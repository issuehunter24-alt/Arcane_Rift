{"version":3,"mappings":"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a,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,aAAc,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,QAAS,GACxF,MAAO,CACH,YAAa,kEACb,gBAAiB,qCAC7B,EACQ,eAAgB,mCAChB,WAAY,mCACZ,SAAU,CACN,UAAW,CACP,CACI,QAAS,SACT,KAAM,2CACN,QAAS,SACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,oCACN,QAAS,SACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,kEACN,QAAS,SACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,oEACN,QAAS,SACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,sDACN,QAAS,aACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,2DACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,kDACN,QAAS,aACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,yDACN,QAAS,SACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,+CACN,QAAS,aACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,yBACN,QAAS,QACT,eAAgB,8BACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,SACT,KAAM,qCACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,2CACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,qDACN,QAAS,SACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,qDACN,QAAS,aACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,sCACN,QAAS,QACT,eAAgB,8BACpC,CACA,EACY,WAAY,CACR,CACI,QAAS,SACT,KAAM,uDACN,QAAS,SACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,oDACN,QAAS,MACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,iDACN,QAAS,SACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,0CACN,QAAS,aACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,gDACN,QAAS,QACT,eAAgB,8BACpC,CACA,CACA,CACA,EACI,CACI,GAAI,EAAG,KAAM,QAAS,MAAO,OAAQ,iBAAkB,IACvD,YAAa,CAAE,KAAM,EAAG,OAAQ,CAAC,EAAI,aAAc,CAAE,KAAM,EAAG,OAAQ,CAAC,EAAI,QAAS,GACpF,MAAO,CACH,YAAa,mFACb,gBAAiB,iCAC7B,EACQ,eAAgB,mCAChB,WAAY,8BACZ,SAAU,CACN,UAAW,CACP,CACI,QAAS,SACT,KAAM,qDACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,0CACN,QAAS,SACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,6DACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,4DACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,qDACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,+DACN,QAAS,SACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,0CACN,QAAS,QACT,eAAgB,yBACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,SACT,KAAM,+BACN,QAAS,MACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,wCACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,kDACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,8CACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,mDACN,QAAS,QACT,eAAgB,yBACpC,CACA,EACY,WAAY,CACR,CACI,QAAS,SACT,KAAM,oDACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,wCACN,QAAS,MACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,iDACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,sCACN,QAAS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SAAU,CACN,UAAW,CACP,CACI,QAAS,eACT,KAAM,uCACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,4CACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,eACT,KAAM,2DACN,QAAS,SACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,kCACN,QAAS,aACT,eAAgB,8BACpC,EACgB,CACI,QAAS,eACT,KAAM,mDACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,qCACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,eACT,KAAM,wCACN,QAAS,QACT,eAAgB,yBACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,eACT,KAAM,mCACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,kDACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,eACT,KAAM,yCACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,2CACN,QAAS,aACT,eAAgB,8BACpC,CACA,EACY,WAAY,CACR,CACI,QAAS,eACT,KAAM,sCACN,QAAS,YACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,4CACN,QAAS,MACT,eAAgB,8BACpC,EACgB,CACI,QAAS,eACT,KAAM,4CACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,wCACN,QAAS,aACT,eAAgB,8BACpC,CACA,CACA,CACA,EACI,CACI,GAAI,EAAG,KAAM,SAAU,MAAO,UAAW,iBAAkB,IAC3D,YAAa,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,aAAc,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,QAAS,GACxF,MAAO,CACH,YAAa,iGACb,gBAAiB,sCAC7B,EACQ,eAAgB,mCAChB,WAAY,8BACZ,SAAU,CACN,UAAW,CACP,CACI,QAAS,SACT,KAAM,0DACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,uDACN,QAAS,YACT,eAAgB,8BACpC,EACgB,CACI,QAAS,oBACT,KAAM,8DACN,QAAS,SACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,kEACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,sDACN,QAAS,aACT,eAAgB,8BACpC,EACgB,CACI,QAAS,oBACT,KAAM,oEACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,wCACN,QAAS,QACT,eAAgB,yBACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,SACT,KAAM,gDACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,oBACT,KAAM,yDACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,kDACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,uDACN,QAAS,QACT,eAAgB,yBACpC,CACA,EACY,WAAY,CACR,CACI,QAAS,SACT,KAAM,uCACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,kDACN,QAAS,MACT,eAAgB,8BACpC,EACgB,CACI,QAAS,oBACT,KAAM,wDACN,QAAS,SACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,gDACN,QAAS,QACT,eAAgB,yBACpC,CACA,CACA,CACA,EACI,CACI,GAAI,EAAG,KAAM,SAAU,MAAO,QAAS,iBAAkB,IACzD,YAAa,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,aAAc,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,QAAS,GACxF,MAAO,CACH,YAAa,8DACb,gBAAiB,mCAC7B,EACQ,eAAgB,mCAChB,WAAY,6BACZ,SAAU,CACN,UAAW,CACP,CACI,QAAS,cACT,KAAM,iCACN,QAAS,SACT,eAAgB,wBACpC,EACgB,CACI,QAAS,eACT,KAAM,sCACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,kDACN,QAAS,YACT,eAAgB,8BACpC,EACgB,CACI,QAAS,cACT,KAAM,+CACN,QAAS,QACT,eAAgB,wBACpC,EACgB,CACI,QAAS,eACT,KAAM,mDACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,2CACN,QAAS,aACT,eAAgB,8BACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,cACT,KAAM,wCACN,QAAS,YACT,eAAgB,wBACpC,EACgB,CACI,QAAS,eACT,KAAM,kCACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,0DACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,cACT,KAAM,+BACN,QAAS,SACT,eAAgB,wBACpC,CACA,EACY,WAAY,CACR,CACI,QAAS,cACT,KAAM,2CACN,QAAS,QACT,eAAgB,wBACpC,EACgB,CACI,QAAS,YACT,KAAM,oCACN,QAAS,MACT,eAAgB,8BACpC,EACgB,CACI,QAAS,eACT,KAAM,iCACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,cACT,KAAM,4CACN,QAAS,SACT,eAAgB,wBACpC,CACA,CACA,CACA,EACI,CACI,GAAI,EAAG,KAAM,QAAS,MAAO,QAAS,iBAAkB,IACxD,YAAa,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,aAAc,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,QAAS,GACxF,MAAO,CACH,YAAa,8DACb,gBAAiB,mCAC7B,EACQ,eAAgB,mCAChB,WAAY,gCACZ,SAAU,CACN,UAAW,CACP,CACI,QAAS,iBACT,KAAM,kDACN,QAAS,QACT,eAAgB,2BACpC,EACgB,CACI,QAAS,YACT,KAAM,6CACN,QAAS,aACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,iEACN,QAAS,SACT,eAAgB,8BACpC,EACgB,CACI,QAAS,iBACT,KAAM,iEACN,QAAS,SACT,eAAgB,2BACpC,EACgB,CACI,QAAS,YACT,KAAM,+CACN,QAAS,aACT,eAAgB,8BACpC,EACgB,CACI,QAAS,iBACT,KAAM,6BACN,QAAS,SACT,eAAgB,2BACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,iBACT,KAAM,sCACN,QAAS,YACT,eAAgB,2BACpC,EACgB,CACI,QAAS,SACT,KAAM,0CACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,4CACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,iBACT,KAAM,+BACN,QAAS,SACT,eAAgB,2BACpC,CACA,EACY,WAAY,CACR,CACI,QAAS,iBACT,KAAM,kCACN,QAAS,QACT,eAAgB,2BACpC,EACgB,CACI,QAAS,YACT,KAAM,+CACN,QAAS,MACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,2CACN,QAAS,SACT,eAAgB,8BACpC,EACgB,CACI,QAAS,iBACT,KAAM,qCACN,QAAS,SACT,eAAgB,2BACpC,CACA,CACA,CACA,EACI,CACI,GAAI,EAAG,KAAM,SAAU,MAAO,kBAAmB,iBAAkB,IACnE,YAAa,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,aAAc,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,QAAS,GACxF,MAAO,CACH,YAAa,4DACb,gBAAiB,sCAC7B,EACQ,eAAgB,mCAChB,WAAY,kCACZ,SAAU,CACN,UAAW,CACP,CACI,QAAS,mBACT,KAAM,6CACN,QAAS,SACT,eAAgB,6BACpC,EACgB,CACI,QAAS,YACT,KAAM,oDACN,QAAS,MACT,eAAgB,8BACpC,EACgB,CACI,QAAS,mBACT,KAAM,4CACN,QAAS,SACT,eAAgB,6BACpC,EACgB,CACI,QAAS,YACT,KAAM,uDACN,QAAS,aACT,eAAgB,8BACpC,EACgB,CACI,QAAS,mBACT,KAAM,oCACN,QAAS,QACT,eAAgB,6BACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,mBACT,KAAM,gCACN,QAAS,YACT,eAAgB,6BACpC,EACgB,CACI,QAAS,YACT,KAAM,+CACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,mBACT,KAAM,8CACN,QAAS,SACT,eAAgB,6BACpC,CACA,EACY,WAAY,CACR,CACI,QAAS,mBACT,KAAM,4BACN,QAAS,SACT,eAAgB,6BACpC,EACgB,CACI,QAAS,YACT,KAAM,8CACN,QAAS,MACT,eAAgB,8BACpC,EACgB,CACI,QAAS,mBACT,KAAM,8CACN,QAAS,SACT,eAAgB,6BACpC,EACgB,CACI,QAAS,mBACT,KAAM,8BACN,QAAS,QACT,eAAgB,6BACpC,CACA,CACA,CACA,EACI,CACI,GAAI,GAAI,KAAM,UAAW,MAAO,SAAU,iBAAkB,IAC5D,YAAa,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,aAAc,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,QAAS,GACxF,MAAO,CACH,YAAa,6DACb,gBAAiB,wCAC7B,EACQ,eAAgB,mCAChB,WAAY,6BACZ,SAAU,CACN,UAAW,CACP,CACI,QAAS,cACT,KAAM,gDACN,QAAS,QACT,eAAgB,wBACpC,EACgB,CACI,QAAS,YACT,KAAM,4DACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,mCACN,QAAS,QACT,eAAgB,sBACpC,EACgB,CACI,QAAS,cACT,KAAM,4DACN,QAAS,QACT,eAAgB,wBACpC,EACgB,CACI,QAAS,YACT,KAAM,+DACN,QAAS,aACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,gCACN,QAAS,QACT,eAAgB,sBACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,cACT,KAAM,mCACN,QAAS,YACT,eAAgB,wBACpC,EACgB,CACI,QAAS,YACT,KAAM,qDACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,uCACN,QAAS,QACT,eAAgB,sBACpC,EACgB,CACI,QAAS,cACT,KAAM,4DACN,QAAS,QACT,eAAgB,wBACpC,CACA,EACY,WAAY,CACR,CACI,QAAS,cACT,KAAM,oCACN,QAAS,SACT,eAAgB,wBACpC,EACgB,CACI,QAAS,YACT,KAAM,6CACN,QAAS,MACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,6CACN,QAAS,QACT,eAAgB,sBACpC,EACgB,CACI,QAAS,cACT,KAAM,4CACN,QAAS,QACT,eAAgB,wBACpC,CACA,CACA,CACA,EACI,CACI,GAAI,GAAI,KAAM,QAAS,MAAO,UAAW,iBAAkB,IAC3D,YAAa,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,aAAc,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,QAAS,GACxF,MAAO,CACH,YAAa,sEACb,gBAAiB,6CAC7B,EACQ,eAAgB,mCAChB,WAAY,mCACZ,SAAU,CACN,UAAW,CACP,CACI,QAAS,SACT,KAAM,4DACN,QAAS,SACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,4CACN,QAAS,aACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,gEACN,QAAS,SACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,sDACN,QAAS,SACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,2DACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,kDACN,QAAS,aACT,eAAgB,8BACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,SACT,KAAM,wDACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,6CACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,kDACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,2CACN,QAAS,aACT,eAAgB,8BACpC,CACA,EACY,WAAY,CACR,CACI,QAAS,SACT,KAAM,4CACN,QAAS,SACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,+CACN,QAAS,MACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,oDACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,mCACN,QAAS,aACT,eAAgB,8BACpC,CACA,CACA,CACA,EACI,CACI,GAAI,GAAI,KAAM,SAAU,MAAO,QAAS,iBAAkB,IAC1D,YAAa,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,aAAc,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,QAAS,GACxF,MAAO,CACH,YAAa,kDACb,gBAAiB,uCAC7B,EACQ,eAAgB,mCAChB,WAAY,8BACZ,SAAU,CACN,UAAW,CACP,CACI,QAAS,SACT,KAAM,4DACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,oDACN,QAAS,SACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,0DACN,QAAS,SACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,wCACN,QAAS,aACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,2DACN,QAAS,SACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,gCACN,QAAS,QACT,eAAgB,8BACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,SACT,KAAM,uCACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,sDACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,0CACN,QAAS,SACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,yBACN,QAAS,QACT,eAAgB,8BACpC,CACA,EACY,WAAY,CACR,CACI,QAAS,SACT,KAAM,gCACN,QAAS,SACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,6BACN,QAAS,MACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,qCACN,QAAS,QACT,eAAgB,yBACpC,CACA,CACA,CACA,EACI,CACI,GAAI,GAAI,KAAM,SAAU,MAAO,OAAQ,iBAAkB,IACzD,YAAa,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,aAAc,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,QAAS,GACxF,MAAO,CACH,YAAa,0CACb,gBAAiB,sCAC7B,EACQ,eAAgB,mCAChB,WAAY,mCACZ,SAAU,CACN,UAAW,CACP,CACI,QAAS,oBACT,KAAM,kDACN,QAAS,SACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,6CACN,QAAS,SACT,eAAgB,8BACpC,EACgB,CACI,QAAS,oBACT,KAAM,kDACN,QAAS,SACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,oDACN,QAAS,aACT,eAAgB,8BACpC,EACgB,CACI,QAAS,oBACT,KAAM,+CACN,QAAS,SACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,4BACN,QAAS,QACT,eAAgB,8BACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,oBACT,KAAM,4BACN,QAAS,YACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,qDACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,oBACT,KAAM,sCACN,QAAS,SACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,uBACN,QAAS,SACT,eAAgB,8BACpC,CACA,EACY,WAAY,CACR,CACI,QAAS,oBACT,KAAM,0BACN,QAAS,SACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,wCACN,QAAS,MACT,eAAgB,8BACpC,EACgB,CACI,QAAS,oBACT,KAAM,sCACN,QAAS,SACT,eAAgB,8BACpC,CACA,CACA,CACA,EACI,CACI,GAAI,GAAI,KAAM,SAAU,MAAO,aAAc,iBAAkB,IAC/D,YAAa,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,aAAc,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,QAAS,GACxF,MAAO,CACH,YAAa,6CACb,gBAAiB,4CAC7B,EACQ,eAAgB,mCAChB,WAAY,8BACZ,SAAU,CACN,UAAW,CACP,CACI,QAAS,eACT,KAAM,gDACN,QAAS,SACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,gCACN,QAAS,SACT,eAAgB,8BACpC,EACgB,CACI,QAAS,eACT,KAAM,kDACN,QAAS,SACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,sCACN,QAAS,aACT,eAAgB,8BACpC,EACgB,CACI,QAAS,eACT,KAAM,6BACN,QAAS,QACT,eAAgB,yBACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,eACT,KAAM,qCACN,QAAS,YACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,8BACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,eACT,KAAM,uCACN,QAAS,SACT,eAAgB,yBACpC,CACA,EACY,WAAY,CACR,CACI,QAAS,eACT,KAAM,qBACN,QAAS,SACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,6BACN,QAAS,MACT,eAAgB,8BACpC,EACgB,CACI,QAAS,eACT,KAAM,iDACN,QAAS,SACT,eAAgB,yBACpC,CACA,CACA,CACA,EACI,CACI,GAAI,GAAI,KAAM,SAAU,MAAO,QAAS,iBAAkB,IAC1D,YAAa,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,aAAc,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,QAAS,GACxF,MAAO,CACH,YAAa,kDACb,gBAAiB,uCAC7B,EACQ,eAAgB,mCAChB,WAAY,8BACZ,SAAU,CACN,UAAW,CACP,CACI,QAAS,eACT,KAAM,6CACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,sDACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,eACT,KAAM,qDACN,QAAS,SACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,wDACN,QAAS,aACT,eAAgB,8BACpC,EACgB,CACI,QAAS,eACT,KAAM,sCACN,QAAS,QACT,eAAgB,yBACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,eACT,KAAM,8CACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,eACT,KAAM,+CACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,sDACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,eACT,KAAM,iCACN,QAAS,QACT,eAAgB,yBACpC,CACA,EACY,WAAY,CACR,CACI,QAAS,eACT,KAAM,qDACN,QAAS,SACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,0CACN,QAAS,MACT,eAAgB,8BACpC,EACgB,CACI,QAAS,eACT,KAAM,+CACN,QAAS,SACT,eAAgB,yBACpC,EACgB,CACI,QAAS,eACT,KAAM,6BACN,QAAS,QACT,eAAgB,yBACpC,CACA,CACA,CACA,EACI,CACI,GAAI,GAAI,KAAM,SAAU,MAAO,SAAU,iBAAkB,IAC3D,YAAa,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,aAAc,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,QAAS,GACxF,MAAO,CACH,YAAa,yCACb,gBAAiB,wCAC7B,EACQ,eAAgB,mCAChB,WAAY,6BACZ,SAAU,CACN,UAAW,CACP,CACI,QAAS,cACT,KAAM,kDACN,QAAS,SACT,eAAgB,wBACpC,EACgB,CACI,QAAS,YACT,KAAM,iCACN,QAAS,SACT,eAAgB,8BACpC,EACgB,CACI,QAAS,cACT,KAAM,wDACN,QAAS,QACT,eAAgB,wBACpC,EACgB,CACI,QAAS,YACT,KAAM,gDACN,QAAS,aACT,eAAgB,8BACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,cACT,KAAM,iCACN,QAAS,YACT,eAAgB,wBACpC,EACgB,CACI,QAAS,YACT,KAAM,6CACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,cACT,KAAM,8BACN,QAAS,SACT,eAAgB,wBACpC,CACA,EACY,WAAY,CACR,CACI,QAAS,cACT,KAAM,oBACN,QAAS,SACT,eAAgB,wBACpC,EACgB,CACI,QAAS,YACT,KAAM,+BACN,QAAS,MACT,eAAgB,8BACpC,EACgB,CACI,QAAS,cACT,KAAM,8BACN,QAAS,SACT,eAAgB,wBACpC,CACA,CACA,CACA,EACI,CACI,GAAI,GAAI,KAAM,QAAS,MAAO,QAAS,iBAAkB,IACzD,YAAa,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,aAAc,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,QAAS,GACxF,MAAO,CACH,YAAa,+DACb,gBAAiB,0CAC7B,EACQ,eAAgB,mCAChB,WAAY,8BACZ,SAAU,CACN,UAAW,CACP,CACI,QAAS,SACT,KAAM,yCACN,QAAS,SACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,sDACN,QAAS,aACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,mDACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,2CACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,6CACN,QAAS,QACT,eAAgB,yBACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,SACT,KAAM,8BACN,QAAS,YACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,+CACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,2CACN,QAAS,QACT,eAAgB,yBACpC,CACA,EACY,WAAY,CACR,CACI,QAAS,SACT,KAAM,8BACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,wCACN,QAAS,MACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,+BACN,QAAS,SACT,eAAgB,yBACpC,CACA,CACA,CACA,EACI,CACI,GAAI,GAAI,KAAM,SAAU,MAAO,aAAc,iBAAkB,IAC/D,YAAa,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,aAAc,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,QAAS,GACxF,MAAO,CACH,YAAa,oDACb,gBAAiB,sCAC7B,EACQ,eAAgB,mCAChB,WAAY,sBACZ,SAAU,CACN,UAAW,CACP,CACI,QAAS,OACT,KAAM,yCACN,QAAS,QACT,eAAgB,iBACpC,EACgB,CACI,QAAS,YACT,KAAM,gDACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,OACT,KAAM,2DACN,QAAS,aACT,eAAgB,iBACpC,EACgB,CACI,QAAS,YACT,KAAM,4CACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,OACT,KAAM,qCACN,QAAS,QACT,eAAgB,iBACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,OACT,KAAM,sCACN,QAAS,QACT,eAAgB,iBACpC,EACgB,CACI,QAAS,YACT,KAAM,gDACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,OACT,KAAM,gCACN,QAAS,QACT,eAAgB,iBACpC,CACA,EACY,WAAY,CACR,CACI,QAAS,OACT,KAAM,4BACN,QAAS,MACT,eAAgB,iBACpC,EACgB,CACI,QAAS,YACT,KAAM,6CACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,OACT,KAAM,uCACN,QAAS,aACT,eAAgB,iBACpC,CACA,CACA,CACA,EACI,CACI,GAAI,GAAI,KAAM,QAAS,MAAO,UAAW,iBAAkB,IAC3D,YAAa,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,aAAc,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,QAAS,GACxF,MAAO,CACH,YAAa,oCACb,gBAAiB,kCAC7B,EACQ,eAAgB,mCAChB,WAAY,kCACZ,SAAU,CACN,UAAW,CACP,CACI,QAAS,mBACT,KAAM,qCACN,QAAS,SACT,eAAgB,6BACpC,EACgB,CACI,QAAS,YACT,KAAM,4BACN,QAAS,MACT,eAAgB,8BACpC,EACgB,CACI,QAAS,mBACT,KAAM,qCACN,QAAS,QACT,eAAgB,6BACpC,EACgB,CACI,QAAS,YACT,KAAM,8BACN,QAAS,aACT,eAAgB,8BACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,mBACT,KAAM,gCACN,QAAS,YACT,eAAgB,6BACpC,EACgB,CACI,QAAS,YACT,KAAM,sCACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,mBACT,KAAM,yCACN,QAAS,SACT,eAAgB,6BACpC,CACA,EACY,WAAY,CACR,CACI,QAAS,mBACT,KAAM,6BACN,QAAS,SACT,eAAgB,6BACpC,EACgB,CACI,QAAS,YACT,KAAM,wBACN,QAAS,MACT,eAAgB,8BACpC,EACgB,CACI,QAAS,mBACT,KAAM,2CACN,QAAS,SACT,eAAgB,6BACpC,CACA,CACA,CACA,EACI,CACI,GAAI,GAAI,KAAM,QAAS,MAAO,SAAU,iBAAkB,IAC1D,YAAa,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,aAAc,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,QAAS,GACxF,MAAO,CACH,YAAa,uCACb,gBAAiB,0CAC7B,EACQ,eAAgB,mCAChB,WAAY,gCACZ,SAAU,CACN,UAAW,CACP,CACI,QAAS,iBACT,KAAM,gDACN,QAAS,QACT,eAAgB,2BACpC,EACgB,CACI,QAAS,YACT,KAAM,qDACN,QAAS,aACT,eAAgB,8BACpC,EACgB,CACI,QAAS,iBACT,KAAM,gDACN,QAAS,SACT,eAAgB,2BACpC,EACgB,CACI,QAAS,YACT,KAAM,qDACN,QAAS,SACT,eAAgB,8BACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,iBACT,KAAM,yCACN,QAAS,QACT,eAAgB,2BACpC,EACgB,CACI,QAAS,YACT,KAAM,4BACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,iBACT,KAAM,kCACN,QAAS,SACT,eAAgB,2BACpC,CACA,EACY,WAAY,CACR,CACI,QAAS,iBACT,KAAM,qCACN,QAAS,SACT,eAAgB,2BACpC,EACgB,CACI,QAAS,YACT,KAAM,2BACN,QAAS,MACT,eAAgB,8BACpC,EACgB,CACI,QAAS,iBACT,KAAM,sCACN,QAAS,SACT,eAAgB,2BACpC,CACA,CACA,CACA,EAEI,CACI,GAAI,GAAI,KAAM,QAAS,MAAO,SAAU,iBAAkB,IAC1D,YAAa,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,aAAc,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,QAAS,GACxF,MAAO,CACH,YAAa,+CACb,gBAAiB,kCAC7B,EACQ,eAAgB,mCAChB,SAAU,CACN,UAAW,CACP,CACI,QAAS,SACT,KAAM,yCACN,QAAS,SACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,qDACN,QAAS,SACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,8CACN,QAAS,MACT,eAAgB,8BACpC,EACgB,CACI,QAAS,eACT,KAAM,4BACN,QAAS,SACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,yCACN,QAAS,aACT,eAAgB,8BACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,SACT,KAAM,sCACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,+CACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,8CACN,QAAS,SACT,eAAgB,yBACpC,CACA,EACY,WAAY,CACR,CACI,QAAS,SACT,KAAM,mCACN,QAAS,SACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,sCACN,QAAS,MACT,eAAgB,8BACpC,EACgB,CACI,QAAS,eACT,KAAM,2CACN,QAAS,SACT,eAAgB,yBACpC,CACA,CACA,CACA,EACI,CACI,GAAI,GAAI,KAAM,SAAU,MAAO,OAAQ,iBAAkB,IACzD,YAAa,CAAE,KAAM,IAAM,OAAQ,EAAE,EAAI,aAAc,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,QAAS,GAC1F,MAAO,CACH,YAAa,yDACb,gBAAiB,+BAC7B,EACQ,eAAgB,mCAChB,WAAY,2BACZ,SAAU,CACN,UAAW,CACP,CACI,QAAS,YACT,KAAM,wCACN,QAAS,QACT,eAAgB,sBACpC,EACgB,CACI,QAAS,YACT,KAAM,2CACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,0DACN,QAAS,SACT,eAAgB,sBACpC,EACgB,CACI,QAAS,YACT,KAAM,uDACN,QAAS,aACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,4CACN,QAAS,QACT,eAAgB,sBACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,YACT,KAAM,8BACN,QAAS,YACT,eAAgB,sBACpC,EACgB,CACI,QAAS,YACT,KAAM,yCACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,gDACN,QAAS,QACT,eAAgB,sBACpC,CACA,EACY,WAAY,CACR,CACI,QAAS,YACT,KAAM,kCACN,QAAS,SACT,eAAgB,sBACpC,EACgB,CACI,QAAS,YACT,KAAM,uCACN,QAAS,MACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,mCACN,QAAS,QACT,eAAgB,sBACpC,CACA,CACA,CACA,EACI,CACI,GAAI,GAAI,KAAM,SAAU,MAAO,aAAc,iBAAkB,IAC/D,YAAa,CAAE,KAAM,KAAM,OAAQ,EAAE,EAAI,aAAc,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,QAAS,GAC1F,MAAO,CACH,YAAa,sCACb,gBAAiB,mCAC7B,EACQ,eAAgB,mCAChB,WAAY,8BACZ,SAAU,CACN,UAAW,CACP,CACI,QAAS,eACT,KAAM,uCACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,2CACN,QAAS,SACT,eAAgB,8BACpC,EACgB,CACI,QAAS,eACT,KAAM,+CACN,QAAS,SACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,sCACN,QAAS,aACT,eAAgB,8BACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,eACT,KAAM,0CACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,yCACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,eACT,KAAM,8CACN,QAAS,SACT,eAAgB,yBACpC,CACA,EACY,WAAY,CACR,CACI,QAAS,eACT,KAAM,4BACN,QAAS,SACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,4BACN,QAAS,MACT,eAAgB,8BACpC,EACgB,CACI,QAAS,eACT,KAAM,uCACN,QAAS,SACT,eAAgB,yBACpC,CACA,CACA,CACA,EACI,CACI,GAAI,GAAI,KAAM,QAAS,MAAO,SAAU,iBAAkB,IAC1D,YAAa,CAAE,KAAM,KAAM,OAAQ,EAAE,EAAI,aAAc,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,QAAS,GAC1F,MAAO,CACH,YAAa,6CACb,gBAAiB,yCAC7B,EACQ,eAAgB,mCAChB,WAAY,6BACZ,SAAU,CACN,UAAW,CACP,CACI,QAAS,cACT,KAAM,wCACN,QAAS,QACT,eAAgB,wBACpC,EACgB,CACI,QAAS,YACT,KAAM,2CACN,QAAS,MACT,eAAgB,8BACpC,EACgB,CACI,QAAS,cACT,KAAM,6CACN,QAAS,SACT,eAAgB,wBACpC,EACgB,CACI,QAAS,YACT,KAAM,sCACN,QAAS,aACT,eAAgB,8BACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,cACT,KAAM,kCACN,QAAS,YACT,eAAgB,wBACpC,EACgB,CACI,QAAS,YACT,KAAM,8CACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,cACT,KAAM,0CACN,QAAS,SACT,eAAgB,wBACpC,CACA,EACY,WAAY,CACR,CACI,QAAS,cACT,KAAM,kBACN,QAAS,SACT,eAAgB,wBACpC,EACgB,CACI,QAAS,YACT,KAAM,+BACN,QAAS,MACT,eAAgB,8BACpC,EACgB,CACI,QAAS,cACT,KAAM,qCACN,QAAS,SACT,eAAgB,wBACpC,CACA,CACA,CACA,EACI,CACI,GAAI,GAAI,KAAM,QAAS,MAAO,eAAgB,iBAAkB,IAChE,YAAa,CAAE,KAAM,KAAM,OAAQ,EAAE,EAAI,aAAc,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,QAAS,GAC1F,MAAO,CACH,YAAa,mDACb,gBAAiB,yCAC7B,EACQ,eAAgB,mCAChB,WAAY,kCACZ,SAAU,CACN,UAAW,CACP,CACI,QAAS,mBACT,KAAM,2CACN,QAAS,SACT,eAAgB,6BACpC,EACgB,CACI,QAAS,YACT,KAAM,uCACN,QAAS,aACT,eAAgB,8BACpC,EACgB,CACI,QAAS,mBACT,KAAM,6CACN,QAAS,SACT,eAAgB,6BACpC,EACgB,CACI,QAAS,YACT,KAAM,uCACN,QAAS,QACT,eAAgB,8BACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,mBACT,KAAM,8BACN,QAAS,QACT,eAAgB,6BACpC,EACgB,CACI,QAAS,YACT,KAAM,+CACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,mBACT,KAAM,uCACN,QAAS,SACT,eAAgB,6BACpC,CACA,EACY,WAAY,CACR,CACI,QAAS,mBACT,KAAM,6BACN,QAAS,QACT,eAAgB,6BACpC,EACgB,CACI,QAAS,YACT,KAAM,iCACN,QAAS,MACT,eAAgB,8BACpC,CACA,CACA,CACA,EACI,CACI,GAAI,GAAI,KAAM,QAAS,MAAO,SAAU,iBAAkB,IAC1D,YAAa,CAAE,KAAM,KAAM,OAAQ,EAAE,EAAI,aAAc,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,QAAS,GAC1F,MAAO,CACH,YAAa,0CACb,gBAAiB,uCAC7B,EACQ,eAAgB,mCAChB,WAAY,gCACZ,SAAU,CACN,UAAW,CACP,CACI,QAAS,iBACT,KAAM,yCACN,QAAS,SACT,eAAgB,2BACpC,EACgB,CACI,QAAS,YACT,KAAM,+BACN,QAAS,SACT,eAAgB,8BACpC,EACgB,CACI,QAAS,iBACT,KAAM,sCACN,QAAS,SACT,eAAgB,2BACpC,EACgB,CACI,QAAS,YACT,KAAM,0BACN,QAAS,aACT,eAAgB,8BACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,iBACT,KAAM,8BACN,QAAS,QACT,eAAgB,2BACpC,EACgB,CACI,QAAS,YACT,KAAM,uCACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,iBACT,KAAM,0CACN,QAAS,SACT,eAAgB,2BACpC,CACA,EACY,WAAY,CACR,CACI,QAAS,iBACT,KAAM,4CACN,QAAS,SACT,eAAgB,2BACpC,EACgB,CACI,QAAS,YACT,KAAM,oCACN,QAAS,MACT,eAAgB,8BACpC,EACgB,CACI,QAAS,iBACT,KAAM,kCACN,QAAS,SACT,eAAgB,2BACpC,CACA,CACA,CACA,EACI,CACI,GAAI,GAAI,KAAM,UAAW,MAAO,UAAW,iBAAkB,IAC7D,YAAa,CAAE,KAAM,KAAM,OAAQ,EAAE,EAAI,aAAc,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,QAAS,GAC1F,MAAO,CACH,YAAa,wDACb,gBAAiB,mCAC7B,EACQ,eAAgB,mCAChB,WAAY,6BACZ,SAAU,CACN,UAAW,CACP,CACI,QAAS,cACT,KAAM,qCACN,QAAS,QACT,eAAgB,wBACpC,EACgB,CACI,QAAS,SACT,KAAM,wDACN,QAAS,SACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,sDACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,cACT,KAAM,sDACN,QAAS,QACT,eAAgB,wBACpC,EACgB,CACI,QAAS,SACT,KAAM,kDACN,QAAS,QACT,eAAgB,yBACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,cACT,KAAM,qCACN,QAAS,QACT,eAAgB,wBACpC,EACgB,CACI,QAAS,SACT,KAAM,iDACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,2BACN,QAAS,QACT,eAAgB,8BACpC,CACA,EACY,WAAY,CACR,CACI,QAAS,cACT,KAAM,6BACN,QAAS,YACT,eAAgB,wBACpC,EACgB,CACI,QAAS,YACT,KAAM,kCACN,QAAS,MACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,wCACN,QAAS,SACT,eAAgB,yBACpC,CACA,CACA,CACA,EACI,CACI,GAAI,GAAI,KAAM,QAAS,MAAO,QAAS,iBAAkB,IACzD,YAAa,CAAE,KAAM,KAAM,OAAQ,EAAE,EAAI,aAAc,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,QAAS,GAC1F,MAAO,CACH,YAAa,0CACb,gBAAiB,yCAC7B,EACQ,eAAgB,mCAChB,SAAU,CACN,UAAW,CACP,CACI,QAAS,SACT,KAAM,uDACN,QAAS,SACT,eAAgB,8BACpC,EACgB,CACI,QAAS,iBACT,KAAM,oDACN,QAAS,SACT,eAAgB,2BACpC,EACgB,CACI,QAAS,YACT,KAAM,gDACN,QAAS,aACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,yCACN,QAAS,SACT,eAAgB,sBACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,SACT,KAAM,iCACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,sDACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,yBACN,QAAS,SACT,eAAgB,sBACpC,CACA,EACY,WAAY,CACR,CACI,QAAS,iBACT,KAAM,qCACN,QAAS,SACT,eAAgB,2BACpC,EACgB,CACI,QAAS,YACT,KAAM,oCACN,QAAS,MACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,qCACN,QAAS,SACT,eAAgB,8BACpC,CACA,CACA,CACA,EACI,CACI,GAAI,GAAI,KAAM,SAAU,MAAO,YAAa,iBAAkB,IAC9D,YAAa,CAAE,KAAM,KAAM,OAAQ,EAAE,EAAI,aAAc,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,QAAS,GAC1F,MAAO,CACH,YAAa,qDACb,gBAAiB,sCAC7B,EACQ,eAAgB,mCAChB,WAAY,8BACZ,SAAU,CACN,UAAW,CACP,CACI,QAAS,eACT,KAAM,sCACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,4CACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,eACT,KAAM,yCACN,QAAS,aACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,yCACN,QAAS,aACT,eAAgB,8BACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,eACT,KAAM,6CACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,wCACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,eACT,KAAM,iCACN,QAAS,QACT,eAAgB,yBACpC,CACA,EACY,WAAY,CACR,CACI,QAAS,eACT,KAAM,iCACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,kCACN,QAAS,aACT,eAAgB,8BACpC,CACA,CACA,CACA,EACI,CACI,GAAI,GAAI,KAAM,QAAS,MAAO,aAAc,iBAAkB,IAC9D,YAAa,CAAE,KAAM,KAAM,OAAQ,EAAE,EAAI,aAAc,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,QAAS,GAC1F,MAAO,CACH,YAAa,wDACb,gBAAiB,sCAC7B,EACQ,eAAgB,mCAChB,WAAY,+BACZ,SAAU,CACN,UAAW,CACP,CACI,QAAS,gBACT,KAAM,8CACN,QAAS,SACT,eAAgB,0BACpC,EACgB,CACI,QAAS,YACT,KAAM,sCACN,QAAS,aACT,eAAgB,8BACpC,EACgB,CACI,QAAS,gBACT,KAAM,0DACN,QAAS,QACT,eAAgB,0BACpC,EACgB,CACI,QAAS,YACT,KAAM,8CACN,QAAS,aACT,eAAgB,8BACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,gBACT,KAAM,4CACN,QAAS,QACT,eAAgB,0BACpC,EACgB,CACI,QAAS,YACT,KAAM,oCACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,gBACT,KAAM,wCACN,QAAS,SACT,eAAgB,0BACpC,CACA,EACY,WAAY,CACR,CACI,QAAS,gBACT,KAAM,+BACN,QAAS,SACT,eAAgB,0BACpC,EACgB,CACI,QAAS,YACT,KAAM,wCACN,QAAS,aACT,eAAgB,8BACpC,CACA,CACA,CACA,EACI,CACI,GAAI,GAAI,KAAM,MAAO,MAAO,UAAW,iBAAkB,IACzD,YAAa,CAAE,KAAM,KAAM,OAAQ,EAAE,EAAI,aAAc,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,QAAS,GAC1F,MAAO,CACH,YAAa,8CACb,gBAAiB,mCAC7B,EACQ,eAAgB,mCAChB,WAAY,8BACZ,SAAU,CACN,UAAW,CACP,CACI,QAAS,SACT,KAAM,8DACN,QAAS,SACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,mDACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,6DACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,6BACN,QAAS,aACT,eAAgB,8BACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,SACT,KAAM,4CACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,sCACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,uCACN,QAAS,SACT,eAAgB,yBACpC,CACA,EACY,WAAY,CACR,CACI,QAAS,SACT,KAAM,mCACN,QAAS,YACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,uCACN,QAAS,MACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,2BACN,QAAS,QACT,eAAgB,yBACpC,CACA,CACA,CACA,EACI,CACI,GAAI,GAAI,KAAM,QAAS,MAAO,SAAU,iBAAkB,IAC1D,YAAa,CAAE,KAAM,KAAM,OAAQ,EAAE,EAAI,aAAc,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,QAAS,GAC1F,MAAO,CACH,YAAa,qCACb,gBAAiB,oCAC7B,EACQ,eAAgB,mCAChB,SAAU,CACN,UAAW,CACP,CACI,QAAS,iBACT,KAAM,mDACN,QAAS,QAC7B,EACgB,CACI,QAAS,YACT,KAAM,+CACN,QAAS,aACT,eAAgB,8BACpC,EACgB,CACI,QAAS,iBACT,KAAM,8DACN,QAAS,QAC7B,EACgB,CACI,QAAS,YACT,KAAM,uCACN,QAAS,SACT,eAAgB,8BACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,iBACT,KAAM,qCACN,QAAS,QAC7B,EACgB,CACI,QAAS,YACT,KAAM,iCACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,iBACT,KAAM,gCACN,QAAS,QAC7B,CACA,EACY,WAAY,CACR,CACI,QAAS,iBACT,KAAM,kCACN,QAAS,QAC7B,EACgB,CACI,QAAS,YACT,KAAM,kCACN,QAAS,MACT,eAAgB,8BACpC,EACgB,CACI,QAAS,iBACT,KAAM,sCACN,QAAS,QAC7B,CACA,CACA,CACA,EACI,CACI,GAAI,GAAI,KAAM,QAAS,MAAO,YAAa,iBAAkB,IAC7D,YAAa,CAAE,KAAM,KAAM,OAAQ,EAAE,EAAI,aAAc,CAAE,KAAM,IAAK,OAAQ,CAAC,EAAI,QAAS,GAC1F,MAAO,CACH,YAAa,yDACb,gBAAiB,sCAC7B,EACQ,eAAgB,mCAChB,WAAY,sBACZ,SAAU,CACN,UAAW,CACP,CACI,QAAS,OACT,KAAM,oDACN,QAAS,QACT,eAAgB,iBACpC,EACgB,CACI,QAAS,YACT,KAAM,kDACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,OACT,KAAM,mDACN,QAAS,aACT,eAAgB,iBACpC,EACgB,CACI,QAAS,YACT,KAAM,kDACN,QAAS,aACT,eAAgB,8BACpC,EACgB,CACI,QAAS,OACT,KAAM,sCACN,QAAS,QACT,eAAgB,iBACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,OACT,KAAM,yCACN,QAAS,QACT,eAAgB,iBACpC,EACgB,CACI,QAAS,YACT,KAAM,qEACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,OACT,KAAM,yCACN,QAAS,QACT,eAAgB,iBACpC,CACA,EACY,WAAY,CACR,CACI,QAAS,OA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EACgB,CACI,QAAS,YACT,KAAM,iDACN,QAAS,aACT,eAAgB,8BACpC,EACgB,CACI,QAAS,kBACT,KAAM,qCACN,QAAS,QAC7B,EACgB,CACI,QAAS,oBACT,KAAM,6CACN,QAAS,QACT,eAAgB,8BACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,kBACT,KAAM,4CACN,QAAS,OAC7B,EACgB,CACI,QAAS,oBACT,KAAM,mDACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,YACT,KAAM,sDACN,QAAS,QACT,eAAgB,8BACpC,CACA,EACY,WAAY,CACR,CACI,QAAS,kBACT,KAAM,0BACN,QAAS,QAC7B,EACgB,CACI,QAAS,YACT,KAAM,+BACN,QAAS,MACT,eAAgB,8BACpC,EACgB,CACI,QAAS,oBACT,KAAM,8BACN,QAAS,QACT,eAAgB,8BACpC,CACA,CACA,CACA,EACI,CACI,GAAI,GAAI,KAAM,SAAU,MAAO,UAAW,iBAAkB,IAC5D,YAAa,CAAE,KAAM,KAAM,OAAQ,EAAE,EAAI,aAAc,CAAE,KAAM,KAAM,OAAQ,EAAE,EAAI,QAAS,GAC5F,MAAO,CACH,YAAa,4CACb,gBAAiB,0CAC7B,EACQ,eAAgB,mCAChB,WAAY,8BACZ,SAAU,CACN,UAAW,CACP,CACI,QAAS,SACT,KAAM,8CACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,4CACN,QAAS,QACT,eAAgB,8BACpC,EACgB,CACI,QAAS,SACT,KAAM,yBACN,QAAS,QACT,eAAgB,yBACpC,CACA,EACY,YAAa,CACT,CACI,QAAS,SACT,KAAM,+BACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,wBACN,QAAS,QACT,eAAgB,8BACpC,CACA,EACY,WAAY,CACR,CACI,QAAS,SACT,KAAM,2BACN,QAAS,QACT,eAAgB,yBACpC,EACgB,CACI,QAAS,YACT,KAAM,kCACN,QAAS,MACT,eAAgB,8BACpC,CACA,CACA,CACA,EACI,CACI,GAAI,GAAI,KAAM,QAAS,MAAO,OAAQ,iBAAkB,IACxD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","names":["ExtensionType","ExtensionType2","normalizeExtension","ext","normalizeExtensionPriority","defaultPriority","extensions","extensions2","type","_b","_a","handlers","queue","onAdd","onRemove","addHandlers","removeHandlers","map","extension","item","b","index","list","a","Target","sources","source","browserExt","webworkerExt","ObservablePoint","observer","x","y","p","value","has","prefix","Events","EE","fn","context","once","addListener","emitter","event","listener","evt","clearEvent","EventEmitter","names","events","name","i","l","ee","listeners","a1","a2","a3","a4","a5","len","args","length","j","module","PI_2","RAD_TO_DEG","DEG_TO_RAD","Point","tempPoint","Matrix","c","d","tx","ty","array","transpose","out","pos","newPos","id","angle","cos","sin","c1","tx1","matrix","b1","d1","b2","c2","d2","pivotX","pivotY","scaleX","scaleY","rotation","skewX","skewY","transform","pivot","delta","n","identityMatrix","tempMatrix","ux","uy","vx","vy","rotationCayley","rotationMatrices","signum","init","row","_ux","_uy","_vx","_vy","k","mat","groupD8","ind","rotationSecond","rotationFirst","dx","dy","rect","sourceFrame","width","height","frameX","frameY","frameWidth","frameHeight","tempPoints","Rectangle","bounds","rectangle","strokeWidth","alignment","_x","_y","strokeWidthOuter","strokeWidthInner","outerLeft","outerRight","outerTop","outerBottom","innerLeft","innerRight","innerTop","innerBottom","other","x02","y02","x0","x1","y0","y1","lt","lb","rt","rb","s","nx","ny","n00","n10","n01","n11","mx","my","m00","m10","m01","m11","paddingX","paddingY","x2","y2","resolution","eps","uidCache","uid","warnings","v8_0_0","v8_3_4","deprecationState","deprecation","version","message","ignoreDepth","stack","deprecationMessage","useGroup","NOOP","nextPow2","v","isPow2","definedProps","obj","result","key","idHash","createResourceIdFromString","_TextureStyle","options","bigKey","TextureStyle","_TextureSource","resource","newPixelWidth","newPixelHeight","_resource","TextureSource","BufferImageSource","buffer","format","tempMat","TextureMatrix","texture","clampMargin","uvs","tex","orig","trim","texBase","frame","margin","offset","Texture","label","defaultAnchor","defaultBorders","rotate","dynamic","nX","nY","nW","nH","w2","h2","cX","cY","destroySource","updateQuadBounds","anchor","sourceWidth","sourceHeight","defaultMatrix","Bounds","minX","minY","maxX","maxY","mask","left","right","top","bottom","vertexData","beginOffset","endOffset","localX","localY","r","t","e","u","o","h","g","f","m","N","M","H","$","w","S","namesPlugin","extend","_Color","value1","value2","type1","keys1","keys2","alpha","applyToRGB","hexString","alphaString","int","match","color","colord","min","max","Color","cullingMixin","warnCount","maxWarnings","warn","GlobalResourceRegistry","pool","Pool","ClassType","initialSize","total","data","PoolGroupClass","Class","stats","BigPool","cacheAsTextureMixin","val","removeItems","arr","startIdx","removeCount","childrenHelperMixin","beginIndex","endIndex","end","range","removed","child","renderGroup","children","currentIndex","child2","index1","index2","childMat","newMatrix","oldChild","newChild","collectRenderablesMixin","instructionSet","renderer","currentLayer","renderPipes","effect","FilterEffect","MaskEffectManagerClass","test","MaskEffectManager","effectsMixin","hasFilters","hadFilters","didChange","findMixin","deep","found","matrixPool","boundsPool","getFastGlobalBoundsMixin","factorRenderLayers","localBounds","manageEffects","viewBounds","advanced","getGlobalBounds","target","skipUpdateTransform","parentTransform","pooledMatrix","updateTransformBackwards","_getGlobalBounds","worldTransform","parentBounds","preserveBounds","renderableBounds","parent","multiplyHexColors","color1","color2","r1","g1","r2","g2","WHITE_BGR","multiplyColors","localBGRColor","parentBGRColor","bgr2rgb","getGlobalMixin","skipUpdate","current","getLocalBounds","relativeMatrix","_getLocalBounds","rootContainer","isRoot","relativeTransform","localTransform","checkChildrenDidChange","container","previousData","measureMixin","localWidth","sign","localHeight","localBoundsCacheData","onRenderMixin","func","sortMixin","sortChildren","toLocalGlobalMixin","point","position","globalMatrix","from","InstructionSet","instruction","count","TexturePoolClass","textureOptions","pixelWidth","pixelHeight","antialias","textureSource","po2Width","po2Height","renderTexture","resetStyle","destroyTextures","textures","TexturePool","RenderGroup","root","cachedParent","childrenAtDepth","renderGroupChild","childrenToUpdate","renderable","parentCacheAsTexture","assignWithIgnore","ignore","defaultSkew","defaultPivot","defaultScale","defaultOrigin","UPDATE_COLOR","UPDATE_BLEND","UPDATE_VISIBLE","Container","parentRenderGroup","size","skew","opts","localTransformChangeId","scale","origin","sx","sy","px","py","ox","oy","bgr","valueNumber","oldChildren","ViewContainer","Sprite","roundPixels","rest","skipCache","currentTexture","destroyTextureSource","tempBounds","addMaskBounds","boundsToMask","addMaskLocalBounds","localRoot","relativeMask","getMatrixRelativeToParent","AlphaMask","hitTestFn","ColorMask","StencilMask","BrowserAdapter","canvas","url","xml","currentAdapter","DOMAdapter","adapter","CanvasSource","didResize","ImageSource","UPDATE_PRIORITY","UPDATE_PRIORITY2","TickerListener","priority","ticker","redirect","previous","hard","_Ticker","time","currentTime","elapsedMS","head","fps","minFPS","minFPMS","maxFPS","shared","system","Ticker","promise","detectVideoAlphaMode","gl","video","resolve","video2","framebuffer","pixel","_VideoSource","reject","VideoSource","convertToList","input","forceTransform","CacheClass","keys","cacheableAssets","parser","cacheableMap","key2","cacheKeys","cachedAssets","cacheMap","Cache","textureSourceFrom","hasResource","res","Source","resourceToTexture","textureFrom","LoaderParserPriority","LoaderParserPriority2","assertPath","path2","removeUrlParams","escapeRegExp","string","replaceAll","str","find","replace","normalizeStringPosix","allowAboveRoot","lastSegmentLength","lastSlash","dots","code","lastSlashIndex","path","matchFile","matchProtocol","customBaseUrl","customRootUrl","baseUrl","rootUrl","protocol","isAbsolute","trailingSeparator","segments","joined","arg","prevArg","hasRoot","matchedSlash","proto","origpath","start","extIdx","firstNonSlashEnd","startDot","startPart","preDotState","ret","processX","base","ids","depth","tags","createStringVariations","regex","vars","split","isSingleItem","Resolver","bundleId","assetId","assetBundleId","bundleIdentifier","preferOrders","prefer","basePath","rootPath","searchParams","queryValues","asset","alias","src","manifest","bundle","assets","assetNames","convertedAssets","srcs","aliases","bundleAssetId","bundleIds","keyCheck","userDefinedLoadParser","userDefinedParser","srcsToUse","src2","aliasesToUse","resolvedAssets","formattedAsset","singleAsset","results","preferredOrder","priorityKey","filteredAssets","preferred","preference","paramConnector","assetData","loadParser","progressSize","getUrlExtension","copySearchParams","targetUrl","sourceUrl","_Spritesheet","optionsOrTexture","arg1","cachePrefix","metaResolution","initialFrameIndex","frameIndex","maxFrames","sourceSize","animations","animName","frameName","callback","destroyBase","Spritesheet","validImages","getCacheableAssets","ignoreMultiPack","out2","spritesheetAsset","loader","imageTexture","imageFilename","imagePath","spritesheet","multiPacks","promises","itemUrl","sp","_resolvedAsset","idCounts","createIdFromString","groupId","getTestContext","maxFragmentPrecision","getMaxFragmentPrecision","addProgramDefines","isES300","isFragment","ensurePrecision","maxSupportedPrecision","precision","insertVersion","fragmentNameCache","VertexNameCache","setProgramName","nameCache","stripVersion","processes","programCache","_GlProgram","preprocessorOptions","fragment","vertex","processKey","processOptions","GlProgram","attributeFormatData","getAttributeInfoFromFormat","WGSL_TO_VERTEX_TYPES","extractAttributesFromGpuProgram","entryPoint","mainVertStart","arrowFunctionStart","functionArgsSubstring","inputsRegex","extractStructAndGroups","wgsl","linePattern","groupPattern","bindingPattern","namePattern","typePattern","structPattern","structMemberPattern","structName","groups","structs","struct","members","acc","member","name2","group","ShaderStage","ShaderStage2","generateGpuLayoutGroups","layout","generateLayoutHash","removeStructAndGroupDuplicates","vertexStructsAndGroups","fragmentStructsAndGroups","structNameSet","dupeGroupKeySet","GpuProgram","gpuLayout","structsAndGroups","UNIFORM_TYPES_VALUES","UNIFORM_TYPES_MAP","getDefaultUniformValue","_UniformGroup","uniformStructures","uniforms","uniformData","arrayMatch","innerType","UniformGroup","BindGroup","resources","keyParts","currentResource","tick","RendererType","RendererType2","Shader","gpuProgram","glProgram","compatibleRenderers","groupMap","nameHash","uniformName","groupData","bindTick","groupIndex","bindIndex","uniformsOut","destroyPrograms","bindGroup","gpu","environments","loadEnvironmentExtensions","skip","env","unsafeEval","unsafeEvalSupported","earcut","holeIndices","dim","hasHoles","outerLen","outerNode","linkedList","triangles","invSize","eliminateHoles","earcutLinked","clockwise","last","signedArea","insertNode","equals","removeNode","filterPoints","again","area","ear","pass","indexCurve","stop","prev","next","isEarHashed","isEar","cureLocalIntersections","splitEarcut","ax","bx","cx","ay","by","cy","pointInTriangleExceptFirst","minZ","zOrder","maxZ","intersects","locallyInside","isValidDiagonal","splitPolygon","getLeftmost","compareXYSlope","eliminateHole","aSlope","bSlope","hole","bridge","findHoleBridge","bridgeReverse","hx","hy","qx","tanMin","pointInTriangle","tan","sectorContainsSector","sortLinked","numMerges","inSize","tail","q","pSize","qSize","leftmost","intersectsPolygon","middleInside","p1","p2","q1","q2","o1","o2","o3","o4","onSegment","num","inside","createNode","an","bp","sum","earcutModule","CLEAR","CLEAR2","SystemRunner","a0","a6","a7","items","defaultRunners","_AbstractRenderer","config","combinedRunners","systemName","deprecated","isRGBAArray","desiredScreenWidth","desiredScreenHeight","previousResolution","clear","clearColor","runnerIds","runnerId","systems","ClassRef","pipes","pipeAdaptors","adaptors","adaptor","pipe","PipeClass","Adaptor","runner","AbstractRenderer","_isWebGLSupported","isWebGLSupported","failIfMajorPerformanceCaveat","contextOptions","success","loseContext","_isWebGPUSupported","isWebGPUSupported","renderPriority","autoDetectRenderer","RendererClass","finalOptions","rendererType","WebGPURenderer","__vitePreload","WebGLRenderer","VERSION","ApplicationInitHook","RendererInitHook","_Application","plugin","rendererDestroyOptions","plugins","Application","AbstractBitmapFont","page","LRU","ttl","resetTtl","bypass","evicted","lru","genericFontFamilies","fontStringFromTextStyle","style","fontSizeString","fontFamilies","fontFamily","contextSettings","_CanvasTextMetrics","text","lines","lineWidths","lineHeight","maxLineWidth","fontProperties","wordWrap","textKey","font","lineWidth","measurements","letterSpacing","useExperimentalLetterSpacing","metrics","metricWidth","actualBoundingBoxLeft","boundsWidth","line","cache","whiteSpace","collapseSpaces","collapseNewlines","canPrependSpaces","wordWrapWidth","tokens","token","currIsBreakingSpace","lastIsBreakingSpace","tokenWidth","characters","char","lastChar","nextChar","characterWidth","isLastToken","newLine","_nextChar","_token","breakWords","_char","_index","_breakWords","properties","segmenter","segment","CanvasTextMetrics","emptyColorStops","_FillGradient","ensureGradientOptions","flip","temp","colorStops","defaultSize","getCanvas","gradient","addColorStops","dist","r0","FillGradient","repetitionMap","FillPattern","repetition","parseSvgPath","parse","_","command","parseValues","number","numbers","parseSVGPath","svgPath","commands","subpaths","currentSubPath","lastX","lastY","Circle","radius","outerWidth","distance","circle","Ellipse","halfWidth","halfHeight","normx","normy","strokeOuterWidth","strokeInnerWidth","innerHorizontal","innerVertical","outerHorizontal","outerVertical","normalizedX","normalizedY","innerEllipse","outerEllipse","ellipse","squaredDistanceToLineSegment","dot","lenSq","param","xx","yy","tempRect","tempRect2","Polygon","points","flat","il","polygon","thisBounds","otherBounds","xi","yi","xj","yj","strokeWidthSquared","rightWidthSquared","leftWidthSquared","iterationLength","distanceSquared","pointsDesc","currentPoint","isCornerWithinStroke","pX","pY","cornerX","cornerY","RoundedRectangle","radius2","innerX","innerY","innerWidth","innerHeight","rightBound","bottomBound","cachedGroups","getTextureBatchBindGroup","maxTextures","generateTextureBatchBindGroup","bindGroupResources","ViewableBuffer","sizeOrBuffer","fastCopy","sourceBuffer","destinationBuffer","lengthDouble","sourceFloat64View","remainingBytes","sourceUint8View","BLEND_TO_NPM","STENCIL_MODES","STENCIL_MODES2","getAdjustedBlendModeBlend","blendMode","fragTemplate","generateIfTestSrc","maxIfs","checkMaxIfStatementsInShader","shader","fragmentSrc","maxTexturesPerBatchCache","getMaxTexturesPerBatch","BatchTextureArray","Batch","batchPool","batchPoolIndex","getBatchFromPool","returnBatchToPool","batch","BATCH_TICK","_Batcher","attributesInitialSize","indicesInitialSize","batchableObject","textureId","attributeBuffer","elements","textureBatch","firstElement","topology","f32","u32","indexBuffer","action","element","adjustedBlendMode","breakRequired","indexStart","indexSize","newSize","newArrayBuffer","newIndexBuffer","indicesOffset","indices","indexOffset","attributeOffset","Batcher","BufferUsage","BufferUsage2","usage","shrinkToFit","mappedAtCreation","syncGPU","oldData","sizeInBytes","ensureIsBuffer","Buffer","getGeometryBounds","geometry","attributeId","attribute","byteSize","stride","ensureIsAttribute","Geometry","attributes","attributeOption","destroyBuffers","placeHolderBufferData","placeHolderIndexData","BatchGeometry","addBits","srcParts","parts","part","sanitisedPart","findHooksRx","compileHooks","programSrc","hook","extractInputs","fragmentSource","compileInputs","fragments","template","sort","mainInput","finalString","inValue","cleanedString","extractOutputs","extractVariableName","stripVariable","compileOutputs","mainStruct","mainStart","mainEnd","compiledCode","injectBits","templateSrc","fragmentParts","bitCacheMap","CACHE_UID","compileHighShader","bits","cacheId","generateCacheId","compileInputsAndOutputs","compileBits","compileHighShaderGl","vertexFragments","shaderBit","fragmentFragments","compiledVertex","compiledFragment","highFragment","vertexParts","vertexGPUTemplate","fragmentGPUTemplate","vertexGlTemplate","fragmentGlTemplate","globalUniformsBit","globalUniformsBitGl","compileHighShaderGpuProgram","compileHighShaderGlProgram","colorBit","colorBitGl","textureBatchBitGpuCache","generateBindingSrc","bindingIndex","generateSampleSrc","generateTextureBatchBit","textureBatchBitGlCache","generateSampleGlSrc","generateTextureBatchBitGl","roundPixelsBit","roundPixelsBitGl","batchSamplersUniformGroupHash","getBatchSamplersUniformGroup","batchSamplersUniformGroup","sampleValues","DefaultShader","defaultShader","_DefaultBatcher","float32View","uint32View","textureIdAndRound","wt","positions","argb","i2","w0","w1","h0","h1","DefaultBatcher","buildUvs","vertices","verticesStride","verticesOffset","uvsOffset","uvsStride","buildSimpleUvs","transformVertices","BatchableGraphics","rgb","gpuBuffer","buildCircle","shape","rx","ry","roundedRect","j1","j2","j3","j4","y22","x12","x22","y12","centerX","centerY","centerIndex","buildEllipse","buildRoundedRectangle","closePointEps","curveEps","getOrientationOfPoints","square","innerWeight","outerWeight","verts","ix","iy","exx","eyy","eix","eiy","eox","eoy","round","ex","ey","cx2p0x","cy2p0y","angle0","angle1","startAngle","angleDiff","absAngleDiff","segCount","angleInc","buildLine","lineStyle","flipAlignment","closed","orientation","firstPoint","lastPoint","closedShape","closedPath","midPointX","midPointY","indexCount","widthSquared","miterLimitSquared","perpX","perpY","perp1x","perp1y","ratio","dx0","dy0","dx1","dy1","cross","pDist","imx","imy","omx","omy","smallerInsideSegmentSq","insideWeight","smallerInsideDiagonalSq","eps2","buildPixelLine","fx","fy","lx","ly","closePath","triangulateWithHoles","holes","emptyArray","buildPolygon","buildRectangle","rectData","verticesIndex","buildTriangle","tempTextureMatrix","generateTextureMatrix","textureMatrix","mTx","mTy","sourceStyle","shapeBuilders","buildContextBatches","gpuContext","geometryData","batches","addTextureToGeometryData","isStroke","shapePath","addShapePathToGeometryData","build","vertOffset","textureUvs","graphicsBatch","close","otherPoints","getHoleArrays","holePoints","holePrimitives","holeArrays","holePrimitive","GpuGraphicsContext","GraphicsContextRenderData","_GraphicsContextSystem","batchMode","graphicsData","vertexSize","batcher","drawBatches","GraphicsContextSystem","RECURSION_LIMIT","FLT_EPSILON","PATH_DISTANCE_EPSILON","buildAdaptiveBezier","sX","sY","cp1x","cp1y","cp2x","cp2y","eX","eY","smoothness","smoothing","distanceTolerance","begin","recursive","x3","y3","x4","y4","level","x23","y23","x34","y34","x123","y123","x234","y234","x1234","y1234","d3","buildAdaptiveQuadratic","buildArc","steps","cs","sn","buildArcTo","fromX","mm","dd","cc","tt","k1","k2","qy","endAngle","TAU","mapToEllipse","cosPhi","sinPhi","xp","yp","approxUnitArc","ang1","ang2","vectorAngle","getArcCenter","largeArcFlag","sweepFlag","pxp","pyp","rxSq","rySq","pxpSq","pypSq","radicant","centerXp","centerYp","vx1","vy1","vx2","vy2","buildArcToSvg","xAxisRotation","lambda","outCurvePoint","curve","roundedShapeArc","vecFrom","pp","sharpCorner","pRadius","p3","v1","v2","radDirection","drawDirection","halfAngle","cRadius","lenOut","roundedShapeQuadraticCurve","pointLerp","numPoints","thisPoint","nextPoint","lastEdgeLength","lastOffsetDistance","nextEdgeLength","nextOffsetDistance","tempRectangle","ShapePath","graphicsPath2D","fromY","counterclockwise","currentPoly","shapePrimitives","mainShape","shapePrimitive","mainPolygon","sides","corner","sideLength","internalAngle","useQuadratic","fillet","maxFillet","inset","dir","chamfer","radiusX","radiusY","lastShape","tempX","boundsRect","GraphicsPath","instructions","signed","currentX","currentY","cpx1","cpy1","innerRadius","newGraphicsPath2D","cpx2","cpy2","adjustTransform","lastInstruction","currentMatrix","parseSVGFloatAttribute","svg","defaultValue","parseSVGDefinitions","session","definitions","definition","parseLinearGradient","parseRadialGradient","gradientUnit","_child","extractSvgUrlId","styleAttributes","parseSVGStyle","strokeStyle","fillStyle","parseAttribute","styleParts","stylePart","id2","checkForNestedPattern","subpathsWithArea","areas","largestArea","secondArea","smallestArea","largestToSecondRatio","secondToSmallestRatio","extractSubpaths","pathData","calculatePathArea","coords","xs","ys","appendSVGPath","graphicsPath","tempPath","SVGParser","graphicsContext","div","renderChildren","f1","s1","noStyle","pointsString","fillRule","hasExplicitEvenodd","hasMultipleSubpaths","subpath","isMainShape","newPath","isHole","useEvenoddForGraphicsPath","isColorLike","isFillPattern","isFillGradient","isTexture","handleColorLike","fill","defaultStyle","handleTexture","handleFillPattern","handleFillGradient","handleFillObject","toFillStyle","objectStyle","toStrokeStyle","miterLimit","cap","join","pixelLine","tmpPoint","_GraphicsContext","clone","tint","dw","dh","holePath","transformedX","transformedY","cpx","cpy","state","outerPadding","_bounds","hasHit","shapes","transformedPoint","holeShapes","GraphicsContext","_TextStyle","convertV7Tov8Style","fullStyle","thisKey","filterPadding","_c","_d","cb","property","newValue","TextStyle","oldStyle","defaults","gradientFill","fillGradientStops","fills","CanvasPoolClass","canvasOptions","minWidth","minHeight","canvasAndContext","CanvasPool","PRECISION","getCanvasFillStyle","textMetrics","padding","fillPattern","pattern","fillGradient","isLinear","isLocal","isNearlyVertical","center","outerCenter","outerRadius","globalStop","_DynamicBitmapFont","dynamicOptions","requestedFontSize","chars","charList","self","pageData","currentMaxCharHeight","fontScale","skipTexture","maxTextureWidth","maxTextureHeight","textureGlyphWidth","paddedWidth","paddedHeight","pageData2","xAdvance","newChars","measureCache","first","second","amount","textureResolution","stroke","strokeThickness","shadowOptions","dropShadowBlur","dropShadowDistance","descent","removeShadow","shadowBlur","shadowOffsetX","shadowOffsetY","DynamicBitmapFont","getBitmapTextLayout","trimEnd","layoutData","currentLine","previousChar","firstWord","currentWord","adjustedLetterSpacing","adjustedWordWrapWidth","adjustedLineHeight","nextWord","word","nextLine","checkIsOverflow","isEnd","charData","spaceWidth","kerning","nextCharWidth","alignCenter","alignRight","alignJustify","measurementData","indy","spaceIndex","totalSpaces","resolveCharacters","startCode","endCode","fontCount","BitmapFontManagerClass","fontFamilyKey","overrideFill","styleCopy","fnt","dynamicFont","bitmapFont","textStyle","flatChars","cacheKey","BitmapFontManager","BitmapFont","textureFrame","textureRotate","bitmapFontTextParser","txt","rawData","attributeList","itemData","strValue","floatValue","info","common","distanceField","charNode","letter","bitmapFontXMLParser","bitmapFontXMLStringParser","validExtensions","bitmapFontCachePlugin","loadBitmapFont","bitmapFontData","pages","textureUrls","pageFile","loadedTextures","_options","BackgroundLoader","verbose","assetUrls","toLoad","toLoadAmount","cacheTextureArray","testImageFormat","imageData","image","blob","detectAvif","formats","imageFormats","detectDefaults","inWorker","testVideoFormat","mimeType","detectMp4","detectOgv","detectWebm","detectWebp","_Loader","parserX","parser2","assetsToLoadIn","onProgressOrOptions","onProgress","onError","strategy","retryCount","retryDelay","assetsToLoad","assetsToUnloadIn","loadPromise","loadedAsset","hash","attempt","wait","ms","isLast","Loader","checkDataUrl","mimes","mime","checkExtension","tempURL","validJSONExtension","validJSONMIME","loadJson","validTXTExtension","validTXTMIME","loadTxt","validWeights","validFontExtensions","validFontMIMEs","CSS_IDENT_TOKEN_REGEX","getFontFamilyName","nameTokens","valid","fontFamilyName","validURICharactersRegex","encodeURIWhenNeeded","uri","loadWebFont","fonts","fontFaces","weights","weight","cached","entry","getResolutionOfUrl","createTexture","unload","validSVGExtension","validSVGMIME","loadSvg","loadAsGraphics","loadAsTexture","crossOrigin","response","canvasWidth","canvasHeight","_p","svgSource","WORKER_CODE","WORKER_URL","WorkerInstance","UUID","MAX_WORKERS","WorkerManagerClass","worker","WorkerInstance$1","toDo","WorkerManager","validImageExtensions","validImageMIMEs","loadImageBitmap","imageBlob","loadTextures","potentialVideoExtensions","validVideoExtensions","validVideoMIMEs","crossorigin","determineCrossOrigin","preloadVideo","loaded","error","cleanup","err","loc","parsedUrl","getBrowserSupportedVideoExtensions","supportedExtensions","supportedMimes","loadVideoTextures","ve","vm","isValidDataUrl","isValidExtension","videoElement","attributeMap","sourceElement","onCanPlay","resolveTextureUrl","resolveJsonUrl","AssetsClass","resolutionPref","urls","urlArray","resolveResults","counts","_onProgress","resolveResult","values","resolveResult2","progressOrLoadOptions","resolveArray","loadedAssets","detection","preferences","Assets","assetKeyMap","ref","Graphics","method","AbstractText","styleClass","ensureTextOptions","_internalCanvas","_internalContext","ensureInternalCanvas","checkRow","checkColumn","getCanvasBoundingBox","output","CanvasTextGeneratorClass","measured","linePositionX","linePositionY","passesCount","isShadowPass","dsOffsetText","dsOffsetShadow","dropShadowColor","dropShadowAlpha","strokePadding","linePositionYShift","currentPosition","stringArray","previousWidth","currentWidth","currentChar","textStr","CanvasTextGenerator","Text","canvasMeasurement","DEFAULT_CHARACTER","DEFAULT_TYPE","DEFAULT_RARITY","toTitleCase","trimmed","extractCharacterFromId","cardId","resolveCardMeta","card","rawId","character","rarity","getCardImagePath","getCardImagePathFallback","ko","en","bundles","LOCALE_STORAGE_KEY","currentLocale","missingKeys","setLocale","locale","validLocale","translated","getCurrentLocale","createStoreImpl","createState","setState","partial","nextState","previousState","getState","api","initialState","__vite_import_meta_env__","createStore","REACT_ELEMENT_TYPE","REACT_PORTAL_TYPE","REACT_FRAGMENT_TYPE","REACT_STRICT_MODE_TYPE","REACT_PROFILER_TYPE","REACT_CONSUMER_TYPE","REACT_CONTEXT_TYPE","REACT_FORWARD_REF_TYPE","REACT_SUSPENSE_TYPE","REACT_MEMO_TYPE","REACT_LAZY_TYPE","REACT_ACTIVITY_TYPE","MAYBE_ITERATOR_SYMBOL","getIteratorFn","maybeIterable","ReactNoopUpdateQueue","assign","emptyObject","Component","props","updater","partialState","ComponentDummy","PureComponent","pureComponentPrototype","isArrayImpl","noop","ReactSharedInternals","hasOwnProperty","ReactElement","refProp","cloneAndReplaceKey","oldElement","newKey","isValidElement","object","escape","escaperLookup","userProvidedKeyEscapeRegex","getElementKey","resolveThenable","thenable","fulfilledValue","mapIntoArray","escapedPrefix","nameSoFar","invokeCallback","nextNamePrefix","mapChildren","lazyInitializer","payload","ctor","moduleObject","reportGlobalError","Children","forEachFunc","forEachContext","react_production","propName","childArray","childrenLength","render","compare","scope","prevTransition","currentTransition","returnValue","onStartTransitionFinish","usable","permalink","deps","Context","initialValue","create","passthrough","reducer","initialArg","subscribe","getSnapshot","getServerSnapshot","reactModule","require$$0","React","is","objectIs","useState","useEffect","useLayoutEffect","useDebugValue","useSyncExternalStore$2","_useState","inst","forceUpdate","checkIfSnapshotChanged","latestGetSnapshot","nextValue","useSyncExternalStore$1","shim","useSyncExternalStoreShim_production","shimModule","require$$1","useSyncExternalStore","useRef","useMemo","withSelector_production","selector","isEqual","instRef","memoizedSelector","nextSnapshot","hasMemo","memoizedSnapshot","currentSelection","memoizedSelection","nextSelection","maybeGetServerSnapshot","withSelectorModule","ReactExports","useSyncExternalStoreWithSelector","useSyncExternalStoreExports","didWarnAboutEqualityFn","identity","useStore","equalityFn","slice","createImpl","useBoundStore","extendStatics","__extends","__","__assign","__rest","__decorate","decorators","desc","__param","paramIndex","decorator","__esDecorate","descriptorIn","contextIn","initializers","extraInitializers","accept","kind","descriptor","done","__runInitializers","thisArg","useValue","__propKey","__setFunctionName","__metadata","metadataKey","metadataValue","__awaiter","_arguments","P","generator","adopt","fulfilled","step","rejected","__generator","body","verb","op","__createBinding","__exportStar","__values","__read","ar","__spread","__spreadArrays","jl","__spreadArray","to","pack","__await","__asyncGenerator","awaitReturn","resume","settle","fulfill","__asyncDelegator","__asyncValues","__makeTemplateObject","cooked","raw","__setModuleDefault","ownKeys","__importStar","mod","__importDefault","__classPrivateFieldGet","receiver","__classPrivateFieldSet","__classPrivateFieldIn","__addDisposableResource","async","dispose","inner","_SuppressedError","suppressed","__disposeResources","fail","__rewriteRelativeImportExtension","preserveJsx","tsx","cm","tslib_es6","resolveFetch","customFetch","FunctionsError","FunctionsFetchError","FunctionsRelayError","FunctionsHttpError","FunctionRegion","FunctionsClient","headers","region","functionName_1","functionName","functionArgs","signal","_headers","fetchError","isRelayError","responseType","PostgrestError_1","PostgrestError","PostgrestBuilder_1","PostgrestBuilder","builder","onfulfilled","onrejected","_fetch","status","statusText","countHeader","contentRange","PostgrestTransformBuilder_1","PostgrestTransformBuilder","columns","quoted","cleanedColumns","column","ascending","nullsFirst","foreignTable","referencedTable","existingOrder","keyOffset","keyLimit","analyze","settings","buffers","wal","forMediatype","PostgrestFilterBuilder_1","PostgrestReservedCharsRegexp","PostgrestFilterBuilder","patterns","cleanedValues","query","typePart","configPart","operator","filters","PostgrestQueryBuilder_1","PostgrestQueryBuilder","schema","fetch","defaultToNull","uniqueColumns","onConflict","ignoreDuplicates","PostgrestClient_1","tslib_1","require$$2","PostgrestClient","relation","get","cjs","require$$3","require$$4","require$$5","require$$6","_default","index.default","WebSocketFactory","processVersions","versionString","nodeVersion","errorMessage","protocols","WS","DEFAULT_VERSION","VSN","DEFAULT_TIMEOUT","WS_CLOSE_NORMAL","MAX_PUSH_BUFFER_SIZE","SOCKET_STATES","CHANNEL_STATES","CHANNEL_EVENTS","TRANSPORTS","CONNECTION_STATE","Serializer","rawPayload","view","decoder","topicSize","eventSize","topic","Timer","timerCalc","PostgresTypes","convertChangeData","record","skipTypes","rec_key","convertColumn","columnName","colType","convertCell","dataType","toArray","toBoolean","toNumber","toJson","toTimestampString","parsedValue","lastIdx","closeBrace","valTrim","httpEndpointURL","socketUrl","wsUrl","Push","channel","timeout","REALTIME_PRESENCE_LISTEN_EVENTS","RealtimePresence","newState","onJoin","onLeave","onSync","diff","currentPresences","newPresences","leftPresences","currentState","transformedState","joins","leaves","presences","newPresenceRefs","curPresenceRefs","joinedPresences","joinedPresenceRefs","curPresences","presenceRefsToRemove","presence","REALTIME_POSTGRES_CHANGES_LISTEN_EVENT","REALTIME_LISTEN_TYPES","REALTIME_SUBSCRIBE_STATES","RealtimeChannel","params","socket","pushEvent","reason","broadcast","isPrivate","postgres_changes","presence_enabled","accessTokenPayload","clientPostgresBindings","bindingsLen","newPostgresBindings","clientPostgresBinding","table","filter","serverPostgresFilter","authorization","errorBody","endpoint_payload","push","onClose","leavePush","controller","removedPush","_event","_ref","typeLower","leave","handledPayload","bind","_e","_f","bindId","bindEvent","postgresChanges","commit_timestamp","errors","binding","obj1","obj2","records","Transformers.convertChangeData","CONNECTION_TIMEOUTS","RECONNECT_INTERVALS","DEFAULT_RECONNECT_FALLBACK","WORKER_SCRIPT","RealtimeClient","endPoint","fallbackTimer","values_1","msg","realtimeTopic","exists","chan","newRef","dupChannel","rawMessage","refString","timer","objectUrl","result_url","manual","tokenToSend","_g","_h","_j","tries","StorageError","isStorageError","StorageApiError","statusCode","StorageUnknownError","originalError","resolveResponse","recursiveToCamel","el","isPlainObject","prototype","_getErrorMessage","handleError","Res","_getRequestParams","parameters","_handleRequest","fetcher","post","put","remove","StreamDownloadBuilder","downloadFn","shouldThrowOnError","BlobDownloadBuilder","onfinally","DEFAULT_SEARCH_OPTIONS","DEFAULT_FILE_OPTIONS","StorageFileApi","bucketId","fileBody","fileOptions","metadata","cleanPath","_path","fromPath","toPath","expiresIn","downloadQueryParam","paths","datum","renderPath","transformationQuery","queryString","_queryString","DEFAULT_HEADERS","StorageBucketApi","id_1","StorageAnalyticsApi","queryParams","StorageVectorsError","isStorageVectorsError","StorageVectorsApiError","StorageVectorsUnknownError","StorageVectorsErrorCode","responseError","contentType","VectorIndexApi","vectorBucketName","indexName","VectorDataApi","VectorBucketApi","StorageVectorsClient","VectorBucketScope","_super","VectorIndexScope","StorageClient","JS_ENV","DEFAULT_GLOBAL_OPTIONS","DEFAULT_DB_OPTIONS","DEFAULT_AUTH_OPTIONS","DEFAULT_REALTIME_OPTIONS","resolveHeadersConstructor","fetchWithAuth","supabaseKey","getAccessToken","HeadersConstructor","accessToken","ensureTrailingSlash","applySettingDefaults","dbOptions","authOptions","realtimeOptions","globalOptions","validateSupabaseUrl","supabaseUrl","trimmedUrl","AUTO_REFRESH_TICK_DURATION_MS","AUTO_REFRESH_TICK_THRESHOLD","EXPIRY_MARGIN_MS","GOTRUE_URL","STORAGE_KEY","API_VERSION_HEADER_NAME","API_VERSIONS","BASE64URL_REGEX","JWKS_TTL","AuthError","isAuthError","AuthApiError","isAuthApiError","AuthUnknownError","CustomAuthError","AuthSessionMissingError","isAuthSessionMissingError","AuthInvalidTokenResponseError","AuthInvalidCredentialsError","AuthImplicitGrantRedirectError","details","isAuthImplicitGrantRedirectError","AuthPKCEGrantCodeExchangeError","AuthRetryableFetchError","isAuthRetryableFetchError","AuthWeakPasswordError","reasons","AuthInvalidJwtError","TO_BASE64URL","IGNORE_BASE64URL","FROM_BASE64URL","charMap","byteToBase64URL","byte","emit","byteFromBase64URL","charCode","stringFromBase64URL","conv","utf8Emit","codepoint","utf8State","b64State","byteEmit","stringFromUTF8","codepointToUTF8","stringToUTF8","highSurrogate","leadingBit","base64UrlToUint8Array","onByte","stringToUint8Array","bytesToBase64URL","bytes","onChar","expiresAt","uuid","isBrowser","localStorageWriteTests","supportsLocalStorage","randomKey","parseParametersFromURL","href","looksLikeFetchResponse","maybeResponse","setItemAsync","storage","getItemAsync","removeItemAsync","Deferred","rej","decodeJWT","sleep","retryable","isRetryable","dec2hex","dec","generatePKCEVerifier","charSet","charSetLen","verifier","sha256","randomString","encodedData","generatePKCEChallenge","hashed","getCodeChallengeAndMethod","storageKey","isPasswordRecovery","codeVerifier","storedCodeVerifier","codeChallenge","API_VERSION_REGEX","parseResponseAPIVersion","apiVersion","validateExp","exp","timeNow","getAlgorithm","alg","UUID_REGEX","validateUUID","userNotAvailableProxy","proxyTarget","prop","sProp","_target","insecureUserWarningProxy","user","suppressWarningRef","deepClone","NETWORK_ERROR_CODES","errorCode","responseAPIVersion","_request","qs","requestParams","_sessionResponse","hasSession","_sessionResponsePassword","_userResponse","_ssoResponse","_generateLinkResponse","action_link","email_otp","hashed_token","redirect_to","verification_type","_noResolveJsonResponse","SIGN_OUT_SCOPES","GoTrueAdminApi","jwt","email","pagination","users","links","link","rel","shouldSoftDelete","factors","clients","client","clientId","memoryLocalStorageAdapter","store","internals","LockAcquireTimeoutError","NavigatorLockAcquireTimeoutError","navigatorLock","acquireTimeout","abortController","lock","polyfillGlobalThis","getAddress","address","fromHex","hex","toHex","createSiweMessage","chainId","domain","expirationTime","issuedAt","nonce","notBefore","requestId","scheme","statement","suffix","content","WebAuthnError","cause","WebAuthnUnknownError","identifyRegistrationError","publicKey","effectiveDomain","isValidDomain","identifyAuthenticationError","WebAuthnAbortService","abortError","newController","webAuthnAbortService","deserializeCredentialCreationOptions","challengeStr","userOpts","excludeCredentials","restOptions","challenge","cred","deserializeCredentialRequestOptions","allowCredentials","serializeCredentialCreationResponse","credential","credentialWithAttachment","serializeCredentialRequestResponse","clientExtensionResults","assertionResponse","hostname","browserSupportsWebAuthn","createCredential","getCredential","DEFAULT_CREATION_OPTIONS","DEFAULT_REQUEST_OPTIONS","deepMerge","isObject","isArrayBufferLike","existing","mergeCredentialCreationOptions","baseOptions","overrides","mergeCredentialRequestOptions","WebAuthnApi","factorId","webauthn","friendlyName","challengeResponse","challengeError","abortSignal","challengeId","rpId","rpOrigins","factor","enrollError","DEFAULT_OPTIONS","lockNoOp","GLOBAL_JWKS","GoTrueClient","callbackUrlType","redirectType","credentials","password","codeChallengeMethod","phone","invalidTokenError","authCode","chain","_k","_l","signature","wallet","resolvedWallet","windowAny","accounts","accs","chainIdHex","siweMessage","_m","outputToProcess","maybeSignature","storageItem","provider","access_token","redirectTo","captchaToken","sessionError","endpoint","waitOn","currentSession","maybeSession","hasExpired","maybeUser","sessionData","userError","refreshedSession","provider_token","provider_refresh_token","refresh_token","expires_in","expires_at","token_type","actuallyExpiresIn","currentStorageContent","subscription","refreshToken","debugName","startedAt","nextBackOffInterval","separateUser","expiresWithMargin","getUserError","sessionToProcess","userIsProxy","mainSessionData","clonedMainSessionData","clonedSession","now","expiresInTicks","calledFromInitialize","methodName","urlParams","flowParams","challengeData","currentLevel","nextLevel","currentAuthenticationMethods","authorizationId","kid","jwks","jwk","header","rawHeader","signingKey","algorithm","AuthClient","SupabaseAuthClient","SupabaseClient","defaultStorageKey","DEFAULTS","SupabaseStorageClient","autoRefreshToken","persistSession","detectSessionInUrl","userStorage","flowType","debug","throwOnError","authHeaders","createClient","shouldShowDeprecationWarning","processVersion","versionMatch","supabaseAnonKey","SUPABASE_URL","SUPABASE_ANON_KEY","SUPABASE_CLIENT_KEY","globalScope","supabase","campaignStageData","createInitialCampaignStages","stage","mapDialogueLine","pendingDeckSave","scheduleDeckSave","triggerCloudSave","generateUuid","vfxCallback","cardUseAnimationCallback","handTrackingResetCallback","enemyHandUpdateCallback","enemyTurnTimer1","enemyTurnTimer2","enemyTurnTimer3","endTurnTimer","pvpPollTimer","pvpUnloadCleanup","pvpTurnTimerInterval","DEFAULT_PVP_TURN_DURATION","CLOUD_SAVE_EVENT","clampDeckSnapshot","cards","normalizeCardId","withoutSnapshot","rehydrateCardFromPool","baseId","canonical","candidate","rehydrateCardsFromPool","getDeckSnapshot","buildDeckFromSnapshot","snapshot","baseMap","generated","LCG_A","LCG_C","LCG_M","mixSeeds","salt","seed","nextSeed","generateRoundSeed","baseSeed","phase","mixed","getSeededRandom","counter","serializeCard","cost","effects","keywords","effectText","levelCurve","vfxKey","sfxKey","deserializeCard","serialized","clearPvpPolling","detachPvpUnloadCleanup","registerPvpUnloadCleanup","userId","restEndpoint","handler","setVFXCallback","setCardUseAnimationCallback","setHandTrackingResetCallback","setEnemyHandUpdateCallback","notifyEnemyHandUpdate","triggerVFX","STATUS_VFX_MAP","triggerStatusVFX","mapped","triggerCardUseAnimation","isPlayerCard","handIndex","STAGE_REWARD_SETTINGS","getBoostedStageReward","reward","stageId","isRepeat","goldBase","shardsBase","getTodayKey","formatted","createSeededRandom","generateDailyDungeonFloors","dateKey","stages","rand","pickStage","early","mid","late","floor1Stage","floor2Stage","floor3Stage","initialEntityStatus","getEnemyDeckForStage","allCards","campaignStages","getBasicEnemyDeck","enemyImage","characterName","extractCharacterNameFromImage","availableCards","extractCharacterFromCardId","fallbackCards","normalCards","rareCards","epicCards","legendaryCards","attackCards","defenseCards","healCards","specialCards","deck","timestamp","cardIndex","attackCount","shuffledAttack","defenseCount","shuffledDefense","healCount","shuffledHeal","specialCount","shuffledSpecial","remaining","deckBaseId","cardBaseId","needed","shuffled","STARTER_DECK_CARD_IDS","RANK_TIERS","RANK_LEVELS","WINS_PER_RANK","PVP_RANKS","ranks","winThreshold","tier","getPvpRankInfo","wins","cappedWins","rank","nextRank","getInitialDeck","initialCardIds","cardMap","initialDeck","useBattleStore","set","screen","history","replay","packType","roll","selectedRarity","cumulative","rate","cardPool","randomIndex","selectedCard","newCollection","forceRestart","duration","resetState","isPvp","deckSnapshot","queuePayload","upsertResult","opponentRes","opponent","matchId","insertedMatch","opponentProfile","opponentDeckSnapshot","opponentDeckCards","queueRes","queueRow","matchRes","playerRole","opponentId","opponentSnapshot","ownSnapshot","cardsPool","outcome","subscribeError","currentRound","sendStatus","remote","after","matchSeed","nextRound","nextPlayerEnergy","nextEnemyEnergy","turnDuration","updatedStages","isRepeatClear","baseReward","boostedReward","today","floors","floorId","daily","floorIndex","floor","completed","hydrated","allCardsPool","rehydratedCollection","rehydratedDeck","currentDeck","newCardKey","sameCardCount","ownedCount","newDeck","collection","canonicalMap","rarityScore","typeScore","entries","sortedCards","primary","baseCost","costScore","tagScore","score","typeTargets","duplicateCounts","typeCounts","legendaryCap","legendaryCount","performAdd","canonicalId","currentCount","candidates","sortedEntries","rarityOrder","costDiff","rarityDiff","missing","cardCounts","newLogs","stacks","chance","existingIndex","newStatuses","stackValue","baseStacks","baseValue","newStatus","regenEffect","regenValue","statusName","eff","damage","damagePerStack","healAmount","newDuration","regenStatus","vulnerableStatus","bleedStatus","baseDamage","tickPlayer","tickEnemy","headerLabel","playerBurns","enemyBurns","updates","footerLabel","skipGameOverCheck","disableReactive","targetLabel","opponentLabel","getStatus","setStatus","chargesLeft","finalAmount","hasVulnerable","markActive","prevShield","remainingShield","hpDamage","newHp","vulnerableText","guardText","shieldText","counterDamage","reflectRatio","shieldRatio","reflectDamage","shieldGain","updatedStatus","postStatus","currentDamage","currentStage","enemyDeck","initialSeed","playerEnergyBonus","enemyEnergyBonus","playerShieldBonus","enemyShieldBonus","ruleMessages","afterState","queued","nextQueue","nextQueued","delay","priorityMap","pq","handIdx","eq","playerPriorityBonus","enemyPriorityBonus","combined","idx","seedA","typeLabel","who","actualHandIndex","finalState","discard","hand","drawn","newDiscard","maxHandSize","beforeHand","afterHand","overflow","discarded","enemyDiscard","enemyHand","beforeEnemyHand","afterEnemyHand","newEnergy","newHand","newEnemyStatus","turns","playerStatus","hits","lifestealRatio","finalValue","attackBuff","shockStacks","procChance","damageRatio","chainDamage","remainingDamages","aoe","targetOverride","hitIndex","skipGameOver","dealt","targetSide","overflowToShield","currentHp","maxHp","charges","reflectPct","shieldPct","guardBreak","shieldBreak","enemyStatus","prevGuard","percent","lastDamage","maxRecover","rawAmount","fromHand","acquired","resolvedFilter","pickCard","curr","picked","stat","maxStacks","times","targets","prevEff","prevDamage","prevFinalValue","condition","conditionMet","threshold","targetHp","targetMaxHp","thenEff","originalEffects","typeFilter","sourceDeck","cardType","copiedCard","fromHp","transferAmount","duplicate","dupEff","newPlayerStatus","hasHandCard","deckCopy","deckIndex","skipCheck","playerHand","playerDeck","newEnemyHand","energy","stateBefore","skipPlayerTurn","bonusEnergy","triggerEnemy","enemyHp","enemyMaxHp","playerHp","playerMaxHp","enemyHpRatio","playerHpRatio","keyword","midState","newRound","newSeed","remainingEnergy","remainingEnemyEnergy","enemyBonusEnergy","newEnemyEnergy","playableCards","cardScores","topCandidates","chosenCard","nextPlayable","nextScores","checkState","SAVE_VERSION","SAVE_TABLE","currentUserId","unsubscribeSync","saveTimer","lastSavedJson","pendingSaveJson","unloadHandlerRegistered","unloadHandler","currentSyncStatus","lastSaveTriggers","pendingSavedCollection","pendingSavedDeck","setCloudSyncStatus","debugInitialized","flushSaveImmediately","lastGold","lastShards","lastCollection","lastDeck","lastStage","selectPersistentState","campaignClears","clearedFloorIds","collectionEntries","aggregateCollection","deckEntries","aggregateDeck","getCanonicalCardId","limited","normalizeSavedCollection","normalizeSavedDeck","instantiateSavedEntries","limit","poolMap","copies","uniqueId","applySavedCardData","hydratedCollection","hydratedDeck","patch","makeDeckSignature","makeCollectionSignature","aId","bId","makeCampaignClearsSignature","makeDailySignature","clearedFloors","extractSaveTriggers","triggersChanged","loadCloudSave","rawBlob","parsed","parseError","persistCloudSave","save","applyCampaignClears","clears","clearedSet","applyCloudSave","legacyCollectionFormat","legacyDeckFormat","convertedSave","applyDailyProgressFromSave","scheduleSave","json","startSync","defaultSave","triggers","stopSync","handleAuthSessionChange","defaultNickname","normalizeNickname","resolveSessionNickname","meta","metaRecord","useAuthStore","metaNickname","nickname","sessionNickname","profileNickname","normalizedNickname","loadSampleCards","enrichCard","enriched","summarizeEffects","dmg","firstEffectValue","heal","charName","getCardImagePaths","baseName","loadSingleImage","webpPath","pngPath","preloadCardImages","startTime","uniqueCards","loadPromises","webp","png","iconPath","elapsed","getLoadedCardImage","getCardBackImage","CardPool","cardWidth","cardHeight","pooledCard","sprite","costText","typeIcon","nameText","newSprite","oldSprite","backgroundColor","oldIcon","iconSprite","isAffordable","oldCostText","playerHandPool","enemyHandPool","ParticleEmitter","life","fadeOut","speed","spread","randomAngle","randomSpeed","offsetX","VFXManager","brightColor","vfxManager","Easing","Tween","animate","progress","easedProgress","currentValue","TweenManager","tween","originalOnComplete","tweenManager","tweenNumber","onUpdate","AudioManager","audio","track","volume","effectiveVolume","fadeIn","targetVolume","currentVol","fadeInterval","muted","saved","audioManager","SoundPaths","initAudio","ToastManager","title","toastId","toast","icon","closeBtn","toastManager","LoadingManager","loadingManager","getSpecialBackground","variationNumber","clampedVariation","STARTER_COLLECTION_CARD_IDS_SAFE","app","updateBattleLayoutRef","layoutBattleBgRef","handContainerRef","appReady","lastViewportWidth","lastViewportHeight","layoutRefreshTimer","getViewportSize","vv","scheduleLayoutRefresh","applyViewportSize","updateViewportFlags","isLandscape","isCompactHeight","shouldApplyCompact","setAuthOverlayEnabled","requestAuthWithCallback","setupAuthUI","introRoot","menuRoot","menuUserInfoRoot","menuUserNicknameEl","menuUserStageEl","menuUserRankEl","menuButtons","deckEditorRoot","cardGalleryRoot","MOBILE_DECK_EDITOR_PAGES","currentMobileDeckEditorPage","campaignRoot","dailyRoot","rewardRoot","shopRoot","pvpRoot","tutorialOverlay","victoryScreen","defeatScreen","cloudSyncOverlay","cloudSyncText","cloudSyncHideTimer","pvpStatusText","pvpOpponentInfo","pvpOpponentName","pvpErrorText","pvpStatusIndicator","pvpSearchBtn","pvpCancelBtn","pvpBackBtn","announcementModal","announcementCloseButtons","announcementHasBeenShown","announcementDismissedPermanently","announcementRemindQueued","openAnnouncementModal","closeAnnouncementModal","button","HERO_PORTRAIT_MAP","DEFAULT_PLAYER_PORTRAIT","DEFAULT_ENEMY_PORTRAIT","PVP_DEFAULT_BACKGROUND","STORY_TOTAL_STAGE_TARGET","PVP_STATUS_LABELS","PVP_STATUS_CLASSES","resolveDeckPortrait","fallback","heroKey","topHero","showCloudSync","hideCloudSync","withDelay","performHide","CHARACTER_NAME_MAP","GENERIC_VICTORY_LINES","GENERIC_DEFEAT_TAUNTS","STAGE_VICTORY_LINES","STAGE_DEFEAT_TAUNTS","escapeHtml","pickRandom","getDisplayNameFromPortrait","portrait","cardPreview","closeCardPreview","tooltipRoot","hideTooltip","isBattleScreen","statusLabel","defaultMessage","noopAuthUI","_enabled","onAuthenticated","authScreen","authTitle","authError","authMessage","signInForm","signUpForm","logoutButton","signInEmail","signInPassword","signInSubmit","signUpEmail","signUpPassword","signUpNickname","signUpSubmit","toggleButtons","switchBlocks","authOverlayEnabled","pendingAuthCallback","btn","successMessage","inputs","updateAuthUIState","isAuthed","shouldShowOverlay","showForms","shouldShowLogout","block","visibleFor","disabled","enabled","lastSessionUserId","mode","isMobile","isLowEnd","performanceResolution","hud","controls","handRoot","logRoot","logToggle","cardPreviewImage","cardPreviewName","cardPreviewCost","cardPreviewEffects","cardPreviewKeywords","cardPreviewClose","optionsToggle","optionsPanel","optionsClose","optionsLanguage","optionsLogout","volumeMaster","volumeBGM","volumeSFX","volumeMasterVal","volumeBGMVal","volumeSFXVal","muteBtn","battleBgContainer","battleBgSprite","battleBgOverlay","currentBgPath","currentPlayerPortrait","currentEnemyPortrait","layoutBattleBg","updateBattleBackground","isPvpBattle","bgPath","audioSettings","closeOptionsPanel","updateLanguageButton","currentLang","newLocale","signOut","showCardPreview","effectsText","kw","badge","keywordDescriptions","showTooltip","keywordTexts","cardTypeKey","translatedType","roundSeed","gameOver","displayEnergy","displayPlayerHp","displayEnemyHp","formatStatus","badges","stacksText","renderHUD","gameOverText","displayPlayerHpInt","displayEnemyHpInt","renderControls","btnMenu","pvpBox","statusRow","localStatusColor","opponentStatusColor","rawRemaining","countdownActive","progressPercent","clampedPercent","timeColor","timerHeader","progressOuter","progressInner","barColor","infoText","declareInfo","queuedCount","reserved","btnEnd","logViewMode","logFilter","logSearchText","renderLog","viewToggle","searchInput","displayEntries","noResults","vfxContainer","createDeckContainer","isPlayer","isSmallMobile","bgWidth","bgHeight","bgHalfWidth","bgHalfHeight","shadow","characterBackground","characterSprite","cardBack1","cardBack2","cardBack3","countText","playerDeckData","playerDeckContainer","enemyDeckData","enemyDeckContainer","vsText","initDeckVisuals","cardBackPath","cardBackWidth","cardBackHeight","updateDeckVisuals","playerDeckSize","enemyDeckSize","playerPortraitPath","enemyPortraitPath","flashCharacterSprite","effectType","flashColor","getPosition","showCardUseAnimation","enemyHandContainer","playerHPBar","enemyHPBar","createHPBar","maxWidth","bgBar","hpBar","border","hpText","playerHPBarWidth","enemyHPBarWidth","playerHPComponents","enemyHPComponents","createEnergyBar","barHeight","fontSize","energyBar","energyText","playerEnergyBar","enemyEnergyBar","playerEnergyComponents","enemyEnergyComponents","playerStatusContainer","enemyStatusContainer","createStatusIcon","emoji","bg","durationText","updateStatusUI","statusIconMap","playerX","iconData","enemyX","updateHPBar","updateEnergyBar","updateBattleLayout","viewportWidth","viewportHeight","isLandscapeCompact","newPlayerHPBarWidth","newEnemyHPBarWidth","deckOffsetX","deckOffsetY","hpOffsetX","hpOffsetY","energyBarOffset","statusContainerOffset","baseHandOffset","prevPlayerHPForFlash","prevEnemyHPForFlash","flashHPBar","hpChange","flashAlpha","fadeOutDuration","flashOverlay","components","currentHP","maxHP","prevHP","targetWidth","currentEnergy","maxEnergy","enemyCardSprites","isRenderingEnemyHand","pendingEnemyRender","renderEnemyHand","cardsToShow","isDrawingEnemyCards","enemyCardsToRender","isMobileView","spacing","startX","placeholder","handContainer","handScrollData","updateHandScrollBounds","totalWidth","screenWidth","newX","cardSprites","isRenderingHand","pendingRender","cardImagePath","handCount","toX","toY","cardContainer","cardSprite","overlay","glow","glowSize","moveDuration","startTime0","moveToCenter","eased","expandCard","startTime1","startWidth","startHeight","targetHeight","expand","startTime2","shrink","animateCardDraw","targetPosition","deckContainer","startY","renderHand","isDrawingCards","cardsToRender","updatedCost","typeConfig","updatedIcon","st","isQueued","canDeclare","baseY","queuedY","queuedScale","longPressTimer","pointerDownTime","pointerDownPos","pressDuration","moveDistance","gameInitialized","victoryDefeatTimer","getInitialCollection","storeState","isLoggedIn","initialCollection","renderDeckEditor","validity","costDistribution","deckCardCounts","deckColumnMinWidth","collectionMinWidth","collectionGap","deckGap","totalCost","averageCost","uniqueDeckCards","deckErrorsMarkup","deckStatusSummaryMarkup","costChartMarkup","deckSummaryMarkup","headerHTML","contentHTML","pageLabels","isActive","menuBtn","galleryBtn","renderCardGallery","autoBtn","targetPage","collectionGrid","tryAddCardToDeck","mobileMinWidth","inDeckCount","cardDiv","cardImg","countBadge","touchStartTime","suppressClickAfterTouch","touchStartX","touchStartY","touchMoved","moveX","moveY","deltaX","deltaY","deckList","mobileDeckWidth","removeBtn","cardsByType","rarityColors","backBtn","grid","aOrder","bOrder","rarityBadge","renderDailyDungeon","dailyDungeon","gold","shards","todayKey","nextResetDisplay","baseDate","nextReset","month","day","totalFloors","allCleared","floorsMarkup","isLocked","buttonLabel","rewardsMarkup","modifiers","prevCleared","renderCampaign","chaptersRoot","chapterDefinitions","stageIndexMap","chapter","chapterStages","clearedCount","chapterSection","stagesGrid","stageIndex","stageCard","rewardText","storyBtn","showStoryModal","showCutscene","existingModal","modal","modalContent","backgroundDiv","textContent","startBtn","escHandler","renderReward","resolveStageContext","description","itemsHtml","hasItems","claimBtn","currentStageId","currentTutorialStep","tutorialSteps","showTutorial","onComplete","renderTutorial","totalSteps","nextBtn","completeBtn","skipBtn","nextTutorial","skipTutorial","keyHandler","cutsceneRoot","screenTransitionOverlay","currentDialogueIndex","currentDialogueLines","cutsceneCallback","dialogues","backgroundImage","renderCutscene","dialogue","totalLines","nextDialogue","skipCutscene","subtitle","buildVictoryDialogue","authState","speaker","stageLines","buildDefeatDialogue","showVictoryScreen","randomVariation","backgroundPath","hasReward","continueBtn","showDefeatScreen","retryBtn","gachaResultModal","renderShop","cardPacks","packVisuals","closeBtnOld","packsGrid","packDiv","visuals","priceIcon","canAfford","priceClass","buyBtn","playGachaAnimation","cardWrapper","cardBackImg","cardFrontImg","resultInfo","resultName","resultRarity","showGachaResult","rarityNames","check","shakeDuration","shakeSteps","intensity","handleClose","cardDisplay","INTRO_SLIDES","INTRO_TYPE_BY_CODE","INTRO_RARITY_BY_CODE","INTRO_FINALE_CARD_INTERVAL","INTRO_FINALE_STACK_BUFFER","INTRO_FINALE_FLASH_HOLD","introSlidesData","currentIntroPage","introTimeouts","introFinalePlaying","introTitleShowing","clearIntroTimers","scheduleIntroTimer","renderIntroCards","slide","layer","cardEl","resolveCardAssetFromId","shuffleArray","copy","updateMenuUserInfo","battleState","stageListCount","totalStages","clearedByFlag","clearedByIds","clearedStages","rankInfo","rankText","getAssetPathForCard","buildFinaleCardAssets","rarityBuckets","selected","used","takeFromBucket","bucket","allAssets","playIntroFinale","showIntroTitle","cardAssets","totalCards","offsetY","totalDuration","flash","renderIntro","showNextIntroPage","textElement","typeWriterEffect","completeText","elementId","lastIndex","partIndex","charIndex","typeNext","currentPart","titleText","isInitialLoad","transitionToScreen","skipTransition","updateScreenVisibility","previousScreen","pendingUIUpdate","screenToRender","scheduleUIUpdate","prevDeckLength","prevHandLength","prevEnemyHandLength","drawAnimationTimers","enemyDrawAnimationTimers","targetScreen","newCards","targetHandSize","targetX","targetY"],"ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313],"sources":["../../node_modules/pixi.js/lib/extensions/Extensions.mjs","../../node_modules/pixi.js/lib/environment-browser/browserExt.mjs","../../node_modules/pixi.js/lib/environment-webworker/webworkerExt.mjs","../../node_modules/pixi.js/lib/maths/point/ObservablePoint.mjs","../../node_modules/eventemitter3/index.js","../../node_modules/pixi.js/lib/maths/misc/const.mjs","../../node_modules/pixi.js/lib/maths/point/Point.mjs","../../node_modules/pixi.js/lib/maths/matrix/Matrix.mjs","../../node_modules/pixi.js/lib/maths/matrix/groupD8.mjs","../../node_modules/pixi.js/lib/maths/shapes/Rectangle.mjs","../../node_modules/pixi.js/lib/utils/data/uid.mjs","../../node_modules/pixi.js/lib/utils/logging/deprecation.mjs","../../node_modules/pixi.js/lib/utils/misc/NOOP.mjs","../../node_modules/pixi.js/lib/maths/misc/pow2.mjs","../../node_modules/pixi.js/lib/scene/container/utils/definedProps.mjs","../../node_modules/pixi.js/lib/rendering/renderers/shared/texture/TextureStyle.mjs","../../node_modules/pixi.js/lib/rendering/renderers/shared/texture/sources/TextureSource.mjs","../../node_modules/pixi.js/lib/rendering/renderers/shared/texture/sources/BufferImageSource.mjs","../../node_modules/pixi.js/lib/rendering/renderers/shared/texture/TextureMatrix.mjs","../../node_modules/pixi.js/lib/rendering/renderers/shared/texture/Texture.mjs","../../node_modules/pixi.js/lib/utils/data/updateQuadBounds.mjs","../../node_modules/pixi.js/lib/scene/container/bounds/Bounds.mjs","../../node_modules/@pixi/colord/index.mjs","../../node_modules/@pixi/colord/plugins/names.mjs","../../node_modules/pixi.js/lib/color/Color.mjs","../../node_modules/pixi.js/lib/culling/cullingMixin.mjs","../../node_modules/pixi.js/lib/utils/logging/warn.mjs","../../node_modules/pixi.js/lib/utils/pool/GlobalResourceRegistry.mjs","../../node_modules/pixi.js/lib/utils/pool/Pool.mjs","../../node_modules/pixi.js/lib/utils/pool/PoolGroup.mjs","../../node_modules/pixi.js/lib/scene/container/container-mixins/cacheAsTextureMixin.mjs","../../node_modules/pixi.js/lib/utils/data/removeItems.mjs","../../node_modules/pixi.js/lib/scene/container/container-mixins/childrenHelperMixin.mjs","../../node_modules/pixi.js/lib/scene/container/container-mixins/collectRenderablesMixin.mjs","../../node_modules/pixi.js/lib/filters/FilterEffect.mjs","../../node_modules/pixi.js/lib/rendering/mask/MaskEffectManager.mjs","../../node_modules/pixi.js/lib/scene/container/container-mixins/effectsMixin.mjs","../../node_modules/pixi.js/lib/scene/container/container-mixins/findMixin.mjs","../../node_modules/pixi.js/lib/scene/container/bounds/utils/matrixAndBoundsPool.mjs","../../node_modules/pixi.js/lib/scene/container/container-mixins/getFastGlobalBoundsMixin.mjs","../../node_modules/pixi.js/lib/scene/container/bounds/getGlobalBounds.mjs","../../node_modules/pixi.js/lib/scene/container/utils/multiplyHexColors.mjs","../../node_modules/pixi.js/lib/scene/container/utils/multiplyColors.mjs","../../node_modules/pixi.js/lib/scene/container/container-mixins/getGlobalMixin.mjs","../../node_modules/pixi.js/lib/scene/container/bounds/getLocalBounds.mjs","../../node_modules/pixi.js/lib/scene/container/utils/checkChildrenDidChange.mjs","../../node_modules/pixi.js/lib/scene/container/container-mixins/measureMixin.mjs","../../node_modules/pixi.js/lib/scene/container/container-mixins/onRenderMixin.mjs","../../node_modules/pixi.js/lib/scene/container/container-mixins/sortMixin.mjs","../../node_modules/pixi.js/lib/scene/container/container-mixins/toLocalGlobalMixin.mjs","../../node_modules/pixi.js/lib/rendering/renderers/shared/instructions/InstructionSet.mjs","../../node_modules/pixi.js/lib/rendering/renderers/shared/texture/TexturePool.mjs","../../node_modules/pixi.js/lib/scene/container/RenderGroup.mjs","../../node_modules/pixi.js/lib/scene/container/utils/assignWithIgnore.mjs","../../node_modules/pixi.js/lib/scene/container/Container.mjs","../../node_modules/pixi.js/lib/scene/view/ViewContainer.mjs","../../node_modules/pixi.js/lib/scene/sprite/Sprite.mjs","../../node_modules/pixi.js/lib/rendering/mask/utils/addMaskBounds.mjs","../../node_modules/pixi.js/lib/rendering/mask/utils/addMaskLocalBounds.mjs","../../node_modules/pixi.js/lib/rendering/mask/alpha/AlphaMask.mjs","../../node_modules/pixi.js/lib/rendering/mask/color/ColorMask.mjs","../../node_modules/pixi.js/lib/rendering/mask/stencil/StencilMask.mjs","../../node_modules/pixi.js/lib/environment-browser/BrowserAdapter.mjs","../../node_modules/pixi.js/lib/environment/adapter.mjs","../../node_modules/pixi.js/lib/rendering/renderers/shared/texture/sources/CanvasSource.mjs","../../node_modules/pixi.js/lib/rendering/renderers/shared/texture/sources/ImageSource.mjs","../../node_modules/pixi.js/lib/ticker/const.mjs","../../node_modules/pixi.js/lib/ticker/TickerListener.mjs","../../node_modules/pixi.js/lib/ticker/Ticker.mjs","../../node_modules/pixi.js/lib/utils/browser/detectVideoAlphaMode.mjs","../../node_modules/pixi.js/lib/rendering/renderers/shared/texture/sources/VideoSource.mjs","../../node_modules/pixi.js/lib/assets/utils/convertToList.mjs","../../node_modules/pixi.js/lib/assets/cache/Cache.mjs","../../node_modules/pixi.js/lib/rendering/renderers/shared/texture/utils/textureFrom.mjs","../../node_modules/pixi.js/lib/rendering/init.mjs","../../node_modules/pixi.js/lib/assets/loader/parsers/LoaderParser.mjs","../../node_modules/pixi.js/lib/utils/path.mjs","../../node_modules/pixi.js/lib/assets/utils/createStringVariations.mjs","../../node_modules/pixi.js/lib/assets/utils/isSingleItem.mjs","../../node_modules/pixi.js/lib/assets/resolver/Resolver.mjs","../../node_modules/pixi.js/lib/assets/utils/copySearchParams.mjs","../../node_modules/pixi.js/lib/spritesheet/Spritesheet.mjs","../../node_modules/pixi.js/lib/spritesheet/spritesheetAsset.mjs","../../node_modules/pixi.js/lib/spritesheet/init.mjs","../../node_modules/pixi.js/lib/rendering/renderers/shared/utils/createIdFromString.mjs","../../node_modules/pixi.js/lib/rendering/renderers/gl/shader/program/getTestContext.mjs","../../node_modules/pixi.js/lib/rendering/renderers/gl/shader/program/getMaxFragmentPrecision.mjs","../../node_modules/pixi.js/lib/rendering/renderers/gl/shader/program/preprocessors/addProgramDefines.mjs","../../node_modules/pixi.js/lib/rendering/renderers/gl/shader/program/preprocessors/ensurePrecision.mjs","../../node_modules/pixi.js/lib/rendering/renderers/gl/shader/program/preprocessors/insertVersion.mjs","../../node_modules/pixi.js/lib/rendering/renderers/gl/shader/program/preprocessors/setProgramName.mjs","../../node_modules/pixi.js/lib/rendering/renderers/gl/shader/program/preprocessors/stripVersion.mjs","../../node_modules/pixi.js/lib/rendering/renderers/gl/shader/GlProgram.mjs","../../node_modules/pixi.js/lib/rendering/renderers/shared/geometry/utils/getAttributeInfoFromFormat.mjs","../../node_modules/pixi.js/lib/rendering/renderers/gpu/shader/utils/extractAttributesFromGpuProgram.mjs","../../node_modules/pixi.js/lib/rendering/renderers/gpu/shader/utils/extractStructAndGroups.mjs","../../node_modules/pixi.js/lib/rendering/renderers/shared/shader/const.mjs","../../node_modules/pixi.js/lib/rendering/renderers/gpu/shader/utils/generateGpuLayoutGroups.mjs","../../node_modules/pixi.js/lib/rendering/renderers/gpu/shader/utils/generateLayoutHash.mjs","../../node_modules/pixi.js/lib/rendering/renderers/gpu/shader/utils/removeStructAndGroupDuplicates.mjs","../../node_modules/pixi.js/lib/rendering/renderers/gpu/shader/GpuProgram.mjs","../../node_modules/pixi.js/lib/rendering/renderers/shared/shader/types.mjs","../../node_modules/pixi.js/lib/rendering/renderers/shared/shader/utils/getDefaultUniformValue.mjs","../../node_modules/pixi.js/lib/rendering/renderers/shared/shader/UniformGroup.mjs","../../node_modules/pixi.js/lib/rendering/renderers/gpu/shader/BindGroup.mjs","../../node_modules/pixi.js/lib/rendering/renderers/types.mjs","../../node_modules/pixi.js/lib/rendering/renderers/shared/shader/Shader.mjs","../../node_modules/pixi.js/lib/environment/autoDetectEnvironment.mjs","../../node_modules/pixi.js/lib/utils/browser/unsafeEvalSupported.mjs","../../node_modules/earcut/src/earcut.js","../../node_modules/pixi.js/lib/utils/utils.mjs","../../node_modules/pixi.js/lib/rendering/renderers/gl/const.mjs","../../node_modules/pixi.js/lib/rendering/renderers/shared/system/SystemRunner.mjs","../../node_modules/pixi.js/lib/rendering/renderers/shared/system/AbstractRenderer.mjs","../../node_modules/pixi.js/lib/utils/browser/isWebGLSupported.mjs","../../node_modules/pixi.js/lib/utils/browser/isWebGPUSupported.mjs","../../node_modules/pixi.js/lib/rendering/renderers/autoDetectRenderer.mjs","../../node_modules/pixi.js/lib/utils/const.mjs","../../node_modules/pixi.js/lib/utils/global/globalHooks.mjs","../../node_modules/pixi.js/lib/app/Application.mjs","../../node_modules/pixi.js/lib/scene/text-bitmap/AbstractBitmapFont.mjs","../../node_modules/tiny-lru/dist/tiny-lru.js","../../node_modules/pixi.js/lib/scene/text/canvas/utils/fontStringFromTextStyle.mjs","../../node_modules/pixi.js/lib/scene/text/canvas/CanvasTextMetrics.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/fill/FillGradient.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/fill/FillPattern.mjs","../../node_modules/parse-svg-path/index.js","../../node_modules/pixi.js/lib/scene/graphics/shared/svg/parseSVGPath.mjs","../../node_modules/pixi.js/lib/maths/shapes/Circle.mjs","../../node_modules/pixi.js/lib/maths/shapes/Ellipse.mjs","../../node_modules/pixi.js/lib/maths/misc/squaredDistanceToLineSegment.mjs","../../node_modules/pixi.js/lib/maths/shapes/Polygon.mjs","../../node_modules/pixi.js/lib/maths/shapes/RoundedRectangle.mjs","../../node_modules/pixi.js/lib/rendering/batcher/gpu/getTextureBatchBindGroup.mjs","../../node_modules/pixi.js/lib/utils/data/ViewableBuffer.mjs","../../node_modules/pixi.js/lib/rendering/renderers/shared/buffer/utils/fastCopy.mjs","../../node_modules/pixi.js/lib/rendering/renderers/shared/state/const.mjs","../../node_modules/pixi.js/lib/rendering/renderers/shared/state/getAdjustedBlendModeBlend.mjs","../../node_modules/pixi.js/lib/rendering/batcher/gl/utils/checkMaxIfStatementsInShader.mjs","../../node_modules/pixi.js/lib/rendering/batcher/gl/utils/maxRecommendedTextures.mjs","../../node_modules/pixi.js/lib/rendering/batcher/shared/BatchTextureArray.mjs","../../node_modules/pixi.js/lib/rendering/batcher/shared/Batcher.mjs","../../node_modules/pixi.js/lib/rendering/renderers/shared/buffer/const.mjs","../../node_modules/pixi.js/lib/rendering/renderers/shared/buffer/Buffer.mjs","../../node_modules/pixi.js/lib/rendering/renderers/shared/geometry/utils/ensureIsBuffer.mjs","../../node_modules/pixi.js/lib/rendering/renderers/shared/geometry/utils/getGeometryBounds.mjs","../../node_modules/pixi.js/lib/rendering/renderers/shared/geometry/Geometry.mjs","../../node_modules/pixi.js/lib/rendering/batcher/shared/BatchGeometry.mjs","../../node_modules/pixi.js/lib/rendering/high-shader/compiler/utils/addBits.mjs","../../node_modules/pixi.js/lib/rendering/high-shader/compiler/utils/compileHooks.mjs","../../node_modules/pixi.js/lib/rendering/high-shader/compiler/utils/compileInputs.mjs","../../node_modules/pixi.js/lib/rendering/high-shader/compiler/utils/compileOutputs.mjs","../../node_modules/pixi.js/lib/rendering/high-shader/compiler/utils/injectBits.mjs","../../node_modules/pixi.js/lib/rendering/high-shader/compiler/compileHighShader.mjs","../../node_modules/pixi.js/lib/rendering/high-shader/defaultProgramTemplate.mjs","../../node_modules/pixi.js/lib/rendering/high-shader/shader-bits/globalUniformsBit.mjs","../../node_modules/pixi.js/lib/rendering/high-shader/compileHighShaderToProgram.mjs","../../node_modules/pixi.js/lib/rendering/high-shader/shader-bits/colorBit.mjs","../../node_modules/pixi.js/lib/rendering/high-shader/shader-bits/generateTextureBatchBit.mjs","../../node_modules/pixi.js/lib/rendering/high-shader/shader-bits/roundPixelsBit.mjs","../../node_modules/pixi.js/lib/rendering/renderers/gl/shader/getBatchSamplersUniformGroup.mjs","../../node_modules/pixi.js/lib/rendering/batcher/shared/DefaultShader.mjs","../../node_modules/pixi.js/lib/rendering/batcher/shared/DefaultBatcher.mjs","../../node_modules/pixi.js/lib/rendering/renderers/shared/geometry/utils/buildUvs.mjs","../../node_modules/pixi.js/lib/rendering/renderers/shared/geometry/utils/transformVertices.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/BatchableGraphics.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/buildCommands/buildCircle.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/const.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/utils/getOrientationOfPoints.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/buildCommands/buildLine.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/buildCommands/buildPixelLine.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/utils/triangulateWithHoles.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/buildCommands/buildPolygon.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/buildCommands/buildRectangle.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/buildCommands/buildTriangle.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/utils/generateTextureFillMatrix.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/utils/buildContextBatches.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/GraphicsContextSystem.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/buildCommands/buildAdaptiveBezier.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/buildCommands/buildAdaptiveQuadratic.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/buildCommands/buildArc.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/buildCommands/buildArcTo.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/buildCommands/buildArcToSvg.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/path/roundShape.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/path/ShapePath.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/path/GraphicsPath.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/svg/parseSVGFloatAttribute.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/svg/parseSVGDefinitions.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/svg/utils/extractSvgUrlId.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/svg/parseSVGStyle.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/svg/utils/fillOperations.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/svg/utils/pathOperations.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/svg/SVGParser.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/utils/convertFillInputToFillStyle.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/GraphicsContext.mjs","../../node_modules/pixi.js/lib/scene/text/TextStyle.mjs","../../node_modules/pixi.js/lib/rendering/renderers/shared/texture/CanvasPool.mjs","../../node_modules/pixi.js/lib/scene/text/canvas/utils/getCanvasFillStyle.mjs","../../node_modules/pixi.js/lib/scene/text-bitmap/DynamicBitmapFont.mjs","../../node_modules/pixi.js/lib/scene/text-bitmap/utils/getBitmapTextLayout.mjs","../../node_modules/pixi.js/lib/scene/text-bitmap/utils/resolveCharacters.mjs","../../node_modules/pixi.js/lib/scene/text-bitmap/BitmapFontManager.mjs","../../node_modules/pixi.js/lib/scene/text-bitmap/BitmapFont.mjs","../../node_modules/pixi.js/lib/scene/text-bitmap/asset/bitmapFontTextParser.mjs","../../node_modules/pixi.js/lib/scene/text-bitmap/asset/bitmapFontXMLParser.mjs","../../node_modules/pixi.js/lib/scene/text-bitmap/asset/bitmapFontXMLStringParser.mjs","../../node_modules/pixi.js/lib/scene/text-bitmap/asset/loadBitmapFont.mjs","../../node_modules/pixi.js/lib/assets/BackgroundLoader.mjs","../../node_modules/pixi.js/lib/assets/cache/parsers/cacheTextureArray.mjs","../../node_modules/pixi.js/lib/assets/detections/utils/testImageFormat.mjs","../../node_modules/pixi.js/lib/assets/detections/parsers/detectAvif.mjs","../../node_modules/pixi.js/lib/assets/detections/parsers/detectDefaults.mjs","../../node_modules/pixi.js/lib/assets/detections/utils/testVideoFormat.mjs","../../node_modules/pixi.js/lib/assets/detections/parsers/detectMp4.mjs","../../node_modules/pixi.js/lib/assets/detections/parsers/detectOgv.mjs","../../node_modules/pixi.js/lib/assets/detections/parsers/detectWebm.mjs","../../node_modules/pixi.js/lib/assets/detections/parsers/detectWebp.mjs","../../node_modules/pixi.js/lib/assets/loader/Loader.mjs","../../node_modules/pixi.js/lib/assets/utils/checkDataUrl.mjs","../../node_modules/pixi.js/lib/assets/utils/checkExtension.mjs","../../node_modules/pixi.js/lib/assets/loader/parsers/loadJson.mjs","../../node_modules/pixi.js/lib/assets/loader/parsers/loadTxt.mjs","../../node_modules/pixi.js/lib/assets/loader/parsers/loadWebFont.mjs","../../node_modules/pixi.js/lib/utils/network/getResolutionOfUrl.mjs","../../node_modules/pixi.js/lib/assets/loader/parsers/textures/utils/createTexture.mjs","../../node_modules/pixi.js/lib/assets/loader/parsers/textures/loadSVG.mjs","../../node_modules/pixi.js/lib/_virtual/checkImageBitmap.worker.mjs","../../node_modules/pixi.js/lib/_virtual/loadImageBitmap.worker.mjs","../../node_modules/pixi.js/lib/assets/loader/workers/WorkerManager.mjs","../../node_modules/pixi.js/lib/assets/loader/parsers/textures/loadTextures.mjs","../../node_modules/pixi.js/lib/assets/loader/parsers/textures/loadVideoTextures.mjs","../../node_modules/pixi.js/lib/assets/resolver/parsers/resolveTextureUrl.mjs","../../node_modules/pixi.js/lib/assets/resolver/parsers/resolveJsonUrl.mjs","../../node_modules/pixi.js/lib/assets/Assets.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/Graphics.mjs","../../node_modules/pixi.js/lib/scene/text/AbstractText.mjs","../../node_modules/pixi.js/lib/utils/canvas/getCanvasBoundingBox.mjs","../../node_modules/pixi.js/lib/scene/text/canvas/CanvasTextGenerator.mjs","../../node_modules/pixi.js/lib/scene/text/Text.mjs","../../node_modules/pixi.js/lib/index.mjs","../../src/cardImage.js","../../src/i18n.js","../../node_modules/zustand/esm/vanilla.mjs","../../node_modules/react/cjs/react.production.js","../../node_modules/react/index.js","../../node_modules/use-sync-external-store/cjs/use-sync-external-store-shim.production.js","../../node_modules/use-sync-external-store/shim/index.js","../../node_modules/use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.production.js","../../node_modules/use-sync-external-store/shim/with-selector.js","../../node_modules/zustand/esm/index.mjs","../../node_modules/tslib/tslib.es6.mjs","../../node_modules/@supabase/functions-js/dist/module/helper.js","../../node_modules/@supabase/functions-js/dist/module/types.js","../../node_modules/@supabase/functions-js/dist/module/FunctionsClient.js","../../node_modules/@supabase/postgrest-js/dist/cjs/PostgrestError.js","../../node_modules/@supabase/postgrest-js/dist/cjs/PostgrestBuilder.js","../../node_modules/@supabase/postgrest-js/dist/cjs/PostgrestTransformBuilder.js","../../node_modules/@supabase/postgrest-js/dist/cjs/PostgrestFilterBuilder.js","../../node_modules/@supabase/postgrest-js/dist/cjs/PostgrestQueryBuilder.js","../../node_modules/@supabase/postgrest-js/dist/cjs/PostgrestClient.js","../../node_modules/@supabase/postgrest-js/dist/cjs/index.js","../../node_modules/@supabase/postgrest-js/dist/esm/wrapper.mjs","../../node_modules/@supabase/realtime-js/dist/module/lib/websocket-factory.js","../../node_modules/@supabase/realtime-js/dist/module/lib/version.js","../../node_modules/@supabase/realtime-js/dist/module/lib/constants.js","../../node_modules/@supabase/realtime-js/dist/module/lib/serializer.js","../../node_modules/@supabase/realtime-js/dist/module/lib/timer.js","../../node_modules/@supabase/realtime-js/dist/module/lib/transformers.js","../../node_modules/@supabase/realtime-js/dist/module/lib/push.js","../../node_modules/@supabase/realtime-js/dist/module/RealtimePresence.js","../../node_modules/@supabase/realtime-js/dist/module/RealtimeChannel.js","../../node_modules/@supabase/realtime-js/dist/module/RealtimeClient.js","../../node_modules/@supabase/storage-js/dist/module/lib/errors.js","../../node_modules/@supabase/storage-js/dist/module/lib/helpers.js","../../node_modules/@supabase/storage-js/dist/module/lib/fetch.js","../../node_modules/@supabase/storage-js/dist/module/packages/StreamDownloadBuilder.js","../../node_modules/@supabase/storage-js/dist/module/packages/BlobDownloadBuilder.js","../../node_modules/@supabase/storage-js/dist/module/packages/StorageFileApi.js","../../node_modules/@supabase/storage-js/dist/module/lib/version.js","../../node_modules/@supabase/storage-js/dist/module/lib/constants.js","../../node_modules/@supabase/storage-js/dist/module/packages/StorageBucketApi.js","../../node_modules/@supabase/storage-js/dist/module/packages/StorageAnalyticsApi.js","../../node_modules/@supabase/storage-js/dist/module/lib/vectors/constants.js","../../node_modules/@supabase/storage-js/dist/module/lib/vectors/errors.js","../../node_modules/@supabase/storage-js/dist/module/lib/vectors/helpers.js","../../node_modules/@supabase/storage-js/dist/module/lib/vectors/fetch.js","../../node_modules/@supabase/storage-js/dist/module/lib/vectors/VectorIndexApi.js","../../node_modules/@supabase/storage-js/dist/module/lib/vectors/VectorDataApi.js","../../node_modules/@supabase/storage-js/dist/module/lib/vectors/VectorBucketApi.js","../../node_modules/@supabase/storage-js/dist/module/lib/vectors/StorageVectorsClient.js","../../node_modules/@supabase/storage-js/dist/module/StorageClient.js","../../node_modules/@supabase/supabase-js/dist/module/lib/version.js","../../node_modules/@supabase/supabase-js/dist/module/lib/constants.js","../../node_modules/@supabase/supabase-js/dist/module/lib/fetch.js","../../node_modules/@supabase/supabase-js/dist/module/lib/helpers.js","../../node_modules/@supabase/auth-js/dist/module/lib/version.js","../../node_modules/@supabase/auth-js/dist/module/lib/constants.js","../../node_modules/@supabase/auth-js/dist/module/lib/errors.js","../../node_modules/@supabase/auth-js/dist/module/lib/base64url.js","../../node_modules/@supabase/auth-js/dist/module/lib/helpers.js","../../node_modules/@supabase/auth-js/dist/module/lib/fetch.js","../../node_modules/@supabase/auth-js/dist/module/lib/types.js","../../node_modules/@supabase/auth-js/dist/module/GoTrueAdminApi.js","../../node_modules/@supabase/auth-js/dist/module/lib/local-storage.js","../../node_modules/@supabase/auth-js/dist/module/lib/locks.js","../../node_modules/@supabase/auth-js/dist/module/lib/polyfills.js","../../node_modules/@supabase/auth-js/dist/module/lib/web3/ethereum.js","../../node_modules/@supabase/auth-js/dist/module/lib/webauthn.errors.js","../../node_modules/@supabase/auth-js/dist/module/lib/webauthn.js","../../node_modules/@supabase/auth-js/dist/module/GoTrueClient.js","../../node_modules/@supabase/auth-js/dist/module/AuthClient.js","../../node_modules/@supabase/supabase-js/dist/module/lib/SupabaseAuthClient.js","../../node_modules/@supabase/supabase-js/dist/module/SupabaseClient.js","../../node_modules/@supabase/supabase-js/dist/module/index.js","../../src/supabaseClient.js","../../src/data/campaignStages.js","../../src/store.js","../../src/cloudSave.js","../../src/authStore.js","../../src/data.js","../../src/assetLoader.js","../../src/cardPool.js","../../src/vfx.js","../../src/tweens.js","../../src/audio.js","../../src/toast.js","../../src/utils/backgroundVariation.js","../../src/main.ts"],"sourcesContent":["\"use strict\";\nvar ExtensionType = /* @__PURE__ */ ((ExtensionType2) => {\n  ExtensionType2[\"Application\"] = \"application\";\n  ExtensionType2[\"WebGLPipes\"] = \"webgl-pipes\";\n  ExtensionType2[\"WebGLPipesAdaptor\"] = \"webgl-pipes-adaptor\";\n  ExtensionType2[\"WebGLSystem\"] = \"webgl-system\";\n  ExtensionType2[\"WebGPUPipes\"] = \"webgpu-pipes\";\n  ExtensionType2[\"WebGPUPipesAdaptor\"] = \"webgpu-pipes-adaptor\";\n  ExtensionType2[\"WebGPUSystem\"] = \"webgpu-system\";\n  ExtensionType2[\"CanvasSystem\"] = \"canvas-system\";\n  ExtensionType2[\"CanvasPipesAdaptor\"] = \"canvas-pipes-adaptor\";\n  ExtensionType2[\"CanvasPipes\"] = \"canvas-pipes\";\n  ExtensionType2[\"Asset\"] = \"asset\";\n  ExtensionType2[\"LoadParser\"] = \"load-parser\";\n  ExtensionType2[\"ResolveParser\"] = \"resolve-parser\";\n  ExtensionType2[\"CacheParser\"] = \"cache-parser\";\n  ExtensionType2[\"DetectionParser\"] = \"detection-parser\";\n  ExtensionType2[\"MaskEffect\"] = \"mask-effect\";\n  ExtensionType2[\"BlendMode\"] = \"blend-mode\";\n  ExtensionType2[\"TextureSource\"] = \"texture-source\";\n  ExtensionType2[\"Environment\"] = \"environment\";\n  ExtensionType2[\"ShapeBuilder\"] = \"shape-builder\";\n  ExtensionType2[\"Batcher\"] = \"batcher\";\n  return ExtensionType2;\n})(ExtensionType || {});\nconst normalizeExtension = (ext) => {\n  if (typeof ext === \"function\" || typeof ext === \"object\" && ext.extension) {\n    if (!ext.extension) {\n      throw new Error(\"Extension class must have an extension object\");\n    }\n    const metadata = typeof ext.extension !== \"object\" ? { type: ext.extension } : ext.extension;\n    ext = { ...metadata, ref: ext };\n  }\n  if (typeof ext === \"object\") {\n    ext = { ...ext };\n  } else {\n    throw new Error(\"Invalid extension type\");\n  }\n  if (typeof ext.type === \"string\") {\n    ext.type = [ext.type];\n  }\n  return ext;\n};\nconst normalizeExtensionPriority = (ext, defaultPriority) => normalizeExtension(ext).priority ?? defaultPriority;\nconst extensions = {\n  /** @ignore */\n  _addHandlers: {},\n  /** @ignore */\n  _removeHandlers: {},\n  /** @ignore */\n  _queue: {},\n  /**\n   * Remove extensions from PixiJS.\n   * @param extensions - Extensions to be removed. Can be:\n   * - Extension class with static `extension` property\n   * - Extension format object with `type` and `ref`\n   * - Multiple extensions as separate arguments\n   * @returns {extensions} this for chaining\n   * @example\n   * ```ts\n   * // Remove a single extension\n   * extensions.remove(MyRendererPlugin);\n   *\n   * // Remove multiple extensions\n   * extensions.remove(\n   *     MyRendererPlugin,\n   *     MySystemPlugin\n   * );\n   * ```\n   * @see {@link ExtensionType} For available extension types\n   * @see {@link ExtensionFormat} For extension format details\n   */\n  remove(...extensions2) {\n    extensions2.map(normalizeExtension).forEach((ext) => {\n      ext.type.forEach((type) => this._removeHandlers[type]?.(ext));\n    });\n    return this;\n  },\n  /**\n   * Register new extensions with PixiJS. Extensions can be registered in multiple formats:\n   * - As a class with a static `extension` property\n   * - As an extension format object\n   * - As multiple extensions passed as separate arguments\n   * @param extensions - Extensions to add to PixiJS. Each can be:\n   * - A class with static `extension` property\n   * - An extension format object with `type` and `ref`\n   * - Multiple extensions as separate arguments\n   * @returns This extensions instance for chaining\n   * @example\n   * ```ts\n   * // Register a simple extension\n   * extensions.add(MyRendererPlugin);\n   *\n   * // Register multiple extensions\n   * extensions.add(\n   *     MyRendererPlugin,\n   *     MySystemPlugin,\n   * });\n   * ```\n   * @see {@link ExtensionType} For available extension types\n   * @see {@link ExtensionFormat} For extension format details\n   * @see {@link extensions.remove} For removing registered extensions\n   */\n  add(...extensions2) {\n    extensions2.map(normalizeExtension).forEach((ext) => {\n      ext.type.forEach((type) => {\n        const handlers = this._addHandlers;\n        const queue = this._queue;\n        if (!handlers[type]) {\n          queue[type] = queue[type] || [];\n          queue[type]?.push(ext);\n        } else {\n          handlers[type]?.(ext);\n        }\n      });\n    });\n    return this;\n  },\n  /**\n   * Internal method to handle extensions by name.\n   * @param type - The extension type.\n   * @param onAdd  - Function handler when extensions are added/registered {@link StrictExtensionFormat}.\n   * @param onRemove  - Function handler when extensions are removed/unregistered {@link StrictExtensionFormat}.\n   * @returns this for chaining.\n   * @internal\n   * @ignore\n   */\n  handle(type, onAdd, onRemove) {\n    const addHandlers = this._addHandlers;\n    const removeHandlers = this._removeHandlers;\n    if (addHandlers[type] || removeHandlers[type]) {\n      throw new Error(`Extension type ${type} already has a handler`);\n    }\n    addHandlers[type] = onAdd;\n    removeHandlers[type] = onRemove;\n    const queue = this._queue;\n    if (queue[type]) {\n      queue[type]?.forEach((ext) => onAdd(ext));\n      delete queue[type];\n    }\n    return this;\n  },\n  /**\n   * Handle a type, but using a map by `name` property.\n   * @param type - Type of extension to handle.\n   * @param map - The object map of named extensions.\n   * @returns this for chaining.\n   * @ignore\n   */\n  handleByMap(type, map) {\n    return this.handle(\n      type,\n      (extension) => {\n        if (extension.name) {\n          map[extension.name] = extension.ref;\n        }\n      },\n      (extension) => {\n        if (extension.name) {\n          delete map[extension.name];\n        }\n      }\n    );\n  },\n  /**\n   * Handle a type, but using a list of extensions with a `name` property.\n   * @param type - Type of extension to handle.\n   * @param map - The array of named extensions.\n   * @param defaultPriority - Fallback priority if none is defined.\n   * @returns this for chaining.\n   * @ignore\n   */\n  handleByNamedList(type, map, defaultPriority = -1) {\n    return this.handle(\n      type,\n      (extension) => {\n        const index = map.findIndex((item) => item.name === extension.name);\n        if (index >= 0)\n          return;\n        map.push({ name: extension.name, value: extension.ref });\n        map.sort((a, b) => normalizeExtensionPriority(b.value, defaultPriority) - normalizeExtensionPriority(a.value, defaultPriority));\n      },\n      (extension) => {\n        const index = map.findIndex((item) => item.name === extension.name);\n        if (index !== -1) {\n          map.splice(index, 1);\n        }\n      }\n    );\n  },\n  /**\n   * Handle a type, but using a list of extensions.\n   * @param type - Type of extension to handle.\n   * @param list - The list of extensions.\n   * @param defaultPriority - The default priority to use if none is specified.\n   * @returns this for chaining.\n   * @ignore\n   */\n  handleByList(type, list, defaultPriority = -1) {\n    return this.handle(\n      type,\n      (extension) => {\n        if (list.includes(extension.ref)) {\n          return;\n        }\n        list.push(extension.ref);\n        list.sort((a, b) => normalizeExtensionPriority(b, defaultPriority) - normalizeExtensionPriority(a, defaultPriority));\n      },\n      (extension) => {\n        const index = list.indexOf(extension.ref);\n        if (index !== -1) {\n          list.splice(index, 1);\n        }\n      }\n    );\n  },\n  /**\n   * Mixin the source object(s) properties into the target class's prototype.\n   * Copies all property descriptors from source objects to the target's prototype.\n   * @param Target - The target class to mix properties into\n   * @param sources - One or more source objects containing properties to mix in\n   * @example\n   * ```ts\n   * // Create a mixin with shared properties\n   * const moveable = {\n   *     x: 0,\n   *     y: 0,\n   *     move(x: number, y: number) {\n   *         this.x += x;\n   *         this.y += y;\n   *     }\n   * };\n   *\n   * // Create a mixin with computed properties\n   * const scalable = {\n   *     scale: 1,\n   *     get scaled() {\n   *         return this.scale > 1;\n   *     }\n   * };\n   *\n   * // Apply mixins to a class\n   * extensions.mixin(Sprite, moveable, scalable);\n   *\n   * // Use mixed-in properties\n   * const sprite = new Sprite();\n   * sprite.move(10, 20);\n   * console.log(sprite.x, sprite.y); // 10, 20\n   * ```\n   * @remarks\n   * - Copies all properties including getters/setters\n   * - Does not modify source objects\n   * - Preserves property descriptors\n   * @see {@link Object.defineProperties} For details on property descriptors\n   * @see {@link Object.getOwnPropertyDescriptors} For details on property copying\n   */\n  mixin(Target, ...sources) {\n    for (const source of sources) {\n      Object.defineProperties(Target.prototype, Object.getOwnPropertyDescriptors(source));\n    }\n  }\n};\n\nexport { ExtensionType, extensions, normalizeExtensionPriority };\n//# sourceMappingURL=Extensions.mjs.map\n","import { ExtensionType } from '../extensions/Extensions.mjs';\n\n\"use strict\";\nconst browserExt = {\n  extension: {\n    type: ExtensionType.Environment,\n    name: \"browser\",\n    priority: -1\n  },\n  test: () => true,\n  load: async () => {\n    await import('./browserAll.mjs');\n  }\n};\n\nexport { browserExt };\n//# sourceMappingURL=browserExt.mjs.map\n","import { ExtensionType } from '../extensions/Extensions.mjs';\n\n\"use strict\";\nconst webworkerExt = {\n  extension: {\n    type: ExtensionType.Environment,\n    name: \"webworker\",\n    priority: 0\n  },\n  test: () => typeof self !== \"undefined\" && self.WorkerGlobalScope !== void 0,\n  load: async () => {\n    await import('./webworkerAll.mjs');\n  }\n};\n\nexport { webworkerExt };\n//# sourceMappingURL=webworkerExt.mjs.map\n","\"use strict\";\nclass ObservablePoint {\n  /**\n   * Creates a new `ObservablePoint`\n   * @param observer - Observer to pass to listen for change events.\n   * @param {number} [x=0] - position of the point on the x axis\n   * @param {number} [y=0] - position of the point on the y axis\n   */\n  constructor(observer, x, y) {\n    this._x = x || 0;\n    this._y = y || 0;\n    this._observer = observer;\n  }\n  /**\n   * Creates a clone of this point.\n   * @example\n   * ```ts\n   * // Basic cloning\n   * const point = new ObservablePoint(observer, 100, 200);\n   * const copy = point.clone();\n   *\n   * // Clone with new observer\n   * const newObserver = {\n   *     _onUpdate: (p) => console.log(`Clone updated: (${p.x}, ${p.y})`)\n   * };\n   * const watched = point.clone(newObserver);\n   *\n   * // Verify independence\n   * watched.set(300, 400); // Only triggers new observer\n   * ```\n   * @param observer - Optional observer to pass to the new observable point\n   * @returns A copy of this observable point\n   * @see {@link ObservablePoint.copyFrom} For copying into existing point\n   * @see {@link Observer} For observer interface details\n   */\n  clone(observer) {\n    return new ObservablePoint(observer ?? this._observer, this._x, this._y);\n  }\n  /**\n   * Sets the point to a new x and y position.\n   *\n   * If y is omitted, both x and y will be set to x.\n   * @example\n   * ```ts\n   * // Basic position setting\n   * const point = new ObservablePoint(observer);\n   * point.set(100, 200);\n   *\n   * // Set both x and y to same value\n   * point.set(50); // x=50, y=50\n   * ```\n   * @param x - Position on the x axis\n   * @param y - Position on the y axis, defaults to x\n   * @returns The point instance itself\n   * @see {@link ObservablePoint.copyFrom} For copying from another point\n   * @see {@link ObservablePoint.equals} For comparing positions\n   */\n  set(x = 0, y = x) {\n    if (this._x !== x || this._y !== y) {\n      this._x = x;\n      this._y = y;\n      this._observer._onUpdate(this);\n    }\n    return this;\n  }\n  /**\n   * Copies x and y from the given point into this point.\n   * @example\n   * ```ts\n   * // Basic copying\n   * const source = new ObservablePoint(observer, 100, 200);\n   * const target = new ObservablePoint();\n   * target.copyFrom(source);\n   *\n   * // Copy and chain operations\n   * const point = new ObservablePoint()\n   *     .copyFrom(source)\n   *     .set(x + 50, y + 50);\n   *\n   * // Copy from any PointData\n   * const data = { x: 10, y: 20 };\n   * point.copyFrom(data);\n   * ```\n   * @param p - The point to copy from\n   * @returns The point instance itself\n   * @see {@link ObservablePoint.copyTo} For copying to another point\n   * @see {@link ObservablePoint.clone} For creating new point copy\n   */\n  copyFrom(p) {\n    if (this._x !== p.x || this._y !== p.y) {\n      this._x = p.x;\n      this._y = p.y;\n      this._observer._onUpdate(this);\n    }\n    return this;\n  }\n  /**\n   * Copies this point's x and y into the given point.\n   * @example\n   * ```ts\n   * // Basic copying\n   * const source = new ObservablePoint(100, 200);\n   * const target = new ObservablePoint();\n   * source.copyTo(target);\n   * ```\n   * @param p - The point to copy to. Can be any type that is or extends `PointLike`\n   * @returns The point (`p`) with values updated\n   * @see {@link ObservablePoint.copyFrom} For copying from another point\n   * @see {@link ObservablePoint.clone} For creating new point copy\n   */\n  copyTo(p) {\n    p.set(this._x, this._y);\n    return p;\n  }\n  /**\n   * Checks if another point is equal to this point.\n   *\n   * Compares x and y values using strict equality.\n   * @example\n   * ```ts\n   * // Basic equality check\n   * const p1 = new ObservablePoint(100, 200);\n   * const p2 = new ObservablePoint(100, 200);\n   * console.log(p1.equals(p2)); // true\n   *\n   * // Compare with PointData\n   * const data = { x: 100, y: 200 };\n   * console.log(p1.equals(data)); // true\n   *\n   * // Check different points\n   * const p3 = new ObservablePoint(200, 300);\n   * console.log(p1.equals(p3)); // false\n   * ```\n   * @param p - The point to check\n   * @returns `true` if both `x` and `y` are equal\n   * @see {@link ObservablePoint.copyFrom} For making points equal\n   * @see {@link PointData} For point data interface\n   */\n  equals(p) {\n    return p.x === this._x && p.y === this._y;\n  }\n  toString() {\n    return `[pixi.js/math:ObservablePoint x=${this._x} y=${this._y} scope=${this._observer}]`;\n  }\n  /**\n   * Position of the observable point on the x axis.\n   * Triggers observer callback when value changes.\n   * @example\n   * ```ts\n   * // Basic x position\n   * const point = new ObservablePoint(observer);\n   * point.x = 100; // Triggers observer\n   *\n   * // Use in calculations\n   * const width = rightPoint.x - leftPoint.x;\n   * ```\n   * @default 0\n   */\n  get x() {\n    return this._x;\n  }\n  set x(value) {\n    if (this._x !== value) {\n      this._x = value;\n      this._observer._onUpdate(this);\n    }\n  }\n  /**\n   * Position of the observable point on the y axis.\n   * Triggers observer callback when value changes.\n   * @example\n   * ```ts\n   * // Basic y position\n   * const point = new ObservablePoint(observer);\n   * point.y = 200; // Triggers observer\n   *\n   * // Use in calculations\n   * const height = bottomPoint.y - topPoint.y;\n   * ```\n   * @default 0\n   */\n  get y() {\n    return this._y;\n  }\n  set y(value) {\n    if (this._y !== value) {\n      this._y = value;\n      this._observer._onUpdate(this);\n    }\n  }\n}\n\nexport { ObservablePoint };\n//# sourceMappingURL=ObservablePoint.mjs.map\n","'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","\"use strict\";\nconst PI_2 = Math.PI * 2;\nconst RAD_TO_DEG = 180 / Math.PI;\nconst DEG_TO_RAD = Math.PI / 180;\n\nexport { DEG_TO_RAD, PI_2, RAD_TO_DEG };\n//# sourceMappingURL=const.mjs.map\n","\"use strict\";\nclass Point {\n  /**\n   * Creates a new `Point`\n   * @param {number} [x=0] - position of the point on the x axis\n   * @param {number} [y=0] - position of the point on the y axis\n   */\n  constructor(x = 0, y = 0) {\n    /**\n     * Position of the point on the x axis\n     * @example\n     * ```ts\n     * // Set x position\n     * const point = new Point();\n     * point.x = 100;\n     *\n     * // Use in calculations\n     * const width = rightPoint.x - leftPoint.x;\n     * ```\n     */\n    this.x = 0;\n    /**\n     * Position of the point on the y axis\n     * @example\n     * ```ts\n     * // Set y position\n     * const point = new Point();\n     * point.y = 200;\n     *\n     * // Use in calculations\n     * const height = bottomPoint.y - topPoint.y;\n     * ```\n     */\n    this.y = 0;\n    this.x = x;\n    this.y = y;\n  }\n  /**\n   * Creates a clone of this point, which is a new instance with the same `x` and `y` values.\n   * @example\n   * ```ts\n   * // Basic point cloning\n   * const original = new Point(100, 200);\n   * const copy = original.clone();\n   *\n   * // Clone and modify\n   * const modified = original.clone();\n   * modified.set(300, 400);\n   *\n   * // Verify independence\n   * console.log(original); // Point(100, 200)\n   * console.log(modified); // Point(300, 400)\n   * ```\n   * @remarks\n   * - Creates new Point instance\n   * - Deep copies x and y values\n   * - Independent from original\n   * - Useful for preserving values\n   * @returns A clone of this point\n   * @see {@link Point.copyFrom} For copying into existing point\n   * @see {@link Point.copyTo} For copying to existing point\n   */\n  clone() {\n    return new Point(this.x, this.y);\n  }\n  /**\n   * Copies x and y from the given point into this point.\n   * @example\n   * ```ts\n   * // Basic copying\n   * const source = new Point(100, 200);\n   * const target = new Point();\n   * target.copyFrom(source);\n   *\n   * // Copy and chain operations\n   * const point = new Point()\n   *     .copyFrom(source)\n   *     .set(x + 50, y + 50);\n   *\n   * // Copy from any PointData\n   * const data = { x: 10, y: 20 };\n   * point.copyFrom(data);\n   * ```\n   * @param p - The point to copy from\n   * @returns The point instance itself\n   * @see {@link Point.copyTo} For copying to another point\n   * @see {@link Point.clone} For creating new point copy\n   */\n  copyFrom(p) {\n    this.set(p.x, p.y);\n    return this;\n  }\n  /**\n   * Copies this point's x and y into the given point.\n   * @example\n   * ```ts\n   * // Basic copying\n   * const source = new Point(100, 200);\n   * const target = new Point();\n   * source.copyTo(target);\n   * ```\n   * @param p - The point to copy to. Can be any type that is or extends `PointLike`\n   * @returns The point (`p`) with values updated\n   * @see {@link Point.copyFrom} For copying from another point\n   * @see {@link Point.clone} For creating new point copy\n   */\n  copyTo(p) {\n    p.set(this.x, this.y);\n    return p;\n  }\n  /**\n   * Checks if another point is equal to this point.\n   *\n   * Compares x and y values using strict equality.\n   * @example\n   * ```ts\n   * // Basic equality check\n   * const p1 = new Point(100, 200);\n   * const p2 = new Point(100, 200);\n   * console.log(p1.equals(p2)); // true\n   *\n   * // Compare with PointData\n   * const data = { x: 100, y: 200 };\n   * console.log(p1.equals(data)); // true\n   *\n   * // Check different points\n   * const p3 = new Point(200, 300);\n   * console.log(p1.equals(p3)); // false\n   * ```\n   * @param p - The point to check\n   * @returns `true` if both `x` and `y` are equal\n   * @see {@link Point.copyFrom} For making points equal\n   * @see {@link PointData} For point data interface\n   */\n  equals(p) {\n    return p.x === this.x && p.y === this.y;\n  }\n  /**\n   * Sets the point to a new x and y position.\n   *\n   * If y is omitted, both x and y will be set to x.\n   * @example\n   * ```ts\n   * // Basic position setting\n   * const point = new Point();\n   * point.set(100, 200);\n   *\n   * // Set both x and y to same value\n   * point.set(50); // x=50, y=50\n   *\n   * // Chain with other operations\n   * point\n   *     .set(10, 20)\n   *     .copyTo(otherPoint);\n   * ```\n   * @param x - Position on the x axis\n   * @param y - Position on the y axis, defaults to x\n   * @returns The point instance itself\n   * @see {@link Point.copyFrom} For copying from another point\n   * @see {@link Point.equals} For comparing positions\n   */\n  set(x = 0, y = x) {\n    this.x = x;\n    this.y = y;\n    return this;\n  }\n  toString() {\n    return `[pixi.js/math:Point x=${this.x} y=${this.y}]`;\n  }\n  /**\n   * A static Point object with `x` and `y` values of `0`.\n   *\n   * This shared instance is reset to zero values when accessed.\n   *\n   * > [!IMPORTANT] This point is shared and temporary. Do not store references to it.\n   * @example\n   * ```ts\n   * // Use for temporary calculations\n   * const tempPoint = Point.shared;\n   * tempPoint.set(100, 200);\n   * matrix.apply(tempPoint);\n   *\n   * // Will be reset to (0,0) on next access\n   * const fresh = Point.shared; // x=0, y=0\n   * ```\n   * @readonly\n   * @returns A fresh zeroed point for temporary use\n   * @see {@link Point.constructor} For creating new points\n   * @see {@link PointData} For basic point interface\n   */\n  static get shared() {\n    tempPoint.x = 0;\n    tempPoint.y = 0;\n    return tempPoint;\n  }\n}\nconst tempPoint = new Point();\n\nexport { Point };\n//# sourceMappingURL=Point.mjs.map\n","import { PI_2 } from '../misc/const.mjs';\nimport { Point } from '../point/Point.mjs';\n\n\"use strict\";\nclass Matrix {\n  /**\n   * @param a - x scale\n   * @param b - y skew\n   * @param c - x skew\n   * @param d - y scale\n   * @param tx - x translation\n   * @param ty - y translation\n   */\n  constructor(a = 1, b = 0, c = 0, d = 1, tx = 0, ty = 0) {\n    /**\n     * Array representation of the matrix.\n     * Only populated when `toArray()` is called.\n     * @default null\n     * @see {@link Matrix.toArray} For filling this array\n     */\n    this.array = null;\n    this.a = a;\n    this.b = b;\n    this.c = c;\n    this.d = d;\n    this.tx = tx;\n    this.ty = ty;\n  }\n  /**\n   * Creates a Matrix object based on the given array.\n   * Populates matrix components from a flat array in column-major order.\n   *\n   * > [!NOTE] Array mapping order:\n   * > ```\n   * > array[0] = a  (x scale)\n   * > array[1] = b  (y skew)\n   * > array[2] = tx (x translation)\n   * > array[3] = c  (x skew)\n   * > array[4] = d  (y scale)\n   * > array[5] = ty (y translation)\n   * > ```\n   * @example\n   * ```ts\n   * // Create matrix from array\n   * const matrix = new Matrix();\n   * matrix.fromArray([\n   *     2, 0,  100,  // a, b, tx\n   *     0, 2,  100   // c, d, ty\n   * ]);\n   *\n   * // Create matrix from typed array\n   * const float32Array = new Float32Array([\n   *     1, 0, 0,     // Scale x1, no skew\n   *     0, 1, 0      // No skew, scale x1\n   * ]);\n   * matrix.fromArray(float32Array);\n   * ```\n   * @param array - The array to populate the matrix from\n   * @see {@link Matrix.toArray} For converting matrix to array\n   * @see {@link Matrix.set} For setting values directly\n   */\n  fromArray(array) {\n    this.a = array[0];\n    this.b = array[1];\n    this.c = array[3];\n    this.d = array[4];\n    this.tx = array[2];\n    this.ty = array[5];\n  }\n  /**\n   * Sets the matrix properties directly.\n   * All matrix components can be set in one call.\n   * @example\n   * ```ts\n   * // Set to identity matrix\n   * matrix.set(1, 0, 0, 1, 0, 0);\n   *\n   * // Set to scale matrix\n   * matrix.set(2, 0, 0, 2, 0, 0); // Scale 2x\n   *\n   * // Set to translation matrix\n   * matrix.set(1, 0, 0, 1, 100, 50); // Move 100,50\n   * ```\n   * @param a - Scale on x axis\n   * @param b - Shear on y axis\n   * @param c - Shear on x axis\n   * @param d - Scale on y axis\n   * @param tx - Translation on x axis\n   * @param ty - Translation on y axis\n   * @returns This matrix. Good for chaining method calls.\n   * @see {@link Matrix.identity} For resetting to identity\n   * @see {@link Matrix.fromArray} For setting from array\n   */\n  set(a, b, c, d, tx, ty) {\n    this.a = a;\n    this.b = b;\n    this.c = c;\n    this.d = d;\n    this.tx = tx;\n    this.ty = ty;\n    return this;\n  }\n  /**\n   * Creates an array from the current Matrix object.\n   *\n   * > [!NOTE] The array format is:\n   * > ```\n   * > Non-transposed:\n   * > [a, c, tx,\n   * > b, d, ty,\n   * > 0, 0, 1]\n   * >\n   * > Transposed:\n   * > [a, b, 0,\n   * > c, d, 0,\n   * > tx,ty,1]\n   * > ```\n   * @example\n   * ```ts\n   * // Basic array conversion\n   * const matrix = new Matrix(2, 0, 0, 2, 100, 100);\n   * const array = matrix.toArray();\n   *\n   * // Using existing array\n   * const float32Array = new Float32Array(9);\n   * matrix.toArray(false, float32Array);\n   *\n   * // Get transposed array\n   * const transposed = matrix.toArray(true);\n   * ```\n   * @param transpose - Whether to transpose the matrix\n   * @param out - Optional Float32Array to store the result\n   * @returns The array containing the matrix values\n   * @see {@link Matrix.fromArray} For creating matrix from array\n   * @see {@link Matrix.array} For cached array storage\n   */\n  toArray(transpose, out) {\n    if (!this.array) {\n      this.array = new Float32Array(9);\n    }\n    const array = out || this.array;\n    if (transpose) {\n      array[0] = this.a;\n      array[1] = this.b;\n      array[2] = 0;\n      array[3] = this.c;\n      array[4] = this.d;\n      array[5] = 0;\n      array[6] = this.tx;\n      array[7] = this.ty;\n      array[8] = 1;\n    } else {\n      array[0] = this.a;\n      array[1] = this.c;\n      array[2] = this.tx;\n      array[3] = this.b;\n      array[4] = this.d;\n      array[5] = this.ty;\n      array[6] = 0;\n      array[7] = 0;\n      array[8] = 1;\n    }\n    return array;\n  }\n  /**\n   * Get a new position with the current transformation applied.\n   *\n   * Can be used to go from a child's coordinate space to the world coordinate space. (e.g. rendering)\n   * @example\n   * ```ts\n   * // Basic point transformation\n   * const matrix = new Matrix().translate(100, 50).rotate(Math.PI / 4);\n   * const point = new Point(10, 20);\n   * const transformed = matrix.apply(point);\n   *\n   * // Reuse existing point\n   * const output = new Point();\n   * matrix.apply(point, output);\n   * ```\n   * @param pos - The origin point to transform\n   * @param newPos - Optional point to store the result\n   * @returns The transformed point\n   * @see {@link Matrix.applyInverse} For inverse transformation\n   * @see {@link Point} For point operations\n   */\n  apply(pos, newPos) {\n    newPos = newPos || new Point();\n    const x = pos.x;\n    const y = pos.y;\n    newPos.x = this.a * x + this.c * y + this.tx;\n    newPos.y = this.b * x + this.d * y + this.ty;\n    return newPos;\n  }\n  /**\n   * Get a new position with the inverse of the current transformation applied.\n   *\n   * Can be used to go from the world coordinate space to a child's coordinate space. (e.g. input)\n   * @example\n   * ```ts\n   * // Basic inverse transformation\n   * const matrix = new Matrix().translate(100, 50).rotate(Math.PI / 4);\n   * const worldPoint = new Point(150, 100);\n   * const localPoint = matrix.applyInverse(worldPoint);\n   *\n   * // Reuse existing point\n   * const output = new Point();\n   * matrix.applyInverse(worldPoint, output);\n   *\n   * // Convert mouse position to local space\n   * const mousePoint = new Point(mouseX, mouseY);\n   * const localMouse = matrix.applyInverse(mousePoint);\n   * ```\n   * @param pos - The origin point to inverse-transform\n   * @param newPos - Optional point to store the result\n   * @returns The inverse-transformed point\n   * @see {@link Matrix.apply} For forward transformation\n   * @see {@link Matrix.invert} For getting inverse matrix\n   */\n  applyInverse(pos, newPos) {\n    newPos = newPos || new Point();\n    const a = this.a;\n    const b = this.b;\n    const c = this.c;\n    const d = this.d;\n    const tx = this.tx;\n    const ty = this.ty;\n    const id = 1 / (a * d + c * -b);\n    const x = pos.x;\n    const y = pos.y;\n    newPos.x = d * id * x + -c * id * y + (ty * c - tx * d) * id;\n    newPos.y = a * id * y + -b * id * x + (-ty * a + tx * b) * id;\n    return newPos;\n  }\n  /**\n   * Translates the matrix on the x and y axes.\n   * Adds to the position values while preserving scale, rotation and skew.\n   * @example\n   * ```ts\n   * // Basic translation\n   * const matrix = new Matrix();\n   * matrix.translate(100, 50); // Move right 100, down 50\n   *\n   * // Chain with other transformations\n   * matrix\n   *     .scale(2, 2)\n   *     .translate(100, 0)\n   *     .rotate(Math.PI / 4);\n   * ```\n   * @param x - How much to translate on the x axis\n   * @param y - How much to translate on the y axis\n   * @returns This matrix. Good for chaining method calls.\n   * @see {@link Matrix.set} For setting position directly\n   * @see {@link Matrix.setTransform} For complete transform setup\n   */\n  translate(x, y) {\n    this.tx += x;\n    this.ty += y;\n    return this;\n  }\n  /**\n   * Applies a scale transformation to the matrix.\n   * Multiplies the scale values with existing matrix components.\n   * @example\n   * ```ts\n   * // Basic scaling\n   * const matrix = new Matrix();\n   * matrix.scale(2, 3); // Scale 2x horizontally, 3x vertically\n   *\n   * // Chain with other transformations\n   * matrix\n   *     .translate(100, 100)\n   *     .scale(2, 2)     // Scales after translation\n   *     .rotate(Math.PI / 4);\n   * ```\n   * @param x - The amount to scale horizontally\n   * @param y - The amount to scale vertically\n   * @returns This matrix. Good for chaining method calls.\n   * @see {@link Matrix.setTransform} For setting scale directly\n   * @see {@link Matrix.append} For combining transformations\n   */\n  scale(x, y) {\n    this.a *= x;\n    this.d *= y;\n    this.c *= x;\n    this.b *= y;\n    this.tx *= x;\n    this.ty *= y;\n    return this;\n  }\n  /**\n   * Applies a rotation transformation to the matrix.\n   *\n   * Rotates around the origin (0,0) by the given angle in radians.\n   * @example\n   * ```ts\n   * // Basic rotation\n   * const matrix = new Matrix();\n   * matrix.rotate(Math.PI / 4); // Rotate 45 degrees\n   *\n   * // Chain with other transformations\n   * matrix\n   *     .translate(100, 100) // Move to rotation center\n   *     .rotate(Math.PI)     // Rotate 180 degrees\n   *     .scale(2, 2);        // Scale after rotation\n   *\n   * // Common angles\n   * matrix.rotate(Math.PI / 2);  // 90 degrees\n   * matrix.rotate(Math.PI);      // 180 degrees\n   * matrix.rotate(Math.PI * 2);  // 360 degrees\n   * ```\n   * @remarks\n   * - Rotates around origin point (0,0)\n   * - Affects position if translation was set\n   * - Uses counter-clockwise rotation\n   * - Order of operations matters when chaining\n   * @param angle - The angle in radians\n   * @returns This matrix. Good for chaining method calls.\n   * @see {@link Matrix.setTransform} For setting rotation directly\n   * @see {@link Matrix.append} For combining transformations\n   */\n  rotate(angle) {\n    const cos = Math.cos(angle);\n    const sin = Math.sin(angle);\n    const a1 = this.a;\n    const c1 = this.c;\n    const tx1 = this.tx;\n    this.a = a1 * cos - this.b * sin;\n    this.b = a1 * sin + this.b * cos;\n    this.c = c1 * cos - this.d * sin;\n    this.d = c1 * sin + this.d * cos;\n    this.tx = tx1 * cos - this.ty * sin;\n    this.ty = tx1 * sin + this.ty * cos;\n    return this;\n  }\n  /**\n   * Appends the given Matrix to this Matrix.\n   * Combines two matrices by multiplying them together: this = this * matrix\n   * @example\n   * ```ts\n   * // Basic matrix combination\n   * const matrix = new Matrix();\n   * const other = new Matrix().translate(100, 0).rotate(Math.PI / 4);\n   * matrix.append(other);\n   * ```\n   * @remarks\n   * - Order matters: A.append(B) !== B.append(A)\n   * - Modifies current matrix\n   * - Preserves transformation order\n   * - Commonly used for combining transforms\n   * @param matrix - The matrix to append\n   * @returns This matrix. Good for chaining method calls.\n   * @see {@link Matrix.prepend} For prepending transformations\n   * @see {@link Matrix.appendFrom} For appending two external matrices\n   */\n  append(matrix) {\n    const a1 = this.a;\n    const b1 = this.b;\n    const c1 = this.c;\n    const d1 = this.d;\n    this.a = matrix.a * a1 + matrix.b * c1;\n    this.b = matrix.a * b1 + matrix.b * d1;\n    this.c = matrix.c * a1 + matrix.d * c1;\n    this.d = matrix.c * b1 + matrix.d * d1;\n    this.tx = matrix.tx * a1 + matrix.ty * c1 + this.tx;\n    this.ty = matrix.tx * b1 + matrix.ty * d1 + this.ty;\n    return this;\n  }\n  /**\n   * Appends two matrices and sets the result to this matrix.\n   * Performs matrix multiplication: this = A * B\n   * @example\n   * ```ts\n   * // Basic matrix multiplication\n   * const result = new Matrix();\n   * const matrixA = new Matrix().scale(2, 2);\n   * const matrixB = new Matrix().rotate(Math.PI / 4);\n   * result.appendFrom(matrixA, matrixB);\n   * ```\n   * @remarks\n   * - Order matters: A * B !== B * A\n   * - Creates a new transformation from two others\n   * - More efficient than append() for multiple operations\n   * - Does not modify input matrices\n   * @param a - The first matrix to multiply\n   * @param b - The second matrix to multiply\n   * @returns This matrix. Good for chaining method calls.\n   * @see {@link Matrix.append} For single matrix combination\n   * @see {@link Matrix.prepend} For reverse order multiplication\n   */\n  appendFrom(a, b) {\n    const a1 = a.a;\n    const b1 = a.b;\n    const c1 = a.c;\n    const d1 = a.d;\n    const tx = a.tx;\n    const ty = a.ty;\n    const a2 = b.a;\n    const b2 = b.b;\n    const c2 = b.c;\n    const d2 = b.d;\n    this.a = a1 * a2 + b1 * c2;\n    this.b = a1 * b2 + b1 * d2;\n    this.c = c1 * a2 + d1 * c2;\n    this.d = c1 * b2 + d1 * d2;\n    this.tx = tx * a2 + ty * c2 + b.tx;\n    this.ty = tx * b2 + ty * d2 + b.ty;\n    return this;\n  }\n  /**\n   * Sets the matrix based on all the available properties.\n   * Combines position, scale, rotation, skew and pivot in a single operation.\n   * @example\n   * ```ts\n   * // Basic transform setup\n   * const matrix = new Matrix();\n   * matrix.setTransform(\n   *     100, 100,    // position\n   *     0, 0,        // pivot\n   *     2, 2,        // scale\n   *     Math.PI / 4, // rotation (45 degrees)\n   *     0, 0         // skew\n   * );\n   * ```\n   * @remarks\n   * - Updates all matrix components at once\n   * - More efficient than separate transform calls\n   * - Uses radians for rotation and skew\n   * - Pivot affects rotation center\n   * @param x - Position on the x axis\n   * @param y - Position on the y axis\n   * @param pivotX - Pivot on the x axis\n   * @param pivotY - Pivot on the y axis\n   * @param scaleX - Scale on the x axis\n   * @param scaleY - Scale on the y axis\n   * @param rotation - Rotation in radians\n   * @param skewX - Skew on the x axis\n   * @param skewY - Skew on the y axis\n   * @returns This matrix. Good for chaining method calls.\n   * @see {@link Matrix.decompose} For extracting transform properties\n   * @see {@link TransformableObject} For transform data structure\n   */\n  setTransform(x, y, pivotX, pivotY, scaleX, scaleY, rotation, skewX, skewY) {\n    this.a = Math.cos(rotation + skewY) * scaleX;\n    this.b = Math.sin(rotation + skewY) * scaleX;\n    this.c = -Math.sin(rotation - skewX) * scaleY;\n    this.d = Math.cos(rotation - skewX) * scaleY;\n    this.tx = x - (pivotX * this.a + pivotY * this.c);\n    this.ty = y - (pivotX * this.b + pivotY * this.d);\n    return this;\n  }\n  /**\n   * Prepends the given Matrix to this Matrix.\n   * Combines two matrices by multiplying them together: this = matrix * this\n   * @example\n   * ```ts\n   * // Basic matrix prepend\n   * const matrix = new Matrix().scale(2, 2);\n   * const other = new Matrix().translate(100, 0);\n   * matrix.prepend(other); // Translation happens before scaling\n   * ```\n   * @remarks\n   * - Order matters: A.prepend(B) !== B.prepend(A)\n   * - Modifies current matrix\n   * - Reverses transformation order compared to append()\n   * @param matrix - The matrix to prepend\n   * @returns This matrix. Good for chaining method calls.\n   * @see {@link Matrix.append} For appending transformations\n   * @see {@link Matrix.appendFrom} For combining external matrices\n   */\n  prepend(matrix) {\n    const tx1 = this.tx;\n    if (matrix.a !== 1 || matrix.b !== 0 || matrix.c !== 0 || matrix.d !== 1) {\n      const a1 = this.a;\n      const c1 = this.c;\n      this.a = a1 * matrix.a + this.b * matrix.c;\n      this.b = a1 * matrix.b + this.b * matrix.d;\n      this.c = c1 * matrix.a + this.d * matrix.c;\n      this.d = c1 * matrix.b + this.d * matrix.d;\n    }\n    this.tx = tx1 * matrix.a + this.ty * matrix.c + matrix.tx;\n    this.ty = tx1 * matrix.b + this.ty * matrix.d + matrix.ty;\n    return this;\n  }\n  /**\n   * Decomposes the matrix into its individual transform components.\n   * Extracts position, scale, rotation and skew values from the matrix.\n   * @example\n   * ```ts\n   * // Basic decomposition\n   * const matrix = new Matrix()\n   *     .translate(100, 100)\n   *     .rotate(Math.PI / 4)\n   *     .scale(2, 2);\n   *\n   * const transform = {\n   *     position: new Point(),\n   *     scale: new Point(),\n   *     pivot: new Point(),\n   *     skew: new Point(),\n   *     rotation: 0\n   * };\n   *\n   * matrix.decompose(transform);\n   * console.log(transform.position); // Point(100, 100)\n   * console.log(transform.rotation); // ~0.785 (PI/4)\n   * console.log(transform.scale); // Point(2, 2)\n   * ```\n   * @remarks\n   * - Handles combined transformations\n   * - Accounts for pivot points\n   * - Chooses between rotation/skew based on transform type\n   * - Uses radians for rotation and skew\n   * @param transform - The transform object to store the decomposed values\n   * @returns The transform with the newly applied properties\n   * @see {@link Matrix.setTransform} For composing from components\n   * @see {@link TransformableObject} For transform structure\n   */\n  decompose(transform) {\n    const a = this.a;\n    const b = this.b;\n    const c = this.c;\n    const d = this.d;\n    const pivot = transform.pivot;\n    const skewX = -Math.atan2(-c, d);\n    const skewY = Math.atan2(b, a);\n    const delta = Math.abs(skewX + skewY);\n    if (delta < 1e-5 || Math.abs(PI_2 - delta) < 1e-5) {\n      transform.rotation = skewY;\n      transform.skew.x = transform.skew.y = 0;\n    } else {\n      transform.rotation = 0;\n      transform.skew.x = skewX;\n      transform.skew.y = skewY;\n    }\n    transform.scale.x = Math.sqrt(a * a + b * b);\n    transform.scale.y = Math.sqrt(c * c + d * d);\n    transform.position.x = this.tx + (pivot.x * a + pivot.y * c);\n    transform.position.y = this.ty + (pivot.x * b + pivot.y * d);\n    return transform;\n  }\n  /**\n   * Inverts this matrix.\n   * Creates the matrix that when multiplied with this matrix results in an identity matrix.\n   * @example\n   * ```ts\n   * // Basic matrix inversion\n   * const matrix = new Matrix()\n   *     .translate(100, 50)\n   *     .scale(2, 2);\n   *\n   * matrix.invert(); // Now transforms in opposite direction\n   *\n   * // Verify inversion\n   * const point = new Point(50, 50);\n   * const transformed = matrix.apply(point);\n   * const original = matrix.invert().apply(transformed);\n   * // original  point\n   * ```\n   * @remarks\n   * - Modifies the current matrix\n   * - Useful for reversing transformations\n   * - Cannot invert matrices with zero determinant\n   * @returns This matrix. Good for chaining method calls.\n   * @see {@link Matrix.identity} For resetting to identity\n   * @see {@link Matrix.applyInverse} For inverse transformations\n   */\n  invert() {\n    const a1 = this.a;\n    const b1 = this.b;\n    const c1 = this.c;\n    const d1 = this.d;\n    const tx1 = this.tx;\n    const n = a1 * d1 - b1 * c1;\n    this.a = d1 / n;\n    this.b = -b1 / n;\n    this.c = -c1 / n;\n    this.d = a1 / n;\n    this.tx = (c1 * this.ty - d1 * tx1) / n;\n    this.ty = -(a1 * this.ty - b1 * tx1) / n;\n    return this;\n  }\n  /**\n   * Checks if this matrix is an identity matrix.\n   *\n   * An identity matrix has no transformations applied (default state).\n   * @example\n   * ```ts\n   * // Check if matrix is identity\n   * const matrix = new Matrix();\n   * console.log(matrix.isIdentity()); // true\n   *\n   * // Check after transformations\n   * matrix.translate(100, 0);\n   * console.log(matrix.isIdentity()); // false\n   *\n   * // Reset and verify\n   * matrix.identity();\n   * console.log(matrix.isIdentity()); // true\n   * ```\n   * @remarks\n   * - Verifies a = 1, d = 1 (no scale)\n   * - Verifies b = 0, c = 0 (no skew)\n   * - Verifies tx = 0, ty = 0 (no translation)\n   * @returns True if matrix has no transformations\n   * @see {@link Matrix.identity} For resetting to identity\n   * @see {@link Matrix.IDENTITY} For constant identity matrix\n   */\n  isIdentity() {\n    return this.a === 1 && this.b === 0 && this.c === 0 && this.d === 1 && this.tx === 0 && this.ty === 0;\n  }\n  /**\n   * Resets this Matrix to an identity (default) matrix.\n   * Sets all components to their default values: scale=1, no skew, no translation.\n   * @example\n   * ```ts\n   * // Reset transformed matrix\n   * const matrix = new Matrix()\n   *     .scale(2, 2)\n   *     .rotate(Math.PI / 4);\n   * matrix.identity(); // Back to default state\n   *\n   * // Chain after reset\n   * matrix\n   *     .identity()\n   *     .translate(100, 100)\n   *     .scale(2, 2);\n   *\n   * // Compare with identity constant\n   * const isDefault = matrix.equals(Matrix.IDENTITY);\n   * ```\n   * @remarks\n   * - Sets a=1, d=1 (default scale)\n   * - Sets b=0, c=0 (no skew)\n   * - Sets tx=0, ty=0 (no translation)\n   * @returns This matrix. Good for chaining method calls.\n   * @see {@link Matrix.IDENTITY} For constant identity matrix\n   * @see {@link Matrix.isIdentity} For checking identity state\n   */\n  identity() {\n    this.a = 1;\n    this.b = 0;\n    this.c = 0;\n    this.d = 1;\n    this.tx = 0;\n    this.ty = 0;\n    return this;\n  }\n  /**\n   * Creates a new Matrix object with the same values as this one.\n   * @returns A copy of this matrix. Good for chaining method calls.\n   */\n  clone() {\n    const matrix = new Matrix();\n    matrix.a = this.a;\n    matrix.b = this.b;\n    matrix.c = this.c;\n    matrix.d = this.d;\n    matrix.tx = this.tx;\n    matrix.ty = this.ty;\n    return matrix;\n  }\n  /**\n   * Creates a new Matrix object with the same values as this one.\n   * @param matrix\n   * @example\n   * ```ts\n   * // Basic matrix cloning\n   * const matrix = new Matrix()\n   *     .translate(100, 100)\n   *     .rotate(Math.PI / 4);\n   * const copy = matrix.clone();\n   *\n   * // Clone and modify\n   * const modified = matrix.clone()\n   *     .scale(2, 2);\n   *\n   * // Compare matrices\n   * console.log(matrix.equals(copy));     // true\n   * console.log(matrix.equals(modified)); // false\n   * ```\n   * @returns A copy of this matrix. Good for chaining method calls.\n   * @see {@link Matrix.copyTo} For copying to existing matrix\n   * @see {@link Matrix.copyFrom} For copying from another matrix\n   */\n  copyTo(matrix) {\n    matrix.a = this.a;\n    matrix.b = this.b;\n    matrix.c = this.c;\n    matrix.d = this.d;\n    matrix.tx = this.tx;\n    matrix.ty = this.ty;\n    return matrix;\n  }\n  /**\n   * Changes the values of the matrix to be the same as the ones in given matrix.\n   * @example\n   * ```ts\n   * // Basic matrix copying\n   * const source = new Matrix()\n   *     .translate(100, 100)\n   *     .rotate(Math.PI / 4);\n   * const target = new Matrix();\n   * target.copyFrom(source);\n   * ```\n   * @param matrix - The matrix to copy from\n   * @returns This matrix. Good for chaining method calls.\n   * @see {@link Matrix.clone} For creating new matrix copy\n   * @see {@link Matrix.copyTo} For copying to another matrix\n   */\n  copyFrom(matrix) {\n    this.a = matrix.a;\n    this.b = matrix.b;\n    this.c = matrix.c;\n    this.d = matrix.d;\n    this.tx = matrix.tx;\n    this.ty = matrix.ty;\n    return this;\n  }\n  /**\n   * Checks if this matrix equals another matrix.\n   * Compares all components for exact equality.\n   * @example\n   * ```ts\n   * // Basic equality check\n   * const m1 = new Matrix();\n   * const m2 = new Matrix();\n   * console.log(m1.equals(m2)); // true\n   *\n   * // Compare transformed matrices\n   * const transform = new Matrix()\n   *     .translate(100, 100)\n   * const clone = new Matrix()\n   *     .scale(2, 2);\n   * console.log(transform.equals(clone)); // false\n   * ```\n   * @param matrix - The matrix to compare to\n   * @returns True if matrices are identical\n   * @see {@link Matrix.copyFrom} For copying matrix values\n   * @see {@link Matrix.isIdentity} For identity comparison\n   */\n  equals(matrix) {\n    return matrix.a === this.a && matrix.b === this.b && matrix.c === this.c && matrix.d === this.d && matrix.tx === this.tx && matrix.ty === this.ty;\n  }\n  toString() {\n    return `[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`;\n  }\n  /**\n   * A default (identity) matrix with no transformations applied.\n   *\n   * > [!IMPORTANT] This is a shared read-only object. Create a new Matrix if you need to modify it.\n   * @example\n   * ```ts\n   * // Get identity matrix reference\n   * const identity = Matrix.IDENTITY;\n   * console.log(identity.isIdentity()); // true\n   *\n   * // Compare with identity\n   * const matrix = new Matrix();\n   * console.log(matrix.equals(Matrix.IDENTITY)); // true\n   *\n   * // Create new matrix instead of modifying IDENTITY\n   * const transform = new Matrix()\n   *     .copyFrom(Matrix.IDENTITY)\n   *     .translate(100, 100);\n   * ```\n   * @readonly\n   * @returns A read-only identity matrix\n   * @see {@link Matrix.shared} For temporary calculations\n   * @see {@link Matrix.identity} For resetting matrices\n   */\n  static get IDENTITY() {\n    return identityMatrix.identity();\n  }\n  /**\n   * A static Matrix that can be used to avoid creating new objects.\n   * Will always ensure the matrix is reset to identity when requested.\n   *\n   * > [!IMPORTANT] This matrix is shared and temporary. Do not store references to it.\n   * @example\n   * ```ts\n   * // Use for temporary calculations\n   * const tempMatrix = Matrix.shared;\n   * tempMatrix.translate(100, 100).rotate(Math.PI / 4);\n   * const point = tempMatrix.apply({ x: 10, y: 20 });\n   *\n   * // Will be reset to identity on next access\n   * const fresh = Matrix.shared; // Back to identity\n   * ```\n   * @remarks\n   * - Always returns identity matrix\n   * - Safe to modify temporarily\n   * - Not safe to store references\n   * - Useful for one-off calculations\n   * @readonly\n   * @returns A fresh identity matrix for temporary use\n   * @see {@link Matrix.IDENTITY} For immutable identity matrix\n   * @see {@link Matrix.identity} For resetting matrices\n   */\n  static get shared() {\n    return tempMatrix.identity();\n  }\n}\nconst tempMatrix = new Matrix();\nconst identityMatrix = new Matrix();\n\nexport { Matrix };\n//# sourceMappingURL=Matrix.mjs.map\n","import { Matrix } from './Matrix.mjs';\n\n\"use strict\";\nconst ux = [1, 1, 0, -1, -1, -1, 0, 1, 1, 1, 0, -1, -1, -1, 0, 1];\nconst uy = [0, 1, 1, 1, 0, -1, -1, -1, 0, 1, 1, 1, 0, -1, -1, -1];\nconst vx = [0, -1, -1, -1, 0, 1, 1, 1, 0, 1, 1, 1, 0, -1, -1, -1];\nconst vy = [1, 1, 0, -1, -1, -1, 0, 1, -1, -1, 0, 1, 1, 1, 0, -1];\nconst rotationCayley = [];\nconst rotationMatrices = [];\nconst signum = Math.sign;\nfunction init() {\n  for (let i = 0; i < 16; i++) {\n    const row = [];\n    rotationCayley.push(row);\n    for (let j = 0; j < 16; j++) {\n      const _ux = signum(ux[i] * ux[j] + vx[i] * uy[j]);\n      const _uy = signum(uy[i] * ux[j] + vy[i] * uy[j]);\n      const _vx = signum(ux[i] * vx[j] + vx[i] * vy[j]);\n      const _vy = signum(uy[i] * vx[j] + vy[i] * vy[j]);\n      for (let k = 0; k < 16; k++) {\n        if (ux[k] === _ux && uy[k] === _uy && vx[k] === _vx && vy[k] === _vy) {\n          row.push(k);\n          break;\n        }\n      }\n    }\n  }\n  for (let i = 0; i < 16; i++) {\n    const mat = new Matrix();\n    mat.set(ux[i], uy[i], vx[i], vy[i], 0, 0);\n    rotationMatrices.push(mat);\n  }\n}\ninit();\nconst groupD8 = {\n  /**\n   * | Rotation | Direction |\n   * |----------|-----------|\n   * | 0       | East      |\n   * @group groupD8\n   * @type {GD8Symmetry}\n   */\n  E: 0,\n  /**\n   * | Rotation | Direction |\n   * |----------|-----------|\n   * | 45     | Southeast |\n   * @group groupD8\n   * @type {GD8Symmetry}\n   */\n  SE: 1,\n  /**\n   * | Rotation | Direction |\n   * |----------|-----------|\n   * | 90     | South     |\n   * @group groupD8\n   * @type {GD8Symmetry}\n   */\n  S: 2,\n  /**\n   * | Rotation | Direction |\n   * |----------|-----------|\n   * | 135    | Southwest |\n   * @group groupD8\n   * @type {GD8Symmetry}\n   */\n  SW: 3,\n  /**\n   * | Rotation | Direction |\n   * |----------|-----------|\n   * | 180     | West      |\n   * @group groupD8\n   * @type {GD8Symmetry}\n   */\n  W: 4,\n  /**\n   * | Rotation    | Direction    |\n   * |-------------|--------------|\n   * | -135/225 | Northwest    |\n   * @group groupD8\n   * @type {GD8Symmetry}\n   */\n  NW: 5,\n  /**\n   * | Rotation    | Direction    |\n   * |-------------|--------------|\n   * | -90/270  | North        |\n   * @group groupD8\n   * @type {GD8Symmetry}\n   */\n  N: 6,\n  /**\n   * | Rotation    | Direction    |\n   * |-------------|--------------|\n   * | -45/315  | Northeast    |\n   * @group groupD8\n   * @type {GD8Symmetry}\n   */\n  NE: 7,\n  /**\n   * Reflection about Y-axis.\n   * @group groupD8\n   * @type {GD8Symmetry}\n   */\n  MIRROR_VERTICAL: 8,\n  /**\n   * Reflection about the main diagonal.\n   * @group groupD8\n   * @type {GD8Symmetry}\n   */\n  MAIN_DIAGONAL: 10,\n  /**\n   * Reflection about X-axis.\n   * @group groupD8\n   * @type {GD8Symmetry}\n   */\n  MIRROR_HORIZONTAL: 12,\n  /**\n   * Reflection about reverse diagonal.\n   * @group groupD8\n   * @type {GD8Symmetry}\n   */\n  REVERSE_DIAGONAL: 14,\n  /**\n   * @group groupD8\n   * @param {GD8Symmetry} ind - sprite rotation angle.\n   * @returns {GD8Symmetry} The X-component of the U-axis\n   *    after rotating the axes.\n   */\n  uX: (ind) => ux[ind],\n  /**\n   * @group groupD8\n   * @param {GD8Symmetry} ind - sprite rotation angle.\n   * @returns {GD8Symmetry} The Y-component of the U-axis\n   *    after rotating the axes.\n   */\n  uY: (ind) => uy[ind],\n  /**\n   * @group groupD8\n   * @param {GD8Symmetry} ind - sprite rotation angle.\n   * @returns {GD8Symmetry} The X-component of the V-axis\n   *    after rotating the axes.\n   */\n  vX: (ind) => vx[ind],\n  /**\n   * @group groupD8\n   * @param {GD8Symmetry} ind - sprite rotation angle.\n   * @returns {GD8Symmetry} The Y-component of the V-axis\n   *    after rotating the axes.\n   */\n  vY: (ind) => vy[ind],\n  /**\n   * @group groupD8\n   * @param {GD8Symmetry} rotation - symmetry whose opposite\n   *   is needed. Only rotations have opposite symmetries while\n   *   reflections don't.\n   * @returns {GD8Symmetry} The opposite symmetry of `rotation`\n   */\n  inv: (rotation) => {\n    if (rotation & 8) {\n      return rotation & 15;\n    }\n    return -rotation & 7;\n  },\n  /**\n   * Composes the two D8 operations.\n   *\n   * Taking `^` as reflection:\n   *\n   * |       | E=0 | S=2 | W=4 | N=6 | E^=8 | S^=10 | W^=12 | N^=14 |\n   * |-------|-----|-----|-----|-----|------|-------|-------|-------|\n   * | E=0   | E   | S   | W   | N   | E^   | S^    | W^    | N^    |\n   * | S=2   | S   | W   | N   | E   | S^   | W^    | N^    | E^    |\n   * | W=4   | W   | N   | E   | S   | W^   | N^    | E^    | S^    |\n   * | N=6   | N   | E   | S   | W   | N^   | E^    | S^    | W^    |\n   * | E^=8  | E^  | N^  | W^  | S^  | E    | N     | W     | S     |\n   * | S^=10 | S^  | E^  | N^  | W^  | S    | E     | N     | W     |\n   * | W^=12 | W^  | S^  | E^  | N^  | W    | S     | E     | N     |\n   * | N^=14 | N^  | W^  | S^  | E^  | N    | W     | S     | E     |\n   *\n   * [This is a Cayley table]{@link https://en.wikipedia.org/wiki/Cayley_table}\n   * @group groupD8\n   * @param {GD8Symmetry} rotationSecond - Second operation, which\n   *   is the row in the above cayley table.\n   * @param {GD8Symmetry} rotationFirst - First operation, which\n   *   is the column in the above cayley table.\n   * @returns {GD8Symmetry} Composed operation\n   */\n  add: (rotationSecond, rotationFirst) => rotationCayley[rotationSecond][rotationFirst],\n  /**\n   * Reverse of `add`.\n   * @group groupD8\n   * @param {GD8Symmetry} rotationSecond - Second operation\n   * @param {GD8Symmetry} rotationFirst - First operation\n   * @returns {GD8Symmetry} Result\n   */\n  sub: (rotationSecond, rotationFirst) => rotationCayley[rotationSecond][groupD8.inv(rotationFirst)],\n  /**\n   * Adds 180 degrees to rotation, which is a commutative\n   * operation.\n   * @group groupD8\n   * @param {number} rotation - The number to rotate.\n   * @returns {number} Rotated number\n   */\n  rotate180: (rotation) => rotation ^ 4,\n  /**\n   * Checks if the rotation angle is vertical, i.e. south\n   * or north. It doesn't work for reflections.\n   * @group groupD8\n   * @param {GD8Symmetry} rotation - The number to check.\n   * @returns {boolean} Whether or not the direction is vertical\n   */\n  isVertical: (rotation) => (rotation & 3) === 2,\n  // rotation % 4 === 2\n  /**\n   * Approximates the vector `V(dx,dy)` into one of the\n   * eight directions provided by `groupD8`.\n   * @group groupD8\n   * @param {number} dx - X-component of the vector\n   * @param {number} dy - Y-component of the vector\n   * @returns {GD8Symmetry} Approximation of the vector into\n   *  one of the eight symmetries.\n   */\n  byDirection: (dx, dy) => {\n    if (Math.abs(dx) * 2 <= Math.abs(dy)) {\n      if (dy >= 0) {\n        return groupD8.S;\n      }\n      return groupD8.N;\n    } else if (Math.abs(dy) * 2 <= Math.abs(dx)) {\n      if (dx > 0) {\n        return groupD8.E;\n      }\n      return groupD8.W;\n    } else if (dy > 0) {\n      if (dx > 0) {\n        return groupD8.SE;\n      }\n      return groupD8.SW;\n    } else if (dx > 0) {\n      return groupD8.NE;\n    }\n    return groupD8.NW;\n  },\n  /**\n   * Helps sprite to compensate texture packer rotation.\n   * @group groupD8\n   * @param {Matrix} matrix - sprite world matrix\n   * @param {GD8Symmetry} rotation - The rotation factor to use.\n   * @param {number} tx - sprite anchoring\n   * @param {number} ty - sprite anchoring\n   */\n  matrixAppendRotationInv: (matrix, rotation, tx = 0, ty = 0) => {\n    const mat = rotationMatrices[groupD8.inv(rotation)];\n    mat.tx = tx;\n    mat.ty = ty;\n    matrix.append(mat);\n  },\n  /**\n   * Transforms rectangle coordinates based on texture packer rotation.\n   * Used when texture atlas pages are rotated and coordinates need to be adjusted.\n   * @group groupD8\n   * @param {RectangleLike} rect - Rectangle with original coordinates to transform\n   * @param {RectangleLike} sourceFrame - Source texture frame (includes offset and dimensions)\n   * @param {GD8Symmetry} rotation - The groupD8 rotation value\n   * @param {Rectangle} out - Rectangle to store the result\n   * @returns {Rectangle} Transformed coordinates (includes source frame offset)\n   */\n  transformRectCoords: (rect, sourceFrame, rotation, out) => {\n    const { x, y, width, height } = rect;\n    const { x: frameX, y: frameY, width: frameWidth, height: frameHeight } = sourceFrame;\n    if (rotation === groupD8.E) {\n      out.set(x + frameX, y + frameY, width, height);\n      return out;\n    } else if (rotation === groupD8.S) {\n      return out.set(\n        frameWidth - y - height + frameX,\n        x + frameY,\n        height,\n        width\n      );\n    } else if (rotation === groupD8.W) {\n      return out.set(\n        frameWidth - x - width + frameX,\n        frameHeight - y - height + frameY,\n        width,\n        height\n      );\n    } else if (rotation === groupD8.N) {\n      return out.set(\n        y + frameX,\n        frameHeight - x - width + frameY,\n        height,\n        width\n      );\n    }\n    return out.set(x + frameX, y + frameY, width, height);\n  }\n};\n\nexport { groupD8 };\n//# sourceMappingURL=groupD8.mjs.map\n","import { Point } from '../point/Point.mjs';\n\n\"use strict\";\nconst tempPoints = [new Point(), new Point(), new Point(), new Point()];\nclass Rectangle {\n  /**\n   * @param x - The X coordinate of the upper-left corner of the rectangle\n   * @param y - The Y coordinate of the upper-left corner of the rectangle\n   * @param width - The overall width of the rectangle\n   * @param height - The overall height of the rectangle\n   */\n  constructor(x = 0, y = 0, width = 0, height = 0) {\n    /**\n     * The type of the object, mainly used to avoid `instanceof` checks\n     * @example\n     * ```ts\n     * // Check shape type\n     * const shape = new Rectangle(0, 0, 100, 100);\n     * console.log(shape.type); // 'rectangle'\n     *\n     * // Use in type guards\n     * if (shape.type === 'rectangle') {\n     *     console.log(shape.width, shape.height);\n     * }\n     * ```\n     * @readonly\n     * @default 'rectangle'\n     * @see {@link SHAPE_PRIMITIVE} For all shape types\n     */\n    this.type = \"rectangle\";\n    this.x = Number(x);\n    this.y = Number(y);\n    this.width = Number(width);\n    this.height = Number(height);\n  }\n  /**\n   * Returns the left edge (x-coordinate) of the rectangle.\n   * @example\n   * ```ts\n   * // Get left edge position\n   * const rect = new Rectangle(100, 100, 200, 150);\n   * console.log(rect.left); // 100\n   *\n   * // Use in alignment calculations\n   * sprite.x = rect.left + padding;\n   *\n   * // Compare positions\n   * if (point.x > rect.left) {\n   *     console.log('Point is right of rectangle');\n   * }\n   * ```\n   * @readonly\n   * @returns The x-coordinate of the left edge\n   * @see {@link Rectangle.right} For right edge position\n   * @see {@link Rectangle.x} For direct x-coordinate access\n   */\n  get left() {\n    return this.x;\n  }\n  /**\n   * Returns the right edge (x + width) of the rectangle.\n   * @example\n   * ```ts\n   * // Get right edge position\n   * const rect = new Rectangle(100, 100, 200, 150);\n   * console.log(rect.right); // 300\n   *\n   * // Align to right edge\n   * sprite.x = rect.right - sprite.width;\n   *\n   * // Check boundaries\n   * if (point.x < rect.right) {\n   *     console.log('Point is inside right bound');\n   * }\n   * ```\n   * @readonly\n   * @returns The x-coordinate of the right edge\n   * @see {@link Rectangle.left} For left edge position\n   * @see {@link Rectangle.width} For width value\n   */\n  get right() {\n    return this.x + this.width;\n  }\n  /**\n   * Returns the top edge (y-coordinate) of the rectangle.\n   * @example\n   * ```ts\n   * // Get top edge position\n   * const rect = new Rectangle(100, 100, 200, 150);\n   * console.log(rect.top); // 100\n   *\n   * // Position above rectangle\n   * sprite.y = rect.top - sprite.height;\n   *\n   * // Check vertical position\n   * if (point.y > rect.top) {\n   *     console.log('Point is below top edge');\n   * }\n   * ```\n   * @readonly\n   * @returns The y-coordinate of the top edge\n   * @see {@link Rectangle.bottom} For bottom edge position\n   * @see {@link Rectangle.y} For direct y-coordinate access\n   */\n  get top() {\n    return this.y;\n  }\n  /**\n   * Returns the bottom edge (y + height) of the rectangle.\n   * @example\n   * ```ts\n   * // Get bottom edge position\n   * const rect = new Rectangle(100, 100, 200, 150);\n   * console.log(rect.bottom); // 250\n   *\n   * // Stack below rectangle\n   * sprite.y = rect.bottom + margin;\n   *\n   * // Check vertical bounds\n   * if (point.y < rect.bottom) {\n   *     console.log('Point is above bottom edge');\n   * }\n   * ```\n   * @readonly\n   * @returns The y-coordinate of the bottom edge\n   * @see {@link Rectangle.top} For top edge position\n   * @see {@link Rectangle.height} For height value\n   */\n  get bottom() {\n    return this.y + this.height;\n  }\n  /**\n   * Determines whether the Rectangle is empty (has no area).\n   * @example\n   * ```ts\n   * // Check zero dimensions\n   * const rect = new Rectangle(100, 100, 0, 50);\n   * console.log(rect.isEmpty()); // true\n   * ```\n   * @returns True if the rectangle has no area\n   * @see {@link Rectangle.width} For width value\n   * @see {@link Rectangle.height} For height value\n   */\n  isEmpty() {\n    return this.left === this.right || this.top === this.bottom;\n  }\n  /**\n   * A constant empty rectangle. This is a new object every time the property is accessed.\n   * @example\n   * ```ts\n   * // Get fresh empty rectangle\n   * const empty = Rectangle.EMPTY;\n   * console.log(empty.isEmpty()); // true\n   * ```\n   * @returns A new empty rectangle instance\n   * @see {@link Rectangle.isEmpty} For empty state testing\n   */\n  static get EMPTY() {\n    return new Rectangle(0, 0, 0, 0);\n  }\n  /**\n   * Creates a clone of this Rectangle\n   * @example\n   * ```ts\n   * // Basic cloning\n   * const original = new Rectangle(100, 100, 200, 150);\n   * const copy = original.clone();\n   *\n   * // Clone and modify\n   * const modified = original.clone();\n   * modified.width *= 2;\n   * modified.height += 50;\n   *\n   * // Verify independence\n   * console.log(original.width);  // 200\n   * console.log(modified.width);  // 400\n   * ```\n   * @returns A copy of the rectangle\n   * @see {@link Rectangle.copyFrom} For copying into existing rectangle\n   * @see {@link Rectangle.copyTo} For copying to another rectangle\n   */\n  clone() {\n    return new Rectangle(this.x, this.y, this.width, this.height);\n  }\n  /**\n   * Converts a Bounds object to a Rectangle object.\n   * @example\n   * ```ts\n   * // Convert bounds to rectangle\n   * const bounds = container.getBounds();\n   * const rect = new Rectangle().copyFromBounds(bounds);\n   * ```\n   * @param bounds - The bounds to copy and convert to a rectangle\n   * @returns Returns itself\n   * @see {@link Bounds} For bounds object structure\n   * @see {@link Rectangle.getBounds} For getting rectangle bounds\n   */\n  copyFromBounds(bounds) {\n    this.x = bounds.minX;\n    this.y = bounds.minY;\n    this.width = bounds.maxX - bounds.minX;\n    this.height = bounds.maxY - bounds.minY;\n    return this;\n  }\n  /**\n   * Copies another rectangle to this one.\n   * @example\n   * ```ts\n   * // Basic copying\n   * const source = new Rectangle(100, 100, 200, 150);\n   * const target = new Rectangle();\n   * target.copyFrom(source);\n   *\n   * // Chain with other operations\n   * const rect = new Rectangle()\n   *     .copyFrom(source)\n   *     .pad(10);\n   * ```\n   * @param rectangle - The rectangle to copy from\n   * @returns Returns itself\n   * @see {@link Rectangle.copyTo} For copying to another rectangle\n   * @see {@link Rectangle.clone} For creating new rectangle copy\n   */\n  copyFrom(rectangle) {\n    this.x = rectangle.x;\n    this.y = rectangle.y;\n    this.width = rectangle.width;\n    this.height = rectangle.height;\n    return this;\n  }\n  /**\n   * Copies this rectangle to another one.\n   * @example\n   * ```ts\n   * // Basic copying\n   * const source = new Rectangle(100, 100, 200, 150);\n   * const target = new Rectangle();\n   * source.copyTo(target);\n   *\n   * // Chain with other operations\n   * const result = source\n   *     .copyTo(new Rectangle())\n   *     .getBounds();\n   * ```\n   * @param rectangle - The rectangle to copy to\n   * @returns Returns given parameter\n   * @see {@link Rectangle.copyFrom} For copying from another rectangle\n   * @see {@link Rectangle.clone} For creating new rectangle copy\n   */\n  copyTo(rectangle) {\n    rectangle.copyFrom(this);\n    return rectangle;\n  }\n  /**\n   * Checks whether the x and y coordinates given are contained within this Rectangle\n   * @example\n   * ```ts\n   * // Basic containment check\n   * const rect = new Rectangle(100, 100, 200, 150);\n   * const isInside = rect.contains(150, 125); // true\n   * // Check edge cases\n   * console.log(rect.contains(100, 100)); // true (on edge)\n   * console.log(rect.contains(300, 250)); // false (outside)\n   * ```\n   * @param x - The X coordinate of the point to test\n   * @param y - The Y coordinate of the point to test\n   * @returns Whether the x/y coordinates are within this Rectangle\n   * @see {@link Rectangle.containsRect} For rectangle containment\n   * @see {@link Rectangle.strokeContains} For checking stroke intersection\n   */\n  contains(x, y) {\n    if (this.width <= 0 || this.height <= 0) {\n      return false;\n    }\n    if (x >= this.x && x < this.x + this.width) {\n      if (y >= this.y && y < this.y + this.height) {\n        return true;\n      }\n    }\n    return false;\n  }\n  /**\n   * Checks whether the x and y coordinates given are contained within this rectangle including the stroke.\n   * @example\n   * ```ts\n   * // Basic stroke check\n   * const rect = new Rectangle(100, 100, 200, 150);\n   * const isOnStroke = rect.strokeContains(150, 100, 4); // 4px line width\n   *\n   * // Check with different alignments\n   * const innerStroke = rect.strokeContains(150, 100, 4, 1);   // Inside\n   * const centerStroke = rect.strokeContains(150, 100, 4, 0.5); // Centered\n   * const outerStroke = rect.strokeContains(150, 100, 4, 0);   // Outside\n   * ```\n   * @param x - The X coordinate of the point to test\n   * @param y - The Y coordinate of the point to test\n   * @param strokeWidth - The width of the line to check\n   * @param alignment - The alignment of the stroke (1 = inner, 0.5 = centered, 0 = outer)\n   * @returns Whether the x/y coordinates are within this rectangle's stroke\n   * @see {@link Rectangle.contains} For checking fill containment\n   * @see {@link Rectangle.getBounds} For getting stroke bounds\n   */\n  strokeContains(x, y, strokeWidth, alignment = 0.5) {\n    const { width, height } = this;\n    if (width <= 0 || height <= 0)\n      return false;\n    const _x = this.x;\n    const _y = this.y;\n    const strokeWidthOuter = strokeWidth * (1 - alignment);\n    const strokeWidthInner = strokeWidth - strokeWidthOuter;\n    const outerLeft = _x - strokeWidthOuter;\n    const outerRight = _x + width + strokeWidthOuter;\n    const outerTop = _y - strokeWidthOuter;\n    const outerBottom = _y + height + strokeWidthOuter;\n    const innerLeft = _x + strokeWidthInner;\n    const innerRight = _x + width - strokeWidthInner;\n    const innerTop = _y + strokeWidthInner;\n    const innerBottom = _y + height - strokeWidthInner;\n    return x >= outerLeft && x <= outerRight && y >= outerTop && y <= outerBottom && !(x > innerLeft && x < innerRight && y > innerTop && y < innerBottom);\n  }\n  /**\n   * Determines whether the `other` Rectangle transformed by `transform` intersects with `this` Rectangle object.\n   * Returns true only if the area of the intersection is >0, this means that Rectangles\n   * sharing a side are not overlapping. Another side effect is that an arealess rectangle\n   * (width or height equal to zero) can't intersect any other rectangle.\n   * @param {Rectangle} other - The Rectangle to intersect with `this`.\n   * @param {Matrix} transform - The transformation matrix of `other`.\n   * @returns {boolean} A value of `true` if the transformed `other` Rectangle intersects with `this`; otherwise `false`.\n   */\n  /**\n   * Determines whether the `other` Rectangle transformed by `transform` intersects with `this` Rectangle object.\n   *\n   * Returns true only if the area of the intersection is greater than 0.\n   * This means that rectangles sharing only a side are not considered intersecting.\n   * @example\n   * ```ts\n   * // Basic intersection check\n   * const rect1 = new Rectangle(0, 0, 100, 100);\n   * const rect2 = new Rectangle(50, 50, 100, 100);\n   * console.log(rect1.intersects(rect2)); // true\n   *\n   * // With transformation matrix\n   * const matrix = new Matrix();\n   * matrix.rotate(Math.PI / 4); // 45 degrees\n   * console.log(rect1.intersects(rect2, matrix)); // Checks with rotation\n   *\n   * // Edge cases\n   * const zeroWidth = new Rectangle(0, 0, 0, 100);\n   * console.log(rect1.intersects(zeroWidth)); // false (no area)\n   * ```\n   * @remarks\n   * - Returns true only if intersection area is > 0\n   * - Rectangles sharing only a side are not intersecting\n   * - Zero-area rectangles cannot intersect anything\n   * - Supports optional transformation matrix\n   * @param other - The Rectangle to intersect with `this`\n   * @param transform - Optional transformation matrix of `other`\n   * @returns True if the transformed `other` Rectangle intersects with `this`\n   * @see {@link Rectangle.containsRect} For containment testing\n   * @see {@link Rectangle.contains} For point testing\n   */\n  intersects(other, transform) {\n    if (!transform) {\n      const x02 = this.x < other.x ? other.x : this.x;\n      const x12 = this.right > other.right ? other.right : this.right;\n      if (x12 <= x02) {\n        return false;\n      }\n      const y02 = this.y < other.y ? other.y : this.y;\n      const y12 = this.bottom > other.bottom ? other.bottom : this.bottom;\n      return y12 > y02;\n    }\n    const x0 = this.left;\n    const x1 = this.right;\n    const y0 = this.top;\n    const y1 = this.bottom;\n    if (x1 <= x0 || y1 <= y0) {\n      return false;\n    }\n    const lt = tempPoints[0].set(other.left, other.top);\n    const lb = tempPoints[1].set(other.left, other.bottom);\n    const rt = tempPoints[2].set(other.right, other.top);\n    const rb = tempPoints[3].set(other.right, other.bottom);\n    if (rt.x <= lt.x || lb.y <= lt.y) {\n      return false;\n    }\n    const s = Math.sign(transform.a * transform.d - transform.b * transform.c);\n    if (s === 0) {\n      return false;\n    }\n    transform.apply(lt, lt);\n    transform.apply(lb, lb);\n    transform.apply(rt, rt);\n    transform.apply(rb, rb);\n    if (Math.max(lt.x, lb.x, rt.x, rb.x) <= x0 || Math.min(lt.x, lb.x, rt.x, rb.x) >= x1 || Math.max(lt.y, lb.y, rt.y, rb.y) <= y0 || Math.min(lt.y, lb.y, rt.y, rb.y) >= y1) {\n      return false;\n    }\n    const nx = s * (lb.y - lt.y);\n    const ny = s * (lt.x - lb.x);\n    const n00 = nx * x0 + ny * y0;\n    const n10 = nx * x1 + ny * y0;\n    const n01 = nx * x0 + ny * y1;\n    const n11 = nx * x1 + ny * y1;\n    if (Math.max(n00, n10, n01, n11) <= nx * lt.x + ny * lt.y || Math.min(n00, n10, n01, n11) >= nx * rb.x + ny * rb.y) {\n      return false;\n    }\n    const mx = s * (lt.y - rt.y);\n    const my = s * (rt.x - lt.x);\n    const m00 = mx * x0 + my * y0;\n    const m10 = mx * x1 + my * y0;\n    const m01 = mx * x0 + my * y1;\n    const m11 = mx * x1 + my * y1;\n    if (Math.max(m00, m10, m01, m11) <= mx * lt.x + my * lt.y || Math.min(m00, m10, m01, m11) >= mx * rb.x + my * rb.y) {\n      return false;\n    }\n    return true;\n  }\n  /**\n   * Pads the rectangle making it grow in all directions.\n   *\n   * If paddingY is omitted, both paddingX and paddingY will be set to paddingX.\n   * @example\n   * ```ts\n   * // Basic padding\n   * const rect = new Rectangle(100, 100, 200, 150);\n   * rect.pad(10); // Adds 10px padding on all sides\n   *\n   * // Different horizontal and vertical padding\n   * const uiRect = new Rectangle(0, 0, 100, 50);\n   * uiRect.pad(20, 10); // 20px horizontal, 10px vertical\n   * ```\n   * @remarks\n   * - Adjusts x/y by subtracting padding\n   * - Increases width/height by padding * 2\n   * - Common in UI layout calculations\n   * - Chainable with other methods\n   * @param paddingX - The horizontal padding amount\n   * @param paddingY - The vertical padding amount\n   * @returns Returns itself\n   * @see {@link Rectangle.enlarge} For growing to include another rectangle\n   * @see {@link Rectangle.fit} For shrinking to fit within another rectangle\n   */\n  pad(paddingX = 0, paddingY = paddingX) {\n    this.x -= paddingX;\n    this.y -= paddingY;\n    this.width += paddingX * 2;\n    this.height += paddingY * 2;\n    return this;\n  }\n  /**\n   * Fits this rectangle around the passed one.\n   * @example\n   * ```ts\n   * // Basic fitting\n   * const container = new Rectangle(0, 0, 100, 100);\n   * const content = new Rectangle(25, 25, 200, 200);\n   * content.fit(container); // Clips to container bounds\n   * ```\n   * @param rectangle - The rectangle to fit around\n   * @returns Returns itself\n   * @see {@link Rectangle.enlarge} For growing to include another rectangle\n   * @see {@link Rectangle.pad} For adding padding around the rectangle\n   */\n  fit(rectangle) {\n    const x1 = Math.max(this.x, rectangle.x);\n    const x2 = Math.min(this.x + this.width, rectangle.x + rectangle.width);\n    const y1 = Math.max(this.y, rectangle.y);\n    const y2 = Math.min(this.y + this.height, rectangle.y + rectangle.height);\n    this.x = x1;\n    this.width = Math.max(x2 - x1, 0);\n    this.y = y1;\n    this.height = Math.max(y2 - y1, 0);\n    return this;\n  }\n  /**\n   * Enlarges rectangle so that its corners lie on a grid defined by resolution.\n   * @example\n   * ```ts\n   * // Basic grid alignment\n   * const rect = new Rectangle(10.2, 10.6, 100.8, 100.4);\n   * rect.ceil(); // Aligns to whole pixels\n   *\n   * // Custom resolution grid\n   * const uiRect = new Rectangle(5.3, 5.7, 50.2, 50.8);\n   * uiRect.ceil(0.5); // Aligns to half pixels\n   *\n   * // Use with precision value\n   * const preciseRect = new Rectangle(20.001, 20.999, 100.001, 100.999);\n   * preciseRect.ceil(1, 0.01); // Handles small decimal variations\n   * ```\n   * @param resolution - The grid size to align to (1 = whole pixels)\n   * @param eps - Small number to prevent floating point errors\n   * @returns Returns itself\n   * @see {@link Rectangle.fit} For constraining to bounds\n   * @see {@link Rectangle.enlarge} For growing dimensions\n   */\n  ceil(resolution = 1, eps = 1e-3) {\n    const x2 = Math.ceil((this.x + this.width - eps) * resolution) / resolution;\n    const y2 = Math.ceil((this.y + this.height - eps) * resolution) / resolution;\n    this.x = Math.floor((this.x + eps) * resolution) / resolution;\n    this.y = Math.floor((this.y + eps) * resolution) / resolution;\n    this.width = x2 - this.x;\n    this.height = y2 - this.y;\n    return this;\n  }\n  /**\n   * Scales the rectangle's dimensions and position by the specified factors.\n   * @example\n   * ```ts\n   * const rect = new Rectangle(50, 50, 100, 100);\n   *\n   * // Scale uniformly\n   * rect.scale(0.5, 0.5);\n   * // rect is now: x=25, y=25, width=50, height=50\n   *\n   * // non-uniformly\n   * rect.scale(0.5, 1);\n   * // rect is now: x=25, y=50, width=50, height=100\n   * ```\n   * @param x - The factor by which to scale the horizontal properties (x, width).\n   * @param y - The factor by which to scale the vertical properties (y, height).\n   * @returns Returns itself\n   */\n  scale(x, y = x) {\n    this.x *= x;\n    this.y *= y;\n    this.width *= x;\n    this.height *= y;\n    return this;\n  }\n  /**\n   * Enlarges this rectangle to include the passed rectangle.\n   * @example\n   * ```ts\n   * // Basic enlargement\n   * const rect = new Rectangle(50, 50, 100, 100);\n   * const other = new Rectangle(0, 0, 200, 75);\n   * rect.enlarge(other);\n   * // rect is now: x=0, y=0, width=200, height=150\n   *\n   * // Use for bounding box calculation\n   * const bounds = new Rectangle();\n   * objects.forEach((obj) => {\n   *     bounds.enlarge(obj.getBounds());\n   * });\n   * ```\n   * @param rectangle - The rectangle to include\n   * @returns Returns itself\n   * @see {@link Rectangle.fit} For shrinking to fit within another rectangle\n   * @see {@link Rectangle.pad} For adding padding around the rectangle\n   */\n  enlarge(rectangle) {\n    const x1 = Math.min(this.x, rectangle.x);\n    const x2 = Math.max(this.x + this.width, rectangle.x + rectangle.width);\n    const y1 = Math.min(this.y, rectangle.y);\n    const y2 = Math.max(this.y + this.height, rectangle.y + rectangle.height);\n    this.x = x1;\n    this.width = x2 - x1;\n    this.y = y1;\n    this.height = y2 - y1;\n    return this;\n  }\n  /**\n   * Returns the framing rectangle of the rectangle as a Rectangle object\n   * @example\n   * ```ts\n   * // Basic bounds retrieval\n   * const rect = new Rectangle(100, 100, 200, 150);\n   * const bounds = rect.getBounds();\n   *\n   * // Reuse existing rectangle\n   * const out = new Rectangle();\n   * rect.getBounds(out);\n   * ```\n   * @param out - Optional rectangle to store the result\n   * @returns The framing rectangle\n   * @see {@link Rectangle.copyFrom} For direct copying\n   * @see {@link Rectangle.clone} For creating new copy\n   */\n  getBounds(out) {\n    out || (out = new Rectangle());\n    out.copyFrom(this);\n    return out;\n  }\n  /**\n   * Determines whether another Rectangle is fully contained within this Rectangle.\n   *\n   * Rectangles that occupy the same space are considered to be containing each other.\n   *\n   * Rectangles without area (width or height equal to zero) can't contain anything,\n   * not even other arealess rectangles.\n   * @example\n   * ```ts\n   * // Check if one rectangle contains another\n   * const container = new Rectangle(0, 0, 100, 100);\n   * const inner = new Rectangle(25, 25, 50, 50);\n   *\n   * console.log(container.containsRect(inner)); // true\n   *\n   * // Check overlapping rectangles\n   * const partial = new Rectangle(75, 75, 50, 50);\n   * console.log(container.containsRect(partial)); // false\n   *\n   * // Zero-area rectangles\n   * const empty = new Rectangle(0, 0, 0, 100);\n   * console.log(container.containsRect(empty)); // false\n   * ```\n   * @param other - The Rectangle to check for containment\n   * @returns True if other is fully contained within this Rectangle\n   * @see {@link Rectangle.contains} For point containment\n   * @see {@link Rectangle.intersects} For overlap testing\n   */\n  containsRect(other) {\n    if (this.width <= 0 || this.height <= 0)\n      return false;\n    const x1 = other.x;\n    const y1 = other.y;\n    const x2 = other.x + other.width;\n    const y2 = other.y + other.height;\n    return x1 >= this.x && x1 < this.x + this.width && y1 >= this.y && y1 < this.y + this.height && x2 >= this.x && x2 < this.x + this.width && y2 >= this.y && y2 < this.y + this.height;\n  }\n  /**\n   * Sets the position and dimensions of the rectangle.\n   * @example\n   * ```ts\n   * // Basic usage\n   * const rect = new Rectangle();\n   * rect.set(100, 100, 200, 150);\n   *\n   * // Chain with other operations\n   * const bounds = new Rectangle()\n   *     .set(0, 0, 100, 100)\n   *     .pad(10);\n   * ```\n   * @param x - The X coordinate of the upper-left corner of the rectangle\n   * @param y - The Y coordinate of the upper-left corner of the rectangle\n   * @param width - The overall width of the rectangle\n   * @param height - The overall height of the rectangle\n   * @returns Returns itself for method chaining\n   * @see {@link Rectangle.copyFrom} For copying from another rectangle\n   * @see {@link Rectangle.clone} For creating a new copy\n   */\n  set(x, y, width, height) {\n    this.x = x;\n    this.y = y;\n    this.width = width;\n    this.height = height;\n    return this;\n  }\n  toString() {\n    return `[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`;\n  }\n}\n\nexport { Rectangle };\n//# sourceMappingURL=Rectangle.mjs.map\n","\"use strict\";\nconst uidCache = {\n  default: -1\n};\nfunction uid(name = \"default\") {\n  if (uidCache[name] === void 0) {\n    uidCache[name] = -1;\n  }\n  return ++uidCache[name];\n}\nfunction resetUids() {\n  for (const key in uidCache) {\n    delete uidCache[key];\n  }\n}\n\nexport { resetUids, uid };\n//# sourceMappingURL=uid.mjs.map\n","\"use strict\";\nconst warnings = /* @__PURE__ */ new Set();\nconst v8_0_0 = \"8.0.0\";\nconst v8_3_4 = \"8.3.4\";\nconst deprecationState = {\n  quiet: false,\n  noColor: false\n};\nconst deprecation = (version, message, ignoreDepth = 3) => {\n  if (deprecationState.quiet || warnings.has(message))\n    return;\n  let stack = new Error().stack;\n  const deprecationMessage = `${message}\nDeprecated since v${version}`;\n  const useGroup = typeof console.groupCollapsed === \"function\" && !deprecationState.noColor;\n  if (typeof stack === \"undefined\") {\n    console.warn(\"PixiJS Deprecation Warning: \", deprecationMessage);\n  } else {\n    stack = stack.split(\"\\n\").splice(ignoreDepth).join(\"\\n\");\n    if (useGroup) {\n      console.groupCollapsed(\n        \"%cPixiJS Deprecation Warning: %c%s\",\n        \"color:#614108;background:#fffbe6\",\n        \"font-weight:normal;color:#614108;background:#fffbe6\",\n        deprecationMessage\n      );\n      console.warn(stack);\n      console.groupEnd();\n    } else {\n      console.warn(\"PixiJS Deprecation Warning: \", deprecationMessage);\n      console.warn(stack);\n    }\n  }\n  warnings.add(message);\n};\nObject.defineProperties(deprecation, {\n  quiet: {\n    get: () => deprecationState.quiet,\n    set: (value) => {\n      deprecationState.quiet = value;\n    },\n    enumerable: true,\n    configurable: false\n  },\n  noColor: {\n    get: () => deprecationState.noColor,\n    set: (value) => {\n      deprecationState.noColor = value;\n    },\n    enumerable: true,\n    configurable: false\n  }\n});\n\nexport { deprecation, v8_0_0, v8_3_4 };\n//# sourceMappingURL=deprecation.mjs.map\n","\"use strict\";\nconst NOOP = () => {\n};\n\nexport { NOOP };\n//# sourceMappingURL=NOOP.mjs.map\n","\"use strict\";\nfunction nextPow2(v) {\n  v += v === 0 ? 1 : 0;\n  --v;\n  v |= v >>> 1;\n  v |= v >>> 2;\n  v |= v >>> 4;\n  v |= v >>> 8;\n  v |= v >>> 16;\n  return v + 1;\n}\nfunction isPow2(v) {\n  return !(v & v - 1) && !!v;\n}\nfunction log2(v) {\n  let r = (v > 65535 ? 1 : 0) << 4;\n  v >>>= r;\n  let shift = (v > 255 ? 1 : 0) << 3;\n  v >>>= shift;\n  r |= shift;\n  shift = (v > 15 ? 1 : 0) << 2;\n  v >>>= shift;\n  r |= shift;\n  shift = (v > 3 ? 1 : 0) << 1;\n  v >>>= shift;\n  r |= shift;\n  return r | v >> 1;\n}\n\nexport { isPow2, log2, nextPow2 };\n//# sourceMappingURL=pow2.mjs.map\n","\"use strict\";\nfunction definedProps(obj) {\n  const result = {};\n  for (const key in obj) {\n    if (obj[key] !== void 0) {\n      result[key] = obj[key];\n    }\n  }\n  return result;\n}\n\nexport { definedProps };\n//# sourceMappingURL=definedProps.mjs.map\n","import EventEmitter from 'eventemitter3';\nimport { uid } from '../../../../utils/data/uid.mjs';\nimport { deprecation, v8_0_0 } from '../../../../utils/logging/deprecation.mjs';\n\n\"use strict\";\nconst idHash = /* @__PURE__ */ Object.create(null);\nfunction createResourceIdFromString(value) {\n  const id = idHash[value];\n  if (id === void 0) {\n    idHash[value] = uid(\"resource\");\n  }\n  return id;\n}\nconst _TextureStyle = class _TextureStyle extends EventEmitter {\n  /**\n   * @param options - options for the style\n   */\n  constructor(options = {}) {\n    super();\n    /** @internal */\n    this._resourceType = \"textureSampler\";\n    /** @internal */\n    this._touched = 0;\n    /**\n     * Specifies the maximum anisotropy value clamp used by the sampler.\n     * Note: Most implementations support {@link TextureStyle#maxAnisotropy} values in range\n     * between 1 and 16, inclusive. The used value of {@link TextureStyle#maxAnisotropy} will\n     * be clamped to the maximum value that the platform supports.\n     * @internal\n     */\n    this._maxAnisotropy = 1;\n    /**\n     * Has the style been destroyed?\n     * @readonly\n     */\n    this.destroyed = false;\n    options = { ..._TextureStyle.defaultOptions, ...options };\n    this.addressMode = options.addressMode;\n    this.addressModeU = options.addressModeU ?? this.addressModeU;\n    this.addressModeV = options.addressModeV ?? this.addressModeV;\n    this.addressModeW = options.addressModeW ?? this.addressModeW;\n    this.scaleMode = options.scaleMode;\n    this.magFilter = options.magFilter ?? this.magFilter;\n    this.minFilter = options.minFilter ?? this.minFilter;\n    this.mipmapFilter = options.mipmapFilter ?? this.mipmapFilter;\n    this.lodMinClamp = options.lodMinClamp;\n    this.lodMaxClamp = options.lodMaxClamp;\n    this.compare = options.compare;\n    this.maxAnisotropy = options.maxAnisotropy ?? 1;\n  }\n  set addressMode(value) {\n    this.addressModeU = value;\n    this.addressModeV = value;\n    this.addressModeW = value;\n  }\n  /** setting this will set wrapModeU,wrapModeV and wrapModeW all at once! */\n  get addressMode() {\n    return this.addressModeU;\n  }\n  set wrapMode(value) {\n    deprecation(v8_0_0, \"TextureStyle.wrapMode is now TextureStyle.addressMode\");\n    this.addressMode = value;\n  }\n  get wrapMode() {\n    return this.addressMode;\n  }\n  set scaleMode(value) {\n    this.magFilter = value;\n    this.minFilter = value;\n    this.mipmapFilter = value;\n  }\n  /** setting this will set magFilter,minFilter and mipmapFilter all at once!  */\n  get scaleMode() {\n    return this.magFilter;\n  }\n  /** Specifies the maximum anisotropy value clamp used by the sampler. */\n  set maxAnisotropy(value) {\n    this._maxAnisotropy = Math.min(value, 16);\n    if (this._maxAnisotropy > 1) {\n      this.scaleMode = \"linear\";\n    }\n  }\n  get maxAnisotropy() {\n    return this._maxAnisotropy;\n  }\n  // TODO - move this to WebGL?\n  get _resourceId() {\n    return this._sharedResourceId || this._generateResourceId();\n  }\n  update() {\n    this.emit(\"change\", this);\n    this._sharedResourceId = null;\n  }\n  _generateResourceId() {\n    const bigKey = `${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;\n    this._sharedResourceId = createResourceIdFromString(bigKey);\n    return this._resourceId;\n  }\n  /** Destroys the style */\n  destroy() {\n    this.destroyed = true;\n    this.emit(\"destroy\", this);\n    this.emit(\"change\", this);\n    this.removeAllListeners();\n  }\n};\n/** default options for the style */\n_TextureStyle.defaultOptions = {\n  addressMode: \"clamp-to-edge\",\n  scaleMode: \"linear\"\n};\nlet TextureStyle = _TextureStyle;\n\nexport { TextureStyle };\n//# sourceMappingURL=TextureStyle.mjs.map\n","import EventEmitter from 'eventemitter3';\nimport { isPow2 } from '../../../../../maths/misc/pow2.mjs';\nimport { definedProps } from '../../../../../scene/container/utils/definedProps.mjs';\nimport { uid } from '../../../../../utils/data/uid.mjs';\nimport { TextureStyle } from '../TextureStyle.mjs';\n\n\"use strict\";\nconst _TextureSource = class _TextureSource extends EventEmitter {\n  /**\n   * @param options - options for creating a new TextureSource\n   */\n  constructor(options = {}) {\n    super();\n    this.options = options;\n    /** unique id for this Texture source */\n    this.uid = uid(\"textureSource\");\n    /**\n     * The resource type used by this TextureSource. This is used by the bind groups to determine\n     * how to handle this resource.\n     * @internal\n     */\n    this._resourceType = \"textureSource\";\n    /**\n     * i unique resource id, used by the bind group systems.\n     * This can change if the texture is resized or its resource changes\n     * @internal\n     */\n    this._resourceId = uid(\"resource\");\n    /**\n     * this is how the backends know how to upload this texture to the GPU\n     * It changes depending on the resource type. Classes that extend TextureSource\n     * should override this property.\n     * @internal\n     */\n    this.uploadMethodId = \"unknown\";\n    /** @internal */\n    this._resolution = 1;\n    /** the pixel width of this texture source. This is the REAL pure number, not accounting resolution */\n    this.pixelWidth = 1;\n    /** the pixel height of this texture source. This is the REAL pure number, not accounting resolution */\n    this.pixelHeight = 1;\n    /**\n     * the width of this texture source, accounting for resolution\n     * eg pixelWidth 200, resolution 2, then width will be 100\n     */\n    this.width = 1;\n    /**\n     * the height of this texture source, accounting for resolution\n     * eg pixelHeight 200, resolution 2, then height will be 100\n     */\n    this.height = 1;\n    /**\n     * The number of samples of a multisample texture. This is always 1 for non-multisample textures.\n     * To enable multisample for a texture, set antialias to true\n     * @internal\n     */\n    this.sampleCount = 1;\n    /** The number of mip levels to generate for this texture. this is  overridden if autoGenerateMipmaps is true */\n    this.mipLevelCount = 1;\n    /**\n     * Should we auto generate mipmaps for this texture? This will automatically generate mipmaps\n     * for this texture when uploading to the GPU. Mipmapped textures take up more memory, but\n     * can look better when scaled down.\n     *\n     * For performance reasons, it is recommended to NOT use this with RenderTextures, as they are often updated every frame.\n     * If you do, make sure to call `updateMipmaps` after you update the texture.\n     */\n    this.autoGenerateMipmaps = false;\n    /** the format that the texture data has */\n    this.format = \"rgba8unorm\";\n    /** how many dimensions does this texture have? currently v8 only supports 2d */\n    this.dimension = \"2d\";\n    /**\n     * Only really affects RenderTextures.\n     * Should we use antialiasing for this texture. It will look better, but may impact performance as a\n     * Blit operation will be required to resolve the texture.\n     */\n    this.antialias = false;\n    /**\n     * Used by automatic texture Garbage Collection, stores last GC tick when it was bound\n     * @protected\n     */\n    this._touched = 0;\n    /**\n     * Used by the batcher to build texture batches. faster to have the variable here!\n     * @protected\n     */\n    this._batchTick = -1;\n    /**\n     * A temporary batch location for the texture batching. Here for performance reasons only!\n     * @protected\n     */\n    this._textureBindLocation = -1;\n    options = { ..._TextureSource.defaultOptions, ...options };\n    this.label = options.label ?? \"\";\n    this.resource = options.resource;\n    this.autoGarbageCollect = options.autoGarbageCollect;\n    this._resolution = options.resolution;\n    if (options.width) {\n      this.pixelWidth = options.width * this._resolution;\n    } else {\n      this.pixelWidth = this.resource ? this.resourceWidth ?? 1 : 1;\n    }\n    if (options.height) {\n      this.pixelHeight = options.height * this._resolution;\n    } else {\n      this.pixelHeight = this.resource ? this.resourceHeight ?? 1 : 1;\n    }\n    this.width = this.pixelWidth / this._resolution;\n    this.height = this.pixelHeight / this._resolution;\n    this.format = options.format;\n    this.dimension = options.dimensions;\n    this.mipLevelCount = options.mipLevelCount;\n    this.autoGenerateMipmaps = options.autoGenerateMipmaps;\n    this.sampleCount = options.sampleCount;\n    this.antialias = options.antialias;\n    this.alphaMode = options.alphaMode;\n    this.style = new TextureStyle(definedProps(options));\n    this.destroyed = false;\n    this._refreshPOT();\n  }\n  /** returns itself */\n  get source() {\n    return this;\n  }\n  /** the style of the texture */\n  get style() {\n    return this._style;\n  }\n  set style(value) {\n    if (this.style === value)\n      return;\n    this._style?.off(\"change\", this._onStyleChange, this);\n    this._style = value;\n    this._style?.on(\"change\", this._onStyleChange, this);\n    this._onStyleChange();\n  }\n  /** Specifies the maximum anisotropy value clamp used by the sampler. */\n  set maxAnisotropy(value) {\n    this._style.maxAnisotropy = value;\n  }\n  get maxAnisotropy() {\n    return this._style.maxAnisotropy;\n  }\n  /** setting this will set wrapModeU, wrapModeV and wrapModeW all at once! */\n  get addressMode() {\n    return this._style.addressMode;\n  }\n  set addressMode(value) {\n    this._style.addressMode = value;\n  }\n  /** setting this will set wrapModeU, wrapModeV and wrapModeW all at once! */\n  get repeatMode() {\n    return this._style.addressMode;\n  }\n  set repeatMode(value) {\n    this._style.addressMode = value;\n  }\n  /** Specifies the sampling behavior when the sample footprint is smaller than or equal to one texel. */\n  get magFilter() {\n    return this._style.magFilter;\n  }\n  set magFilter(value) {\n    this._style.magFilter = value;\n  }\n  /** Specifies the sampling behavior when the sample footprint is larger than one texel. */\n  get minFilter() {\n    return this._style.minFilter;\n  }\n  set minFilter(value) {\n    this._style.minFilter = value;\n  }\n  /** Specifies behavior for sampling between mipmap levels. */\n  get mipmapFilter() {\n    return this._style.mipmapFilter;\n  }\n  set mipmapFilter(value) {\n    this._style.mipmapFilter = value;\n  }\n  /** Specifies the minimum and maximum levels of detail, respectively, used internally when sampling a texture. */\n  get lodMinClamp() {\n    return this._style.lodMinClamp;\n  }\n  set lodMinClamp(value) {\n    this._style.lodMinClamp = value;\n  }\n  /** Specifies the minimum and maximum levels of detail, respectively, used internally when sampling a texture. */\n  get lodMaxClamp() {\n    return this._style.lodMaxClamp;\n  }\n  set lodMaxClamp(value) {\n    this._style.lodMaxClamp = value;\n  }\n  _onStyleChange() {\n    this.emit(\"styleChange\", this);\n  }\n  /** call this if you have modified the texture outside of the constructor */\n  update() {\n    if (this.resource) {\n      const resolution = this._resolution;\n      const didResize = this.resize(this.resourceWidth / resolution, this.resourceHeight / resolution);\n      if (didResize)\n        return;\n    }\n    this.emit(\"update\", this);\n  }\n  /** Destroys this texture source */\n  destroy() {\n    this.destroyed = true;\n    this.emit(\"destroy\", this);\n    this.emit(\"change\", this);\n    if (this._style) {\n      this._style.destroy();\n      this._style = null;\n    }\n    this.uploadMethodId = null;\n    this.resource = null;\n    this.removeAllListeners();\n  }\n  /**\n   * This will unload the Texture source from the GPU. This will free up the GPU memory\n   * As soon as it is required fore rendering, it will be re-uploaded.\n   */\n  unload() {\n    this._resourceId = uid(\"resource\");\n    this.emit(\"change\", this);\n    this.emit(\"unload\", this);\n  }\n  /** the width of the resource. This is the REAL pure number, not accounting resolution   */\n  get resourceWidth() {\n    const { resource } = this;\n    return resource.naturalWidth || resource.videoWidth || resource.displayWidth || resource.width;\n  }\n  /** the height of the resource. This is the REAL pure number, not accounting resolution */\n  get resourceHeight() {\n    const { resource } = this;\n    return resource.naturalHeight || resource.videoHeight || resource.displayHeight || resource.height;\n  }\n  /**\n   * the resolution of the texture. Changing this number, will not change the number of pixels in the actual texture\n   * but will the size of the texture when rendered.\n   *\n   * changing the resolution of this texture to 2 for example will make it appear twice as small when rendered (as pixel\n   * density will have increased)\n   */\n  get resolution() {\n    return this._resolution;\n  }\n  set resolution(resolution) {\n    if (this._resolution === resolution)\n      return;\n    this._resolution = resolution;\n    this.width = this.pixelWidth / resolution;\n    this.height = this.pixelHeight / resolution;\n  }\n  /**\n   * Resize the texture, this is handy if you want to use the texture as a render texture\n   * @param width - the new width of the texture\n   * @param height - the new height of the texture\n   * @param resolution - the new resolution of the texture\n   * @returns - if the texture was resized\n   */\n  resize(width, height, resolution) {\n    resolution || (resolution = this._resolution);\n    width || (width = this.width);\n    height || (height = this.height);\n    const newPixelWidth = Math.round(width * resolution);\n    const newPixelHeight = Math.round(height * resolution);\n    this.width = newPixelWidth / resolution;\n    this.height = newPixelHeight / resolution;\n    this._resolution = resolution;\n    if (this.pixelWidth === newPixelWidth && this.pixelHeight === newPixelHeight) {\n      return false;\n    }\n    this._refreshPOT();\n    this.pixelWidth = newPixelWidth;\n    this.pixelHeight = newPixelHeight;\n    this.emit(\"resize\", this);\n    this._resourceId = uid(\"resource\");\n    this.emit(\"change\", this);\n    return true;\n  }\n  /**\n   * Lets the renderer know that this texture has been updated and its mipmaps should be re-generated.\n   * This is only important for RenderTexture instances, as standard Texture instances will have their\n   * mipmaps generated on upload. You should call this method after you make any change to the texture\n   *\n   * The reason for this is is can be quite expensive to update mipmaps for a texture. So by default,\n   * We want you, the developer to specify when this action should happen.\n   *\n   * Generally you don't want to have mipmaps generated on Render targets that are changed every frame,\n   */\n  updateMipmaps() {\n    if (this.autoGenerateMipmaps && this.mipLevelCount > 1) {\n      this.emit(\"updateMipmaps\", this);\n    }\n  }\n  set wrapMode(value) {\n    this._style.wrapMode = value;\n  }\n  get wrapMode() {\n    return this._style.wrapMode;\n  }\n  set scaleMode(value) {\n    this._style.scaleMode = value;\n  }\n  /** setting this will set magFilter,minFilter and mipmapFilter all at once!  */\n  get scaleMode() {\n    return this._style.scaleMode;\n  }\n  /**\n   * Refresh check for isPowerOfTwo texture based on size\n   * @private\n   */\n  _refreshPOT() {\n    this.isPowerOfTwo = isPow2(this.pixelWidth) && isPow2(this.pixelHeight);\n  }\n  static test(_resource) {\n    throw new Error(\"Unimplemented\");\n  }\n};\n/** The default options used when creating a new TextureSource. override these to add your own defaults */\n_TextureSource.defaultOptions = {\n  resolution: 1,\n  format: \"bgra8unorm\",\n  alphaMode: \"premultiply-alpha-on-upload\",\n  dimensions: \"2d\",\n  mipLevelCount: 1,\n  autoGenerateMipmaps: false,\n  sampleCount: 1,\n  antialias: false,\n  autoGarbageCollect: false\n};\nlet TextureSource = _TextureSource;\n\nexport { TextureSource };\n//# sourceMappingURL=TextureSource.mjs.map\n","import { ExtensionType } from '../../../../../extensions/Extensions.mjs';\nimport { TextureSource } from './TextureSource.mjs';\n\n\"use strict\";\nclass BufferImageSource extends TextureSource {\n  constructor(options) {\n    const buffer = options.resource || new Float32Array(options.width * options.height * 4);\n    let format = options.format;\n    if (!format) {\n      if (buffer instanceof Float32Array) {\n        format = \"rgba32float\";\n      } else if (buffer instanceof Int32Array) {\n        format = \"rgba32uint\";\n      } else if (buffer instanceof Uint32Array) {\n        format = \"rgba32uint\";\n      } else if (buffer instanceof Int16Array) {\n        format = \"rgba16uint\";\n      } else if (buffer instanceof Uint16Array) {\n        format = \"rgba16uint\";\n      } else if (buffer instanceof Int8Array) {\n        format = \"bgra8unorm\";\n      } else {\n        format = \"bgra8unorm\";\n      }\n    }\n    super({\n      ...options,\n      resource: buffer,\n      format\n    });\n    this.uploadMethodId = \"buffer\";\n  }\n  static test(resource) {\n    return resource instanceof Int8Array || resource instanceof Uint8Array || resource instanceof Uint8ClampedArray || resource instanceof Int16Array || resource instanceof Uint16Array || resource instanceof Int32Array || resource instanceof Uint32Array || resource instanceof Float32Array;\n  }\n}\nBufferImageSource.extension = ExtensionType.TextureSource;\n\nexport { BufferImageSource };\n//# sourceMappingURL=BufferImageSource.mjs.map\n","import { Matrix } from '../../../../maths/matrix/Matrix.mjs';\n\n\"use strict\";\nconst tempMat = new Matrix();\nclass TextureMatrix {\n  /**\n   * @param texture - observed texture\n   * @param clampMargin - Changes frame clamping, 0.5 by default. Use -0.5 for extra border.\n   */\n  constructor(texture, clampMargin) {\n    this.mapCoord = new Matrix();\n    this.uClampFrame = new Float32Array(4);\n    this.uClampOffset = new Float32Array(2);\n    this._textureID = -1;\n    this._updateID = 0;\n    this.clampOffset = 0;\n    if (typeof clampMargin === \"undefined\") {\n      this.clampMargin = texture.width < 10 ? 0 : 0.5;\n    } else {\n      this.clampMargin = clampMargin;\n    }\n    this.isSimple = false;\n    this.texture = texture;\n  }\n  /** Texture property. */\n  get texture() {\n    return this._texture;\n  }\n  set texture(value) {\n    if (this.texture === value)\n      return;\n    this._texture?.removeListener(\"update\", this.update, this);\n    this._texture = value;\n    this._texture.addListener(\"update\", this.update, this);\n    this.update();\n  }\n  /**\n   * Multiplies uvs array to transform\n   * @param uvs - mesh uvs\n   * @param [out=uvs] - output\n   * @returns - output\n   */\n  multiplyUvs(uvs, out) {\n    if (out === void 0) {\n      out = uvs;\n    }\n    const mat = this.mapCoord;\n    for (let i = 0; i < uvs.length; i += 2) {\n      const x = uvs[i];\n      const y = uvs[i + 1];\n      out[i] = x * mat.a + y * mat.c + mat.tx;\n      out[i + 1] = x * mat.b + y * mat.d + mat.ty;\n    }\n    return out;\n  }\n  /**\n   * Updates matrices if texture was changed\n   * @returns - whether or not it was updated\n   */\n  update() {\n    const tex = this._texture;\n    this._updateID++;\n    const uvs = tex.uvs;\n    this.mapCoord.set(uvs.x1 - uvs.x0, uvs.y1 - uvs.y0, uvs.x3 - uvs.x0, uvs.y3 - uvs.y0, uvs.x0, uvs.y0);\n    const orig = tex.orig;\n    const trim = tex.trim;\n    if (trim) {\n      tempMat.set(\n        orig.width / trim.width,\n        0,\n        0,\n        orig.height / trim.height,\n        -trim.x / trim.width,\n        -trim.y / trim.height\n      );\n      this.mapCoord.append(tempMat);\n    }\n    const texBase = tex.source;\n    const frame = this.uClampFrame;\n    const margin = this.clampMargin / texBase._resolution;\n    const offset = this.clampOffset / texBase._resolution;\n    frame[0] = (tex.frame.x + margin + offset) / texBase.width;\n    frame[1] = (tex.frame.y + margin + offset) / texBase.height;\n    frame[2] = (tex.frame.x + tex.frame.width - margin + offset) / texBase.width;\n    frame[3] = (tex.frame.y + tex.frame.height - margin + offset) / texBase.height;\n    this.uClampOffset[0] = this.clampOffset / texBase.pixelWidth;\n    this.uClampOffset[1] = this.clampOffset / texBase.pixelHeight;\n    this.isSimple = tex.frame.width === texBase.width && tex.frame.height === texBase.height && tex.rotate === 0;\n    return true;\n  }\n}\n\nexport { TextureMatrix };\n//# sourceMappingURL=TextureMatrix.mjs.map\n","import EventEmitter from 'eventemitter3';\nimport { groupD8 } from '../../../../maths/matrix/groupD8.mjs';\nimport { Rectangle } from '../../../../maths/shapes/Rectangle.mjs';\nimport { uid } from '../../../../utils/data/uid.mjs';\nimport { deprecation, v8_0_0 } from '../../../../utils/logging/deprecation.mjs';\nimport { NOOP } from '../../../../utils/misc/NOOP.mjs';\nimport { BufferImageSource } from './sources/BufferImageSource.mjs';\nimport { TextureSource } from './sources/TextureSource.mjs';\nimport { TextureMatrix } from './TextureMatrix.mjs';\n\n\"use strict\";\nclass Texture extends EventEmitter {\n  /**\n   * @param {TextureOptions} options - Options for the texture\n   */\n  constructor({\n    source,\n    label,\n    frame,\n    orig,\n    trim,\n    defaultAnchor,\n    defaultBorders,\n    rotate,\n    dynamic\n  } = {}) {\n    super();\n    /** unique id for this texture */\n    this.uid = uid(\"texture\");\n    /** A uvs object based on the given frame and the texture source */\n    this.uvs = { x0: 0, y0: 0, x1: 0, y1: 0, x2: 0, y2: 0, x3: 0, y3: 0 };\n    /**\n     * This is the area of the BaseTexture image to actually copy to the Canvas / WebGL when rendering,\n     * irrespective of the actual frame size or placement (which can be influenced by trimmed texture atlases)\n     */\n    this.frame = new Rectangle();\n    /**\n     * Does this Texture have any frame data assigned to it?\n     *\n     * This mode is enabled automatically if no frame was passed inside constructor.\n     *\n     * In this mode texture is subscribed to baseTexture events, and fires `update` on any change.\n     *\n     * Beware, after loading or resize of baseTexture event can fired two times!\n     * If you want more control, subscribe on baseTexture itself.\n     * @example\n     * texture.on('update', () => {});\n     */\n    this.noFrame = false;\n    /**\n     * Set to true if you plan on modifying the uvs of this texture.\n     * When this is the case, sprites and other objects using the texture will\n     * make sure to listen for changes to the uvs and update their vertices accordingly.\n     */\n    this.dynamic = false;\n    /** is it a texture? yes! used for type checking */\n    this.isTexture = true;\n    this.label = label;\n    this.source = source?.source ?? new TextureSource();\n    this.noFrame = !frame;\n    if (frame) {\n      this.frame.copyFrom(frame);\n    } else {\n      const { width, height } = this._source;\n      this.frame.width = width;\n      this.frame.height = height;\n    }\n    this.orig = orig || this.frame;\n    this.trim = trim;\n    this.rotate = rotate ?? 0;\n    this.defaultAnchor = defaultAnchor;\n    this.defaultBorders = defaultBorders;\n    this.destroyed = false;\n    this.dynamic = dynamic || false;\n    this.updateUvs();\n  }\n  set source(value) {\n    if (this._source) {\n      this._source.off(\"resize\", this.update, this);\n    }\n    this._source = value;\n    value.on(\"resize\", this.update, this);\n    this.emit(\"update\", this);\n  }\n  /** the underlying source of the texture (equivalent of baseTexture in v7) */\n  get source() {\n    return this._source;\n  }\n  /** returns a TextureMatrix instance for this texture. By default, that object is not created because its heavy. */\n  get textureMatrix() {\n    if (!this._textureMatrix) {\n      this._textureMatrix = new TextureMatrix(this);\n    }\n    return this._textureMatrix;\n  }\n  /** The width of the Texture in pixels. */\n  get width() {\n    return this.orig.width;\n  }\n  /** The height of the Texture in pixels. */\n  get height() {\n    return this.orig.height;\n  }\n  /** Call this function when you have modified the frame of this texture. */\n  updateUvs() {\n    const { uvs, frame } = this;\n    const { width, height } = this._source;\n    const nX = frame.x / width;\n    const nY = frame.y / height;\n    const nW = frame.width / width;\n    const nH = frame.height / height;\n    let rotate = this.rotate;\n    if (rotate) {\n      const w2 = nW / 2;\n      const h2 = nH / 2;\n      const cX = nX + w2;\n      const cY = nY + h2;\n      rotate = groupD8.add(rotate, groupD8.NW);\n      uvs.x0 = cX + w2 * groupD8.uX(rotate);\n      uvs.y0 = cY + h2 * groupD8.uY(rotate);\n      rotate = groupD8.add(rotate, 2);\n      uvs.x1 = cX + w2 * groupD8.uX(rotate);\n      uvs.y1 = cY + h2 * groupD8.uY(rotate);\n      rotate = groupD8.add(rotate, 2);\n      uvs.x2 = cX + w2 * groupD8.uX(rotate);\n      uvs.y2 = cY + h2 * groupD8.uY(rotate);\n      rotate = groupD8.add(rotate, 2);\n      uvs.x3 = cX + w2 * groupD8.uX(rotate);\n      uvs.y3 = cY + h2 * groupD8.uY(rotate);\n    } else {\n      uvs.x0 = nX;\n      uvs.y0 = nY;\n      uvs.x1 = nX + nW;\n      uvs.y1 = nY;\n      uvs.x2 = nX + nW;\n      uvs.y2 = nY + nH;\n      uvs.x3 = nX;\n      uvs.y3 = nY + nH;\n    }\n  }\n  /**\n   * Destroys this texture\n   * @param destroySource - Destroy the source when the texture is destroyed.\n   */\n  destroy(destroySource = false) {\n    if (this._source) {\n      if (destroySource) {\n        this._source.destroy();\n        this._source = null;\n      }\n    }\n    this._textureMatrix = null;\n    this.destroyed = true;\n    this.emit(\"destroy\", this);\n    this.removeAllListeners();\n  }\n  /**\n   * Call this if you have modified the `texture outside` of the constructor.\n   *\n   * If you have modified this texture's source, you must separately call `texture.source.update()` to see those changes.\n   */\n  update() {\n    if (this.noFrame) {\n      this.frame.width = this._source.width;\n      this.frame.height = this._source.height;\n    }\n    this.updateUvs();\n    this.emit(\"update\", this);\n  }\n  /** @deprecated since 8.0.0 */\n  get baseTexture() {\n    deprecation(v8_0_0, \"Texture.baseTexture is now Texture.source\");\n    return this._source;\n  }\n}\nTexture.EMPTY = new Texture({\n  label: \"EMPTY\",\n  source: new TextureSource({\n    label: \"EMPTY\"\n  })\n});\nTexture.EMPTY.destroy = NOOP;\nTexture.WHITE = new Texture({\n  source: new BufferImageSource({\n    resource: new Uint8Array([255, 255, 255, 255]),\n    width: 1,\n    height: 1,\n    alphaMode: \"premultiply-alpha-on-upload\",\n    label: \"WHITE\"\n  }),\n  label: \"WHITE\"\n});\nTexture.WHITE.destroy = NOOP;\n\nexport { Texture };\n//# sourceMappingURL=Texture.mjs.map\n","\"use strict\";\nfunction updateQuadBounds(bounds, anchor, texture) {\n  const { width, height } = texture.orig;\n  const trim = texture.trim;\n  if (trim) {\n    const sourceWidth = trim.width;\n    const sourceHeight = trim.height;\n    bounds.minX = trim.x - anchor._x * width;\n    bounds.maxX = bounds.minX + sourceWidth;\n    bounds.minY = trim.y - anchor._y * height;\n    bounds.maxY = bounds.minY + sourceHeight;\n  } else {\n    bounds.minX = -anchor._x * width;\n    bounds.maxX = bounds.minX + width;\n    bounds.minY = -anchor._y * height;\n    bounds.maxY = bounds.minY + height;\n  }\n}\n\nexport { updateQuadBounds };\n//# sourceMappingURL=updateQuadBounds.mjs.map\n","import { Matrix } from '../../../maths/matrix/Matrix.mjs';\nimport { Rectangle } from '../../../maths/shapes/Rectangle.mjs';\n\n\"use strict\";\nconst defaultMatrix = new Matrix();\nclass Bounds {\n  /**\n   * Creates a new Bounds object.\n   * @param minX - The minimum X coordinate of the bounds.\n   * @param minY - The minimum Y coordinate of the bounds.\n   * @param maxX - The maximum X coordinate of the bounds.\n   * @param maxY - The maximum Y coordinate of the bounds.\n   */\n  constructor(minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity) {\n    /**\n     * The minimum X coordinate of the bounds.\n     * Represents the leftmost edge of the bounding box.\n     * @example\n     * ```ts\n     * const bounds = new Bounds();\n     * // Set left edge\n     * bounds.minX = 100;\n     * ```\n     * @default Infinity\n     */\n    this.minX = Infinity;\n    /**\n     * The minimum Y coordinate of the bounds.\n     * Represents the topmost edge of the bounding box.\n     * @example\n     * ```ts\n     * const bounds = new Bounds();\n     * // Set top edge\n     * bounds.minY = 100;\n     * ```\n     * @default Infinity\n     */\n    this.minY = Infinity;\n    /**\n     * The maximum X coordinate of the bounds.\n     * Represents the rightmost edge of the bounding box.\n     * @example\n     * ```ts\n     * const bounds = new Bounds();\n     * // Set right edge\n     * bounds.maxX = 200;\n     * // Get width\n     * const width = bounds.maxX - bounds.minX;\n     * ```\n     * @default -Infinity\n     */\n    this.maxX = -Infinity;\n    /**\n     * The maximum Y coordinate of the bounds.\n     * Represents the bottommost edge of the bounding box.\n     * @example\n     * ```ts\n     * const bounds = new Bounds();\n     * // Set bottom edge\n     * bounds.maxY = 200;\n     * // Get height\n     * const height = bounds.maxY - bounds.minY;\n     * ```\n     * @default -Infinity\n     */\n    this.maxY = -Infinity;\n    /**\n     * The transformation matrix applied to this bounds object.\n     * Used when calculating bounds with transforms.\n     * @example\n     * ```ts\n     * const bounds = new Bounds();\n     *\n     * // Apply translation matrix\n     * bounds.matrix = new Matrix()\n     *     .translate(100, 100);\n     *\n     * // Combine transformations\n     * bounds.matrix = new Matrix()\n     *     .translate(50, 50)\n     *     .rotate(Math.PI / 4)\n     *     .scale(2, 2);\n     *\n     * // Use in bounds calculations\n     * bounds.addFrame(0, 0, 100, 100); // Uses current matrix\n     * bounds.addFrame(0, 0, 100, 100, customMatrix); // Override matrix\n     * ```\n     * @advanced\n     */\n    this.matrix = defaultMatrix;\n    this.minX = minX;\n    this.minY = minY;\n    this.maxX = maxX;\n    this.maxY = maxY;\n  }\n  /**\n   * Checks if bounds are empty, meaning either width or height is zero or negative.\n   * Empty bounds occur when min values exceed max values on either axis.\n   * @example\n   * ```ts\n   * const bounds = new Bounds();\n   *\n   * // Check if newly created bounds are empty\n   * console.log(bounds.isEmpty()); // true, default bounds are empty\n   *\n   * // Add frame and check again\n   * bounds.addFrame(0, 0, 100, 100);\n   * console.log(bounds.isEmpty()); // false, bounds now have area\n   *\n   * // Clear bounds\n   * bounds.clear();\n   * console.log(bounds.isEmpty()); // true, bounds are empty again\n   * ```\n   * @returns True if bounds are empty (have no area)\n   * @see {@link Bounds#clear} For resetting bounds\n   * @see {@link Bounds#isValid} For checking validity\n   */\n  isEmpty() {\n    return this.minX > this.maxX || this.minY > this.maxY;\n  }\n  /**\n   * The bounding rectangle representation of these bounds.\n   * Lazily creates and updates a Rectangle instance based on the current bounds.\n   * @example\n   * ```ts\n   * const bounds = new Bounds(0, 0, 100, 100);\n   *\n   * // Get rectangle representation\n   * const rect = bounds.rectangle;\n   * console.log(rect.x, rect.y, rect.width, rect.height);\n   *\n   * // Use for hit testing\n   * if (bounds.rectangle.contains(mouseX, mouseY)) {\n   *     console.log('Mouse is inside bounds!');\n   * }\n   * ```\n   * @see {@link Rectangle} For rectangle methods\n   * @see {@link Bounds.isEmpty} For bounds validation\n   */\n  get rectangle() {\n    if (!this._rectangle) {\n      this._rectangle = new Rectangle();\n    }\n    const rectangle = this._rectangle;\n    if (this.minX > this.maxX || this.minY > this.maxY) {\n      rectangle.x = 0;\n      rectangle.y = 0;\n      rectangle.width = 0;\n      rectangle.height = 0;\n    } else {\n      rectangle.copyFromBounds(this);\n    }\n    return rectangle;\n  }\n  /**\n   * Clears the bounds and resets all coordinates to their default values.\n   * Resets the transformation matrix back to identity.\n   * @example\n   * ```ts\n   * const bounds = new Bounds(0, 0, 100, 100);\n   * console.log(bounds.isEmpty()); // false\n   * // Clear the bounds\n   * bounds.clear();\n   * console.log(bounds.isEmpty()); // true\n   * ```\n   * @returns This bounds object for chaining\n   */\n  clear() {\n    this.minX = Infinity;\n    this.minY = Infinity;\n    this.maxX = -Infinity;\n    this.maxY = -Infinity;\n    this.matrix = defaultMatrix;\n    return this;\n  }\n  /**\n   * Sets the bounds directly using coordinate values.\n   * Provides a way to set all bounds values at once.\n   * @example\n   * ```ts\n   * const bounds = new Bounds();\n   * bounds.set(0, 0, 100, 100);\n   * ```\n   * @param x0 - Left X coordinate of frame\n   * @param y0 - Top Y coordinate of frame\n   * @param x1 - Right X coordinate of frame\n   * @param y1 - Bottom Y coordinate of frame\n   * @see {@link Bounds#addFrame} For matrix-aware bounds setting\n   * @see {@link Bounds#clear} For resetting bounds\n   */\n  set(x0, y0, x1, y1) {\n    this.minX = x0;\n    this.minY = y0;\n    this.maxX = x1;\n    this.maxY = y1;\n  }\n  /**\n   * Adds a rectangular frame to the bounds, optionally transformed by a matrix.\n   * Updates the bounds to encompass the new frame coordinates.\n   * @example\n   * ```ts\n   * const bounds = new Bounds();\n   * bounds.addFrame(0, 0, 100, 100);\n   *\n   * // Add transformed frame\n   * const matrix = new Matrix()\n   *     .translate(50, 50)\n   *     .rotate(Math.PI / 4);\n   * bounds.addFrame(0, 0, 100, 100, matrix);\n   * ```\n   * @param x0 - Left X coordinate of frame\n   * @param y0 - Top Y coordinate of frame\n   * @param x1 - Right X coordinate of frame\n   * @param y1 - Bottom Y coordinate of frame\n   * @param matrix - Optional transformation matrix\n   * @see {@link Bounds#addRect} For adding Rectangle objects\n   * @see {@link Bounds#addBounds} For adding other Bounds\n   */\n  addFrame(x0, y0, x1, y1, matrix) {\n    matrix || (matrix = this.matrix);\n    const a = matrix.a;\n    const b = matrix.b;\n    const c = matrix.c;\n    const d = matrix.d;\n    const tx = matrix.tx;\n    const ty = matrix.ty;\n    let minX = this.minX;\n    let minY = this.minY;\n    let maxX = this.maxX;\n    let maxY = this.maxY;\n    let x = a * x0 + c * y0 + tx;\n    let y = b * x0 + d * y0 + ty;\n    if (x < minX)\n      minX = x;\n    if (y < minY)\n      minY = y;\n    if (x > maxX)\n      maxX = x;\n    if (y > maxY)\n      maxY = y;\n    x = a * x1 + c * y0 + tx;\n    y = b * x1 + d * y0 + ty;\n    if (x < minX)\n      minX = x;\n    if (y < minY)\n      minY = y;\n    if (x > maxX)\n      maxX = x;\n    if (y > maxY)\n      maxY = y;\n    x = a * x0 + c * y1 + tx;\n    y = b * x0 + d * y1 + ty;\n    if (x < minX)\n      minX = x;\n    if (y < minY)\n      minY = y;\n    if (x > maxX)\n      maxX = x;\n    if (y > maxY)\n      maxY = y;\n    x = a * x1 + c * y1 + tx;\n    y = b * x1 + d * y1 + ty;\n    if (x < minX)\n      minX = x;\n    if (y < minY)\n      minY = y;\n    if (x > maxX)\n      maxX = x;\n    if (y > maxY)\n      maxY = y;\n    this.minX = minX;\n    this.minY = minY;\n    this.maxX = maxX;\n    this.maxY = maxY;\n  }\n  /**\n   * Adds a rectangle to the bounds, optionally transformed by a matrix.\n   * Updates the bounds to encompass the given rectangle.\n   * @example\n   * ```ts\n   * const bounds = new Bounds();\n   * // Add simple rectangle\n   * const rect = new Rectangle(0, 0, 100, 100);\n   * bounds.addRect(rect);\n   *\n   * // Add transformed rectangle\n   * const matrix = new Matrix()\n   *     .translate(50, 50)\n   *     .rotate(Math.PI / 4);\n   * bounds.addRect(rect, matrix);\n   * ```\n   * @param rect - The rectangle to be added\n   * @param matrix - Optional transformation matrix\n   * @see {@link Bounds#addFrame} For adding raw coordinates\n   * @see {@link Bounds#addBounds} For adding other bounds\n   */\n  addRect(rect, matrix) {\n    this.addFrame(rect.x, rect.y, rect.x + rect.width, rect.y + rect.height, matrix);\n  }\n  /**\n   * Adds another bounds object to this one, optionally transformed by a matrix.\n   * Expands the bounds to include the given bounds' area.\n   * @example\n   * ```ts\n   * const bounds = new Bounds();\n   *\n   * // Add child bounds\n   * const childBounds = sprite.getBounds();\n   * bounds.addBounds(childBounds);\n   *\n   * // Add transformed bounds\n   * const matrix = new Matrix()\n   *     .scale(2, 2);\n   * bounds.addBounds(childBounds, matrix);\n   * ```\n   * @param bounds - The bounds to be added\n   * @param matrix - Optional transformation matrix\n   * @see {@link Bounds#addFrame} For adding raw coordinates\n   * @see {@link Bounds#addRect} For adding rectangles\n   */\n  addBounds(bounds, matrix) {\n    this.addFrame(bounds.minX, bounds.minY, bounds.maxX, bounds.maxY, matrix);\n  }\n  /**\n   * Adds other Bounds as a mask, creating an intersection of the two bounds.\n   * Only keeps the overlapping region between current bounds and mask bounds.\n   * @example\n   * ```ts\n   * const bounds = new Bounds(0, 0, 100, 100);\n   * // Create mask bounds\n   * const mask = new Bounds();\n   * mask.addFrame(50, 50, 150, 150);\n   * // Apply mask - results in bounds of (50,50,100,100)\n   * bounds.addBoundsMask(mask);\n   * ```\n   * @param mask - The Bounds to use as a mask\n   * @see {@link Bounds#addBounds} For union operation\n   * @see {@link Bounds#fit} For fitting to rectangle\n   */\n  addBoundsMask(mask) {\n    this.minX = this.minX > mask.minX ? this.minX : mask.minX;\n    this.minY = this.minY > mask.minY ? this.minY : mask.minY;\n    this.maxX = this.maxX < mask.maxX ? this.maxX : mask.maxX;\n    this.maxY = this.maxY < mask.maxY ? this.maxY : mask.maxY;\n  }\n  /**\n   * Applies a transformation matrix to the bounds, updating its coordinates.\n   * Transforms all corners of the bounds using the given matrix.\n   * @example\n   * ```ts\n   * const bounds = new Bounds(0, 0, 100, 100);\n   * // Apply translation\n   * const translateMatrix = new Matrix()\n   *     .translate(50, 50);\n   * bounds.applyMatrix(translateMatrix);\n   * ```\n   * @param matrix - The matrix to apply to the bounds\n   * @see {@link Matrix} For matrix operations\n   * @see {@link Bounds#addFrame} For adding transformed frames\n   */\n  applyMatrix(matrix) {\n    const minX = this.minX;\n    const minY = this.minY;\n    const maxX = this.maxX;\n    const maxY = this.maxY;\n    const { a, b, c, d, tx, ty } = matrix;\n    let x = a * minX + c * minY + tx;\n    let y = b * minX + d * minY + ty;\n    this.minX = x;\n    this.minY = y;\n    this.maxX = x;\n    this.maxY = y;\n    x = a * maxX + c * minY + tx;\n    y = b * maxX + d * minY + ty;\n    this.minX = x < this.minX ? x : this.minX;\n    this.minY = y < this.minY ? y : this.minY;\n    this.maxX = x > this.maxX ? x : this.maxX;\n    this.maxY = y > this.maxY ? y : this.maxY;\n    x = a * minX + c * maxY + tx;\n    y = b * minX + d * maxY + ty;\n    this.minX = x < this.minX ? x : this.minX;\n    this.minY = y < this.minY ? y : this.minY;\n    this.maxX = x > this.maxX ? x : this.maxX;\n    this.maxY = y > this.maxY ? y : this.maxY;\n    x = a * maxX + c * maxY + tx;\n    y = b * maxX + d * maxY + ty;\n    this.minX = x < this.minX ? x : this.minX;\n    this.minY = y < this.minY ? y : this.minY;\n    this.maxX = x > this.maxX ? x : this.maxX;\n    this.maxY = y > this.maxY ? y : this.maxY;\n  }\n  /**\n   * Resizes the bounds object to fit within the given rectangle.\n   * Clips the bounds if they extend beyond the rectangle's edges.\n   * @example\n   * ```ts\n   * const bounds = new Bounds(0, 0, 200, 200);\n   * // Fit within viewport\n   * const viewport = new Rectangle(50, 50, 100, 100);\n   * bounds.fit(viewport);\n   * // bounds are now (50, 50, 150, 150)\n   * ```\n   * @param rect - The rectangle to fit within\n   * @returns This bounds object for chaining\n   * @see {@link Bounds#addBoundsMask} For intersection\n   * @see {@link Bounds#pad} For expanding bounds\n   */\n  fit(rect) {\n    if (this.minX < rect.left)\n      this.minX = rect.left;\n    if (this.maxX > rect.right)\n      this.maxX = rect.right;\n    if (this.minY < rect.top)\n      this.minY = rect.top;\n    if (this.maxY > rect.bottom)\n      this.maxY = rect.bottom;\n    return this;\n  }\n  /**\n   * Resizes the bounds object to include the given bounds.\n   * Similar to fit() but works with raw coordinate values instead of a Rectangle.\n   * @example\n   * ```ts\n   * const bounds = new Bounds(0, 0, 200, 200);\n   * // Fit to specific coordinates\n   * bounds.fitBounds(50, 150, 50, 150);\n   * // bounds are now (50, 50, 150, 150)\n   * ```\n   * @param left - The left value of the bounds\n   * @param right - The right value of the bounds\n   * @param top - The top value of the bounds\n   * @param bottom - The bottom value of the bounds\n   * @returns This bounds object for chaining\n   * @see {@link Bounds#fit} For fitting to Rectangle\n   * @see {@link Bounds#addBoundsMask} For intersection\n   */\n  fitBounds(left, right, top, bottom) {\n    if (this.minX < left)\n      this.minX = left;\n    if (this.maxX > right)\n      this.maxX = right;\n    if (this.minY < top)\n      this.minY = top;\n    if (this.maxY > bottom)\n      this.maxY = bottom;\n    return this;\n  }\n  /**\n   * Pads bounds object, making it grow in all directions.\n   * If paddingY is omitted, both paddingX and paddingY will be set to paddingX.\n   * @example\n   * ```ts\n   * const bounds = new Bounds(0, 0, 100, 100);\n   *\n   * // Add equal padding\n   * bounds.pad(10);\n   * // bounds are now (-10, -10, 110, 110)\n   *\n   * // Add different padding for x and y\n   * bounds.pad(20, 10);\n   * // bounds are now (-30, -20, 130, 120)\n   * ```\n   * @param paddingX - The horizontal padding amount\n   * @param paddingY - The vertical padding amount\n   * @returns This bounds object for chaining\n   * @see {@link Bounds#fit} For constraining bounds\n   * @see {@link Bounds#scale} For uniform scaling\n   */\n  pad(paddingX, paddingY = paddingX) {\n    this.minX -= paddingX;\n    this.maxX += paddingX;\n    this.minY -= paddingY;\n    this.maxY += paddingY;\n    return this;\n  }\n  /**\n   * Ceils the bounds by rounding up max values and rounding down min values.\n   * Useful for pixel-perfect calculations and avoiding fractional pixels.\n   * @example\n   * ```ts\n   * const bounds = new Bounds();\n   * bounds.set(10.2, 10.9, 50.1, 50.8);\n   *\n   * // Round to whole pixels\n   * bounds.ceil();\n   * // bounds are now (10, 10, 51, 51)\n   * ```\n   * @returns This bounds object for chaining\n   * @see {@link Bounds#scale} For size adjustments\n   * @see {@link Bounds#fit} For constraining bounds\n   */\n  ceil() {\n    this.minX = Math.floor(this.minX);\n    this.minY = Math.floor(this.minY);\n    this.maxX = Math.ceil(this.maxX);\n    this.maxY = Math.ceil(this.maxY);\n    return this;\n  }\n  /**\n   * Creates a new Bounds instance with the same values.\n   * @example\n   * ```ts\n   * const bounds = new Bounds(0, 0, 100, 100);\n   *\n   * // Create a copy\n   * const copy = bounds.clone();\n   *\n   * // Original and copy are independent\n   * bounds.pad(10);\n   * console.log(copy.width === bounds.width); // false\n   * ```\n   * @returns A new Bounds instance with the same values\n   * @see {@link Bounds#copyFrom} For reusing existing bounds\n   */\n  clone() {\n    return new Bounds(this.minX, this.minY, this.maxX, this.maxY);\n  }\n  /**\n   * Scales the bounds by the given values, adjusting all edges proportionally.\n   * @example\n   * ```ts\n   * const bounds = new Bounds(0, 0, 100, 100);\n   *\n   * // Scale uniformly\n   * bounds.scale(2);\n   * // bounds are now (0, 0, 200, 200)\n   *\n   * // Scale non-uniformly\n   * bounds.scale(0.5, 2);\n   * // bounds are now (0, 0, 100, 400)\n   * ```\n   * @param x - The X value to scale by\n   * @param y - The Y value to scale by (defaults to x)\n   * @returns This bounds object for chaining\n   * @see {@link Bounds#pad} For adding padding\n   * @see {@link Bounds#fit} For constraining size\n   */\n  scale(x, y = x) {\n    this.minX *= x;\n    this.minY *= y;\n    this.maxX *= x;\n    this.maxY *= y;\n    return this;\n  }\n  /**\n   * The x position of the bounds in local space.\n   * Setting this value will move the bounds while maintaining its width.\n   * @example\n   * ```ts\n   * const bounds = new Bounds(0, 0, 100, 100);\n   * // Get x position\n   * console.log(bounds.x); // 0\n   *\n   * // Move bounds horizontally\n   * bounds.x = 50;\n   * console.log(bounds.minX, bounds.maxX); // 50, 150\n   *\n   * // Width stays the same\n   * console.log(bounds.width); // Still 100\n   * ```\n   */\n  get x() {\n    return this.minX;\n  }\n  set x(value) {\n    const width = this.maxX - this.minX;\n    this.minX = value;\n    this.maxX = value + width;\n  }\n  /**\n   * The y position of the bounds in local space.\n   * Setting this value will move the bounds while maintaining its height.\n   * @example\n   * ```ts\n   * const bounds = new Bounds(0, 0, 100, 100);\n   * // Get y position\n   * console.log(bounds.y); // 0\n   *\n   * // Move bounds vertically\n   * bounds.y = 50;\n   * console.log(bounds.minY, bounds.maxY); // 50, 150\n   *\n   * // Height stays the same\n   * console.log(bounds.height); // Still 100\n   * ```\n   */\n  get y() {\n    return this.minY;\n  }\n  set y(value) {\n    const height = this.maxY - this.minY;\n    this.minY = value;\n    this.maxY = value + height;\n  }\n  /**\n   * The width value of the bounds.\n   * Represents the distance between minX and maxX coordinates.\n   * @example\n   * ```ts\n   * const bounds = new Bounds(0, 0, 100, 100);\n   * // Get width\n   * console.log(bounds.width); // 100\n   * // Resize width\n   * bounds.width = 200;\n   * console.log(bounds.maxX - bounds.minX); // 200\n   * ```\n   */\n  get width() {\n    return this.maxX - this.minX;\n  }\n  set width(value) {\n    this.maxX = this.minX + value;\n  }\n  /**\n   * The height value of the bounds.\n   * Represents the distance between minY and maxY coordinates.\n   * @example\n   * ```ts\n   * const bounds = new Bounds(0, 0, 100, 100);\n   * // Get height\n   * console.log(bounds.height); // 100\n   * // Resize height\n   * bounds.height = 150;\n   * console.log(bounds.maxY - bounds.minY); // 150\n   * ```\n   */\n  get height() {\n    return this.maxY - this.minY;\n  }\n  set height(value) {\n    this.maxY = this.minY + value;\n  }\n  /**\n   * The left edge coordinate of the bounds.\n   * Alias for minX.\n   * @example\n   * ```ts\n   * const bounds = new Bounds(50, 0, 150, 100);\n   * console.log(bounds.left); // 50\n   * console.log(bounds.left === bounds.minX); // true\n   * ```\n   * @readonly\n   */\n  get left() {\n    return this.minX;\n  }\n  /**\n   * The right edge coordinate of the bounds.\n   * Alias for maxX.\n   * @example\n   * ```ts\n   * const bounds = new Bounds(0, 0, 100, 100);\n   * console.log(bounds.right); // 100\n   * console.log(bounds.right === bounds.maxX); // true\n   * ```\n   * @readonly\n   */\n  get right() {\n    return this.maxX;\n  }\n  /**\n   * The top edge coordinate of the bounds.\n   * Alias for minY.\n   * @example\n   * ```ts\n   * const bounds = new Bounds(0, 25, 100, 125);\n   * console.log(bounds.top); // 25\n   * console.log(bounds.top === bounds.minY); // true\n   * ```\n   * @readonly\n   */\n  get top() {\n    return this.minY;\n  }\n  /**\n   * The bottom edge coordinate of the bounds.\n   * Alias for maxY.\n   * @example\n   * ```ts\n   * const bounds = new Bounds(0, 0, 100, 200);\n   * console.log(bounds.bottom); // 200\n   * console.log(bounds.bottom === bounds.maxY); // true\n   * ```\n   * @readonly\n   */\n  get bottom() {\n    return this.maxY;\n  }\n  /**\n   * Whether the bounds has positive width and height.\n   * Checks if both dimensions are greater than zero.\n   * @example\n   * ```ts\n   * const bounds = new Bounds(0, 0, 100, 100);\n   * // Check if bounds are positive\n   * console.log(bounds.isPositive); // true\n   *\n   * // Negative bounds\n   * bounds.maxX = bounds.minX;\n   * console.log(bounds.isPositive); // false, width is 0\n   * ```\n   * @readonly\n   * @see {@link Bounds#isEmpty} For checking empty state\n   * @see {@link Bounds#isValid} For checking validity\n   */\n  get isPositive() {\n    return this.maxX - this.minX > 0 && this.maxY - this.minY > 0;\n  }\n  /**\n   * Whether the bounds has valid coordinates.\n   * Checks if the bounds has been initialized with real values.\n   * @example\n   * ```ts\n   * const bounds = new Bounds();\n   * console.log(bounds.isValid); // false, default state\n   *\n   * // Set valid bounds\n   * bounds.addFrame(0, 0, 100, 100);\n   * console.log(bounds.isValid); // true\n   * ```\n   * @readonly\n   * @see {@link Bounds#isEmpty} For checking empty state\n   * @see {@link Bounds#isPositive} For checking dimensions\n   */\n  get isValid() {\n    return this.minX + this.minY !== Infinity;\n  }\n  /**\n   * Adds vertices from a Float32Array to the bounds, optionally transformed by a matrix.\n   * Used for efficiently updating bounds from raw vertex data.\n   * @example\n   * ```ts\n   * const bounds = new Bounds();\n   *\n   * // Add vertices from geometry\n   * const vertices = new Float32Array([\n   *     0, 0,    // Vertex 1\n   *     100, 0,  // Vertex 2\n   *     100, 100 // Vertex 3\n   * ]);\n   * bounds.addVertexData(vertices, 0, 6);\n   *\n   * // Add transformed vertices\n   * const matrix = new Matrix()\n   *     .translate(50, 50)\n   *     .rotate(Math.PI / 4);\n   * bounds.addVertexData(vertices, 0, 6, matrix);\n   *\n   * // Add subset of vertices\n   * bounds.addVertexData(vertices, 2, 4); // Only second vertex\n   * ```\n   * @param vertexData - The array of vertices to add\n   * @param beginOffset - Starting index in the vertex array\n   * @param endOffset - Ending index in the vertex array (excluded)\n   * @param matrix - Optional transformation matrix\n   * @see {@link Bounds#addFrame} For adding rectangular frames\n   * @see {@link Matrix} For transformation details\n   */\n  addVertexData(vertexData, beginOffset, endOffset, matrix) {\n    let minX = this.minX;\n    let minY = this.minY;\n    let maxX = this.maxX;\n    let maxY = this.maxY;\n    matrix || (matrix = this.matrix);\n    const a = matrix.a;\n    const b = matrix.b;\n    const c = matrix.c;\n    const d = matrix.d;\n    const tx = matrix.tx;\n    const ty = matrix.ty;\n    for (let i = beginOffset; i < endOffset; i += 2) {\n      const localX = vertexData[i];\n      const localY = vertexData[i + 1];\n      const x = a * localX + c * localY + tx;\n      const y = b * localX + d * localY + ty;\n      minX = x < minX ? x : minX;\n      minY = y < minY ? y : minY;\n      maxX = x > maxX ? x : maxX;\n      maxY = y > maxY ? y : maxY;\n    }\n    this.minX = minX;\n    this.minY = minY;\n    this.maxX = maxX;\n    this.maxY = maxY;\n  }\n  /**\n   * Checks if a point is contained within the bounds.\n   * Returns true if the point's coordinates fall within the bounds' area.\n   * @example\n   * ```ts\n   * const bounds = new Bounds(0, 0, 100, 100);\n   * // Basic point check\n   * console.log(bounds.containsPoint(50, 50)); // true\n   * console.log(bounds.containsPoint(150, 150)); // false\n   *\n   * // Check edges\n   * console.log(bounds.containsPoint(0, 0));   // true, includes edges\n   * console.log(bounds.containsPoint(100, 100)); // true, includes edges\n   * ```\n   * @param x - x coordinate to check\n   * @param y - y coordinate to check\n   * @returns True if the point is inside the bounds\n   * @see {@link Bounds#isPositive} For valid bounds check\n   * @see {@link Bounds#rectangle} For Rectangle representation\n   */\n  containsPoint(x, y) {\n    if (this.minX <= x && this.minY <= y && this.maxX >= x && this.maxY >= y) {\n      return true;\n    }\n    return false;\n  }\n  /**\n   * Returns a string representation of the bounds.\n   * Useful for debugging and logging bounds information.\n   * @example\n   * ```ts\n   * const bounds = new Bounds(0, 0, 100, 100);\n   * console.log(bounds.toString()); // \"[pixi.js:Bounds minX=0 minY=0 maxX=100 maxY=100 width=100 height=100]\"\n   * ```\n   * @returns A string describing the bounds\n   * @see {@link Bounds#copyFrom} For copying bounds\n   * @see {@link Bounds#clone} For creating a new instance\n   */\n  toString() {\n    return `[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`;\n  }\n  /**\n   * Copies the bounds from another bounds object.\n   * Useful for reusing bounds objects and avoiding allocations.\n   * @example\n   * ```ts\n   * const sourceBounds = new Bounds(0, 0, 100, 100);\n   * // Copy bounds\n   * const targetBounds = new Bounds();\n   * targetBounds.copyFrom(sourceBounds);\n   * ```\n   * @param bounds - The bounds to copy from\n   * @returns This bounds object for chaining\n   * @see {@link Bounds#clone} For creating new instances\n   */\n  copyFrom(bounds) {\n    this.minX = bounds.minX;\n    this.minY = bounds.minY;\n    this.maxX = bounds.maxX;\n    this.maxY = bounds.maxY;\n    return this;\n  }\n}\n\nexport { Bounds };\n//# sourceMappingURL=Bounds.mjs.map\n","var r={grad:.9,turn:360,rad:360/(2*Math.PI)},t=function(r){return\"string\"==typeof r?r.length>0:\"number\"==typeof r},n=function(r,t,n){return void 0===t&&(t=0),void 0===n&&(n=Math.pow(10,t)),Math.round(n*r)/n+0},e=function(r,t,n){return void 0===t&&(t=0),void 0===n&&(n=1),r>n?n:r>t?r:t},u=function(r){return(r=isFinite(r)?r%360:0)>0?r:r+360},a=function(r){return{r:e(r.r,0,255),g:e(r.g,0,255),b:e(r.b,0,255),a:e(r.a)}},o=function(r){return{r:n(r.r),g:n(r.g),b:n(r.b),a:n(r.a,3)}},i=/^#([0-9a-f]{3,8})$/i,s=function(r){var t=r.toString(16);return t.length<2?\"0\"+t:t},h=function(r){var t=r.r,n=r.g,e=r.b,u=r.a,a=Math.max(t,n,e),o=a-Math.min(t,n,e),i=o?a===t?(n-e)/o:a===n?2+(e-t)/o:4+(t-n)/o:0;return{h:60*(i<0?i+6:i),s:a?o/a*100:0,v:a/255*100,a:u}},b=function(r){var t=r.h,n=r.s,e=r.v,u=r.a;t=t/360*6,n/=100,e/=100;var a=Math.floor(t),o=e*(1-n),i=e*(1-(t-a)*n),s=e*(1-(1-t+a)*n),h=a%6;return{r:255*[e,i,o,o,s,e][h],g:255*[s,e,e,i,o,o][h],b:255*[o,o,s,e,e,i][h],a:u}},g=function(r){return{h:u(r.h),s:e(r.s,0,100),l:e(r.l,0,100),a:e(r.a)}},d=function(r){return{h:n(r.h),s:n(r.s),l:n(r.l),a:n(r.a,3)}},f=function(r){return b((n=(t=r).s,{h:t.h,s:(n*=((e=t.l)<50?e:100-e)/100)>0?2*n/(e+n)*100:0,v:e+n,a:t.a}));var t,n,e},c=function(r){return{h:(t=h(r)).h,s:(u=(200-(n=t.s))*(e=t.v)/100)>0&&u<200?n*e/100/(u<=100?u:200-u)*100:0,l:u/2,a:t.a};var t,n,e,u},l=/^hsla?\\(\\s*([+-]?\\d*\\.?\\d+)(deg|rad|grad|turn)?\\s*,\\s*([+-]?\\d*\\.?\\d+)%\\s*,\\s*([+-]?\\d*\\.?\\d+)%\\s*(?:,\\s*([+-]?\\d*\\.?\\d+)(%)?\\s*)?\\)$/i,p=/^hsla?\\(\\s*([+-]?\\d*\\.?\\d+)(deg|rad|grad|turn)?\\s+([+-]?\\d*\\.?\\d+)%\\s+([+-]?\\d*\\.?\\d+)%\\s*(?:\\/\\s*([+-]?\\d*\\.?\\d+)(%)?\\s*)?\\)$/i,v=/^rgba?\\(\\s*([+-]?\\d*\\.?\\d+)(%)?\\s*,\\s*([+-]?\\d*\\.?\\d+)(%)?\\s*,\\s*([+-]?\\d*\\.?\\d+)(%)?\\s*(?:,\\s*([+-]?\\d*\\.?\\d+)(%)?\\s*)?\\)$/i,m=/^rgba?\\(\\s*([+-]?\\d*\\.?\\d+)(%)?\\s+([+-]?\\d*\\.?\\d+)(%)?\\s+([+-]?\\d*\\.?\\d+)(%)?\\s*(?:\\/\\s*([+-]?\\d*\\.?\\d+)(%)?\\s*)?\\)$/i,y={string:[[function(r){var t=i.exec(r);return t?(r=t[1]).length<=4?{r:parseInt(r[0]+r[0],16),g:parseInt(r[1]+r[1],16),b:parseInt(r[2]+r[2],16),a:4===r.length?n(parseInt(r[3]+r[3],16)/255,2):1}:6===r.length||8===r.length?{r:parseInt(r.substr(0,2),16),g:parseInt(r.substr(2,2),16),b:parseInt(r.substr(4,2),16),a:8===r.length?n(parseInt(r.substr(6,2),16)/255,2):1}:null:null},\"hex\"],[function(r){var t=v.exec(r)||m.exec(r);return t?t[2]!==t[4]||t[4]!==t[6]?null:a({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:void 0===t[7]?1:Number(t[7])/(t[8]?100:1)}):null},\"rgb\"],[function(t){var n=l.exec(t)||p.exec(t);if(!n)return null;var e,u,a=g({h:(e=n[1],u=n[2],void 0===u&&(u=\"deg\"),Number(e)*(r[u]||1)),s:Number(n[3]),l:Number(n[4]),a:void 0===n[5]?1:Number(n[5])/(n[6]?100:1)});return f(a)},\"hsl\"]],object:[[function(r){var n=r.r,e=r.g,u=r.b,o=r.a,i=void 0===o?1:o;return t(n)&&t(e)&&t(u)?a({r:Number(n),g:Number(e),b:Number(u),a:Number(i)}):null},\"rgb\"],[function(r){var n=r.h,e=r.s,u=r.l,a=r.a,o=void 0===a?1:a;if(!t(n)||!t(e)||!t(u))return null;var i=g({h:Number(n),s:Number(e),l:Number(u),a:Number(o)});return f(i)},\"hsl\"],[function(r){var n=r.h,a=r.s,o=r.v,i=r.a,s=void 0===i?1:i;if(!t(n)||!t(a)||!t(o))return null;var h=function(r){return{h:u(r.h),s:e(r.s,0,100),v:e(r.v,0,100),a:e(r.a)}}({h:Number(n),s:Number(a),v:Number(o),a:Number(s)});return b(h)},\"hsv\"]]},N=function(r,t){for(var n=0;n<t.length;n++){var e=t[n][0](r);if(e)return[e,t[n][1]]}return[null,void 0]},x=function(r){return\"string\"==typeof r?N(r.trim(),y.string):\"object\"==typeof r&&null!==r?N(r,y.object):[null,void 0]},I=function(r){return x(r)[1]},M=function(r,t){var n=c(r);return{h:n.h,s:e(n.s+100*t,0,100),l:n.l,a:n.a}},H=function(r){return(299*r.r+587*r.g+114*r.b)/1e3/255},$=function(r,t){var n=c(r);return{h:n.h,s:n.s,l:e(n.l+100*t,0,100),a:n.a}},j=function(){function r(r){this.parsed=x(r)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return r.prototype.isValid=function(){return null!==this.parsed},r.prototype.brightness=function(){return n(H(this.rgba),2)},r.prototype.isDark=function(){return H(this.rgba)<.5},r.prototype.isLight=function(){return H(this.rgba)>=.5},r.prototype.toHex=function(){return r=o(this.rgba),t=r.r,e=r.g,u=r.b,i=(a=r.a)<1?s(n(255*a)):\"\",\"#\"+s(t)+s(e)+s(u)+i;var r,t,e,u,a,i},r.prototype.toRgb=function(){return o(this.rgba)},r.prototype.toRgbString=function(){return r=o(this.rgba),t=r.r,n=r.g,e=r.b,(u=r.a)<1?\"rgba(\"+t+\", \"+n+\", \"+e+\", \"+u+\")\":\"rgb(\"+t+\", \"+n+\", \"+e+\")\";var r,t,n,e,u},r.prototype.toHsl=function(){return d(c(this.rgba))},r.prototype.toHslString=function(){return r=d(c(this.rgba)),t=r.h,n=r.s,e=r.l,(u=r.a)<1?\"hsla(\"+t+\", \"+n+\"%, \"+e+\"%, \"+u+\")\":\"hsl(\"+t+\", \"+n+\"%, \"+e+\"%)\";var r,t,n,e,u},r.prototype.toHsv=function(){return r=h(this.rgba),{h:n(r.h),s:n(r.s),v:n(r.v),a:n(r.a,3)};var r},r.prototype.invert=function(){return w({r:255-(r=this.rgba).r,g:255-r.g,b:255-r.b,a:r.a});var r},r.prototype.saturate=function(r){return void 0===r&&(r=.1),w(M(this.rgba,r))},r.prototype.desaturate=function(r){return void 0===r&&(r=.1),w(M(this.rgba,-r))},r.prototype.grayscale=function(){return w(M(this.rgba,-1))},r.prototype.lighten=function(r){return void 0===r&&(r=.1),w($(this.rgba,r))},r.prototype.darken=function(r){return void 0===r&&(r=.1),w($(this.rgba,-r))},r.prototype.rotate=function(r){return void 0===r&&(r=15),this.hue(this.hue()+r)},r.prototype.alpha=function(r){return\"number\"==typeof r?w({r:(t=this.rgba).r,g:t.g,b:t.b,a:r}):n(this.rgba.a,3);var t},r.prototype.hue=function(r){var t=c(this.rgba);return\"number\"==typeof r?w({h:r,s:t.s,l:t.l,a:t.a}):n(t.h)},r.prototype.isEqual=function(r){return this.toHex()===w(r).toHex()},r}(),w=function(r){return r instanceof j?r:new j(r)},S=[],k=function(r){r.forEach(function(r){S.indexOf(r)<0&&(r(j,y),S.push(r))})},E=function(){return new j({r:255*Math.random(),g:255*Math.random(),b:255*Math.random()})};export{j as Colord,w as colord,k as extend,I as getFormat,E as random};\n","export default function(e,f){var a={white:\"#ffffff\",bisque:\"#ffe4c4\",blue:\"#0000ff\",cadetblue:\"#5f9ea0\",chartreuse:\"#7fff00\",chocolate:\"#d2691e\",coral:\"#ff7f50\",antiquewhite:\"#faebd7\",aqua:\"#00ffff\",azure:\"#f0ffff\",whitesmoke:\"#f5f5f5\",papayawhip:\"#ffefd5\",plum:\"#dda0dd\",blanchedalmond:\"#ffebcd\",black:\"#000000\",gold:\"#ffd700\",goldenrod:\"#daa520\",gainsboro:\"#dcdcdc\",cornsilk:\"#fff8dc\",cornflowerblue:\"#6495ed\",burlywood:\"#deb887\",aquamarine:\"#7fffd4\",beige:\"#f5f5dc\",crimson:\"#dc143c\",cyan:\"#00ffff\",darkblue:\"#00008b\",darkcyan:\"#008b8b\",darkgoldenrod:\"#b8860b\",darkkhaki:\"#bdb76b\",darkgray:\"#a9a9a9\",darkgreen:\"#006400\",darkgrey:\"#a9a9a9\",peachpuff:\"#ffdab9\",darkmagenta:\"#8b008b\",darkred:\"#8b0000\",darkorchid:\"#9932cc\",darkorange:\"#ff8c00\",darkslateblue:\"#483d8b\",gray:\"#808080\",darkslategray:\"#2f4f4f\",darkslategrey:\"#2f4f4f\",deeppink:\"#ff1493\",deepskyblue:\"#00bfff\",wheat:\"#f5deb3\",firebrick:\"#b22222\",floralwhite:\"#fffaf0\",ghostwhite:\"#f8f8ff\",darkviolet:\"#9400d3\",magenta:\"#ff00ff\",green:\"#008000\",dodgerblue:\"#1e90ff\",grey:\"#808080\",honeydew:\"#f0fff0\",hotpink:\"#ff69b4\",blueviolet:\"#8a2be2\",forestgreen:\"#228b22\",lawngreen:\"#7cfc00\",indianred:\"#cd5c5c\",indigo:\"#4b0082\",fuchsia:\"#ff00ff\",brown:\"#a52a2a\",maroon:\"#800000\",mediumblue:\"#0000cd\",lightcoral:\"#f08080\",darkturquoise:\"#00ced1\",lightcyan:\"#e0ffff\",ivory:\"#fffff0\",lightyellow:\"#ffffe0\",lightsalmon:\"#ffa07a\",lightseagreen:\"#20b2aa\",linen:\"#faf0e6\",mediumaquamarine:\"#66cdaa\",lemonchiffon:\"#fffacd\",lime:\"#00ff00\",khaki:\"#f0e68c\",mediumseagreen:\"#3cb371\",limegreen:\"#32cd32\",mediumspringgreen:\"#00fa9a\",lightskyblue:\"#87cefa\",lightblue:\"#add8e6\",midnightblue:\"#191970\",lightpink:\"#ffb6c1\",mistyrose:\"#ffe4e1\",moccasin:\"#ffe4b5\",mintcream:\"#f5fffa\",lightslategray:\"#778899\",lightslategrey:\"#778899\",navajowhite:\"#ffdead\",navy:\"#000080\",mediumvioletred:\"#c71585\",powderblue:\"#b0e0e6\",palegoldenrod:\"#eee8aa\",oldlace:\"#fdf5e6\",paleturquoise:\"#afeeee\",mediumturquoise:\"#48d1cc\",mediumorchid:\"#ba55d3\",rebeccapurple:\"#663399\",lightsteelblue:\"#b0c4de\",mediumslateblue:\"#7b68ee\",thistle:\"#d8bfd8\",tan:\"#d2b48c\",orchid:\"#da70d6\",mediumpurple:\"#9370db\",purple:\"#800080\",pink:\"#ffc0cb\",skyblue:\"#87ceeb\",springgreen:\"#00ff7f\",palegreen:\"#98fb98\",red:\"#ff0000\",yellow:\"#ffff00\",slateblue:\"#6a5acd\",lavenderblush:\"#fff0f5\",peru:\"#cd853f\",palevioletred:\"#db7093\",violet:\"#ee82ee\",teal:\"#008080\",slategray:\"#708090\",slategrey:\"#708090\",aliceblue:\"#f0f8ff\",darkseagreen:\"#8fbc8f\",darkolivegreen:\"#556b2f\",greenyellow:\"#adff2f\",seagreen:\"#2e8b57\",seashell:\"#fff5ee\",tomato:\"#ff6347\",silver:\"#c0c0c0\",sienna:\"#a0522d\",lavender:\"#e6e6fa\",lightgreen:\"#90ee90\",orange:\"#ffa500\",orangered:\"#ff4500\",steelblue:\"#4682b4\",royalblue:\"#4169e1\",turquoise:\"#40e0d0\",yellowgreen:\"#9acd32\",salmon:\"#fa8072\",saddlebrown:\"#8b4513\",sandybrown:\"#f4a460\",rosybrown:\"#bc8f8f\",darksalmon:\"#e9967a\",lightgoldenrodyellow:\"#fafad2\",snow:\"#fffafa\",lightgrey:\"#d3d3d3\",lightgray:\"#d3d3d3\",dimgray:\"#696969\",dimgrey:\"#696969\",olivedrab:\"#6b8e23\",olive:\"#808000\"},r={};for(var d in a)r[a[d]]=d;var l={};e.prototype.toName=function(f){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return\"transparent\";var d,i,n=r[this.toHex()];if(n)return n;if(null==f?void 0:f.closest){var o=this.toRgb(),t=1/0,b=\"black\";if(!l.length)for(var c in a)l[c]=new e(a[c]).toRgb();for(var g in a){var u=(d=o,i=l[g],Math.pow(d.r-i.r,2)+Math.pow(d.g-i.g,2)+Math.pow(d.b-i.b,2));u<t&&(t=u,b=g)}return b}};f.string.push([function(f){var r=f.toLowerCase(),d=\"transparent\"===r?\"#0000\":a[r];return d?new e(d).toRgb():null},\"name\"])}\n","import { extend, colord } from '@pixi/colord';\nimport namesPlugin from '@pixi/colord/plugins/names';\n\n\"use strict\";\nextend([namesPlugin]);\nconst _Color = class _Color {\n  /**\n   * @param {ColorSource} value - Optional value to use, if not provided, white is used.\n   */\n  constructor(value = 16777215) {\n    this._value = null;\n    this._components = new Float32Array(4);\n    this._components.fill(1);\n    this._int = 16777215;\n    this.value = value;\n  }\n  /**\n   * Get the red component of the color, normalized between 0 and 1.\n   * @example\n   * ```ts\n   * const color = new Color('red');\n   * console.log(color.red); // 1\n   *\n   * const green = new Color('#00ff00');\n   * console.log(green.red); // 0\n   * ```\n   */\n  get red() {\n    return this._components[0];\n  }\n  /**\n   * Get the green component of the color, normalized between 0 and 1.\n   * @example\n   * ```ts\n   * const color = new Color('lime');\n   * console.log(color.green); // 1\n   *\n   * const red = new Color('#ff0000');\n   * console.log(red.green); // 0\n   * ```\n   */\n  get green() {\n    return this._components[1];\n  }\n  /**\n   * Get the blue component of the color, normalized between 0 and 1.\n   * @example\n   * ```ts\n   * const color = new Color('blue');\n   * console.log(color.blue); // 1\n   *\n   * const yellow = new Color('#ffff00');\n   * console.log(yellow.blue); // 0\n   * ```\n   */\n  get blue() {\n    return this._components[2];\n  }\n  /**\n   * Get the alpha component of the color, normalized between 0 and 1.\n   * @example\n   * ```ts\n   * const color = new Color('red');\n   * console.log(color.alpha); // 1 (fully opaque)\n   *\n   * const transparent = new Color('rgba(255, 0, 0, 0.5)');\n   * console.log(transparent.alpha); // 0.5 (semi-transparent)\n   * ```\n   */\n  get alpha() {\n    return this._components[3];\n  }\n  /**\n   * Sets the color value and returns the instance for chaining.\n   *\n   * This is a chainable version of setting the `value` property.\n   * @param value - The color to set. Accepts various formats:\n   * - Hex strings/numbers (e.g., '#ff0000', 0xff0000)\n   * - RGB/RGBA values (arrays, objects)\n   * - CSS color names\n   * - HSL/HSLA values\n   * - HSV/HSVA values\n   * @returns The Color instance for chaining\n   * @example\n   * ```ts\n   * // Basic usage\n   * const color = new Color();\n   * color.setValue('#ff0000')\n   *     .setAlpha(0.5)\n   *     .premultiply(0.8);\n   *\n   * // Different formats\n   * color.setValue(0xff0000);          // Hex number\n   * color.setValue('#ff0000');         // Hex string\n   * color.setValue([1, 0, 0]);         // RGB array\n   * color.setValue([1, 0, 0, 0.5]);    // RGBA array\n   * color.setValue({ r: 1, g: 0, b: 0 }); // RGB object\n   *\n   * // Copy from another color\n   * const red = new Color('red');\n   * color.setValue(red);\n   * ```\n   * @throws {Error} If the color value is invalid or null\n   * @see {@link Color.value} For the underlying value property\n   */\n  setValue(value) {\n    this.value = value;\n    return this;\n  }\n  /**\n   * The current color source. This property allows getting and setting the color value\n   * while preserving the original format where possible.\n   * @remarks\n   * When setting:\n   * - Setting to a `Color` instance copies its source and components\n   * - Setting to other valid sources normalizes and stores the value\n   * - Setting to `null` throws an Error\n   * - The color remains unchanged if normalization fails\n   *\n   * When getting:\n   * - Returns `null` if color was modified by {@link Color.multiply} or {@link Color.premultiply}\n   * - Otherwise returns the original color source\n   * @example\n   * ```ts\n   * // Setting different color formats\n   * const color = new Color();\n   *\n   * color.value = 0xff0000;         // Hex number\n   * color.value = '#ff0000';        // Hex string\n   * color.value = [1, 0, 0];        // RGB array\n   * color.value = [1, 0, 0, 0.5];   // RGBA array\n   * color.value = { r: 1, g: 0, b: 0 }; // RGB object\n   *\n   * // Copying from another color\n   * const red = new Color('red');\n   * color.value = red;  // Copies red's components\n   *\n   * // Getting the value\n   * console.log(color.value);  // Returns original format\n   *\n   * // After modifications\n   * color.multiply([0.5, 0.5, 0.5]);\n   * console.log(color.value);  // Returns null\n   * ```\n   * @throws {Error} When attempting to set `null`\n   */\n  set value(value) {\n    if (value instanceof _Color) {\n      this._value = this._cloneSource(value._value);\n      this._int = value._int;\n      this._components.set(value._components);\n    } else if (value === null) {\n      throw new Error(\"Cannot set Color#value to null\");\n    } else if (this._value === null || !this._isSourceEqual(this._value, value)) {\n      this._value = this._cloneSource(value);\n      this._normalize(this._value);\n    }\n  }\n  get value() {\n    return this._value;\n  }\n  /**\n   * Copy a color source internally.\n   * @param value - Color source\n   */\n  _cloneSource(value) {\n    if (typeof value === \"string\" || typeof value === \"number\" || value instanceof Number || value === null) {\n      return value;\n    } else if (Array.isArray(value) || ArrayBuffer.isView(value)) {\n      return value.slice(0);\n    } else if (typeof value === \"object\" && value !== null) {\n      return { ...value };\n    }\n    return value;\n  }\n  /**\n   * Equality check for color sources.\n   * @param value1 - First color source\n   * @param value2 - Second color source\n   * @returns `true` if the color sources are equal, `false` otherwise.\n   */\n  _isSourceEqual(value1, value2) {\n    const type1 = typeof value1;\n    const type2 = typeof value2;\n    if (type1 !== type2) {\n      return false;\n    } else if (type1 === \"number\" || type1 === \"string\" || value1 instanceof Number) {\n      return value1 === value2;\n    } else if (Array.isArray(value1) && Array.isArray(value2) || ArrayBuffer.isView(value1) && ArrayBuffer.isView(value2)) {\n      if (value1.length !== value2.length) {\n        return false;\n      }\n      return value1.every((v, i) => v === value2[i]);\n    } else if (value1 !== null && value2 !== null) {\n      const keys1 = Object.keys(value1);\n      const keys2 = Object.keys(value2);\n      if (keys1.length !== keys2.length) {\n        return false;\n      }\n      return keys1.every((key) => value1[key] === value2[key]);\n    }\n    return value1 === value2;\n  }\n  /**\n   * Convert to a RGBA color object with normalized components (0-1).\n   * @example\n   * ```ts\n   * import { Color } from 'pixi.js';\n   *\n   * // Convert colors to RGBA objects\n   * new Color('white').toRgba();     // returns { r: 1, g: 1, b: 1, a: 1 }\n   * new Color('#ff0000').toRgba();   // returns { r: 1, g: 0, b: 0, a: 1 }\n   *\n   * // With transparency\n   * new Color('rgba(255,0,0,0.5)').toRgba(); // returns { r: 1, g: 0, b: 0, a: 0.5 }\n   * ```\n   * @returns An RGBA object with normalized components\n   */\n  toRgba() {\n    const [r, g, b, a] = this._components;\n    return { r, g, b, a };\n  }\n  /**\n   * Convert to a RGB color object with normalized components (0-1).\n   *\n   * Alpha component is omitted in the output.\n   * @example\n   * ```ts\n   * import { Color } from 'pixi.js';\n   *\n   * // Convert colors to RGB objects\n   * new Color('white').toRgb();     // returns { r: 1, g: 1, b: 1 }\n   * new Color('#ff0000').toRgb();   // returns { r: 1, g: 0, b: 0 }\n   *\n   * // Alpha is ignored\n   * new Color('rgba(255,0,0,0.5)').toRgb(); // returns { r: 1, g: 0, b: 0 }\n   * ```\n   * @returns An RGB object with normalized components\n   */\n  toRgb() {\n    const [r, g, b] = this._components;\n    return { r, g, b };\n  }\n  /**\n   * Convert to a CSS-style rgba string representation.\n   *\n   * RGB components are scaled to 0-255 range, alpha remains 0-1.\n   * @example\n   * ```ts\n   * import { Color } from 'pixi.js';\n   *\n   * // Convert colors to RGBA strings\n   * new Color('white').toRgbaString();     // returns \"rgba(255,255,255,1)\"\n   * new Color('#ff0000').toRgbaString();   // returns \"rgba(255,0,0,1)\"\n   *\n   * // With transparency\n   * new Color([1, 0, 0, 0.5]).toRgbaString(); // returns \"rgba(255,0,0,0.5)\"\n   * ```\n   * @returns A CSS-compatible rgba string\n   */\n  toRgbaString() {\n    const [r, g, b] = this.toUint8RgbArray();\n    return `rgba(${r},${g},${b},${this.alpha})`;\n  }\n  /**\n   * Convert to an [R, G, B] array of clamped uint8 values (0 to 255).\n   * @param {number[]|Uint8Array|Uint8ClampedArray} [out] - Optional output array. If not provided,\n   * a cached array will be used and returned.\n   * @returns Array containing RGB components as integers between 0-255\n   * @example\n   * ```ts\n   * // Basic usage\n   * new Color('white').toUint8RgbArray(); // returns [255, 255, 255]\n   * new Color('#ff0000').toUint8RgbArray(); // returns [255, 0, 0]\n   *\n   * // Using custom output array\n   * const rgb = new Uint8Array(3);\n   * new Color('blue').toUint8RgbArray(rgb); // rgb is now [0, 0, 255]\n   *\n   * // Using different array types\n   * new Color('red').toUint8RgbArray(new Uint8ClampedArray(3)); // [255, 0, 0]\n   * new Color('red').toUint8RgbArray([]); // [255, 0, 0]\n   * ```\n   * @remarks\n   * - Output values are always clamped between 0-255\n   * - Alpha component is not included in output\n   * - Reuses internal cache array if no output array provided\n   */\n  toUint8RgbArray(out) {\n    const [r, g, b] = this._components;\n    if (!this._arrayRgb) {\n      this._arrayRgb = [];\n    }\n    out || (out = this._arrayRgb);\n    out[0] = Math.round(r * 255);\n    out[1] = Math.round(g * 255);\n    out[2] = Math.round(b * 255);\n    return out;\n  }\n  /**\n   * Convert to an [R, G, B, A] array of normalized floats (numbers from 0.0 to 1.0).\n   * @param {number[]|Float32Array} [out] - Optional output array. If not provided,\n   * a cached array will be used and returned.\n   * @returns Array containing RGBA components as floats between 0-1\n   * @example\n   * ```ts\n   * // Basic usage\n   * new Color('white').toArray();  // returns [1, 1, 1, 1]\n   * new Color('red').toArray();    // returns [1, 0, 0, 1]\n   *\n   * // With alpha\n   * new Color('rgba(255,0,0,0.5)').toArray(); // returns [1, 0, 0, 0.5]\n   *\n   * // Using custom output array\n   * const rgba = new Float32Array(4);\n   * new Color('blue').toArray(rgba); // rgba is now [0, 0, 1, 1]\n   * ```\n   * @remarks\n   * - Output values are normalized between 0-1\n   * - Includes alpha component as the fourth value\n   * - Reuses internal cache array if no output array provided\n   */\n  toArray(out) {\n    if (!this._arrayRgba) {\n      this._arrayRgba = [];\n    }\n    out || (out = this._arrayRgba);\n    const [r, g, b, a] = this._components;\n    out[0] = r;\n    out[1] = g;\n    out[2] = b;\n    out[3] = a;\n    return out;\n  }\n  /**\n   * Convert to an [R, G, B] array of normalized floats (numbers from 0.0 to 1.0).\n   * @param {number[]|Float32Array} [out] - Optional output array. If not provided,\n   * a cached array will be used and returned.\n   * @returns Array containing RGB components as floats between 0-1\n   * @example\n   * ```ts\n   * // Basic usage\n   * new Color('white').toRgbArray(); // returns [1, 1, 1]\n   * new Color('red').toRgbArray();   // returns [1, 0, 0]\n   *\n   * // Using custom output array\n   * const rgb = new Float32Array(3);\n   * new Color('blue').toRgbArray(rgb); // rgb is now [0, 0, 1]\n   * ```\n   * @remarks\n   * - Output values are normalized between 0-1\n   * - Alpha component is omitted from output\n   * - Reuses internal cache array if no output array provided\n   */\n  toRgbArray(out) {\n    if (!this._arrayRgb) {\n      this._arrayRgb = [];\n    }\n    out || (out = this._arrayRgb);\n    const [r, g, b] = this._components;\n    out[0] = r;\n    out[1] = g;\n    out[2] = b;\n    return out;\n  }\n  /**\n   * Convert to a hexadecimal number.\n   * @returns The color as a 24-bit RGB integer\n   * @example\n   * ```ts\n   * // Basic usage\n   * new Color('white').toNumber(); // returns 0xffffff\n   * new Color('red').toNumber();   // returns 0xff0000\n   *\n   * // Store as hex\n   * const color = new Color('blue');\n   * const hex = color.toNumber(); // 0x0000ff\n   * ```\n   */\n  toNumber() {\n    return this._int;\n  }\n  /**\n   * Convert to a BGR number.\n   *\n   * Useful for platforms that expect colors in BGR format.\n   * @returns The color as a 24-bit BGR integer\n   * @example\n   * ```ts\n   * // Convert RGB to BGR\n   * new Color(0xffcc99).toBgrNumber(); // returns 0x99ccff\n   *\n   * // Common use case: platform-specific color format\n   * const color = new Color('orange');\n   * const bgrColor = color.toBgrNumber(); // Color with swapped R/B channels\n   * ```\n   * @remarks\n   * This swaps the red and blue channels compared to the normal RGB format:\n   * - RGB 0xRRGGBB becomes BGR 0xBBGGRR\n   */\n  toBgrNumber() {\n    const [r, g, b] = this.toUint8RgbArray();\n    return (b << 16) + (g << 8) + r;\n  }\n  /**\n   * Convert to a hexadecimal number in little endian format (e.g., BBGGRR).\n   *\n   * Useful for platforms that expect colors in little endian byte order.\n   * @example\n   * ```ts\n   * import { Color } from 'pixi.js';\n   *\n   * // Convert RGB color to little endian format\n   * new Color(0xffcc99).toLittleEndianNumber(); // returns 0x99ccff\n   *\n   * // Common use cases:\n   * const color = new Color('orange');\n   * const leColor = color.toLittleEndianNumber(); // Swaps byte order for LE systems\n   *\n   * // Multiple conversions\n   * const colors = {\n   *     normal: 0xffcc99,\n   *     littleEndian: new Color(0xffcc99).toLittleEndianNumber(), // 0x99ccff\n   *     backToNormal: new Color(0x99ccff).toLittleEndianNumber()  // 0xffcc99\n   * };\n   * ```\n   * @remarks\n   * - Swaps R and B channels in the color value\n   * - RGB 0xRRGGBB becomes 0xBBGGRR\n   * - Useful for systems that use little endian byte order\n   * - Can be used to convert back and forth between formats\n   * @returns The color as a number in little endian format (BBGGRR)\n   * @see {@link Color.toBgrNumber} For BGR format without byte swapping\n   */\n  toLittleEndianNumber() {\n    const value = this._int;\n    return (value >> 16) + (value & 65280) + ((value & 255) << 16);\n  }\n  /**\n   * Multiply with another color.\n   *\n   * This action is destructive and modifies the original color.\n   * @param {ColorSource} value - The color to multiply by. Accepts any valid color format:\n   * - Hex strings/numbers (e.g., '#ff0000', 0xff0000)\n   * - RGB/RGBA arrays ([1, 0, 0], [1, 0, 0, 1])\n   * - Color objects ({ r: 1, g: 0, b: 0 })\n   * - CSS color names ('red', 'blue')\n   * @returns this - The Color instance for chaining\n   * @example\n   * ```ts\n   * // Basic multiplication\n   * const color = new Color('#ff0000');\n   * color.multiply(0x808080); // 50% darker red\n   *\n   * // With transparency\n   * color.multiply([1, 1, 1, 0.5]); // 50% transparent\n   *\n   * // Chain operations\n   * color\n   *     .multiply('#808080')\n   *     .multiply({ r: 1, g: 1, b: 1, a: 0.5 });\n   * ```\n   * @remarks\n   * - Multiplies each RGB component and alpha separately\n   * - Values are clamped between 0-1\n   * - Original color format is lost (value becomes null)\n   * - Operation cannot be undone\n   */\n  multiply(value) {\n    const [r, g, b, a] = _Color._temp.setValue(value)._components;\n    this._components[0] *= r;\n    this._components[1] *= g;\n    this._components[2] *= b;\n    this._components[3] *= a;\n    this._refreshInt();\n    this._value = null;\n    return this;\n  }\n  /**\n   * Converts color to a premultiplied alpha format.\n   *\n   * This action is destructive and modifies the original color.\n   * @param alpha - The alpha value to multiply by (0-1)\n   * @param {boolean} [applyToRGB=true] - Whether to premultiply RGB channels\n   * @returns {Color} The Color instance for chaining\n   * @example\n   * ```ts\n   * // Basic premultiplication\n   * const color = new Color('red');\n   * color.premultiply(0.5); // 50% transparent red with premultiplied RGB\n   *\n   * // Alpha only (RGB unchanged)\n   * color.premultiply(0.5, false); // 50% transparent, original RGB\n   *\n   * // Chain with other operations\n   * color\n   *     .multiply(0x808080)\n   *     .premultiply(0.5)\n   *     .toNumber();\n   * ```\n   * @remarks\n   * - RGB channels are multiplied by alpha when applyToRGB is true\n   * - Alpha is always set to the provided value\n   * - Values are clamped between 0-1\n   * - Original color format is lost (value becomes null)\n   * - Operation cannot be undone\n   */\n  premultiply(alpha, applyToRGB = true) {\n    if (applyToRGB) {\n      this._components[0] *= alpha;\n      this._components[1] *= alpha;\n      this._components[2] *= alpha;\n    }\n    this._components[3] = alpha;\n    this._refreshInt();\n    this._value = null;\n    return this;\n  }\n  /**\n   * Returns the color as a 32-bit premultiplied alpha integer.\n   *\n   * Format: 0xAARRGGBB\n   * @param {number} alpha - The alpha value to multiply by (0-1)\n   * @param {boolean} [applyToRGB=true] - Whether to premultiply RGB channels\n   * @returns {number} The premultiplied color as a 32-bit integer\n   * @example\n   * ```ts\n   * // Convert to premultiplied format\n   * const color = new Color('red');\n   *\n   * // Full opacity (0xFFRRGGBB)\n   * color.toPremultiplied(1.0); // 0xFFFF0000\n   *\n   * // 50% transparency with premultiplied RGB\n   * color.toPremultiplied(0.5); // 0x7F7F0000\n   *\n   * // 50% transparency without RGB premultiplication\n   * color.toPremultiplied(0.5, false); // 0x7FFF0000\n   * ```\n   * @remarks\n   * - Returns full opacity (0xFF000000) when alpha is 1.0\n   * - Returns 0 when alpha is 0.0 and applyToRGB is true\n   * - RGB values are rounded during premultiplication\n   */\n  toPremultiplied(alpha, applyToRGB = true) {\n    if (alpha === 1) {\n      return (255 << 24) + this._int;\n    }\n    if (alpha === 0) {\n      return applyToRGB ? 0 : this._int;\n    }\n    let r = this._int >> 16 & 255;\n    let g = this._int >> 8 & 255;\n    let b = this._int & 255;\n    if (applyToRGB) {\n      r = r * alpha + 0.5 | 0;\n      g = g * alpha + 0.5 | 0;\n      b = b * alpha + 0.5 | 0;\n    }\n    return (alpha * 255 << 24) + (r << 16) + (g << 8) + b;\n  }\n  /**\n   * Convert to a hexadecimal string (6 characters).\n   * @returns A CSS-compatible hex color string (e.g., \"#ff0000\")\n   * @example\n   * ```ts\n   * import { Color } from 'pixi.js';\n   *\n   * // Basic colors\n   * new Color('red').toHex();    // returns \"#ff0000\"\n   * new Color('white').toHex();  // returns \"#ffffff\"\n   * new Color('black').toHex();  // returns \"#000000\"\n   *\n   * // From different formats\n   * new Color(0xff0000).toHex(); // returns \"#ff0000\"\n   * new Color([1, 0, 0]).toHex(); // returns \"#ff0000\"\n   * new Color({ r: 1, g: 0, b: 0 }).toHex(); // returns \"#ff0000\"\n   * ```\n   * @remarks\n   * - Always returns a 6-character hex string\n   * - Includes leading \"#\" character\n   * - Alpha channel is ignored\n   * - Values are rounded to nearest hex value\n   */\n  toHex() {\n    const hexString = this._int.toString(16);\n    return `#${\"000000\".substring(0, 6 - hexString.length) + hexString}`;\n  }\n  /**\n   * Convert to a hexadecimal string with alpha (8 characters).\n   * @returns A CSS-compatible hex color string with alpha (e.g., \"#ff0000ff\")\n   * @example\n   * ```ts\n   * import { Color } from 'pixi.js';\n   *\n   * // Fully opaque colors\n   * new Color('red').toHexa();   // returns \"#ff0000ff\"\n   * new Color('white').toHexa(); // returns \"#ffffffff\"\n   *\n   * // With transparency\n   * new Color('rgba(255, 0, 0, 0.5)').toHexa(); // returns \"#ff00007f\"\n   * new Color([1, 0, 0, 0]).toHexa(); // returns \"#ff000000\"\n   * ```\n   * @remarks\n   * - Returns an 8-character hex string\n   * - Includes leading \"#\" character\n   * - Alpha is encoded in last two characters\n   * - Values are rounded to nearest hex value\n   */\n  toHexa() {\n    const alphaValue = Math.round(this._components[3] * 255);\n    const alphaString = alphaValue.toString(16);\n    return this.toHex() + \"00\".substring(0, 2 - alphaString.length) + alphaString;\n  }\n  /**\n   * Set alpha (transparency) value while preserving color components.\n   *\n   * Provides a chainable interface for setting alpha.\n   * @param alpha - Alpha value between 0 (fully transparent) and 1 (fully opaque)\n   * @returns The Color instance for chaining\n   * @example\n   * ```ts\n   * // Basic alpha setting\n   * const color = new Color('red');\n   * color.setAlpha(0.5);  // 50% transparent red\n   *\n   * // Chain with other operations\n   * color\n   *     .setValue('#ff0000')\n   *     .setAlpha(0.8)    // 80% opaque\n   *     .premultiply(0.5); // Further modify alpha\n   *\n   * // Reset to fully opaque\n   * color.setAlpha(1);\n   * ```\n   * @remarks\n   * - Alpha value is clamped between 0-1\n   * - Can be chained with other color operations\n   */\n  setAlpha(alpha) {\n    this._components[3] = this._clamp(alpha);\n    return this;\n  }\n  /**\n   * Normalize the input value into rgba\n   * @param value - Input value\n   */\n  _normalize(value) {\n    let r;\n    let g;\n    let b;\n    let a;\n    if ((typeof value === \"number\" || value instanceof Number) && value >= 0 && value <= 16777215) {\n      const int = value;\n      r = (int >> 16 & 255) / 255;\n      g = (int >> 8 & 255) / 255;\n      b = (int & 255) / 255;\n      a = 1;\n    } else if ((Array.isArray(value) || value instanceof Float32Array) && value.length >= 3 && value.length <= 4) {\n      value = this._clamp(value);\n      [r, g, b, a = 1] = value;\n    } else if ((value instanceof Uint8Array || value instanceof Uint8ClampedArray) && value.length >= 3 && value.length <= 4) {\n      value = this._clamp(value, 0, 255);\n      [r, g, b, a = 255] = value;\n      r /= 255;\n      g /= 255;\n      b /= 255;\n      a /= 255;\n    } else if (typeof value === \"string\" || typeof value === \"object\") {\n      if (typeof value === \"string\") {\n        const match = _Color.HEX_PATTERN.exec(value);\n        if (match) {\n          value = `#${match[2]}`;\n        }\n      }\n      const color = colord(value);\n      if (color.isValid()) {\n        ({ r, g, b, a } = color.rgba);\n        r /= 255;\n        g /= 255;\n        b /= 255;\n      }\n    }\n    if (r !== void 0) {\n      this._components[0] = r;\n      this._components[1] = g;\n      this._components[2] = b;\n      this._components[3] = a;\n      this._refreshInt();\n    } else {\n      throw new Error(`Unable to convert color ${value}`);\n    }\n  }\n  /** Refresh the internal color rgb number */\n  _refreshInt() {\n    this._clamp(this._components);\n    const [r, g, b] = this._components;\n    this._int = (r * 255 << 16) + (g * 255 << 8) + (b * 255 | 0);\n  }\n  /**\n   * Clamps values to a range. Will override original values\n   * @param value - Value(s) to clamp\n   * @param min - Minimum value\n   * @param max - Maximum value\n   */\n  _clamp(value, min = 0, max = 1) {\n    if (typeof value === \"number\") {\n      return Math.min(Math.max(value, min), max);\n    }\n    value.forEach((v, i) => {\n      value[i] = Math.min(Math.max(v, min), max);\n    });\n    return value;\n  }\n  /**\n   * Check if a value can be interpreted as a valid color format.\n   * Supports all color formats that can be used with the Color class.\n   * @param value - Value to check\n   * @returns True if the value can be used as a color\n   * @example\n   * ```ts\n   * import { Color } from 'pixi.js';\n   *\n   * // CSS colors and hex values\n   * Color.isColorLike('red');          // true\n   * Color.isColorLike('#ff0000');      // true\n   * Color.isColorLike(0xff0000);       // true\n   *\n   * // Arrays (RGB/RGBA)\n   * Color.isColorLike([1, 0, 0]);      // true\n   * Color.isColorLike([1, 0, 0, 0.5]); // true\n   *\n   * // TypedArrays\n   * Color.isColorLike(new Float32Array([1, 0, 0]));          // true\n   * Color.isColorLike(new Uint8Array([255, 0, 0]));          // true\n   * Color.isColorLike(new Uint8ClampedArray([255, 0, 0]));   // true\n   *\n   * // Object formats\n   * Color.isColorLike({ r: 1, g: 0, b: 0 });            // true (RGB)\n   * Color.isColorLike({ r: 1, g: 0, b: 0, a: 0.5 });    // true (RGBA)\n   * Color.isColorLike({ h: 0, s: 100, l: 50 });         // true (HSL)\n   * Color.isColorLike({ h: 0, s: 100, l: 50, a: 0.5 }); // true (HSLA)\n   * Color.isColorLike({ h: 0, s: 100, v: 100 });        // true (HSV)\n   * Color.isColorLike({ h: 0, s: 100, v: 100, a: 0.5 });// true (HSVA)\n   *\n   * // Color instances\n   * Color.isColorLike(new Color('red')); // true\n   *\n   * // Invalid values\n   * Color.isColorLike(null);           // false\n   * Color.isColorLike(undefined);      // false\n   * Color.isColorLike({});             // false\n   * Color.isColorLike([]);             // false\n   * Color.isColorLike('not-a-color');  // false\n   * ```\n   * @remarks\n   * Checks for the following formats:\n   * - Numbers (0x000000 to 0xffffff)\n   * - CSS color strings\n   * - RGB/RGBA arrays and objects\n   * - HSL/HSLA objects\n   * - HSV/HSVA objects\n   * - TypedArrays (Float32Array, Uint8Array, Uint8ClampedArray)\n   * - Color instances\n   * @see {@link ColorSource} For supported color format types\n   * @see {@link Color.setValue} For setting color values\n   * @category utility\n   */\n  static isColorLike(value) {\n    return typeof value === \"number\" || typeof value === \"string\" || value instanceof Number || value instanceof _Color || Array.isArray(value) || value instanceof Uint8Array || value instanceof Uint8ClampedArray || value instanceof Float32Array || value.r !== void 0 && value.g !== void 0 && value.b !== void 0 || value.r !== void 0 && value.g !== void 0 && value.b !== void 0 && value.a !== void 0 || value.h !== void 0 && value.s !== void 0 && value.l !== void 0 || value.h !== void 0 && value.s !== void 0 && value.l !== void 0 && value.a !== void 0 || value.h !== void 0 && value.s !== void 0 && value.v !== void 0 || value.h !== void 0 && value.s !== void 0 && value.v !== void 0 && value.a !== void 0;\n  }\n};\n/**\n * Static shared Color instance used for utility operations. This is a singleton color object\n * that can be reused to avoid creating unnecessary Color instances.\n * > [!IMPORTANT] You should be careful when using this shared instance, as it is mutable and can be\n * > changed by any code that uses it.\n * >\n * > It is best used for one-off color operations or temporary transformations.\n * > For persistent colors, create your own Color instance instead.\n * @example\n * ```ts\n * import { Color } from 'pixi.js';\n *\n * // Use shared instance for one-off color operations\n * Color.shared.setValue(0xff0000);\n * const redHex = Color.shared.toHex();     // \"#ff0000\"\n * const redRgb = Color.shared.toRgbArray(); // [1, 0, 0]\n *\n * // Temporary color transformations\n * const colorNumber = Color.shared\n *     .setValue('#ff0000')     // Set to red\n *     .setAlpha(0.5)          // Make semi-transparent\n *     .premultiply(0.8)       // Apply premultiplication\n *     .toNumber();            // Convert to number\n *\n * // Chain multiple operations\n * const result = Color.shared\n *     .setValue(someColor)\n *     .multiply(tintColor)\n *     .toPremultiplied(alpha);\n * ```\n * @remarks\n * - This is a shared instance - be careful about multiple code paths using it simultaneously\n * - Use for temporary color operations to avoid allocating new Color instances\n * - The value is preserved between operations, so reset if needed\n * - For persistent colors, create your own Color instance instead\n */\n_Color.shared = new _Color();\n/**\n * Temporary Color object for static uses internally.\n * As to not conflict with Color.shared.\n * @ignore\n */\n_Color._temp = new _Color();\n/** Pattern for hex strings */\n// eslint-disable-next-line @typescript-eslint/naming-convention\n_Color.HEX_PATTERN = /^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;\nlet Color = _Color;\n\nexport { Color };\n//# sourceMappingURL=Color.mjs.map\n","\"use strict\";\nconst cullingMixin = {\n  cullArea: null,\n  cullable: false,\n  cullableChildren: true\n};\n\nexport { cullingMixin };\n//# sourceMappingURL=cullingMixin.mjs.map\n","\"use strict\";\nlet warnCount = 0;\nconst maxWarnings = 500;\nfunction warn(...args) {\n  if (warnCount === maxWarnings)\n    return;\n  warnCount++;\n  if (warnCount === maxWarnings) {\n    console.warn(\"PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS.\");\n  } else {\n    console.warn(\"PixiJS Warning: \", ...args);\n  }\n}\n\nexport { warn };\n//# sourceMappingURL=warn.mjs.map\n","\"use strict\";\nconst GlobalResourceRegistry = {\n  /**\n   * Set of registered pools and cleanable objects.\n   * @private\n   */\n  _registeredResources: /* @__PURE__ */ new Set(),\n  /**\n   * Registers a pool or cleanable object for cleanup.\n   * @param {Cleanable} pool - The pool or object to register.\n   */\n  register(pool) {\n    this._registeredResources.add(pool);\n  },\n  /**\n   * Unregisters a pool or cleanable object from cleanup.\n   * @param {Cleanable} pool - The pool or object to unregister.\n   */\n  unregister(pool) {\n    this._registeredResources.delete(pool);\n  },\n  /** Clears all registered pools and cleanable objects. This will call clear() on each registered item. */\n  release() {\n    this._registeredResources.forEach((pool) => pool.clear());\n  },\n  /**\n   * Gets the number of registered pools and cleanable objects.\n   * @returns {number} The count of registered items.\n   */\n  get registeredCount() {\n    return this._registeredResources.size;\n  },\n  /**\n   * Checks if a specific pool or cleanable object is registered.\n   * @param {Cleanable} pool - The pool or object to check.\n   * @returns {boolean} True if the item is registered, false otherwise.\n   */\n  isRegistered(pool) {\n    return this._registeredResources.has(pool);\n  },\n  /**\n   * Removes all registrations without clearing the pools.\n   * Useful if you want to reset the collector without affecting the pools.\n   */\n  reset() {\n    this._registeredResources.clear();\n  }\n};\n\nexport { GlobalResourceRegistry };\n//# sourceMappingURL=GlobalResourceRegistry.mjs.map\n","\"use strict\";\nclass Pool {\n  /**\n   * Constructs a new Pool.\n   * @param ClassType - The constructor of the items in the pool.\n   * @param {number} [initialSize] - The initial size of the pool.\n   */\n  constructor(ClassType, initialSize) {\n    this._pool = [];\n    this._count = 0;\n    this._index = 0;\n    this._classType = ClassType;\n    if (initialSize) {\n      this.prepopulate(initialSize);\n    }\n  }\n  /**\n   * Prepopulates the pool with a given number of items.\n   * @param total - The number of items to add to the pool.\n   */\n  prepopulate(total) {\n    for (let i = 0; i < total; i++) {\n      this._pool[this._index++] = new this._classType();\n    }\n    this._count += total;\n  }\n  /**\n   * Gets an item from the pool. Calls the item's `init` method if it exists.\n   * If there are no items left in the pool, a new one will be created.\n   * @param {unknown} [data] - Optional data to pass to the item's constructor.\n   * @returns {T} The item from the pool.\n   */\n  get(data) {\n    let item;\n    if (this._index > 0) {\n      item = this._pool[--this._index];\n    } else {\n      item = new this._classType();\n    }\n    item.init?.(data);\n    return item;\n  }\n  /**\n   * Returns an item to the pool. Calls the item's `reset` method if it exists.\n   * @param {T} item - The item to return to the pool.\n   */\n  return(item) {\n    item.reset?.();\n    this._pool[this._index++] = item;\n  }\n  /**\n   * Gets the number of items in the pool.\n   * @readonly\n   */\n  get totalSize() {\n    return this._count;\n  }\n  /**\n   * Gets the number of items in the pool that are free to use without needing to create more.\n   * @readonly\n   */\n  get totalFree() {\n    return this._index;\n  }\n  /**\n   * Gets the number of items in the pool that are currently in use.\n   * @readonly\n   */\n  get totalUsed() {\n    return this._count - this._index;\n  }\n  /** clears the pool */\n  clear() {\n    if (this._pool.length > 0 && this._pool[0].destroy) {\n      for (let i = 0; i < this._index; i++) {\n        this._pool[i].destroy();\n      }\n    }\n    this._pool.length = 0;\n    this._count = 0;\n    this._index = 0;\n  }\n}\n\nexport { Pool };\n//# sourceMappingURL=Pool.mjs.map\n","import { GlobalResourceRegistry } from './GlobalResourceRegistry.mjs';\nimport { Pool } from './Pool.mjs';\n\n\"use strict\";\nclass PoolGroupClass {\n  constructor() {\n    /**\n     * A map to store the pools by their class type.\n     * @private\n     */\n    this._poolsByClass = /* @__PURE__ */ new Map();\n  }\n  /**\n   * Prepopulates a specific pool with a given number of items.\n   * @template T The type of items in the pool. Must extend PoolItem.\n   * @param {PoolItemConstructor<T>} Class - The constructor of the items in the pool.\n   * @param {number} total - The number of items to add to the pool.\n   */\n  prepopulate(Class, total) {\n    const classPool = this.getPool(Class);\n    classPool.prepopulate(total);\n  }\n  /**\n   * Gets an item from a specific pool.\n   * @template T The type of items in the pool. Must extend PoolItem.\n   * @param {PoolItemConstructor<T>} Class - The constructor of the items in the pool.\n   * @param {unknown} [data] - Optional data to pass to the item's constructor.\n   * @returns {T} The item from the pool.\n   */\n  get(Class, data) {\n    const pool = this.getPool(Class);\n    return pool.get(data);\n  }\n  /**\n   * Returns an item to its respective pool.\n   * @param {PoolItem} item - The item to return to the pool.\n   */\n  return(item) {\n    const pool = this.getPool(item.constructor);\n    pool.return(item);\n  }\n  /**\n   * Gets a specific pool based on the class type.\n   * @template T The type of items in the pool. Must extend PoolItem.\n   * @param {PoolItemConstructor<T>} ClassType - The constructor of the items in the pool.\n   * @returns {Pool<T>} The pool of the given class type.\n   */\n  getPool(ClassType) {\n    if (!this._poolsByClass.has(ClassType)) {\n      this._poolsByClass.set(ClassType, new Pool(ClassType));\n    }\n    return this._poolsByClass.get(ClassType);\n  }\n  /** gets the usage stats of each pool in the system */\n  stats() {\n    const stats = {};\n    this._poolsByClass.forEach((pool) => {\n      const name = stats[pool._classType.name] ? pool._classType.name + pool._classType.ID : pool._classType.name;\n      stats[name] = {\n        free: pool.totalFree,\n        used: pool.totalUsed,\n        size: pool.totalSize\n      };\n    });\n    return stats;\n  }\n  /** Clears all pools in the group. This will reset all pools and free their resources. */\n  clear() {\n    this._poolsByClass.forEach((pool) => pool.clear());\n    this._poolsByClass.clear();\n  }\n}\nconst BigPool = new PoolGroupClass();\nGlobalResourceRegistry.register(BigPool);\n\nexport { BigPool, PoolGroupClass };\n//# sourceMappingURL=PoolGroup.mjs.map\n","import { deprecation } from '../../../utils/logging/deprecation.mjs';\n\n\"use strict\";\nconst cacheAsTextureMixin = {\n  get isCachedAsTexture() {\n    return !!this.renderGroup?.isCachedAsTexture;\n  },\n  cacheAsTexture(val) {\n    if (typeof val === \"boolean\" && val === false) {\n      this.disableRenderGroup();\n    } else {\n      this.enableRenderGroup();\n      this.renderGroup.enableCacheAsTexture(val === true ? {} : val);\n    }\n  },\n  updateCacheTexture() {\n    this.renderGroup?.updateCacheTexture();\n  },\n  get cacheAsBitmap() {\n    return this.isCachedAsTexture;\n  },\n  set cacheAsBitmap(val) {\n    deprecation(\"v8.6.0\", \"cacheAsBitmap is deprecated, use cacheAsTexture instead.\");\n    this.cacheAsTexture(val);\n  }\n};\n\nexport { cacheAsTextureMixin };\n//# sourceMappingURL=cacheAsTextureMixin.mjs.map\n","\"use strict\";\nfunction removeItems(arr, startIdx, removeCount) {\n  const length = arr.length;\n  let i;\n  if (startIdx >= length || removeCount === 0) {\n    return;\n  }\n  removeCount = startIdx + removeCount > length ? length - startIdx : removeCount;\n  const len = length - removeCount;\n  for (i = startIdx; i < len; ++i) {\n    arr[i] = arr[i + removeCount];\n  }\n  arr.length = len;\n}\n\nexport { removeItems };\n//# sourceMappingURL=removeItems.mjs.map\n","import { removeItems } from '../../../utils/data/removeItems.mjs';\nimport { deprecation, v8_0_0 } from '../../../utils/logging/deprecation.mjs';\n\n\"use strict\";\nconst childrenHelperMixin = {\n  allowChildren: true,\n  removeChildren(beginIndex = 0, endIndex) {\n    const end = endIndex ?? this.children.length;\n    const range = end - beginIndex;\n    const removed = [];\n    if (range > 0 && range <= end) {\n      for (let i = end - 1; i >= beginIndex; i--) {\n        const child = this.children[i];\n        if (!child)\n          continue;\n        removed.push(child);\n        child.parent = null;\n      }\n      removeItems(this.children, beginIndex, end);\n      const renderGroup = this.renderGroup || this.parentRenderGroup;\n      if (renderGroup) {\n        renderGroup.removeChildren(removed);\n      }\n      for (let i = 0; i < removed.length; ++i) {\n        const child = removed[i];\n        child.parentRenderLayer?.detach(child);\n        this.emit(\"childRemoved\", child, this, i);\n        removed[i].emit(\"removed\", this);\n      }\n      if (removed.length > 0) {\n        this._didViewChangeTick++;\n      }\n      return removed;\n    } else if (range === 0 && this.children.length === 0) {\n      return removed;\n    }\n    throw new RangeError(\"removeChildren: numeric values are outside the acceptable range.\");\n  },\n  removeChildAt(index) {\n    const child = this.getChildAt(index);\n    return this.removeChild(child);\n  },\n  getChildAt(index) {\n    if (index < 0 || index >= this.children.length) {\n      throw new Error(`getChildAt: Index (${index}) does not exist.`);\n    }\n    return this.children[index];\n  },\n  setChildIndex(child, index) {\n    if (index < 0 || index >= this.children.length) {\n      throw new Error(`The index ${index} supplied is out of bounds ${this.children.length}`);\n    }\n    this.getChildIndex(child);\n    this.addChildAt(child, index);\n  },\n  getChildIndex(child) {\n    const index = this.children.indexOf(child);\n    if (index === -1) {\n      throw new Error(\"The supplied Container must be a child of the caller\");\n    }\n    return index;\n  },\n  addChildAt(child, index) {\n    if (!this.allowChildren) {\n      deprecation(v8_0_0, \"addChildAt: Only Containers will be allowed to add children in v8.0.0\");\n    }\n    const { children } = this;\n    if (index < 0 || index > children.length) {\n      throw new Error(`${child}addChildAt: The index ${index} supplied is out of bounds ${children.length}`);\n    }\n    if (child.parent) {\n      const currentIndex = child.parent.children.indexOf(child);\n      if (child.parent === this && currentIndex === index) {\n        return child;\n      }\n      if (currentIndex !== -1) {\n        child.parent.children.splice(currentIndex, 1);\n      }\n    }\n    if (index === children.length) {\n      children.push(child);\n    } else {\n      children.splice(index, 0, child);\n    }\n    child.parent = this;\n    child.didChange = true;\n    child._updateFlags = 15;\n    const renderGroup = this.renderGroup || this.parentRenderGroup;\n    if (renderGroup) {\n      renderGroup.addChild(child);\n    }\n    if (this.sortableChildren)\n      this.sortDirty = true;\n    this.emit(\"childAdded\", child, this, index);\n    child.emit(\"added\", this);\n    return child;\n  },\n  swapChildren(child, child2) {\n    if (child === child2) {\n      return;\n    }\n    const index1 = this.getChildIndex(child);\n    const index2 = this.getChildIndex(child2);\n    this.children[index1] = child2;\n    this.children[index2] = child;\n    const renderGroup = this.renderGroup || this.parentRenderGroup;\n    if (renderGroup) {\n      renderGroup.structureDidChange = true;\n    }\n    this._didContainerChangeTick++;\n  },\n  removeFromParent() {\n    this.parent?.removeChild(this);\n  },\n  reparentChild(...child) {\n    if (child.length === 1) {\n      return this.reparentChildAt(child[0], this.children.length);\n    }\n    child.forEach((c) => this.reparentChildAt(c, this.children.length));\n    return child[0];\n  },\n  reparentChildAt(child, index) {\n    if (child.parent === this) {\n      this.setChildIndex(child, index);\n      return child;\n    }\n    const childMat = child.worldTransform.clone();\n    child.removeFromParent();\n    this.addChildAt(child, index);\n    const newMatrix = this.worldTransform.clone();\n    newMatrix.invert();\n    childMat.prepend(newMatrix);\n    child.setFromMatrix(childMat);\n    return child;\n  },\n  replaceChild(oldChild, newChild) {\n    oldChild.updateLocalTransform();\n    this.addChildAt(newChild, this.getChildIndex(oldChild));\n    newChild.setFromMatrix(oldChild.localTransform);\n    newChild.updateLocalTransform();\n    this.removeChild(oldChild);\n  }\n};\n\nexport { childrenHelperMixin };\n//# sourceMappingURL=childrenHelperMixin.mjs.map\n","\"use strict\";\nconst collectRenderablesMixin = {\n  collectRenderables(instructionSet, renderer, currentLayer) {\n    if (this.parentRenderLayer && this.parentRenderLayer !== currentLayer || this.globalDisplayStatus < 7 || !this.includeInBuild)\n      return;\n    if (this.sortableChildren) {\n      this.sortChildren();\n    }\n    if (this.isSimple) {\n      this.collectRenderablesSimple(instructionSet, renderer, currentLayer);\n    } else if (this.renderGroup) {\n      renderer.renderPipes.renderGroup.addRenderGroup(this.renderGroup, instructionSet);\n    } else {\n      this.collectRenderablesWithEffects(instructionSet, renderer, currentLayer);\n    }\n  },\n  collectRenderablesSimple(instructionSet, renderer, currentLayer) {\n    const children = this.children;\n    const length = children.length;\n    for (let i = 0; i < length; i++) {\n      children[i].collectRenderables(instructionSet, renderer, currentLayer);\n    }\n  },\n  collectRenderablesWithEffects(instructionSet, renderer, currentLayer) {\n    const { renderPipes } = renderer;\n    for (let i = 0; i < this.effects.length; i++) {\n      const effect = this.effects[i];\n      const pipe = renderPipes[effect.pipe];\n      pipe.push(effect, this, instructionSet);\n    }\n    this.collectRenderablesSimple(instructionSet, renderer, currentLayer);\n    for (let i = this.effects.length - 1; i >= 0; i--) {\n      const effect = this.effects[i];\n      const pipe = renderPipes[effect.pipe];\n      pipe.pop(effect, this, instructionSet);\n    }\n  }\n};\n\nexport { collectRenderablesMixin };\n//# sourceMappingURL=collectRenderablesMixin.mjs.map\n","\"use strict\";\nclass FilterEffect {\n  constructor() {\n    /** the pipe that knows how to handle this effect */\n    this.pipe = \"filter\";\n    /** the priority of this effect */\n    this.priority = 1;\n  }\n  destroy() {\n    for (let i = 0; i < this.filters.length; i++) {\n      this.filters[i].destroy();\n    }\n    this.filters = null;\n    this.filterArea = null;\n  }\n}\n\nexport { FilterEffect };\n//# sourceMappingURL=FilterEffect.mjs.map\n","import { extensions, ExtensionType } from '../../extensions/Extensions.mjs';\nimport { BigPool } from '../../utils/pool/PoolGroup.mjs';\n\n\"use strict\";\nclass MaskEffectManagerClass {\n  constructor() {\n    /** @private */\n    this._effectClasses = [];\n    this._tests = [];\n    this._initialized = false;\n  }\n  init() {\n    if (this._initialized)\n      return;\n    this._initialized = true;\n    this._effectClasses.forEach((test) => {\n      this.add({\n        test: test.test,\n        maskClass: test\n      });\n    });\n  }\n  add(test) {\n    this._tests.push(test);\n  }\n  getMaskEffect(item) {\n    if (!this._initialized)\n      this.init();\n    for (let i = 0; i < this._tests.length; i++) {\n      const test = this._tests[i];\n      if (test.test(item)) {\n        return BigPool.get(test.maskClass, item);\n      }\n    }\n    return item;\n  }\n  returnMaskEffect(effect) {\n    BigPool.return(effect);\n  }\n}\nconst MaskEffectManager = new MaskEffectManagerClass();\nextensions.handleByList(ExtensionType.MaskEffect, MaskEffectManager._effectClasses);\n\nexport { MaskEffectManager, MaskEffectManagerClass };\n//# sourceMappingURL=MaskEffectManager.mjs.map\n","import { FilterEffect } from '../../../filters/FilterEffect.mjs';\nimport { MaskEffectManager } from '../../../rendering/mask/MaskEffectManager.mjs';\n\n\"use strict\";\nconst effectsMixin = {\n  _maskEffect: null,\n  _maskOptions: {\n    inverse: false\n  },\n  _filterEffect: null,\n  effects: [],\n  _markStructureAsChanged() {\n    const renderGroup = this.renderGroup || this.parentRenderGroup;\n    if (renderGroup) {\n      renderGroup.structureDidChange = true;\n    }\n  },\n  addEffect(effect) {\n    const index = this.effects.indexOf(effect);\n    if (index !== -1)\n      return;\n    this.effects.push(effect);\n    this.effects.sort((a, b) => a.priority - b.priority);\n    this._markStructureAsChanged();\n    this._updateIsSimple();\n  },\n  removeEffect(effect) {\n    const index = this.effects.indexOf(effect);\n    if (index === -1)\n      return;\n    this.effects.splice(index, 1);\n    this._markStructureAsChanged();\n    this._updateIsSimple();\n  },\n  set mask(value) {\n    const effect = this._maskEffect;\n    if (effect?.mask === value)\n      return;\n    if (effect) {\n      this.removeEffect(effect);\n      MaskEffectManager.returnMaskEffect(effect);\n      this._maskEffect = null;\n    }\n    if (value === null || value === void 0)\n      return;\n    this._maskEffect = MaskEffectManager.getMaskEffect(value);\n    this.addEffect(this._maskEffect);\n  },\n  get mask() {\n    return this._maskEffect?.mask;\n  },\n  setMask(options) {\n    this._maskOptions = {\n      ...this._maskOptions,\n      ...options\n    };\n    if (options.mask) {\n      this.mask = options.mask;\n    }\n    this._markStructureAsChanged();\n  },\n  set filters(value) {\n    if (!Array.isArray(value) && value)\n      value = [value];\n    const effect = this._filterEffect || (this._filterEffect = new FilterEffect());\n    value = value;\n    const hasFilters = value?.length > 0;\n    const hadFilters = effect.filters?.length > 0;\n    const didChange = hasFilters !== hadFilters;\n    value = Array.isArray(value) ? value.slice(0) : value;\n    effect.filters = Object.freeze(value);\n    if (didChange) {\n      if (hasFilters) {\n        this.addEffect(effect);\n      } else {\n        this.removeEffect(effect);\n        effect.filters = value ?? null;\n      }\n    }\n  },\n  get filters() {\n    return this._filterEffect?.filters;\n  },\n  set filterArea(value) {\n    this._filterEffect || (this._filterEffect = new FilterEffect());\n    this._filterEffect.filterArea = value;\n  },\n  get filterArea() {\n    return this._filterEffect?.filterArea;\n  }\n};\n\nexport { effectsMixin };\n//# sourceMappingURL=effectsMixin.mjs.map\n","import { deprecation, v8_0_0 } from '../../../utils/logging/deprecation.mjs';\n\n\"use strict\";\nconst findMixin = {\n  label: null,\n  get name() {\n    deprecation(v8_0_0, \"Container.name property has been removed, use Container.label instead\");\n    return this.label;\n  },\n  set name(value) {\n    deprecation(v8_0_0, \"Container.name property has been removed, use Container.label instead\");\n    this.label = value;\n  },\n  getChildByName(name, deep = false) {\n    return this.getChildByLabel(name, deep);\n  },\n  getChildByLabel(label, deep = false) {\n    const children = this.children;\n    for (let i = 0; i < children.length; i++) {\n      const child = children[i];\n      if (child.label === label || label instanceof RegExp && label.test(child.label))\n        return child;\n    }\n    if (deep) {\n      for (let i = 0; i < children.length; i++) {\n        const child = children[i];\n        const found = child.getChildByLabel(label, true);\n        if (found) {\n          return found;\n        }\n      }\n    }\n    return null;\n  },\n  getChildrenByLabel(label, deep = false, out = []) {\n    const children = this.children;\n    for (let i = 0; i < children.length; i++) {\n      const child = children[i];\n      if (child.label === label || label instanceof RegExp && label.test(child.label)) {\n        out.push(child);\n      }\n    }\n    if (deep) {\n      for (let i = 0; i < children.length; i++) {\n        children[i].getChildrenByLabel(label, true, out);\n      }\n    }\n    return out;\n  }\n};\n\nexport { findMixin };\n//# sourceMappingURL=findMixin.mjs.map\n","import { Matrix } from '../../../../maths/matrix/Matrix.mjs';\nimport { BigPool } from '../../../../utils/pool/PoolGroup.mjs';\nimport { Bounds } from '../Bounds.mjs';\n\n\"use strict\";\nconst matrixPool = BigPool.getPool(Matrix);\nconst boundsPool = BigPool.getPool(Bounds);\n\nexport { boundsPool, matrixPool };\n//# sourceMappingURL=matrixAndBoundsPool.mjs.map\n","import { Matrix } from '../../../maths/matrix/Matrix.mjs';\nimport { Bounds } from '../bounds/Bounds.mjs';\nimport { boundsPool } from '../bounds/utils/matrixAndBoundsPool.mjs';\n\n\"use strict\";\nconst tempMatrix = new Matrix();\nconst getFastGlobalBoundsMixin = {\n  getFastGlobalBounds(factorRenderLayers, bounds) {\n    bounds || (bounds = new Bounds());\n    bounds.clear();\n    this._getGlobalBoundsRecursive(!!factorRenderLayers, bounds, this.parentRenderLayer);\n    if (!bounds.isValid) {\n      bounds.set(0, 0, 0, 0);\n    }\n    const renderGroup = this.renderGroup || this.parentRenderGroup;\n    bounds.applyMatrix(renderGroup.worldTransform);\n    return bounds;\n  },\n  _getGlobalBoundsRecursive(factorRenderLayers, bounds, currentLayer) {\n    let localBounds = bounds;\n    if (factorRenderLayers && this.parentRenderLayer && this.parentRenderLayer !== currentLayer)\n      return;\n    if (this.localDisplayStatus !== 7 || !this.measurable) {\n      return;\n    }\n    const manageEffects = !!this.effects.length;\n    if (this.renderGroup || manageEffects) {\n      localBounds = boundsPool.get().clear();\n    }\n    if (this.boundsArea) {\n      bounds.addRect(this.boundsArea, this.worldTransform);\n    } else {\n      if (this.renderPipeId) {\n        const viewBounds = this.bounds;\n        localBounds.addFrame(\n          viewBounds.minX,\n          viewBounds.minY,\n          viewBounds.maxX,\n          viewBounds.maxY,\n          this.groupTransform\n        );\n      }\n      const children = this.children;\n      for (let i = 0; i < children.length; i++) {\n        children[i]._getGlobalBoundsRecursive(factorRenderLayers, localBounds, currentLayer);\n      }\n    }\n    if (manageEffects) {\n      let advanced = false;\n      const renderGroup = this.renderGroup || this.parentRenderGroup;\n      for (let i = 0; i < this.effects.length; i++) {\n        if (this.effects[i].addBounds) {\n          if (!advanced) {\n            advanced = true;\n            localBounds.applyMatrix(renderGroup.worldTransform);\n          }\n          this.effects[i].addBounds(localBounds, true);\n        }\n      }\n      if (advanced) {\n        localBounds.applyMatrix(renderGroup.worldTransform.copyTo(tempMatrix).invert());\n      }\n      bounds.addBounds(localBounds);\n      boundsPool.return(localBounds);\n    } else if (this.renderGroup) {\n      bounds.addBounds(localBounds, this.relativeGroupTransform);\n      boundsPool.return(localBounds);\n    }\n  }\n};\n\nexport { getFastGlobalBoundsMixin };\n//# sourceMappingURL=getFastGlobalBoundsMixin.mjs.map\n","import { Matrix } from '../../../maths/matrix/Matrix.mjs';\nimport { matrixPool, boundsPool } from './utils/matrixAndBoundsPool.mjs';\n\n\"use strict\";\nfunction getGlobalBounds(target, skipUpdateTransform, bounds) {\n  bounds.clear();\n  let parentTransform;\n  let pooledMatrix;\n  if (target.parent) {\n    if (!skipUpdateTransform) {\n      pooledMatrix = matrixPool.get().identity();\n      parentTransform = updateTransformBackwards(target, pooledMatrix);\n    } else {\n      parentTransform = target.parent.worldTransform;\n    }\n  } else {\n    parentTransform = Matrix.IDENTITY;\n  }\n  _getGlobalBounds(target, bounds, parentTransform, skipUpdateTransform);\n  if (pooledMatrix) {\n    matrixPool.return(pooledMatrix);\n  }\n  if (!bounds.isValid) {\n    bounds.set(0, 0, 0, 0);\n  }\n  return bounds;\n}\nfunction _getGlobalBounds(target, bounds, parentTransform, skipUpdateTransform) {\n  if (!target.visible || !target.measurable)\n    return;\n  let worldTransform;\n  if (!skipUpdateTransform) {\n    target.updateLocalTransform();\n    worldTransform = matrixPool.get();\n    worldTransform.appendFrom(target.localTransform, parentTransform);\n  } else {\n    worldTransform = target.worldTransform;\n  }\n  const parentBounds = bounds;\n  const preserveBounds = !!target.effects.length;\n  if (preserveBounds) {\n    bounds = boundsPool.get().clear();\n  }\n  if (target.boundsArea) {\n    bounds.addRect(target.boundsArea, worldTransform);\n  } else {\n    const renderableBounds = target.bounds;\n    if (renderableBounds && !renderableBounds.isEmpty()) {\n      bounds.matrix = worldTransform;\n      bounds.addBounds(renderableBounds);\n    }\n    for (let i = 0; i < target.children.length; i++) {\n      _getGlobalBounds(target.children[i], bounds, worldTransform, skipUpdateTransform);\n    }\n  }\n  if (preserveBounds) {\n    for (let i = 0; i < target.effects.length; i++) {\n      target.effects[i].addBounds?.(bounds);\n    }\n    parentBounds.addBounds(bounds, Matrix.IDENTITY);\n    boundsPool.return(bounds);\n  }\n  if (!skipUpdateTransform) {\n    matrixPool.return(worldTransform);\n  }\n}\nfunction updateTransformBackwards(target, parentTransform) {\n  const parent = target.parent;\n  if (parent) {\n    updateTransformBackwards(parent, parentTransform);\n    parent.updateLocalTransform();\n    parentTransform.append(parent.localTransform);\n  }\n  return parentTransform;\n}\n\nexport { getGlobalBounds, updateTransformBackwards };\n//# sourceMappingURL=getGlobalBounds.mjs.map\n","\"use strict\";\nfunction multiplyHexColors(color1, color2) {\n  if (color1 === 16777215 || !color2)\n    return color2;\n  if (color2 === 16777215 || !color1)\n    return color1;\n  const r1 = color1 >> 16 & 255;\n  const g1 = color1 >> 8 & 255;\n  const b1 = color1 & 255;\n  const r2 = color2 >> 16 & 255;\n  const g2 = color2 >> 8 & 255;\n  const b2 = color2 & 255;\n  const r = r1 * r2 / 255 | 0;\n  const g = g1 * g2 / 255 | 0;\n  const b = b1 * b2 / 255 | 0;\n  return (r << 16) + (g << 8) + b;\n}\n\nexport { multiplyHexColors };\n//# sourceMappingURL=multiplyHexColors.mjs.map\n","import { multiplyHexColors } from './multiplyHexColors.mjs';\n\n\"use strict\";\nconst WHITE_BGR = 16777215;\nfunction multiplyColors(localBGRColor, parentBGRColor) {\n  if (localBGRColor === WHITE_BGR) {\n    return parentBGRColor;\n  }\n  if (parentBGRColor === WHITE_BGR) {\n    return localBGRColor;\n  }\n  return multiplyHexColors(localBGRColor, parentBGRColor);\n}\n\nexport { multiplyColors };\n//# sourceMappingURL=multiplyColors.mjs.map\n","import { Matrix } from '../../../maths/matrix/Matrix.mjs';\nimport { updateTransformBackwards } from '../bounds/getGlobalBounds.mjs';\nimport { matrixPool } from '../bounds/utils/matrixAndBoundsPool.mjs';\nimport { multiplyColors } from '../utils/multiplyColors.mjs';\n\n\"use strict\";\nfunction bgr2rgb(color) {\n  return ((color & 255) << 16) + (color & 65280) + (color >> 16 & 255);\n}\nconst getGlobalMixin = {\n  getGlobalAlpha(skipUpdate) {\n    if (skipUpdate) {\n      if (this.renderGroup) {\n        return this.renderGroup.worldAlpha;\n      }\n      if (this.parentRenderGroup) {\n        return this.parentRenderGroup.worldAlpha * this.alpha;\n      }\n      return this.alpha;\n    }\n    let alpha = this.alpha;\n    let current = this.parent;\n    while (current) {\n      alpha *= current.alpha;\n      current = current.parent;\n    }\n    return alpha;\n  },\n  getGlobalTransform(matrix = new Matrix(), skipUpdate) {\n    if (skipUpdate) {\n      return matrix.copyFrom(this.worldTransform);\n    }\n    this.updateLocalTransform();\n    const parentTransform = updateTransformBackwards(this, matrixPool.get().identity());\n    matrix.appendFrom(this.localTransform, parentTransform);\n    matrixPool.return(parentTransform);\n    return matrix;\n  },\n  getGlobalTint(skipUpdate) {\n    if (skipUpdate) {\n      if (this.renderGroup) {\n        return bgr2rgb(this.renderGroup.worldColor);\n      }\n      if (this.parentRenderGroup) {\n        return bgr2rgb(\n          multiplyColors(this.localColor, this.parentRenderGroup.worldColor)\n        );\n      }\n      return this.tint;\n    }\n    let color = this.localColor;\n    let parent = this.parent;\n    while (parent) {\n      color = multiplyColors(color, parent.localColor);\n      parent = parent.parent;\n    }\n    return bgr2rgb(color);\n  }\n};\n\nexport { bgr2rgb, getGlobalMixin };\n//# sourceMappingURL=getGlobalMixin.mjs.map\n","import { Matrix } from '../../../maths/matrix/Matrix.mjs';\nimport { matrixPool, boundsPool } from './utils/matrixAndBoundsPool.mjs';\n\n\"use strict\";\nfunction getLocalBounds(target, bounds, relativeMatrix) {\n  bounds.clear();\n  relativeMatrix || (relativeMatrix = Matrix.IDENTITY);\n  _getLocalBounds(target, bounds, relativeMatrix, target, true);\n  if (!bounds.isValid) {\n    bounds.set(0, 0, 0, 0);\n  }\n  return bounds;\n}\nfunction _getLocalBounds(target, bounds, parentTransform, rootContainer, isRoot) {\n  let relativeTransform;\n  if (!isRoot) {\n    if (!target.visible || !target.measurable)\n      return;\n    target.updateLocalTransform();\n    const localTransform = target.localTransform;\n    relativeTransform = matrixPool.get();\n    relativeTransform.appendFrom(localTransform, parentTransform);\n  } else {\n    relativeTransform = matrixPool.get();\n    relativeTransform = parentTransform.copyTo(relativeTransform);\n  }\n  const parentBounds = bounds;\n  const preserveBounds = !!target.effects.length;\n  if (preserveBounds) {\n    bounds = boundsPool.get().clear();\n  }\n  if (target.boundsArea) {\n    bounds.addRect(target.boundsArea, relativeTransform);\n  } else {\n    if (target.renderPipeId) {\n      bounds.matrix = relativeTransform;\n      bounds.addBounds(target.bounds);\n    }\n    const children = target.children;\n    for (let i = 0; i < children.length; i++) {\n      _getLocalBounds(children[i], bounds, relativeTransform, rootContainer, false);\n    }\n  }\n  if (preserveBounds) {\n    for (let i = 0; i < target.effects.length; i++) {\n      target.effects[i].addLocalBounds?.(bounds, rootContainer);\n    }\n    parentBounds.addBounds(bounds, Matrix.IDENTITY);\n    boundsPool.return(bounds);\n  }\n  matrixPool.return(relativeTransform);\n}\n\nexport { getLocalBounds };\n//# sourceMappingURL=getLocalBounds.mjs.map\n","\"use strict\";\nfunction checkChildrenDidChange(container, previousData) {\n  const children = container.children;\n  for (let i = 0; i < children.length; i++) {\n    const child = children[i];\n    const uid = child.uid;\n    const didChange = (child._didViewChangeTick & 65535) << 16 | child._didContainerChangeTick & 65535;\n    const index = previousData.index;\n    if (previousData.data[index] !== uid || previousData.data[index + 1] !== didChange) {\n      previousData.data[previousData.index] = uid;\n      previousData.data[previousData.index + 1] = didChange;\n      previousData.didChange = true;\n    }\n    previousData.index = index + 2;\n    if (child.children.length) {\n      checkChildrenDidChange(child, previousData);\n    }\n  }\n  return previousData.didChange;\n}\n\nexport { checkChildrenDidChange };\n//# sourceMappingURL=checkChildrenDidChange.mjs.map\n","import { Matrix } from '../../../maths/matrix/Matrix.mjs';\nimport { Bounds } from '../bounds/Bounds.mjs';\nimport { getGlobalBounds } from '../bounds/getGlobalBounds.mjs';\nimport { getLocalBounds } from '../bounds/getLocalBounds.mjs';\nimport { checkChildrenDidChange } from '../utils/checkChildrenDidChange.mjs';\n\n\"use strict\";\nconst tempMatrix = new Matrix();\nconst measureMixin = {\n  _localBoundsCacheId: -1,\n  _localBoundsCacheData: null,\n  _setWidth(value, localWidth) {\n    const sign = Math.sign(this.scale.x) || 1;\n    if (localWidth !== 0) {\n      this.scale.x = value / localWidth * sign;\n    } else {\n      this.scale.x = sign;\n    }\n  },\n  _setHeight(value, localHeight) {\n    const sign = Math.sign(this.scale.y) || 1;\n    if (localHeight !== 0) {\n      this.scale.y = value / localHeight * sign;\n    } else {\n      this.scale.y = sign;\n    }\n  },\n  getLocalBounds() {\n    if (!this._localBoundsCacheData) {\n      this._localBoundsCacheData = {\n        data: [],\n        index: 1,\n        didChange: false,\n        localBounds: new Bounds()\n      };\n    }\n    const localBoundsCacheData = this._localBoundsCacheData;\n    localBoundsCacheData.index = 1;\n    localBoundsCacheData.didChange = false;\n    if (localBoundsCacheData.data[0] !== this._didViewChangeTick) {\n      localBoundsCacheData.didChange = true;\n      localBoundsCacheData.data[0] = this._didViewChangeTick;\n    }\n    checkChildrenDidChange(this, localBoundsCacheData);\n    if (localBoundsCacheData.didChange) {\n      getLocalBounds(this, localBoundsCacheData.localBounds, tempMatrix);\n    }\n    return localBoundsCacheData.localBounds;\n  },\n  getBounds(skipUpdate, bounds) {\n    return getGlobalBounds(this, skipUpdate, bounds || new Bounds());\n  }\n};\n\nexport { measureMixin };\n//# sourceMappingURL=measureMixin.mjs.map\n","\"use strict\";\nconst onRenderMixin = {\n  _onRender: null,\n  set onRender(func) {\n    const renderGroup = this.renderGroup || this.parentRenderGroup;\n    if (!func) {\n      if (this._onRender) {\n        renderGroup?.removeOnRender(this);\n      }\n      this._onRender = null;\n      return;\n    }\n    if (!this._onRender) {\n      renderGroup?.addOnRender(this);\n    }\n    this._onRender = func;\n  },\n  get onRender() {\n    return this._onRender;\n  }\n};\n\nexport { onRenderMixin };\n//# sourceMappingURL=onRenderMixin.mjs.map\n","\"use strict\";\nconst sortMixin = {\n  _zIndex: 0,\n  sortDirty: false,\n  sortableChildren: false,\n  get zIndex() {\n    return this._zIndex;\n  },\n  set zIndex(value) {\n    if (this._zIndex === value)\n      return;\n    this._zIndex = value;\n    this.depthOfChildModified();\n  },\n  depthOfChildModified() {\n    if (this.parent) {\n      this.parent.sortableChildren = true;\n      this.parent.sortDirty = true;\n    }\n    if (this.parentRenderGroup) {\n      this.parentRenderGroup.structureDidChange = true;\n    }\n  },\n  sortChildren() {\n    if (!this.sortDirty)\n      return;\n    this.sortDirty = false;\n    this.children.sort(sortChildren);\n  }\n};\nfunction sortChildren(a, b) {\n  return a._zIndex - b._zIndex;\n}\n\nexport { sortMixin };\n//# sourceMappingURL=sortMixin.mjs.map\n","import { Point } from '../../../maths/point/Point.mjs';\nimport { matrixPool } from '../bounds/utils/matrixAndBoundsPool.mjs';\n\n\"use strict\";\nconst toLocalGlobalMixin = {\n  getGlobalPosition(point = new Point(), skipUpdate = false) {\n    if (this.parent) {\n      this.parent.toGlobal(this._position, point, skipUpdate);\n    } else {\n      point.x = this._position.x;\n      point.y = this._position.y;\n    }\n    return point;\n  },\n  toGlobal(position, point, skipUpdate = false) {\n    const globalMatrix = this.getGlobalTransform(matrixPool.get(), skipUpdate);\n    point = globalMatrix.apply(position, point);\n    matrixPool.return(globalMatrix);\n    return point;\n  },\n  toLocal(position, from, point, skipUpdate) {\n    if (from) {\n      position = from.toGlobal(position, point, skipUpdate);\n    }\n    const globalMatrix = this.getGlobalTransform(matrixPool.get(), skipUpdate);\n    point = globalMatrix.applyInverse(position, point);\n    matrixPool.return(globalMatrix);\n    return point;\n  }\n};\n\nexport { toLocalGlobalMixin };\n//# sourceMappingURL=toLocalGlobalMixin.mjs.map\n","import { uid } from '../../../../utils/data/uid.mjs';\n\n\"use strict\";\nclass InstructionSet {\n  constructor() {\n    /** a unique id for this instruction set used through the renderer */\n    this.uid = uid(\"instructionSet\");\n    /** the array of instructions */\n    this.instructions = [];\n    /** the actual size of the array (any instructions passed this should be ignored) */\n    this.instructionSize = 0;\n    this.renderables = [];\n    /** used by the garbage collector to track when the instruction set was last used */\n    this.gcTick = 0;\n  }\n  /** reset the instruction set so it can be reused set size back to 0 */\n  reset() {\n    this.instructionSize = 0;\n  }\n  /**\n   * Destroy the instruction set, clearing the instructions and renderables.\n   * @internal\n   */\n  destroy() {\n    this.instructions.length = 0;\n    this.renderables.length = 0;\n    this.renderPipes = null;\n    this.gcTick = 0;\n  }\n  /**\n   * Add an instruction to the set\n   * @param instruction - add an instruction to the set\n   */\n  add(instruction) {\n    this.instructions[this.instructionSize++] = instruction;\n  }\n  /**\n   * Log the instructions to the console (for debugging)\n   * @internal\n   */\n  log() {\n    this.instructions.length = this.instructionSize;\n    console.table(this.instructions, [\"type\", \"action\"]);\n  }\n}\n\nexport { InstructionSet };\n//# sourceMappingURL=InstructionSet.mjs.map\n","import { nextPow2 } from '../../../../maths/misc/pow2.mjs';\nimport { GlobalResourceRegistry } from '../../../../utils/pool/GlobalResourceRegistry.mjs';\nimport { TextureSource } from './sources/TextureSource.mjs';\nimport { Texture } from './Texture.mjs';\nimport { TextureStyle } from './TextureStyle.mjs';\n\n\"use strict\";\nlet count = 0;\nclass TexturePoolClass {\n  /**\n   * @param textureOptions - options that will be passed to BaseRenderTexture constructor\n   * @param {SCALE_MODE} [textureOptions.scaleMode] - See {@link SCALE_MODE} for possible values.\n   */\n  constructor(textureOptions) {\n    this._poolKeyHash = /* @__PURE__ */ Object.create(null);\n    this._texturePool = {};\n    this.textureOptions = textureOptions || {};\n    this.enableFullScreen = false;\n    this.textureStyle = new TextureStyle(this.textureOptions);\n  }\n  /**\n   * Creates texture with params that were specified in pool constructor.\n   * @param pixelWidth - Width of texture in pixels.\n   * @param pixelHeight - Height of texture in pixels.\n   * @param antialias\n   */\n  createTexture(pixelWidth, pixelHeight, antialias) {\n    const textureSource = new TextureSource({\n      ...this.textureOptions,\n      width: pixelWidth,\n      height: pixelHeight,\n      resolution: 1,\n      antialias,\n      autoGarbageCollect: false\n    });\n    return new Texture({\n      source: textureSource,\n      label: `texturePool_${count++}`\n    });\n  }\n  /**\n   * Gets a Power-of-Two render texture or fullScreen texture\n   * @param frameWidth - The minimum width of the render texture.\n   * @param frameHeight - The minimum height of the render texture.\n   * @param resolution - The resolution of the render texture.\n   * @param antialias\n   * @returns The new render texture.\n   */\n  getOptimalTexture(frameWidth, frameHeight, resolution = 1, antialias) {\n    let po2Width = Math.ceil(frameWidth * resolution - 1e-6);\n    let po2Height = Math.ceil(frameHeight * resolution - 1e-6);\n    po2Width = nextPow2(po2Width);\n    po2Height = nextPow2(po2Height);\n    const key = (po2Width << 17) + (po2Height << 1) + (antialias ? 1 : 0);\n    if (!this._texturePool[key]) {\n      this._texturePool[key] = [];\n    }\n    let texture = this._texturePool[key].pop();\n    if (!texture) {\n      texture = this.createTexture(po2Width, po2Height, antialias);\n    }\n    texture.source._resolution = resolution;\n    texture.source.width = po2Width / resolution;\n    texture.source.height = po2Height / resolution;\n    texture.source.pixelWidth = po2Width;\n    texture.source.pixelHeight = po2Height;\n    texture.frame.x = 0;\n    texture.frame.y = 0;\n    texture.frame.width = frameWidth;\n    texture.frame.height = frameHeight;\n    texture.updateUvs();\n    this._poolKeyHash[texture.uid] = key;\n    return texture;\n  }\n  /**\n   * Gets extra texture of the same size as input renderTexture\n   * @param texture - The texture to check what size it is.\n   * @param antialias - Whether to use antialias.\n   * @returns A texture that is a power of two\n   */\n  getSameSizeTexture(texture, antialias = false) {\n    const source = texture.source;\n    return this.getOptimalTexture(texture.width, texture.height, source._resolution, antialias);\n  }\n  /**\n   * Place a render texture back into the pool. Optionally reset the style of the texture to the default texture style.\n   * useful if you modified the style of the texture after getting it from the pool.\n   * @param renderTexture - The renderTexture to free\n   * @param resetStyle - Whether to reset the style of the texture to the default texture style\n   */\n  returnTexture(renderTexture, resetStyle = false) {\n    const key = this._poolKeyHash[renderTexture.uid];\n    if (resetStyle) {\n      renderTexture.source.style = this.textureStyle;\n    }\n    this._texturePool[key].push(renderTexture);\n  }\n  /**\n   * Clears the pool.\n   * @param destroyTextures - Destroy all stored textures.\n   */\n  clear(destroyTextures) {\n    destroyTextures = destroyTextures !== false;\n    if (destroyTextures) {\n      for (const i in this._texturePool) {\n        const textures = this._texturePool[i];\n        if (textures) {\n          for (let j = 0; j < textures.length; j++) {\n            textures[j].destroy(true);\n          }\n        }\n      }\n    }\n    this._texturePool = {};\n  }\n}\nconst TexturePool = new TexturePoolClass();\nGlobalResourceRegistry.register(TexturePool);\n\nexport { TexturePool, TexturePoolClass };\n//# sourceMappingURL=TexturePool.mjs.map\n","import { Matrix } from '../../maths/matrix/Matrix.mjs';\nimport { InstructionSet } from '../../rendering/renderers/shared/instructions/InstructionSet.mjs';\nimport { TexturePool } from '../../rendering/renderers/shared/texture/TexturePool.mjs';\n\n\"use strict\";\nclass RenderGroup {\n  constructor() {\n    this.renderPipeId = \"renderGroup\";\n    this.root = null;\n    this.canBundle = false;\n    this.renderGroupParent = null;\n    this.renderGroupChildren = [];\n    this.worldTransform = new Matrix();\n    this.worldColorAlpha = 4294967295;\n    this.worldColor = 16777215;\n    this.worldAlpha = 1;\n    // these updates are transform changes..\n    this.childrenToUpdate = /* @__PURE__ */ Object.create(null);\n    this.updateTick = 0;\n    this.gcTick = 0;\n    // these update are renderable changes..\n    this.childrenRenderablesToUpdate = { list: [], index: 0 };\n    // other\n    this.structureDidChange = true;\n    this.instructionSet = new InstructionSet();\n    this._onRenderContainers = [];\n    /**\n     * Indicates if the cached texture needs to be updated.\n     * @default true\n     */\n    this.textureNeedsUpdate = true;\n    /**\n     * Indicates if the container should be cached as a texture.\n     * @default false\n     */\n    this.isCachedAsTexture = false;\n    this._matrixDirty = 7;\n  }\n  init(root) {\n    this.root = root;\n    if (root._onRender)\n      this.addOnRender(root);\n    root.didChange = true;\n    const children = root.children;\n    for (let i = 0; i < children.length; i++) {\n      const child = children[i];\n      child._updateFlags = 15;\n      this.addChild(child);\n    }\n  }\n  enableCacheAsTexture(options = {}) {\n    this.textureOptions = options;\n    this.isCachedAsTexture = true;\n    this.textureNeedsUpdate = true;\n  }\n  disableCacheAsTexture() {\n    this.isCachedAsTexture = false;\n    if (this.texture) {\n      TexturePool.returnTexture(this.texture, true);\n      this.texture = null;\n    }\n  }\n  updateCacheTexture() {\n    this.textureNeedsUpdate = true;\n    const cachedParent = this._parentCacheAsTextureRenderGroup;\n    if (cachedParent && !cachedParent.textureNeedsUpdate) {\n      cachedParent.updateCacheTexture();\n    }\n  }\n  reset() {\n    this.renderGroupChildren.length = 0;\n    for (const i in this.childrenToUpdate) {\n      const childrenAtDepth = this.childrenToUpdate[i];\n      childrenAtDepth.list.fill(null);\n      childrenAtDepth.index = 0;\n    }\n    this.childrenRenderablesToUpdate.index = 0;\n    this.childrenRenderablesToUpdate.list.fill(null);\n    this.root = null;\n    this.updateTick = 0;\n    this.structureDidChange = true;\n    this._onRenderContainers.length = 0;\n    this.renderGroupParent = null;\n    this.disableCacheAsTexture();\n  }\n  get localTransform() {\n    return this.root.localTransform;\n  }\n  addRenderGroupChild(renderGroupChild) {\n    if (renderGroupChild.renderGroupParent) {\n      renderGroupChild.renderGroupParent._removeRenderGroupChild(renderGroupChild);\n    }\n    renderGroupChild.renderGroupParent = this;\n    this.renderGroupChildren.push(renderGroupChild);\n  }\n  _removeRenderGroupChild(renderGroupChild) {\n    const index = this.renderGroupChildren.indexOf(renderGroupChild);\n    if (index > -1) {\n      this.renderGroupChildren.splice(index, 1);\n    }\n    renderGroupChild.renderGroupParent = null;\n  }\n  addChild(child) {\n    this.structureDidChange = true;\n    child.parentRenderGroup = this;\n    child.updateTick = -1;\n    if (child.parent === this.root) {\n      child.relativeRenderGroupDepth = 1;\n    } else {\n      child.relativeRenderGroupDepth = child.parent.relativeRenderGroupDepth + 1;\n    }\n    child.didChange = true;\n    this.onChildUpdate(child);\n    if (child.renderGroup) {\n      this.addRenderGroupChild(child.renderGroup);\n      return;\n    }\n    if (child._onRender)\n      this.addOnRender(child);\n    const children = child.children;\n    for (let i = 0; i < children.length; i++) {\n      this.addChild(children[i]);\n    }\n  }\n  removeChild(child) {\n    this.structureDidChange = true;\n    if (child._onRender) {\n      if (!child.renderGroup) {\n        this.removeOnRender(child);\n      }\n    }\n    child.parentRenderGroup = null;\n    if (child.renderGroup) {\n      this._removeRenderGroupChild(child.renderGroup);\n      return;\n    }\n    const children = child.children;\n    for (let i = 0; i < children.length; i++) {\n      this.removeChild(children[i]);\n    }\n  }\n  removeChildren(children) {\n    for (let i = 0; i < children.length; i++) {\n      this.removeChild(children[i]);\n    }\n  }\n  onChildUpdate(child) {\n    let childrenToUpdate = this.childrenToUpdate[child.relativeRenderGroupDepth];\n    if (!childrenToUpdate) {\n      childrenToUpdate = this.childrenToUpdate[child.relativeRenderGroupDepth] = {\n        index: 0,\n        list: []\n      };\n    }\n    childrenToUpdate.list[childrenToUpdate.index++] = child;\n  }\n  updateRenderable(renderable) {\n    if (renderable.globalDisplayStatus < 7)\n      return;\n    this.instructionSet.renderPipes[renderable.renderPipeId].updateRenderable(renderable);\n    renderable.didViewUpdate = false;\n  }\n  onChildViewUpdate(child) {\n    this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++] = child;\n  }\n  get isRenderable() {\n    return this.root.localDisplayStatus === 7 && this.worldAlpha > 0;\n  }\n  /**\n   * adding a container to the onRender list will make sure the user function\n   * passed in to the user defined 'onRender` callBack\n   * @param container - the container to add to the onRender list\n   */\n  addOnRender(container) {\n    this._onRenderContainers.push(container);\n  }\n  removeOnRender(container) {\n    this._onRenderContainers.splice(this._onRenderContainers.indexOf(container), 1);\n  }\n  runOnRender(renderer) {\n    for (let i = 0; i < this._onRenderContainers.length; i++) {\n      this._onRenderContainers[i]._onRender(renderer);\n    }\n  }\n  destroy() {\n    this.disableCacheAsTexture();\n    this.renderGroupParent = null;\n    this.root = null;\n    this.childrenRenderablesToUpdate = null;\n    this.childrenToUpdate = null;\n    this.renderGroupChildren = null;\n    this._onRenderContainers = null;\n    this.instructionSet = null;\n  }\n  getChildren(out = []) {\n    const children = this.root.children;\n    for (let i = 0; i < children.length; i++) {\n      this._getChildren(children[i], out);\n    }\n    return out;\n  }\n  _getChildren(container, out = []) {\n    out.push(container);\n    if (container.renderGroup)\n      return out;\n    const children = container.children;\n    for (let i = 0; i < children.length; i++) {\n      this._getChildren(children[i], out);\n    }\n    return out;\n  }\n  invalidateMatrices() {\n    this._matrixDirty = 7;\n  }\n  /**\n   * Returns the inverse of the world transform matrix.\n   * @returns {Matrix} The inverse of the world transform matrix.\n   */\n  get inverseWorldTransform() {\n    if ((this._matrixDirty & 1) === 0)\n      return this._inverseWorldTransform;\n    this._matrixDirty &= ~1;\n    this._inverseWorldTransform || (this._inverseWorldTransform = new Matrix());\n    return this._inverseWorldTransform.copyFrom(this.worldTransform).invert();\n  }\n  /**\n   * Returns the inverse of the texture offset transform matrix.\n   * @returns {Matrix} The inverse of the texture offset transform matrix.\n   */\n  get textureOffsetInverseTransform() {\n    if ((this._matrixDirty & 2) === 0)\n      return this._textureOffsetInverseTransform;\n    this._matrixDirty &= ~2;\n    this._textureOffsetInverseTransform || (this._textureOffsetInverseTransform = new Matrix());\n    return this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(\n      -this._textureBounds.x,\n      -this._textureBounds.y\n    );\n  }\n  /**\n   * Returns the inverse of the parent texture transform matrix.\n   * This is used to properly transform coordinates when rendering into cached textures.\n   * @returns {Matrix} The inverse of the parent texture transform matrix.\n   */\n  get inverseParentTextureTransform() {\n    if ((this._matrixDirty & 4) === 0)\n      return this._inverseParentTextureTransform;\n    this._matrixDirty &= ~4;\n    const parentCacheAsTexture = this._parentCacheAsTextureRenderGroup;\n    if (parentCacheAsTexture) {\n      this._inverseParentTextureTransform || (this._inverseParentTextureTransform = new Matrix());\n      return this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(parentCacheAsTexture.inverseWorldTransform).translate(\n        -parentCacheAsTexture._textureBounds.x,\n        -parentCacheAsTexture._textureBounds.y\n      );\n    }\n    return this.worldTransform;\n  }\n  /**\n   * Returns a matrix that transforms coordinates to the correct coordinate space of the texture being rendered to.\n   * This is the texture offset inverse transform of the closest parent RenderGroup that is cached as a texture.\n   * @returns {Matrix | null} The transform matrix for the cached texture coordinate space,\n   * or null if no parent is cached as texture.\n   */\n  get cacheToLocalTransform() {\n    if (this.isCachedAsTexture) {\n      return this.textureOffsetInverseTransform;\n    }\n    if (!this._parentCacheAsTextureRenderGroup)\n      return null;\n    return this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform;\n  }\n}\n\nexport { RenderGroup };\n//# sourceMappingURL=RenderGroup.mjs.map\n","\"use strict\";\nfunction assignWithIgnore(target, options, ignore = {}) {\n  for (const key in options) {\n    if (!ignore[key] && options[key] !== void 0) {\n      target[key] = options[key];\n    }\n  }\n}\n\nexport { assignWithIgnore };\n//# sourceMappingURL=assignWithIgnore.mjs.map\n","import EventEmitter from 'eventemitter3';\nimport { Color } from '../../color/Color.mjs';\nimport { cullingMixin } from '../../culling/cullingMixin.mjs';\nimport { extensions } from '../../extensions/Extensions.mjs';\nimport { Matrix } from '../../maths/matrix/Matrix.mjs';\nimport { RAD_TO_DEG, DEG_TO_RAD } from '../../maths/misc/const.mjs';\nimport { ObservablePoint } from '../../maths/point/ObservablePoint.mjs';\nimport { uid } from '../../utils/data/uid.mjs';\nimport { deprecation, v8_0_0 } from '../../utils/logging/deprecation.mjs';\nimport { warn } from '../../utils/logging/warn.mjs';\nimport { BigPool } from '../../utils/pool/PoolGroup.mjs';\nimport { cacheAsTextureMixin } from './container-mixins/cacheAsTextureMixin.mjs';\nimport { childrenHelperMixin } from './container-mixins/childrenHelperMixin.mjs';\nimport { collectRenderablesMixin } from './container-mixins/collectRenderablesMixin.mjs';\nimport { effectsMixin } from './container-mixins/effectsMixin.mjs';\nimport { findMixin } from './container-mixins/findMixin.mjs';\nimport { getFastGlobalBoundsMixin } from './container-mixins/getFastGlobalBoundsMixin.mjs';\nimport { bgr2rgb, getGlobalMixin } from './container-mixins/getGlobalMixin.mjs';\nimport { measureMixin } from './container-mixins/measureMixin.mjs';\nimport { onRenderMixin } from './container-mixins/onRenderMixin.mjs';\nimport { sortMixin } from './container-mixins/sortMixin.mjs';\nimport { toLocalGlobalMixin } from './container-mixins/toLocalGlobalMixin.mjs';\nimport { RenderGroup } from './RenderGroup.mjs';\nimport { assignWithIgnore } from './utils/assignWithIgnore.mjs';\n\n\"use strict\";\nconst defaultSkew = new ObservablePoint(null);\nconst defaultPivot = new ObservablePoint(null);\nconst defaultScale = new ObservablePoint(null, 1, 1);\nconst defaultOrigin = new ObservablePoint(null);\nconst UPDATE_COLOR = 1;\nconst UPDATE_BLEND = 2;\nconst UPDATE_VISIBLE = 4;\nconst UPDATE_TRANSFORM = 8;\nclass Container extends EventEmitter {\n  constructor(options = {}) {\n    super();\n    /**\n     * unique id for this container\n     * @internal\n     */\n    this.uid = uid(\"renderable\");\n    /** @private */\n    this._updateFlags = 15;\n    // the render group this container owns\n    /** @private */\n    this.renderGroup = null;\n    // the render group this container belongs to\n    /** @private */\n    this.parentRenderGroup = null;\n    // the index of the container in the render group\n    /** @private */\n    this.parentRenderGroupIndex = 0;\n    // set to true if the container has changed. It is reset once the changes have been applied\n    // by the transform system\n    // its here to stop ensure that when things change, only one update gets registers with the transform system\n    /** @private */\n    this.didChange = false;\n    // same as above, but for the renderable\n    /** @private */\n    this.didViewUpdate = false;\n    // how deep is the container relative to its render group..\n    // unless the element is the root render group - it will be relative to its parent\n    /** @private */\n    this.relativeRenderGroupDepth = 0;\n    /**\n     * The array of children of this container. Each child must be a Container or extend from it.\n     *\n     * The array is read-only, but its contents can be modified using Container methods.\n     * @example\n     * ```ts\n     * // Access children\n     * const firstChild = container.children[0];\n     * const lastChild = container.children[container.children.length - 1];\n     * ```\n     * @readonly\n     * @see {@link Container#addChild} For adding children\n     * @see {@link Container#removeChild} For removing children\n     */\n    this.children = [];\n    /**\n     * The display object container that contains this display object.\n     * This represents the parent-child relationship in the display tree.\n     * @example\n     * ```ts\n     * // Basic parent access\n     * const parent = sprite.parent;\n     *\n     * // Walk up the tree\n     * let current = sprite;\n     * while (current.parent) {\n     *     console.log('Level up:', current.parent.constructor.name);\n     *     current = current.parent;\n     * }\n     * ```\n     * @readonly\n     * @see {@link Container#addChild} For adding to a parent\n     * @see {@link Container#removeChild} For removing from parent\n     */\n    this.parent = null;\n    // used internally for changing up the render order.. mainly for masks and filters\n    // TODO setting this should cause a rebuild??\n    /** @private */\n    this.includeInBuild = true;\n    /** @private */\n    this.measurable = true;\n    /** @private */\n    this.isSimple = true;\n    /**\n     * The RenderLayer this container belongs to, if any.\n     * If it belongs to a RenderLayer, it will be rendered from the RenderLayer's position in the scene.\n     * @readonly\n     * @advanced\n     */\n    this.parentRenderLayer = null;\n    // / /////////////Transform related props//////////////\n    // used by the transform system to check if a container needs to be updated that frame\n    // if the tick matches the current transform system tick, it is not updated again\n    /** @internal */\n    this.updateTick = -1;\n    /**\n     * Current transform of the object based on local factors: position, scale, other stuff.\n     * This matrix represents the local transformation without any parent influence.\n     * @example\n     * ```ts\n     * // Basic transform access\n     * const localMatrix = sprite.localTransform;\n     * console.log(localMatrix.toString());\n     * ```\n     * @readonly\n     * @see {@link Container#worldTransform} For global transform\n     * @see {@link Container#groupTransform} For render group transform\n     */\n    this.localTransform = new Matrix();\n    /**\n     * The relative group transform is a transform relative to the render group it belongs too. It will include all parent\n     * transforms and up to the render group (think of it as kind of like a stage - but the stage can be nested).\n     * If this container is is self a render group matrix will be relative to its parent render group\n     * @readonly\n     * @advanced\n     */\n    this.relativeGroupTransform = new Matrix();\n    /**\n     * The group transform is a transform relative to the render group it belongs too.\n     * If this container is render group then this will be an identity matrix. other wise it\n     * will be the same as the relativeGroupTransform.\n     * Use this value when actually rendering things to the screen\n     * @readonly\n     * @advanced\n     */\n    this.groupTransform = this.relativeGroupTransform;\n    /**\n     * Whether this object has been destroyed. If true, the object should no longer be used.\n     * After an object is destroyed, all of its functionality is disabled and references are removed.\n     * @example\n     * ```ts\n     * // Cleanup with destroy\n     * sprite.destroy();\n     * console.log(sprite.destroyed); // true\n     * ```\n     * @default false\n     * @see {@link Container#destroy} For destroying objects\n     */\n    this.destroyed = false;\n    // transform data..\n    /**\n     * The coordinate of the object relative to the local coordinates of the parent.\n     * @internal\n     */\n    this._position = new ObservablePoint(this, 0, 0);\n    /**\n     * The scale factor of the object.\n     * @internal\n     */\n    this._scale = defaultScale;\n    /**\n     * The pivot point of the container that it rotates around.\n     * @internal\n     */\n    this._pivot = defaultPivot;\n    /**\n     * The origin point around which the container rotates and scales.\n     * Unlike pivot, changing origin will not move the container's position.\n     * @private\n     */\n    this._origin = defaultOrigin;\n    /**\n     * The skew amount, on the x and y axis.\n     * @internal\n     */\n    this._skew = defaultSkew;\n    /**\n     * The X-coordinate value of the normalized local X axis,\n     * the first column of the local transformation matrix without a scale.\n     * @internal\n     */\n    this._cx = 1;\n    /**\n     * The Y-coordinate value of the normalized local X axis,\n     * the first column of the local transformation matrix without a scale.\n     * @internal\n     */\n    this._sx = 0;\n    /**\n     * The X-coordinate value of the normalized local Y axis,\n     * the second column of the local transformation matrix without a scale.\n     * @internal\n     */\n    this._cy = 0;\n    /**\n     * The Y-coordinate value of the normalized local Y axis,\n     * the second column of the local transformation matrix without a scale.\n     * @internal\n     */\n    this._sy = 1;\n    /**\n     * The rotation amount.\n     * @internal\n     */\n    this._rotation = 0;\n    // / COLOR related props //////////////\n    // color stored as ABGR\n    /** @internal */\n    this.localColor = 16777215;\n    /** @internal */\n    this.localAlpha = 1;\n    /** @internal */\n    this.groupAlpha = 1;\n    // A\n    /** @internal */\n    this.groupColor = 16777215;\n    // BGR\n    /** @internal */\n    this.groupColorAlpha = 4294967295;\n    // ABGR\n    // / BLEND related props //////////////\n    /** @internal */\n    this.localBlendMode = \"inherit\";\n    /** @internal */\n    this.groupBlendMode = \"normal\";\n    // / VISIBILITY related props //////////////\n    // visibility\n    // 0b11\n    // first bit is visible, second bit is renderable\n    /**\n     * This property holds three bits: culled, visible, renderable\n     * the third bit represents culling (0 = culled, 1 = not culled) 0b100\n     * the second bit represents visibility (0 = not visible, 1 = visible) 0b010\n     * the first bit represents renderable (0 = not renderable, 1 = renderable) 0b001\n     * @internal\n     */\n    this.localDisplayStatus = 7;\n    // 0b11 | 0b10 | 0b01 | 0b00\n    /** @internal */\n    this.globalDisplayStatus = 7;\n    /**\n     * A value that increments each time the containe is modified\n     * eg children added, removed etc\n     * @ignore\n     */\n    this._didContainerChangeTick = 0;\n    /**\n     * A value that increments each time the container view is modified\n     * eg texture swap, geometry change etc\n     * @ignore\n     */\n    this._didViewChangeTick = 0;\n    /**\n     * property that tracks if the container transform has changed\n     * @ignore\n     */\n    this._didLocalTransformChangeId = -1;\n    this.effects = [];\n    assignWithIgnore(this, options, {\n      children: true,\n      parent: true,\n      effects: true\n    });\n    options.children?.forEach((child) => this.addChild(child));\n    options.parent?.addChild(this);\n  }\n  /**\n   * Mixes all enumerable properties and methods from a source object to Container.\n   * @param source - The source of properties and methods to mix in.\n   * @deprecated since 8.8.0\n   */\n  static mixin(source) {\n    deprecation(\"8.8.0\", \"Container.mixin is deprecated, please use extensions.mixin instead.\");\n    extensions.mixin(Container, source);\n  }\n  // = 'default';\n  /**\n   * We now use the _didContainerChangeTick and _didViewChangeTick to track changes\n   * @deprecated since 8.2.6\n   * @ignore\n   */\n  set _didChangeId(value) {\n    this._didViewChangeTick = value >> 12 & 4095;\n    this._didContainerChangeTick = value & 4095;\n  }\n  /** @ignore */\n  get _didChangeId() {\n    return this._didContainerChangeTick & 4095 | (this._didViewChangeTick & 4095) << 12;\n  }\n  /**\n   * Adds one or more children to the container.\n   * The children will be rendered as part of this container's display list.\n   * @example\n   * ```ts\n   * // Add a single child\n   * container.addChild(sprite);\n   *\n   * // Add multiple children\n   * container.addChild(background, player, foreground);\n   *\n   * // Add with type checking\n   * const sprite = container.addChild<Sprite>(new Sprite(texture));\n   * sprite.tint = 'red';\n   * ```\n   * @param children - The Container(s) to add to the container\n   * @returns The first child that was added\n   * @see {@link Container#removeChild} For removing children\n   * @see {@link Container#addChildAt} For adding at specific index\n   */\n  addChild(...children) {\n    if (!this.allowChildren) {\n      deprecation(v8_0_0, \"addChild: Only Containers will be allowed to add children in v8.0.0\");\n    }\n    if (children.length > 1) {\n      for (let i = 0; i < children.length; i++) {\n        this.addChild(children[i]);\n      }\n      return children[0];\n    }\n    const child = children[0];\n    const renderGroup = this.renderGroup || this.parentRenderGroup;\n    if (child.parent === this) {\n      this.children.splice(this.children.indexOf(child), 1);\n      this.children.push(child);\n      if (renderGroup) {\n        renderGroup.structureDidChange = true;\n      }\n      return child;\n    }\n    if (child.parent) {\n      child.parent.removeChild(child);\n    }\n    this.children.push(child);\n    if (this.sortableChildren)\n      this.sortDirty = true;\n    child.parent = this;\n    child.didChange = true;\n    child._updateFlags = 15;\n    if (renderGroup) {\n      renderGroup.addChild(child);\n    }\n    this.emit(\"childAdded\", child, this, this.children.length - 1);\n    child.emit(\"added\", this);\n    this._didViewChangeTick++;\n    if (child._zIndex !== 0) {\n      child.depthOfChildModified();\n    }\n    return child;\n  }\n  /**\n   * Removes one or more children from the container.\n   * When removing multiple children, events will be triggered for each child in sequence.\n   * @example\n   * ```ts\n   * // Remove a single child\n   * const removed = container.removeChild(sprite);\n   *\n   * // Remove multiple children\n   * const bg = container.removeChild(background, player, userInterface);\n   *\n   * // Remove with type checking\n   * const sprite = container.removeChild<Sprite>(childSprite);\n   * sprite.texture = newTexture;\n   * ```\n   * @param children - The Container(s) to remove\n   * @returns The first child that was removed\n   * @see {@link Container#addChild} For adding children\n   * @see {@link Container#removeChildren} For removing multiple children\n   */\n  removeChild(...children) {\n    if (children.length > 1) {\n      for (let i = 0; i < children.length; i++) {\n        this.removeChild(children[i]);\n      }\n      return children[0];\n    }\n    const child = children[0];\n    const index = this.children.indexOf(child);\n    if (index > -1) {\n      this._didViewChangeTick++;\n      this.children.splice(index, 1);\n      if (this.renderGroup) {\n        this.renderGroup.removeChild(child);\n      } else if (this.parentRenderGroup) {\n        this.parentRenderGroup.removeChild(child);\n      }\n      if (child.parentRenderLayer) {\n        child.parentRenderLayer.detach(child);\n      }\n      child.parent = null;\n      this.emit(\"childRemoved\", child, this, index);\n      child.emit(\"removed\", this);\n    }\n    return child;\n  }\n  /** @ignore */\n  _onUpdate(point) {\n    if (point) {\n      if (point === this._skew) {\n        this._updateSkew();\n      }\n    }\n    this._didContainerChangeTick++;\n    if (this.didChange)\n      return;\n    this.didChange = true;\n    if (this.parentRenderGroup) {\n      this.parentRenderGroup.onChildUpdate(this);\n    }\n  }\n  set isRenderGroup(value) {\n    if (!!this.renderGroup === value)\n      return;\n    if (value) {\n      this.enableRenderGroup();\n    } else {\n      this.disableRenderGroup();\n    }\n  }\n  /**\n   * Returns true if this container is a render group.\n   * This means that it will be rendered as a separate pass, with its own set of instructions\n   * @advanced\n   */\n  get isRenderGroup() {\n    return !!this.renderGroup;\n  }\n  /**\n   * Calling this enables a render group for this container.\n   * This means it will be rendered as a separate set of instructions.\n   * The transform of the container will also be handled on the GPU rather than the CPU.\n   * @advanced\n   */\n  enableRenderGroup() {\n    if (this.renderGroup)\n      return;\n    const parentRenderGroup = this.parentRenderGroup;\n    parentRenderGroup?.removeChild(this);\n    this.renderGroup = BigPool.get(RenderGroup, this);\n    this.groupTransform = Matrix.IDENTITY;\n    parentRenderGroup?.addChild(this);\n    this._updateIsSimple();\n  }\n  /**\n   * This will disable the render group for this container.\n   * @advanced\n   */\n  disableRenderGroup() {\n    if (!this.renderGroup)\n      return;\n    const parentRenderGroup = this.parentRenderGroup;\n    parentRenderGroup?.removeChild(this);\n    BigPool.return(this.renderGroup);\n    this.renderGroup = null;\n    this.groupTransform = this.relativeGroupTransform;\n    parentRenderGroup?.addChild(this);\n    this._updateIsSimple();\n  }\n  /** @ignore */\n  _updateIsSimple() {\n    this.isSimple = !this.renderGroup && this.effects.length === 0;\n  }\n  /**\n   * Current transform of the object based on world (parent) factors.\n   *\n   * This matrix represents the absolute transformation in the scene graph.\n   * @example\n   * ```ts\n   * // Get world position\n   * const worldPos = container.worldTransform;\n   * console.log(`World position: (${worldPos.tx}, ${worldPos.ty})`);\n   * ```\n   * @readonly\n   * @see {@link Container#localTransform} For local space transform\n   */\n  get worldTransform() {\n    this._worldTransform || (this._worldTransform = new Matrix());\n    if (this.renderGroup) {\n      this._worldTransform.copyFrom(this.renderGroup.worldTransform);\n    } else if (this.parentRenderGroup) {\n      this._worldTransform.appendFrom(this.relativeGroupTransform, this.parentRenderGroup.worldTransform);\n    }\n    return this._worldTransform;\n  }\n  /**\n   * The position of the container on the x axis relative to the local coordinates of the parent.\n   *\n   * An alias to position.x\n   * @example\n   * ```ts\n   * // Basic position\n   * container.x = 100;\n   * ```\n   */\n  get x() {\n    return this._position.x;\n  }\n  set x(value) {\n    this._position.x = value;\n  }\n  /**\n   * The position of the container on the y axis relative to the local coordinates of the parent.\n   *\n   * An alias to position.y\n   * @example\n   * ```ts\n   * // Basic position\n   * container.y = 200;\n   * ```\n   */\n  get y() {\n    return this._position.y;\n  }\n  set y(value) {\n    this._position.y = value;\n  }\n  /**\n   * The coordinate of the object relative to the local coordinates of the parent.\n   * @example\n   * ```ts\n   * // Basic position setting\n   * container.position.set(100, 200);\n   * container.position.set(100); // Sets both x and y to 100\n   * // Using point data\n   * container.position = { x: 50, y: 75 };\n   * ```\n   * @since 4.0.0\n   */\n  get position() {\n    return this._position;\n  }\n  set position(value) {\n    this._position.copyFrom(value);\n  }\n  /**\n   * The rotation of the object in radians.\n   *\n   * > [!NOTE] 'rotation' and 'angle' have the same effect on a display object;\n   * > rotation is in radians, angle is in degrees.\n   * @example\n   * ```ts\n   * // Basic rotation\n   * container.rotation = Math.PI / 4; // 45 degrees\n   *\n   * // Convert from degrees\n   * const degrees = 45;\n   * container.rotation = degrees * Math.PI / 180;\n   *\n   * // Rotate around center\n   * container.pivot.set(container.width / 2, container.height / 2);\n   * container.rotation = Math.PI; // 180 degrees\n   *\n   * // Rotate around center with origin\n   * container.origin.set(container.width / 2, container.height / 2);\n   * container.rotation = Math.PI; // 180 degrees\n   * ```\n   */\n  get rotation() {\n    return this._rotation;\n  }\n  set rotation(value) {\n    if (this._rotation !== value) {\n      this._rotation = value;\n      this._onUpdate(this._skew);\n    }\n  }\n  /**\n   * The angle of the object in degrees.\n   *\n   * > [!NOTE] 'rotation' and 'angle' have the same effect on a display object;\n   * > rotation is in radians, angle is in degrees.\n   * @example\n   * ```ts\n   * // Basic angle rotation\n   * sprite.angle = 45; // 45 degrees\n   *\n   * // Rotate around center\n   * sprite.pivot.set(sprite.width / 2, sprite.height / 2);\n   * sprite.angle = 180; // Half rotation\n   *\n   * // Rotate around center with origin\n   * sprite.origin.set(sprite.width / 2, sprite.height / 2);\n   * sprite.angle = 180; // Half rotation\n   *\n   * // Reset rotation\n   * sprite.angle = 0;\n   * ```\n   */\n  get angle() {\n    return this.rotation * RAD_TO_DEG;\n  }\n  set angle(value) {\n    this.rotation = value * DEG_TO_RAD;\n  }\n  /**\n   * The center of rotation, scaling, and skewing for this display object in its local space.\n   * The `position` is the projection of `pivot` in the parent's local space.\n   *\n   * By default, the pivot is the origin (0, 0).\n   * @example\n   * ```ts\n   * // Rotate around center\n   * container.pivot.set(container.width / 2, container.height / 2);\n   * container.rotation = Math.PI; // Rotates around center\n   * ```\n   * @since 4.0.0\n   */\n  get pivot() {\n    if (this._pivot === defaultPivot) {\n      this._pivot = new ObservablePoint(this, 0, 0);\n    }\n    return this._pivot;\n  }\n  set pivot(value) {\n    if (this._pivot === defaultPivot) {\n      this._pivot = new ObservablePoint(this, 0, 0);\n      if (this._origin !== defaultOrigin) {\n        warn(`Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.`);\n      }\n    }\n    typeof value === \"number\" ? this._pivot.set(value) : this._pivot.copyFrom(value);\n  }\n  /**\n   * The skew factor for the object in radians. Skewing is a transformation that distorts\n   * the object by rotating it differently at each point, creating a non-uniform shape.\n   * @example\n   * ```ts\n   * // Basic skewing\n   * container.skew.set(0.5, 0); // Skew horizontally\n   * container.skew.set(0, 0.5); // Skew vertically\n   *\n   * // Skew with point data\n   * container.skew = { x: 0.3, y: 0.3 }; // Diagonal skew\n   *\n   * // Reset skew\n   * container.skew.set(0, 0);\n   *\n   * // Animate skew\n   * app.ticker.add(() => {\n   *     // Create wave effect\n   *     container.skew.x = Math.sin(Date.now() / 1000) * 0.3;\n   * });\n   *\n   * // Combine with rotation\n   * container.rotation = Math.PI / 4; // 45 degrees\n   * container.skew.set(0.2, 0.2); // Skew the rotated object\n   * ```\n   * @since 4.0.0\n   * @type {ObservablePoint} Point-like object with x/y properties in radians\n   * @default {x: 0, y: 0}\n   */\n  get skew() {\n    if (this._skew === defaultSkew) {\n      this._skew = new ObservablePoint(this, 0, 0);\n    }\n    return this._skew;\n  }\n  set skew(value) {\n    if (this._skew === defaultSkew) {\n      this._skew = new ObservablePoint(this, 0, 0);\n    }\n    this._skew.copyFrom(value);\n  }\n  /**\n   * The scale factors of this object along the local coordinate axes.\n   *\n   * The default scale is (1, 1).\n   * @example\n   * ```ts\n   * // Basic scaling\n   * container.scale.set(2, 2); // Scales to double size\n   * container.scale.set(2); // Scales uniformly to double size\n   * container.scale = 2; // Scales uniformly to double size\n   * // Scale to a specific width and height\n   * container.setSize(200, 100); // Sets width to 200 and height to 100\n   * ```\n   * @since 4.0.0\n   */\n  get scale() {\n    if (this._scale === defaultScale) {\n      this._scale = new ObservablePoint(this, 1, 1);\n    }\n    return this._scale;\n  }\n  set scale(value) {\n    if (this._scale === defaultScale) {\n      this._scale = new ObservablePoint(this, 0, 0);\n    }\n    if (typeof value === \"string\") {\n      value = parseFloat(value);\n    }\n    typeof value === \"number\" ? this._scale.set(value) : this._scale.copyFrom(value);\n  }\n  /**\n   * @experimental\n   * The origin point around which the container rotates and scales without affecting its position.\n   * Unlike pivot, changing the origin will not move the container's position.\n   * @example\n   * ```ts\n   * // Rotate around center point\n   * container.origin.set(container.width / 2, container.height / 2);\n   * container.rotation = Math.PI; // Rotates around center\n   *\n   * // Reset origin\n   * container.origin.set(0, 0);\n   * ```\n   */\n  get origin() {\n    if (this._origin === defaultOrigin) {\n      this._origin = new ObservablePoint(this, 0, 0);\n    }\n    return this._origin;\n  }\n  set origin(value) {\n    if (this._origin === defaultOrigin) {\n      this._origin = new ObservablePoint(this, 0, 0);\n      if (this._pivot !== defaultPivot) {\n        warn(`Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.`);\n      }\n    }\n    typeof value === \"number\" ? this._origin.set(value) : this._origin.copyFrom(value);\n  }\n  /**\n   * The width of the Container, setting this will actually modify the scale to achieve the value set.\n   * > [!NOTE] Changing the width will adjust the scale.x property of the container while maintaining its aspect ratio.\n   * > [!NOTE] If you want to set both width and height at the same time, use {@link Container#setSize}\n   * as it is more optimized by not recalculating the local bounds twice.\n   * @example\n   * ```ts\n   * // Basic width setting\n   * container.width = 100;\n   * // Optimized width setting\n   * container.setSize(100, 100);\n   * ```\n   */\n  get width() {\n    return Math.abs(this.scale.x * this.getLocalBounds().width);\n  }\n  set width(value) {\n    const localWidth = this.getLocalBounds().width;\n    this._setWidth(value, localWidth);\n  }\n  /**\n   * The height of the Container,\n   * > [!NOTE] Changing the height will adjust the scale.y property of the container while maintaining its aspect ratio.\n   * > [!NOTE] If you want to set both width and height at the same time, use {@link Container#setSize}\n   * as it is more optimized by not recalculating the local bounds twice.\n   * @example\n   * ```ts\n   * // Basic height setting\n   * container.height = 200;\n   * // Optimized height setting\n   * container.setSize(100, 200);\n   * ```\n   */\n  get height() {\n    return Math.abs(this.scale.y * this.getLocalBounds().height);\n  }\n  set height(value) {\n    const localHeight = this.getLocalBounds().height;\n    this._setHeight(value, localHeight);\n  }\n  /**\n   * Retrieves the size of the container as a [Size]{@link Size} object.\n   *\n   * This is faster than get the width and height separately.\n   * @example\n   * ```ts\n   * // Basic size retrieval\n   * const size = container.getSize();\n   * console.log(`Size: ${size.width}x${size.height}`);\n   *\n   * // Reuse existing size object\n   * const reuseSize = { width: 0, height: 0 };\n   * container.getSize(reuseSize);\n   * ```\n   * @param out - Optional object to store the size in.\n   * @returns The size of the container.\n   */\n  getSize(out) {\n    if (!out) {\n      out = {};\n    }\n    const bounds = this.getLocalBounds();\n    out.width = Math.abs(this.scale.x * bounds.width);\n    out.height = Math.abs(this.scale.y * bounds.height);\n    return out;\n  }\n  /**\n   * Sets the size of the container to the specified width and height.\n   * This is more efficient than setting width and height separately as it only recalculates bounds once.\n   * @example\n   * ```ts\n   * // Basic size setting\n   * container.setSize(100, 200);\n   *\n   * // Set uniform size\n   * container.setSize(100); // Sets both width and height to 100\n   * ```\n   * @param value - This can be either a number or a [Size]{@link Size} object.\n   * @param height - The height to set. Defaults to the value of `width` if not provided.\n   */\n  setSize(value, height) {\n    const size = this.getLocalBounds();\n    if (typeof value === \"object\") {\n      height = value.height ?? value.width;\n      value = value.width;\n    } else {\n      height ?? (height = value);\n    }\n    value !== void 0 && this._setWidth(value, size.width);\n    height !== void 0 && this._setHeight(height, size.height);\n  }\n  /** Called when the skew or the rotation changes. */\n  _updateSkew() {\n    const rotation = this._rotation;\n    const skew = this._skew;\n    this._cx = Math.cos(rotation + skew._y);\n    this._sx = Math.sin(rotation + skew._y);\n    this._cy = -Math.sin(rotation - skew._x);\n    this._sy = Math.cos(rotation - skew._x);\n  }\n  /**\n   * Updates the transform properties of the container.\n   * Allows partial updates of transform properties for optimized manipulation.\n   * @example\n   * ```ts\n   * // Basic transform update\n   * container.updateTransform({\n   *     x: 100,\n   *     y: 200,\n   *     rotation: Math.PI / 4\n   * });\n   *\n   * // Scale and rotate around center\n   * sprite.updateTransform({\n   *     pivotX: sprite.width / 2,\n   *     pivotY: sprite.height / 2,\n   *     scaleX: 2,\n   *     scaleY: 2,\n   *     rotation: Math.PI\n   * });\n   *\n   * // Update position only\n   * button.updateTransform({\n   *     x: button.x + 10, // Move right\n   *     y: button.y      // Keep same y\n   * });\n   * ```\n   * @param opts - Transform options to update\n   * @param opts.x - The x position\n   * @param opts.y - The y position\n   * @param opts.scaleX - The x-axis scale factor\n   * @param opts.scaleY - The y-axis scale factor\n   * @param opts.rotation - The rotation in radians\n   * @param opts.skewX - The x-axis skew factor\n   * @param opts.skewY - The y-axis skew factor\n   * @param opts.pivotX - The x-axis pivot point\n   * @param opts.pivotY - The y-axis pivot point\n   * @returns This container, for chaining\n   * @see {@link Container#setFromMatrix} For matrix-based transforms\n   * @see {@link Container#position} For direct position access\n   */\n  updateTransform(opts) {\n    this.position.set(\n      typeof opts.x === \"number\" ? opts.x : this.position.x,\n      typeof opts.y === \"number\" ? opts.y : this.position.y\n    );\n    this.scale.set(\n      typeof opts.scaleX === \"number\" ? opts.scaleX || 1 : this.scale.x,\n      typeof opts.scaleY === \"number\" ? opts.scaleY || 1 : this.scale.y\n    );\n    this.rotation = typeof opts.rotation === \"number\" ? opts.rotation : this.rotation;\n    this.skew.set(\n      typeof opts.skewX === \"number\" ? opts.skewX : this.skew.x,\n      typeof opts.skewY === \"number\" ? opts.skewY : this.skew.y\n    );\n    this.pivot.set(\n      typeof opts.pivotX === \"number\" ? opts.pivotX : this.pivot.x,\n      typeof opts.pivotY === \"number\" ? opts.pivotY : this.pivot.y\n    );\n    this.origin.set(\n      typeof opts.originX === \"number\" ? opts.originX : this.origin.x,\n      typeof opts.originY === \"number\" ? opts.originY : this.origin.y\n    );\n    return this;\n  }\n  /**\n   * Updates the local transform properties by decomposing the given matrix.\n   * Extracts position, scale, rotation, and skew from a transformation matrix.\n   * @example\n   * ```ts\n   * // Basic matrix transform\n   * const matrix = new Matrix()\n   *     .translate(100, 100)\n   *     .rotate(Math.PI / 4)\n   *     .scale(2, 2);\n   *\n   * container.setFromMatrix(matrix);\n   *\n   * // Copy transform from another container\n   * const source = new Container();\n   * source.position.set(100, 100);\n   * source.rotation = Math.PI / 2;\n   *\n   * target.setFromMatrix(source.localTransform);\n   *\n   * // Reset transform\n   * container.setFromMatrix(Matrix.IDENTITY);\n   * ```\n   * @param matrix - The matrix to use for updating the transform\n   * @see {@link Container#updateTransform} For property-based updates\n   * @see {@link Matrix#decompose} For matrix decomposition details\n   */\n  setFromMatrix(matrix) {\n    matrix.decompose(this);\n  }\n  /** Updates the local transform. */\n  updateLocalTransform() {\n    const localTransformChangeId = this._didContainerChangeTick;\n    if (this._didLocalTransformChangeId === localTransformChangeId)\n      return;\n    this._didLocalTransformChangeId = localTransformChangeId;\n    const lt = this.localTransform;\n    const scale = this._scale;\n    const pivot = this._pivot;\n    const origin = this._origin;\n    const position = this._position;\n    const sx = scale._x;\n    const sy = scale._y;\n    const px = pivot._x;\n    const py = pivot._y;\n    const ox = -origin._x;\n    const oy = -origin._y;\n    lt.a = this._cx * sx;\n    lt.b = this._sx * sx;\n    lt.c = this._cy * sy;\n    lt.d = this._sy * sy;\n    lt.tx = position._x - (px * lt.a + py * lt.c) + (ox * lt.a + oy * lt.c) - ox;\n    lt.ty = position._y - (px * lt.b + py * lt.d) + (ox * lt.b + oy * lt.d) - oy;\n  }\n  // / ///// color related stuff\n  set alpha(value) {\n    if (value === this.localAlpha)\n      return;\n    this.localAlpha = value;\n    this._updateFlags |= UPDATE_COLOR;\n    this._onUpdate();\n  }\n  /**\n   * The opacity of the object relative to its parent's opacity.\n   * Value ranges from 0 (fully transparent) to 1 (fully opaque).\n   * @example\n   * ```ts\n   * // Basic transparency\n   * sprite.alpha = 0.5; // 50% opacity\n   *\n   * // Inherited opacity\n   * container.alpha = 0.5;\n   * const child = new Sprite(texture);\n   * child.alpha = 0.5;\n   * container.addChild(child);\n   * // child's effective opacity is 0.25 (0.5 * 0.5)\n   * ```\n   * @default 1\n   * @see {@link Container#visible} For toggling visibility\n   * @see {@link Container#renderable} For render control\n   */\n  get alpha() {\n    return this.localAlpha;\n  }\n  set tint(value) {\n    const tempColor = Color.shared.setValue(value ?? 16777215);\n    const bgr = tempColor.toBgrNumber();\n    if (bgr === this.localColor)\n      return;\n    this.localColor = bgr;\n    this._updateFlags |= UPDATE_COLOR;\n    this._onUpdate();\n  }\n  /**\n   * The tint applied to the sprite.\n   *\n   * This can be any valid {@link ColorSource}.\n   * @example\n   * ```ts\n   * // Basic color tinting\n   * container.tint = 0xff0000; // Red tint\n   * container.tint = 'red';    // Same as above\n   * container.tint = '#00ff00'; // Green\n   * container.tint = 'rgb(0,0,255)'; // Blue\n   *\n   * // Remove tint\n   * container.tint = 0xffffff; // White = no tint\n   * container.tint = null;     // Also removes tint\n   * ```\n   * @default 0xFFFFFF\n   * @see {@link Container#alpha} For transparency\n   * @see {@link Container#visible} For visibility control\n   */\n  get tint() {\n    return bgr2rgb(this.localColor);\n  }\n  // / //////////////// blend related stuff\n  set blendMode(value) {\n    if (this.localBlendMode === value)\n      return;\n    if (this.parentRenderGroup) {\n      this.parentRenderGroup.structureDidChange = true;\n    }\n    this._updateFlags |= UPDATE_BLEND;\n    this.localBlendMode = value;\n    this._onUpdate();\n  }\n  /**\n   * The blend mode to be applied to the sprite. Controls how pixels are blended when rendering.\n   *\n   * Setting to 'normal' will reset to default blending.\n   * > [!NOTE] More blend modes are available after importing the `pixi.js/advanced-blend-modes` sub-export.\n   * @example\n   * ```ts\n   * // Basic blend modes\n   * sprite.blendMode = 'add';        // Additive blending\n   * sprite.blendMode = 'multiply';   // Multiply colors\n   * sprite.blendMode = 'screen';     // Screen blend\n   *\n   * // Reset blend mode\n   * sprite.blendMode = 'normal';     // Normal blending\n   * ```\n   * @default 'normal'\n   * @see {@link Container#alpha} For transparency\n   * @see {@link Container#tint} For color adjustments\n   */\n  get blendMode() {\n    return this.localBlendMode;\n  }\n  // / ///////// VISIBILITY / RENDERABLE /////////////////\n  /**\n   * The visibility of the object. If false the object will not be drawn,\n   * and the transform will not be updated.\n   * @example\n   * ```ts\n   * // Basic visibility toggle\n   * sprite.visible = false; // Hide sprite\n   * sprite.visible = true;  // Show sprite\n   * ```\n   * @default true\n   * @see {@link Container#renderable} For render-only control\n   * @see {@link Container#alpha} For transparency\n   */\n  get visible() {\n    return !!(this.localDisplayStatus & 2);\n  }\n  set visible(value) {\n    const valueNumber = value ? 2 : 0;\n    if ((this.localDisplayStatus & 2) === valueNumber)\n      return;\n    if (this.parentRenderGroup) {\n      this.parentRenderGroup.structureDidChange = true;\n    }\n    this._updateFlags |= UPDATE_VISIBLE;\n    this.localDisplayStatus ^= 2;\n    this._onUpdate();\n  }\n  /** @ignore */\n  get culled() {\n    return !(this.localDisplayStatus & 4);\n  }\n  /** @ignore */\n  set culled(value) {\n    const valueNumber = value ? 0 : 4;\n    if ((this.localDisplayStatus & 4) === valueNumber)\n      return;\n    if (this.parentRenderGroup) {\n      this.parentRenderGroup.structureDidChange = true;\n    }\n    this._updateFlags |= UPDATE_VISIBLE;\n    this.localDisplayStatus ^= 4;\n    this._onUpdate();\n  }\n  /**\n   * Controls whether this object can be rendered. If false the object will not be drawn,\n   * but the transform will still be updated. This is different from visible, which skips\n   * transform updates.\n   * @example\n   * ```ts\n   * // Basic render control\n   * sprite.renderable = false; // Skip rendering\n   * sprite.renderable = true;  // Enable rendering\n   * ```\n   * @default true\n   * @see {@link Container#visible} For skipping transform updates\n   * @see {@link Container#alpha} For transparency\n   */\n  get renderable() {\n    return !!(this.localDisplayStatus & 1);\n  }\n  set renderable(value) {\n    const valueNumber = value ? 1 : 0;\n    if ((this.localDisplayStatus & 1) === valueNumber)\n      return;\n    this._updateFlags |= UPDATE_VISIBLE;\n    this.localDisplayStatus ^= 1;\n    if (this.parentRenderGroup) {\n      this.parentRenderGroup.structureDidChange = true;\n    }\n    this._onUpdate();\n  }\n  /**\n   * Whether or not the object should be rendered.\n   * @advanced\n   */\n  get isRenderable() {\n    return this.localDisplayStatus === 7 && this.groupAlpha > 0;\n  }\n  /**\n   * Removes all internal references and listeners as well as removes children from the display list.\n   * Do not use a Container after calling `destroy`.\n   * @param options - Options parameter. A boolean will act as if all options\n   *  have been set to that value\n   * @example\n   * ```ts\n   * container.destroy();\n   * container.destroy(true);\n   * container.destroy({ children: true });\n   * container.destroy({ children: true, texture: true, textureSource: true });\n   * ```\n   */\n  destroy(options = false) {\n    if (this.destroyed)\n      return;\n    this.destroyed = true;\n    let oldChildren;\n    if (this.children.length) {\n      oldChildren = this.removeChildren(0, this.children.length);\n    }\n    this.removeFromParent();\n    this.parent = null;\n    this._maskEffect = null;\n    this._filterEffect = null;\n    this.effects = null;\n    this._position = null;\n    this._scale = null;\n    this._pivot = null;\n    this._origin = null;\n    this._skew = null;\n    this.emit(\"destroyed\", this);\n    this.removeAllListeners();\n    const destroyChildren = typeof options === \"boolean\" ? options : options?.children;\n    if (destroyChildren && oldChildren) {\n      for (let i = 0; i < oldChildren.length; ++i) {\n        oldChildren[i].destroy(options);\n      }\n    }\n    this.renderGroup?.destroy();\n    this.renderGroup = null;\n  }\n}\nextensions.mixin(\n  Container,\n  childrenHelperMixin,\n  getFastGlobalBoundsMixin,\n  toLocalGlobalMixin,\n  onRenderMixin,\n  measureMixin,\n  effectsMixin,\n  findMixin,\n  sortMixin,\n  cullingMixin,\n  cacheAsTextureMixin,\n  getGlobalMixin,\n  collectRenderablesMixin\n);\n\nexport { Container, UPDATE_BLEND, UPDATE_COLOR, UPDATE_TRANSFORM, UPDATE_VISIBLE };\n//# sourceMappingURL=Container.mjs.map\n","import { Bounds } from '../container/bounds/Bounds.mjs';\nimport { Container } from '../container/Container.mjs';\n\n\"use strict\";\nclass ViewContainer extends Container {\n  // eslint-disable-next-line @typescript-eslint/no-useless-constructor\n  constructor(options) {\n    super(options);\n    /** @internal */\n    this.canBundle = true;\n    /** @internal */\n    this.allowChildren = false;\n    /** @internal */\n    this._roundPixels = 0;\n    /** @internal */\n    this._lastUsed = -1;\n    /** @internal */\n    this._gpuData = /* @__PURE__ */ Object.create(null);\n    this._bounds = new Bounds(0, 1, 0, 0);\n    this._boundsDirty = true;\n  }\n  /**\n   * The local bounds of the view in its own coordinate space.\n   * Bounds are automatically updated when the view's content changes.\n   * @example\n   * ```ts\n   * // Get bounds dimensions\n   * const bounds = view.bounds;\n   * console.log(`Width: ${bounds.maxX - bounds.minX}`);\n   * console.log(`Height: ${bounds.maxY - bounds.minY}`);\n   * ```\n   * @returns The rectangular bounds of the view\n   * @see {@link Bounds} For bounds operations\n   */\n  get bounds() {\n    if (!this._boundsDirty)\n      return this._bounds;\n    this.updateBounds();\n    this._boundsDirty = false;\n    return this._bounds;\n  }\n  /**\n   * Whether or not to round the x/y position of the sprite.\n   * @example\n   * ```ts\n   * // Enable pixel rounding for crisp rendering\n   * view.roundPixels = true;\n   * ```\n   * @default false\n   */\n  get roundPixels() {\n    return !!this._roundPixels;\n  }\n  set roundPixels(value) {\n    this._roundPixels = value ? 1 : 0;\n  }\n  /**\n   * Checks if the object contains the given point in local coordinates.\n   * Uses the view's bounds for hit testing.\n   * @example\n   * ```ts\n   * // Basic point check\n   * const localPoint = { x: 50, y: 25 };\n   * const contains = view.containsPoint(localPoint);\n   * console.log('Point is inside:', contains);\n   * ```\n   * @param point - The point to check in local coordinates\n   * @returns True if the point is within the view's bounds\n   * @see {@link ViewContainer#bounds} For the bounds used in hit testing\n   * @see {@link Container#toLocal} For converting global coordinates to local\n   */\n  containsPoint(point) {\n    const bounds = this.bounds;\n    const { x, y } = point;\n    return x >= bounds.minX && x <= bounds.maxX && y >= bounds.minY && y <= bounds.maxY;\n  }\n  /** @private */\n  onViewUpdate() {\n    this._didViewChangeTick++;\n    this._boundsDirty = true;\n    if (this.didViewUpdate)\n      return;\n    this.didViewUpdate = true;\n    const renderGroup = this.renderGroup || this.parentRenderGroup;\n    if (renderGroup) {\n      renderGroup.onChildViewUpdate(this);\n    }\n  }\n  destroy(options) {\n    super.destroy(options);\n    this._bounds = null;\n    for (const key in this._gpuData) {\n      this._gpuData[key].destroy?.();\n    }\n    this._gpuData = null;\n  }\n  /**\n   * Collects renderables for the view container.\n   * @param instructionSet - The instruction set to collect renderables for.\n   * @param renderer - The renderer to collect renderables for.\n   * @param currentLayer - The current render layer.\n   * @internal\n   */\n  collectRenderablesSimple(instructionSet, renderer, currentLayer) {\n    const { renderPipes } = renderer;\n    renderPipes.blendMode.pushBlendMode(this, this.groupBlendMode, instructionSet);\n    const rp = renderPipes;\n    rp[this.renderPipeId].addRenderable(this, instructionSet);\n    this.didViewUpdate = false;\n    const children = this.children;\n    const length = children.length;\n    for (let i = 0; i < length; i++) {\n      children[i].collectRenderables(instructionSet, renderer, currentLayer);\n    }\n    renderPipes.blendMode.popBlendMode(instructionSet);\n  }\n}\n\nexport { ViewContainer };\n//# sourceMappingURL=ViewContainer.mjs.map\n","import { ObservablePoint } from '../../maths/point/ObservablePoint.mjs';\nimport { Texture } from '../../rendering/renderers/shared/texture/Texture.mjs';\nimport { updateQuadBounds } from '../../utils/data/updateQuadBounds.mjs';\nimport { deprecation } from '../../utils/logging/deprecation.mjs';\nimport { ViewContainer } from '../view/ViewContainer.mjs';\n\n\"use strict\";\nclass Sprite extends ViewContainer {\n  /**\n   * @param options - The options for creating the sprite.\n   */\n  constructor(options = Texture.EMPTY) {\n    if (options instanceof Texture) {\n      options = { texture: options };\n    }\n    const { texture = Texture.EMPTY, anchor, roundPixels, width, height, ...rest } = options;\n    super({\n      label: \"Sprite\",\n      ...rest\n    });\n    /** @internal */\n    this.renderPipeId = \"sprite\";\n    /** @internal */\n    this.batched = true;\n    this._visualBounds = { minX: 0, maxX: 1, minY: 0, maxY: 0 };\n    this._anchor = new ObservablePoint(\n      {\n        _onUpdate: () => {\n          this.onViewUpdate();\n        }\n      }\n    );\n    if (anchor) {\n      this.anchor = anchor;\n    } else if (texture.defaultAnchor) {\n      this.anchor = texture.defaultAnchor;\n    }\n    this.texture = texture;\n    this.allowChildren = false;\n    this.roundPixels = roundPixels ?? false;\n    if (width !== void 0)\n      this.width = width;\n    if (height !== void 0)\n      this.height = height;\n  }\n  /**\n   * Creates a new sprite based on a source texture, image, video, or canvas element.\n   * This is a convenience method that automatically creates and manages textures.\n   * @example\n   * ```ts\n   * // Create from path or URL\n   * const sprite = Sprite.from('assets/image.png');\n   *\n   * // Create from existing texture\n   * const sprite = Sprite.from(texture);\n   *\n   * // Create from canvas\n   * const canvas = document.createElement('canvas');\n   * const sprite = Sprite.from(canvas, true); // Skip caching new texture\n   * ```\n   * @param source - The source to create the sprite from. Can be a path to an image, a texture,\n   * or any valid texture source (canvas, video, etc.)\n   * @param skipCache - Whether to skip adding to the texture cache when creating a new texture\n   * @returns A new sprite based on the source\n   * @see {@link Texture.from} For texture creation details\n   * @see {@link Assets} For asset loading and management\n   */\n  static from(source, skipCache = false) {\n    if (source instanceof Texture) {\n      return new Sprite(source);\n    }\n    return new Sprite(Texture.from(source, skipCache));\n  }\n  set texture(value) {\n    value || (value = Texture.EMPTY);\n    const currentTexture = this._texture;\n    if (currentTexture === value)\n      return;\n    if (currentTexture && currentTexture.dynamic)\n      currentTexture.off(\"update\", this.onViewUpdate, this);\n    if (value.dynamic)\n      value.on(\"update\", this.onViewUpdate, this);\n    this._texture = value;\n    if (this._width) {\n      this._setWidth(this._width, this._texture.orig.width);\n    }\n    if (this._height) {\n      this._setHeight(this._height, this._texture.orig.height);\n    }\n    this.onViewUpdate();\n  }\n  /**\n   * The texture that is displayed by the sprite. When changed, automatically updates\n   * the sprite dimensions and manages texture event listeners.\n   * @example\n   * ```ts\n   * // Create sprite with texture\n   * const sprite = new Sprite({\n   *     texture: Texture.from('sprite.png')\n   * });\n   *\n   * // Update texture\n   * sprite.texture = Texture.from('newSprite.png');\n   *\n   * // Use texture from spritesheet\n   * const sheet = await Assets.load('spritesheet.json');\n   * sprite.texture = sheet.textures['frame1.png'];\n   *\n   * // Reset to empty texture\n   * sprite.texture = Texture.EMPTY;\n   * ```\n   * @see {@link Texture} For texture creation and management\n   * @see {@link Assets} For asset loading\n   */\n  get texture() {\n    return this._texture;\n  }\n  /**\n   * The bounds of the sprite, taking into account the texture's trim area.\n   * @example\n   * ```ts\n   * const texture = new Texture({\n   *     source: new TextureSource({ width: 300, height: 300 }),\n   *     frame: new Rectangle(196, 66, 58, 56),\n   *     trim: new Rectangle(4, 4, 58, 56),\n   *     orig: new Rectangle(0, 0, 64, 64),\n   *     rotate: 2,\n   * });\n   * const sprite = new Sprite(texture);\n   * const visualBounds = sprite.visualBounds;\n   * // console.log(visualBounds); // { minX: -4, maxX: 62, minY: -4, maxY: 60 }\n   */\n  get visualBounds() {\n    updateQuadBounds(this._visualBounds, this._anchor, this._texture);\n    return this._visualBounds;\n  }\n  /**\n   * @deprecated\n   * @ignore\n   */\n  get sourceBounds() {\n    deprecation(\"8.6.1\", \"Sprite.sourceBounds is deprecated, use visualBounds instead.\");\n    return this.visualBounds;\n  }\n  /** @private */\n  updateBounds() {\n    const anchor = this._anchor;\n    const texture = this._texture;\n    const bounds = this._bounds;\n    const { width, height } = texture.orig;\n    bounds.minX = -anchor._x * width;\n    bounds.maxX = bounds.minX + width;\n    bounds.minY = -anchor._y * height;\n    bounds.maxY = bounds.minY + height;\n  }\n  /**\n   * Destroys this sprite renderable and optionally its texture.\n   * @param options - Options parameter. A boolean will act as if all options\n   *  have been set to that value\n   * @example\n   * sprite.destroy();\n   * sprite.destroy(true);\n   * sprite.destroy({ texture: true, textureSource: true });\n   */\n  destroy(options = false) {\n    super.destroy(options);\n    const destroyTexture = typeof options === \"boolean\" ? options : options?.texture;\n    if (destroyTexture) {\n      const destroyTextureSource = typeof options === \"boolean\" ? options : options?.textureSource;\n      this._texture.destroy(destroyTextureSource);\n    }\n    this._texture = null;\n    this._visualBounds = null;\n    this._bounds = null;\n    this._anchor = null;\n    this._gpuData = null;\n  }\n  /**\n   * The anchor sets the origin point of the sprite. The default value is taken from the {@link Texture}\n   * and passed to the constructor.\n   *\n   * - The default is `(0,0)`, this means the sprite's origin is the top left.\n   * - Setting the anchor to `(0.5,0.5)` means the sprite's origin is centered.\n   * - Setting the anchor to `(1,1)` would mean the sprite's origin point will be the bottom right corner.\n   *\n   * If you pass only single parameter, it will set both x and y to the same value as shown in the example below.\n   * @example\n   * ```ts\n   * // Center the anchor point\n   * sprite.anchor = 0.5; // Sets both x and y to 0.5\n   * sprite.position.set(400, 300); // Sprite will be centered at this position\n   *\n   * // Set specific x/y anchor points\n   * sprite.anchor = {\n   *     x: 1, // Right edge\n   *     y: 0  // Top edge\n   * };\n   *\n   * // Using individual coordinates\n   * sprite.anchor.set(0.5, 1); // Center-bottom\n   *\n   * // For rotation around center\n   * sprite.anchor.set(0.5);\n   * sprite.rotation = Math.PI / 4; // 45 degrees around center\n   *\n   * // For scaling from center\n   * sprite.anchor.set(0.5);\n   * sprite.scale.set(2); // Scales from center point\n   * ```\n   */\n  get anchor() {\n    return this._anchor;\n  }\n  set anchor(value) {\n    typeof value === \"number\" ? this._anchor.set(value) : this._anchor.copyFrom(value);\n  }\n  /**\n   * The width of the sprite, setting this will actually modify the scale to achieve the value set.\n   * @example\n   * ```ts\n   * // Set width directly\n   * sprite.width = 200;\n   * console.log(sprite.scale.x); // Scale adjusted to match width\n   *\n   * // Set width while preserving aspect ratio\n   * const ratio = sprite.height / sprite.width;\n   * sprite.width = 300;\n   * sprite.height = 300 * ratio;\n   *\n   * // For better performance when setting both width and height\n   * sprite.setSize(300, 400); // Avoids recalculating bounds twice\n   *\n   * // Reset to original texture size\n   * sprite.width = sprite.texture.orig.width;\n   * ```\n   */\n  get width() {\n    return Math.abs(this.scale.x) * this._texture.orig.width;\n  }\n  set width(value) {\n    this._setWidth(value, this._texture.orig.width);\n    this._width = value;\n  }\n  /**\n   * The height of the sprite, setting this will actually modify the scale to achieve the value set.\n   * @example\n   * ```ts\n   * // Set height directly\n   * sprite.height = 150;\n   * console.log(sprite.scale.y); // Scale adjusted to match height\n   *\n   * // Set height while preserving aspect ratio\n   * const ratio = sprite.width / sprite.height;\n   * sprite.height = 200;\n   * sprite.width = 200 * ratio;\n   *\n   * // For better performance when setting both width and height\n   * sprite.setSize(300, 400); // Avoids recalculating bounds twice\n   *\n   * // Reset to original texture size\n   * sprite.height = sprite.texture.orig.height;\n   * ```\n   */\n  get height() {\n    return Math.abs(this.scale.y) * this._texture.orig.height;\n  }\n  set height(value) {\n    this._setHeight(value, this._texture.orig.height);\n    this._height = value;\n  }\n  /**\n   * Retrieves the size of the Sprite as a [Size]{@link Size} object based on the texture dimensions and scale.\n   * This is faster than getting width and height separately as it only calculates the bounds once.\n   * @example\n   * ```ts\n   * // Basic size retrieval\n   * const sprite = new Sprite(Texture.from('sprite.png'));\n   * const size = sprite.getSize();\n   * console.log(`Size: ${size.width}x${size.height}`);\n   *\n   * // Reuse existing size object\n   * const reuseSize = { width: 0, height: 0 };\n   * sprite.getSize(reuseSize);\n   * ```\n   * @param out - Optional object to store the size in, to avoid allocating a new object\n   * @returns The size of the Sprite\n   * @see {@link Sprite#width} For getting just the width\n   * @see {@link Sprite#height} For getting just the height\n   * @see {@link Sprite#setSize} For setting both width and height\n   */\n  getSize(out) {\n    out || (out = {});\n    out.width = Math.abs(this.scale.x) * this._texture.orig.width;\n    out.height = Math.abs(this.scale.y) * this._texture.orig.height;\n    return out;\n  }\n  /**\n   * Sets the size of the Sprite to the specified width and height.\n   * This is faster than setting width and height separately as it only recalculates bounds once.\n   * @example\n   * ```ts\n   * // Basic size setting\n   * const sprite = new Sprite(Texture.from('sprite.png'));\n   * sprite.setSize(100, 200); // Width: 100, Height: 200\n   *\n   * // Set uniform size\n   * sprite.setSize(100); // Sets both width and height to 100\n   *\n   * // Set size with object\n   * sprite.setSize({\n   *     width: 200,\n   *     height: 300\n   * });\n   *\n   * // Reset to texture size\n   * sprite.setSize(\n   *     sprite.texture.orig.width,\n   *     sprite.texture.orig.height\n   * );\n   * ```\n   * @param value - This can be either a number or a {@link Size} object\n   * @param height - The height to set. Defaults to the value of `width` if not provided\n   * @see {@link Sprite#width} For setting width only\n   * @see {@link Sprite#height} For setting height only\n   * @see {@link Sprite#texture} For the source dimensions\n   */\n  setSize(value, height) {\n    if (typeof value === \"object\") {\n      height = value.height ?? value.width;\n      value = value.width;\n    } else {\n      height ?? (height = value);\n    }\n    value !== void 0 && this._setWidth(value, this._texture.orig.width);\n    height !== void 0 && this._setHeight(height, this._texture.orig.height);\n  }\n}\n\nexport { Sprite };\n//# sourceMappingURL=Sprite.mjs.map\n","import { Bounds } from '../../../scene/container/bounds/Bounds.mjs';\nimport { getGlobalBounds } from '../../../scene/container/bounds/getGlobalBounds.mjs';\n\n\"use strict\";\nconst tempBounds = new Bounds();\nfunction addMaskBounds(mask, bounds, skipUpdateTransform) {\n  const boundsToMask = tempBounds;\n  mask.measurable = true;\n  getGlobalBounds(mask, skipUpdateTransform, boundsToMask);\n  bounds.addBoundsMask(boundsToMask);\n  mask.measurable = false;\n}\n\nexport { addMaskBounds };\n//# sourceMappingURL=addMaskBounds.mjs.map\n","import { getLocalBounds } from '../../../scene/container/bounds/getLocalBounds.mjs';\nimport { boundsPool, matrixPool } from '../../../scene/container/bounds/utils/matrixAndBoundsPool.mjs';\nimport { warn } from '../../../utils/logging/warn.mjs';\n\n\"use strict\";\nfunction addMaskLocalBounds(mask, bounds, localRoot) {\n  const boundsToMask = boundsPool.get();\n  mask.measurable = true;\n  const tempMatrix = matrixPool.get().identity();\n  const relativeMask = getMatrixRelativeToParent(mask, localRoot, tempMatrix);\n  getLocalBounds(mask, boundsToMask, relativeMask);\n  mask.measurable = false;\n  bounds.addBoundsMask(boundsToMask);\n  matrixPool.return(tempMatrix);\n  boundsPool.return(boundsToMask);\n}\nfunction getMatrixRelativeToParent(target, root, matrix) {\n  if (!target) {\n    warn(\"Mask bounds, renderable is not inside the root container\");\n    return matrix;\n  }\n  if (target !== root) {\n    getMatrixRelativeToParent(target.parent, root, matrix);\n    target.updateLocalTransform();\n    matrix.append(target.localTransform);\n  }\n  return matrix;\n}\n\nexport { addMaskLocalBounds };\n//# sourceMappingURL=addMaskLocalBounds.mjs.map\n","import { ExtensionType } from '../../../extensions/Extensions.mjs';\nimport { Sprite } from '../../../scene/sprite/Sprite.mjs';\nimport { addMaskBounds } from '../utils/addMaskBounds.mjs';\nimport { addMaskLocalBounds } from '../utils/addMaskLocalBounds.mjs';\n\n\"use strict\";\nclass AlphaMask {\n  constructor(options) {\n    this.priority = 0;\n    this.inverse = false;\n    this.pipe = \"alphaMask\";\n    if (options?.mask) {\n      this.init(options.mask);\n    }\n  }\n  init(mask) {\n    this.mask = mask;\n    this.renderMaskToTexture = !(mask instanceof Sprite);\n    this.mask.renderable = this.renderMaskToTexture;\n    this.mask.includeInBuild = !this.renderMaskToTexture;\n    this.mask.measurable = false;\n  }\n  reset() {\n    this.mask.measurable = true;\n    this.mask = null;\n  }\n  addBounds(bounds, skipUpdateTransform) {\n    if (!this.inverse) {\n      addMaskBounds(this.mask, bounds, skipUpdateTransform);\n    }\n  }\n  addLocalBounds(bounds, localRoot) {\n    addMaskLocalBounds(this.mask, bounds, localRoot);\n  }\n  containsPoint(point, hitTestFn) {\n    const mask = this.mask;\n    return hitTestFn(mask, point);\n  }\n  destroy() {\n    this.reset();\n  }\n  static test(mask) {\n    return mask instanceof Sprite;\n  }\n}\nAlphaMask.extension = ExtensionType.MaskEffect;\n\nexport { AlphaMask };\n//# sourceMappingURL=AlphaMask.mjs.map\n","import { ExtensionType } from '../../../extensions/Extensions.mjs';\n\n\"use strict\";\nclass ColorMask {\n  constructor(options) {\n    this.priority = 0;\n    this.pipe = \"colorMask\";\n    if (options?.mask) {\n      this.init(options.mask);\n    }\n  }\n  init(mask) {\n    this.mask = mask;\n  }\n  destroy() {\n  }\n  static test(mask) {\n    return typeof mask === \"number\";\n  }\n}\nColorMask.extension = ExtensionType.MaskEffect;\n\nexport { ColorMask };\n//# sourceMappingURL=ColorMask.mjs.map\n","import { ExtensionType } from '../../../extensions/Extensions.mjs';\nimport { Container } from '../../../scene/container/Container.mjs';\nimport { addMaskBounds } from '../utils/addMaskBounds.mjs';\nimport { addMaskLocalBounds } from '../utils/addMaskLocalBounds.mjs';\n\n\"use strict\";\nclass StencilMask {\n  constructor(options) {\n    this.priority = 0;\n    this.pipe = \"stencilMask\";\n    if (options?.mask) {\n      this.init(options.mask);\n    }\n  }\n  init(mask) {\n    this.mask = mask;\n    this.mask.includeInBuild = false;\n    this.mask.measurable = false;\n  }\n  reset() {\n    this.mask.measurable = true;\n    this.mask.includeInBuild = true;\n    this.mask = null;\n  }\n  addBounds(bounds, skipUpdateTransform) {\n    addMaskBounds(this.mask, bounds, skipUpdateTransform);\n  }\n  addLocalBounds(bounds, localRoot) {\n    addMaskLocalBounds(this.mask, bounds, localRoot);\n  }\n  containsPoint(point, hitTestFn) {\n    const mask = this.mask;\n    return hitTestFn(mask, point);\n  }\n  destroy() {\n    this.reset();\n  }\n  static test(mask) {\n    return mask instanceof Container;\n  }\n}\nStencilMask.extension = ExtensionType.MaskEffect;\n\nexport { StencilMask };\n//# sourceMappingURL=StencilMask.mjs.map\n","\"use strict\";\nconst BrowserAdapter = {\n  createCanvas: (width, height) => {\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = width;\n    canvas.height = height;\n    return canvas;\n  },\n  createImage: () => new Image(),\n  getCanvasRenderingContext2D: () => CanvasRenderingContext2D,\n  getWebGLRenderingContext: () => WebGLRenderingContext,\n  getNavigator: () => navigator,\n  getBaseUrl: () => document.baseURI ?? window.location.href,\n  getFontFaceSet: () => document.fonts,\n  fetch: (url, options) => fetch(url, options),\n  parseXML: (xml) => {\n    const parser = new DOMParser();\n    return parser.parseFromString(xml, \"text/xml\");\n  }\n};\n\nexport { BrowserAdapter };\n//# sourceMappingURL=BrowserAdapter.mjs.map\n","import { BrowserAdapter } from '../environment-browser/BrowserAdapter.mjs';\n\n\"use strict\";\nlet currentAdapter = BrowserAdapter;\nconst DOMAdapter = {\n  /**\n   * Returns the current adapter.\n   * @returns {environment.Adapter} The current adapter.\n   */\n  get() {\n    return currentAdapter;\n  },\n  /**\n   * Sets the current adapter.\n   * @param adapter - The new adapter.\n   */\n  set(adapter) {\n    currentAdapter = adapter;\n  }\n};\n\nexport { DOMAdapter };\n//# sourceMappingURL=adapter.mjs.map\n","import { DOMAdapter } from '../../../../../environment/adapter.mjs';\nimport { ExtensionType } from '../../../../../extensions/Extensions.mjs';\nimport { TextureSource } from './TextureSource.mjs';\n\n\"use strict\";\nclass CanvasSource extends TextureSource {\n  constructor(options) {\n    if (!options.resource) {\n      options.resource = DOMAdapter.get().createCanvas();\n    }\n    if (!options.width) {\n      options.width = options.resource.width;\n      if (!options.autoDensity) {\n        options.width /= options.resolution;\n      }\n    }\n    if (!options.height) {\n      options.height = options.resource.height;\n      if (!options.autoDensity) {\n        options.height /= options.resolution;\n      }\n    }\n    super(options);\n    this.uploadMethodId = \"image\";\n    this.autoDensity = options.autoDensity;\n    this.resizeCanvas();\n    this.transparent = !!options.transparent;\n  }\n  resizeCanvas() {\n    if (this.autoDensity && \"style\" in this.resource) {\n      this.resource.style.width = `${this.width}px`;\n      this.resource.style.height = `${this.height}px`;\n    }\n    if (this.resource.width !== this.pixelWidth || this.resource.height !== this.pixelHeight) {\n      this.resource.width = this.pixelWidth;\n      this.resource.height = this.pixelHeight;\n    }\n  }\n  resize(width = this.width, height = this.height, resolution = this._resolution) {\n    const didResize = super.resize(width, height, resolution);\n    if (didResize) {\n      this.resizeCanvas();\n    }\n    return didResize;\n  }\n  static test(resource) {\n    return globalThis.HTMLCanvasElement && resource instanceof HTMLCanvasElement || globalThis.OffscreenCanvas && resource instanceof OffscreenCanvas;\n  }\n  /**\n   * Returns the 2D rendering context for the canvas.\n   * Caches the context after creating it.\n   * @returns The 2D rendering context of the canvas.\n   */\n  get context2D() {\n    return this._context2D || (this._context2D = this.resource.getContext(\"2d\"));\n  }\n}\nCanvasSource.extension = ExtensionType.TextureSource;\n\nexport { CanvasSource };\n//# sourceMappingURL=CanvasSource.mjs.map\n","import { ExtensionType } from '../../../../../extensions/Extensions.mjs';\nimport { TextureSource } from './TextureSource.mjs';\n\n\"use strict\";\nclass ImageSource extends TextureSource {\n  constructor(options) {\n    super(options);\n    this.uploadMethodId = \"image\";\n    this.autoGarbageCollect = true;\n  }\n  static test(resource) {\n    return globalThis.HTMLImageElement && resource instanceof HTMLImageElement || typeof ImageBitmap !== \"undefined\" && resource instanceof ImageBitmap || globalThis.VideoFrame && resource instanceof VideoFrame;\n  }\n}\nImageSource.extension = ExtensionType.TextureSource;\n\nexport { ImageSource };\n//# sourceMappingURL=ImageSource.mjs.map\n","\"use strict\";\nvar UPDATE_PRIORITY = /* @__PURE__ */ ((UPDATE_PRIORITY2) => {\n  UPDATE_PRIORITY2[UPDATE_PRIORITY2[\"INTERACTION\"] = 50] = \"INTERACTION\";\n  UPDATE_PRIORITY2[UPDATE_PRIORITY2[\"HIGH\"] = 25] = \"HIGH\";\n  UPDATE_PRIORITY2[UPDATE_PRIORITY2[\"NORMAL\"] = 0] = \"NORMAL\";\n  UPDATE_PRIORITY2[UPDATE_PRIORITY2[\"LOW\"] = -25] = \"LOW\";\n  UPDATE_PRIORITY2[UPDATE_PRIORITY2[\"UTILITY\"] = -50] = \"UTILITY\";\n  return UPDATE_PRIORITY2;\n})(UPDATE_PRIORITY || {});\n\nexport { UPDATE_PRIORITY };\n//# sourceMappingURL=const.mjs.map\n","\"use strict\";\nclass TickerListener {\n  /**\n   * Constructor\n   * @private\n   * @param fn - The listener function to be added for one update\n   * @param context - The listener context\n   * @param priority - The priority for emitting\n   * @param once - If the handler should fire once\n   */\n  constructor(fn, context = null, priority = 0, once = false) {\n    /** The next item in chain. */\n    this.next = null;\n    /** The previous item in chain. */\n    this.previous = null;\n    /** `true` if this listener has been destroyed already. */\n    this._destroyed = false;\n    this._fn = fn;\n    this._context = context;\n    this.priority = priority;\n    this._once = once;\n  }\n  /**\n   * Simple compare function to figure out if a function and context match.\n   * @param fn - The listener function to be added for one update\n   * @param context - The listener context\n   * @returns `true` if the listener match the arguments\n   */\n  match(fn, context = null) {\n    return this._fn === fn && this._context === context;\n  }\n  /**\n   * Emit by calling the current function.\n   * @param ticker - The ticker emitting.\n   * @returns Next ticker\n   */\n  emit(ticker) {\n    if (this._fn) {\n      if (this._context) {\n        this._fn.call(this._context, ticker);\n      } else {\n        this._fn(ticker);\n      }\n    }\n    const redirect = this.next;\n    if (this._once) {\n      this.destroy(true);\n    }\n    if (this._destroyed) {\n      this.next = null;\n    }\n    return redirect;\n  }\n  /**\n   * Connect to the list.\n   * @param previous - Input node, previous listener\n   */\n  connect(previous) {\n    this.previous = previous;\n    if (previous.next) {\n      previous.next.previous = this;\n    }\n    this.next = previous.next;\n    previous.next = this;\n  }\n  /**\n   * Destroy and don't use after this.\n   * @param hard - `true` to remove the `next` reference, this\n   *        is considered a hard destroy. Soft destroy maintains the next reference.\n   * @returns The listener to redirect while emitting or removing.\n   */\n  destroy(hard = false) {\n    this._destroyed = true;\n    this._fn = null;\n    this._context = null;\n    if (this.previous) {\n      this.previous.next = this.next;\n    }\n    if (this.next) {\n      this.next.previous = this.previous;\n    }\n    const redirect = this.next;\n    this.next = hard ? null : redirect;\n    this.previous = null;\n    return redirect;\n  }\n}\n\nexport { TickerListener };\n//# sourceMappingURL=TickerListener.mjs.map\n","import { UPDATE_PRIORITY } from './const.mjs';\nimport { TickerListener } from './TickerListener.mjs';\n\n\"use strict\";\nconst _Ticker = class _Ticker {\n  constructor() {\n    /**\n     * Whether or not this ticker should invoke the method {@link Ticker#start|start}\n     * automatically when a listener is added.\n     * @example\n     * ```ts\n     * // Default behavior (manual start)\n     * const ticker = new Ticker();\n     * ticker.autoStart = false;\n     * ticker.add(() => {\n     *     // Won't run until ticker.start() is called\n     * });\n     *\n     * // Auto-start behavior\n     * const autoTicker = new Ticker();\n     * autoTicker.autoStart = true;\n     * autoTicker.add(() => {\n     *     // Runs immediately when added\n     * });\n     * ```\n     * @default false\n     * @see {@link Ticker#start} For manually starting the ticker\n     * @see {@link Ticker#stop} For manually stopping the ticker\n     */\n    this.autoStart = false;\n    /**\n     * Scalar representing the delta time factor.\n     * This is a dimensionless value representing the fraction of a frame at the target framerate.\n     * At 60 FPS, this value is typically around 1.0.\n     *\n     * This is NOT in milliseconds - it's a scalar multiplier for frame-independent animations.\n     * For actual milliseconds, use {@link Ticker#deltaMS}.\n     * @member {number}\n     * @example\n     * ```ts\n     * // Frame-independent animation using deltaTime scalar\n     * ticker.add((ticker) => {\n     *     // Rotate sprite by 0.1 radians per frame, scaled by deltaTime\n     *     sprite.rotation += 0.1 * ticker.deltaTime;\n     * });\n     * ```\n     */\n    this.deltaTime = 1;\n    /**\n     * The last time update was invoked, in milliseconds since epoch.\n     * Similar to performance.now() timestamp format.\n     *\n     * Used internally for calculating time deltas between frames.\n     * @member {number}\n     * @example\n     * ```ts\n     * ticker.add((ticker) => {\n     *     const currentTime = performance.now();\n     *     const timeSinceLastFrame = currentTime - ticker.lastTime;\n     *     console.log(`Time since last frame: ${timeSinceLastFrame}ms`);\n     * });\n     * ```\n     */\n    this.lastTime = -1;\n    /**\n     * Factor of current {@link Ticker#deltaTime|deltaTime}.\n     * Used to scale time for slow motion or fast-forward effects.\n     * @example\n     * ```ts\n     * // Basic speed adjustment\n     * ticker.speed = 0.5; // Half speed (slow motion)\n     * ticker.speed = 2.0; // Double speed (fast forward)\n     *\n     * // Temporary speed changes\n     * function slowMotion() {\n     *     const normalSpeed = ticker.speed;\n     *     ticker.speed = 0.2;\n     *     setTimeout(() => {\n     *         ticker.speed = normalSpeed;\n     *     }, 1000);\n     * }\n     * ```\n     */\n    this.speed = 1;\n    /**\n     * Whether or not this ticker has been started.\n     *\n     * `true` if {@link Ticker#start|start} has been called.\n     * `false` if {@link Ticker#stop|Stop} has been called.\n     *\n     * While `false`, this value may change to `true` in the\n     * event of {@link Ticker#autoStart|autoStart} being `true`\n     * and a listener is added.\n     * @example\n     * ```ts\n     * // Check ticker state\n     * const ticker = new Ticker();\n     * console.log(ticker.started); // false\n     *\n     * // Start and verify\n     * ticker.start();\n     * console.log(ticker.started); // true\n     * ```\n     */\n    this.started = false;\n    /** Internal current frame request ID */\n    this._requestId = null;\n    /**\n     * Internal value managed by minFPS property setter and getter.\n     * This is the maximum allowed milliseconds between updates.\n     */\n    this._maxElapsedMS = 100;\n    /**\n     * Internal value managed by minFPS property setter and getter.\n     * This is the minimum allowed milliseconds between updates.\n     */\n    this._minElapsedMS = 0;\n    /** If enabled, deleting is disabled.*/\n    this._protected = false;\n    /** The last time keyframe was executed. Maintains a relatively fixed interval with the previous value. */\n    this._lastFrame = -1;\n    this._head = new TickerListener(null, null, Infinity);\n    this.deltaMS = 1 / _Ticker.targetFPMS;\n    this.elapsedMS = 1 / _Ticker.targetFPMS;\n    this._tick = (time) => {\n      this._requestId = null;\n      if (this.started) {\n        this.update(time);\n        if (this.started && this._requestId === null && this._head.next) {\n          this._requestId = requestAnimationFrame(this._tick);\n        }\n      }\n    };\n  }\n  /**\n   * Conditionally requests a new animation frame.\n   * If a frame has not already been requested, and if the internal\n   * emitter has listeners, a new frame is requested.\n   */\n  _requestIfNeeded() {\n    if (this._requestId === null && this._head.next) {\n      this.lastTime = performance.now();\n      this._lastFrame = this.lastTime;\n      this._requestId = requestAnimationFrame(this._tick);\n    }\n  }\n  /** Conditionally cancels a pending animation frame. */\n  _cancelIfNeeded() {\n    if (this._requestId !== null) {\n      cancelAnimationFrame(this._requestId);\n      this._requestId = null;\n    }\n  }\n  /**\n   * Conditionally requests a new animation frame.\n   * If the ticker has been started it checks if a frame has not already\n   * been requested, and if the internal emitter has listeners. If these\n   * conditions are met, a new frame is requested. If the ticker has not\n   * been started, but autoStart is `true`, then the ticker starts now,\n   * and continues with the previous conditions to request a new frame.\n   */\n  _startIfPossible() {\n    if (this.started) {\n      this._requestIfNeeded();\n    } else if (this.autoStart) {\n      this.start();\n    }\n  }\n  /**\n   * Register a handler for tick events.\n   * @param fn - The listener function to add. Receives the Ticker instance as parameter\n   * @param context - The context for the listener\n   * @param priority - The priority of the listener\n   * @example\n   * ```ts\n   * // Access time properties through the ticker parameter\n   * ticker.add((ticker) => {\n   *     // Use deltaTime (dimensionless scalar) for frame-independent animations\n   *     sprite.rotation += 0.1 * ticker.deltaTime;\n   *\n   *     // Use deltaMS (milliseconds) for time-based calculations\n   *     const progress = ticker.deltaMS / animationDuration;\n   *\n   *     // Use elapsedMS for raw timing measurements\n   *     console.log(`Raw frame time: ${ticker.elapsedMS}ms`);\n   * });\n   * ```\n   */\n  add(fn, context, priority = UPDATE_PRIORITY.NORMAL) {\n    return this._addListener(new TickerListener(fn, context, priority));\n  }\n  /**\n   * Add a handler for the tick event which is only executed once on the next frame.\n   * @example\n   * ```ts\n   * // Basic one-time update\n   * ticker.addOnce(() => {\n   *     console.log('Runs next frame only');\n   * });\n   *\n   * // With specific context\n   * const game = {\n   *     init(ticker) {\n   *         this.loadResources();\n   *         console.log('Game initialized');\n   *     }\n   * };\n   * ticker.addOnce(game.init, game);\n   *\n   * // With priority\n   * ticker.addOnce(\n   *     () => {\n   *         // High priority one-time setup\n   *         physics.init();\n   *     },\n   *     undefined,\n   *     UPDATE_PRIORITY.HIGH\n   * );\n   * ```\n   * @param fn - The listener function to be added for one update\n   * @param context - The listener context\n   * @param priority - The priority for emitting (default: UPDATE_PRIORITY.NORMAL)\n   * @returns This instance of a ticker\n   * @see {@link Ticker#add} For continuous updates\n   * @see {@link Ticker#remove} For removing handlers\n   */\n  addOnce(fn, context, priority = UPDATE_PRIORITY.NORMAL) {\n    return this._addListener(new TickerListener(fn, context, priority, true));\n  }\n  /**\n   * Internally adds the event handler so that it can be sorted by priority.\n   * Priority allows certain handler (user, AnimatedSprite, Interaction) to be run\n   * before the rendering.\n   * @private\n   * @param listener - Current listener being added.\n   * @returns This instance of a ticker\n   */\n  _addListener(listener) {\n    let current = this._head.next;\n    let previous = this._head;\n    if (!current) {\n      listener.connect(previous);\n    } else {\n      while (current) {\n        if (listener.priority > current.priority) {\n          listener.connect(previous);\n          break;\n        }\n        previous = current;\n        current = current.next;\n      }\n      if (!listener.previous) {\n        listener.connect(previous);\n      }\n    }\n    this._startIfPossible();\n    return this;\n  }\n  /**\n   * Removes any handlers matching the function and context parameters.\n   * If no handlers are left after removing, then it cancels the animation frame.\n   * @example\n   * ```ts\n   * // Basic removal\n   * const onTick = () => {\n   *     sprite.rotation += 0.1;\n   * };\n   * ticker.add(onTick);\n   * ticker.remove(onTick);\n   *\n   * // Remove with context\n   * const game = {\n   *     update(ticker) {\n   *         this.physics.update(ticker.deltaTime);\n   *     }\n   * };\n   * ticker.add(game.update, game);\n   * ticker.remove(game.update, game);\n   *\n   * // Remove all matching handlers\n   * // (if same function was added multiple times)\n   * ticker.add(onTick);\n   * ticker.add(onTick);\n   * ticker.remove(onTick); // Removes all instances\n   * ```\n   * @param fn - The listener function to be removed\n   * @param context - The listener context to be removed\n   * @returns This instance of a ticker\n   * @see {@link Ticker#add} For adding handlers\n   * @see {@link Ticker#addOnce} For one-time handlers\n   */\n  remove(fn, context) {\n    let listener = this._head.next;\n    while (listener) {\n      if (listener.match(fn, context)) {\n        listener = listener.destroy();\n      } else {\n        listener = listener.next;\n      }\n    }\n    if (!this._head.next) {\n      this._cancelIfNeeded();\n    }\n    return this;\n  }\n  /**\n   * The number of listeners on this ticker, calculated by walking through linked list.\n   * @example\n   * ```ts\n   * // Check number of active listeners\n   * const ticker = new Ticker();\n   * console.log(ticker.count); // 0\n   *\n   * // Add some listeners\n   * ticker.add(() => {});\n   * ticker.add(() => {});\n   * console.log(ticker.count); // 2\n   *\n   * // Check after cleanup\n   * ticker.destroy();\n   * console.log(ticker.count); // 0\n   * ```\n   * @readonly\n   * @see {@link Ticker#add} For adding listeners\n   * @see {@link Ticker#remove} For removing listeners\n   */\n  get count() {\n    if (!this._head) {\n      return 0;\n    }\n    let count = 0;\n    let current = this._head;\n    while (current = current.next) {\n      count++;\n    }\n    return count;\n  }\n  /**\n   * Starts the ticker. If the ticker has listeners a new animation frame is requested at this point.\n   * @example\n   * ```ts\n   * // Basic manual start\n   * const ticker = new Ticker();\n   * ticker.add(() => {\n   *     // Animation code here\n   * });\n   * ticker.start();\n   * ```\n   * @see {@link Ticker#stop} For stopping the ticker\n   * @see {@link Ticker#autoStart} For automatic starting\n   * @see {@link Ticker#started} For checking ticker state\n   */\n  start() {\n    if (!this.started) {\n      this.started = true;\n      this._requestIfNeeded();\n    }\n  }\n  /**\n   * Stops the ticker. If the ticker has requested an animation frame it is canceled at this point.\n   * @example\n   * ```ts\n   * // Basic stop\n   * const ticker = new Ticker();\n   * ticker.stop();\n   * ```\n   * @see {@link Ticker#start} For starting the ticker\n   * @see {@link Ticker#started} For checking ticker state\n   * @see {@link Ticker#destroy} For cleaning up the ticker\n   */\n  stop() {\n    if (this.started) {\n      this.started = false;\n      this._cancelIfNeeded();\n    }\n  }\n  /**\n   * Destroy the ticker and don't use after this. Calling this method removes all references to internal events.\n   * @example\n   * ```ts\n   * // Clean up with active listeners\n   * const ticker = new Ticker();\n   * ticker.add(() => {});\n   * ticker.destroy(); // Removes all listeners\n   * ```\n   * @see {@link Ticker#stop} For stopping without destroying\n   * @see {@link Ticker#remove} For removing specific listeners\n   */\n  destroy() {\n    if (!this._protected) {\n      this.stop();\n      let listener = this._head.next;\n      while (listener) {\n        listener = listener.destroy(true);\n      }\n      this._head.destroy();\n      this._head = null;\n    }\n  }\n  /**\n   * Triggers an update.\n   *\n   * An update entails setting the\n   * current {@link Ticker#elapsedMS|elapsedMS},\n   * the current {@link Ticker#deltaTime|deltaTime},\n   * invoking all listeners with current deltaTime,\n   * and then finally setting {@link Ticker#lastTime|lastTime}\n   * with the value of currentTime that was provided.\n   *\n   * This method will be called automatically by animation\n   * frame callbacks if the ticker instance has been started\n   * and listeners are added.\n   * @example\n   * ```ts\n   * // Basic manual update\n   * const ticker = new Ticker();\n   * ticker.update(performance.now());\n   * ```\n   * @param currentTime - The current time of execution (defaults to performance.now())\n   * @see {@link Ticker#deltaTime} For frame delta value\n   * @see {@link Ticker#elapsedMS} For raw elapsed time\n   */\n  update(currentTime = performance.now()) {\n    let elapsedMS;\n    if (currentTime > this.lastTime) {\n      elapsedMS = this.elapsedMS = currentTime - this.lastTime;\n      if (elapsedMS > this._maxElapsedMS) {\n        elapsedMS = this._maxElapsedMS;\n      }\n      elapsedMS *= this.speed;\n      if (this._minElapsedMS) {\n        const delta = currentTime - this._lastFrame | 0;\n        if (delta < this._minElapsedMS) {\n          return;\n        }\n        this._lastFrame = currentTime - delta % this._minElapsedMS;\n      }\n      this.deltaMS = elapsedMS;\n      this.deltaTime = this.deltaMS * _Ticker.targetFPMS;\n      const head = this._head;\n      let listener = head.next;\n      while (listener) {\n        listener = listener.emit(this);\n      }\n      if (!head.next) {\n        this._cancelIfNeeded();\n      }\n    } else {\n      this.deltaTime = this.deltaMS = this.elapsedMS = 0;\n    }\n    this.lastTime = currentTime;\n  }\n  /**\n   * The frames per second at which this ticker is running.\n   * The default is approximately 60 in most modern browsers.\n   * > [!NOTE] This does not factor in the value of\n   * > {@link Ticker#speed|speed}, which is specific\n   * > to scaling {@link Ticker#deltaTime|deltaTime}.\n   * @example\n   * ```ts\n   * // Basic FPS monitoring\n   * ticker.add(() => {\n   *     console.log(`Current FPS: ${Math.round(ticker.FPS)}`);\n   * });\n   * ```\n   * @readonly\n   */\n  get FPS() {\n    return 1e3 / this.elapsedMS;\n  }\n  /**\n   * Manages the maximum amount of milliseconds allowed to\n   * elapse between invoking {@link Ticker#update|update}.\n   *\n   * This value is used to cap {@link Ticker#deltaTime|deltaTime},\n   * but does not effect the measured value of {@link Ticker#FPS|FPS}.\n   *\n   * When setting this property it is clamped to a value between\n   * `0` and `Ticker.targetFPMS * 1000`.\n   * @example\n   * ```ts\n   * // Set minimum acceptable frame rate\n   * const ticker = new Ticker();\n   * ticker.minFPS = 30; // Never go below 30 FPS\n   *\n   * // Use with maxFPS for frame rate clamping\n   * ticker.minFPS = 30;\n   * ticker.maxFPS = 60;\n   *\n   * // Monitor delta capping\n   * ticker.add(() => {\n   *     // Delta time will be capped based on minFPS\n   *     console.log(`Delta time: ${ticker.deltaTime}`);\n   * });\n   * ```\n   * @default 10\n   */\n  get minFPS() {\n    return 1e3 / this._maxElapsedMS;\n  }\n  set minFPS(fps) {\n    const minFPS = Math.min(this.maxFPS, fps);\n    const minFPMS = Math.min(Math.max(0, minFPS) / 1e3, _Ticker.targetFPMS);\n    this._maxElapsedMS = 1 / minFPMS;\n  }\n  /**\n   * Manages the minimum amount of milliseconds required to\n   * elapse between invoking {@link Ticker#update|update}.\n   *\n   * This will effect the measured value of {@link Ticker#FPS|FPS}.\n   *\n   * If it is set to `0`, then there is no limit; PixiJS will render as many frames as it can.\n   * Otherwise it will be at least `minFPS`\n   * @example\n   * ```ts\n   * // Set minimum acceptable frame rate\n   * const ticker = new Ticker();\n   * ticker.maxFPS = 60; // Never go above 60 FPS\n   *\n   * // Use with maxFPS for frame rate clamping\n   * ticker.minFPS = 30;\n   * ticker.maxFPS = 60;\n   *\n   * // Monitor delta capping\n   * ticker.add(() => {\n   *     // Delta time will be capped based on maxFPS\n   *     console.log(`Delta time: ${ticker.deltaTime}`);\n   * });\n   * ```\n   * @default 0\n   */\n  get maxFPS() {\n    if (this._minElapsedMS) {\n      return Math.round(1e3 / this._minElapsedMS);\n    }\n    return 0;\n  }\n  set maxFPS(fps) {\n    if (fps === 0) {\n      this._minElapsedMS = 0;\n    } else {\n      const maxFPS = Math.max(this.minFPS, fps);\n      this._minElapsedMS = 1 / (maxFPS / 1e3);\n    }\n  }\n  /**\n   * The shared ticker instance used by {@link AnimatedSprite} and by\n   * {@link VideoSource} to update animation frames / video textures.\n   *\n   * It may also be used by {@link Application} if created with the `sharedTicker` option property set to true.\n   *\n   * The property {@link Ticker#autoStart|autoStart} is set to `true` for this instance.\n   * Please follow the examples for usage, including how to opt-out of auto-starting the shared ticker.\n   * @example\n   * import { Ticker } from 'pixi.js';\n   *\n   * const ticker = Ticker.shared;\n   * // Set this to prevent starting this ticker when listeners are added.\n   * // By default this is true only for the Ticker.shared instance.\n   * ticker.autoStart = false;\n   *\n   * // FYI, call this to ensure the ticker is stopped. It should be stopped\n   * // if you have not attempted to render anything yet.\n   * ticker.stop();\n   *\n   * // Call this when you are ready for a running shared ticker.\n   * ticker.start();\n   * @example\n   * import { autoDetectRenderer, Container } from 'pixi.js';\n   *\n   * // You may use the shared ticker to render...\n   * const renderer = autoDetectRenderer();\n   * const stage = new Container();\n   * document.body.appendChild(renderer.view);\n   * ticker.add((time) => renderer.render(stage));\n   *\n   * // Or you can just update it manually.\n   * ticker.autoStart = false;\n   * ticker.stop();\n   * const animate = (time) => {\n   *     ticker.update(time);\n   *     renderer.render(stage);\n   *     requestAnimationFrame(animate);\n   * };\n   * animate(performance.now());\n   * @type {Ticker}\n   * @readonly\n   */\n  static get shared() {\n    if (!_Ticker._shared) {\n      const shared = _Ticker._shared = new _Ticker();\n      shared.autoStart = true;\n      shared._protected = true;\n    }\n    return _Ticker._shared;\n  }\n  /**\n   * The system ticker instance used by {@link PrepareBase} for core timing\n   * functionality that shouldn't usually need to be paused, unlike the `shared`\n   * ticker which drives visual animations and rendering which may want to be paused.\n   *\n   * The property {@link Ticker#autoStart|autoStart} is set to `true` for this instance.\n   * @type {Ticker}\n   * @readonly\n   * @advanced\n   */\n  static get system() {\n    if (!_Ticker._system) {\n      const system = _Ticker._system = new _Ticker();\n      system.autoStart = true;\n      system._protected = true;\n    }\n    return _Ticker._system;\n  }\n};\n/**\n * Target frame rate in frames per millisecond.\n * Used for converting deltaTime to a scalar time delta.\n * @example\n * ```ts\n * // Default is 0.06 (60 FPS)\n * console.log(Ticker.targetFPMS); // 0.06\n *\n * // Calculate target frame duration\n * const frameDuration = 1 / Ticker.targetFPMS; //  16.67ms\n *\n * // Use in custom timing calculations\n * const deltaTime = elapsedMS * Ticker.targetFPMS;\n * ```\n * @remarks\n * - Default is 0.06 (equivalent to 60 FPS)\n * - Used in deltaTime calculations\n * - Affects all ticker instances\n * @default 0.06\n * @see {@link Ticker#deltaTime} For time scaling\n * @see {@link Ticker#FPS} For actual frame rate\n */\n_Ticker.targetFPMS = 0.06;\nlet Ticker = _Ticker;\n\nexport { Ticker };\n//# sourceMappingURL=Ticker.mjs.map\n","import { DOMAdapter } from '../../environment/adapter.mjs';\n\n\"use strict\";\nlet promise;\nasync function detectVideoAlphaMode() {\n  promise ?? (promise = (async () => {\n    const canvas = DOMAdapter.get().createCanvas(1, 1);\n    const gl = canvas.getContext(\"webgl\");\n    if (!gl) {\n      return \"premultiply-alpha-on-upload\";\n    }\n    const video = await new Promise((resolve) => {\n      const video2 = document.createElement(\"video\");\n      video2.onloadeddata = () => resolve(video2);\n      video2.onerror = () => resolve(null);\n      video2.autoplay = false;\n      video2.crossOrigin = \"anonymous\";\n      video2.preload = \"auto\";\n      video2.src = \"data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=\";\n      video2.load();\n    });\n    if (!video) {\n      return \"premultiply-alpha-on-upload\";\n    }\n    const texture = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, texture);\n    const framebuffer = gl.createFramebuffer();\n    gl.bindFramebuffer(gl.FRAMEBUFFER, framebuffer);\n    gl.framebufferTexture2D(\n      gl.FRAMEBUFFER,\n      gl.COLOR_ATTACHMENT0,\n      gl.TEXTURE_2D,\n      texture,\n      0\n    );\n    gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);\n    gl.pixelStorei(gl.UNPACK_COLORSPACE_CONVERSION_WEBGL, gl.NONE);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, video);\n    const pixel = new Uint8Array(4);\n    gl.readPixels(0, 0, 1, 1, gl.RGBA, gl.UNSIGNED_BYTE, pixel);\n    gl.deleteFramebuffer(framebuffer);\n    gl.deleteTexture(texture);\n    gl.getExtension(\"WEBGL_lose_context\")?.loseContext();\n    return pixel[0] <= pixel[3] ? \"premultiplied-alpha\" : \"premultiply-alpha-on-upload\";\n  })());\n  return promise;\n}\n\nexport { detectVideoAlphaMode };\n//# sourceMappingURL=detectVideoAlphaMode.mjs.map\n","import { ExtensionType } from '../../../../../extensions/Extensions.mjs';\nimport { Ticker } from '../../../../../ticker/Ticker.mjs';\nimport { detectVideoAlphaMode } from '../../../../../utils/browser/detectVideoAlphaMode.mjs';\nimport { TextureSource } from './TextureSource.mjs';\n\n\"use strict\";\nconst _VideoSource = class _VideoSource extends TextureSource {\n  constructor(options) {\n    super(options);\n    // Public\n    /** Whether or not the video is ready to play. */\n    this.isReady = false;\n    /** The upload method for this texture. */\n    this.uploadMethodId = \"video\";\n    options = {\n      ..._VideoSource.defaultOptions,\n      ...options\n    };\n    this._autoUpdate = true;\n    this._isConnectedToTicker = false;\n    this._updateFPS = options.updateFPS || 0;\n    this._msToNextUpdate = 0;\n    this.autoPlay = options.autoPlay !== false;\n    this.alphaMode = options.alphaMode ?? \"premultiply-alpha-on-upload\";\n    this._videoFrameRequestCallback = this._videoFrameRequestCallback.bind(this);\n    this._videoFrameRequestCallbackHandle = null;\n    this._load = null;\n    this._resolve = null;\n    this._reject = null;\n    this._onCanPlay = this._onCanPlay.bind(this);\n    this._onCanPlayThrough = this._onCanPlayThrough.bind(this);\n    this._onError = this._onError.bind(this);\n    this._onPlayStart = this._onPlayStart.bind(this);\n    this._onPlayStop = this._onPlayStop.bind(this);\n    this._onSeeked = this._onSeeked.bind(this);\n    if (options.autoLoad !== false) {\n      void this.load();\n    }\n  }\n  /** Update the video frame if the source is not destroyed and meets certain conditions. */\n  updateFrame() {\n    if (this.destroyed) {\n      return;\n    }\n    if (this._updateFPS) {\n      const elapsedMS = Ticker.shared.elapsedMS * this.resource.playbackRate;\n      this._msToNextUpdate = Math.floor(this._msToNextUpdate - elapsedMS);\n    }\n    if (!this._updateFPS || this._msToNextUpdate <= 0) {\n      this._msToNextUpdate = this._updateFPS ? Math.floor(1e3 / this._updateFPS) : 0;\n    }\n    if (this.isValid) {\n      this.update();\n    }\n  }\n  /** Callback to update the video frame and potentially request the next frame update. */\n  _videoFrameRequestCallback() {\n    this.updateFrame();\n    if (this.destroyed) {\n      this._videoFrameRequestCallbackHandle = null;\n    } else {\n      this._videoFrameRequestCallbackHandle = this.resource.requestVideoFrameCallback(\n        this._videoFrameRequestCallback\n      );\n    }\n  }\n  /**\n   * Checks if the resource has valid dimensions.\n   * @returns {boolean} True if width and height are set, otherwise false.\n   */\n  get isValid() {\n    return !!this.resource.videoWidth && !!this.resource.videoHeight;\n  }\n  /**\n   * Start preloading the video resource.\n   * @returns {Promise<this>} Handle the validate event\n   */\n  async load() {\n    if (this._load) {\n      return this._load;\n    }\n    const source = this.resource;\n    const options = this.options;\n    if ((source.readyState === source.HAVE_ENOUGH_DATA || source.readyState === source.HAVE_FUTURE_DATA) && source.width && source.height) {\n      source.complete = true;\n    }\n    source.addEventListener(\"play\", this._onPlayStart);\n    source.addEventListener(\"pause\", this._onPlayStop);\n    source.addEventListener(\"seeked\", this._onSeeked);\n    if (!this._isSourceReady()) {\n      if (!options.preload) {\n        source.addEventListener(\"canplay\", this._onCanPlay);\n      }\n      source.addEventListener(\"canplaythrough\", this._onCanPlayThrough);\n      source.addEventListener(\"error\", this._onError, true);\n    } else {\n      this._mediaReady();\n    }\n    this.alphaMode = await detectVideoAlphaMode();\n    this._load = new Promise((resolve, reject) => {\n      if (this.isValid) {\n        resolve(this);\n      } else {\n        this._resolve = resolve;\n        this._reject = reject;\n        if (options.preloadTimeoutMs !== void 0) {\n          this._preloadTimeout = setTimeout(() => {\n            this._onError(new ErrorEvent(`Preload exceeded timeout of ${options.preloadTimeoutMs}ms`));\n          });\n        }\n        source.load();\n      }\n    });\n    return this._load;\n  }\n  /**\n   * Handle video error events.\n   * @param event - The error event\n   */\n  _onError(event) {\n    this.resource.removeEventListener(\"error\", this._onError, true);\n    this.emit(\"error\", event);\n    if (this._reject) {\n      this._reject(event);\n      this._reject = null;\n      this._resolve = null;\n    }\n  }\n  /**\n   * Checks if the underlying source is playing.\n   * @returns True if playing.\n   */\n  _isSourcePlaying() {\n    const source = this.resource;\n    return !source.paused && !source.ended;\n  }\n  /**\n   * Checks if the underlying source is ready for playing.\n   * @returns True if ready.\n   */\n  _isSourceReady() {\n    const source = this.resource;\n    return source.readyState > 2;\n  }\n  /** Runs the update loop when the video is ready to play. */\n  _onPlayStart() {\n    if (!this.isValid) {\n      this._mediaReady();\n    }\n    this._configureAutoUpdate();\n  }\n  /** Stops the update loop when a pause event is triggered. */\n  _onPlayStop() {\n    this._configureAutoUpdate();\n  }\n  /** Handles behavior when the video completes seeking to the current playback position. */\n  _onSeeked() {\n    if (this._autoUpdate && !this._isSourcePlaying()) {\n      this._msToNextUpdate = 0;\n      this.updateFrame();\n      this._msToNextUpdate = 0;\n    }\n  }\n  _onCanPlay() {\n    const source = this.resource;\n    source.removeEventListener(\"canplay\", this._onCanPlay);\n    this._mediaReady();\n  }\n  _onCanPlayThrough() {\n    const source = this.resource;\n    source.removeEventListener(\"canplaythrough\", this._onCanPlay);\n    if (this._preloadTimeout) {\n      clearTimeout(this._preloadTimeout);\n      this._preloadTimeout = void 0;\n    }\n    this._mediaReady();\n  }\n  /** Fired when the video is loaded and ready to play. */\n  _mediaReady() {\n    const source = this.resource;\n    if (this.isValid) {\n      this.isReady = true;\n      this.resize(source.videoWidth, source.videoHeight);\n    }\n    this._msToNextUpdate = 0;\n    this.updateFrame();\n    this._msToNextUpdate = 0;\n    if (this._resolve) {\n      this._resolve(this);\n      this._resolve = null;\n      this._reject = null;\n    }\n    if (this._isSourcePlaying()) {\n      this._onPlayStart();\n    } else if (this.autoPlay) {\n      void this.resource.play();\n    }\n  }\n  /** Cleans up resources and event listeners associated with this texture. */\n  destroy() {\n    this._configureAutoUpdate();\n    const source = this.resource;\n    if (source) {\n      source.removeEventListener(\"play\", this._onPlayStart);\n      source.removeEventListener(\"pause\", this._onPlayStop);\n      source.removeEventListener(\"seeked\", this._onSeeked);\n      source.removeEventListener(\"canplay\", this._onCanPlay);\n      source.removeEventListener(\"canplaythrough\", this._onCanPlayThrough);\n      source.removeEventListener(\"error\", this._onError, true);\n      source.pause();\n      source.src = \"\";\n      source.load();\n    }\n    super.destroy();\n  }\n  /** Should the base texture automatically update itself, set to true by default. */\n  get autoUpdate() {\n    return this._autoUpdate;\n  }\n  set autoUpdate(value) {\n    if (value !== this._autoUpdate) {\n      this._autoUpdate = value;\n      this._configureAutoUpdate();\n    }\n  }\n  /**\n   * How many times a second to update the texture from the video.\n   * Leave at 0 to update at every render.\n   * A lower fps can help performance, as updating the texture at 60fps on a 30ps video may not be efficient.\n   */\n  get updateFPS() {\n    return this._updateFPS;\n  }\n  set updateFPS(value) {\n    if (value !== this._updateFPS) {\n      this._updateFPS = value;\n      this._configureAutoUpdate();\n    }\n  }\n  /**\n   * Configures the updating mechanism based on the current state and settings.\n   *\n   * This method decides between using the browser's native video frame callback or a custom ticker\n   * for updating the video frame. It ensures optimal performance and responsiveness\n   * based on the video's state, playback status, and the desired frames-per-second setting.\n   *\n   * - If `_autoUpdate` is enabled and the video source is playing:\n   *   - It will prefer the native video frame callback if available and no specific FPS is set.\n   *   - Otherwise, it will use a custom ticker for manual updates.\n   * - If `_autoUpdate` is disabled or the video isn't playing, any active update mechanisms are halted.\n   */\n  _configureAutoUpdate() {\n    if (this._autoUpdate && this._isSourcePlaying()) {\n      if (!this._updateFPS && this.resource.requestVideoFrameCallback) {\n        if (this._isConnectedToTicker) {\n          Ticker.shared.remove(this.updateFrame, this);\n          this._isConnectedToTicker = false;\n          this._msToNextUpdate = 0;\n        }\n        if (this._videoFrameRequestCallbackHandle === null) {\n          this._videoFrameRequestCallbackHandle = this.resource.requestVideoFrameCallback(\n            this._videoFrameRequestCallback\n          );\n        }\n      } else {\n        if (this._videoFrameRequestCallbackHandle !== null) {\n          this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle);\n          this._videoFrameRequestCallbackHandle = null;\n        }\n        if (!this._isConnectedToTicker) {\n          Ticker.shared.add(this.updateFrame, this);\n          this._isConnectedToTicker = true;\n          this._msToNextUpdate = 0;\n        }\n      }\n    } else {\n      if (this._videoFrameRequestCallbackHandle !== null) {\n        this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle);\n        this._videoFrameRequestCallbackHandle = null;\n      }\n      if (this._isConnectedToTicker) {\n        Ticker.shared.remove(this.updateFrame, this);\n        this._isConnectedToTicker = false;\n        this._msToNextUpdate = 0;\n      }\n    }\n  }\n  static test(resource) {\n    return globalThis.HTMLVideoElement && resource instanceof HTMLVideoElement;\n  }\n};\n_VideoSource.extension = ExtensionType.TextureSource;\n/** The default options for video sources. */\n_VideoSource.defaultOptions = {\n  ...TextureSource.defaultOptions,\n  /** If true, the video will start loading immediately. */\n  autoLoad: true,\n  /** If true, the video will start playing as soon as it is loaded. */\n  autoPlay: true,\n  /** The number of times a second to update the texture from the video. Leave at 0 to update at every render. */\n  updateFPS: 0,\n  /** If true, the video will be loaded with the `crossorigin` attribute. */\n  crossorigin: true,\n  /** If true, the video will loop when it ends. */\n  loop: false,\n  /** If true, the video will be muted. */\n  muted: true,\n  /** If true, the video will play inline. */\n  playsinline: true,\n  /** If true, the video will be preloaded. */\n  preload: false\n};\n/**\n * Map of video MIME types that can't be directly derived from file extensions.\n * @readonly\n */\n_VideoSource.MIME_TYPES = {\n  ogv: \"video/ogg\",\n  mov: \"video/quicktime\",\n  m4v: \"video/mp4\"\n};\nlet VideoSource = _VideoSource;\n\nexport { VideoSource };\n//# sourceMappingURL=VideoSource.mjs.map\n","\"use strict\";\nconst convertToList = (input, transform, forceTransform = false) => {\n  if (!Array.isArray(input)) {\n    input = [input];\n  }\n  if (!transform) {\n    return input;\n  }\n  return input.map((item) => {\n    if (typeof item === \"string\" || forceTransform) {\n      return transform(item);\n    }\n    return item;\n  });\n};\n\nexport { convertToList };\n//# sourceMappingURL=convertToList.mjs.map\n","import { warn } from '../../utils/logging/warn.mjs';\nimport { convertToList } from '../utils/convertToList.mjs';\n\n\"use strict\";\nclass CacheClass {\n  constructor() {\n    this._parsers = [];\n    this._cache = /* @__PURE__ */ new Map();\n    this._cacheMap = /* @__PURE__ */ new Map();\n  }\n  /** Clear all entries. */\n  reset() {\n    this._cacheMap.clear();\n    this._cache.clear();\n  }\n  /**\n   * Check if the key exists\n   * @param key - The key to check\n   */\n  has(key) {\n    return this._cache.has(key);\n  }\n  /**\n   * Fetch entry by key\n   * @param key - The key of the entry to get\n   */\n  get(key) {\n    const result = this._cache.get(key);\n    if (!result) {\n      warn(`[Assets] Asset id ${key} was not found in the Cache`);\n    }\n    return result;\n  }\n  /**\n   * Set a value by key or keys name\n   * @param key - The key or keys to set\n   * @param value - The value to store in the cache or from which cacheable assets will be derived.\n   */\n  set(key, value) {\n    const keys = convertToList(key);\n    let cacheableAssets;\n    for (let i = 0; i < this.parsers.length; i++) {\n      const parser = this.parsers[i];\n      if (parser.test(value)) {\n        cacheableAssets = parser.getCacheableAssets(keys, value);\n        break;\n      }\n    }\n    const cacheableMap = new Map(Object.entries(cacheableAssets || {}));\n    if (!cacheableAssets) {\n      keys.forEach((key2) => {\n        cacheableMap.set(key2, value);\n      });\n    }\n    const cacheKeys = [...cacheableMap.keys()];\n    const cachedAssets = {\n      cacheKeys,\n      keys\n    };\n    keys.forEach((key2) => {\n      this._cacheMap.set(key2, cachedAssets);\n    });\n    cacheKeys.forEach((key2) => {\n      const val = cacheableAssets ? cacheableAssets[key2] : value;\n      if (this._cache.has(key2) && this._cache.get(key2) !== val) {\n        warn(\"[Cache] already has key:\", key2);\n      }\n      this._cache.set(key2, cacheableMap.get(key2));\n    });\n  }\n  /**\n   * Remove entry by key\n   *\n   * This function will also remove any associated alias from the cache also.\n   * @param key - The key of the entry to remove\n   */\n  remove(key) {\n    if (!this._cacheMap.has(key)) {\n      warn(`[Assets] Asset id ${key} was not found in the Cache`);\n      return;\n    }\n    const cacheMap = this._cacheMap.get(key);\n    const cacheKeys = cacheMap.cacheKeys;\n    cacheKeys.forEach((key2) => {\n      this._cache.delete(key2);\n    });\n    cacheMap.keys.forEach((key2) => {\n      this._cacheMap.delete(key2);\n    });\n  }\n  /**\n   * All loader parsers registered\n   * @advanced\n   */\n  get parsers() {\n    return this._parsers;\n  }\n}\nconst Cache = new CacheClass();\n\nexport { Cache };\n//# sourceMappingURL=Cache.mjs.map\n","import { Cache } from '../../../../../assets/cache/Cache.mjs';\nimport { extensions, ExtensionType } from '../../../../../extensions/Extensions.mjs';\nimport { TextureSource } from '../sources/TextureSource.mjs';\nimport { Texture } from '../Texture.mjs';\n\n\"use strict\";\nconst sources = [];\nextensions.handleByList(ExtensionType.TextureSource, sources);\nfunction autoDetectSource(options = {}) {\n  return textureSourceFrom(options);\n}\nfunction textureSourceFrom(options = {}) {\n  const hasResource = options && options.resource;\n  const res = hasResource ? options.resource : options;\n  const opts = hasResource ? options : { resource: options };\n  for (let i = 0; i < sources.length; i++) {\n    const Source = sources[i];\n    if (Source.test(res)) {\n      return new Source(opts);\n    }\n  }\n  throw new Error(`Could not find a source type for resource: ${opts.resource}`);\n}\nfunction resourceToTexture(options = {}, skipCache = false) {\n  const hasResource = options && options.resource;\n  const resource = hasResource ? options.resource : options;\n  const opts = hasResource ? options : { resource: options };\n  if (!skipCache && Cache.has(resource)) {\n    return Cache.get(resource);\n  }\n  const texture = new Texture({ source: textureSourceFrom(opts) });\n  texture.on(\"destroy\", () => {\n    if (Cache.has(resource)) {\n      Cache.remove(resource);\n    }\n  });\n  if (!skipCache) {\n    Cache.set(resource, texture);\n  }\n  return texture;\n}\nfunction textureFrom(id, skipCache = false) {\n  if (typeof id === \"string\") {\n    return Cache.get(id);\n  } else if (id instanceof TextureSource) {\n    return new Texture({ source: id });\n  }\n  return resourceToTexture(id, skipCache);\n}\nTexture.from = textureFrom;\nTextureSource.from = textureSourceFrom;\n\nexport { autoDetectSource, resourceToTexture, textureFrom };\n//# sourceMappingURL=textureFrom.mjs.map\n","import { extensions } from '../extensions/Extensions.mjs';\nimport { AlphaMask } from './mask/alpha/AlphaMask.mjs';\nimport { ColorMask } from './mask/color/ColorMask.mjs';\nimport { StencilMask } from './mask/stencil/StencilMask.mjs';\nimport { BufferImageSource } from './renderers/shared/texture/sources/BufferImageSource.mjs';\nimport { CanvasSource } from './renderers/shared/texture/sources/CanvasSource.mjs';\nimport { ImageSource } from './renderers/shared/texture/sources/ImageSource.mjs';\nimport { VideoSource } from './renderers/shared/texture/sources/VideoSource.mjs';\nimport './renderers/shared/texture/utils/textureFrom.mjs';\nimport './mask/MaskEffectManager.mjs';\n\n\"use strict\";\nextensions.add(AlphaMask, ColorMask, StencilMask, VideoSource, ImageSource, CanvasSource, BufferImageSource);\n//# sourceMappingURL=init.mjs.map\n","\"use strict\";\nvar LoaderParserPriority = /* @__PURE__ */ ((LoaderParserPriority2) => {\n  LoaderParserPriority2[LoaderParserPriority2[\"Low\"] = 0] = \"Low\";\n  LoaderParserPriority2[LoaderParserPriority2[\"Normal\"] = 1] = \"Normal\";\n  LoaderParserPriority2[LoaderParserPriority2[\"High\"] = 2] = \"High\";\n  return LoaderParserPriority2;\n})(LoaderParserPriority || {});\n\nexport { LoaderParserPriority };\n//# sourceMappingURL=LoaderParser.mjs.map\n","import { DOMAdapter } from '../environment/adapter.mjs';\n\n\"use strict\";\nfunction assertPath(path2) {\n  if (typeof path2 !== \"string\") {\n    throw new TypeError(`Path must be a string. Received ${JSON.stringify(path2)}`);\n  }\n}\nfunction removeUrlParams(url) {\n  const re = url.split(\"?\")[0];\n  return re.split(\"#\")[0];\n}\nfunction escapeRegExp(string) {\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\");\n}\nfunction replaceAll(str, find, replace) {\n  return str.replace(new RegExp(escapeRegExp(find), \"g\"), replace);\n}\nfunction normalizeStringPosix(path2, allowAboveRoot) {\n  let res = \"\";\n  let lastSegmentLength = 0;\n  let lastSlash = -1;\n  let dots = 0;\n  let code = -1;\n  for (let i = 0; i <= path2.length; ++i) {\n    if (i < path2.length) {\n      code = path2.charCodeAt(i);\n    } else if (code === 47) {\n      break;\n    } else {\n      code = 47;\n    }\n    if (code === 47) {\n      if (lastSlash === i - 1 || dots === 1) {\n      } else if (lastSlash !== i - 1 && dots === 2) {\n        if (res.length < 2 || lastSegmentLength !== 2 || res.charCodeAt(res.length - 1) !== 46 || res.charCodeAt(res.length - 2) !== 46) {\n          if (res.length > 2) {\n            const lastSlashIndex = res.lastIndexOf(\"/\");\n            if (lastSlashIndex !== res.length - 1) {\n              if (lastSlashIndex === -1) {\n                res = \"\";\n                lastSegmentLength = 0;\n              } else {\n                res = res.slice(0, lastSlashIndex);\n                lastSegmentLength = res.length - 1 - res.lastIndexOf(\"/\");\n              }\n              lastSlash = i;\n              dots = 0;\n              continue;\n            }\n          } else if (res.length === 2 || res.length === 1) {\n            res = \"\";\n            lastSegmentLength = 0;\n            lastSlash = i;\n            dots = 0;\n            continue;\n          }\n        }\n        if (allowAboveRoot) {\n          if (res.length > 0) {\n            res += \"/..\";\n          } else {\n            res = \"..\";\n          }\n          lastSegmentLength = 2;\n        }\n      } else {\n        if (res.length > 0) {\n          res += `/${path2.slice(lastSlash + 1, i)}`;\n        } else {\n          res = path2.slice(lastSlash + 1, i);\n        }\n        lastSegmentLength = i - lastSlash - 1;\n      }\n      lastSlash = i;\n      dots = 0;\n    } else if (code === 46 && dots !== -1) {\n      ++dots;\n    } else {\n      dots = -1;\n    }\n  }\n  return res;\n}\nconst path = {\n  /**\n   * Converts a path to posix format.\n   * @param path - The path to convert to posix\n   * @example\n   * ```ts\n   * // Convert a Windows path to POSIX format\n   * path.toPosix('C:\\\\Users\\\\User\\\\Documents\\\\file.txt');\n   * // -> 'C:/Users/User/Documents/file.txt'\n   * ```\n   */\n  toPosix(path2) {\n    return replaceAll(path2, \"\\\\\", \"/\");\n  },\n  /**\n   * Checks if the path is a URL e.g. http://, https://\n   * @param path - The path to check\n   * @example\n   * ```ts\n   * // Check if a path is a URL\n   * path.isUrl('http://www.example.com');\n   * // -> true\n   * path.isUrl('C:/Users/User/Documents/file.txt');\n   * // -> false\n   * ```\n   */\n  isUrl(path2) {\n    return /^https?:/.test(this.toPosix(path2));\n  },\n  /**\n   * Checks if the path is a data URL\n   * @param path - The path to check\n   * @example\n   * ```ts\n   * // Check if a path is a data URL\n   * path.isDataUrl('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUA...');\n   * // -> true\n   * ```\n   */\n  isDataUrl(path2) {\n    return /^data:([a-z]+\\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\\-._~:@\\/?%\\s<>]*?)$/i.test(path2);\n  },\n  /**\n   * Checks if the path is a blob URL\n   * @param path - The path to check\n   * @example\n   * ```ts\n   * // Check if a path is a blob URL\n   * path.isBlobUrl('blob:http://www.example.com/12345678-1234-1234-1234-123456789012');\n   * // -> true\n   * ```\n   */\n  isBlobUrl(path2) {\n    return path2.startsWith(\"blob:\");\n  },\n  /**\n   * Checks if the path has a protocol e.g. http://, https://, file:///, data:, blob:, C:/\n   * This will return true for windows file paths\n   * @param path - The path to check\n   * @example\n   * ```ts\n   * // Check if a path has a protocol\n   * path.hasProtocol('http://www.example.com');\n   * // -> true\n   * path.hasProtocol('C:/Users/User/Documents/file.txt');\n   * // -> true\n   * ```\n   */\n  hasProtocol(path2) {\n    return /^[^/:]+:/.test(this.toPosix(path2));\n  },\n  /**\n   * Returns the protocol of the path e.g. http://, https://, file:///, data:, blob:, C:/\n   * @param path - The path to get the protocol from\n   * @example\n   * ```ts\n   * // Get the protocol from a URL\n   * path.getProtocol('http://www.example.com/path/to/resource');\n   * // -> 'http://'\n   * // Get the protocol from a file path\n   * path.getProtocol('C:/Users/User/Documents/file.txt');\n   * // -> 'C:/'\n   * ```\n   */\n  getProtocol(path2) {\n    assertPath(path2);\n    path2 = this.toPosix(path2);\n    const matchFile = /^file:\\/\\/\\//.exec(path2);\n    if (matchFile) {\n      return matchFile[0];\n    }\n    const matchProtocol = /^[^/:]+:\\/{0,2}/.exec(path2);\n    if (matchProtocol) {\n      return matchProtocol[0];\n    }\n    return \"\";\n  },\n  /**\n   * Converts URL to an absolute path.\n   * When loading from a Web Worker, we must use absolute paths.\n   * If the URL is already absolute we return it as is\n   * If it's not, we convert it\n   * @param url - The URL to test\n   * @param customBaseUrl - The base URL to use\n   * @param customRootUrl - The root URL to use\n   * @example\n   * ```ts\n   * // Convert a relative URL to an absolute path\n   * path.toAbsolute('images/texture.png', 'http://example.com/assets/');\n   * // -> 'http://example.com/assets/images/texture.png'\n   * ```\n   */\n  toAbsolute(url, customBaseUrl, customRootUrl) {\n    assertPath(url);\n    if (this.isDataUrl(url) || this.isBlobUrl(url))\n      return url;\n    const baseUrl = removeUrlParams(this.toPosix(customBaseUrl ?? DOMAdapter.get().getBaseUrl()));\n    const rootUrl = removeUrlParams(this.toPosix(customRootUrl ?? this.rootname(baseUrl)));\n    url = this.toPosix(url);\n    if (url.startsWith(\"/\")) {\n      return path.join(rootUrl, url.slice(1));\n    }\n    const absolutePath = this.isAbsolute(url) ? url : this.join(baseUrl, url);\n    return absolutePath;\n  },\n  /**\n   * Normalizes the given path, resolving '..' and '.' segments\n   * @param path - The path to normalize\n   * @example\n   * ```ts\n   * // Normalize a path with relative segments\n   * path.normalize('http://www.example.com/foo/bar/../baz');\n   * // -> 'http://www.example.com/foo/baz'\n   * // Normalize a file path with relative segments\n   * path.normalize('C:\\\\Users\\\\User\\\\Documents\\\\..\\\\file.txt');\n   * // -> 'C:/Users/User/file.txt'\n   * ```\n   */\n  normalize(path2) {\n    assertPath(path2);\n    if (path2.length === 0)\n      return \".\";\n    if (this.isDataUrl(path2) || this.isBlobUrl(path2))\n      return path2;\n    path2 = this.toPosix(path2);\n    let protocol = \"\";\n    const isAbsolute = path2.startsWith(\"/\");\n    if (this.hasProtocol(path2)) {\n      protocol = this.rootname(path2);\n      path2 = path2.slice(protocol.length);\n    }\n    const trailingSeparator = path2.endsWith(\"/\");\n    path2 = normalizeStringPosix(path2, false);\n    if (path2.length > 0 && trailingSeparator)\n      path2 += \"/\";\n    if (isAbsolute)\n      return `/${path2}`;\n    return protocol + path2;\n  },\n  /**\n   * Determines if path is an absolute path.\n   * Absolute paths can be urls, data urls, or paths on disk\n   * @param path - The path to test\n   * @example\n   * ```ts\n   * // Check if a path is absolute\n   * path.isAbsolute('http://www.example.com/foo/bar');\n   * // -> true\n   * path.isAbsolute('C:/Users/User/Documents/file.txt');\n   * // -> true\n   * ```\n   */\n  isAbsolute(path2) {\n    assertPath(path2);\n    path2 = this.toPosix(path2);\n    if (this.hasProtocol(path2))\n      return true;\n    return path2.startsWith(\"/\");\n  },\n  /**\n   * Joins all given path segments together using the platform-specific separator as a delimiter,\n   * then normalizes the resulting path\n   * @param segments - The segments of the path to join\n   * @example\n   * ```ts\n   * // Join multiple path segments\n   * path.join('assets', 'images', 'sprite.png');\n   * // -> 'assets/images/sprite.png'\n   * // Join with relative segments\n   * path.join('assets', 'images', '../textures', 'sprite.png');\n   * // -> 'assets/textures/sprite.png'\n   * ```\n   */\n  join(...segments) {\n    if (segments.length === 0) {\n      return \".\";\n    }\n    let joined;\n    for (let i = 0; i < segments.length; ++i) {\n      const arg = segments[i];\n      assertPath(arg);\n      if (arg.length > 0) {\n        if (joined === void 0)\n          joined = arg;\n        else {\n          const prevArg = segments[i - 1] ?? \"\";\n          if (this.joinExtensions.includes(this.extname(prevArg).toLowerCase())) {\n            joined += `/../${arg}`;\n          } else {\n            joined += `/${arg}`;\n          }\n        }\n      }\n    }\n    if (joined === void 0) {\n      return \".\";\n    }\n    return this.normalize(joined);\n  },\n  /**\n   * Returns the directory name of a path\n   * @param path - The path to parse\n   * @example\n   * ```ts\n   * // Get the directory name of a path\n   * path.dirname('http://www.example.com/foo/bar/baz.png');\n   * // -> 'http://www.example.com/foo/bar'\n   * // Get the directory name of a file path\n   * path.dirname('C:/Users/User/Documents/file.txt');\n   * // -> 'C:/Users/User/Documents'\n   * ```\n   */\n  dirname(path2) {\n    assertPath(path2);\n    if (path2.length === 0)\n      return \".\";\n    path2 = this.toPosix(path2);\n    let code = path2.charCodeAt(0);\n    const hasRoot = code === 47;\n    let end = -1;\n    let matchedSlash = true;\n    const proto = this.getProtocol(path2);\n    const origpath = path2;\n    path2 = path2.slice(proto.length);\n    for (let i = path2.length - 1; i >= 1; --i) {\n      code = path2.charCodeAt(i);\n      if (code === 47) {\n        if (!matchedSlash) {\n          end = i;\n          break;\n        }\n      } else {\n        matchedSlash = false;\n      }\n    }\n    if (end === -1)\n      return hasRoot ? \"/\" : this.isUrl(origpath) ? proto + path2 : proto;\n    if (hasRoot && end === 1)\n      return \"//\";\n    return proto + path2.slice(0, end);\n  },\n  /**\n   * Returns the root of the path e.g. /, C:/, file:///, http://domain.com/\n   * @param path - The path to parse\n   * @example\n   * ```ts\n   * // Get the root of a URL\n   * path.rootname('http://www.example.com/foo/bar/baz.png');\n   * // -> 'http://www.example.com/'\n   * // Get the root of a file path\n   * path.rootname('C:/Users/User/Documents/file.txt');\n   * // -> 'C:/'\n   * ```\n   */\n  rootname(path2) {\n    assertPath(path2);\n    path2 = this.toPosix(path2);\n    let root = \"\";\n    if (path2.startsWith(\"/\"))\n      root = \"/\";\n    else {\n      root = this.getProtocol(path2);\n    }\n    if (this.isUrl(path2)) {\n      const index = path2.indexOf(\"/\", root.length);\n      if (index !== -1) {\n        root = path2.slice(0, index);\n      } else\n        root = path2;\n      if (!root.endsWith(\"/\"))\n        root += \"/\";\n    }\n    return root;\n  },\n  /**\n   * Returns the last portion of a path\n   * @param path - The path to test\n   * @param ext - Optional extension to remove\n   * @example\n   * ```ts\n   * // Get the basename of a URL\n   * path.basename('http://www.example.com/foo/bar/baz.png');\n   * // -> 'baz.png'\n   * // Get the basename of a file path\n   * path.basename('C:/Users/User/Documents/file.txt');\n   * // -> 'file.txt'\n   * ```\n   */\n  basename(path2, ext) {\n    assertPath(path2);\n    if (ext)\n      assertPath(ext);\n    path2 = removeUrlParams(this.toPosix(path2));\n    let start = 0;\n    let end = -1;\n    let matchedSlash = true;\n    let i;\n    if (ext !== void 0 && ext.length > 0 && ext.length <= path2.length) {\n      if (ext.length === path2.length && ext === path2)\n        return \"\";\n      let extIdx = ext.length - 1;\n      let firstNonSlashEnd = -1;\n      for (i = path2.length - 1; i >= 0; --i) {\n        const code = path2.charCodeAt(i);\n        if (code === 47) {\n          if (!matchedSlash) {\n            start = i + 1;\n            break;\n          }\n        } else {\n          if (firstNonSlashEnd === -1) {\n            matchedSlash = false;\n            firstNonSlashEnd = i + 1;\n          }\n          if (extIdx >= 0) {\n            if (code === ext.charCodeAt(extIdx)) {\n              if (--extIdx === -1) {\n                end = i;\n              }\n            } else {\n              extIdx = -1;\n              end = firstNonSlashEnd;\n            }\n          }\n        }\n      }\n      if (start === end)\n        end = firstNonSlashEnd;\n      else if (end === -1)\n        end = path2.length;\n      return path2.slice(start, end);\n    }\n    for (i = path2.length - 1; i >= 0; --i) {\n      if (path2.charCodeAt(i) === 47) {\n        if (!matchedSlash) {\n          start = i + 1;\n          break;\n        }\n      } else if (end === -1) {\n        matchedSlash = false;\n        end = i + 1;\n      }\n    }\n    if (end === -1)\n      return \"\";\n    return path2.slice(start, end);\n  },\n  /**\n   * Returns the extension of the path, from the last occurrence of the . (period) character to end of string in the last\n   * portion of the path. If there is no . in the last portion of the path, or if there are no . characters other than\n   * the first character of the basename of path, an empty string is returned.\n   * @param path - The path to parse\n   * @example\n   * ```ts\n   * // Get the extension of a URL\n   * path.extname('http://www.example.com/foo/bar/baz.png');\n   * // -> '.png'\n   * // Get the extension of a file path\n   * path.extname('C:/Users/User/Documents/file.txt');\n   * // -> '.txt'\n   * ```\n   */\n  extname(path2) {\n    assertPath(path2);\n    path2 = removeUrlParams(this.toPosix(path2));\n    let startDot = -1;\n    let startPart = 0;\n    let end = -1;\n    let matchedSlash = true;\n    let preDotState = 0;\n    for (let i = path2.length - 1; i >= 0; --i) {\n      const code = path2.charCodeAt(i);\n      if (code === 47) {\n        if (!matchedSlash) {\n          startPart = i + 1;\n          break;\n        }\n        continue;\n      }\n      if (end === -1) {\n        matchedSlash = false;\n        end = i + 1;\n      }\n      if (code === 46) {\n        if (startDot === -1)\n          startDot = i;\n        else if (preDotState !== 1)\n          preDotState = 1;\n      } else if (startDot !== -1) {\n        preDotState = -1;\n      }\n    }\n    if (startDot === -1 || end === -1 || preDotState === 0 || preDotState === 1 && startDot === end - 1 && startDot === startPart + 1) {\n      return \"\";\n    }\n    return path2.slice(startDot, end);\n  },\n  /**\n   * Parses a path into an object containing the 'root', `dir`, `base`, `ext`, and `name` properties.\n   * @param path - The path to parse\n   * @example\n   * ```ts\n   * // Parse a URL\n   * const parsed = path.parse('http://www.example.com/foo/bar/baz.png');\n   * // -> {\n   * //   root: 'http://www.example.com/',\n   * //   dir: 'http://www.example.com/foo/bar',\n   * //   base: 'baz.png',\n   * //   ext: '.png',\n   * //   name: 'baz'\n   * // }\n   * // Parse a file path\n   * const parsedFile = path.parse('C:/Users/User/Documents/file.txt');\n   * // -> {\n   * //   root: 'C:/',\n   * //   dir: 'C:/Users/User/Documents',\n   * //   base: 'file.txt',\n   * //   ext: '.txt',\n   * //   name: 'file'\n   * // }\n   * ```\n   */\n  parse(path2) {\n    assertPath(path2);\n    const ret = { root: \"\", dir: \"\", base: \"\", ext: \"\", name: \"\" };\n    if (path2.length === 0)\n      return ret;\n    path2 = removeUrlParams(this.toPosix(path2));\n    let code = path2.charCodeAt(0);\n    const isAbsolute = this.isAbsolute(path2);\n    let start;\n    const protocol = \"\";\n    ret.root = this.rootname(path2);\n    if (isAbsolute || this.hasProtocol(path2)) {\n      start = 1;\n    } else {\n      start = 0;\n    }\n    let startDot = -1;\n    let startPart = 0;\n    let end = -1;\n    let matchedSlash = true;\n    let i = path2.length - 1;\n    let preDotState = 0;\n    for (; i >= start; --i) {\n      code = path2.charCodeAt(i);\n      if (code === 47) {\n        if (!matchedSlash) {\n          startPart = i + 1;\n          break;\n        }\n        continue;\n      }\n      if (end === -1) {\n        matchedSlash = false;\n        end = i + 1;\n      }\n      if (code === 46) {\n        if (startDot === -1)\n          startDot = i;\n        else if (preDotState !== 1)\n          preDotState = 1;\n      } else if (startDot !== -1) {\n        preDotState = -1;\n      }\n    }\n    if (startDot === -1 || end === -1 || preDotState === 0 || preDotState === 1 && startDot === end - 1 && startDot === startPart + 1) {\n      if (end !== -1) {\n        if (startPart === 0 && isAbsolute)\n          ret.base = ret.name = path2.slice(1, end);\n        else\n          ret.base = ret.name = path2.slice(startPart, end);\n      }\n    } else {\n      if (startPart === 0 && isAbsolute) {\n        ret.name = path2.slice(1, startDot);\n        ret.base = path2.slice(1, end);\n      } else {\n        ret.name = path2.slice(startPart, startDot);\n        ret.base = path2.slice(startPart, end);\n      }\n      ret.ext = path2.slice(startDot, end);\n    }\n    ret.dir = this.dirname(path2);\n    if (protocol)\n      ret.dir = protocol + ret.dir;\n    return ret;\n  },\n  sep: \"/\",\n  delimiter: \":\",\n  joinExtensions: [\".html\"]\n};\n\nexport { path };\n//# sourceMappingURL=path.mjs.map\n","\"use strict\";\nfunction processX(base, ids, depth, result, tags) {\n  const id = ids[depth];\n  for (let i = 0; i < id.length; i++) {\n    const value = id[i];\n    if (depth < ids.length - 1) {\n      processX(base.replace(result[depth], value), ids, depth + 1, result, tags);\n    } else {\n      tags.push(base.replace(result[depth], value));\n    }\n  }\n}\nfunction createStringVariations(string) {\n  const regex = /\\{(.*?)\\}/g;\n  const result = string.match(regex);\n  const tags = [];\n  if (result) {\n    const ids = [];\n    result.forEach((vars) => {\n      const split = vars.substring(1, vars.length - 1).split(\",\");\n      ids.push(split);\n    });\n    processX(string, ids, 0, result, tags);\n  } else {\n    tags.push(string);\n  }\n  return tags;\n}\n\nexport { createStringVariations };\n//# sourceMappingURL=createStringVariations.mjs.map\n","\"use strict\";\nconst isSingleItem = (item) => !Array.isArray(item);\n\nexport { isSingleItem };\n//# sourceMappingURL=isSingleItem.mjs.map\n","import { warn } from '../../utils/logging/warn.mjs';\nimport { path } from '../../utils/path.mjs';\nimport { convertToList } from '../utils/convertToList.mjs';\nimport { createStringVariations } from '../utils/createStringVariations.mjs';\nimport { isSingleItem } from '../utils/isSingleItem.mjs';\n\n\"use strict\";\nclass Resolver {\n  constructor() {\n    this._defaultBundleIdentifierOptions = {\n      connector: \"-\",\n      createBundleAssetId: (bundleId, assetId) => `${bundleId}${this._bundleIdConnector}${assetId}`,\n      extractAssetIdFromBundle: (bundleId, assetBundleId) => assetBundleId.replace(`${bundleId}${this._bundleIdConnector}`, \"\")\n    };\n    /** The character that is used to connect the bundleId and the assetId when generating a bundle asset id key */\n    this._bundleIdConnector = this._defaultBundleIdentifierOptions.connector;\n    /**\n     * A function that generates a bundle asset id key from a bundleId and an assetId\n     * @param bundleId - the bundleId\n     * @param assetId  - the assetId\n     * @returns the bundle asset id key\n     */\n    this._createBundleAssetId = this._defaultBundleIdentifierOptions.createBundleAssetId;\n    /**\n     * A function that generates an assetId from a bundle asset id key. This is the reverse of generateBundleAssetId\n     * @param bundleId - the bundleId\n     * @param assetBundleId - the bundle asset id key\n     * @returns the assetId\n     */\n    this._extractAssetIdFromBundle = this._defaultBundleIdentifierOptions.extractAssetIdFromBundle;\n    this._assetMap = {};\n    this._preferredOrder = [];\n    this._parsers = [];\n    this._resolverHash = {};\n    this._bundles = {};\n  }\n  /**\n   * Override how the resolver deals with generating bundle ids.\n   * must be called before any bundles are added\n   * @param bundleIdentifier - the bundle identifier options\n   */\n  setBundleIdentifier(bundleIdentifier) {\n    this._bundleIdConnector = bundleIdentifier.connector ?? this._bundleIdConnector;\n    this._createBundleAssetId = bundleIdentifier.createBundleAssetId ?? this._createBundleAssetId;\n    this._extractAssetIdFromBundle = bundleIdentifier.extractAssetIdFromBundle ?? this._extractAssetIdFromBundle;\n    if (this._extractAssetIdFromBundle(\"foo\", this._createBundleAssetId(\"foo\", \"bar\")) !== \"bar\") {\n      throw new Error(\"[Resolver] GenerateBundleAssetId are not working correctly\");\n    }\n  }\n  /**\n   * Let the resolver know which assets you prefer to use when resolving assets.\n   * Multiple prefer user defined rules can be added.\n   * @example\n   * resolver.prefer({\n   *     // first look for something with the correct format, and then then correct resolution\n   *     priority: ['format', 'resolution'],\n   *     params:{\n   *         format:'webp', // prefer webp images\n   *         resolution: 2, // prefer a resolution of 2\n   *     }\n   * })\n   * resolver.add('foo', ['bar@2x.webp', 'bar@2x.png', 'bar.webp', 'bar.png']);\n   * resolver.resolveUrl('foo') // => 'bar@2x.webp'\n   * @param preferOrders - the prefer options\n   */\n  prefer(...preferOrders) {\n    preferOrders.forEach((prefer) => {\n      this._preferredOrder.push(prefer);\n      if (!prefer.priority) {\n        prefer.priority = Object.keys(prefer.params);\n      }\n    });\n    this._resolverHash = {};\n  }\n  /**\n   * Set the base path to prepend to all urls when resolving\n   * @example\n   * resolver.basePath = 'https://home.com/';\n   * resolver.add('foo', 'bar.ong');\n   * resolver.resolveUrl('foo', 'bar.png'); // => 'https://home.com/bar.png'\n   * @param basePath - the base path to use\n   */\n  set basePath(basePath) {\n    this._basePath = basePath;\n  }\n  get basePath() {\n    return this._basePath;\n  }\n  /**\n   * Set the root path for root-relative URLs. By default the `basePath`'s root is used. If no `basePath` is set, then the\n   * default value for browsers is `window.location.origin`\n   * @example\n   * // Application hosted on https://home.com/some-path/index.html\n   * resolver.basePath = 'https://home.com/some-path/';\n   * resolver.rootPath = 'https://home.com/';\n   * resolver.add('foo', '/bar.png');\n   * resolver.resolveUrl('foo', '/bar.png'); // => 'https://home.com/bar.png'\n   * @param rootPath - the root path to use\n   */\n  set rootPath(rootPath) {\n    this._rootPath = rootPath;\n  }\n  get rootPath() {\n    return this._rootPath;\n  }\n  /**\n   * All the active URL parsers that help the parser to extract information and create\n   * an asset object-based on parsing the URL itself.\n   *\n   * Can be added using the extensions API\n   * @example\n   * resolver.add('foo', [\n   *     {\n   *         resolution: 2,\n   *         format: 'png',\n   *         src: 'image@2x.png',\n   *     },\n   *     {\n   *         resolution:1,\n   *         format:'png',\n   *         src: 'image.png',\n   *     },\n   * ]);\n   *\n   * // With a url parser the information such as resolution and file format could extracted from the url itself:\n   * extensions.add({\n   *     extension: ExtensionType.ResolveParser,\n   *     test: loadTextures.test, // test if url ends in an image\n   *     parse: (value: string) =>\n   *     ({\n   *         resolution: parseFloat(Resolver.RETINA_PREFIX.exec(value)?.[1] ?? '1'),\n   *         format: value.split('.').pop(),\n   *         src: value,\n   *     }),\n   * });\n   *\n   * // Now resolution and format can be extracted from the url\n   * resolver.add('foo', [\n   *     'image@2x.png',\n   *     'image.png',\n   * ]);\n   */\n  get parsers() {\n    return this._parsers;\n  }\n  /** Used for testing, this resets the resolver to its initial state */\n  reset() {\n    this.setBundleIdentifier(this._defaultBundleIdentifierOptions);\n    this._assetMap = {};\n    this._preferredOrder = [];\n    this._resolverHash = {};\n    this._rootPath = null;\n    this._basePath = null;\n    this._manifest = null;\n    this._bundles = {};\n    this._defaultSearchParams = null;\n  }\n  /**\n   * Sets the default URL search parameters for the URL resolver. The urls can be specified as a string or an object.\n   * @param searchParams - the default url parameters to append when resolving urls\n   */\n  setDefaultSearchParams(searchParams) {\n    if (typeof searchParams === \"string\") {\n      this._defaultSearchParams = searchParams;\n    } else {\n      const queryValues = searchParams;\n      this._defaultSearchParams = Object.keys(queryValues).map((key) => `${encodeURIComponent(key)}=${encodeURIComponent(queryValues[key])}`).join(\"&\");\n    }\n  }\n  /**\n   * Returns the aliases for a given asset\n   * @param asset - the asset to get the aliases for\n   */\n  getAlias(asset) {\n    const { alias, src } = asset;\n    const aliasesToUse = convertToList(\n      alias || src,\n      (value) => {\n        if (typeof value === \"string\")\n          return value;\n        if (Array.isArray(value))\n          return value.map((v) => v?.src ?? v);\n        if (value?.src)\n          return value.src;\n        return value;\n      },\n      true\n    );\n    return aliasesToUse;\n  }\n  /**\n   * Add a manifest to the asset resolver. This is a nice way to add all the asset information in one go.\n   * generally a manifest would be built using a tool.\n   * @param manifest - the manifest to add to the resolver\n   */\n  addManifest(manifest) {\n    if (this._manifest) {\n      warn(\"[Resolver] Manifest already exists, this will be overwritten\");\n    }\n    this._manifest = manifest;\n    manifest.bundles.forEach((bundle) => {\n      this.addBundle(bundle.name, bundle.assets);\n    });\n  }\n  /**\n   * This adds a bundle of assets in one go so that you can resolve them as a group.\n   * For example you could add a bundle for each screen in you pixi app\n   * @example\n   * resolver.addBundle('animals', [\n   *  { alias: 'bunny', src: 'bunny.png' },\n   *  { alias: 'chicken', src: 'chicken.png' },\n   *  { alias: 'thumper', src: 'thumper.png' },\n   * ]);\n   * // or\n   * resolver.addBundle('animals', {\n   *     bunny: 'bunny.png',\n   *     chicken: 'chicken.png',\n   *     thumper: 'thumper.png',\n   * });\n   *\n   * const resolvedAssets = await resolver.resolveBundle('animals');\n   * @param bundleId - The id of the bundle to add\n   * @param assets - A record of the asset or assets that will be chosen from when loading via the specified key\n   */\n  addBundle(bundleId, assets) {\n    const assetNames = [];\n    let convertedAssets = assets;\n    if (!Array.isArray(assets)) {\n      convertedAssets = Object.entries(assets).map(([alias, src]) => {\n        if (typeof src === \"string\" || Array.isArray(src)) {\n          return { alias, src };\n        }\n        return { alias, ...src };\n      });\n    }\n    convertedAssets.forEach((asset) => {\n      const srcs = asset.src;\n      const aliases = asset.alias;\n      let ids;\n      if (typeof aliases === \"string\") {\n        const bundleAssetId = this._createBundleAssetId(bundleId, aliases);\n        assetNames.push(bundleAssetId);\n        ids = [aliases, bundleAssetId];\n      } else {\n        const bundleIds = aliases.map((name) => this._createBundleAssetId(bundleId, name));\n        assetNames.push(...bundleIds);\n        ids = [...aliases, ...bundleIds];\n      }\n      this.add({\n        ...asset,\n        ...{\n          alias: ids,\n          src: srcs\n        }\n      });\n    });\n    this._bundles[bundleId] = assetNames;\n  }\n  /**\n   * Tells the resolver what keys are associated with witch asset.\n   * The most important thing the resolver does\n   * @example\n   * // Single key, single asset:\n   * resolver.add({alias: 'foo', src: 'bar.png');\n   * resolver.resolveUrl('foo') // => 'bar.png'\n   *\n   * // Multiple keys, single asset:\n   * resolver.add({alias: ['foo', 'boo'], src: 'bar.png'});\n   * resolver.resolveUrl('foo') // => 'bar.png'\n   * resolver.resolveUrl('boo') // => 'bar.png'\n   *\n   * // Multiple keys, multiple assets:\n   * resolver.add({alias: ['foo', 'boo'], src: ['bar.png', 'bar.webp']});\n   * resolver.resolveUrl('foo') // => 'bar.png'\n   *\n   * // Add custom data attached to the resolver\n   * Resolver.add({\n   *     alias: 'bunnyBooBooSmooth',\n   *     src: 'bunny{png,webp}',\n   *     data: { scaleMode:SCALE_MODES.NEAREST }, // Base texture options\n   * });\n   *\n   * resolver.resolve('bunnyBooBooSmooth') // => { src: 'bunny.png', data: { scaleMode: SCALE_MODES.NEAREST } }\n   * @param aliases - the UnresolvedAsset or array of UnresolvedAssets to add to the resolver\n   */\n  add(aliases) {\n    const assets = [];\n    if (Array.isArray(aliases)) {\n      assets.push(...aliases);\n    } else {\n      assets.push(aliases);\n    }\n    let keyCheck;\n    keyCheck = (key) => {\n      if (this.hasKey(key)) {\n        warn(`[Resolver] already has key: ${key} overwriting`);\n      }\n    };\n    const assetArray = convertToList(assets);\n    assetArray.forEach((asset) => {\n      const { src } = asset;\n      let {\n        data,\n        format,\n        loadParser: userDefinedLoadParser,\n        parser: userDefinedParser\n      } = asset;\n      const srcsToUse = convertToList(src).map((src2) => {\n        if (typeof src2 === \"string\") {\n          return createStringVariations(src2);\n        }\n        return Array.isArray(src2) ? src2 : [src2];\n      });\n      const aliasesToUse = this.getAlias(asset);\n      Array.isArray(aliasesToUse) ? aliasesToUse.forEach(keyCheck) : keyCheck(aliasesToUse);\n      const resolvedAssets = [];\n      srcsToUse.forEach((srcs) => {\n        srcs.forEach((src2) => {\n          let formattedAsset = {};\n          if (typeof src2 !== \"object\") {\n            formattedAsset.src = src2;\n            for (let i = 0; i < this._parsers.length; i++) {\n              const parser = this._parsers[i];\n              if (parser.test(src2)) {\n                formattedAsset = parser.parse(src2);\n                break;\n              }\n            }\n          } else {\n            data = src2.data ?? data;\n            format = src2.format ?? format;\n            if (src2.loadParser || src2.parser) {\n              userDefinedLoadParser = src2.loadParser ?? userDefinedLoadParser;\n              userDefinedParser = src2.parser ?? userDefinedParser;\n            }\n            formattedAsset = {\n              ...formattedAsset,\n              ...src2\n            };\n          }\n          if (!aliasesToUse) {\n            throw new Error(`[Resolver] alias is undefined for this asset: ${formattedAsset.src}`);\n          }\n          formattedAsset = this._buildResolvedAsset(formattedAsset, {\n            aliases: aliasesToUse,\n            data,\n            format,\n            loadParser: userDefinedLoadParser,\n            parser: userDefinedParser,\n            progressSize: asset.progressSize\n          });\n          resolvedAssets.push(formattedAsset);\n        });\n      });\n      aliasesToUse.forEach((alias) => {\n        this._assetMap[alias] = resolvedAssets;\n      });\n    });\n  }\n  // TODO: this needs an overload like load did in Assets\n  /**\n   * If the resolver has had a manifest set via setManifest, this will return the assets urls for\n   * a given bundleId or bundleIds.\n   * @example\n   * // Manifest Example\n   * const manifest = {\n   *     bundles: [\n   *         {\n   *             name: 'load-screen',\n   *             assets: [\n   *                 {\n   *                     alias: 'background',\n   *                     src: 'sunset.png',\n   *                 },\n   *                 {\n   *                     alias: 'bar',\n   *                     src: 'load-bar.{png,webp}',\n   *                 },\n   *             ],\n   *         },\n   *         {\n   *             name: 'game-screen',\n   *             assets: [\n   *                 {\n   *                     alias: 'character',\n   *                     src: 'robot.png',\n   *                 },\n   *                 {\n   *                     alias: 'enemy',\n   *                     src: 'bad-guy.png',\n   *                 },\n   *             ],\n   *         },\n   *     ]\n   * };\n   *\n   * resolver.setManifest(manifest);\n   * const resolved = resolver.resolveBundle('load-screen');\n   * @param bundleIds - The bundle ids to resolve\n   * @returns All the bundles assets or a hash of assets for each bundle specified\n   */\n  resolveBundle(bundleIds) {\n    const singleAsset = isSingleItem(bundleIds);\n    bundleIds = convertToList(bundleIds);\n    const out = {};\n    bundleIds.forEach((bundleId) => {\n      const assetNames = this._bundles[bundleId];\n      if (assetNames) {\n        const results = this.resolve(assetNames);\n        const assets = {};\n        for (const key in results) {\n          const asset = results[key];\n          assets[this._extractAssetIdFromBundle(bundleId, key)] = asset;\n        }\n        out[bundleId] = assets;\n      }\n    });\n    return singleAsset ? out[bundleIds[0]] : out;\n  }\n  /**\n   * Does exactly what resolve does, but returns just the URL rather than the whole asset object\n   * @param key - The key or keys to resolve\n   * @returns - The URLs associated with the key(s)\n   */\n  resolveUrl(key) {\n    const result = this.resolve(key);\n    if (typeof key !== \"string\") {\n      const out = {};\n      for (const i in result) {\n        out[i] = result[i].src;\n      }\n      return out;\n    }\n    return result.src;\n  }\n  resolve(keys) {\n    const singleAsset = isSingleItem(keys);\n    keys = convertToList(keys);\n    const result = {};\n    keys.forEach((key) => {\n      if (!this._resolverHash[key]) {\n        if (this._assetMap[key]) {\n          let assets = this._assetMap[key];\n          const preferredOrder = this._getPreferredOrder(assets);\n          preferredOrder?.priority.forEach((priorityKey) => {\n            preferredOrder.params[priorityKey].forEach((value) => {\n              const filteredAssets = assets.filter((asset) => {\n                if (asset[priorityKey]) {\n                  return asset[priorityKey] === value;\n                }\n                return false;\n              });\n              if (filteredAssets.length) {\n                assets = filteredAssets;\n              }\n            });\n          });\n          this._resolverHash[key] = assets[0];\n        } else {\n          this._resolverHash[key] = this._buildResolvedAsset({\n            alias: [key],\n            src: key\n          }, {});\n        }\n      }\n      result[key] = this._resolverHash[key];\n    });\n    return singleAsset ? result[keys[0]] : result;\n  }\n  /**\n   * Checks if an asset with a given key exists in the resolver\n   * @param key - The key of the asset\n   */\n  hasKey(key) {\n    return !!this._assetMap[key];\n  }\n  /**\n   * Checks if a bundle with the given key exists in the resolver\n   * @param key - The key of the bundle\n   */\n  hasBundle(key) {\n    return !!this._bundles[key];\n  }\n  /**\n   * Internal function for figuring out what prefer criteria an asset should use.\n   * @param assets\n   */\n  _getPreferredOrder(assets) {\n    for (let i = 0; i < assets.length; i++) {\n      const asset = assets[i];\n      const preferred = this._preferredOrder.find((preference) => preference.params.format.includes(asset.format));\n      if (preferred) {\n        return preferred;\n      }\n    }\n    return this._preferredOrder[0];\n  }\n  /**\n   * Appends the default url parameters to the url\n   * @param url - The url to append the default parameters to\n   * @returns - The url with the default parameters appended\n   */\n  _appendDefaultSearchParams(url) {\n    if (!this._defaultSearchParams)\n      return url;\n    const paramConnector = /\\?/.test(url) ? \"&\" : \"?\";\n    return `${url}${paramConnector}${this._defaultSearchParams}`;\n  }\n  _buildResolvedAsset(formattedAsset, data) {\n    const { aliases, data: assetData, loadParser, parser, format, progressSize } = data;\n    if (this._basePath || this._rootPath) {\n      formattedAsset.src = path.toAbsolute(formattedAsset.src, this._basePath, this._rootPath);\n    }\n    formattedAsset.alias = aliases ?? formattedAsset.alias ?? [formattedAsset.src];\n    formattedAsset.src = this._appendDefaultSearchParams(formattedAsset.src);\n    formattedAsset.data = { ...assetData || {}, ...formattedAsset.data };\n    formattedAsset.loadParser = loadParser ?? formattedAsset.loadParser;\n    formattedAsset.parser = parser ?? formattedAsset.parser;\n    formattedAsset.format = format ?? formattedAsset.format ?? getUrlExtension(formattedAsset.src);\n    if (progressSize !== void 0) {\n      formattedAsset.progressSize = progressSize;\n    }\n    return formattedAsset;\n  }\n}\n/**\n * The prefix that denotes a URL is for a retina asset.\n * @default /@([0-9\\.]+)x/\n * @example `@2x`\n */\nResolver.RETINA_PREFIX = /@([0-9\\.]+)x/;\nfunction getUrlExtension(url) {\n  return url.split(\".\").pop().split(\"?\").shift().split(\"#\").shift();\n}\n\nexport { Resolver, getUrlExtension };\n//# sourceMappingURL=Resolver.mjs.map\n","\"use strict\";\nconst copySearchParams = (targetUrl, sourceUrl) => {\n  const searchParams = sourceUrl.split(\"?\")[1];\n  if (searchParams) {\n    targetUrl += `?${searchParams}`;\n  }\n  return targetUrl;\n};\n\nexport { copySearchParams };\n//# sourceMappingURL=copySearchParams.mjs.map\n","import { Rectangle } from '../maths/shapes/Rectangle.mjs';\nimport { TextureSource } from '../rendering/renderers/shared/texture/sources/TextureSource.mjs';\nimport { Texture } from '../rendering/renderers/shared/texture/Texture.mjs';\n\n\"use strict\";\nconst _Spritesheet = class _Spritesheet {\n  constructor(optionsOrTexture, arg1) {\n    /** For multi-packed spritesheets, this contains a reference to all the other spritesheets it depends on. */\n    this.linkedSheets = [];\n    let options = optionsOrTexture;\n    if (optionsOrTexture?.source instanceof TextureSource) {\n      options = {\n        texture: optionsOrTexture,\n        data: arg1\n      };\n    }\n    const { texture, data, cachePrefix = \"\" } = options;\n    this.cachePrefix = cachePrefix;\n    this._texture = texture instanceof Texture ? texture : null;\n    this.textureSource = texture.source;\n    this.textures = {};\n    this.animations = {};\n    this.data = data;\n    const metaResolution = parseFloat(data.meta.scale);\n    if (metaResolution) {\n      this.resolution = metaResolution;\n      texture.source.resolution = this.resolution;\n    } else {\n      this.resolution = texture.source._resolution;\n    }\n    this._frames = this.data.frames;\n    this._frameKeys = Object.keys(this._frames);\n    this._batchIndex = 0;\n    this._callback = null;\n  }\n  /**\n   * Parser spritesheet from loaded data. This is done asynchronously\n   * to prevent creating too many Texture within a single process.\n   */\n  parse() {\n    return new Promise((resolve) => {\n      this._callback = resolve;\n      this._batchIndex = 0;\n      if (this._frameKeys.length <= _Spritesheet.BATCH_SIZE) {\n        this._processFrames(0);\n        this._processAnimations();\n        this._parseComplete();\n      } else {\n        this._nextBatch();\n      }\n    });\n  }\n  /**\n   * Process a batch of frames\n   * @param initialFrameIndex - The index of frame to start.\n   */\n  _processFrames(initialFrameIndex) {\n    let frameIndex = initialFrameIndex;\n    const maxFrames = _Spritesheet.BATCH_SIZE;\n    while (frameIndex - initialFrameIndex < maxFrames && frameIndex < this._frameKeys.length) {\n      const i = this._frameKeys[frameIndex];\n      const data = this._frames[i];\n      const rect = data.frame;\n      if (rect) {\n        let frame = null;\n        let trim = null;\n        const sourceSize = data.trimmed !== false && data.sourceSize ? data.sourceSize : data.frame;\n        const orig = new Rectangle(\n          0,\n          0,\n          Math.floor(sourceSize.w) / this.resolution,\n          Math.floor(sourceSize.h) / this.resolution\n        );\n        if (data.rotated) {\n          frame = new Rectangle(\n            Math.floor(rect.x) / this.resolution,\n            Math.floor(rect.y) / this.resolution,\n            Math.floor(rect.h) / this.resolution,\n            Math.floor(rect.w) / this.resolution\n          );\n        } else {\n          frame = new Rectangle(\n            Math.floor(rect.x) / this.resolution,\n            Math.floor(rect.y) / this.resolution,\n            Math.floor(rect.w) / this.resolution,\n            Math.floor(rect.h) / this.resolution\n          );\n        }\n        if (data.trimmed !== false && data.spriteSourceSize) {\n          trim = new Rectangle(\n            Math.floor(data.spriteSourceSize.x) / this.resolution,\n            Math.floor(data.spriteSourceSize.y) / this.resolution,\n            Math.floor(rect.w) / this.resolution,\n            Math.floor(rect.h) / this.resolution\n          );\n        }\n        this.textures[i] = new Texture({\n          source: this.textureSource,\n          frame,\n          orig,\n          trim,\n          rotate: data.rotated ? 2 : 0,\n          defaultAnchor: data.anchor,\n          defaultBorders: data.borders,\n          label: i.toString()\n        });\n      }\n      frameIndex++;\n    }\n  }\n  /** Parse animations config. */\n  _processAnimations() {\n    const animations = this.data.animations || {};\n    for (const animName in animations) {\n      this.animations[animName] = [];\n      for (let i = 0; i < animations[animName].length; i++) {\n        const frameName = animations[animName][i];\n        this.animations[animName].push(this.textures[frameName]);\n      }\n    }\n  }\n  /** The parse has completed. */\n  _parseComplete() {\n    const callback = this._callback;\n    this._callback = null;\n    this._batchIndex = 0;\n    callback.call(this, this.textures);\n  }\n  /** Begin the next batch of textures. */\n  _nextBatch() {\n    this._processFrames(this._batchIndex * _Spritesheet.BATCH_SIZE);\n    this._batchIndex++;\n    setTimeout(() => {\n      if (this._batchIndex * _Spritesheet.BATCH_SIZE < this._frameKeys.length) {\n        this._nextBatch();\n      } else {\n        this._processAnimations();\n        this._parseComplete();\n      }\n    }, 0);\n  }\n  /**\n   * Destroy Spritesheet and don't use after this.\n   * @param {boolean} [destroyBase=false] - Whether to destroy the base texture as well\n   */\n  destroy(destroyBase = false) {\n    for (const i in this.textures) {\n      this.textures[i].destroy();\n    }\n    this._frames = null;\n    this._frameKeys = null;\n    this.data = null;\n    this.textures = null;\n    if (destroyBase) {\n      this._texture?.destroy();\n      this.textureSource.destroy();\n    }\n    this._texture = null;\n    this.textureSource = null;\n    this.linkedSheets = [];\n  }\n};\n/**\n * The maximum number of Textures to build per process.\n * @advanced\n */\n_Spritesheet.BATCH_SIZE = 1e3;\nlet Spritesheet = _Spritesheet;\n\nexport { Spritesheet };\n//# sourceMappingURL=Spritesheet.mjs.map\n","import { LoaderParserPriority } from '../assets/loader/parsers/LoaderParser.mjs';\nimport { Resolver } from '../assets/resolver/Resolver.mjs';\nimport { copySearchParams } from '../assets/utils/copySearchParams.mjs';\nimport { ExtensionType } from '../extensions/Extensions.mjs';\nimport { Texture } from '../rendering/renderers/shared/texture/Texture.mjs';\nimport { path } from '../utils/path.mjs';\nimport { Spritesheet } from './Spritesheet.mjs';\n\n\"use strict\";\nconst validImages = [\n  \"jpg\",\n  \"png\",\n  \"jpeg\",\n  \"avif\",\n  \"webp\",\n  \"basis\",\n  \"etc2\",\n  \"bc7\",\n  \"bc6h\",\n  \"bc5\",\n  \"bc4\",\n  \"bc3\",\n  \"bc2\",\n  \"bc1\",\n  \"eac\",\n  \"astc\"\n];\nfunction getCacheableAssets(keys, asset, ignoreMultiPack) {\n  const out = {};\n  keys.forEach((key) => {\n    out[key] = asset;\n  });\n  Object.keys(asset.textures).forEach((key) => {\n    out[`${asset.cachePrefix}${key}`] = asset.textures[key];\n  });\n  if (!ignoreMultiPack) {\n    const basePath = path.dirname(keys[0]);\n    asset.linkedSheets.forEach((item, i) => {\n      const out2 = getCacheableAssets([`${basePath}/${asset.data.meta.related_multi_packs[i]}`], item, true);\n      Object.assign(out, out2);\n    });\n  }\n  return out;\n}\nconst spritesheetAsset = {\n  extension: ExtensionType.Asset,\n  /** Handle the caching of the related Spritesheet Textures */\n  cache: {\n    test: (asset) => asset instanceof Spritesheet,\n    getCacheableAssets: (keys, asset) => getCacheableAssets(keys, asset, false)\n  },\n  /** Resolve the resolution of the asset. */\n  resolver: {\n    extension: {\n      type: ExtensionType.ResolveParser,\n      name: \"resolveSpritesheet\"\n    },\n    test: (value) => {\n      const tempURL = value.split(\"?\")[0];\n      const split = tempURL.split(\".\");\n      const extension = split.pop();\n      const format = split.pop();\n      return extension === \"json\" && validImages.includes(format);\n    },\n    parse: (value) => {\n      const split = value.split(\".\");\n      return {\n        resolution: parseFloat(Resolver.RETINA_PREFIX.exec(value)?.[1] ?? \"1\"),\n        format: split[split.length - 2],\n        src: value\n      };\n    }\n  },\n  /**\n   * Loader plugin that parses sprite sheets!\n   * once the JSON has been loaded this checks to see if the JSON is spritesheet data.\n   * If it is, we load the spritesheets image and parse the data into Spritesheet\n   * All textures in the sprite sheet are then added to the cache\n   */\n  loader: {\n    /** used for deprecation purposes */\n    name: \"spritesheetLoader\",\n    id: \"spritesheet\",\n    extension: {\n      type: ExtensionType.LoadParser,\n      priority: LoaderParserPriority.Normal,\n      name: \"spritesheetLoader\"\n    },\n    async testParse(asset, options) {\n      return path.extname(options.src).toLowerCase() === \".json\" && !!asset.frames;\n    },\n    async parse(asset, options, loader) {\n      const {\n        texture: imageTexture,\n        // if user need to use preloaded texture\n        imageFilename,\n        // if user need to use custom filename (not from jsonFile.meta.image)\n        textureOptions,\n        // if user need to set texture options on texture\n        cachePrefix\n        // if user need to use custom cache prefix\n      } = options?.data ?? {};\n      let basePath = path.dirname(options.src);\n      if (basePath && basePath.lastIndexOf(\"/\") !== basePath.length - 1) {\n        basePath += \"/\";\n      }\n      let texture;\n      if (imageTexture instanceof Texture) {\n        texture = imageTexture;\n      } else {\n        const imagePath = copySearchParams(basePath + (imageFilename ?? asset.meta.image), options.src);\n        const assets = await loader.load([{ src: imagePath, data: textureOptions }]);\n        texture = assets[imagePath];\n      }\n      const spritesheet = new Spritesheet({\n        texture: texture.source,\n        data: asset,\n        cachePrefix\n      });\n      await spritesheet.parse();\n      const multiPacks = asset?.meta?.related_multi_packs;\n      if (Array.isArray(multiPacks)) {\n        const promises = [];\n        for (const item of multiPacks) {\n          if (typeof item !== \"string\") {\n            continue;\n          }\n          let itemUrl = basePath + item;\n          if (options.data?.ignoreMultiPack) {\n            continue;\n          }\n          itemUrl = copySearchParams(itemUrl, options.src);\n          promises.push(loader.load({\n            src: itemUrl,\n            data: {\n              textureOptions,\n              ignoreMultiPack: true\n            }\n          }));\n        }\n        const res = await Promise.all(promises);\n        spritesheet.linkedSheets = res;\n        res.forEach((item) => {\n          item.linkedSheets = [spritesheet].concat(spritesheet.linkedSheets.filter((sp) => sp !== item));\n        });\n      }\n      return spritesheet;\n    },\n    async unload(spritesheet, _resolvedAsset, loader) {\n      await loader.unload(spritesheet.textureSource._sourceOrigin);\n      spritesheet.destroy(false);\n    }\n  }\n};\n\nexport { spritesheetAsset };\n//# sourceMappingURL=spritesheetAsset.mjs.map\n","import { extensions } from '../extensions/Extensions.mjs';\nimport { spritesheetAsset } from './spritesheetAsset.mjs';\n\n\"use strict\";\nextensions.add(spritesheetAsset);\n//# sourceMappingURL=init.mjs.map\n","\"use strict\";\nconst idCounts = /* @__PURE__ */ Object.create(null);\nconst idHash = /* @__PURE__ */ Object.create(null);\nfunction createIdFromString(value, groupId) {\n  let id = idHash[value];\n  if (id === void 0) {\n    if (idCounts[groupId] === void 0) {\n      idCounts[groupId] = 1;\n    }\n    idHash[value] = id = idCounts[groupId]++;\n  }\n  return id;\n}\n\nexport { createIdFromString };\n//# sourceMappingURL=createIdFromString.mjs.map\n","import { DOMAdapter } from '../../../../../environment/adapter.mjs';\n\n\"use strict\";\nlet context;\nfunction getTestContext() {\n  if (!context || context?.isContextLost()) {\n    const canvas = DOMAdapter.get().createCanvas();\n    context = canvas.getContext(\"webgl\", {});\n  }\n  return context;\n}\n\nexport { getTestContext };\n//# sourceMappingURL=getTestContext.mjs.map\n","import { getTestContext } from './getTestContext.mjs';\n\n\"use strict\";\nlet maxFragmentPrecision;\nfunction getMaxFragmentPrecision() {\n  if (!maxFragmentPrecision) {\n    maxFragmentPrecision = \"mediump\";\n    const gl = getTestContext();\n    if (gl) {\n      if (gl.getShaderPrecisionFormat) {\n        const shaderFragment = gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER, gl.HIGH_FLOAT);\n        maxFragmentPrecision = shaderFragment.precision ? \"highp\" : \"mediump\";\n      }\n    }\n  }\n  return maxFragmentPrecision;\n}\n\nexport { getMaxFragmentPrecision };\n//# sourceMappingURL=getMaxFragmentPrecision.mjs.map\n","\"use strict\";\nfunction addProgramDefines(src, isES300, isFragment) {\n  if (isES300)\n    return src;\n  if (isFragment) {\n    src = src.replace(\"out vec4 finalColor;\", \"\");\n    return `\n\n        #ifdef GL_ES // This checks if it is WebGL1\n        #define in varying\n        #define finalColor gl_FragColor\n        #define texture texture2D\n        #endif\n        ${src}\n        `;\n  }\n  return `\n\n        #ifdef GL_ES // This checks if it is WebGL1\n        #define in attribute\n        #define out varying\n        #endif\n        ${src}\n        `;\n}\n\nexport { addProgramDefines };\n//# sourceMappingURL=addProgramDefines.mjs.map\n","\"use strict\";\nfunction ensurePrecision(src, options, isFragment) {\n  const maxSupportedPrecision = isFragment ? options.maxSupportedFragmentPrecision : options.maxSupportedVertexPrecision;\n  if (src.substring(0, 9) !== \"precision\") {\n    let precision = isFragment ? options.requestedFragmentPrecision : options.requestedVertexPrecision;\n    if (precision === \"highp\" && maxSupportedPrecision !== \"highp\") {\n      precision = \"mediump\";\n    }\n    return `precision ${precision} float;\n${src}`;\n  } else if (maxSupportedPrecision !== \"highp\" && src.substring(0, 15) === \"precision highp\") {\n    return src.replace(\"precision highp\", \"precision mediump\");\n  }\n  return src;\n}\n\nexport { ensurePrecision };\n//# sourceMappingURL=ensurePrecision.mjs.map\n","\"use strict\";\nfunction insertVersion(src, isES300) {\n  if (!isES300)\n    return src;\n  return `#version 300 es\n${src}`;\n}\n\nexport { insertVersion };\n//# sourceMappingURL=insertVersion.mjs.map\n","\"use strict\";\nconst fragmentNameCache = {};\nconst VertexNameCache = {};\nfunction setProgramName(src, { name = `pixi-program` }, isFragment = true) {\n  name = name.replace(/\\s+/g, \"-\");\n  name += isFragment ? \"-fragment\" : \"-vertex\";\n  const nameCache = isFragment ? fragmentNameCache : VertexNameCache;\n  if (nameCache[name]) {\n    nameCache[name]++;\n    name += `-${nameCache[name]}`;\n  } else {\n    nameCache[name] = 1;\n  }\n  if (src.indexOf(\"#define SHADER_NAME\") !== -1)\n    return src;\n  const shaderName = `#define SHADER_NAME ${name}`;\n  return `${shaderName}\n${src}`;\n}\n\nexport { setProgramName };\n//# sourceMappingURL=setProgramName.mjs.map\n","\"use strict\";\nfunction stripVersion(src, isES300) {\n  if (!isES300)\n    return src;\n  return src.replace(\"#version 300 es\", \"\");\n}\n\nexport { stripVersion };\n//# sourceMappingURL=stripVersion.mjs.map\n","import { createIdFromString } from '../../shared/utils/createIdFromString.mjs';\nimport { getMaxFragmentPrecision } from './program/getMaxFragmentPrecision.mjs';\nimport { addProgramDefines } from './program/preprocessors/addProgramDefines.mjs';\nimport { ensurePrecision } from './program/preprocessors/ensurePrecision.mjs';\nimport { insertVersion } from './program/preprocessors/insertVersion.mjs';\nimport { setProgramName } from './program/preprocessors/setProgramName.mjs';\nimport { stripVersion } from './program/preprocessors/stripVersion.mjs';\n\n\"use strict\";\nconst processes = {\n  // strips any version headers..\n  stripVersion,\n  // adds precision string if not already present\n  ensurePrecision,\n  // add some defines if WebGL1 to make it more compatible with WebGL2 shaders\n  addProgramDefines,\n  // add the program name to the shader\n  setProgramName,\n  // add the version string to the shader header\n  insertVersion\n};\nconst programCache = /* @__PURE__ */ Object.create(null);\nconst _GlProgram = class _GlProgram {\n  /**\n   * Creates a shiny new GlProgram. Used by WebGL renderer.\n   * @param options - The options for the program.\n   */\n  constructor(options) {\n    options = { ..._GlProgram.defaultOptions, ...options };\n    const isES300 = options.fragment.indexOf(\"#version 300 es\") !== -1;\n    const preprocessorOptions = {\n      stripVersion: isES300,\n      ensurePrecision: {\n        requestedFragmentPrecision: options.preferredFragmentPrecision,\n        requestedVertexPrecision: options.preferredVertexPrecision,\n        maxSupportedVertexPrecision: \"highp\",\n        maxSupportedFragmentPrecision: getMaxFragmentPrecision()\n      },\n      setProgramName: {\n        name: options.name\n      },\n      addProgramDefines: isES300,\n      insertVersion: isES300\n    };\n    let fragment = options.fragment;\n    let vertex = options.vertex;\n    Object.keys(processes).forEach((processKey) => {\n      const processOptions = preprocessorOptions[processKey];\n      fragment = processes[processKey](fragment, processOptions, true);\n      vertex = processes[processKey](vertex, processOptions, false);\n    });\n    this.fragment = fragment;\n    this.vertex = vertex;\n    this.transformFeedbackVaryings = options.transformFeedbackVaryings;\n    this._key = createIdFromString(`${this.vertex}:${this.fragment}`, \"gl-program\");\n  }\n  /** destroys the program */\n  destroy() {\n    this.fragment = null;\n    this.vertex = null;\n    this._attributeData = null;\n    this._uniformData = null;\n    this._uniformBlockData = null;\n    this.transformFeedbackVaryings = null;\n    programCache[this._cacheKey] = null;\n  }\n  /**\n   * Helper function that creates a program for a given source.\n   * It will check the program cache if the program has already been created.\n   * If it has that one will be returned, if not a new one will be created and cached.\n   * @param options - The options for the program.\n   * @returns A program using the same source\n   */\n  static from(options) {\n    const key = `${options.vertex}:${options.fragment}`;\n    if (!programCache[key]) {\n      programCache[key] = new _GlProgram(options);\n      programCache[key]._cacheKey = key;\n    }\n    return programCache[key];\n  }\n};\n/** The default options used by the program. */\n_GlProgram.defaultOptions = {\n  preferredVertexPrecision: \"highp\",\n  preferredFragmentPrecision: \"mediump\"\n};\nlet GlProgram = _GlProgram;\n\nexport { GlProgram };\n//# sourceMappingURL=GlProgram.mjs.map\n","\"use strict\";\nconst attributeFormatData = {\n  uint8x2: { size: 2, stride: 2, normalised: false },\n  uint8x4: { size: 4, stride: 4, normalised: false },\n  sint8x2: { size: 2, stride: 2, normalised: false },\n  sint8x4: { size: 4, stride: 4, normalised: false },\n  unorm8x2: { size: 2, stride: 2, normalised: true },\n  unorm8x4: { size: 4, stride: 4, normalised: true },\n  snorm8x2: { size: 2, stride: 2, normalised: true },\n  snorm8x4: { size: 4, stride: 4, normalised: true },\n  uint16x2: { size: 2, stride: 4, normalised: false },\n  uint16x4: { size: 4, stride: 8, normalised: false },\n  sint16x2: { size: 2, stride: 4, normalised: false },\n  sint16x4: { size: 4, stride: 8, normalised: false },\n  unorm16x2: { size: 2, stride: 4, normalised: true },\n  unorm16x4: { size: 4, stride: 8, normalised: true },\n  snorm16x2: { size: 2, stride: 4, normalised: true },\n  snorm16x4: { size: 4, stride: 8, normalised: true },\n  float16x2: { size: 2, stride: 4, normalised: false },\n  float16x4: { size: 4, stride: 8, normalised: false },\n  float32: { size: 1, stride: 4, normalised: false },\n  float32x2: { size: 2, stride: 8, normalised: false },\n  float32x3: { size: 3, stride: 12, normalised: false },\n  float32x4: { size: 4, stride: 16, normalised: false },\n  uint32: { size: 1, stride: 4, normalised: false },\n  uint32x2: { size: 2, stride: 8, normalised: false },\n  uint32x3: { size: 3, stride: 12, normalised: false },\n  uint32x4: { size: 4, stride: 16, normalised: false },\n  sint32: { size: 1, stride: 4, normalised: false },\n  sint32x2: { size: 2, stride: 8, normalised: false },\n  sint32x3: { size: 3, stride: 12, normalised: false },\n  sint32x4: { size: 4, stride: 16, normalised: false }\n};\nfunction getAttributeInfoFromFormat(format) {\n  return attributeFormatData[format] ?? attributeFormatData.float32;\n}\n\nexport { getAttributeInfoFromFormat };\n//# sourceMappingURL=getAttributeInfoFromFormat.mjs.map\n","import { getAttributeInfoFromFormat } from '../../../shared/geometry/utils/getAttributeInfoFromFormat.mjs';\n\n\"use strict\";\nconst WGSL_TO_VERTEX_TYPES = {\n  f32: \"float32\",\n  \"vec2<f32>\": \"float32x2\",\n  \"vec3<f32>\": \"float32x3\",\n  \"vec4<f32>\": \"float32x4\",\n  vec2f: \"float32x2\",\n  vec3f: \"float32x3\",\n  vec4f: \"float32x4\",\n  i32: \"sint32\",\n  \"vec2<i32>\": \"sint32x2\",\n  \"vec3<i32>\": \"sint32x3\",\n  \"vec4<i32>\": \"sint32x4\",\n  u32: \"uint32\",\n  \"vec2<u32>\": \"uint32x2\",\n  \"vec3<u32>\": \"uint32x3\",\n  \"vec4<u32>\": \"uint32x4\",\n  bool: \"uint32\",\n  \"vec2<bool>\": \"uint32x2\",\n  \"vec3<bool>\": \"uint32x3\",\n  \"vec4<bool>\": \"uint32x4\"\n};\nfunction extractAttributesFromGpuProgram({ source, entryPoint }) {\n  const results = {};\n  const mainVertStart = source.indexOf(`fn ${entryPoint}`);\n  if (mainVertStart !== -1) {\n    const arrowFunctionStart = source.indexOf(\"->\", mainVertStart);\n    if (arrowFunctionStart !== -1) {\n      const functionArgsSubstring = source.substring(mainVertStart, arrowFunctionStart);\n      const inputsRegex = /@location\\((\\d+)\\)\\s+([a-zA-Z0-9_]+)\\s*:\\s*([a-zA-Z0-9_<>]+)(?:,|\\s|$)/g;\n      let match;\n      while ((match = inputsRegex.exec(functionArgsSubstring)) !== null) {\n        const format = WGSL_TO_VERTEX_TYPES[match[3]] ?? \"float32\";\n        results[match[2]] = {\n          location: parseInt(match[1], 10),\n          format,\n          stride: getAttributeInfoFromFormat(format).stride,\n          offset: 0,\n          instance: false,\n          start: 0\n        };\n      }\n    }\n  }\n  return results;\n}\n\nexport { extractAttributesFromGpuProgram };\n//# sourceMappingURL=extractAttributesFromGpuProgram.mjs.map\n","\"use strict\";\nfunction extractStructAndGroups(wgsl) {\n  const linePattern = /(^|[^/])@(group|binding)\\(\\d+\\)[^;]+;/g;\n  const groupPattern = /@group\\((\\d+)\\)/;\n  const bindingPattern = /@binding\\((\\d+)\\)/;\n  const namePattern = /var(<[^>]+>)? (\\w+)/;\n  const typePattern = /:\\s*(\\w+)/;\n  const structPattern = /struct\\s+(\\w+)\\s*{([^}]+)}/g;\n  const structMemberPattern = /(\\w+)\\s*:\\s*([\\w\\<\\>]+)/g;\n  const structName = /struct\\s+(\\w+)/;\n  const groups = wgsl.match(linePattern)?.map((item) => ({\n    group: parseInt(item.match(groupPattern)[1], 10),\n    binding: parseInt(item.match(bindingPattern)[1], 10),\n    name: item.match(namePattern)[2],\n    isUniform: item.match(namePattern)[1] === \"<uniform>\",\n    type: item.match(typePattern)[1]\n  }));\n  if (!groups) {\n    return {\n      groups: [],\n      structs: []\n    };\n  }\n  const structs = wgsl.match(structPattern)?.map((struct) => {\n    const name = struct.match(structName)[1];\n    const members = struct.match(structMemberPattern).reduce((acc, member) => {\n      const [name2, type] = member.split(\":\");\n      acc[name2.trim()] = type.trim();\n      return acc;\n    }, {});\n    if (!members) {\n      return null;\n    }\n    return { name, members };\n  }).filter(({ name }) => groups.some((group) => group.type === name)) ?? [];\n  return {\n    groups,\n    structs\n  };\n}\n\nexport { extractStructAndGroups };\n//# sourceMappingURL=extractStructAndGroups.mjs.map\n","\"use strict\";\nvar ShaderStage = /* @__PURE__ */ ((ShaderStage2) => {\n  ShaderStage2[ShaderStage2[\"VERTEX\"] = 1] = \"VERTEX\";\n  ShaderStage2[ShaderStage2[\"FRAGMENT\"] = 2] = \"FRAGMENT\";\n  ShaderStage2[ShaderStage2[\"COMPUTE\"] = 4] = \"COMPUTE\";\n  return ShaderStage2;\n})(ShaderStage || {});\n\nexport { ShaderStage };\n//# sourceMappingURL=const.mjs.map\n","import { ShaderStage } from '../../../shared/shader/const.mjs';\n\n\"use strict\";\nfunction generateGpuLayoutGroups({ groups }) {\n  const layout = [];\n  for (let i = 0; i < groups.length; i++) {\n    const group = groups[i];\n    if (!layout[group.group]) {\n      layout[group.group] = [];\n    }\n    if (group.isUniform) {\n      layout[group.group].push({\n        binding: group.binding,\n        visibility: ShaderStage.VERTEX | ShaderStage.FRAGMENT,\n        buffer: {\n          type: \"uniform\"\n        }\n      });\n    } else if (group.type === \"sampler\") {\n      layout[group.group].push({\n        binding: group.binding,\n        visibility: ShaderStage.FRAGMENT,\n        sampler: {\n          type: \"filtering\"\n        }\n      });\n    } else if (group.type === \"texture_2d\") {\n      layout[group.group].push({\n        binding: group.binding,\n        visibility: ShaderStage.FRAGMENT,\n        texture: {\n          sampleType: \"float\",\n          viewDimension: \"2d\",\n          multisampled: false\n        }\n      });\n    }\n  }\n  return layout;\n}\n\nexport { generateGpuLayoutGroups };\n//# sourceMappingURL=generateGpuLayoutGroups.mjs.map\n","\"use strict\";\nfunction generateLayoutHash({ groups }) {\n  const layout = [];\n  for (let i = 0; i < groups.length; i++) {\n    const group = groups[i];\n    if (!layout[group.group]) {\n      layout[group.group] = {};\n    }\n    layout[group.group][group.name] = group.binding;\n  }\n  return layout;\n}\n\nexport { generateLayoutHash };\n//# sourceMappingURL=generateLayoutHash.mjs.map\n","\"use strict\";\nfunction removeStructAndGroupDuplicates(vertexStructsAndGroups, fragmentStructsAndGroups) {\n  const structNameSet = /* @__PURE__ */ new Set();\n  const dupeGroupKeySet = /* @__PURE__ */ new Set();\n  const structs = [...vertexStructsAndGroups.structs, ...fragmentStructsAndGroups.structs].filter((struct) => {\n    if (structNameSet.has(struct.name)) {\n      return false;\n    }\n    structNameSet.add(struct.name);\n    return true;\n  });\n  const groups = [...vertexStructsAndGroups.groups, ...fragmentStructsAndGroups.groups].filter((group) => {\n    const key = `${group.name}-${group.binding}`;\n    if (dupeGroupKeySet.has(key)) {\n      return false;\n    }\n    dupeGroupKeySet.add(key);\n    return true;\n  });\n  return { structs, groups };\n}\n\nexport { removeStructAndGroupDuplicates };\n//# sourceMappingURL=removeStructAndGroupDuplicates.mjs.map\n","import { createIdFromString } from '../../shared/utils/createIdFromString.mjs';\nimport { extractAttributesFromGpuProgram } from './utils/extractAttributesFromGpuProgram.mjs';\nimport { extractStructAndGroups } from './utils/extractStructAndGroups.mjs';\nimport { generateGpuLayoutGroups } from './utils/generateGpuLayoutGroups.mjs';\nimport { generateLayoutHash } from './utils/generateLayoutHash.mjs';\nimport { removeStructAndGroupDuplicates } from './utils/removeStructAndGroupDuplicates.mjs';\n\n\"use strict\";\nconst programCache = /* @__PURE__ */ Object.create(null);\nclass GpuProgram {\n  /**\n   * Create a new GpuProgram\n   * @param options - The options for the gpu program\n   */\n  constructor(options) {\n    /** @internal */\n    this._layoutKey = 0;\n    /** @internal */\n    this._attributeLocationsKey = 0;\n    const { fragment, vertex, layout, gpuLayout, name } = options;\n    this.name = name;\n    this.fragment = fragment;\n    this.vertex = vertex;\n    if (fragment.source === vertex.source) {\n      const structsAndGroups = extractStructAndGroups(fragment.source);\n      this.structsAndGroups = structsAndGroups;\n    } else {\n      const vertexStructsAndGroups = extractStructAndGroups(vertex.source);\n      const fragmentStructsAndGroups = extractStructAndGroups(fragment.source);\n      this.structsAndGroups = removeStructAndGroupDuplicates(vertexStructsAndGroups, fragmentStructsAndGroups);\n    }\n    this.layout = layout ?? generateLayoutHash(this.structsAndGroups);\n    this.gpuLayout = gpuLayout ?? generateGpuLayoutGroups(this.structsAndGroups);\n    this.autoAssignGlobalUniforms = !!(this.layout[0]?.globalUniforms !== void 0);\n    this.autoAssignLocalUniforms = !!(this.layout[1]?.localUniforms !== void 0);\n    this._generateProgramKey();\n  }\n  // TODO maker this pure\n  _generateProgramKey() {\n    const { vertex, fragment } = this;\n    const bigKey = vertex.source + fragment.source + vertex.entryPoint + fragment.entryPoint;\n    this._layoutKey = createIdFromString(bigKey, \"program\");\n  }\n  get attributeData() {\n    this._attributeData ?? (this._attributeData = extractAttributesFromGpuProgram(this.vertex));\n    return this._attributeData;\n  }\n  /** destroys the program */\n  destroy() {\n    this.gpuLayout = null;\n    this.layout = null;\n    this.structsAndGroups = null;\n    this.fragment = null;\n    this.vertex = null;\n    programCache[this._cacheKey] = null;\n  }\n  /**\n   * Helper function that creates a program for a given source.\n   * It will check the program cache if the program has already been created.\n   * If it has that one will be returned, if not a new one will be created and cached.\n   * @param options - The options for the program.\n   * @returns A program using the same source\n   */\n  static from(options) {\n    const key = `${options.vertex.source}:${options.fragment.source}:${options.fragment.entryPoint}:${options.vertex.entryPoint}`;\n    if (!programCache[key]) {\n      programCache[key] = new GpuProgram(options);\n      programCache[key]._cacheKey = key;\n    }\n    return programCache[key];\n  }\n}\n\nexport { GpuProgram };\n//# sourceMappingURL=GpuProgram.mjs.map\n","\"use strict\";\nconst UNIFORM_TYPES_VALUES = [\n  \"f32\",\n  \"i32\",\n  \"vec2<f32>\",\n  \"vec3<f32>\",\n  \"vec4<f32>\",\n  \"mat2x2<f32>\",\n  \"mat3x3<f32>\",\n  \"mat4x4<f32>\",\n  \"mat3x2<f32>\",\n  \"mat4x2<f32>\",\n  \"mat2x3<f32>\",\n  \"mat4x3<f32>\",\n  \"mat2x4<f32>\",\n  \"mat3x4<f32>\",\n  \"vec2<i32>\",\n  \"vec3<i32>\",\n  \"vec4<i32>\"\n];\nconst UNIFORM_TYPES_MAP = UNIFORM_TYPES_VALUES.reduce((acc, type) => {\n  acc[type] = true;\n  return acc;\n}, {});\n\nexport { UNIFORM_TYPES_MAP, UNIFORM_TYPES_VALUES };\n//# sourceMappingURL=types.mjs.map\n","\"use strict\";\nfunction getDefaultUniformValue(type, size) {\n  switch (type) {\n    case \"f32\":\n      return 0;\n    case \"vec2<f32>\":\n      return new Float32Array(2 * size);\n    case \"vec3<f32>\":\n      return new Float32Array(3 * size);\n    case \"vec4<f32>\":\n      return new Float32Array(4 * size);\n    case \"mat2x2<f32>\":\n      return new Float32Array([\n        1,\n        0,\n        0,\n        1\n      ]);\n    case \"mat3x3<f32>\":\n      return new Float32Array([\n        1,\n        0,\n        0,\n        0,\n        1,\n        0,\n        0,\n        0,\n        1\n      ]);\n    case \"mat4x4<f32>\":\n      return new Float32Array([\n        1,\n        0,\n        0,\n        0,\n        0,\n        1,\n        0,\n        0,\n        0,\n        0,\n        1,\n        0,\n        0,\n        0,\n        0,\n        1\n      ]);\n  }\n  return null;\n}\n\nexport { getDefaultUniformValue };\n//# sourceMappingURL=getDefaultUniformValue.mjs.map\n","import { uid } from '../../../../utils/data/uid.mjs';\nimport { createIdFromString } from '../utils/createIdFromString.mjs';\nimport { UNIFORM_TYPES_MAP, UNIFORM_TYPES_VALUES } from './types.mjs';\nimport { getDefaultUniformValue } from './utils/getDefaultUniformValue.mjs';\n\n\"use strict\";\nconst _UniformGroup = class _UniformGroup {\n  /**\n   * Create a new Uniform group\n   * @param uniformStructures - The structures of the uniform group\n   * @param options - The optional parameters of this uniform group\n   */\n  constructor(uniformStructures, options) {\n    /**\n     * used internally to know if a uniform group was used in the last render pass\n     * @internal\n     */\n    this._touched = 0;\n    /** a unique id for this uniform group used through the renderer */\n    this.uid = uid(\"uniform\");\n    /**\n     * a resource type, used to identify how to handle it when its in a bind group / shader resource\n     * @internal\n     */\n    this._resourceType = \"uniformGroup\";\n    /**\n     * the resource id used internally by the renderer to build bind group keys\n     * @internal\n     */\n    this._resourceId = uid(\"resource\");\n    /** used ito identify if this is a uniform group */\n    this.isUniformGroup = true;\n    /**\n     * used to flag if this Uniform groups data is different from what it has stored in its buffer / on the GPU\n     * @internal\n     */\n    this._dirtyId = 0;\n    // implementing the interface - UniformGroup are not destroyed\n    this.destroyed = false;\n    options = { ..._UniformGroup.defaultOptions, ...options };\n    this.uniformStructures = uniformStructures;\n    const uniforms = {};\n    for (const i in uniformStructures) {\n      const uniformData = uniformStructures[i];\n      uniformData.name = i;\n      uniformData.size = uniformData.size ?? 1;\n      if (!UNIFORM_TYPES_MAP[uniformData.type]) {\n        const arrayMatch = uniformData.type.match(/^array<(\\w+(?:<\\w+>)?),\\s*(\\d+)>$/);\n        if (arrayMatch) {\n          const [, innerType, size] = arrayMatch;\n          throw new Error(\n            `Uniform type ${uniformData.type} is not supported. Use type: '${innerType}', size: ${size} instead.`\n          );\n        }\n        throw new Error(`Uniform type ${uniformData.type} is not supported. Supported uniform types are: ${UNIFORM_TYPES_VALUES.join(\", \")}`);\n      }\n      uniformData.value ?? (uniformData.value = getDefaultUniformValue(uniformData.type, uniformData.size));\n      uniforms[i] = uniformData.value;\n    }\n    this.uniforms = uniforms;\n    this._dirtyId = 1;\n    this.ubo = options.ubo;\n    this.isStatic = options.isStatic;\n    this._signature = createIdFromString(Object.keys(uniforms).map(\n      (i) => `${i}-${uniformStructures[i].type}`\n    ).join(\"-\"), \"uniform-group\");\n  }\n  /** Call this if you want the uniform groups data to be uploaded to the GPU only useful if `isStatic` is true. */\n  update() {\n    this._dirtyId++;\n  }\n};\n/** The default options used by the uniform group. */\n_UniformGroup.defaultOptions = {\n  /** if true the UniformGroup is handled as an Uniform buffer object. */\n  ubo: false,\n  /** if true, then you are responsible for when the data is uploaded to the GPU by calling `update()` */\n  isStatic: false\n};\nlet UniformGroup = _UniformGroup;\n\nexport { UniformGroup };\n//# sourceMappingURL=UniformGroup.mjs.map\n","\"use strict\";\nclass BindGroup {\n  /**\n   * Create a new instance eof the Bind Group.\n   * @param resources - The resources that are bound together for use by a shader.\n   */\n  constructor(resources) {\n    /** The resources that are bound together for use by a shader. */\n    this.resources = /* @__PURE__ */ Object.create(null);\n    this._dirty = true;\n    let index = 0;\n    for (const i in resources) {\n      const resource = resources[i];\n      this.setResource(resource, index++);\n    }\n    this._updateKey();\n  }\n  /**\n   * Updates the key if its flagged as dirty. This is used internally to\n   * match this bind group to a WebGPU BindGroup.\n   * @internal\n   */\n  _updateKey() {\n    if (!this._dirty)\n      return;\n    this._dirty = false;\n    const keyParts = [];\n    let index = 0;\n    for (const i in this.resources) {\n      keyParts[index++] = this.resources[i]._resourceId;\n    }\n    this._key = keyParts.join(\"|\");\n  }\n  /**\n   * Set a resource at a given index. this function will\n   * ensure that listeners will be removed from the current resource\n   * and added to the new resource.\n   * @param resource - The resource to set.\n   * @param index - The index to set the resource at.\n   */\n  setResource(resource, index) {\n    const currentResource = this.resources[index];\n    if (resource === currentResource)\n      return;\n    if (currentResource) {\n      resource.off?.(\"change\", this.onResourceChange, this);\n    }\n    resource.on?.(\"change\", this.onResourceChange, this);\n    this.resources[index] = resource;\n    this._dirty = true;\n  }\n  /**\n   * Returns the resource at the current specified index.\n   * @param index - The index of the resource to get.\n   * @returns - The resource at the specified index.\n   */\n  getResource(index) {\n    return this.resources[index];\n  }\n  /**\n   * Used internally to 'touch' each resource, to ensure that the GC\n   * knows that all resources in this bind group are still being used.\n   * @param tick - The current tick.\n   * @internal\n   */\n  _touch(tick) {\n    const resources = this.resources;\n    for (const i in resources) {\n      resources[i]._touched = tick;\n    }\n  }\n  /** Destroys this bind group and removes all listeners. */\n  destroy() {\n    const resources = this.resources;\n    for (const i in resources) {\n      const resource = resources[i];\n      resource?.off?.(\"change\", this.onResourceChange, this);\n    }\n    this.resources = null;\n  }\n  onResourceChange(resource) {\n    this._dirty = true;\n    if (resource.destroyed) {\n      const resources = this.resources;\n      for (const i in resources) {\n        if (resources[i] === resource) {\n          resources[i] = null;\n        }\n      }\n    } else {\n      this._updateKey();\n    }\n  }\n}\n\nexport { BindGroup };\n//# sourceMappingURL=BindGroup.mjs.map\n","\"use strict\";\nvar RendererType = /* @__PURE__ */ ((RendererType2) => {\n  RendererType2[RendererType2[\"WEBGL\"] = 1] = \"WEBGL\";\n  RendererType2[RendererType2[\"WEBGPU\"] = 2] = \"WEBGPU\";\n  RendererType2[RendererType2[\"BOTH\"] = 3] = \"BOTH\";\n  return RendererType2;\n})(RendererType || {});\n\nexport { RendererType };\n//# sourceMappingURL=types.mjs.map\n","import EventEmitter from 'eventemitter3';\nimport { uid } from '../../../../utils/data/uid.mjs';\nimport { GlProgram } from '../../gl/shader/GlProgram.mjs';\nimport { BindGroup } from '../../gpu/shader/BindGroup.mjs';\nimport { GpuProgram } from '../../gpu/shader/GpuProgram.mjs';\nimport { RendererType } from '../../types.mjs';\nimport { UniformGroup } from './UniformGroup.mjs';\n\n\"use strict\";\nclass Shader extends EventEmitter {\n  constructor(options) {\n    super();\n    /** A unique identifier for the shader */\n    this.uid = uid(\"shader\");\n    /**\n     * A record of the uniform groups and resources used by the shader.\n     * This is used by WebGL renderer to sync uniform data.\n     * @internal\n     */\n    this._uniformBindMap = /* @__PURE__ */ Object.create(null);\n    this._ownedBindGroups = [];\n    let {\n      gpuProgram,\n      glProgram,\n      groups,\n      resources,\n      compatibleRenderers,\n      groupMap\n    } = options;\n    this.gpuProgram = gpuProgram;\n    this.glProgram = glProgram;\n    if (compatibleRenderers === void 0) {\n      compatibleRenderers = 0;\n      if (gpuProgram)\n        compatibleRenderers |= RendererType.WEBGPU;\n      if (glProgram)\n        compatibleRenderers |= RendererType.WEBGL;\n    }\n    this.compatibleRenderers = compatibleRenderers;\n    const nameHash = {};\n    if (!resources && !groups) {\n      resources = {};\n    }\n    if (resources && groups) {\n      throw new Error(\"[Shader] Cannot have both resources and groups\");\n    } else if (!gpuProgram && groups && !groupMap) {\n      throw new Error(\"[Shader] No group map or WebGPU shader provided - consider using resources instead.\");\n    } else if (!gpuProgram && groups && groupMap) {\n      for (const i in groupMap) {\n        for (const j in groupMap[i]) {\n          const uniformName = groupMap[i][j];\n          nameHash[uniformName] = {\n            group: i,\n            binding: j,\n            name: uniformName\n          };\n        }\n      }\n    } else if (gpuProgram && groups && !groupMap) {\n      const groupData = gpuProgram.structsAndGroups.groups;\n      groupMap = {};\n      groupData.forEach((data) => {\n        groupMap[data.group] = groupMap[data.group] || {};\n        groupMap[data.group][data.binding] = data.name;\n        nameHash[data.name] = data;\n      });\n    } else if (resources) {\n      groups = {};\n      groupMap = {};\n      if (gpuProgram) {\n        const groupData = gpuProgram.structsAndGroups.groups;\n        groupData.forEach((data) => {\n          groupMap[data.group] = groupMap[data.group] || {};\n          groupMap[data.group][data.binding] = data.name;\n          nameHash[data.name] = data;\n        });\n      }\n      let bindTick = 0;\n      for (const i in resources) {\n        if (nameHash[i])\n          continue;\n        if (!groups[99]) {\n          groups[99] = new BindGroup();\n          this._ownedBindGroups.push(groups[99]);\n        }\n        nameHash[i] = { group: 99, binding: bindTick, name: i };\n        groupMap[99] = groupMap[99] || {};\n        groupMap[99][bindTick] = i;\n        bindTick++;\n      }\n      for (const i in resources) {\n        const name = i;\n        let value = resources[i];\n        if (!value.source && !value._resourceType) {\n          value = new UniformGroup(value);\n        }\n        const data = nameHash[name];\n        if (data) {\n          if (!groups[data.group]) {\n            groups[data.group] = new BindGroup();\n            this._ownedBindGroups.push(groups[data.group]);\n          }\n          groups[data.group].setResource(value, data.binding);\n        }\n      }\n    }\n    this.groups = groups;\n    this._uniformBindMap = groupMap;\n    this.resources = this._buildResourceAccessor(groups, nameHash);\n  }\n  /**\n   * Sometimes a resource group will be provided later (for example global uniforms)\n   * In such cases, this method can be used to let the shader know about the group.\n   * @param name - the name of the resource group\n   * @param groupIndex - the index of the group (should match the webGPU shader group location)\n   * @param bindIndex - the index of the bind point (should match the webGPU shader bind point)\n   */\n  addResource(name, groupIndex, bindIndex) {\n    var _a, _b;\n    (_a = this._uniformBindMap)[groupIndex] || (_a[groupIndex] = {});\n    (_b = this._uniformBindMap[groupIndex])[bindIndex] || (_b[bindIndex] = name);\n    if (!this.groups[groupIndex]) {\n      this.groups[groupIndex] = new BindGroup();\n      this._ownedBindGroups.push(this.groups[groupIndex]);\n    }\n  }\n  _buildResourceAccessor(groups, nameHash) {\n    const uniformsOut = {};\n    for (const i in nameHash) {\n      const data = nameHash[i];\n      Object.defineProperty(uniformsOut, data.name, {\n        get() {\n          return groups[data.group].getResource(data.binding);\n        },\n        set(value) {\n          groups[data.group].setResource(value, data.binding);\n        }\n      });\n    }\n    return uniformsOut;\n  }\n  /**\n   * Use to destroy the shader when its not longer needed.\n   * It will destroy the resources and remove listeners.\n   * @param destroyPrograms - if the programs should be destroyed as well.\n   * Make sure its not being used by other shaders!\n   */\n  destroy(destroyPrograms = false) {\n    this.emit(\"destroy\", this);\n    if (destroyPrograms) {\n      this.gpuProgram?.destroy();\n      this.glProgram?.destroy();\n    }\n    this.gpuProgram = null;\n    this.glProgram = null;\n    this.removeAllListeners();\n    this._uniformBindMap = null;\n    this._ownedBindGroups.forEach((bindGroup) => {\n      bindGroup.destroy();\n    });\n    this._ownedBindGroups = null;\n    this.resources = null;\n    this.groups = null;\n  }\n  static from(options) {\n    const { gpu, gl, ...rest } = options;\n    let gpuProgram;\n    let glProgram;\n    if (gpu) {\n      gpuProgram = GpuProgram.from(gpu);\n    }\n    if (gl) {\n      glProgram = GlProgram.from(gl);\n    }\n    return new Shader({\n      gpuProgram,\n      glProgram,\n      ...rest\n    });\n  }\n}\n\nexport { Shader };\n//# sourceMappingURL=Shader.mjs.map\n","import { extensions, ExtensionType } from '../extensions/Extensions.mjs';\n\n\"use strict\";\nconst environments = [];\nextensions.handleByNamedList(ExtensionType.Environment, environments);\nasync function loadEnvironmentExtensions(skip) {\n  if (skip)\n    return;\n  for (let i = 0; i < environments.length; i++) {\n    const env = environments[i];\n    if (env.value.test()) {\n      await env.value.load();\n      return;\n    }\n  }\n}\nasync function autoDetectEnvironment(add) {\n  return loadEnvironmentExtensions(!add);\n}\n\nexport { autoDetectEnvironment, loadEnvironmentExtensions };\n//# sourceMappingURL=autoDetectEnvironment.mjs.map\n","\"use strict\";\nlet unsafeEval;\nfunction unsafeEvalSupported() {\n  if (typeof unsafeEval === \"boolean\") {\n    return unsafeEval;\n  }\n  try {\n    const func = new Function(\"param1\", \"param2\", \"param3\", \"return param1[param2] === param3;\");\n    unsafeEval = func({ a: \"b\" }, \"a\", \"b\") === true;\n  } catch (_e) {\n    unsafeEval = false;\n  }\n  return unsafeEval;\n}\n\nexport { unsafeEvalSupported };\n//# sourceMappingURL=unsafeEvalSupported.mjs.map\n","\nexport default function earcut(data, holeIndices, dim = 2) {\n\n    const hasHoles = holeIndices && holeIndices.length;\n    const outerLen = hasHoles ? holeIndices[0] * dim : data.length;\n    let outerNode = linkedList(data, 0, outerLen, dim, true);\n    const triangles = [];\n\n    if (!outerNode || outerNode.next === outerNode.prev) return triangles;\n\n    let minX, minY, invSize;\n\n    if (hasHoles) outerNode = eliminateHoles(data, holeIndices, outerNode, dim);\n\n    // if the shape is not too simple, we'll use z-order curve hash later; calculate polygon bbox\n    if (data.length > 80 * dim) {\n        minX = data[0];\n        minY = data[1];\n        let maxX = minX;\n        let maxY = minY;\n\n        for (let i = dim; i < outerLen; i += dim) {\n            const x = data[i];\n            const y = data[i + 1];\n            if (x < minX) minX = x;\n            if (y < minY) minY = y;\n            if (x > maxX) maxX = x;\n            if (y > maxY) maxY = y;\n        }\n\n        // minX, minY and invSize are later used to transform coords into integers for z-order calculation\n        invSize = Math.max(maxX - minX, maxY - minY);\n        invSize = invSize !== 0 ? 32767 / invSize : 0;\n    }\n\n    earcutLinked(outerNode, triangles, dim, minX, minY, invSize, 0);\n\n    return triangles;\n}\n\n// create a circular doubly linked list from polygon points in the specified winding order\nfunction linkedList(data, start, end, dim, clockwise) {\n    let last;\n\n    if (clockwise === (signedArea(data, start, end, dim) > 0)) {\n        for (let i = start; i < end; i += dim) last = insertNode(i / dim | 0, data[i], data[i + 1], last);\n    } else {\n        for (let i = end - dim; i >= start; i -= dim) last = insertNode(i / dim | 0, data[i], data[i + 1], last);\n    }\n\n    if (last && equals(last, last.next)) {\n        removeNode(last);\n        last = last.next;\n    }\n\n    return last;\n}\n\n// eliminate colinear or duplicate points\nfunction filterPoints(start, end) {\n    if (!start) return start;\n    if (!end) end = start;\n\n    let p = start,\n        again;\n    do {\n        again = false;\n\n        if (!p.steiner && (equals(p, p.next) || area(p.prev, p, p.next) === 0)) {\n            removeNode(p);\n            p = end = p.prev;\n            if (p === p.next) break;\n            again = true;\n\n        } else {\n            p = p.next;\n        }\n    } while (again || p !== end);\n\n    return end;\n}\n\n// main ear slicing loop which triangulates a polygon (given as a linked list)\nfunction earcutLinked(ear, triangles, dim, minX, minY, invSize, pass) {\n    if (!ear) return;\n\n    // interlink polygon nodes in z-order\n    if (!pass && invSize) indexCurve(ear, minX, minY, invSize);\n\n    let stop = ear;\n\n    // iterate through ears, slicing them one by one\n    while (ear.prev !== ear.next) {\n        const prev = ear.prev;\n        const next = ear.next;\n\n        if (invSize ? isEarHashed(ear, minX, minY, invSize) : isEar(ear)) {\n            triangles.push(prev.i, ear.i, next.i); // cut off the triangle\n\n            removeNode(ear);\n\n            // skipping the next vertex leads to less sliver triangles\n            ear = next.next;\n            stop = next.next;\n\n            continue;\n        }\n\n        ear = next;\n\n        // if we looped through the whole remaining polygon and can't find any more ears\n        if (ear === stop) {\n            // try filtering points and slicing again\n            if (!pass) {\n                earcutLinked(filterPoints(ear), triangles, dim, minX, minY, invSize, 1);\n\n            // if this didn't work, try curing all small self-intersections locally\n            } else if (pass === 1) {\n                ear = cureLocalIntersections(filterPoints(ear), triangles);\n                earcutLinked(ear, triangles, dim, minX, minY, invSize, 2);\n\n            // as a last resort, try splitting the remaining polygon into two\n            } else if (pass === 2) {\n                splitEarcut(ear, triangles, dim, minX, minY, invSize);\n            }\n\n            break;\n        }\n    }\n}\n\n// check whether a polygon node forms a valid ear with adjacent nodes\nfunction isEar(ear) {\n    const a = ear.prev,\n        b = ear,\n        c = ear.next;\n\n    if (area(a, b, c) >= 0) return false; // reflex, can't be an ear\n\n    // now make sure we don't have other points inside the potential ear\n    const ax = a.x, bx = b.x, cx = c.x, ay = a.y, by = b.y, cy = c.y;\n\n    // triangle bbox\n    const x0 = Math.min(ax, bx, cx),\n        y0 = Math.min(ay, by, cy),\n        x1 = Math.max(ax, bx, cx),\n        y1 = Math.max(ay, by, cy);\n\n    let p = c.next;\n    while (p !== a) {\n        if (p.x >= x0 && p.x <= x1 && p.y >= y0 && p.y <= y1 &&\n            pointInTriangleExceptFirst(ax, ay, bx, by, cx, cy, p.x, p.y) &&\n            area(p.prev, p, p.next) >= 0) return false;\n        p = p.next;\n    }\n\n    return true;\n}\n\nfunction isEarHashed(ear, minX, minY, invSize) {\n    const a = ear.prev,\n        b = ear,\n        c = ear.next;\n\n    if (area(a, b, c) >= 0) return false; // reflex, can't be an ear\n\n    const ax = a.x, bx = b.x, cx = c.x, ay = a.y, by = b.y, cy = c.y;\n\n    // triangle bbox\n    const x0 = Math.min(ax, bx, cx),\n        y0 = Math.min(ay, by, cy),\n        x1 = Math.max(ax, bx, cx),\n        y1 = Math.max(ay, by, cy);\n\n    // z-order range for the current triangle bbox;\n    const minZ = zOrder(x0, y0, minX, minY, invSize),\n        maxZ = zOrder(x1, y1, minX, minY, invSize);\n\n    let p = ear.prevZ,\n        n = ear.nextZ;\n\n    // look for points inside the triangle in both directions\n    while (p && p.z >= minZ && n && n.z <= maxZ) {\n        if (p.x >= x0 && p.x <= x1 && p.y >= y0 && p.y <= y1 && p !== a && p !== c &&\n            pointInTriangleExceptFirst(ax, ay, bx, by, cx, cy, p.x, p.y) && area(p.prev, p, p.next) >= 0) return false;\n        p = p.prevZ;\n\n        if (n.x >= x0 && n.x <= x1 && n.y >= y0 && n.y <= y1 && n !== a && n !== c &&\n            pointInTriangleExceptFirst(ax, ay, bx, by, cx, cy, n.x, n.y) && area(n.prev, n, n.next) >= 0) return false;\n        n = n.nextZ;\n    }\n\n    // look for remaining points in decreasing z-order\n    while (p && p.z >= minZ) {\n        if (p.x >= x0 && p.x <= x1 && p.y >= y0 && p.y <= y1 && p !== a && p !== c &&\n            pointInTriangleExceptFirst(ax, ay, bx, by, cx, cy, p.x, p.y) && area(p.prev, p, p.next) >= 0) return false;\n        p = p.prevZ;\n    }\n\n    // look for remaining points in increasing z-order\n    while (n && n.z <= maxZ) {\n        if (n.x >= x0 && n.x <= x1 && n.y >= y0 && n.y <= y1 && n !== a && n !== c &&\n            pointInTriangleExceptFirst(ax, ay, bx, by, cx, cy, n.x, n.y) && area(n.prev, n, n.next) >= 0) return false;\n        n = n.nextZ;\n    }\n\n    return true;\n}\n\n// go through all polygon nodes and cure small local self-intersections\nfunction cureLocalIntersections(start, triangles) {\n    let p = start;\n    do {\n        const a = p.prev,\n            b = p.next.next;\n\n        if (!equals(a, b) && intersects(a, p, p.next, b) && locallyInside(a, b) && locallyInside(b, a)) {\n\n            triangles.push(a.i, p.i, b.i);\n\n            // remove two nodes involved\n            removeNode(p);\n            removeNode(p.next);\n\n            p = start = b;\n        }\n        p = p.next;\n    } while (p !== start);\n\n    return filterPoints(p);\n}\n\n// try splitting polygon into two and triangulate them independently\nfunction splitEarcut(start, triangles, dim, minX, minY, invSize) {\n    // look for a valid diagonal that divides the polygon into two\n    let a = start;\n    do {\n        let b = a.next.next;\n        while (b !== a.prev) {\n            if (a.i !== b.i && isValidDiagonal(a, b)) {\n                // split the polygon in two by the diagonal\n                let c = splitPolygon(a, b);\n\n                // filter colinear points around the cuts\n                a = filterPoints(a, a.next);\n                c = filterPoints(c, c.next);\n\n                // run earcut on each half\n                earcutLinked(a, triangles, dim, minX, minY, invSize, 0);\n                earcutLinked(c, triangles, dim, minX, minY, invSize, 0);\n                return;\n            }\n            b = b.next;\n        }\n        a = a.next;\n    } while (a !== start);\n}\n\n// link every hole into the outer loop, producing a single-ring polygon without holes\nfunction eliminateHoles(data, holeIndices, outerNode, dim) {\n    const queue = [];\n\n    for (let i = 0, len = holeIndices.length; i < len; i++) {\n        const start = holeIndices[i] * dim;\n        const end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;\n        const list = linkedList(data, start, end, dim, false);\n        if (list === list.next) list.steiner = true;\n        queue.push(getLeftmost(list));\n    }\n\n    queue.sort(compareXYSlope);\n\n    // process holes from left to right\n    for (let i = 0; i < queue.length; i++) {\n        outerNode = eliminateHole(queue[i], outerNode);\n    }\n\n    return outerNode;\n}\n\nfunction compareXYSlope(a, b) {\n    let result = a.x - b.x;\n    // when the left-most point of 2 holes meet at a vertex, sort the holes counterclockwise so that when we find\n    // the bridge to the outer shell is always the point that they meet at.\n    if (result === 0) {\n        result = a.y - b.y;\n        if (result === 0) {\n            const aSlope = (a.next.y - a.y) / (a.next.x - a.x);\n            const bSlope = (b.next.y - b.y) / (b.next.x - b.x);\n            result = aSlope - bSlope;\n        }\n    }\n    return result;\n}\n\n// find a bridge between vertices that connects hole with an outer ring and link it\nfunction eliminateHole(hole, outerNode) {\n    const bridge = findHoleBridge(hole, outerNode);\n    if (!bridge) {\n        return outerNode;\n    }\n\n    const bridgeReverse = splitPolygon(bridge, hole);\n\n    // filter collinear points around the cuts\n    filterPoints(bridgeReverse, bridgeReverse.next);\n    return filterPoints(bridge, bridge.next);\n}\n\n// David Eberly's algorithm for finding a bridge between hole and outer polygon\nfunction findHoleBridge(hole, outerNode) {\n    let p = outerNode;\n    const hx = hole.x;\n    const hy = hole.y;\n    let qx = -Infinity;\n    let m;\n\n    // find a segment intersected by a ray from the hole's leftmost point to the left;\n    // segment's endpoint with lesser x will be potential connection point\n    // unless they intersect at a vertex, then choose the vertex\n    if (equals(hole, p)) return p;\n    do {\n        if (equals(hole, p.next)) return p.next;\n        else if (hy <= p.y && hy >= p.next.y && p.next.y !== p.y) {\n            const x = p.x + (hy - p.y) * (p.next.x - p.x) / (p.next.y - p.y);\n            if (x <= hx && x > qx) {\n                qx = x;\n                m = p.x < p.next.x ? p : p.next;\n                if (x === hx) return m; // hole touches outer segment; pick leftmost endpoint\n            }\n        }\n        p = p.next;\n    } while (p !== outerNode);\n\n    if (!m) return null;\n\n    // look for points inside the triangle of hole point, segment intersection and endpoint;\n    // if there are no points found, we have a valid connection;\n    // otherwise choose the point of the minimum angle with the ray as connection point\n\n    const stop = m;\n    const mx = m.x;\n    const my = m.y;\n    let tanMin = Infinity;\n\n    p = m;\n\n    do {\n        if (hx >= p.x && p.x >= mx && hx !== p.x &&\n                pointInTriangle(hy < my ? hx : qx, hy, mx, my, hy < my ? qx : hx, hy, p.x, p.y)) {\n\n            const tan = Math.abs(hy - p.y) / (hx - p.x); // tangential\n\n            if (locallyInside(p, hole) &&\n                (tan < tanMin || (tan === tanMin && (p.x > m.x || (p.x === m.x && sectorContainsSector(m, p)))))) {\n                m = p;\n                tanMin = tan;\n            }\n        }\n\n        p = p.next;\n    } while (p !== stop);\n\n    return m;\n}\n\n// whether sector in vertex m contains sector in vertex p in the same coordinates\nfunction sectorContainsSector(m, p) {\n    return area(m.prev, m, p.prev) < 0 && area(p.next, m, m.next) < 0;\n}\n\n// interlink polygon nodes in z-order\nfunction indexCurve(start, minX, minY, invSize) {\n    let p = start;\n    do {\n        if (p.z === 0) p.z = zOrder(p.x, p.y, minX, minY, invSize);\n        p.prevZ = p.prev;\n        p.nextZ = p.next;\n        p = p.next;\n    } while (p !== start);\n\n    p.prevZ.nextZ = null;\n    p.prevZ = null;\n\n    sortLinked(p);\n}\n\n// Simon Tatham's linked list merge sort algorithm\n// http://www.chiark.greenend.org.uk/~sgtatham/algorithms/listsort.html\nfunction sortLinked(list) {\n    let numMerges;\n    let inSize = 1;\n\n    do {\n        let p = list;\n        let e;\n        list = null;\n        let tail = null;\n        numMerges = 0;\n\n        while (p) {\n            numMerges++;\n            let q = p;\n            let pSize = 0;\n            for (let i = 0; i < inSize; i++) {\n                pSize++;\n                q = q.nextZ;\n                if (!q) break;\n            }\n            let qSize = inSize;\n\n            while (pSize > 0 || (qSize > 0 && q)) {\n\n                if (pSize !== 0 && (qSize === 0 || !q || p.z <= q.z)) {\n                    e = p;\n                    p = p.nextZ;\n                    pSize--;\n                } else {\n                    e = q;\n                    q = q.nextZ;\n                    qSize--;\n                }\n\n                if (tail) tail.nextZ = e;\n                else list = e;\n\n                e.prevZ = tail;\n                tail = e;\n            }\n\n            p = q;\n        }\n\n        tail.nextZ = null;\n        inSize *= 2;\n\n    } while (numMerges > 1);\n\n    return list;\n}\n\n// z-order of a point given coords and inverse of the longer side of data bbox\nfunction zOrder(x, y, minX, minY, invSize) {\n    // coords are transformed into non-negative 15-bit integer range\n    x = (x - minX) * invSize | 0;\n    y = (y - minY) * invSize | 0;\n\n    x = (x | (x << 8)) & 0x00FF00FF;\n    x = (x | (x << 4)) & 0x0F0F0F0F;\n    x = (x | (x << 2)) & 0x33333333;\n    x = (x | (x << 1)) & 0x55555555;\n\n    y = (y | (y << 8)) & 0x00FF00FF;\n    y = (y | (y << 4)) & 0x0F0F0F0F;\n    y = (y | (y << 2)) & 0x33333333;\n    y = (y | (y << 1)) & 0x55555555;\n\n    return x | (y << 1);\n}\n\n// find the leftmost node of a polygon ring\nfunction getLeftmost(start) {\n    let p = start,\n        leftmost = start;\n    do {\n        if (p.x < leftmost.x || (p.x === leftmost.x && p.y < leftmost.y)) leftmost = p;\n        p = p.next;\n    } while (p !== start);\n\n    return leftmost;\n}\n\n// check if a point lies within a convex triangle\nfunction pointInTriangle(ax, ay, bx, by, cx, cy, px, py) {\n    return (cx - px) * (ay - py) >= (ax - px) * (cy - py) &&\n           (ax - px) * (by - py) >= (bx - px) * (ay - py) &&\n           (bx - px) * (cy - py) >= (cx - px) * (by - py);\n}\n\n// check if a point lies within a convex triangle but false if its equal to the first point of the triangle\nfunction pointInTriangleExceptFirst(ax, ay, bx, by, cx, cy, px, py) {\n    return !(ax === px && ay === py) && pointInTriangle(ax, ay, bx, by, cx, cy, px, py);\n}\n\n// check if a diagonal between two polygon nodes is valid (lies in polygon interior)\nfunction isValidDiagonal(a, b) {\n    return a.next.i !== b.i && a.prev.i !== b.i && !intersectsPolygon(a, b) && // doesn't intersect other edges\n           (locallyInside(a, b) && locallyInside(b, a) && middleInside(a, b) && // locally visible\n            (area(a.prev, a, b.prev) || area(a, b.prev, b)) || // does not create opposite-facing sectors\n            equals(a, b) && area(a.prev, a, a.next) > 0 && area(b.prev, b, b.next) > 0); // special zero-length case\n}\n\n// signed area of a triangle\nfunction area(p, q, r) {\n    return (q.y - p.y) * (r.x - q.x) - (q.x - p.x) * (r.y - q.y);\n}\n\n// check if two points are equal\nfunction equals(p1, p2) {\n    return p1.x === p2.x && p1.y === p2.y;\n}\n\n// check if two segments intersect\nfunction intersects(p1, q1, p2, q2) {\n    const o1 = sign(area(p1, q1, p2));\n    const o2 = sign(area(p1, q1, q2));\n    const o3 = sign(area(p2, q2, p1));\n    const o4 = sign(area(p2, q2, q1));\n\n    if (o1 !== o2 && o3 !== o4) return true; // general case\n\n    if (o1 === 0 && onSegment(p1, p2, q1)) return true; // p1, q1 and p2 are collinear and p2 lies on p1q1\n    if (o2 === 0 && onSegment(p1, q2, q1)) return true; // p1, q1 and q2 are collinear and q2 lies on p1q1\n    if (o3 === 0 && onSegment(p2, p1, q2)) return true; // p2, q2 and p1 are collinear and p1 lies on p2q2\n    if (o4 === 0 && onSegment(p2, q1, q2)) return true; // p2, q2 and q1 are collinear and q1 lies on p2q2\n\n    return false;\n}\n\n// for collinear points p, q, r, check if point q lies on segment pr\nfunction onSegment(p, q, r) {\n    return q.x <= Math.max(p.x, r.x) && q.x >= Math.min(p.x, r.x) && q.y <= Math.max(p.y, r.y) && q.y >= Math.min(p.y, r.y);\n}\n\nfunction sign(num) {\n    return num > 0 ? 1 : num < 0 ? -1 : 0;\n}\n\n// check if a polygon diagonal intersects any polygon segments\nfunction intersectsPolygon(a, b) {\n    let p = a;\n    do {\n        if (p.i !== a.i && p.next.i !== a.i && p.i !== b.i && p.next.i !== b.i &&\n                intersects(p, p.next, a, b)) return true;\n        p = p.next;\n    } while (p !== a);\n\n    return false;\n}\n\n// check if a polygon diagonal is locally inside the polygon\nfunction locallyInside(a, b) {\n    return area(a.prev, a, a.next) < 0 ?\n        area(a, b, a.next) >= 0 && area(a, a.prev, b) >= 0 :\n        area(a, b, a.prev) < 0 || area(a, a.next, b) < 0;\n}\n\n// check if the middle point of a polygon diagonal is inside the polygon\nfunction middleInside(a, b) {\n    let p = a;\n    let inside = false;\n    const px = (a.x + b.x) / 2;\n    const py = (a.y + b.y) / 2;\n    do {\n        if (((p.y > py) !== (p.next.y > py)) && p.next.y !== p.y &&\n                (px < (p.next.x - p.x) * (py - p.y) / (p.next.y - p.y) + p.x))\n            inside = !inside;\n        p = p.next;\n    } while (p !== a);\n\n    return inside;\n}\n\n// link two polygon vertices with a bridge; if the vertices belong to the same ring, it splits polygon into two;\n// if one belongs to the outer ring and another to a hole, it merges it into a single ring\nfunction splitPolygon(a, b) {\n    const a2 = createNode(a.i, a.x, a.y),\n        b2 = createNode(b.i, b.x, b.y),\n        an = a.next,\n        bp = b.prev;\n\n    a.next = b;\n    b.prev = a;\n\n    a2.next = an;\n    an.prev = a2;\n\n    b2.next = a2;\n    a2.prev = b2;\n\n    bp.next = b2;\n    b2.prev = bp;\n\n    return b2;\n}\n\n// create a node and optionally link it with previous one (in a circular doubly linked list)\nfunction insertNode(i, x, y, last) {\n    const p = createNode(i, x, y);\n\n    if (!last) {\n        p.prev = p;\n        p.next = p;\n\n    } else {\n        p.next = last.next;\n        p.prev = last;\n        last.next.prev = p;\n        last.next = p;\n    }\n    return p;\n}\n\nfunction removeNode(p) {\n    p.next.prev = p.prev;\n    p.prev.next = p.next;\n\n    if (p.prevZ) p.prevZ.nextZ = p.nextZ;\n    if (p.nextZ) p.nextZ.prevZ = p.prevZ;\n}\n\nfunction createNode(i, x, y) {\n    return {\n        i, // vertex index in coordinates array\n        x, y, // vertex coordinates\n        prev: null, // previous and next vertex nodes in a polygon ring\n        next: null,\n        z: 0, // z-order curve value\n        prevZ: null, // previous and next nodes in z-order\n        nextZ: null,\n        steiner: false // indicates whether this is a steiner point\n    };\n}\n\n// return a percentage difference between the polygon area and its triangulation area;\n// used to verify correctness of triangulation\nexport function deviation(data, holeIndices, dim, triangles) {\n    const hasHoles = holeIndices && holeIndices.length;\n    const outerLen = hasHoles ? holeIndices[0] * dim : data.length;\n\n    let polygonArea = Math.abs(signedArea(data, 0, outerLen, dim));\n    if (hasHoles) {\n        for (let i = 0, len = holeIndices.length; i < len; i++) {\n            const start = holeIndices[i] * dim;\n            const end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;\n            polygonArea -= Math.abs(signedArea(data, start, end, dim));\n        }\n    }\n\n    let trianglesArea = 0;\n    for (let i = 0; i < triangles.length; i += 3) {\n        const a = triangles[i] * dim;\n        const b = triangles[i + 1] * dim;\n        const c = triangles[i + 2] * dim;\n        trianglesArea += Math.abs(\n            (data[a] - data[c]) * (data[b + 1] - data[a + 1]) -\n            (data[a] - data[b]) * (data[c + 1] - data[a + 1]));\n    }\n\n    return polygonArea === 0 && trianglesArea === 0 ? 0 :\n        Math.abs((trianglesArea - polygonArea) / polygonArea);\n}\n\nfunction signedArea(data, start, end, dim) {\n    let sum = 0;\n    for (let i = start, j = end - dim; i < end; i += dim) {\n        sum += (data[j] - data[i]) * (data[i + 1] + data[j + 1]);\n        j = i;\n    }\n    return sum;\n}\n\n// turn a polygon in a multi-dimensional array form (e.g. as in GeoJSON) into a form Earcut accepts\nexport function flatten(data) {\n    const vertices = [];\n    const holes = [];\n    const dimensions = data[0][0].length;\n    let holeIndex = 0;\n    let prevLen = 0;\n\n    for (const ring of data) {\n        for (const p of ring) {\n            for (let d = 0; d < dimensions; d++) vertices.push(p[d]);\n        }\n        if (prevLen) {\n            holeIndex += prevLen;\n            holes.push(holeIndex);\n        }\n        prevLen = ring.length;\n    }\n    return {vertices, holes, dimensions};\n}\n","import earcutModule from 'earcut';\nexport { default as EventEmitter } from 'eventemitter3';\n\n\"use strict\";\nconst earcut = earcutModule.default || earcutModule;\n\nexport { earcut };\n//# sourceMappingURL=utils.mjs.map\n","\"use strict\";\nvar CLEAR = /* @__PURE__ */ ((CLEAR2) => {\n  CLEAR2[CLEAR2[\"NONE\"] = 0] = \"NONE\";\n  CLEAR2[CLEAR2[\"COLOR\"] = 16384] = \"COLOR\";\n  CLEAR2[CLEAR2[\"STENCIL\"] = 1024] = \"STENCIL\";\n  CLEAR2[CLEAR2[\"DEPTH\"] = 256] = \"DEPTH\";\n  CLEAR2[CLEAR2[\"COLOR_DEPTH\"] = 16640] = \"COLOR_DEPTH\";\n  CLEAR2[CLEAR2[\"COLOR_STENCIL\"] = 17408] = \"COLOR_STENCIL\";\n  CLEAR2[CLEAR2[\"DEPTH_STENCIL\"] = 1280] = \"DEPTH_STENCIL\";\n  CLEAR2[CLEAR2[\"ALL\"] = 17664] = \"ALL\";\n  return CLEAR2;\n})(CLEAR || {});\n\nexport { CLEAR };\n//# sourceMappingURL=const.mjs.map\n","\"use strict\";\nclass SystemRunner {\n  /**\n   * @param name - The function name that will be executed on the listeners added to this Runner.\n   */\n  constructor(name) {\n    this.items = [];\n    this._name = name;\n  }\n  /* jsdoc/check-param-names */\n  /**\n   * Dispatch/Broadcast Runner to all listeners added to the queue.\n   * @param {...any} params - (optional) parameters to pass to each listener\n   */\n  /* jsdoc/check-param-names */\n  emit(a0, a1, a2, a3, a4, a5, a6, a7) {\n    const { name, items } = this;\n    for (let i = 0, len = items.length; i < len; i++) {\n      items[i][name](a0, a1, a2, a3, a4, a5, a6, a7);\n    }\n    return this;\n  }\n  /**\n   * Add a listener to the Runner\n   *\n   * Runners do not need to have scope or functions passed to them.\n   * All that is required is to pass the listening object and ensure that it has contains a function that has the same name\n   * as the name provided to the Runner when it was created.\n   *\n   * Eg A listener passed to this Runner will require a 'complete' function.\n   *\n   * ```ts\n   * import { Runner } from 'pixi.js';\n   *\n   * const complete = new Runner('complete');\n   * ```\n   *\n   * The scope used will be the object itself.\n   * @param {any} item - The object that will be listening.\n   */\n  add(item) {\n    if (item[this._name]) {\n      this.remove(item);\n      this.items.push(item);\n    }\n    return this;\n  }\n  /**\n   * Remove a single listener from the dispatch queue.\n   * @param {any} item - The listener that you would like to remove.\n   */\n  remove(item) {\n    const index = this.items.indexOf(item);\n    if (index !== -1) {\n      this.items.splice(index, 1);\n    }\n    return this;\n  }\n  /**\n   * Check to see if the listener is already in the Runner\n   * @param {any} item - The listener that you would like to check.\n   */\n  contains(item) {\n    return this.items.indexOf(item) !== -1;\n  }\n  /** Remove all listeners from the Runner */\n  removeAll() {\n    this.items.length = 0;\n    return this;\n  }\n  /** Remove all references, don't use after this. */\n  destroy() {\n    this.removeAll();\n    this.items = null;\n    this._name = null;\n  }\n  /**\n   * `true` if there are no this Runner contains no listeners\n   * @readonly\n   */\n  get empty() {\n    return this.items.length === 0;\n  }\n  /**\n   * The name of the runner.\n   * @readonly\n   */\n  get name() {\n    return this._name;\n  }\n}\n\nexport { SystemRunner };\n//# sourceMappingURL=SystemRunner.mjs.map\n","import { Color } from '../../../../color/Color.mjs';\nimport { loadEnvironmentExtensions } from '../../../../environment/autoDetectEnvironment.mjs';\nimport { Container } from '../../../../scene/container/Container.mjs';\nimport { unsafeEvalSupported } from '../../../../utils/browser/unsafeEvalSupported.mjs';\nimport { uid } from '../../../../utils/data/uid.mjs';\nimport { deprecation, v8_0_0 } from '../../../../utils/logging/deprecation.mjs';\nimport { GlobalResourceRegistry } from '../../../../utils/pool/GlobalResourceRegistry.mjs';\nimport '../../../../utils/utils.mjs';\nimport { CLEAR } from '../../gl/const.mjs';\nimport { SystemRunner } from './SystemRunner.mjs';\nimport EventEmitter from 'eventemitter3';\n\n\"use strict\";\nconst defaultRunners = [\n  \"init\",\n  \"destroy\",\n  \"contextChange\",\n  \"resolutionChange\",\n  \"resetState\",\n  \"renderEnd\",\n  \"renderStart\",\n  \"render\",\n  \"update\",\n  \"postrender\",\n  \"prerender\"\n];\nconst _AbstractRenderer = class _AbstractRenderer extends EventEmitter {\n  /**\n   * Set up a system with a collection of SystemClasses and runners.\n   * Systems are attached dynamically to this class when added.\n   * @param config - the config for the system manager\n   */\n  constructor(config) {\n    super();\n    /** @internal */\n    this.uid = uid(\"renderer\");\n    /** @internal */\n    this.runners = /* @__PURE__ */ Object.create(null);\n    /** @internal */\n    this.renderPipes = /* @__PURE__ */ Object.create(null);\n    this._initOptions = {};\n    this._systemsHash = /* @__PURE__ */ Object.create(null);\n    this.type = config.type;\n    this.name = config.name;\n    this.config = config;\n    const combinedRunners = [...defaultRunners, ...this.config.runners ?? []];\n    this._addRunners(...combinedRunners);\n    this._unsafeEvalCheck();\n  }\n  /**\n   * Initialize the renderer.\n   * @param options - The options to use to create the renderer.\n   */\n  async init(options = {}) {\n    const skip = options.skipExtensionImports === true ? true : options.manageImports === false;\n    await loadEnvironmentExtensions(skip);\n    this._addSystems(this.config.systems);\n    this._addPipes(this.config.renderPipes, this.config.renderPipeAdaptors);\n    for (const systemName in this._systemsHash) {\n      const system = this._systemsHash[systemName];\n      const defaultSystemOptions = system.constructor.defaultOptions;\n      options = { ...defaultSystemOptions, ...options };\n    }\n    options = { ..._AbstractRenderer.defaultOptions, ...options };\n    this._roundPixels = options.roundPixels ? 1 : 0;\n    for (let i = 0; i < this.runners.init.items.length; i++) {\n      await this.runners.init.items[i].init(options);\n    }\n    this._initOptions = options;\n  }\n  render(args, deprecated) {\n    let options = args;\n    if (options instanceof Container) {\n      options = { container: options };\n      if (deprecated) {\n        deprecation(v8_0_0, \"passing a second argument is deprecated, please use render options instead\");\n        options.target = deprecated.renderTexture;\n      }\n    }\n    options.target || (options.target = this.view.renderTarget);\n    if (options.target === this.view.renderTarget) {\n      this._lastObjectRendered = options.container;\n      options.clearColor ?? (options.clearColor = this.background.colorRgba);\n      options.clear ?? (options.clear = this.background.clearBeforeRender);\n    }\n    if (options.clearColor) {\n      const isRGBAArray = Array.isArray(options.clearColor) && options.clearColor.length === 4;\n      options.clearColor = isRGBAArray ? options.clearColor : Color.shared.setValue(options.clearColor).toArray();\n    }\n    if (!options.transform) {\n      options.container.updateLocalTransform();\n      options.transform = options.container.localTransform;\n    }\n    if (!options.container.visible) {\n      return;\n    }\n    options.container.enableRenderGroup();\n    this.runners.prerender.emit(options);\n    this.runners.renderStart.emit(options);\n    this.runners.render.emit(options);\n    this.runners.renderEnd.emit(options);\n    this.runners.postrender.emit(options);\n  }\n  /**\n   * Resizes the WebGL view to the specified width and height.\n   * @param desiredScreenWidth - The desired width of the screen.\n   * @param desiredScreenHeight - The desired height of the screen.\n   * @param resolution - The resolution / device pixel ratio of the renderer.\n   */\n  resize(desiredScreenWidth, desiredScreenHeight, resolution) {\n    const previousResolution = this.view.resolution;\n    this.view.resize(desiredScreenWidth, desiredScreenHeight, resolution);\n    this.emit(\"resize\", this.view.screen.width, this.view.screen.height, this.view.resolution);\n    if (resolution !== void 0 && resolution !== previousResolution) {\n      this.runners.resolutionChange.emit(resolution);\n    }\n  }\n  /**\n   * Clears the render target.\n   * @param options - The options to use when clearing the render target.\n   * @param options.target - The render target to clear.\n   * @param options.clearColor - The color to clear with.\n   * @param options.clear - The clear mode to use.\n   * @advanced\n   */\n  clear(options = {}) {\n    const renderer = this;\n    options.target || (options.target = renderer.renderTarget.renderTarget);\n    options.clearColor || (options.clearColor = this.background.colorRgba);\n    options.clear ?? (options.clear = CLEAR.ALL);\n    const { clear, clearColor, target } = options;\n    Color.shared.setValue(clearColor ?? this.background.colorRgba);\n    renderer.renderTarget.clear(target, clear, Color.shared.toArray());\n  }\n  /** The resolution / device pixel ratio of the renderer. */\n  get resolution() {\n    return this.view.resolution;\n  }\n  set resolution(value) {\n    this.view.resolution = value;\n    this.runners.resolutionChange.emit(value);\n  }\n  /**\n   * Same as view.width, actual number of pixels in the canvas by horizontal.\n   * @type {number}\n   * @readonly\n   * @default 800\n   */\n  get width() {\n    return this.view.texture.frame.width;\n  }\n  /**\n   * Same as view.height, actual number of pixels in the canvas by vertical.\n   * @default 600\n   */\n  get height() {\n    return this.view.texture.frame.height;\n  }\n  // NOTE: this was `view` in v7\n  /**\n   * The canvas element that everything is drawn to.\n   * @type {environment.ICanvas}\n   */\n  get canvas() {\n    return this.view.canvas;\n  }\n  /**\n   * the last object rendered by the renderer. Useful for other plugins like interaction managers\n   * @readonly\n   */\n  get lastObjectRendered() {\n    return this._lastObjectRendered;\n  }\n  /**\n   * Flag if we are rendering to the screen vs renderTexture\n   * @readonly\n   * @default true\n   */\n  get renderingToScreen() {\n    const renderer = this;\n    return renderer.renderTarget.renderingToScreen;\n  }\n  /**\n   * Measurements of the screen. (0, 0, screenWidth, screenHeight).\n   *\n   * Its safe to use as filterArea or hitArea for the whole stage.\n   */\n  get screen() {\n    return this.view.screen;\n  }\n  /**\n   * Create a bunch of runners based of a collection of ids\n   * @param runnerIds - the runner ids to add\n   */\n  _addRunners(...runnerIds) {\n    runnerIds.forEach((runnerId) => {\n      this.runners[runnerId] = new SystemRunner(runnerId);\n    });\n  }\n  _addSystems(systems) {\n    let i;\n    for (i in systems) {\n      const val = systems[i];\n      this._addSystem(val.value, val.name);\n    }\n  }\n  /**\n   * Add a new system to the renderer.\n   * @param ClassRef - Class reference\n   * @param name - Property name for system, if not specified\n   *        will use a static `name` property on the class itself. This\n   *        name will be assigned as s property on the Renderer so make\n   *        sure it doesn't collide with properties on Renderer.\n   * @returns Return instance of renderer\n   */\n  _addSystem(ClassRef, name) {\n    const system = new ClassRef(this);\n    if (this[name]) {\n      throw new Error(`Whoops! The name \"${name}\" is already in use`);\n    }\n    this[name] = system;\n    this._systemsHash[name] = system;\n    for (const i in this.runners) {\n      this.runners[i].add(system);\n    }\n    return this;\n  }\n  _addPipes(pipes, pipeAdaptors) {\n    const adaptors = pipeAdaptors.reduce((acc, adaptor) => {\n      acc[adaptor.name] = adaptor.value;\n      return acc;\n    }, {});\n    pipes.forEach((pipe) => {\n      const PipeClass = pipe.value;\n      const name = pipe.name;\n      const Adaptor = adaptors[name];\n      this.renderPipes[name] = new PipeClass(\n        this,\n        Adaptor ? new Adaptor() : null\n      );\n      this.runners.destroy.add(this.renderPipes[name]);\n    });\n  }\n  destroy(options = false) {\n    this.runners.destroy.items.reverse();\n    this.runners.destroy.emit(options);\n    Object.values(this.runners).forEach((runner) => {\n      runner.destroy();\n    });\n    if (options === true || typeof options === \"object\" && options.releaseGlobalResources) {\n      GlobalResourceRegistry.release();\n    }\n    this._systemsHash = null;\n    this.renderPipes = null;\n  }\n  /**\n   * Generate a texture from a container.\n   * @param options - options or container target to use when generating the texture\n   * @returns a texture\n   */\n  generateTexture(options) {\n    return this.textureGenerator.generateTexture(options);\n  }\n  /**\n   * Whether the renderer will round coordinates to whole pixels when rendering.\n   * Can be overridden on a per scene item basis.\n   */\n  get roundPixels() {\n    return !!this._roundPixels;\n  }\n  /**\n   * Overridable function by `pixi.js/unsafe-eval` to silence\n   * throwing an error if platform doesn't support unsafe-evals.\n   * @private\n   * @ignore\n   */\n  _unsafeEvalCheck() {\n    if (!unsafeEvalSupported()) {\n      throw new Error(\"Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.\");\n    }\n  }\n  /**\n   * Resets the rendering state of the renderer.\n   * This is useful when you want to use the WebGL context directly and need to ensure PixiJS's internal state\n   * stays synchronized. When modifying the WebGL context state externally, calling this method before the next Pixi\n   * render will reset all internal caches and ensure it executes correctly.\n   *\n   * This is particularly useful when combining PixiJS with other rendering engines like Three.js:\n   * ```js\n   * // Reset Three.js state\n   * threeRenderer.resetState();\n   *\n   * // Render a Three.js scene\n   * threeRenderer.render(threeScene, threeCamera);\n   *\n   * // Reset PixiJS state since Three.js modified the WebGL context\n   * pixiRenderer.resetState();\n   *\n   * // Now render Pixi content\n   * pixiRenderer.render(pixiScene);\n   * ```\n   * @advanced\n   */\n  resetState() {\n    this.runners.resetState.emit();\n  }\n};\n/** The default options for the renderer. */\n_AbstractRenderer.defaultOptions = {\n  /**\n   * Default resolution / device pixel ratio of the renderer.\n   * @default 1\n   */\n  resolution: 1,\n  /**\n   * Should the `failIfMajorPerformanceCaveat` flag be enabled as a context option used in the `isWebGLSupported`\n   * function. If set to true, a WebGL renderer can fail to be created if the browser thinks there could be\n   * performance issues when using WebGL.\n   *\n   * In PixiJS v6 this has changed from true to false by default, to allow WebGL to work in as many\n   * scenarios as possible. However, some users may have a poor experience, for example, if a user has a gpu or\n   * driver version blacklisted by the\n   * browser.\n   *\n   * If your application requires high performance rendering, you may wish to set this to false.\n   * We recommend one of two options if you decide to set this flag to false:\n   *\n   * 1: Use the Canvas renderer as a fallback in case high performance WebGL is\n   *    not supported.\n   *\n   * 2: Call `isWebGLSupported` (which if found in the utils package) in your code before attempting to create a\n   *    PixiJS renderer, and show an error message to the user if the function returns false, explaining that their\n   *    device & browser combination does not support high performance WebGL.\n   *    This is a much better strategy than trying to create a PixiJS renderer and finding it then fails.\n   * @default false\n   */\n  failIfMajorPerformanceCaveat: false,\n  /**\n   * Should round pixels be forced when rendering?\n   * @default false\n   */\n  roundPixels: false\n};\nlet AbstractRenderer = _AbstractRenderer;\n\nexport { AbstractRenderer };\n//# sourceMappingURL=AbstractRenderer.mjs.map\n","import { DOMAdapter } from '../../environment/adapter.mjs';\nimport { AbstractRenderer } from '../../rendering/renderers/shared/system/AbstractRenderer.mjs';\n\n\"use strict\";\nlet _isWebGLSupported;\nfunction isWebGLSupported(failIfMajorPerformanceCaveat) {\n  if (_isWebGLSupported !== void 0)\n    return _isWebGLSupported;\n  _isWebGLSupported = (() => {\n    const contextOptions = {\n      stencil: true,\n      failIfMajorPerformanceCaveat: failIfMajorPerformanceCaveat ?? AbstractRenderer.defaultOptions.failIfMajorPerformanceCaveat\n    };\n    try {\n      if (!DOMAdapter.get().getWebGLRenderingContext()) {\n        return false;\n      }\n      const canvas = DOMAdapter.get().createCanvas();\n      let gl = canvas.getContext(\"webgl\", contextOptions);\n      const success = !!gl?.getContextAttributes()?.stencil;\n      if (gl) {\n        const loseContext = gl.getExtension(\"WEBGL_lose_context\");\n        if (loseContext) {\n          loseContext.loseContext();\n        }\n      }\n      gl = null;\n      return success;\n    } catch (_e) {\n      return false;\n    }\n  })();\n  return _isWebGLSupported;\n}\n\nexport { isWebGLSupported };\n//# sourceMappingURL=isWebGLSupported.mjs.map\n","import { DOMAdapter } from '../../environment/adapter.mjs';\n\n\"use strict\";\nlet _isWebGPUSupported;\nasync function isWebGPUSupported(options = {}) {\n  if (_isWebGPUSupported !== void 0)\n    return _isWebGPUSupported;\n  _isWebGPUSupported = await (async () => {\n    const gpu = DOMAdapter.get().getNavigator().gpu;\n    if (!gpu) {\n      return false;\n    }\n    try {\n      const adapter = await gpu.requestAdapter(options);\n      await adapter.requestDevice();\n      return true;\n    } catch (_e) {\n      return false;\n    }\n  })();\n  return _isWebGPUSupported;\n}\n\nexport { isWebGPUSupported };\n//# sourceMappingURL=isWebGPUSupported.mjs.map\n","import { isWebGLSupported } from '../../utils/browser/isWebGLSupported.mjs';\nimport { isWebGPUSupported } from '../../utils/browser/isWebGPUSupported.mjs';\nimport { AbstractRenderer } from './shared/system/AbstractRenderer.mjs';\n\n\"use strict\";\nconst renderPriority = [\"webgl\", \"webgpu\", \"canvas\"];\nasync function autoDetectRenderer(options) {\n  let preferredOrder = [];\n  if (options.preference) {\n    preferredOrder.push(options.preference);\n    renderPriority.forEach((item) => {\n      if (item !== options.preference) {\n        preferredOrder.push(item);\n      }\n    });\n  } else {\n    preferredOrder = renderPriority.slice();\n  }\n  let RendererClass;\n  let finalOptions = {};\n  for (let i = 0; i < preferredOrder.length; i++) {\n    const rendererType = preferredOrder[i];\n    if (rendererType === \"webgpu\" && await isWebGPUSupported()) {\n      const { WebGPURenderer } = await import('./gpu/WebGPURenderer.mjs');\n      RendererClass = WebGPURenderer;\n      finalOptions = { ...options, ...options.webgpu };\n      break;\n    } else if (rendererType === \"webgl\" && isWebGLSupported(\n      options.failIfMajorPerformanceCaveat ?? AbstractRenderer.defaultOptions.failIfMajorPerformanceCaveat\n    )) {\n      const { WebGLRenderer } = await import('./gl/WebGLRenderer.mjs');\n      RendererClass = WebGLRenderer;\n      finalOptions = { ...options, ...options.webgl };\n      break;\n    } else if (rendererType === \"canvas\") {\n      finalOptions = { ...options };\n      throw new Error(\"CanvasRenderer is not yet implemented\");\n    }\n  }\n  delete finalOptions.webgpu;\n  delete finalOptions.webgl;\n  if (!RendererClass) {\n    throw new Error(\"No available renderer for the current environment\");\n  }\n  const renderer = new RendererClass();\n  await renderer.init(finalOptions);\n  return renderer;\n}\n\nexport { autoDetectRenderer };\n//# sourceMappingURL=autoDetectRenderer.mjs.map\n","export { default as EventEmitter } from 'eventemitter3';\n\n\"use strict\";\nconst DATA_URI = /^\\s*data:(?:([\\w-]+)\\/([\\w+.-]+))?(?:;charset=([\\w-]+))?(?:;(base64))?,(.*)/i;\nconst VERSION = \"8.14.0\";\n\nexport { DATA_URI, VERSION };\n//# sourceMappingURL=const.mjs.map\n","import { ExtensionType } from '../../extensions/Extensions.mjs';\nimport { VERSION } from '../const.mjs';\n\n\"use strict\";\nclass ApplicationInitHook {\n  static init() {\n    globalThis.__PIXI_APP_INIT__?.(this, VERSION);\n  }\n  static destroy() {\n  }\n}\n/** @ignore */\nApplicationInitHook.extension = ExtensionType.Application;\nclass RendererInitHook {\n  constructor(renderer) {\n    this._renderer = renderer;\n  }\n  init() {\n    globalThis.__PIXI_RENDERER_INIT__?.(this._renderer, VERSION);\n  }\n  destroy() {\n    this._renderer = null;\n  }\n}\n/** @ignore */\nRendererInitHook.extension = {\n  type: [\n    ExtensionType.WebGLSystem,\n    ExtensionType.WebGPUSystem\n  ],\n  name: \"initHook\",\n  priority: -10\n};\n\nexport { ApplicationInitHook, RendererInitHook };\n//# sourceMappingURL=globalHooks.mjs.map\n","import { extensions, ExtensionType } from '../extensions/Extensions.mjs';\nimport { autoDetectRenderer } from '../rendering/renderers/autoDetectRenderer.mjs';\nimport { Container } from '../scene/container/Container.mjs';\nimport { ApplicationInitHook } from '../utils/global/globalHooks.mjs';\nimport { deprecation, v8_0_0 } from '../utils/logging/deprecation.mjs';\n\n\"use strict\";\nconst _Application = class _Application {\n  constructor(...args) {\n    /**\n     * The root display container for your application.\n     * All visual elements should be added to this container or its children.\n     * @example\n     * ```js\n     * // Create a sprite and add it to the stage\n     * const sprite = Sprite.from('image.png');\n     * app.stage.addChild(sprite);\n     *\n     * // Create a container for grouping objects\n     * const container = new Container();\n     * app.stage.addChild(container);\n     * ```\n     */\n    this.stage = new Container();\n    if (args[0] !== void 0) {\n      deprecation(v8_0_0, \"Application constructor options are deprecated, please use Application.init() instead.\");\n    }\n  }\n  /**\n   * Initializes the PixiJS application with the specified options.\n   *\n   * This method must be called after creating a new Application instance.\n   * @param options - Configuration options for the application and renderer\n   * @returns A promise that resolves when initialization is complete\n   * @example\n   * ```js\n   * const app = new Application();\n   *\n   * // Initialize with custom options\n   * await app.init({\n   *     width: 800,\n   *     height: 600,\n   *     backgroundColor: 0x1099bb,\n   *     preference: 'webgl', // or 'webgpu'\n   * });\n   * ```\n   */\n  async init(options) {\n    options = { ...options };\n    this.renderer = await autoDetectRenderer(options);\n    _Application._plugins.forEach((plugin) => {\n      plugin.init.call(this, options);\n    });\n  }\n  /**\n   * Renders the current stage to the screen.\n   *\n   * When using the default setup with {@link TickerPlugin} (enabled by default), you typically don't need to call\n   * this method directly as rendering is handled automatically.\n   *\n   * Only use this method if you've disabled the {@link TickerPlugin} or need custom\n   * render timing control.\n   * @example\n   * ```js\n   * // Example 1: Default setup (TickerPlugin handles rendering)\n   * const app = new Application();\n   * await app.init();\n   * // No need to call render() - TickerPlugin handles it\n   *\n   * // Example 2: Custom rendering loop (if TickerPlugin is disabled)\n   * const app = new Application();\n   * await app.init({ autoStart: false }); // Disable automatic rendering\n   *\n   * function animate() {\n   *     app.render();\n   *     requestAnimationFrame(animate);\n   * }\n   * animate();\n   * ```\n   */\n  render() {\n    this.renderer.render({ container: this.stage });\n  }\n  /**\n   * Reference to the renderer's canvas element. This is the HTML element\n   * that displays your application's graphics.\n   * @readonly\n   * @type {HTMLCanvasElement}\n   * @example\n   * ```js\n   * // Create a new application\n   * const app = new Application();\n   * // Initialize the application\n   * await app.init({...});\n   * // Add canvas to the page\n   * document.body.appendChild(app.canvas);\n   *\n   * // Access the canvas directly\n   * console.log(app.canvas); // HTMLCanvasElement\n   * ```\n   */\n  get canvas() {\n    return this.renderer.canvas;\n  }\n  /**\n   * Reference to the renderer's canvas element.\n   * @type {HTMLCanvasElement}\n   * @deprecated since 8.0.0\n   * @see {@link Application#canvas}\n   */\n  get view() {\n    deprecation(v8_0_0, \"Application.view is deprecated, please use Application.canvas instead.\");\n    return this.renderer.canvas;\n  }\n  /**\n   * Reference to the renderer's screen rectangle. This represents the visible area of your application.\n   *\n   * It's commonly used for:\n   * - Setting filter areas for full-screen effects\n   * - Defining hit areas for screen-wide interaction\n   * - Determining the visible bounds of your application\n   * @readonly\n   * @example\n   * ```js\n   * // Use as filter area for a full-screen effect\n   * const blurFilter = new BlurFilter();\n   * sprite.filterArea = app.screen;\n   *\n   * // Use as hit area for screen-wide interaction\n   * const screenSprite = new Sprite();\n   * screenSprite.hitArea = app.screen;\n   *\n   * // Get screen dimensions\n   * console.log(app.screen.width, app.screen.height);\n   * ```\n   * @see {@link Rectangle} For all available properties and methods\n   */\n  get screen() {\n    return this.renderer.screen;\n  }\n  /**\n   * Destroys the application and all of its resources.\n   *\n   * This method should be called when you want to completely\n   * clean up the application and free all associated memory.\n   * @param rendererDestroyOptions - Options for destroying the renderer:\n   *  - `false` or `undefined`: Preserves the canvas element (default)\n   *  - `true`: Removes the canvas element\n   *  - `{ removeView: boolean }`: Object with removeView property to control canvas removal\n   * @param options - Options for destroying the application:\n   *  - `false` or `undefined`: Basic cleanup (default)\n   *  - `true`: Complete cleanup including children\n   *  - Detailed options object:\n   *    - `children`: Remove children\n   *    - `texture`: Destroy textures\n   *    - `textureSource`: Destroy texture sources\n   *    - `context`: Destroy WebGL context\n   * @example\n   * ```js\n   * // Basic cleanup\n   * app.destroy();\n   *\n   * // Remove canvas and do complete cleanup\n   * app.destroy(true, true);\n   *\n   * // Remove canvas with explicit options\n   * app.destroy({ removeView: true }, true);\n   *\n   * // Detailed cleanup with specific options\n   * app.destroy(\n   *     { removeView: true },\n   *     {\n   *         children: true,\n   *         texture: true,\n   *         textureSource: true,\n   *         context: true\n   *     }\n   * );\n   * ```\n   * > [!WARNING] After calling destroy, the application instance should no longer be used.\n   * > All properties will be null and further operations will throw errors.\n   */\n  destroy(rendererDestroyOptions = false, options = false) {\n    const plugins = _Application._plugins.slice(0);\n    plugins.reverse();\n    plugins.forEach((plugin) => {\n      plugin.destroy.call(this);\n    });\n    this.stage.destroy(options);\n    this.stage = null;\n    this.renderer.destroy(rendererDestroyOptions);\n    this.renderer = null;\n  }\n};\n/**\n * Collection of installed plugins.\n * @internal\n */\n_Application._plugins = [];\nlet Application = _Application;\nextensions.handleByList(ExtensionType.Application, Application._plugins);\nextensions.add(ApplicationInitHook);\n\nexport { Application };\n//# sourceMappingURL=Application.mjs.map\n","import EventEmitter from 'eventemitter3';\nimport { deprecation, v8_0_0 } from '../../utils/logging/deprecation.mjs';\n\n\"use strict\";\nclass AbstractBitmapFont extends EventEmitter {\n  constructor() {\n    super(...arguments);\n    /** The map of characters by character code. */\n    this.chars = /* @__PURE__ */ Object.create(null);\n    /**\n     * The line-height of the font face in pixels.\n     * @type {number}\n     */\n    this.lineHeight = 0;\n    /**\n     * The name of the font face\n     * @type {string}\n     */\n    this.fontFamily = \"\";\n    /** The metrics of the font face. */\n    this.fontMetrics = { fontSize: 0, ascent: 0, descent: 0 };\n    /**\n     * The offset of the font face from the baseline.\n     * @type {number}\n     */\n    this.baseLineOffset = 0;\n    /** The range and type of the distance field for this font. */\n    this.distanceField = { type: \"none\", range: 0 };\n    /** The map of base page textures (i.e., sheets of glyphs). */\n    this.pages = [];\n    /** should the fill for this font be applied as a tint to the text. */\n    this.applyFillAsTint = true;\n    /** The size of the font face in pixels. */\n    this.baseMeasurementFontSize = 100;\n    this.baseRenderedFontSize = 100;\n  }\n  /**\n   * The name of the font face.\n   * @deprecated since 8.0.0 Use `fontFamily` instead.\n   */\n  get font() {\n    deprecation(v8_0_0, \"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead.\");\n    return this.fontFamily;\n  }\n  /**\n   * The map of base page textures (i.e., sheets of glyphs).\n   * @deprecated since 8.0.0 Use `pages` instead.\n   */\n  get pageTextures() {\n    deprecation(v8_0_0, \"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead.\");\n    return this.pages;\n  }\n  /**\n   * The size of the font face in pixels.\n   * @deprecated since 8.0.0 Use `fontMetrics.fontSize` instead.\n   */\n  get size() {\n    deprecation(v8_0_0, \"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead.\");\n    return this.fontMetrics.fontSize;\n  }\n  /**\n   * The kind of distance field for this font or \"none\".\n   * @deprecated since 8.0.0 Use `distanceField.type` instead.\n   */\n  get distanceFieldRange() {\n    deprecation(v8_0_0, \"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead.\");\n    return this.distanceField.range;\n  }\n  /**\n   * The range of the distance field in pixels.\n   * @deprecated since 8.0.0 Use `distanceField.range` instead.\n   */\n  get distanceFieldType() {\n    deprecation(v8_0_0, \"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead.\");\n    return this.distanceField.type;\n  }\n  destroy(destroyTextures = false) {\n    this.emit(\"destroy\", this);\n    this.removeAllListeners();\n    for (const i in this.chars) {\n      this.chars[i].texture?.destroy();\n    }\n    this.chars = null;\n    if (destroyTextures) {\n      this.pages.forEach((page) => page.texture.destroy(true));\n      this.pages = null;\n    }\n  }\n}\n\nexport { AbstractBitmapFont };\n//# sourceMappingURL=AbstractBitmapFont.mjs.map\n","/**\n * tiny-lru\n *\n * @copyright 2025 Jason Mulligan <jason.mulligan@avoidwork.com>\n * @license BSD-3-Clause\n * @version 11.4.5\n */\n/**\n * A high-performance Least Recently Used (LRU) cache implementation with optional TTL support.\n * Items are automatically evicted when the cache reaches its maximum size,\n * removing the least recently used items first. All core operations (get, set, delete) are O(1).\n *\n * @class LRU\n * @example\n * // Create a cache with max 100 items\n * const cache = new LRU(100);\n * cache.set('key1', 'value1');\n * console.log(cache.get('key1')); // 'value1'\n *\n * @example\n * // Create a cache with TTL\n * const cache = new LRU(100, 5000); // 5 second TTL\n * cache.set('key1', 'value1');\n * // After 5 seconds, key1 will be expired\n */\nclass LRU {\n\t/**\n\t * Creates a new LRU cache instance.\n\t * Note: Constructor does not validate parameters. Use lru() factory function for parameter validation.\n\t *\n\t * @constructor\n\t * @param {number} [max=0] - Maximum number of items to store. 0 means unlimited.\n\t * @param {number} [ttl=0] - Time to live in milliseconds. 0 means no expiration.\n\t * @param {boolean} [resetTtl=false] - Whether to reset TTL when accessing existing items via get().\n\t * @example\n\t * const cache = new LRU(1000, 60000, true); // 1000 items, 1 minute TTL, reset on access\n\t * @see {@link lru} For parameter validation\n\t * @since 1.0.0\n\t */\n\tconstructor (max = 0, ttl = 0, resetTtl = false) {\n\t\tthis.first = null;\n\t\tthis.items = Object.create(null);\n\t\tthis.last = null;\n\t\tthis.max = max;\n\t\tthis.resetTtl = resetTtl;\n\t\tthis.size = 0;\n\t\tthis.ttl = ttl;\n\t}\n\n\t/**\n\t * Removes all items from the cache.\n\t *\n\t * @method clear\n\t * @memberof LRU\n\t * @returns {LRU} The LRU instance for method chaining.\n\t * @example\n\t * cache.clear();\n\t * console.log(cache.size); // 0\n\t * @since 1.0.0\n\t */\n\tclear () {\n\t\tthis.first = null;\n\t\tthis.items = Object.create(null);\n\t\tthis.last = null;\n\t\tthis.size = 0;\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Removes an item from the cache by key.\n\t *\n\t * @method delete\n\t * @memberof LRU\n\t * @param {string} key - The key of the item to delete.\n\t * @returns {LRU} The LRU instance for method chaining.\n\t * @example\n\t * cache.set('key1', 'value1');\n\t * cache.delete('key1');\n\t * console.log(cache.has('key1')); // false\n\t * @see {@link LRU#has}\n\t * @see {@link LRU#clear}\n\t * @since 1.0.0\n\t */\n\tdelete (key) {\n\t\tif (this.has(key)) {\n\t\t\tconst item = this.items[key];\n\n\t\t\tdelete this.items[key];\n\t\t\tthis.size--;\n\n\t\t\tif (item.prev !== null) {\n\t\t\t\titem.prev.next = item.next;\n\t\t\t}\n\n\t\t\tif (item.next !== null) {\n\t\t\t\titem.next.prev = item.prev;\n\t\t\t}\n\n\t\t\tif (this.first === item) {\n\t\t\t\tthis.first = item.next;\n\t\t\t}\n\n\t\t\tif (this.last === item) {\n\t\t\t\tthis.last = item.prev;\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns an array of [key, value] pairs for the specified keys.\n\t * Order follows LRU order (least to most recently used).\n\t *\n\t * @method entries\n\t * @memberof LRU\n\t * @param {string[]} [keys=this.keys()] - Array of keys to get entries for. Defaults to all keys.\n\t * @returns {Array<Array<*>>} Array of [key, value] pairs in LRU order.\n\t * @example\n\t * cache.set('a', 1).set('b', 2);\n\t * console.log(cache.entries()); // [['a', 1], ['b', 2]]\n\t * console.log(cache.entries(['a'])); // [['a', 1]]\n\t * @see {@link LRU#keys}\n\t * @see {@link LRU#values}\n\t * @since 11.1.0\n\t */\n\tentries (keys = this.keys()) {\n\t\treturn keys.map(key => [key, this.get(key)]);\n\t}\n\n\t/**\n\t * Removes the least recently used item from the cache.\n\t *\n\t * @method evict\n\t * @memberof LRU\n\t * @param {boolean} [bypass=false] - Whether to force eviction even when cache is empty.\n\t * @returns {LRU} The LRU instance for method chaining.\n\t * @example\n\t * cache.set('old', 'value').set('new', 'value');\n\t * cache.evict(); // Removes 'old' item\n\t * @see {@link LRU#setWithEvicted}\n\t * @since 1.0.0\n\t */\n\tevict (bypass = false) {\n\t\tif (bypass || this.size > 0) {\n\t\t\tconst item = this.first;\n\n\t\t\tdelete this.items[item.key];\n\n\t\t\tif (--this.size === 0) {\n\t\t\t\tthis.first = null;\n\t\t\t\tthis.last = null;\n\t\t\t} else {\n\t\t\t\tthis.first = item.next;\n\t\t\t\tthis.first.prev = null;\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns the expiration timestamp for a given key.\n\t *\n\t * @method expiresAt\n\t * @memberof LRU\n\t * @param {string} key - The key to check expiration for.\n\t * @returns {number|undefined} The expiration timestamp in milliseconds, or undefined if key doesn't exist.\n\t * @example\n\t * const cache = new LRU(100, 5000); // 5 second TTL\n\t * cache.set('key1', 'value1');\n\t * console.log(cache.expiresAt('key1')); // timestamp 5 seconds from now\n\t * @see {@link LRU#get}\n\t * @see {@link LRU#has}\n\t * @since 1.0.0\n\t */\n\texpiresAt (key) {\n\t\tlet result;\n\n\t\tif (this.has(key)) {\n\t\t\tresult = this.items[key].expiry;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t/**\n\t * Retrieves a value from the cache by key. Updates the item's position to most recently used.\n\t *\n\t * @method get\n\t * @memberof LRU\n\t * @param {string} key - The key to retrieve.\n\t * @returns {*} The value associated with the key, or undefined if not found or expired.\n\t * @example\n\t * cache.set('key1', 'value1');\n\t * console.log(cache.get('key1')); // 'value1'\n\t * console.log(cache.get('nonexistent')); // undefined\n\t * @see {@link LRU#set}\n\t * @see {@link LRU#has}\n\t * @since 1.0.0\n\t */\n\tget (key) {\n\t\tconst item = this.items[key];\n\n\t\tif (item !== undefined) {\n\t\t\t// Check TTL only if enabled to avoid unnecessary Date.now() calls\n\t\t\tif (this.ttl > 0) {\n\t\t\t\tif (item.expiry <= Date.now()) {\n\t\t\t\t\tthis.delete(key);\n\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Fast LRU update without full set() overhead\n\t\t\tthis.moveToEnd(item);\n\n\t\t\treturn item.value;\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\t/**\n\t * Checks if a key exists in the cache.\n\t *\n\t * @method has\n\t * @memberof LRU\n\t * @param {string} key - The key to check for.\n\t * @returns {boolean} True if the key exists, false otherwise.\n\t * @example\n\t * cache.set('key1', 'value1');\n\t * console.log(cache.has('key1')); // true\n\t * console.log(cache.has('nonexistent')); // false\n\t * @see {@link LRU#get}\n\t * @see {@link LRU#delete}\n\t * @since 9.0.0\n\t */\n\thas (key) {\n\t\treturn key in this.items;\n\t}\n\n\t/**\n\t * Efficiently moves an item to the end of the LRU list (most recently used position).\n\t * This is an internal optimization method that avoids the overhead of the full set() operation\n\t * when only LRU position needs to be updated.\n\t *\n\t * @method moveToEnd\n\t * @memberof LRU\n\t * @param {Object} item - The cache item with prev/next pointers to reposition.\n\t * @private\n\t * @since 11.3.5\n\t */\n\tmoveToEnd (item) {\n\t\t// If already at the end, nothing to do\n\t\tif (this.last === item) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Remove item from current position in the list\n\t\tif (item.prev !== null) {\n\t\t\titem.prev.next = item.next;\n\t\t}\n\n\t\tif (item.next !== null) {\n\t\t\titem.next.prev = item.prev;\n\t\t}\n\n\t\t// Update first pointer if this was the first item\n\t\tif (this.first === item) {\n\t\t\tthis.first = item.next;\n\t\t}\n\n\t\t// Add item to the end\n\t\titem.prev = this.last;\n\t\titem.next = null;\n\n\t\tif (this.last !== null) {\n\t\t\tthis.last.next = item;\n\t\t}\n\n\t\tthis.last = item;\n\n\t\t// Handle edge case: if this was the only item, it's also first\n\t\tif (this.first === null) {\n\t\t\tthis.first = item;\n\t\t}\n\t}\n\n\t/**\n\t * Returns an array of all keys in the cache, ordered from least to most recently used.\n\t *\n\t * @method keys\n\t * @memberof LRU\n\t * @returns {string[]} Array of keys in LRU order.\n\t * @example\n\t * cache.set('a', 1).set('b', 2);\n\t * cache.get('a'); // Move 'a' to most recent\n\t * console.log(cache.keys()); // ['b', 'a']\n\t * @see {@link LRU#values}\n\t * @see {@link LRU#entries}\n\t * @since 9.0.0\n\t */\n\tkeys () {\n\t\tconst result = [];\n\t\tlet x = this.first;\n\n\t\twhile (x !== null) {\n\t\t\tresult.push(x.key);\n\t\t\tx = x.next;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t/**\n\t * Sets a value in the cache and returns any evicted item.\n\t *\n\t * @method setWithEvicted\n\t * @memberof LRU\n\t * @param {string} key - The key to set.\n\t * @param {*} value - The value to store.\n\t * @param {boolean} [resetTtl=this.resetTtl] - Whether to reset the TTL for this operation.\n\t * @returns {Object|null} The evicted item (if any) with shape {key, value, expiry, prev, next}, or null.\n\t * @example\n\t * const cache = new LRU(2);\n\t * cache.set('a', 1).set('b', 2);\n\t * const evicted = cache.setWithEvicted('c', 3); // evicted = {key: 'a', value: 1, ...}\n\t * @see {@link LRU#set}\n\t * @see {@link LRU#evict}\n\t * @since 11.3.0\n\t */\n\tsetWithEvicted (key, value, resetTtl = this.resetTtl) {\n\t\tlet evicted = null;\n\n\t\tif (this.has(key)) {\n\t\t\tthis.set(key, value, true, resetTtl);\n\t\t} else {\n\t\t\tif (this.max > 0 && this.size === this.max) {\n\t\t\t\tevicted = {...this.first};\n\t\t\t\tthis.evict(true);\n\t\t\t}\n\n\t\t\tlet item = this.items[key] = {\n\t\t\t\texpiry: this.ttl > 0 ? Date.now() + this.ttl : this.ttl,\n\t\t\t\tkey: key,\n\t\t\t\tprev: this.last,\n\t\t\t\tnext: null,\n\t\t\t\tvalue\n\t\t\t};\n\n\t\t\tif (++this.size === 1) {\n\t\t\t\tthis.first = item;\n\t\t\t} else {\n\t\t\t\tthis.last.next = item;\n\t\t\t}\n\n\t\t\tthis.last = item;\n\t\t}\n\n\t\treturn evicted;\n\t}\n\n\t/**\n\t * Sets a value in the cache. Updates the item's position to most recently used.\n\t *\n\t * @method set\n\t * @memberof LRU\n\t * @param {string} key - The key to set.\n\t * @param {*} value - The value to store.\n\t * @param {boolean} [bypass=false] - Internal parameter for setWithEvicted method.\n\t * @param {boolean} [resetTtl=this.resetTtl] - Whether to reset the TTL for this operation.\n\t * @returns {LRU} The LRU instance for method chaining.\n\t * @example\n\t * cache.set('key1', 'value1')\n\t *      .set('key2', 'value2')\n\t *      .set('key3', 'value3');\n\t * @see {@link LRU#get}\n\t * @see {@link LRU#setWithEvicted}\n\t * @since 1.0.0\n\t */\n\tset (key, value, bypass = false, resetTtl = this.resetTtl) {\n\t\tlet item = this.items[key];\n\n\t\tif (bypass || item !== undefined) {\n\t\t\t// Existing item: update value and position\n\t\t\titem.value = value;\n\n\t\t\tif (bypass === false && resetTtl) {\n\t\t\t\titem.expiry = this.ttl > 0 ? Date.now() + this.ttl : this.ttl;\n\t\t\t}\n\n\t\t\t// Always move to end, but the bypass parameter affects TTL reset behavior\n\t\t\tthis.moveToEnd(item);\n\t\t} else {\n\t\t\t// New item: check for eviction and create\n\t\t\tif (this.max > 0 && this.size === this.max) {\n\t\t\t\tthis.evict(true);\n\t\t\t}\n\n\t\t\titem = this.items[key] = {\n\t\t\t\texpiry: this.ttl > 0 ? Date.now() + this.ttl : this.ttl,\n\t\t\t\tkey: key,\n\t\t\t\tprev: this.last,\n\t\t\t\tnext: null,\n\t\t\t\tvalue\n\t\t\t};\n\n\t\t\tif (++this.size === 1) {\n\t\t\t\tthis.first = item;\n\t\t\t} else {\n\t\t\t\tthis.last.next = item;\n\t\t\t}\n\n\t\t\tthis.last = item;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns an array of all values in the cache for the specified keys.\n\t * Order follows LRU order (least to most recently used).\n\t *\n\t * @method values\n\t * @memberof LRU\n\t * @param {string[]} [keys=this.keys()] - Array of keys to get values for. Defaults to all keys.\n\t * @returns {Array<*>} Array of values corresponding to the keys in LRU order.\n\t * @example\n\t * cache.set('a', 1).set('b', 2);\n\t * console.log(cache.values()); // [1, 2]\n\t * console.log(cache.values(['a'])); // [1]\n\t * @see {@link LRU#keys}\n\t * @see {@link LRU#entries}\n\t * @since 11.1.0\n\t */\n\tvalues (keys = this.keys()) {\n\t\treturn keys.map(key => this.get(key));\n\t}\n}\n\n/**\n * Factory function to create a new LRU cache instance with parameter validation.\n *\n * @function lru\n * @param {number} [max=1000] - Maximum number of items to store. Must be >= 0. Use 0 for unlimited size.\n * @param {number} [ttl=0] - Time to live in milliseconds. Must be >= 0. Use 0 for no expiration.\n * @param {boolean} [resetTtl=false] - Whether to reset TTL when accessing existing items via get().\n * @returns {LRU} A new LRU cache instance.\n * @throws {TypeError} When parameters are invalid (negative numbers or wrong types).\n * @example\n * // Create cache with factory function\n * const cache = lru(100, 5000, true);\n * cache.set('key', 'value');\n *\n * @example\n * // Error handling\n * try {\n *   const cache = lru(-1); // Invalid max\n * } catch (error) {\n *   console.error(error.message); // \"Invalid max value\"\n * }\n * @see {@link LRU}\n * @since 1.0.0\n */\nfunction lru (max = 1000, ttl = 0, resetTtl = false) {\n\tif (isNaN(max) || max < 0) {\n\t\tthrow new TypeError(\"Invalid max value\");\n\t}\n\n\tif (isNaN(ttl) || ttl < 0) {\n\t\tthrow new TypeError(\"Invalid ttl value\");\n\t}\n\n\tif (typeof resetTtl !== \"boolean\") {\n\t\tthrow new TypeError(\"Invalid resetTtl value\");\n\t}\n\n\treturn new LRU(max, ttl, resetTtl);\n}export{LRU,lru};","\"use strict\";\nconst genericFontFamilies = [\n  \"serif\",\n  \"sans-serif\",\n  \"monospace\",\n  \"cursive\",\n  \"fantasy\",\n  \"system-ui\"\n];\nfunction fontStringFromTextStyle(style) {\n  const fontSizeString = typeof style.fontSize === \"number\" ? `${style.fontSize}px` : style.fontSize;\n  let fontFamilies = style.fontFamily;\n  if (!Array.isArray(style.fontFamily)) {\n    fontFamilies = style.fontFamily.split(\",\");\n  }\n  for (let i = fontFamilies.length - 1; i >= 0; i--) {\n    let fontFamily = fontFamilies[i].trim();\n    if (!/([\\\"\\'])[^\\'\\\"]+\\1/.test(fontFamily) && !genericFontFamilies.includes(fontFamily)) {\n      fontFamily = `\"${fontFamily}\"`;\n    }\n    fontFamilies[i] = fontFamily;\n  }\n  return `${style.fontStyle} ${style.fontVariant} ${style.fontWeight} ${fontSizeString} ${fontFamilies.join(\",\")}`;\n}\n\nexport { fontStringFromTextStyle };\n//# sourceMappingURL=fontStringFromTextStyle.mjs.map\n","import { lru } from 'tiny-lru';\nimport { DOMAdapter } from '../../../environment/adapter.mjs';\nimport { fontStringFromTextStyle } from './utils/fontStringFromTextStyle.mjs';\n\n\"use strict\";\nconst contextSettings = {\n  // TextMetrics requires getImageData readback for measuring fonts.\n  willReadFrequently: true\n};\nconst _CanvasTextMetrics = class _CanvasTextMetrics {\n  /**\n   * Checking that we can use modern canvas 2D API.\n   *\n   * Note: This is an unstable API, Chrome < 94 use `textLetterSpacing`, later versions use `letterSpacing`.\n   * @see TextMetrics.experimentalLetterSpacing\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/ICanvasRenderingContext2D/letterSpacing\n   * @see https://developer.chrome.com/origintrials/#/view_trial/3585991203293757441\n   */\n  static get experimentalLetterSpacingSupported() {\n    let result = _CanvasTextMetrics._experimentalLetterSpacingSupported;\n    if (result === void 0) {\n      const proto = DOMAdapter.get().getCanvasRenderingContext2D().prototype;\n      result = _CanvasTextMetrics._experimentalLetterSpacingSupported = \"letterSpacing\" in proto || \"textLetterSpacing\" in proto;\n    }\n    return result;\n  }\n  /**\n   * @param text - the text that was measured\n   * @param style - the style that was measured\n   * @param width - the measured width of the text\n   * @param height - the measured height of the text\n   * @param lines - an array of the lines of text broken by new lines and wrapping if specified in style\n   * @param lineWidths - an array of the line widths for each line matched to `lines`\n   * @param lineHeight - the measured line height for this style\n   * @param maxLineWidth - the maximum line width for all measured lines\n   * @param {FontMetrics} fontProperties - the font properties object from TextMetrics.measureFont\n   */\n  constructor(text, style, width, height, lines, lineWidths, lineHeight, maxLineWidth, fontProperties) {\n    this.text = text;\n    this.style = style;\n    this.width = width;\n    this.height = height;\n    this.lines = lines;\n    this.lineWidths = lineWidths;\n    this.lineHeight = lineHeight;\n    this.maxLineWidth = maxLineWidth;\n    this.fontProperties = fontProperties;\n  }\n  /**\n   * Measures the supplied string of text and returns a Rectangle.\n   * @param text - The text to measure.\n   * @param style - The text style to use for measuring\n   * @param canvas - optional specification of the canvas to use for measuring.\n   * @param wordWrap\n   * @returns Measured width and height of the text.\n   */\n  static measureText(text = \" \", style, canvas = _CanvasTextMetrics._canvas, wordWrap = style.wordWrap) {\n    const textKey = `${text}-${style.styleKey}-wordWrap-${wordWrap}`;\n    if (_CanvasTextMetrics._measurementCache.has(textKey)) {\n      return _CanvasTextMetrics._measurementCache.get(textKey);\n    }\n    const font = fontStringFromTextStyle(style);\n    const fontProperties = _CanvasTextMetrics.measureFont(font);\n    if (fontProperties.fontSize === 0) {\n      fontProperties.fontSize = style.fontSize;\n      fontProperties.ascent = style.fontSize;\n    }\n    const context = _CanvasTextMetrics.__context;\n    context.font = font;\n    const outputText = wordWrap ? _CanvasTextMetrics._wordWrap(text, style, canvas) : text;\n    const lines = outputText.split(/(?:\\r\\n|\\r|\\n)/);\n    const lineWidths = new Array(lines.length);\n    let maxLineWidth = 0;\n    for (let i = 0; i < lines.length; i++) {\n      const lineWidth = _CanvasTextMetrics._measureText(lines[i], style.letterSpacing, context);\n      lineWidths[i] = lineWidth;\n      maxLineWidth = Math.max(maxLineWidth, lineWidth);\n    }\n    const strokeWidth = style._stroke?.width || 0;\n    let width = maxLineWidth + strokeWidth;\n    if (style.dropShadow) {\n      width += style.dropShadow.distance;\n    }\n    const lineHeight = style.lineHeight || fontProperties.fontSize;\n    let height = Math.max(lineHeight, fontProperties.fontSize + strokeWidth) + (lines.length - 1) * (lineHeight + style.leading);\n    if (style.dropShadow) {\n      height += style.dropShadow.distance;\n    }\n    const measurements = new _CanvasTextMetrics(\n      text,\n      style,\n      width,\n      height,\n      lines,\n      lineWidths,\n      lineHeight + style.leading,\n      maxLineWidth,\n      fontProperties\n    );\n    _CanvasTextMetrics._measurementCache.set(textKey, measurements);\n    return measurements;\n  }\n  static _measureText(text, letterSpacing, context) {\n    let useExperimentalLetterSpacing = false;\n    if (_CanvasTextMetrics.experimentalLetterSpacingSupported) {\n      if (_CanvasTextMetrics.experimentalLetterSpacing) {\n        context.letterSpacing = `${letterSpacing}px`;\n        context.textLetterSpacing = `${letterSpacing}px`;\n        useExperimentalLetterSpacing = true;\n      } else {\n        context.letterSpacing = \"0px\";\n        context.textLetterSpacing = \"0px\";\n      }\n    }\n    const metrics = context.measureText(text);\n    let metricWidth = metrics.width;\n    const actualBoundingBoxLeft = -metrics.actualBoundingBoxLeft;\n    const actualBoundingBoxRight = metrics.actualBoundingBoxRight;\n    let boundsWidth = actualBoundingBoxRight - actualBoundingBoxLeft;\n    if (metricWidth > 0) {\n      if (useExperimentalLetterSpacing) {\n        metricWidth -= letterSpacing;\n        boundsWidth -= letterSpacing;\n      } else {\n        const val = (_CanvasTextMetrics.graphemeSegmenter(text).length - 1) * letterSpacing;\n        metricWidth += val;\n        boundsWidth += val;\n      }\n    }\n    return Math.max(metricWidth, boundsWidth);\n  }\n  /**\n   * Applies newlines to a string to have it optimally fit into the horizontal\n   * bounds set by the Text object's wordWrapWidth property.\n   * @param text - String to apply word wrapping to\n   * @param style - the style to use when wrapping\n   * @param canvas - optional specification of the canvas to use for measuring.\n   * @returns New string with new lines applied where required\n   */\n  static _wordWrap(text, style, canvas = _CanvasTextMetrics._canvas) {\n    const context = canvas.getContext(\"2d\", contextSettings);\n    let width = 0;\n    let line = \"\";\n    let lines = \"\";\n    const cache = /* @__PURE__ */ Object.create(null);\n    const { letterSpacing, whiteSpace } = style;\n    const collapseSpaces = _CanvasTextMetrics._collapseSpaces(whiteSpace);\n    const collapseNewlines = _CanvasTextMetrics._collapseNewlines(whiteSpace);\n    let canPrependSpaces = !collapseSpaces;\n    const wordWrapWidth = style.wordWrapWidth + letterSpacing;\n    const tokens = _CanvasTextMetrics._tokenize(text);\n    for (let i = 0; i < tokens.length; i++) {\n      let token = tokens[i];\n      if (_CanvasTextMetrics._isNewline(token)) {\n        if (!collapseNewlines) {\n          lines += _CanvasTextMetrics._addLine(line);\n          canPrependSpaces = !collapseSpaces;\n          line = \"\";\n          width = 0;\n          continue;\n        }\n        token = \" \";\n      }\n      if (collapseSpaces) {\n        const currIsBreakingSpace = _CanvasTextMetrics.isBreakingSpace(token);\n        const lastIsBreakingSpace = _CanvasTextMetrics.isBreakingSpace(line[line.length - 1]);\n        if (currIsBreakingSpace && lastIsBreakingSpace) {\n          continue;\n        }\n      }\n      const tokenWidth = _CanvasTextMetrics._getFromCache(token, letterSpacing, cache, context);\n      if (tokenWidth > wordWrapWidth) {\n        if (line !== \"\") {\n          lines += _CanvasTextMetrics._addLine(line);\n          line = \"\";\n          width = 0;\n        }\n        if (_CanvasTextMetrics.canBreakWords(token, style.breakWords)) {\n          const characters = _CanvasTextMetrics.wordWrapSplit(token);\n          for (let j = 0; j < characters.length; j++) {\n            let char = characters[j];\n            let lastChar = char;\n            let k = 1;\n            while (characters[j + k]) {\n              const nextChar = characters[j + k];\n              if (!_CanvasTextMetrics.canBreakChars(lastChar, nextChar, token, j, style.breakWords)) {\n                char += nextChar;\n              } else {\n                break;\n              }\n              lastChar = nextChar;\n              k++;\n            }\n            j += k - 1;\n            const characterWidth = _CanvasTextMetrics._getFromCache(char, letterSpacing, cache, context);\n            if (characterWidth + width > wordWrapWidth) {\n              lines += _CanvasTextMetrics._addLine(line);\n              canPrependSpaces = false;\n              line = \"\";\n              width = 0;\n            }\n            line += char;\n            width += characterWidth;\n          }\n        } else {\n          if (line.length > 0) {\n            lines += _CanvasTextMetrics._addLine(line);\n            line = \"\";\n            width = 0;\n          }\n          const isLastToken = i === tokens.length - 1;\n          lines += _CanvasTextMetrics._addLine(token, !isLastToken);\n          canPrependSpaces = false;\n          line = \"\";\n          width = 0;\n        }\n      } else {\n        if (tokenWidth + width > wordWrapWidth) {\n          canPrependSpaces = false;\n          lines += _CanvasTextMetrics._addLine(line);\n          line = \"\";\n          width = 0;\n        }\n        if (line.length > 0 || !_CanvasTextMetrics.isBreakingSpace(token) || canPrependSpaces) {\n          line += token;\n          width += tokenWidth;\n        }\n      }\n    }\n    lines += _CanvasTextMetrics._addLine(line, false);\n    return lines;\n  }\n  /**\n   * Convenience function for logging each line added during the wordWrap method.\n   * @param line    - The line of text to add\n   * @param newLine - Add new line character to end\n   * @returns A formatted line\n   */\n  static _addLine(line, newLine = true) {\n    line = _CanvasTextMetrics._trimRight(line);\n    line = newLine ? `${line}\n` : line;\n    return line;\n  }\n  /**\n   * Gets & sets the widths of calculated characters in a cache object\n   * @param key            - The key\n   * @param letterSpacing  - The letter spacing\n   * @param cache          - The cache\n   * @param context        - The canvas context\n   * @returns The from cache.\n   */\n  static _getFromCache(key, letterSpacing, cache, context) {\n    let width = cache[key];\n    if (typeof width !== \"number\") {\n      width = _CanvasTextMetrics._measureText(key, letterSpacing, context) + letterSpacing;\n      cache[key] = width;\n    }\n    return width;\n  }\n  /**\n   * Determines whether we should collapse breaking spaces.\n   * @param whiteSpace - The TextStyle property whiteSpace\n   * @returns Should collapse\n   */\n  static _collapseSpaces(whiteSpace) {\n    return whiteSpace === \"normal\" || whiteSpace === \"pre-line\";\n  }\n  /**\n   * Determines whether we should collapse newLine chars.\n   * @param whiteSpace - The white space\n   * @returns should collapse\n   */\n  static _collapseNewlines(whiteSpace) {\n    return whiteSpace === \"normal\";\n  }\n  /**\n   * Trims breaking whitespaces from string.\n   * @param text - The text\n   * @returns Trimmed string\n   */\n  static _trimRight(text) {\n    if (typeof text !== \"string\") {\n      return \"\";\n    }\n    for (let i = text.length - 1; i >= 0; i--) {\n      const char = text[i];\n      if (!_CanvasTextMetrics.isBreakingSpace(char)) {\n        break;\n      }\n      text = text.slice(0, -1);\n    }\n    return text;\n  }\n  /**\n   * Determines if char is a newline.\n   * @param char - The character\n   * @returns True if newline, False otherwise.\n   */\n  static _isNewline(char) {\n    if (typeof char !== \"string\") {\n      return false;\n    }\n    return _CanvasTextMetrics._newlines.includes(char.charCodeAt(0));\n  }\n  /**\n   * Determines if char is a breaking whitespace.\n   *\n   * It allows one to determine whether char should be a breaking whitespace\n   * For example certain characters in CJK langs or numbers.\n   * It must return a boolean.\n   * @param char - The character\n   * @param [_nextChar] - The next character\n   * @returns True if whitespace, False otherwise.\n   */\n  static isBreakingSpace(char, _nextChar) {\n    if (typeof char !== \"string\") {\n      return false;\n    }\n    return _CanvasTextMetrics._breakingSpaces.includes(char.charCodeAt(0));\n  }\n  /**\n   * Splits a string into words, breaking-spaces and newLine characters\n   * @param text - The text\n   * @returns A tokenized array\n   */\n  static _tokenize(text) {\n    const tokens = [];\n    let token = \"\";\n    if (typeof text !== \"string\") {\n      return tokens;\n    }\n    for (let i = 0; i < text.length; i++) {\n      const char = text[i];\n      const nextChar = text[i + 1];\n      if (_CanvasTextMetrics.isBreakingSpace(char, nextChar) || _CanvasTextMetrics._isNewline(char)) {\n        if (token !== \"\") {\n          tokens.push(token);\n          token = \"\";\n        }\n        if (char === \"\\r\" && nextChar === \"\\n\") {\n          tokens.push(\"\\r\\n\");\n          i++;\n        } else {\n          tokens.push(char);\n        }\n        continue;\n      }\n      token += char;\n    }\n    if (token !== \"\") {\n      tokens.push(token);\n    }\n    return tokens;\n  }\n  /**\n   * Overridable helper method used internally by TextMetrics, exposed to allow customizing the class's behavior.\n   *\n   * It allows one to customise which words should break\n   * Examples are if the token is CJK or numbers.\n   * It must return a boolean.\n   * @param _token - The token\n   * @param breakWords - The style attr break words\n   * @returns Whether to break word or not\n   */\n  static canBreakWords(_token, breakWords) {\n    return breakWords;\n  }\n  /**\n   * Overridable helper method used internally by TextMetrics, exposed to allow customizing the class's behavior.\n   *\n   * It allows one to determine whether a pair of characters\n   * should be broken by newlines\n   * For example certain characters in CJK langs or numbers.\n   * It must return a boolean.\n   * @param _char - The character\n   * @param _nextChar - The next character\n   * @param _token - The token/word the characters are from\n   * @param _index - The index in the token of the char\n   * @param _breakWords - The style attr break words\n   * @returns whether to break word or not\n   */\n  static canBreakChars(_char, _nextChar, _token, _index, _breakWords) {\n    return true;\n  }\n  /**\n   * Overridable helper method used internally by TextMetrics, exposed to allow customizing the class's behavior.\n   *\n   * It is called when a token (usually a word) has to be split into separate pieces\n   * in order to determine the point to break a word.\n   * It must return an array of characters.\n   * @param token - The token to split\n   * @returns The characters of the token\n   * @see CanvasTextMetrics.graphemeSegmenter\n   */\n  static wordWrapSplit(token) {\n    return _CanvasTextMetrics.graphemeSegmenter(token);\n  }\n  /**\n   * Calculates the ascent, descent and fontSize of a given font-style\n   * @param font - String representing the style of the font\n   * @returns Font properties object\n   */\n  static measureFont(font) {\n    if (_CanvasTextMetrics._fonts[font]) {\n      return _CanvasTextMetrics._fonts[font];\n    }\n    const context = _CanvasTextMetrics._context;\n    context.font = font;\n    const metrics = context.measureText(_CanvasTextMetrics.METRICS_STRING + _CanvasTextMetrics.BASELINE_SYMBOL);\n    const properties = {\n      ascent: metrics.actualBoundingBoxAscent,\n      descent: metrics.actualBoundingBoxDescent,\n      fontSize: metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent\n    };\n    _CanvasTextMetrics._fonts[font] = properties;\n    return properties;\n  }\n  /**\n   * Clear font metrics in metrics cache.\n   * @param {string} [font] - font name. If font name not set then clear cache for all fonts.\n   */\n  static clearMetrics(font = \"\") {\n    if (font) {\n      delete _CanvasTextMetrics._fonts[font];\n    } else {\n      _CanvasTextMetrics._fonts = {};\n    }\n  }\n  /**\n   * Cached canvas element for measuring text\n   * TODO: this should be private, but isn't because of backward compat, will fix later.\n   * @ignore\n   */\n  static get _canvas() {\n    if (!_CanvasTextMetrics.__canvas) {\n      let canvas;\n      try {\n        const c = new OffscreenCanvas(0, 0);\n        const context = c.getContext(\"2d\", contextSettings);\n        if (context?.measureText) {\n          _CanvasTextMetrics.__canvas = c;\n          return c;\n        }\n        canvas = DOMAdapter.get().createCanvas();\n      } catch (_cx) {\n        canvas = DOMAdapter.get().createCanvas();\n      }\n      canvas.width = canvas.height = 10;\n      _CanvasTextMetrics.__canvas = canvas;\n    }\n    return _CanvasTextMetrics.__canvas;\n  }\n  /**\n   * TODO: this should be private, but isn't because of backward compat, will fix later.\n   * @ignore\n   */\n  static get _context() {\n    if (!_CanvasTextMetrics.__context) {\n      _CanvasTextMetrics.__context = _CanvasTextMetrics._canvas.getContext(\"2d\", contextSettings);\n    }\n    return _CanvasTextMetrics.__context;\n  }\n};\n/**\n * String used for calculate font metrics.\n * These characters are all tall to help calculate the height required for text.\n */\n_CanvasTextMetrics.METRICS_STRING = \"|\\xC9q\\xC5\";\n/** Baseline symbol for calculate font metrics. */\n_CanvasTextMetrics.BASELINE_SYMBOL = \"M\";\n/** Baseline multiplier for calculate font metrics. */\n_CanvasTextMetrics.BASELINE_MULTIPLIER = 1.4;\n/** Height multiplier for setting height of canvas to calculate font metrics. */\n_CanvasTextMetrics.HEIGHT_MULTIPLIER = 2;\n/**\n * A Unicode \"character\", or \"grapheme cluster\", can be composed of multiple Unicode code points,\n * such as letters with diacritical marks (e.g. `'\\u0065\\u0301'`, letter e with acute)\n * or emojis with modifiers (e.g. `'\\uD83E\\uDDD1\\u200D\\uD83D\\uDCBB'`, technologist).\n * The new `Intl.Segmenter` API in ES2022 can split the string into grapheme clusters correctly. If it is not available,\n * PixiJS will fallback to use the iterator of String, which can only spilt the string into code points.\n * If you want to get full functionality in environments that don't support `Intl.Segmenter` (such as Firefox),\n * you can use other libraries such as [grapheme-splitter]{@link https://www.npmjs.com/package/grapheme-splitter}\n * or [graphemer]{@link https://www.npmjs.com/package/graphemer} to create a polyfill. Since these libraries can be\n * relatively large in size to handle various Unicode grapheme clusters properly, PixiJS won't use them directly.\n */\n_CanvasTextMetrics.graphemeSegmenter = (() => {\n  if (typeof Intl?.Segmenter === \"function\") {\n    const segmenter = new Intl.Segmenter();\n    return (s) => {\n      const segments = segmenter.segment(s);\n      const result = [];\n      let i = 0;\n      for (const segment of segments) {\n        result[i++] = segment.segment;\n      }\n      return result;\n    };\n  }\n  return (s) => [...s];\n})();\n/**\n * New rendering behavior for letter-spacing which uses Chrome's new native API. This will\n * lead to more accurate letter-spacing results because it does not try to manually draw\n * each character. However, this Chrome API is experimental and may not serve all cases yet.\n * @see TextMetrics.experimentalLetterSpacingSupported\n */\n_CanvasTextMetrics.experimentalLetterSpacing = false;\n/** Cache of {@link TextMetrics.FontMetrics} objects. */\n_CanvasTextMetrics._fonts = {};\n/** Cache of new line chars. */\n_CanvasTextMetrics._newlines = [\n  10,\n  // line feed\n  13\n  // carriage return\n];\n/** Cache of breaking spaces. */\n_CanvasTextMetrics._breakingSpaces = [\n  9,\n  // character tabulation\n  32,\n  // space\n  8192,\n  // en quad\n  8193,\n  // em quad\n  8194,\n  // en space\n  8195,\n  // em space\n  8196,\n  // three-per-em space\n  8197,\n  // four-per-em space\n  8198,\n  // six-per-em space\n  8200,\n  // punctuation space\n  8201,\n  // thin space\n  8202,\n  // hair space\n  8287,\n  // medium mathematical space\n  12288\n  // ideographic space\n];\n/** Cache for measured text metrics */\n_CanvasTextMetrics._measurementCache = lru(1e3);\nlet CanvasTextMetrics = _CanvasTextMetrics;\n\nexport { CanvasTextMetrics };\n//# sourceMappingURL=CanvasTextMetrics.mjs.map\n","import { Color } from '../../../../color/Color.mjs';\nimport { DOMAdapter } from '../../../../environment/adapter.mjs';\nimport { Matrix } from '../../../../maths/matrix/Matrix.mjs';\nimport { ImageSource } from '../../../../rendering/renderers/shared/texture/sources/ImageSource.mjs';\nimport { Texture } from '../../../../rendering/renderers/shared/texture/Texture.mjs';\nimport { uid } from '../../../../utils/data/uid.mjs';\nimport { deprecation } from '../../../../utils/logging/deprecation.mjs';\nimport { definedProps } from '../../../container/utils/definedProps.mjs';\n\n\"use strict\";\nconst emptyColorStops = [{ offset: 0, color: \"white\" }, { offset: 1, color: \"black\" }];\nconst _FillGradient = class _FillGradient {\n  constructor(...args) {\n    /**\n     * Unique identifier for this gradient instance\n     * @internal\n     */\n    this.uid = uid(\"fillGradient\");\n    /**\n     * Internal tick counter to track changes in the gradient.\n     * This is used to invalidate the gradient when the texture changes.\n     * @internal\n     */\n    this._tick = 0;\n    /** Type of gradient - currently only supports 'linear' */\n    this.type = \"linear\";\n    /** Array of color stops defining the gradient */\n    this.colorStops = [];\n    let options = ensureGradientOptions(args);\n    const defaults = options.type === \"radial\" ? _FillGradient.defaultRadialOptions : _FillGradient.defaultLinearOptions;\n    options = { ...defaults, ...definedProps(options) };\n    this._textureSize = options.textureSize;\n    this._wrapMode = options.wrapMode;\n    if (options.type === \"radial\") {\n      this.center = options.center;\n      this.outerCenter = options.outerCenter ?? this.center;\n      this.innerRadius = options.innerRadius;\n      this.outerRadius = options.outerRadius;\n      this.scale = options.scale;\n      this.rotation = options.rotation;\n    } else {\n      this.start = options.start;\n      this.end = options.end;\n    }\n    this.textureSpace = options.textureSpace;\n    this.type = options.type;\n    options.colorStops.forEach((stop) => {\n      this.addColorStop(stop.offset, stop.color);\n    });\n  }\n  /**\n   * Adds a color stop to the gradient\n   * @param offset - Position of the stop (0-1)\n   * @param color - Color of the stop\n   * @returns This gradient instance for chaining\n   */\n  addColorStop(offset, color) {\n    this.colorStops.push({ offset, color: Color.shared.setValue(color).toHexa() });\n    return this;\n  }\n  /**\n   * Builds the internal texture and transform for the gradient.\n   * Called automatically when the gradient is first used.\n   * @internal\n   */\n  buildLinearGradient() {\n    if (this.texture)\n      return;\n    let { x: x0, y: y0 } = this.start;\n    let { x: x1, y: y1 } = this.end;\n    let dx = x1 - x0;\n    let dy = y1 - y0;\n    const flip = dx < 0 || dy < 0;\n    if (this._wrapMode === \"clamp-to-edge\") {\n      if (dx < 0) {\n        const temp = x0;\n        x0 = x1;\n        x1 = temp;\n        dx *= -1;\n      }\n      if (dy < 0) {\n        const temp = y0;\n        y0 = y1;\n        y1 = temp;\n        dy *= -1;\n      }\n    }\n    const colorStops = this.colorStops.length ? this.colorStops : emptyColorStops;\n    const defaultSize = this._textureSize;\n    const { canvas, context } = getCanvas(defaultSize, 1);\n    const gradient = !flip ? context.createLinearGradient(0, 0, this._textureSize, 0) : context.createLinearGradient(this._textureSize, 0, 0, 0);\n    addColorStops(gradient, colorStops);\n    context.fillStyle = gradient;\n    context.fillRect(0, 0, defaultSize, 1);\n    this.texture = new Texture({\n      source: new ImageSource({\n        resource: canvas,\n        addressMode: this._wrapMode\n      })\n    });\n    const dist = Math.sqrt(dx * dx + dy * dy);\n    const angle = Math.atan2(dy, dx);\n    const m = new Matrix();\n    m.scale(dist / defaultSize, 1);\n    m.rotate(angle);\n    m.translate(x0, y0);\n    if (this.textureSpace === \"local\") {\n      m.scale(defaultSize, defaultSize);\n    }\n    this.transform = m;\n  }\n  /**\n   * Builds the internal texture and transform for the gradient.\n   * Called automatically when the gradient is first used.\n   * @internal\n   */\n  buildGradient() {\n    if (!this.texture)\n      this._tick++;\n    if (this.type === \"linear\") {\n      this.buildLinearGradient();\n    } else {\n      this.buildRadialGradient();\n    }\n  }\n  /**\n   * Builds the internal texture and transform for the radial gradient.\n   * Called automatically when the gradient is first used.\n   * @internal\n   */\n  buildRadialGradient() {\n    if (this.texture)\n      return;\n    const colorStops = this.colorStops.length ? this.colorStops : emptyColorStops;\n    const defaultSize = this._textureSize;\n    const { canvas, context } = getCanvas(defaultSize, defaultSize);\n    const { x: x0, y: y0 } = this.center;\n    const { x: x1, y: y1 } = this.outerCenter;\n    const r0 = this.innerRadius;\n    const r1 = this.outerRadius;\n    const ox = x1 - r1;\n    const oy = y1 - r1;\n    const scale = defaultSize / (r1 * 2);\n    const cx = (x0 - ox) * scale;\n    const cy = (y0 - oy) * scale;\n    const gradient = context.createRadialGradient(\n      cx,\n      cy,\n      r0 * scale,\n      (x1 - ox) * scale,\n      (y1 - oy) * scale,\n      r1 * scale\n    );\n    addColorStops(gradient, colorStops);\n    context.fillStyle = colorStops[colorStops.length - 1].color;\n    context.fillRect(0, 0, defaultSize, defaultSize);\n    context.fillStyle = gradient;\n    context.translate(cx, cy);\n    context.rotate(this.rotation);\n    context.scale(1, this.scale);\n    context.translate(-cx, -cy);\n    context.fillRect(0, 0, defaultSize, defaultSize);\n    this.texture = new Texture({\n      source: new ImageSource({\n        resource: canvas,\n        addressMode: this._wrapMode\n      })\n    });\n    const m = new Matrix();\n    m.scale(1 / scale, 1 / scale);\n    m.translate(ox, oy);\n    if (this.textureSpace === \"local\") {\n      m.scale(defaultSize, defaultSize);\n    }\n    this.transform = m;\n  }\n  /** Destroys the gradient, releasing resources. This will also destroy the internal texture. */\n  destroy() {\n    this.texture?.destroy(true);\n    this.texture = null;\n    this.transform = null;\n    this.colorStops = [];\n    this.start = null;\n    this.end = null;\n    this.center = null;\n    this.outerCenter = null;\n  }\n  /**\n   * Returns a unique key for this gradient instance.\n   * This key is used for caching and texture management.\n   * @returns {string} Unique key for the gradient\n   */\n  get styleKey() {\n    return `fill-gradient-${this.uid}-${this._tick}`;\n  }\n};\n/** Default options for creating a gradient fill */\n_FillGradient.defaultLinearOptions = {\n  start: { x: 0, y: 0 },\n  end: { x: 0, y: 1 },\n  colorStops: [],\n  textureSpace: \"local\",\n  type: \"linear\",\n  textureSize: 256,\n  wrapMode: \"clamp-to-edge\"\n};\n/** Default options for creating a radial gradient fill */\n_FillGradient.defaultRadialOptions = {\n  center: { x: 0.5, y: 0.5 },\n  innerRadius: 0,\n  outerRadius: 0.5,\n  colorStops: [],\n  scale: 1,\n  textureSpace: \"local\",\n  type: \"radial\",\n  textureSize: 256,\n  wrapMode: \"clamp-to-edge\"\n};\nlet FillGradient = _FillGradient;\nfunction addColorStops(gradient, colorStops) {\n  for (let i = 0; i < colorStops.length; i++) {\n    const stop = colorStops[i];\n    gradient.addColorStop(stop.offset, stop.color);\n  }\n}\nfunction getCanvas(width, height) {\n  const canvas = DOMAdapter.get().createCanvas(width, height);\n  const context = canvas.getContext(\"2d\");\n  return { canvas, context };\n}\nfunction ensureGradientOptions(args) {\n  let options = args[0] ?? {};\n  if (typeof options === \"number\" || args[1]) {\n    deprecation(\"8.5.2\", `use options object instead`);\n    options = {\n      type: \"linear\",\n      start: { x: args[0], y: args[1] },\n      end: { x: args[2], y: args[3] },\n      textureSpace: args[4],\n      textureSize: args[5] ?? FillGradient.defaultLinearOptions.textureSize\n    };\n  }\n  return options;\n}\n\nexport { FillGradient };\n//# sourceMappingURL=FillGradient.mjs.map\n","import { Matrix } from '../../../../maths/matrix/Matrix.mjs';\nimport { uid } from '../../../../utils/data/uid.mjs';\n\n\"use strict\";\nconst repetitionMap = {\n  repeat: {\n    addressModeU: \"repeat\",\n    addressModeV: \"repeat\"\n  },\n  \"repeat-x\": {\n    addressModeU: \"repeat\",\n    addressModeV: \"clamp-to-edge\"\n  },\n  \"repeat-y\": {\n    addressModeU: \"clamp-to-edge\",\n    addressModeV: \"repeat\"\n  },\n  \"no-repeat\": {\n    addressModeU: \"clamp-to-edge\",\n    addressModeV: \"clamp-to-edge\"\n  }\n};\nclass FillPattern {\n  constructor(texture, repetition) {\n    /**\n     * unique id for this fill pattern\n     * @internal\n     */\n    this.uid = uid(\"fillPattern\");\n    /**\n     * Internal tick counter to track changes in the pattern.\n     * This is used to invalidate the pattern when the texture or transform changes.\n     * @internal\n     */\n    this._tick = 0;\n    /** The transform matrix applied to the pattern */\n    this.transform = new Matrix();\n    this.texture = texture;\n    this.transform.scale(\n      1 / texture.frame.width,\n      1 / texture.frame.height\n    );\n    if (repetition) {\n      texture.source.style.addressModeU = repetitionMap[repetition].addressModeU;\n      texture.source.style.addressModeV = repetitionMap[repetition].addressModeV;\n    }\n  }\n  /**\n   * Sets the transform for the pattern\n   * @param transform - The transform matrix to apply to the pattern.\n   * If not provided, the pattern will use the default transform.\n   */\n  setTransform(transform) {\n    const texture = this.texture;\n    this.transform.copyFrom(transform);\n    this.transform.invert();\n    this.transform.scale(\n      1 / texture.frame.width,\n      1 / texture.frame.height\n    );\n    this._tick++;\n  }\n  /** Internal texture used to render the gradient */\n  get texture() {\n    return this._texture;\n  }\n  set texture(value) {\n    if (this._texture === value)\n      return;\n    this._texture = value;\n    this._tick++;\n  }\n  /**\n   * Returns a unique key for this instance.\n   * This key is used for caching.\n   * @returns {string} Unique key for the instance\n   */\n  get styleKey() {\n    return `fill-pattern-${this.uid}-${this._tick}`;\n  }\n  /** Destroys the fill pattern, releasing resources. This will also destroy the internal texture. */\n  destroy() {\n    this.texture.destroy(true);\n    this.texture = null;\n  }\n}\n\nexport { FillPattern };\n//# sourceMappingURL=FillPattern.mjs.map\n","\nmodule.exports = parse\n\n/**\n * expected argument lengths\n * @type {Object}\n */\n\nvar length = {a: 7, c: 6, h: 1, l: 2, m: 2, q: 4, s: 4, t: 2, v: 1, z: 0}\n\n/**\n * segment pattern\n * @type {RegExp}\n */\n\nvar segment = /([astvzqmhlc])([^astvzqmhlc]*)/ig\n\n/**\n * parse an svg path data string. Generates an Array\n * of commands where each command is an Array of the\n * form `[command, arg1, arg2, ...]`\n *\n * @param {String} path\n * @return {Array}\n */\n\nfunction parse(path) {\n\tvar data = []\n\tpath.replace(segment, function(_, command, args){\n\t\tvar type = command.toLowerCase()\n\t\targs = parseValues(args)\n\n\t\t// overloaded moveTo\n\t\tif (type == 'm' && args.length > 2) {\n\t\t\tdata.push([command].concat(args.splice(0, 2)))\n\t\t\ttype = 'l'\n\t\t\tcommand = command == 'm' ? 'l' : 'L'\n\t\t}\n\n\t\twhile (true) {\n\t\t\tif (args.length == length[type]) {\n\t\t\t\targs.unshift(command)\n\t\t\t\treturn data.push(args)\n\t\t\t}\n\t\t\tif (args.length < length[type]) throw new Error('malformed path data')\n\t\t\tdata.push([command].concat(args.splice(0, length[type])))\n\t\t}\n\t})\n\treturn data\n}\n\nvar number = /-?[0-9]*\\.?[0-9]+(?:e[-+]?\\d+)?/ig\n\nfunction parseValues(args) {\n\tvar numbers = args.match(number)\n\treturn numbers ? numbers.map(Number) : []\n}\n","import parse from 'parse-svg-path';\nimport { warn } from '../../../../utils/logging/warn.mjs';\n\n\"use strict\";\nfunction parseSVGPath(svgPath, path) {\n  const commands = parse(svgPath);\n  const subpaths = [];\n  let currentSubPath = null;\n  let lastX = 0;\n  let lastY = 0;\n  for (let i = 0; i < commands.length; i++) {\n    const command = commands[i];\n    const type = command[0];\n    const data = command;\n    switch (type) {\n      case \"M\":\n        lastX = data[1];\n        lastY = data[2];\n        path.moveTo(lastX, lastY);\n        break;\n      case \"m\":\n        lastX += data[1];\n        lastY += data[2];\n        path.moveTo(lastX, lastY);\n        break;\n      case \"H\":\n        lastX = data[1];\n        path.lineTo(lastX, lastY);\n        break;\n      case \"h\":\n        lastX += data[1];\n        path.lineTo(lastX, lastY);\n        break;\n      case \"V\":\n        lastY = data[1];\n        path.lineTo(lastX, lastY);\n        break;\n      case \"v\":\n        lastY += data[1];\n        path.lineTo(lastX, lastY);\n        break;\n      case \"L\":\n        lastX = data[1];\n        lastY = data[2];\n        path.lineTo(lastX, lastY);\n        break;\n      case \"l\":\n        lastX += data[1];\n        lastY += data[2];\n        path.lineTo(lastX, lastY);\n        break;\n      case \"C\":\n        lastX = data[5];\n        lastY = data[6];\n        path.bezierCurveTo(\n          data[1],\n          data[2],\n          // First control point\n          data[3],\n          data[4],\n          // Second control point\n          lastX,\n          lastY\n          // End point\n        );\n        break;\n      case \"c\":\n        path.bezierCurveTo(\n          lastX + data[1],\n          lastY + data[2],\n          // First control point\n          lastX + data[3],\n          lastY + data[4],\n          // Second control point\n          lastX + data[5],\n          lastY + data[6]\n          // End point\n        );\n        lastX += data[5];\n        lastY += data[6];\n        break;\n      case \"S\":\n        lastX = data[3];\n        lastY = data[4];\n        path.bezierCurveToShort(\n          data[1],\n          data[2],\n          // Control point\n          lastX,\n          lastY\n          // End point\n        );\n        break;\n      case \"s\":\n        path.bezierCurveToShort(\n          lastX + data[1],\n          lastY + data[2],\n          // Control point\n          lastX + data[3],\n          lastY + data[4]\n          // End point\n        );\n        lastX += data[3];\n        lastY += data[4];\n        break;\n      case \"Q\":\n        lastX = data[3];\n        lastY = data[4];\n        path.quadraticCurveTo(\n          data[1],\n          data[2],\n          // Control point\n          lastX,\n          lastY\n          // End point\n        );\n        break;\n      case \"q\":\n        path.quadraticCurveTo(\n          lastX + data[1],\n          lastY + data[2],\n          // Control point\n          lastX + data[3],\n          lastY + data[4]\n          // End point\n        );\n        lastX += data[3];\n        lastY += data[4];\n        break;\n      case \"T\":\n        lastX = data[1];\n        lastY = data[2];\n        path.quadraticCurveToShort(\n          lastX,\n          lastY\n          // End point\n        );\n        break;\n      case \"t\":\n        lastX += data[1];\n        lastY += data[2];\n        path.quadraticCurveToShort(\n          lastX,\n          lastY\n          // End point\n        );\n        break;\n      case \"A\":\n        lastX = data[6];\n        lastY = data[7];\n        path.arcToSvg(\n          data[1],\n          // rx\n          data[2],\n          // ry\n          data[3],\n          // x-axis-rotation\n          data[4],\n          // large-arc-flag\n          data[5],\n          // sweep-flag\n          lastX,\n          lastY\n          // End point\n        );\n        break;\n      case \"a\":\n        lastX += data[6];\n        lastY += data[7];\n        path.arcToSvg(\n          data[1],\n          // rx\n          data[2],\n          // ry\n          data[3],\n          // x-axis-rotation\n          data[4],\n          // large-arc-flag\n          data[5],\n          // sweep-flag\n          lastX,\n          lastY\n          // End point\n        );\n        break;\n      case \"Z\":\n      case \"z\":\n        path.closePath();\n        if (subpaths.length > 0) {\n          currentSubPath = subpaths.pop();\n          if (currentSubPath) {\n            lastX = currentSubPath.startX;\n            lastY = currentSubPath.startY;\n          } else {\n            lastX = 0;\n            lastY = 0;\n          }\n        }\n        currentSubPath = null;\n        break;\n      default:\n        warn(`Unknown SVG path command: ${type}`);\n    }\n    if (type !== \"Z\" && type !== \"z\") {\n      if (currentSubPath === null) {\n        currentSubPath = { startX: lastX, startY: lastY };\n        subpaths.push(currentSubPath);\n      }\n    }\n  }\n  return path;\n}\n\nexport { parseSVGPath };\n//# sourceMappingURL=parseSVGPath.mjs.map\n","import { Rectangle } from './Rectangle.mjs';\n\n\"use strict\";\nclass Circle {\n  /**\n   * @param x - The X coordinate of the center of this circle\n   * @param y - The Y coordinate of the center of this circle\n   * @param radius - The radius of the circle\n   */\n  constructor(x = 0, y = 0, radius = 0) {\n    /**\n     * The type of the object, mainly used to avoid `instanceof` checks.\n     * @example\n     * ```ts\n     * // Check shape type\n     * const shape = new Circle(0, 0, 50);\n     * console.log(shape.type); // 'circle'\n     *\n     * // Use in type guards\n     * if (shape.type === 'circle') {\n     *     console.log(shape.radius);\n     * }\n     * ```\n     * @remarks\n     * - Used for shape type checking\n     * - More efficient than instanceof\n     * - Read-only property\n     * @readonly\n     * @default 'circle'\n     * @see {@link SHAPE_PRIMITIVE} For all shape types\n     * @see {@link ShapePrimitive} For shape interface\n     */\n    this.type = \"circle\";\n    this.x = x;\n    this.y = y;\n    this.radius = radius;\n  }\n  /**\n   * Creates a clone of this Circle instance.\n   * @example\n   * ```ts\n   * // Basic circle cloning\n   * const original = new Circle(100, 100, 50);\n   * const copy = original.clone();\n   *\n   * // Clone and modify\n   * const modified = original.clone();\n   * modified.radius = 75;\n   *\n   * // Verify independence\n   * console.log(original.radius); // 50\n   * console.log(modified.radius); // 75\n   * ```\n   * @returns A copy of the Circle\n   * @see {@link Circle.copyFrom} For copying into existing circle\n   * @see {@link Circle.copyTo} For copying to another circle\n   */\n  clone() {\n    return new Circle(this.x, this.y, this.radius);\n  }\n  /**\n   * Checks whether the x and y coordinates given are contained within this circle.\n   *\n   * Uses the distance formula to determine if a point is inside the circle's radius.\n   *\n   * Commonly used for hit testing in PixiJS events and graphics.\n   * @example\n   * ```ts\n   * // Basic containment check\n   * const circle = new Circle(100, 100, 50);\n   * const isInside = circle.contains(120, 120);\n   *\n   * // Check mouse position\n   * const circle = new Circle(0, 0, 100);\n   * container.hitArea = circle;\n   * container.on('pointermove', (e) => {\n   *     // only called if pointer is within circle\n   * });\n   * ```\n   * @param x - The X coordinate of the point to test\n   * @param y - The Y coordinate of the point to test\n   * @returns Whether the x/y coordinates are within this Circle\n   * @see {@link Circle.strokeContains} For checking stroke intersection\n   * @see {@link Circle.getBounds} For getting bounding box\n   */\n  contains(x, y) {\n    if (this.radius <= 0)\n      return false;\n    const r2 = this.radius * this.radius;\n    let dx = this.x - x;\n    let dy = this.y - y;\n    dx *= dx;\n    dy *= dy;\n    return dx + dy <= r2;\n  }\n  /**\n   * Checks whether the x and y coordinates given are contained within this circle including the stroke.\n   * @example\n   * ```ts\n   * // Basic stroke check\n   * const circle = new Circle(100, 100, 50);\n   * const isOnStroke = circle.strokeContains(150, 100, 4); // 4px line width\n   *\n   * // Check with different alignments\n   * const innerStroke = circle.strokeContains(150, 100, 4, 1);   // Inside\n   * const centerStroke = circle.strokeContains(150, 100, 4, 0.5); // Centered\n   * const outerStroke = circle.strokeContains(150, 100, 4, 0);   // Outside\n   * ```\n   * @param x - The X coordinate of the point to test\n   * @param y - The Y coordinate of the point to test\n   * @param width - The width of the line to check\n   * @param alignment - The alignment of the stroke, 0.5 by default\n   * @returns Whether the x/y coordinates are within this Circle's stroke\n   * @see {@link Circle.contains} For checking fill containment\n   * @see {@link Circle.getBounds} For getting stroke bounds\n   */\n  strokeContains(x, y, width, alignment = 0.5) {\n    if (this.radius === 0)\n      return false;\n    const dx = this.x - x;\n    const dy = this.y - y;\n    const radius = this.radius;\n    const outerWidth = (1 - alignment) * width;\n    const distance = Math.sqrt(dx * dx + dy * dy);\n    return distance <= radius + outerWidth && distance > radius - (width - outerWidth);\n  }\n  /**\n   * Returns the framing rectangle of the circle as a Rectangle object.\n   * @example\n   * ```ts\n   * // Basic bounds calculation\n   * const circle = new Circle(100, 100, 50);\n   * const bounds = circle.getBounds();\n   * // bounds: x=50, y=50, width=100, height=100\n   *\n   * // Reuse existing rectangle\n   * const rect = new Rectangle();\n   * circle.getBounds(rect);\n   * ```\n   * @param out - Optional Rectangle object to store the result\n   * @returns The framing rectangle\n   * @see {@link Rectangle} For rectangle properties\n   * @see {@link Circle.contains} For point containment\n   */\n  getBounds(out) {\n    out || (out = new Rectangle());\n    out.x = this.x - this.radius;\n    out.y = this.y - this.radius;\n    out.width = this.radius * 2;\n    out.height = this.radius * 2;\n    return out;\n  }\n  /**\n   * Copies another circle to this one.\n   * @example\n   * ```ts\n   * // Basic copying\n   * const source = new Circle(100, 100, 50);\n   * const target = new Circle();\n   * target.copyFrom(source);\n   * ```\n   * @param circle - The circle to copy from\n   * @returns Returns itself\n   * @see {@link Circle.copyTo} For copying to another circle\n   * @see {@link Circle.clone} For creating new circle copy\n   */\n  copyFrom(circle) {\n    this.x = circle.x;\n    this.y = circle.y;\n    this.radius = circle.radius;\n    return this;\n  }\n  /**\n   * Copies this circle to another one.\n   * @example\n   * ```ts\n   * // Basic copying\n   * const source = new Circle(100, 100, 50);\n   * const target = new Circle();\n   * source.copyTo(target);\n   * ```\n   * @param circle - The circle to copy to\n   * @returns Returns given parameter\n   * @see {@link Circle.copyFrom} For copying from another circle\n   * @see {@link Circle.clone} For creating new circle copy\n   */\n  copyTo(circle) {\n    circle.copyFrom(this);\n    return circle;\n  }\n  toString() {\n    return `[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`;\n  }\n}\n\nexport { Circle };\n//# sourceMappingURL=Circle.mjs.map\n","import { Rectangle } from './Rectangle.mjs';\n\n\"use strict\";\nclass Ellipse {\n  /**\n   * @param x - The X coordinate of the center of this ellipse\n   * @param y - The Y coordinate of the center of this ellipse\n   * @param halfWidth - The half width of this ellipse\n   * @param halfHeight - The half height of this ellipse\n   */\n  constructor(x = 0, y = 0, halfWidth = 0, halfHeight = 0) {\n    /**\n     * The type of the object, mainly used to avoid `instanceof` checks\n     * @example\n     * ```ts\n     * // Check shape type\n     * const shape = new Ellipse(0, 0, 50, 25);\n     * console.log(shape.type); // 'ellipse'\n     *\n     * // Use in type guards\n     * if (shape.type === 'ellipse') {\n     *     console.log(shape.halfWidth, shape.halfHeight);\n     * }\n     * ```\n     * @readonly\n     * @default 'ellipse'\n     * @see {@link SHAPE_PRIMITIVE} For all shape types\n     */\n    this.type = \"ellipse\";\n    this.x = x;\n    this.y = y;\n    this.halfWidth = halfWidth;\n    this.halfHeight = halfHeight;\n  }\n  /**\n   * Creates a clone of this Ellipse instance.\n   * @example\n   * ```ts\n   * // Basic cloning\n   * const original = new Ellipse(100, 100, 50, 25);\n   * const copy = original.clone();\n   *\n   * // Clone and modify\n   * const modified = original.clone();\n   * modified.halfWidth *= 2;\n   * modified.halfHeight *= 2;\n   *\n   * // Verify independence\n   * console.log(original.halfWidth);  // 50\n   * console.log(modified.halfWidth);  // 100\n   * ```\n   * @returns A copy of the ellipse\n   * @see {@link Ellipse.copyFrom} For copying into existing ellipse\n   * @see {@link Ellipse.copyTo} For copying to another ellipse\n   */\n  clone() {\n    return new Ellipse(this.x, this.y, this.halfWidth, this.halfHeight);\n  }\n  /**\n   * Checks whether the x and y coordinates given are contained within this ellipse.\n   * Uses normalized coordinates and the ellipse equation to determine containment.\n   * @example\n   * ```ts\n   * // Basic containment check\n   * const ellipse = new Ellipse(100, 100, 50, 25);\n   * const isInside = ellipse.contains(120, 110);\n   * ```\n   * @remarks\n   * - Uses ellipse equation (x/a + y/b  1)\n   * - Returns false if dimensions are 0 or negative\n   * - Normalized to center (0,0) for calculation\n   * @param x - The X coordinate of the point to test\n   * @param y - The Y coordinate of the point to test\n   * @returns Whether the x/y coords are within this ellipse\n   * @see {@link Ellipse.strokeContains} For checking stroke intersection\n   * @see {@link Ellipse.getBounds} For getting containing rectangle\n   */\n  contains(x, y) {\n    if (this.halfWidth <= 0 || this.halfHeight <= 0) {\n      return false;\n    }\n    let normx = (x - this.x) / this.halfWidth;\n    let normy = (y - this.y) / this.halfHeight;\n    normx *= normx;\n    normy *= normy;\n    return normx + normy <= 1;\n  }\n  /**\n   * Checks whether the x and y coordinates given are contained within this ellipse including stroke.\n   * @example\n   * ```ts\n   * // Basic stroke check\n   * const ellipse = new Ellipse(100, 100, 50, 25);\n   * const isOnStroke = ellipse.strokeContains(150, 100, 4); // 4px line width\n   *\n   * // Check with different alignments\n   * const innerStroke = ellipse.strokeContains(150, 100, 4, 1);   // Inside\n   * const centerStroke = ellipse.strokeContains(150, 100, 4, 0.5); // Centered\n   * const outerStroke = ellipse.strokeContains(150, 100, 4, 0);   // Outside\n   * ```\n   * @remarks\n   * - Uses normalized ellipse equations\n   * - Considers stroke alignment\n   * - Returns false if dimensions are 0\n   * @param x - The X coordinate of the point to test\n   * @param y - The Y coordinate of the point to test\n   * @param strokeWidth - The width of the line to check\n   * @param alignment - The alignment of the stroke (1 = inner, 0.5 = centered, 0 = outer)\n   * @returns Whether the x/y coords are within this ellipse's stroke\n   * @see {@link Ellipse.contains} For checking fill containment\n   * @see {@link Ellipse.getBounds} For getting stroke bounds\n   */\n  strokeContains(x, y, strokeWidth, alignment = 0.5) {\n    const { halfWidth, halfHeight } = this;\n    if (halfWidth <= 0 || halfHeight <= 0) {\n      return false;\n    }\n    const strokeOuterWidth = strokeWidth * (1 - alignment);\n    const strokeInnerWidth = strokeWidth - strokeOuterWidth;\n    const innerHorizontal = halfWidth - strokeInnerWidth;\n    const innerVertical = halfHeight - strokeInnerWidth;\n    const outerHorizontal = halfWidth + strokeOuterWidth;\n    const outerVertical = halfHeight + strokeOuterWidth;\n    const normalizedX = x - this.x;\n    const normalizedY = y - this.y;\n    const innerEllipse = normalizedX * normalizedX / (innerHorizontal * innerHorizontal) + normalizedY * normalizedY / (innerVertical * innerVertical);\n    const outerEllipse = normalizedX * normalizedX / (outerHorizontal * outerHorizontal) + normalizedY * normalizedY / (outerVertical * outerVertical);\n    return innerEllipse > 1 && outerEllipse <= 1;\n  }\n  /**\n   * Returns the framing rectangle of the ellipse as a Rectangle object.\n   * @example\n   * ```ts\n   * // Basic bounds calculation\n   * const ellipse = new Ellipse(100, 100, 50, 25);\n   * const bounds = ellipse.getBounds();\n   * // bounds: x=50, y=75, width=100, height=50\n   *\n   * // Reuse existing rectangle\n   * const rect = new Rectangle();\n   * ellipse.getBounds(rect);\n   * ```\n   * @remarks\n   * - Creates Rectangle if none provided\n   * - Top-left is (x-halfWidth, y-halfHeight)\n   * - Width is halfWidth * 2\n   * - Height is halfHeight * 2\n   * @param out - Optional Rectangle object to store the result\n   * @returns The framing rectangle\n   * @see {@link Rectangle} For rectangle properties\n   * @see {@link Ellipse.contains} For checking if a point is inside\n   */\n  getBounds(out) {\n    out || (out = new Rectangle());\n    out.x = this.x - this.halfWidth;\n    out.y = this.y - this.halfHeight;\n    out.width = this.halfWidth * 2;\n    out.height = this.halfHeight * 2;\n    return out;\n  }\n  /**\n   * Copies another ellipse to this one.\n   * @example\n   * ```ts\n   * // Basic copying\n   * const source = new Ellipse(100, 100, 50, 25);\n   * const target = new Ellipse();\n   * target.copyFrom(source);\n   * ```\n   * @param ellipse - The ellipse to copy from\n   * @returns Returns itself\n   * @see {@link Ellipse.copyTo} For copying to another ellipse\n   * @see {@link Ellipse.clone} For creating new ellipse copy\n   */\n  copyFrom(ellipse) {\n    this.x = ellipse.x;\n    this.y = ellipse.y;\n    this.halfWidth = ellipse.halfWidth;\n    this.halfHeight = ellipse.halfHeight;\n    return this;\n  }\n  /**\n   * Copies this ellipse to another one.\n   * @example\n   * ```ts\n   * // Basic copying\n   * const source = new Ellipse(100, 100, 50, 25);\n   * const target = new Ellipse();\n   * source.copyTo(target);\n   * ```\n   * @param ellipse - The ellipse to copy to\n   * @returns Returns given parameter\n   * @see {@link Ellipse.copyFrom} For copying from another ellipse\n   * @see {@link Ellipse.clone} For creating new ellipse copy\n   */\n  copyTo(ellipse) {\n    ellipse.copyFrom(this);\n    return ellipse;\n  }\n  toString() {\n    return `[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`;\n  }\n}\n\nexport { Ellipse };\n//# sourceMappingURL=Ellipse.mjs.map\n","\"use strict\";\nfunction squaredDistanceToLineSegment(x, y, x1, y1, x2, y2) {\n  const a = x - x1;\n  const b = y - y1;\n  const c = x2 - x1;\n  const d = y2 - y1;\n  const dot = a * c + b * d;\n  const lenSq = c * c + d * d;\n  let param = -1;\n  if (lenSq !== 0) {\n    param = dot / lenSq;\n  }\n  let xx;\n  let yy;\n  if (param < 0) {\n    xx = x1;\n    yy = y1;\n  } else if (param > 1) {\n    xx = x2;\n    yy = y2;\n  } else {\n    xx = x1 + param * c;\n    yy = y1 + param * d;\n  }\n  const dx = x - xx;\n  const dy = y - yy;\n  return dx * dx + dy * dy;\n}\n\nexport { squaredDistanceToLineSegment };\n//# sourceMappingURL=squaredDistanceToLineSegment.mjs.map\n","import { deprecation } from '../../utils/logging/deprecation.mjs';\nimport { squaredDistanceToLineSegment } from '../misc/squaredDistanceToLineSegment.mjs';\nimport { Rectangle } from './Rectangle.mjs';\n\n\"use strict\";\nlet tempRect;\nlet tempRect2;\nclass Polygon {\n  /**\n   * @param points - This can be an array of Points\n   *  that form the polygon, a flat array of numbers that will be interpreted as [x,y, x,y, ...], or\n   *  the arguments passed can be all the points of the polygon e.g.\n   *  `new Polygon(new Point(), new Point(), ...)`, or the arguments passed can be flat\n   *  x,y values e.g. `new Polygon(x,y, x,y, x,y, ...)` where `x` and `y` are Numbers.\n   */\n  constructor(...points) {\n    /**\n     * The type of the object, mainly used to avoid `instanceof` checks\n     * @example\n     * ```ts\n     * // Check shape type\n     * const shape = new Polygon([0, 0, 100, 0, 50, 100]);\n     * console.log(shape.type); // 'polygon'\n     *\n     * // Use in type guards\n     * if (shape.type === 'polygon') {\n     *     // TypeScript knows this is a Polygon\n     *     console.log(shape.points.length);\n     * }\n     * ```\n     * @readonly\n     * @default 'polygon'\n     * @see {@link SHAPE_PRIMITIVE} For all shape types\n     */\n    this.type = \"polygon\";\n    let flat = Array.isArray(points[0]) ? points[0] : points;\n    if (typeof flat[0] !== \"number\") {\n      const p = [];\n      for (let i = 0, il = flat.length; i < il; i++) {\n        p.push(flat[i].x, flat[i].y);\n      }\n      flat = p;\n    }\n    this.points = flat;\n    this.closePath = true;\n  }\n  /**\n   * Determines whether the polygon's points are arranged in a clockwise direction.\n   * Uses the shoelace formula (surveyor's formula) to calculate the signed area.\n   *\n   * A positive area indicates clockwise winding, while negative indicates counter-clockwise.\n   *\n   * The formula sums up the cross products of adjacent vertices:\n   * For each pair of adjacent points (x1,y1) and (x2,y2), we calculate (x1*y2 - x2*y1)\n   * The final sum divided by 2 gives the signed area - positive for clockwise.\n   * @example\n   * ```ts\n   * // Check polygon winding\n   * const polygon = new Polygon([0, 0, 100, 0, 50, 100]);\n   * console.log(polygon.isClockwise()); // Check direction\n   *\n   * // Use in path construction\n   * const hole = new Polygon([25, 25, 75, 25, 75, 75, 25, 75]);\n   * if (hole.isClockwise() === shape.isClockwise()) {\n   *     hole.points.reverse(); // Reverse for proper hole winding\n   * }\n   * ```\n   * @returns `true` if the polygon's points are arranged clockwise, `false` if counter-clockwise\n   */\n  isClockwise() {\n    let area = 0;\n    const points = this.points;\n    const length = points.length;\n    for (let i = 0; i < length; i += 2) {\n      const x1 = points[i];\n      const y1 = points[i + 1];\n      const x2 = points[(i + 2) % length];\n      const y2 = points[(i + 3) % length];\n      area += (x2 - x1) * (y2 + y1);\n    }\n    return area < 0;\n  }\n  /**\n   * Checks if this polygon completely contains another polygon.\n   * Used for detecting holes in shapes, like when parsing SVG paths.\n   * @example\n   * ```ts\n   * // Basic containment check\n   * const outerSquare = new Polygon([0,0, 100,0, 100,100, 0,100]); // A square\n   * const innerSquare = new Polygon([25,25, 75,25, 75,75, 25,75]); // A smaller square inside\n   *\n   * outerSquare.containsPolygon(innerSquare); // Returns true\n   * innerSquare.containsPolygon(outerSquare); // Returns false\n   * ```\n   * @remarks\n   * - Uses bounds check for quick rejection\n   * - Tests all points for containment\n   * @param polygon - The polygon to test for containment\n   * @returns True if this polygon completely contains the other polygon\n   * @see {@link Polygon.contains} For single point testing\n   * @see {@link Polygon.getBounds} For bounds calculation\n   */\n  containsPolygon(polygon) {\n    const thisBounds = this.getBounds(tempRect);\n    const otherBounds = polygon.getBounds(tempRect2);\n    if (!thisBounds.containsRect(otherBounds)) {\n      return false;\n    }\n    const points = polygon.points;\n    for (let i = 0; i < points.length; i += 2) {\n      const x = points[i];\n      const y = points[i + 1];\n      if (!this.contains(x, y)) {\n        return false;\n      }\n    }\n    return true;\n  }\n  /**\n   * Creates a clone of this polygon.\n   * @example\n   * ```ts\n   * // Basic cloning\n   * const original = new Polygon([0, 0, 100, 0, 50, 100]);\n   * const copy = original.clone();\n   *\n   * // Clone and modify\n   * const modified = original.clone();\n   * modified.points[0] = 10; // Modify first x coordinate\n   * ```\n   * @returns A copy of the polygon\n   * @see {@link Polygon.copyFrom} For copying into existing polygon\n   * @see {@link Polygon.copyTo} For copying to another polygon\n   */\n  clone() {\n    const points = this.points.slice();\n    const polygon = new Polygon(points);\n    polygon.closePath = this.closePath;\n    return polygon;\n  }\n  /**\n   * Checks whether the x and y coordinates passed to this function are contained within this polygon.\n   * Uses raycasting algorithm for point-in-polygon testing.\n   * @example\n   * ```ts\n   * // Basic containment check\n   * const polygon = new Polygon([0, 0, 100, 0, 50, 100]);\n   * const isInside = polygon.contains(25, 25); // true\n   * ```\n   * @param x - The X coordinate of the point to test\n   * @param y - The Y coordinate of the point to test\n   * @returns Whether the x/y coordinates are within this polygon\n   * @see {@link Polygon.strokeContains} For checking stroke intersection\n   * @see {@link Polygon.containsPolygon} For polygon-in-polygon testing\n   */\n  contains(x, y) {\n    let inside = false;\n    const length = this.points.length / 2;\n    for (let i = 0, j = length - 1; i < length; j = i++) {\n      const xi = this.points[i * 2];\n      const yi = this.points[i * 2 + 1];\n      const xj = this.points[j * 2];\n      const yj = this.points[j * 2 + 1];\n      const intersect = yi > y !== yj > y && x < (xj - xi) * ((y - yi) / (yj - yi)) + xi;\n      if (intersect) {\n        inside = !inside;\n      }\n    }\n    return inside;\n  }\n  /**\n   * Checks whether the x and y coordinates given are contained within this polygon including the stroke.\n   * @example\n   * ```ts\n   * // Basic stroke check\n   * const polygon = new Polygon([0, 0, 100, 0, 50, 100]);\n   * const isOnStroke = polygon.strokeContains(25, 25, 4); // 4px line width\n   *\n   * // Check with different alignments\n   * const innerStroke = polygon.strokeContains(25, 25, 4, 1);   // Inside\n   * const centerStroke = polygon.strokeContains(25, 25, 4, 0.5); // Centered\n   * const outerStroke = polygon.strokeContains(25, 25, 4, 0);   // Outside\n   * ```\n   * @param x - The X coordinate of the point to test\n   * @param y - The Y coordinate of the point to test\n   * @param strokeWidth - The width of the line to check\n   * @param alignment - The alignment of the stroke (1 = inner, 0.5 = centered, 0 = outer)\n   * @returns Whether the x/y coordinates are within this polygon's stroke\n   * @see {@link Polygon.contains} For checking fill containment\n   * @see {@link Polygon.getBounds} For getting stroke bounds\n   */\n  strokeContains(x, y, strokeWidth, alignment = 0.5) {\n    const strokeWidthSquared = strokeWidth * strokeWidth;\n    const rightWidthSquared = strokeWidthSquared * (1 - alignment);\n    const leftWidthSquared = strokeWidthSquared - rightWidthSquared;\n    const { points } = this;\n    const iterationLength = points.length - (this.closePath ? 0 : 2);\n    for (let i = 0; i < iterationLength; i += 2) {\n      const x1 = points[i];\n      const y1 = points[i + 1];\n      const x2 = points[(i + 2) % points.length];\n      const y2 = points[(i + 3) % points.length];\n      const distanceSquared = squaredDistanceToLineSegment(x, y, x1, y1, x2, y2);\n      const sign = Math.sign((x2 - x1) * (y - y1) - (y2 - y1) * (x - x1));\n      if (distanceSquared <= (sign < 0 ? leftWidthSquared : rightWidthSquared)) {\n        return true;\n      }\n    }\n    return false;\n  }\n  /**\n   * Returns the framing rectangle of the polygon as a Rectangle object.\n   * @example\n   * ```ts\n   * // Basic bounds calculation\n   * const polygon = new Polygon([0, 0, 100, 0, 50, 100]);\n   * const bounds = polygon.getBounds();\n   * // bounds: x=0, y=0, width=100, height=100\n   *\n   * // Reuse existing rectangle\n   * const rect = new Rectangle();\n   * polygon.getBounds(rect);\n   * ```\n   * @param out - Optional rectangle to store the result\n   * @returns The framing rectangle\n   * @see {@link Rectangle} For rectangle properties\n   * @see {@link Polygon.contains} For checking if a point is inside\n   */\n  getBounds(out) {\n    out || (out = new Rectangle());\n    const points = this.points;\n    let minX = Infinity;\n    let maxX = -Infinity;\n    let minY = Infinity;\n    let maxY = -Infinity;\n    for (let i = 0, n = points.length; i < n; i += 2) {\n      const x = points[i];\n      const y = points[i + 1];\n      minX = x < minX ? x : minX;\n      maxX = x > maxX ? x : maxX;\n      minY = y < minY ? y : minY;\n      maxY = y > maxY ? y : maxY;\n    }\n    out.x = minX;\n    out.width = maxX - minX;\n    out.y = minY;\n    out.height = maxY - minY;\n    return out;\n  }\n  /**\n   * Copies another polygon to this one.\n   * @example\n   * ```ts\n   * // Basic copying\n   * const source = new Polygon([0, 0, 100, 0, 50, 100]);\n   * const target = new Polygon();\n   * target.copyFrom(source);\n   * ```\n   * @param polygon - The polygon to copy from\n   * @returns Returns itself\n   * @see {@link Polygon.copyTo} For copying to another polygon\n   * @see {@link Polygon.clone} For creating new polygon copy\n   */\n  copyFrom(polygon) {\n    this.points = polygon.points.slice();\n    this.closePath = polygon.closePath;\n    return this;\n  }\n  /**\n   * Copies this polygon to another one.\n   * @example\n   * ```ts\n   * // Basic copying\n   * const source = new Polygon([0, 0, 100, 0, 50, 100]);\n   * const target = new Polygon();\n   * source.copyTo(target);\n   * ```\n   * @param polygon - The polygon to copy to\n   * @returns Returns given parameter\n   * @see {@link Polygon.copyFrom} For copying from another polygon\n   * @see {@link Polygon.clone} For creating new polygon copy\n   */\n  copyTo(polygon) {\n    polygon.copyFrom(this);\n    return polygon;\n  }\n  toString() {\n    return `[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((pointsDesc, currentPoint) => `${pointsDesc}, ${currentPoint}`, \"\")}]`;\n  }\n  /**\n   * Get the last X coordinate of the polygon.\n   * @example\n   * ```ts\n   * // Basic coordinate access\n   * const polygon = new Polygon([0, 0, 100, 200, 300, 400]);\n   * console.log(polygon.lastX); // 300\n   * ```\n   * @readonly\n   * @returns The x-coordinate of the last vertex\n   * @see {@link Polygon.lastY} For last Y coordinate\n   * @see {@link Polygon.points} For raw points array\n   */\n  get lastX() {\n    return this.points[this.points.length - 2];\n  }\n  /**\n   * Get the last Y coordinate of the polygon.\n   * @example\n   * ```ts\n   * // Basic coordinate access\n   * const polygon = new Polygon([0, 0, 100, 200, 300, 400]);\n   * console.log(polygon.lastY); // 400\n   * ```\n   * @readonly\n   * @returns The y-coordinate of the last vertex\n   * @see {@link Polygon.lastX} For last X coordinate\n   * @see {@link Polygon.points} For raw points array\n   */\n  get lastY() {\n    return this.points[this.points.length - 1];\n  }\n  /**\n   * Get the last X coordinate of the polygon.\n   * @readonly\n   * @deprecated since 8.11.0, use {@link Polygon.lastX} instead.\n   */\n  get x() {\n    deprecation(\"8.11.0\", \"Polygon.lastX is deprecated, please use Polygon.lastX instead.\");\n    return this.points[this.points.length - 2];\n  }\n  /**\n   * Get the last Y coordinate of the polygon.\n   * @readonly\n   * @deprecated since 8.11.0, use {@link Polygon.lastY} instead.\n   */\n  get y() {\n    deprecation(\"8.11.0\", \"Polygon.y is deprecated, please use Polygon.lastY instead.\");\n    return this.points[this.points.length - 1];\n  }\n  /**\n   * Get the first X coordinate of the polygon.\n   * @example\n   * ```ts\n   * // Basic coordinate access\n   * const polygon = new Polygon([0, 0, 100, 200, 300, 400]);\n   * console.log(polygon.x); // 0\n   * ```\n   * @readonly\n   * @returns The x-coordinate of the first vertex\n   * @see {@link Polygon.startY} For first Y coordinate\n   * @see {@link Polygon.points} For raw points array\n   */\n  get startX() {\n    return this.points[0];\n  }\n  /**\n   * Get the first Y coordinate of the polygon.\n   * @example\n   * ```ts\n   * // Basic coordinate access\n   * const polygon = new Polygon([0, 0, 100, 200, 300, 400]);\n   * console.log(polygon.y); // 0\n   * ```\n   * @readonly\n   * @returns The y-coordinate of the first vertex\n   * @see {@link Polygon.startX} For first X coordinate\n   * @see {@link Polygon.points} For raw points array\n   */\n  get startY() {\n    return this.points[1];\n  }\n}\n\nexport { Polygon };\n//# sourceMappingURL=Polygon.mjs.map\n","import { Rectangle } from './Rectangle.mjs';\n\n\"use strict\";\nconst isCornerWithinStroke = (pX, pY, cornerX, cornerY, radius, strokeWidthInner, strokeWidthOuter) => {\n  const dx = pX - cornerX;\n  const dy = pY - cornerY;\n  const distance = Math.sqrt(dx * dx + dy * dy);\n  return distance >= radius - strokeWidthInner && distance <= radius + strokeWidthOuter;\n};\nclass RoundedRectangle {\n  /**\n   * @param x - The X coordinate of the upper-left corner of the rounded rectangle\n   * @param y - The Y coordinate of the upper-left corner of the rounded rectangle\n   * @param width - The overall width of this rounded rectangle\n   * @param height - The overall height of this rounded rectangle\n   * @param radius - Controls the radius of the rounded corners\n   */\n  constructor(x = 0, y = 0, width = 0, height = 0, radius = 20) {\n    /**\n     * The type of the object, mainly used to avoid `instanceof` checks\n     * @example\n     * ```ts\n     * // Check shape type\n     * const shape = new RoundedRectangle(0, 0, 100, 100, 20);\n     * console.log(shape.type); // 'roundedRectangle'\n     *\n     * // Use in type guards\n     * if (shape.type === 'roundedRectangle') {\n     *     console.log(shape.radius);\n     * }\n     * ```\n     * @readonly\n     * @default 'roundedRectangle'\n     * @see {@link SHAPE_PRIMITIVE} For all shape types\n     */\n    this.type = \"roundedRectangle\";\n    this.x = x;\n    this.y = y;\n    this.width = width;\n    this.height = height;\n    this.radius = radius;\n  }\n  /**\n   * Returns the framing rectangle of the rounded rectangle as a Rectangle object\n   * @example\n   * ```ts\n   * // Basic bounds calculation\n   * const rect = new RoundedRectangle(100, 100, 200, 150, 20);\n   * const bounds = rect.getBounds();\n   * // bounds: x=100, y=100, width=200, height=150\n   *\n   * // Reuse existing rectangle\n   * const out = new Rectangle();\n   * rect.getBounds(out);\n   * ```\n   * @remarks\n   * - Rectangle matches outer dimensions\n   * - Ignores corner radius\n   * @param out - Optional rectangle to store the result\n   * @returns The framing rectangle\n   * @see {@link Rectangle} For rectangle properties\n   * @see {@link RoundedRectangle.contains} For checking if a point is inside\n   */\n  getBounds(out) {\n    out || (out = new Rectangle());\n    out.x = this.x;\n    out.y = this.y;\n    out.width = this.width;\n    out.height = this.height;\n    return out;\n  }\n  /**\n   * Creates a clone of this Rounded Rectangle.\n   * @example\n   * ```ts\n   * // Basic cloning\n   * const original = new RoundedRectangle(100, 100, 200, 150, 20);\n   * const copy = original.clone();\n   *\n   * // Clone and modify\n   * const modified = original.clone();\n   * modified.radius = 30;\n   * modified.width *= 2;\n   *\n   * // Verify independence\n   * console.log(original.radius);  // 20\n   * console.log(modified.radius);  // 30\n   * ```\n   * @returns A copy of the rounded rectangle\n   * @see {@link RoundedRectangle.copyFrom} For copying into existing rectangle\n   * @see {@link RoundedRectangle.copyTo} For copying to another rectangle\n   */\n  clone() {\n    return new RoundedRectangle(this.x, this.y, this.width, this.height, this.radius);\n  }\n  /**\n   * Copies another rectangle to this one.\n   * @example\n   * ```ts\n   * // Basic copying\n   * const source = new RoundedRectangle(100, 100, 200, 150, 20);\n   * const target = new RoundedRectangle();\n   * target.copyFrom(source);\n   *\n   * // Chain with other operations\n   * const rect = new RoundedRectangle()\n   *     .copyFrom(source)\n   *     .getBounds(rect);\n   * ```\n   * @param rectangle - The rectangle to copy from\n   * @returns Returns itself\n   * @see {@link RoundedRectangle.copyTo} For copying to another rectangle\n   * @see {@link RoundedRectangle.clone} For creating new rectangle copy\n   */\n  copyFrom(rectangle) {\n    this.x = rectangle.x;\n    this.y = rectangle.y;\n    this.width = rectangle.width;\n    this.height = rectangle.height;\n    return this;\n  }\n  /**\n   * Copies this rectangle to another one.\n   * @example\n   * ```ts\n   * // Basic copying\n   * const source = new RoundedRectangle(100, 100, 200, 150, 20);\n   * const target = new RoundedRectangle();\n   * source.copyTo(target);\n   *\n   * // Chain with other operations\n   * const result = source\n   *     .copyTo(new RoundedRectangle())\n   *     .getBounds();\n   * ```\n   * @param rectangle - The rectangle to copy to\n   * @returns Returns given parameter\n   * @see {@link RoundedRectangle.copyFrom} For copying from another rectangle\n   * @see {@link RoundedRectangle.clone} For creating new rectangle copy\n   */\n  copyTo(rectangle) {\n    rectangle.copyFrom(this);\n    return rectangle;\n  }\n  /**\n   * Checks whether the x and y coordinates given are contained within this Rounded Rectangle\n   * @example\n   * ```ts\n   * // Basic containment check\n   * const rect = new RoundedRectangle(100, 100, 200, 150, 20);\n   * const isInside = rect.contains(150, 125); // true\n   * // Check corner radius\n   * const corner = rect.contains(100, 100); // false if within corner curve\n   * ```\n   * @remarks\n   * - Returns false if width/height is 0 or negative\n   * - Handles rounded corners with radius check\n   * @param x - The X coordinate of the point to test\n   * @param y - The Y coordinate of the point to test\n   * @returns Whether the x/y coordinates are within this Rounded Rectangle\n   * @see {@link RoundedRectangle.strokeContains} For checking stroke intersection\n   * @see {@link RoundedRectangle.getBounds} For getting containing rectangle\n   */\n  contains(x, y) {\n    if (this.width <= 0 || this.height <= 0) {\n      return false;\n    }\n    if (x >= this.x && x <= this.x + this.width) {\n      if (y >= this.y && y <= this.y + this.height) {\n        const radius = Math.max(0, Math.min(this.radius, Math.min(this.width, this.height) / 2));\n        if (y >= this.y + radius && y <= this.y + this.height - radius || x >= this.x + radius && x <= this.x + this.width - radius) {\n          return true;\n        }\n        let dx = x - (this.x + radius);\n        let dy = y - (this.y + radius);\n        const radius2 = radius * radius;\n        if (dx * dx + dy * dy <= radius2) {\n          return true;\n        }\n        dx = x - (this.x + this.width - radius);\n        if (dx * dx + dy * dy <= radius2) {\n          return true;\n        }\n        dy = y - (this.y + this.height - radius);\n        if (dx * dx + dy * dy <= radius2) {\n          return true;\n        }\n        dx = x - (this.x + radius);\n        if (dx * dx + dy * dy <= radius2) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n  /**\n   * Checks whether the x and y coordinates given are contained within this rectangle including the stroke.\n   * @example\n   * ```ts\n   * // Basic stroke check\n   * const rect = new RoundedRectangle(100, 100, 200, 150, 20);\n   * const isOnStroke = rect.strokeContains(150, 100, 4); // 4px line width\n   *\n   * // Check with different alignments\n   * const innerStroke = rect.strokeContains(150, 100, 4, 1);   // Inside\n   * const centerStroke = rect.strokeContains(150, 100, 4, 0.5); // Centered\n   * const outerStroke = rect.strokeContains(150, 100, 4, 0);   // Outside\n   * ```\n   * @param pX - The X coordinate of the point to test\n   * @param pY - The Y coordinate of the point to test\n   * @param strokeWidth - The width of the line to check\n   * @param alignment - The alignment of the stroke (1 = inner, 0.5 = centered, 0 = outer)\n   * @returns Whether the x/y coordinates are within this rectangle's stroke\n   * @see {@link RoundedRectangle.contains} For checking fill containment\n   * @see {@link RoundedRectangle.getBounds} For getting stroke bounds\n   */\n  strokeContains(pX, pY, strokeWidth, alignment = 0.5) {\n    const { x, y, width, height, radius } = this;\n    const strokeWidthOuter = strokeWidth * (1 - alignment);\n    const strokeWidthInner = strokeWidth - strokeWidthOuter;\n    const innerX = x + radius;\n    const innerY = y + radius;\n    const innerWidth = width - radius * 2;\n    const innerHeight = height - radius * 2;\n    const rightBound = x + width;\n    const bottomBound = y + height;\n    if ((pX >= x - strokeWidthOuter && pX <= x + strokeWidthInner || pX >= rightBound - strokeWidthInner && pX <= rightBound + strokeWidthOuter) && pY >= innerY && pY <= innerY + innerHeight) {\n      return true;\n    }\n    if ((pY >= y - strokeWidthOuter && pY <= y + strokeWidthInner || pY >= bottomBound - strokeWidthInner && pY <= bottomBound + strokeWidthOuter) && pX >= innerX && pX <= innerX + innerWidth) {\n      return true;\n    }\n    return (\n      // Top-left\n      pX < innerX && pY < innerY && isCornerWithinStroke(\n        pX,\n        pY,\n        innerX,\n        innerY,\n        radius,\n        strokeWidthInner,\n        strokeWidthOuter\n      ) || pX > rightBound - radius && pY < innerY && isCornerWithinStroke(\n        pX,\n        pY,\n        rightBound - radius,\n        innerY,\n        radius,\n        strokeWidthInner,\n        strokeWidthOuter\n      ) || pX > rightBound - radius && pY > bottomBound - radius && isCornerWithinStroke(\n        pX,\n        pY,\n        rightBound - radius,\n        bottomBound - radius,\n        radius,\n        strokeWidthInner,\n        strokeWidthOuter\n      ) || pX < innerX && pY > bottomBound - radius && isCornerWithinStroke(\n        pX,\n        pY,\n        innerX,\n        bottomBound - radius,\n        radius,\n        strokeWidthInner,\n        strokeWidthOuter\n      )\n    );\n  }\n  toString() {\n    return `[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`;\n  }\n}\n\nexport { RoundedRectangle };\n//# sourceMappingURL=RoundedRectangle.mjs.map\n","import { BindGroup } from '../../renderers/gpu/shader/BindGroup.mjs';\nimport { Texture } from '../../renderers/shared/texture/Texture.mjs';\n\n\"use strict\";\nconst cachedGroups = {};\nfunction getTextureBatchBindGroup(textures, size, maxTextures) {\n  let uid = 2166136261;\n  for (let i = 0; i < size; i++) {\n    uid ^= textures[i].uid;\n    uid = Math.imul(uid, 16777619);\n    uid >>>= 0;\n  }\n  return cachedGroups[uid] || generateTextureBatchBindGroup(textures, size, uid, maxTextures);\n}\nfunction generateTextureBatchBindGroup(textures, size, key, maxTextures) {\n  const bindGroupResources = {};\n  let bindIndex = 0;\n  for (let i = 0; i < maxTextures; i++) {\n    const texture = i < size ? textures[i] : Texture.EMPTY.source;\n    bindGroupResources[bindIndex++] = texture.source;\n    bindGroupResources[bindIndex++] = texture.style;\n  }\n  const bindGroup = new BindGroup(bindGroupResources);\n  cachedGroups[key] = bindGroup;\n  return bindGroup;\n}\n\nexport { getTextureBatchBindGroup };\n//# sourceMappingURL=getTextureBatchBindGroup.mjs.map\n","\"use strict\";\nclass ViewableBuffer {\n  constructor(sizeOrBuffer) {\n    if (typeof sizeOrBuffer === \"number\") {\n      this.rawBinaryData = new ArrayBuffer(sizeOrBuffer);\n    } else if (sizeOrBuffer instanceof Uint8Array) {\n      this.rawBinaryData = sizeOrBuffer.buffer;\n    } else {\n      this.rawBinaryData = sizeOrBuffer;\n    }\n    this.uint32View = new Uint32Array(this.rawBinaryData);\n    this.float32View = new Float32Array(this.rawBinaryData);\n    this.size = this.rawBinaryData.byteLength;\n  }\n  /** View on the raw binary data as a `Int8Array`. */\n  get int8View() {\n    if (!this._int8View) {\n      this._int8View = new Int8Array(this.rawBinaryData);\n    }\n    return this._int8View;\n  }\n  /** View on the raw binary data as a `Uint8Array`. */\n  get uint8View() {\n    if (!this._uint8View) {\n      this._uint8View = new Uint8Array(this.rawBinaryData);\n    }\n    return this._uint8View;\n  }\n  /**  View on the raw binary data as a `Int16Array`. */\n  get int16View() {\n    if (!this._int16View) {\n      this._int16View = new Int16Array(this.rawBinaryData);\n    }\n    return this._int16View;\n  }\n  /** View on the raw binary data as a `Int32Array`. */\n  get int32View() {\n    if (!this._int32View) {\n      this._int32View = new Int32Array(this.rawBinaryData);\n    }\n    return this._int32View;\n  }\n  /** View on the raw binary data as a `Float64Array`. */\n  get float64View() {\n    if (!this._float64Array) {\n      this._float64Array = new Float64Array(this.rawBinaryData);\n    }\n    return this._float64Array;\n  }\n  /** View on the raw binary data as a `BigUint64Array`. */\n  get bigUint64View() {\n    if (!this._bigUint64Array) {\n      this._bigUint64Array = new BigUint64Array(this.rawBinaryData);\n    }\n    return this._bigUint64Array;\n  }\n  /**\n   * Returns the view of the given type.\n   * @param type - One of `int8`, `uint8`, `int16`,\n   *    `uint16`, `int32`, `uint32`, and `float32`.\n   * @returns - typed array of given type\n   */\n  view(type) {\n    return this[`${type}View`];\n  }\n  /** Destroys all buffer references. Do not use after calling this. */\n  destroy() {\n    this.rawBinaryData = null;\n    this._int8View = null;\n    this._uint8View = null;\n    this._int16View = null;\n    this.uint16View = null;\n    this._int32View = null;\n    this.uint32View = null;\n    this.float32View = null;\n  }\n  /**\n   * Returns the size of the given type in bytes.\n   * @param type - One of `int8`, `uint8`, `int16`,\n   *   `uint16`, `int32`, `uint32`, and `float32`.\n   * @returns - size of the type in bytes\n   */\n  static sizeOf(type) {\n    switch (type) {\n      case \"int8\":\n      case \"uint8\":\n        return 1;\n      case \"int16\":\n      case \"uint16\":\n        return 2;\n      case \"int32\":\n      case \"uint32\":\n      case \"float32\":\n        return 4;\n      default:\n        throw new Error(`${type} isn't a valid view type`);\n    }\n  }\n}\n\nexport { ViewableBuffer };\n//# sourceMappingURL=ViewableBuffer.mjs.map\n","\"use strict\";\nfunction fastCopy(sourceBuffer, destinationBuffer) {\n  const lengthDouble = sourceBuffer.byteLength / 8 | 0;\n  const sourceFloat64View = new Float64Array(sourceBuffer, 0, lengthDouble);\n  const destinationFloat64View = new Float64Array(destinationBuffer, 0, lengthDouble);\n  destinationFloat64View.set(sourceFloat64View);\n  const remainingBytes = sourceBuffer.byteLength - lengthDouble * 8;\n  if (remainingBytes > 0) {\n    const sourceUint8View = new Uint8Array(sourceBuffer, lengthDouble * 8, remainingBytes);\n    const destinationUint8View = new Uint8Array(destinationBuffer, lengthDouble * 8, remainingBytes);\n    destinationUint8View.set(sourceUint8View);\n  }\n}\n\nexport { fastCopy };\n//# sourceMappingURL=fastCopy.mjs.map\n","\"use strict\";\nconst BLEND_TO_NPM = {\n  normal: \"normal-npm\",\n  add: \"add-npm\",\n  screen: \"screen-npm\"\n};\nvar STENCIL_MODES = /* @__PURE__ */ ((STENCIL_MODES2) => {\n  STENCIL_MODES2[STENCIL_MODES2[\"DISABLED\"] = 0] = \"DISABLED\";\n  STENCIL_MODES2[STENCIL_MODES2[\"RENDERING_MASK_ADD\"] = 1] = \"RENDERING_MASK_ADD\";\n  STENCIL_MODES2[STENCIL_MODES2[\"MASK_ACTIVE\"] = 2] = \"MASK_ACTIVE\";\n  STENCIL_MODES2[STENCIL_MODES2[\"INVERSE_MASK_ACTIVE\"] = 3] = \"INVERSE_MASK_ACTIVE\";\n  STENCIL_MODES2[STENCIL_MODES2[\"RENDERING_MASK_REMOVE\"] = 4] = \"RENDERING_MASK_REMOVE\";\n  STENCIL_MODES2[STENCIL_MODES2[\"NONE\"] = 5] = \"NONE\";\n  return STENCIL_MODES2;\n})(STENCIL_MODES || {});\n\nexport { BLEND_TO_NPM, STENCIL_MODES };\n//# sourceMappingURL=const.mjs.map\n","import { BLEND_TO_NPM } from './const.mjs';\n\n\"use strict\";\nfunction getAdjustedBlendModeBlend(blendMode, textureSource) {\n  if (textureSource.alphaMode === \"no-premultiply-alpha\") {\n    return BLEND_TO_NPM[blendMode] || blendMode;\n  }\n  return blendMode;\n}\n\nexport { getAdjustedBlendModeBlend };\n//# sourceMappingURL=getAdjustedBlendModeBlend.mjs.map\n","\"use strict\";\nconst fragTemplate = [\n  \"precision mediump float;\",\n  \"void main(void){\",\n  \"float test = 0.1;\",\n  \"%forloop%\",\n  \"gl_FragColor = vec4(0.0);\",\n  \"}\"\n].join(\"\\n\");\nfunction generateIfTestSrc(maxIfs) {\n  let src = \"\";\n  for (let i = 0; i < maxIfs; ++i) {\n    if (i > 0) {\n      src += \"\\nelse \";\n    }\n    if (i < maxIfs - 1) {\n      src += `if(test == ${i}.0){}`;\n    }\n  }\n  return src;\n}\nfunction checkMaxIfStatementsInShader(maxIfs, gl) {\n  if (maxIfs === 0) {\n    throw new Error(\"Invalid value of `0` passed to `checkMaxIfStatementsInShader`\");\n  }\n  const shader = gl.createShader(gl.FRAGMENT_SHADER);\n  try {\n    while (true) {\n      const fragmentSrc = fragTemplate.replace(/%forloop%/gi, generateIfTestSrc(maxIfs));\n      gl.shaderSource(shader, fragmentSrc);\n      gl.compileShader(shader);\n      if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n        maxIfs = maxIfs / 2 | 0;\n      } else {\n        break;\n      }\n    }\n  } finally {\n    gl.deleteShader(shader);\n  }\n  return maxIfs;\n}\n\nexport { checkMaxIfStatementsInShader };\n//# sourceMappingURL=checkMaxIfStatementsInShader.mjs.map\n","import { getTestContext } from '../../../renderers/gl/shader/program/getTestContext.mjs';\nimport { checkMaxIfStatementsInShader } from './checkMaxIfStatementsInShader.mjs';\n\n\"use strict\";\nlet maxTexturesPerBatchCache = null;\nfunction getMaxTexturesPerBatch() {\n  if (maxTexturesPerBatchCache)\n    return maxTexturesPerBatchCache;\n  const gl = getTestContext();\n  maxTexturesPerBatchCache = gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);\n  maxTexturesPerBatchCache = checkMaxIfStatementsInShader(\n    maxTexturesPerBatchCache,\n    gl\n  );\n  gl.getExtension(\"WEBGL_lose_context\")?.loseContext();\n  return maxTexturesPerBatchCache;\n}\n\nexport { getMaxTexturesPerBatch };\n//# sourceMappingURL=maxRecommendedTextures.mjs.map\n","\"use strict\";\nclass BatchTextureArray {\n  constructor() {\n    /** Respective locations for textures. */\n    this.ids = /* @__PURE__ */ Object.create(null);\n    this.textures = [];\n    this.count = 0;\n  }\n  /** Clear the textures and their locations. */\n  clear() {\n    for (let i = 0; i < this.count; i++) {\n      const t = this.textures[i];\n      this.textures[i] = null;\n      this.ids[t.uid] = null;\n    }\n    this.count = 0;\n  }\n}\n\nexport { BatchTextureArray };\n//# sourceMappingURL=BatchTextureArray.mjs.map\n","import { uid } from '../../../utils/data/uid.mjs';\nimport { ViewableBuffer } from '../../../utils/data/ViewableBuffer.mjs';\nimport { deprecation } from '../../../utils/logging/deprecation.mjs';\nimport { GlobalResourceRegistry } from '../../../utils/pool/GlobalResourceRegistry.mjs';\nimport { fastCopy } from '../../renderers/shared/buffer/utils/fastCopy.mjs';\nimport { getAdjustedBlendModeBlend } from '../../renderers/shared/state/getAdjustedBlendModeBlend.mjs';\nimport { getMaxTexturesPerBatch } from '../gl/utils/maxRecommendedTextures.mjs';\nimport { BatchTextureArray } from './BatchTextureArray.mjs';\n\n\"use strict\";\nclass Batch {\n  constructor() {\n    this.renderPipeId = \"batch\";\n    this.action = \"startBatch\";\n    // TODO - eventually this could be useful for flagging batches as dirty and then only rebuilding those ones\n    // public elementStart = 0;\n    // public elementSize = 0;\n    // for drawing..\n    this.start = 0;\n    this.size = 0;\n    this.textures = new BatchTextureArray();\n    this.blendMode = \"normal\";\n    this.topology = \"triangle-strip\";\n    this.canBundle = true;\n  }\n  destroy() {\n    this.textures = null;\n    this.gpuBindGroup = null;\n    this.bindGroup = null;\n    this.batcher = null;\n  }\n}\nconst batchPool = [];\nlet batchPoolIndex = 0;\nGlobalResourceRegistry.register({\n  clear: () => {\n    if (batchPool.length > 0) {\n      for (const item of batchPool) {\n        if (item)\n          item.destroy();\n      }\n    }\n    batchPool.length = 0;\n    batchPoolIndex = 0;\n  }\n});\nfunction getBatchFromPool() {\n  return batchPoolIndex > 0 ? batchPool[--batchPoolIndex] : new Batch();\n}\nfunction returnBatchToPool(batch) {\n  batchPool[batchPoolIndex++] = batch;\n}\nlet BATCH_TICK = 0;\nconst _Batcher = class _Batcher {\n  constructor(options) {\n    /** unique id for this batcher */\n    this.uid = uid(\"batcher\");\n    /** Indicates whether the batch data has been modified and needs updating. */\n    this.dirty = true;\n    /** The current index of the batch being processed. */\n    this.batchIndex = 0;\n    /** An array of all batches created during the current rendering process. */\n    this.batches = [];\n    this._elements = [];\n    options = { ..._Batcher.defaultOptions, ...options };\n    if (!options.maxTextures) {\n      deprecation(\"v8.8.0\", \"maxTextures is a required option for Batcher now, please pass it in the options\");\n      options.maxTextures = getMaxTexturesPerBatch();\n    }\n    const { maxTextures, attributesInitialSize, indicesInitialSize } = options;\n    this.attributeBuffer = new ViewableBuffer(attributesInitialSize * 4);\n    this.indexBuffer = new Uint16Array(indicesInitialSize);\n    this.maxTextures = maxTextures;\n  }\n  begin() {\n    this.elementSize = 0;\n    this.elementStart = 0;\n    this.indexSize = 0;\n    this.attributeSize = 0;\n    for (let i = 0; i < this.batchIndex; i++) {\n      returnBatchToPool(this.batches[i]);\n    }\n    this.batchIndex = 0;\n    this._batchIndexStart = 0;\n    this._batchIndexSize = 0;\n    this.dirty = true;\n  }\n  add(batchableObject) {\n    this._elements[this.elementSize++] = batchableObject;\n    batchableObject._indexStart = this.indexSize;\n    batchableObject._attributeStart = this.attributeSize;\n    batchableObject._batcher = this;\n    this.indexSize += batchableObject.indexSize;\n    this.attributeSize += batchableObject.attributeSize * this.vertexSize;\n  }\n  checkAndUpdateTexture(batchableObject, texture) {\n    const textureId = batchableObject._batch.textures.ids[texture._source.uid];\n    if (!textureId && textureId !== 0)\n      return false;\n    batchableObject._textureId = textureId;\n    batchableObject.texture = texture;\n    return true;\n  }\n  updateElement(batchableObject) {\n    this.dirty = true;\n    const attributeBuffer = this.attributeBuffer;\n    if (batchableObject.packAsQuad) {\n      this.packQuadAttributes(\n        batchableObject,\n        attributeBuffer.float32View,\n        attributeBuffer.uint32View,\n        batchableObject._attributeStart,\n        batchableObject._textureId\n      );\n    } else {\n      this.packAttributes(\n        batchableObject,\n        attributeBuffer.float32View,\n        attributeBuffer.uint32View,\n        batchableObject._attributeStart,\n        batchableObject._textureId\n      );\n    }\n  }\n  /**\n   * breaks the batcher. This happens when a batch gets too big,\n   * or we need to switch to a different type of rendering (a filter for example)\n   * @param instructionSet\n   */\n  break(instructionSet) {\n    const elements = this._elements;\n    if (!elements[this.elementStart])\n      return;\n    let batch = getBatchFromPool();\n    let textureBatch = batch.textures;\n    textureBatch.clear();\n    const firstElement = elements[this.elementStart];\n    let blendMode = getAdjustedBlendModeBlend(firstElement.blendMode, firstElement.texture._source);\n    let topology = firstElement.topology;\n    if (this.attributeSize * 4 > this.attributeBuffer.size) {\n      this._resizeAttributeBuffer(this.attributeSize * 4);\n    }\n    if (this.indexSize > this.indexBuffer.length) {\n      this._resizeIndexBuffer(this.indexSize);\n    }\n    const f32 = this.attributeBuffer.float32View;\n    const u32 = this.attributeBuffer.uint32View;\n    const indexBuffer = this.indexBuffer;\n    let size = this._batchIndexSize;\n    let start = this._batchIndexStart;\n    let action = \"startBatch\";\n    const maxTextures = this.maxTextures;\n    for (let i = this.elementStart; i < this.elementSize; ++i) {\n      const element = elements[i];\n      elements[i] = null;\n      const texture = element.texture;\n      const source = texture._source;\n      const adjustedBlendMode = getAdjustedBlendModeBlend(element.blendMode, source);\n      const breakRequired = blendMode !== adjustedBlendMode || topology !== element.topology;\n      if (source._batchTick === BATCH_TICK && !breakRequired) {\n        element._textureId = source._textureBindLocation;\n        size += element.indexSize;\n        if (element.packAsQuad) {\n          this.packQuadAttributes(\n            element,\n            f32,\n            u32,\n            element._attributeStart,\n            element._textureId\n          );\n          this.packQuadIndex(\n            indexBuffer,\n            element._indexStart,\n            element._attributeStart / this.vertexSize\n          );\n        } else {\n          this.packAttributes(\n            element,\n            f32,\n            u32,\n            element._attributeStart,\n            element._textureId\n          );\n          this.packIndex(\n            element,\n            indexBuffer,\n            element._indexStart,\n            element._attributeStart / this.vertexSize\n          );\n        }\n        element._batch = batch;\n        continue;\n      }\n      source._batchTick = BATCH_TICK;\n      if (textureBatch.count >= maxTextures || breakRequired) {\n        this._finishBatch(\n          batch,\n          start,\n          size - start,\n          textureBatch,\n          blendMode,\n          topology,\n          instructionSet,\n          action\n        );\n        action = \"renderBatch\";\n        start = size;\n        blendMode = adjustedBlendMode;\n        topology = element.topology;\n        batch = getBatchFromPool();\n        textureBatch = batch.textures;\n        textureBatch.clear();\n        ++BATCH_TICK;\n      }\n      element._textureId = source._textureBindLocation = textureBatch.count;\n      textureBatch.ids[source.uid] = textureBatch.count;\n      textureBatch.textures[textureBatch.count++] = source;\n      element._batch = batch;\n      size += element.indexSize;\n      if (element.packAsQuad) {\n        this.packQuadAttributes(\n          element,\n          f32,\n          u32,\n          element._attributeStart,\n          element._textureId\n        );\n        this.packQuadIndex(\n          indexBuffer,\n          element._indexStart,\n          element._attributeStart / this.vertexSize\n        );\n      } else {\n        this.packAttributes(\n          element,\n          f32,\n          u32,\n          element._attributeStart,\n          element._textureId\n        );\n        this.packIndex(\n          element,\n          indexBuffer,\n          element._indexStart,\n          element._attributeStart / this.vertexSize\n        );\n      }\n    }\n    if (textureBatch.count > 0) {\n      this._finishBatch(\n        batch,\n        start,\n        size - start,\n        textureBatch,\n        blendMode,\n        topology,\n        instructionSet,\n        action\n      );\n      start = size;\n      ++BATCH_TICK;\n    }\n    this.elementStart = this.elementSize;\n    this._batchIndexStart = start;\n    this._batchIndexSize = size;\n  }\n  _finishBatch(batch, indexStart, indexSize, textureBatch, blendMode, topology, instructionSet, action) {\n    batch.gpuBindGroup = null;\n    batch.bindGroup = null;\n    batch.action = action;\n    batch.batcher = this;\n    batch.textures = textureBatch;\n    batch.blendMode = blendMode;\n    batch.topology = topology;\n    batch.start = indexStart;\n    batch.size = indexSize;\n    ++BATCH_TICK;\n    this.batches[this.batchIndex++] = batch;\n    instructionSet.add(batch);\n  }\n  finish(instructionSet) {\n    this.break(instructionSet);\n  }\n  /**\n   * Resizes the attribute buffer to the given size (1 = 1 float32)\n   * @param size - the size in vertices to ensure (not bytes!)\n   */\n  ensureAttributeBuffer(size) {\n    if (size * 4 <= this.attributeBuffer.size)\n      return;\n    this._resizeAttributeBuffer(size * 4);\n  }\n  /**\n   * Resizes the index buffer to the given size (1 = 1 float32)\n   * @param size - the size in vertices to ensure (not bytes!)\n   */\n  ensureIndexBuffer(size) {\n    if (size <= this.indexBuffer.length)\n      return;\n    this._resizeIndexBuffer(size);\n  }\n  _resizeAttributeBuffer(size) {\n    const newSize = Math.max(size, this.attributeBuffer.size * 2);\n    const newArrayBuffer = new ViewableBuffer(newSize);\n    fastCopy(this.attributeBuffer.rawBinaryData, newArrayBuffer.rawBinaryData);\n    this.attributeBuffer = newArrayBuffer;\n  }\n  _resizeIndexBuffer(size) {\n    const indexBuffer = this.indexBuffer;\n    let newSize = Math.max(size, indexBuffer.length * 1.5);\n    newSize += newSize % 2;\n    const newIndexBuffer = newSize > 65535 ? new Uint32Array(newSize) : new Uint16Array(newSize);\n    if (newIndexBuffer.BYTES_PER_ELEMENT !== indexBuffer.BYTES_PER_ELEMENT) {\n      for (let i = 0; i < indexBuffer.length; i++) {\n        newIndexBuffer[i] = indexBuffer[i];\n      }\n    } else {\n      fastCopy(indexBuffer.buffer, newIndexBuffer.buffer);\n    }\n    this.indexBuffer = newIndexBuffer;\n  }\n  packQuadIndex(indexBuffer, index, indicesOffset) {\n    indexBuffer[index] = indicesOffset + 0;\n    indexBuffer[index + 1] = indicesOffset + 1;\n    indexBuffer[index + 2] = indicesOffset + 2;\n    indexBuffer[index + 3] = indicesOffset + 0;\n    indexBuffer[index + 4] = indicesOffset + 2;\n    indexBuffer[index + 5] = indicesOffset + 3;\n  }\n  packIndex(element, indexBuffer, index, indicesOffset) {\n    const indices = element.indices;\n    const size = element.indexSize;\n    const indexOffset = element.indexOffset;\n    const attributeOffset = element.attributeOffset;\n    for (let i = 0; i < size; i++) {\n      indexBuffer[index++] = indicesOffset + indices[i + indexOffset] - attributeOffset;\n    }\n  }\n  destroy() {\n    if (this.batches === null)\n      return;\n    for (let i = 0; i < this.batches.length; i++) {\n      returnBatchToPool(this.batches[i]);\n    }\n    this.batches = null;\n    for (let i = 0; i < this._elements.length; i++) {\n      if (this._elements[i])\n        this._elements[i]._batch = null;\n    }\n    this._elements = null;\n    this.indexBuffer = null;\n    this.attributeBuffer.destroy();\n    this.attributeBuffer = null;\n  }\n};\n_Batcher.defaultOptions = {\n  maxTextures: null,\n  attributesInitialSize: 4,\n  indicesInitialSize: 6\n};\nlet Batcher = _Batcher;\n\nexport { Batch, Batcher };\n//# sourceMappingURL=Batcher.mjs.map\n","\"use strict\";\nvar BufferUsage = /* @__PURE__ */ ((BufferUsage2) => {\n  BufferUsage2[BufferUsage2[\"MAP_READ\"] = 1] = \"MAP_READ\";\n  BufferUsage2[BufferUsage2[\"MAP_WRITE\"] = 2] = \"MAP_WRITE\";\n  BufferUsage2[BufferUsage2[\"COPY_SRC\"] = 4] = \"COPY_SRC\";\n  BufferUsage2[BufferUsage2[\"COPY_DST\"] = 8] = \"COPY_DST\";\n  BufferUsage2[BufferUsage2[\"INDEX\"] = 16] = \"INDEX\";\n  BufferUsage2[BufferUsage2[\"VERTEX\"] = 32] = \"VERTEX\";\n  BufferUsage2[BufferUsage2[\"UNIFORM\"] = 64] = \"UNIFORM\";\n  BufferUsage2[BufferUsage2[\"STORAGE\"] = 128] = \"STORAGE\";\n  BufferUsage2[BufferUsage2[\"INDIRECT\"] = 256] = \"INDIRECT\";\n  BufferUsage2[BufferUsage2[\"QUERY_RESOLVE\"] = 512] = \"QUERY_RESOLVE\";\n  BufferUsage2[BufferUsage2[\"STATIC\"] = 1024] = \"STATIC\";\n  return BufferUsage2;\n})(BufferUsage || {});\n\nexport { BufferUsage };\n//# sourceMappingURL=const.mjs.map\n","import EventEmitter from 'eventemitter3';\nimport { uid } from '../../../../utils/data/uid.mjs';\nimport { BufferUsage } from './const.mjs';\n\n\"use strict\";\nclass Buffer extends EventEmitter {\n  /**\n   * Creates a new Buffer with the given options\n   * @param options - the options for the buffer\n   */\n  constructor(options) {\n    let { data, size } = options;\n    const { usage, label, shrinkToFit } = options;\n    super();\n    /**\n     * emits when the underlying buffer has changed shape (i.e. resized)\n     * letting the renderer know that it needs to discard the old buffer on the GPU and create a new one\n     * @event change\n     */\n    /**\n     * emits when the underlying buffer data has been updated. letting the renderer know\n     * that it needs to update the buffer on the GPU\n     * @event update\n     */\n    /**\n     * emits when the buffer is destroyed. letting the renderer know that it needs to destroy the buffer on the GPU\n     * @event destroy\n     */\n    /** a unique id for this uniform group used through the renderer */\n    this.uid = uid(\"buffer\");\n    /**\n     * a resource type, used to identify how to handle it when its in a bind group / shader resource\n     * @internal\n     */\n    this._resourceType = \"buffer\";\n    /**\n     * the resource id used internally by the renderer to build bind group keys\n     * @internal\n     */\n    this._resourceId = uid(\"resource\");\n    /**\n     * used internally to know if a uniform group was used in the last render pass\n     * @internal\n     */\n    this._touched = 0;\n    /** @internal */\n    this._updateID = 1;\n    this._dataInt32 = null;\n    /**\n     * should the GPU buffer be shrunk when the data becomes smaller?\n     * changing this will cause the buffer to be destroyed and a new one created on the GPU\n     * this can be expensive, especially if the buffer is already big enough!\n     * setting this to false will prevent the buffer from being shrunk. This will yield better performance\n     * if you are constantly setting data that is changing size often.\n     * @default true\n     */\n    this.shrinkToFit = true;\n    /**\n     * Has the buffer been destroyed?\n     * @readonly\n     */\n    this.destroyed = false;\n    if (data instanceof Array) {\n      data = new Float32Array(data);\n    }\n    this._data = data;\n    size ?? (size = data?.byteLength);\n    const mappedAtCreation = !!data;\n    this.descriptor = {\n      size,\n      usage,\n      mappedAtCreation,\n      label\n    };\n    this.shrinkToFit = shrinkToFit ?? true;\n  }\n  /** the data in the buffer */\n  get data() {\n    return this._data;\n  }\n  set data(value) {\n    this.setDataWithSize(value, value.length, true);\n  }\n  get dataInt32() {\n    if (!this._dataInt32) {\n      this._dataInt32 = new Int32Array(this.data.buffer);\n    }\n    return this._dataInt32;\n  }\n  /** whether the buffer is static or not */\n  get static() {\n    return !!(this.descriptor.usage & BufferUsage.STATIC);\n  }\n  set static(value) {\n    if (value) {\n      this.descriptor.usage |= BufferUsage.STATIC;\n    } else {\n      this.descriptor.usage &= ~BufferUsage.STATIC;\n    }\n  }\n  /**\n   * Sets the data in the buffer to the given value. This will immediately update the buffer on the GPU.\n   * If you only want to update a subset of the buffer, you can pass in the size of the data.\n   * @param value - the data to set\n   * @param size - the size of the data in bytes\n   * @param syncGPU - should the buffer be updated on the GPU immediately?\n   */\n  setDataWithSize(value, size, syncGPU) {\n    this._updateID++;\n    this._updateSize = size * value.BYTES_PER_ELEMENT;\n    if (this._data === value) {\n      if (syncGPU)\n        this.emit(\"update\", this);\n      return;\n    }\n    const oldData = this._data;\n    this._data = value;\n    this._dataInt32 = null;\n    if (!oldData || oldData.length !== value.length) {\n      if (!this.shrinkToFit && oldData && value.byteLength < oldData.byteLength) {\n        if (syncGPU)\n          this.emit(\"update\", this);\n      } else {\n        this.descriptor.size = value.byteLength;\n        this._resourceId = uid(\"resource\");\n        this.emit(\"change\", this);\n      }\n      return;\n    }\n    if (syncGPU)\n      this.emit(\"update\", this);\n  }\n  /**\n   * updates the buffer on the GPU to reflect the data in the buffer.\n   * By default it will update the entire buffer. If you only want to update a subset of the buffer,\n   * you can pass in the size of the buffer to update.\n   * @param sizeInBytes - the new size of the buffer in bytes\n   */\n  update(sizeInBytes) {\n    this._updateSize = sizeInBytes ?? this._updateSize;\n    this._updateID++;\n    this.emit(\"update\", this);\n  }\n  /** Destroys the buffer */\n  destroy() {\n    this.destroyed = true;\n    this.emit(\"destroy\", this);\n    this.emit(\"change\", this);\n    this._data = null;\n    this.descriptor = null;\n    this.removeAllListeners();\n  }\n}\n\nexport { Buffer };\n//# sourceMappingURL=Buffer.mjs.map\n","import { Buffer } from '../../buffer/Buffer.mjs';\nimport { BufferUsage } from '../../buffer/const.mjs';\n\n\"use strict\";\nfunction ensureIsBuffer(buffer, index) {\n  if (!(buffer instanceof Buffer)) {\n    let usage = index ? BufferUsage.INDEX : BufferUsage.VERTEX;\n    if (buffer instanceof Array) {\n      if (index) {\n        buffer = new Uint32Array(buffer);\n        usage = BufferUsage.INDEX | BufferUsage.COPY_DST;\n      } else {\n        buffer = new Float32Array(buffer);\n        usage = BufferUsage.VERTEX | BufferUsage.COPY_DST;\n      }\n    }\n    buffer = new Buffer({\n      data: buffer,\n      label: index ? \"index-mesh-buffer\" : \"vertex-mesh-buffer\",\n      usage\n    });\n  }\n  return buffer;\n}\n\nexport { ensureIsBuffer };\n//# sourceMappingURL=ensureIsBuffer.mjs.map\n","\"use strict\";\nfunction getGeometryBounds(geometry, attributeId, bounds) {\n  const attribute = geometry.getAttribute(attributeId);\n  if (!attribute) {\n    bounds.minX = 0;\n    bounds.minY = 0;\n    bounds.maxX = 0;\n    bounds.maxY = 0;\n    return bounds;\n  }\n  const data = attribute.buffer.data;\n  let minX = Infinity;\n  let minY = Infinity;\n  let maxX = -Infinity;\n  let maxY = -Infinity;\n  const byteSize = data.BYTES_PER_ELEMENT;\n  const offset = (attribute.offset || 0) / byteSize;\n  const stride = (attribute.stride || 2 * 4) / byteSize;\n  for (let i = offset; i < data.length; i += stride) {\n    const x = data[i];\n    const y = data[i + 1];\n    if (x > maxX)\n      maxX = x;\n    if (y > maxY)\n      maxY = y;\n    if (x < minX)\n      minX = x;\n    if (y < minY)\n      minY = y;\n  }\n  bounds.minX = minX;\n  bounds.minY = minY;\n  bounds.maxX = maxX;\n  bounds.maxY = maxY;\n  return bounds;\n}\n\nexport { getGeometryBounds };\n//# sourceMappingURL=getGeometryBounds.mjs.map\n","import EventEmitter from 'eventemitter3';\nimport { Bounds } from '../../../../scene/container/bounds/Bounds.mjs';\nimport { uid } from '../../../../utils/data/uid.mjs';\nimport { Buffer } from '../buffer/Buffer.mjs';\nimport { ensureIsBuffer } from './utils/ensureIsBuffer.mjs';\nimport { getGeometryBounds } from './utils/getGeometryBounds.mjs';\n\n\"use strict\";\nfunction ensureIsAttribute(attribute) {\n  if (attribute instanceof Buffer || Array.isArray(attribute) || attribute.BYTES_PER_ELEMENT) {\n    attribute = {\n      buffer: attribute\n    };\n  }\n  attribute.buffer = ensureIsBuffer(attribute.buffer, false);\n  return attribute;\n}\nclass Geometry extends EventEmitter {\n  /**\n   * Create a new instance of a geometry\n   * @param options - The options for the geometry.\n   */\n  constructor(options = {}) {\n    super();\n    /** The unique id of the geometry. */\n    this.uid = uid(\"geometry\");\n    /**\n     * the layout key will be generated by WebGPU all geometries that have the same structure\n     * will have the same layout key. This is used to cache the pipeline layout\n     * @internal\n     */\n    this._layoutKey = 0;\n    /** the instance count of the geometry to draw */\n    this.instanceCount = 1;\n    this._bounds = new Bounds();\n    this._boundsDirty = true;\n    const { attributes, indexBuffer, topology } = options;\n    this.buffers = [];\n    this.attributes = {};\n    if (attributes) {\n      for (const i in attributes) {\n        this.addAttribute(i, attributes[i]);\n      }\n    }\n    this.instanceCount = options.instanceCount ?? 1;\n    if (indexBuffer) {\n      this.addIndex(indexBuffer);\n    }\n    this.topology = topology || \"triangle-list\";\n  }\n  onBufferUpdate() {\n    this._boundsDirty = true;\n    this.emit(\"update\", this);\n  }\n  /**\n   * Returns the requested attribute.\n   * @param id - The name of the attribute required\n   * @returns - The attribute requested.\n   */\n  getAttribute(id) {\n    return this.attributes[id];\n  }\n  /**\n   * Returns the index buffer\n   * @returns - The index buffer.\n   */\n  getIndex() {\n    return this.indexBuffer;\n  }\n  /**\n   * Returns the requested buffer.\n   * @param id - The name of the buffer required.\n   * @returns - The buffer requested.\n   */\n  getBuffer(id) {\n    return this.getAttribute(id).buffer;\n  }\n  /**\n   * Used to figure out how many vertices there are in this geometry\n   * @returns the number of vertices in the geometry\n   */\n  getSize() {\n    for (const i in this.attributes) {\n      const attribute = this.attributes[i];\n      const buffer = attribute.buffer;\n      return buffer.data.length / (attribute.stride / 4 || attribute.size);\n    }\n    return 0;\n  }\n  /**\n   * Adds an attribute to the geometry.\n   * @param name - The name of the attribute to add.\n   * @param attributeOption - The attribute option to add.\n   */\n  addAttribute(name, attributeOption) {\n    const attribute = ensureIsAttribute(attributeOption);\n    const bufferIndex = this.buffers.indexOf(attribute.buffer);\n    if (bufferIndex === -1) {\n      this.buffers.push(attribute.buffer);\n      attribute.buffer.on(\"update\", this.onBufferUpdate, this);\n      attribute.buffer.on(\"change\", this.onBufferUpdate, this);\n    }\n    this.attributes[name] = attribute;\n  }\n  /**\n   * Adds an index buffer to the geometry.\n   * @param indexBuffer - The index buffer to add. Can be a Buffer, TypedArray, or an array of numbers.\n   */\n  addIndex(indexBuffer) {\n    this.indexBuffer = ensureIsBuffer(indexBuffer, true);\n    this.buffers.push(this.indexBuffer);\n  }\n  /** Returns the bounds of the geometry. */\n  get bounds() {\n    if (!this._boundsDirty)\n      return this._bounds;\n    this._boundsDirty = false;\n    return getGeometryBounds(this, \"aPosition\", this._bounds);\n  }\n  /**\n   * destroys the geometry.\n   * @param destroyBuffers - destroy the buffers associated with this geometry\n   */\n  destroy(destroyBuffers = false) {\n    this.emit(\"destroy\", this);\n    this.removeAllListeners();\n    if (destroyBuffers) {\n      this.buffers.forEach((buffer) => buffer.destroy());\n    }\n    this.attributes = null;\n    this.buffers = null;\n    this.indexBuffer = null;\n    this._bounds = null;\n  }\n}\n\nexport { Geometry };\n//# sourceMappingURL=Geometry.mjs.map\n","import { Buffer } from '../../renderers/shared/buffer/Buffer.mjs';\nimport { BufferUsage } from '../../renderers/shared/buffer/const.mjs';\nimport { Geometry } from '../../renderers/shared/geometry/Geometry.mjs';\n\n\"use strict\";\nconst placeHolderBufferData = new Float32Array(1);\nconst placeHolderIndexData = new Uint32Array(1);\nclass BatchGeometry extends Geometry {\n  constructor() {\n    const vertexSize = 6;\n    const attributeBuffer = new Buffer({\n      data: placeHolderBufferData,\n      label: \"attribute-batch-buffer\",\n      usage: BufferUsage.VERTEX | BufferUsage.COPY_DST,\n      shrinkToFit: false\n    });\n    const indexBuffer = new Buffer({\n      data: placeHolderIndexData,\n      label: \"index-batch-buffer\",\n      usage: BufferUsage.INDEX | BufferUsage.COPY_DST,\n      // | BufferUsage.STATIC,\n      shrinkToFit: false\n    });\n    const stride = vertexSize * 4;\n    super({\n      attributes: {\n        aPosition: {\n          buffer: attributeBuffer,\n          format: \"float32x2\",\n          stride,\n          offset: 0\n        },\n        aUV: {\n          buffer: attributeBuffer,\n          format: \"float32x2\",\n          stride,\n          offset: 2 * 4\n        },\n        aColor: {\n          buffer: attributeBuffer,\n          format: \"unorm8x4\",\n          stride,\n          offset: 4 * 4\n        },\n        aTextureIdAndRound: {\n          buffer: attributeBuffer,\n          format: \"uint16x2\",\n          stride,\n          offset: 5 * 4\n        }\n      },\n      indexBuffer\n    });\n  }\n}\n\nexport { BatchGeometry };\n//# sourceMappingURL=BatchGeometry.mjs.map\n","import { warn } from '../../../../utils/logging/warn.mjs';\n\n\"use strict\";\nfunction addBits(srcParts, parts, name) {\n  if (srcParts) {\n    for (const i in srcParts) {\n      const id = i.toLocaleLowerCase();\n      const part = parts[id];\n      if (part) {\n        let sanitisedPart = srcParts[i];\n        if (i === \"header\") {\n          sanitisedPart = sanitisedPart.replace(/@in\\s+[^;]+;\\s*/g, \"\").replace(/@out\\s+[^;]+;\\s*/g, \"\");\n        }\n        if (name) {\n          part.push(`//----${name}----//`);\n        }\n        part.push(sanitisedPart);\n      } else {\n        warn(`${i} placement hook does not exist in shader`);\n      }\n    }\n  }\n}\n\nexport { addBits };\n//# sourceMappingURL=addBits.mjs.map\n","\"use strict\";\nconst findHooksRx = /\\{\\{(.*?)\\}\\}/g;\nfunction compileHooks(programSrc) {\n  const parts = {};\n  const partMatches = programSrc.match(findHooksRx)?.map((hook) => hook.replace(/[{()}]/g, \"\")) ?? [];\n  partMatches.forEach((hook) => {\n    parts[hook] = [];\n  });\n  return parts;\n}\n\nexport { compileHooks };\n//# sourceMappingURL=compileHooks.mjs.map\n","\"use strict\";\nfunction extractInputs(fragmentSource, out) {\n  let match;\n  const regex = /@in\\s+([^;]+);/g;\n  while ((match = regex.exec(fragmentSource)) !== null) {\n    out.push(match[1]);\n  }\n}\nfunction compileInputs(fragments, template, sort = false) {\n  const results = [];\n  extractInputs(template, results);\n  fragments.forEach((fragment) => {\n    if (fragment.header) {\n      extractInputs(fragment.header, results);\n    }\n  });\n  const mainInput = results;\n  if (sort) {\n    mainInput.sort();\n  }\n  const finalString = mainInput.map((inValue, i) => `       @location(${i}) ${inValue},`).join(\"\\n\");\n  let cleanedString = template.replace(/@in\\s+[^;]+;\\s*/g, \"\");\n  cleanedString = cleanedString.replace(\"{{in}}\", `\n${finalString}\n`);\n  return cleanedString;\n}\n\nexport { compileInputs };\n//# sourceMappingURL=compileInputs.mjs.map\n","\"use strict\";\nfunction extractOutputs(fragmentSource, out) {\n  let match;\n  const regex = /@out\\s+([^;]+);/g;\n  while ((match = regex.exec(fragmentSource)) !== null) {\n    out.push(match[1]);\n  }\n}\nfunction extractVariableName(value) {\n  const regex = /\\b(\\w+)\\s*:/g;\n  const match = regex.exec(value);\n  return match ? match[1] : \"\";\n}\nfunction stripVariable(value) {\n  const regex = /@.*?\\s+/g;\n  return value.replace(regex, \"\");\n}\nfunction compileOutputs(fragments, template) {\n  const results = [];\n  extractOutputs(template, results);\n  fragments.forEach((fragment) => {\n    if (fragment.header) {\n      extractOutputs(fragment.header, results);\n    }\n  });\n  let index = 0;\n  const mainStruct = results.sort().map((inValue) => {\n    if (inValue.indexOf(\"builtin\") > -1) {\n      return inValue;\n    }\n    return `@location(${index++}) ${inValue}`;\n  }).join(\",\\n\");\n  const mainStart = results.sort().map((inValue) => `       var ${stripVariable(inValue)};`).join(\"\\n\");\n  const mainEnd = `return VSOutput(\n            ${results.sort().map((inValue) => ` ${extractVariableName(inValue)}`).join(\",\\n\")});`;\n  let compiledCode = template.replace(/@out\\s+[^;]+;\\s*/g, \"\");\n  compiledCode = compiledCode.replace(\"{{struct}}\", `\n${mainStruct}\n`);\n  compiledCode = compiledCode.replace(\"{{start}}\", `\n${mainStart}\n`);\n  compiledCode = compiledCode.replace(\"{{return}}\", `\n${mainEnd}\n`);\n  return compiledCode;\n}\n\nexport { compileOutputs };\n//# sourceMappingURL=compileOutputs.mjs.map\n","\"use strict\";\nfunction injectBits(templateSrc, fragmentParts) {\n  let out = templateSrc;\n  for (const i in fragmentParts) {\n    const parts = fragmentParts[i];\n    const toInject = parts.join(\"\\n\");\n    if (toInject.length) {\n      out = out.replace(`{{${i}}}`, `//-----${i} START-----//\n${parts.join(\"\\n\")}\n//----${i} FINISH----//`);\n    } else {\n      out = out.replace(`{{${i}}}`, \"\");\n    }\n  }\n  return out;\n}\n\nexport { injectBits };\n//# sourceMappingURL=injectBits.mjs.map\n","import { addBits } from './utils/addBits.mjs';\nimport { compileHooks } from './utils/compileHooks.mjs';\nimport { compileInputs } from './utils/compileInputs.mjs';\nimport { compileOutputs } from './utils/compileOutputs.mjs';\nimport { injectBits } from './utils/injectBits.mjs';\n\n\"use strict\";\nconst cacheMap = /* @__PURE__ */ Object.create(null);\nconst bitCacheMap = /* @__PURE__ */ new Map();\nlet CACHE_UID = 0;\nfunction compileHighShader({\n  template,\n  bits\n}) {\n  const cacheId = generateCacheId(template, bits);\n  if (cacheMap[cacheId])\n    return cacheMap[cacheId];\n  const { vertex, fragment } = compileInputsAndOutputs(template, bits);\n  cacheMap[cacheId] = compileBits(vertex, fragment, bits);\n  return cacheMap[cacheId];\n}\nfunction compileHighShaderGl({\n  template,\n  bits\n}) {\n  const cacheId = generateCacheId(template, bits);\n  if (cacheMap[cacheId])\n    return cacheMap[cacheId];\n  cacheMap[cacheId] = compileBits(template.vertex, template.fragment, bits);\n  return cacheMap[cacheId];\n}\nfunction compileInputsAndOutputs(template, bits) {\n  const vertexFragments = bits.map((shaderBit) => shaderBit.vertex).filter((v) => !!v);\n  const fragmentFragments = bits.map((shaderBit) => shaderBit.fragment).filter((v) => !!v);\n  let compiledVertex = compileInputs(vertexFragments, template.vertex, true);\n  compiledVertex = compileOutputs(vertexFragments, compiledVertex);\n  const compiledFragment = compileInputs(fragmentFragments, template.fragment, true);\n  return {\n    vertex: compiledVertex,\n    fragment: compiledFragment\n  };\n}\nfunction generateCacheId(template, bits) {\n  return bits.map((highFragment) => {\n    if (!bitCacheMap.has(highFragment)) {\n      bitCacheMap.set(highFragment, CACHE_UID++);\n    }\n    return bitCacheMap.get(highFragment);\n  }).sort((a, b) => a - b).join(\"-\") + template.vertex + template.fragment;\n}\nfunction compileBits(vertex, fragment, bits) {\n  const vertexParts = compileHooks(vertex);\n  const fragmentParts = compileHooks(fragment);\n  bits.forEach((shaderBit) => {\n    addBits(shaderBit.vertex, vertexParts, shaderBit.name);\n    addBits(shaderBit.fragment, fragmentParts, shaderBit.name);\n  });\n  return {\n    vertex: injectBits(vertex, vertexParts),\n    fragment: injectBits(fragment, fragmentParts)\n  };\n}\n\nexport { compileHighShader, compileHighShaderGl };\n//# sourceMappingURL=compileHighShader.mjs.map\n","\"use strict\";\nconst vertexGPUTemplate = (\n  /* wgsl */\n  `\n    @in aPosition: vec2<f32>;\n    @in aUV: vec2<f32>;\n\n    @out @builtin(position) vPosition: vec4<f32>;\n    @out vUV : vec2<f32>;\n    @out vColor : vec4<f32>;\n\n    {{header}}\n\n    struct VSOutput {\n        {{struct}}\n    };\n\n    @vertex\n    fn main( {{in}} ) -> VSOutput {\n\n        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;\n        var modelMatrix = mat3x3<f32>(\n            1.0, 0.0, 0.0,\n            0.0, 1.0, 0.0,\n            0.0, 0.0, 1.0\n          );\n        var position = aPosition;\n        var uv = aUV;\n\n        {{start}}\n\n        vColor = vec4<f32>(1., 1., 1., 1.);\n\n        {{main}}\n\n        vUV = uv;\n\n        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;\n\n        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);\n\n        vColor *= globalUniforms.uWorldColorAlpha;\n\n        {{end}}\n\n        {{return}}\n    };\n`\n);\nconst fragmentGPUTemplate = (\n  /* wgsl */\n  `\n    @in vUV : vec2<f32>;\n    @in vColor : vec4<f32>;\n\n    {{header}}\n\n    @fragment\n    fn main(\n        {{in}}\n      ) -> @location(0) vec4<f32> {\n\n        {{start}}\n\n        var outColor:vec4<f32>;\n\n        {{main}}\n\n        var finalColor:vec4<f32> = outColor * vColor;\n\n        {{end}}\n\n        return finalColor;\n      };\n`\n);\nconst vertexGlTemplate = (\n  /* glsl */\n  `\n    in vec2 aPosition;\n    in vec2 aUV;\n\n    out vec4 vColor;\n    out vec2 vUV;\n\n    {{header}}\n\n    void main(void){\n\n        mat3 worldTransformMatrix = uWorldTransformMatrix;\n        mat3 modelMatrix = mat3(\n            1.0, 0.0, 0.0,\n            0.0, 1.0, 0.0,\n            0.0, 0.0, 1.0\n          );\n        vec2 position = aPosition;\n        vec2 uv = aUV;\n\n        {{start}}\n\n        vColor = vec4(1.);\n\n        {{main}}\n\n        vUV = uv;\n\n        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;\n\n        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n\n        vColor *= uWorldColorAlpha;\n\n        {{end}}\n    }\n`\n);\nconst fragmentGlTemplate = (\n  /* glsl */\n  `\n\n    in vec4 vColor;\n    in vec2 vUV;\n\n    out vec4 finalColor;\n\n    {{header}}\n\n    void main(void) {\n\n        {{start}}\n\n        vec4 outColor;\n\n        {{main}}\n\n        finalColor = outColor * vColor;\n\n        {{end}}\n    }\n`\n);\n\nexport { fragmentGPUTemplate, fragmentGlTemplate, vertexGPUTemplate, vertexGlTemplate };\n//# sourceMappingURL=defaultProgramTemplate.mjs.map\n","\"use strict\";\nconst globalUniformsBit = {\n  name: \"global-uniforms-bit\",\n  vertex: {\n    header: (\n      /* wgsl */\n      `\n        struct GlobalUniforms {\n            uProjectionMatrix:mat3x3<f32>,\n            uWorldTransformMatrix:mat3x3<f32>,\n            uWorldColorAlpha: vec4<f32>,\n            uResolution: vec2<f32>,\n        }\n\n        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;\n        `\n    )\n  }\n};\nconst globalUniformsUBOBitGl = {\n  name: \"global-uniforms-ubo-bit\",\n  vertex: {\n    header: (\n      /* glsl */\n      `\n          uniform globalUniforms {\n            mat3 uProjectionMatrix;\n            mat3 uWorldTransformMatrix;\n            vec4 uWorldColorAlpha;\n            vec2 uResolution;\n          };\n        `\n    )\n  }\n};\nconst globalUniformsBitGl = {\n  name: \"global-uniforms-bit\",\n  vertex: {\n    header: (\n      /* glsl */\n      `\n          uniform mat3 uProjectionMatrix;\n          uniform mat3 uWorldTransformMatrix;\n          uniform vec4 uWorldColorAlpha;\n          uniform vec2 uResolution;\n        `\n    )\n  }\n};\n\nexport { globalUniformsBit, globalUniformsBitGl, globalUniformsUBOBitGl };\n//# sourceMappingURL=globalUniformsBit.mjs.map\n","import { GlProgram } from '../renderers/gl/shader/GlProgram.mjs';\nimport { GpuProgram } from '../renderers/gpu/shader/GpuProgram.mjs';\nimport { compileHighShader, compileHighShaderGl } from './compiler/compileHighShader.mjs';\nimport { fragmentGPUTemplate, vertexGPUTemplate, vertexGlTemplate, fragmentGlTemplate } from './defaultProgramTemplate.mjs';\nimport { globalUniformsBit, globalUniformsBitGl } from './shader-bits/globalUniformsBit.mjs';\n\n\"use strict\";\nfunction compileHighShaderGpuProgram({ bits, name }) {\n  const source = compileHighShader({\n    template: {\n      fragment: fragmentGPUTemplate,\n      vertex: vertexGPUTemplate\n    },\n    bits: [\n      globalUniformsBit,\n      ...bits\n    ]\n  });\n  return GpuProgram.from({\n    name,\n    vertex: {\n      source: source.vertex,\n      entryPoint: \"main\"\n    },\n    fragment: {\n      source: source.fragment,\n      entryPoint: \"main\"\n    }\n  });\n}\nfunction compileHighShaderGlProgram({ bits, name }) {\n  return new GlProgram({\n    name,\n    ...compileHighShaderGl({\n      template: {\n        vertex: vertexGlTemplate,\n        fragment: fragmentGlTemplate\n      },\n      bits: [\n        globalUniformsBitGl,\n        ...bits\n      ]\n    })\n  });\n}\n\nexport { compileHighShaderGlProgram, compileHighShaderGpuProgram };\n//# sourceMappingURL=compileHighShaderToProgram.mjs.map\n","\"use strict\";\nconst colorBit = {\n  name: \"color-bit\",\n  vertex: {\n    header: (\n      /* wgsl */\n      `\n            @in aColor: vec4<f32>;\n        `\n    ),\n    main: (\n      /* wgsl */\n      `\n            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);\n        `\n    )\n  }\n};\nconst colorBitGl = {\n  name: \"color-bit\",\n  vertex: {\n    header: (\n      /* glsl */\n      `\n            in vec4 aColor;\n        `\n    ),\n    main: (\n      /* glsl */\n      `\n            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);\n        `\n    )\n  }\n};\n\nexport { colorBit, colorBitGl };\n//# sourceMappingURL=colorBit.mjs.map\n","\"use strict\";\nconst textureBatchBitGpuCache = {};\nfunction generateBindingSrc(maxTextures) {\n  const src = [];\n  if (maxTextures === 1) {\n    src.push(\"@group(1) @binding(0) var textureSource1: texture_2d<f32>;\");\n    src.push(\"@group(1) @binding(1) var textureSampler1: sampler;\");\n  } else {\n    let bindingIndex = 0;\n    for (let i = 0; i < maxTextures; i++) {\n      src.push(`@group(1) @binding(${bindingIndex++}) var textureSource${i + 1}: texture_2d<f32>;`);\n      src.push(`@group(1) @binding(${bindingIndex++}) var textureSampler${i + 1}: sampler;`);\n    }\n  }\n  return src.join(\"\\n\");\n}\nfunction generateSampleSrc(maxTextures) {\n  const src = [];\n  if (maxTextures === 1) {\n    src.push(\"outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);\");\n  } else {\n    src.push(\"switch vTextureId {\");\n    for (let i = 0; i < maxTextures; i++) {\n      if (i === maxTextures - 1) {\n        src.push(`  default:{`);\n      } else {\n        src.push(`  case ${i}:{`);\n      }\n      src.push(`      outColor = textureSampleGrad(textureSource${i + 1}, textureSampler${i + 1}, vUV, uvDx, uvDy);`);\n      src.push(`      break;}`);\n    }\n    src.push(`}`);\n  }\n  return src.join(\"\\n\");\n}\nfunction generateTextureBatchBit(maxTextures) {\n  if (!textureBatchBitGpuCache[maxTextures]) {\n    textureBatchBitGpuCache[maxTextures] = {\n      name: \"texture-batch-bit\",\n      vertex: {\n        header: `\n                @in aTextureIdAndRound: vec2<u32>;\n                @out @interpolate(flat) vTextureId : u32;\n            `,\n        main: `\n                vTextureId = aTextureIdAndRound.y;\n            `,\n        end: `\n                if(aTextureIdAndRound.x == 1)\n                {\n                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);\n                }\n            `\n      },\n      fragment: {\n        header: `\n                @in @interpolate(flat) vTextureId: u32;\n\n                ${generateBindingSrc(maxTextures)}\n            `,\n        main: `\n                var uvDx = dpdx(vUV);\n                var uvDy = dpdy(vUV);\n\n                ${generateSampleSrc(maxTextures)}\n            `\n      }\n    };\n  }\n  return textureBatchBitGpuCache[maxTextures];\n}\nconst textureBatchBitGlCache = {};\nfunction generateSampleGlSrc(maxTextures) {\n  const src = [];\n  for (let i = 0; i < maxTextures; i++) {\n    if (i > 0) {\n      src.push(\"else\");\n    }\n    if (i < maxTextures - 1) {\n      src.push(`if(vTextureId < ${i}.5)`);\n    }\n    src.push(\"{\");\n    src.push(`\toutColor = texture(uTextures[${i}], vUV);`);\n    src.push(\"}\");\n  }\n  return src.join(\"\\n\");\n}\nfunction generateTextureBatchBitGl(maxTextures) {\n  if (!textureBatchBitGlCache[maxTextures]) {\n    textureBatchBitGlCache[maxTextures] = {\n      name: \"texture-batch-bit\",\n      vertex: {\n        header: `\n                in vec2 aTextureIdAndRound;\n                out float vTextureId;\n\n            `,\n        main: `\n                vTextureId = aTextureIdAndRound.y;\n            `,\n        end: `\n                if(aTextureIdAndRound.x == 1.)\n                {\n                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);\n                }\n            `\n      },\n      fragment: {\n        header: `\n                in float vTextureId;\n\n                uniform sampler2D uTextures[${maxTextures}];\n\n            `,\n        main: `\n\n                ${generateSampleGlSrc(maxTextures)}\n            `\n      }\n    };\n  }\n  return textureBatchBitGlCache[maxTextures];\n}\n\nexport { generateTextureBatchBit, generateTextureBatchBitGl };\n//# sourceMappingURL=generateTextureBatchBit.mjs.map\n","\"use strict\";\nconst roundPixelsBit = {\n  name: \"round-pixels-bit\",\n  vertex: {\n    header: (\n      /* wgsl */\n      `\n            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32>\n            {\n                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;\n            }\n        `\n    )\n  }\n};\nconst roundPixelsBitGl = {\n  name: \"round-pixels-bit\",\n  vertex: {\n    header: (\n      /* glsl */\n      `\n            vec2 roundPixels(vec2 position, vec2 targetSize)\n            {\n                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;\n            }\n        `\n    )\n  }\n};\n\nexport { roundPixelsBit, roundPixelsBitGl };\n//# sourceMappingURL=roundPixelsBit.mjs.map\n","import { UniformGroup } from '../../shared/shader/UniformGroup.mjs';\n\n\"use strict\";\nconst batchSamplersUniformGroupHash = {};\nfunction getBatchSamplersUniformGroup(maxTextures) {\n  let batchSamplersUniformGroup = batchSamplersUniformGroupHash[maxTextures];\n  if (batchSamplersUniformGroup)\n    return batchSamplersUniformGroup;\n  const sampleValues = new Int32Array(maxTextures);\n  for (let i = 0; i < maxTextures; i++) {\n    sampleValues[i] = i;\n  }\n  batchSamplersUniformGroup = batchSamplersUniformGroupHash[maxTextures] = new UniformGroup({\n    uTextures: { value: sampleValues, type: `i32`, size: maxTextures }\n  }, { isStatic: true });\n  return batchSamplersUniformGroup;\n}\n\nexport { getBatchSamplersUniformGroup };\n//# sourceMappingURL=getBatchSamplersUniformGroup.mjs.map\n","import { compileHighShaderGlProgram, compileHighShaderGpuProgram } from '../../high-shader/compileHighShaderToProgram.mjs';\nimport { colorBitGl, colorBit } from '../../high-shader/shader-bits/colorBit.mjs';\nimport { generateTextureBatchBitGl, generateTextureBatchBit } from '../../high-shader/shader-bits/generateTextureBatchBit.mjs';\nimport { roundPixelsBitGl, roundPixelsBit } from '../../high-shader/shader-bits/roundPixelsBit.mjs';\nimport { getBatchSamplersUniformGroup } from '../../renderers/gl/shader/getBatchSamplersUniformGroup.mjs';\nimport { Shader } from '../../renderers/shared/shader/Shader.mjs';\n\n\"use strict\";\nclass DefaultShader extends Shader {\n  constructor(maxTextures) {\n    const glProgram = compileHighShaderGlProgram({\n      name: \"batch\",\n      bits: [\n        colorBitGl,\n        generateTextureBatchBitGl(maxTextures),\n        roundPixelsBitGl\n      ]\n    });\n    const gpuProgram = compileHighShaderGpuProgram({\n      name: \"batch\",\n      bits: [\n        colorBit,\n        generateTextureBatchBit(maxTextures),\n        roundPixelsBit\n      ]\n    });\n    super({\n      glProgram,\n      gpuProgram,\n      resources: {\n        batchSamplers: getBatchSamplersUniformGroup(maxTextures)\n      }\n    });\n  }\n}\n\nexport { DefaultShader };\n//# sourceMappingURL=DefaultShader.mjs.map\n","import { ExtensionType } from '../../../extensions/Extensions.mjs';\nimport { Batcher } from './Batcher.mjs';\nimport { BatchGeometry } from './BatchGeometry.mjs';\nimport { DefaultShader } from './DefaultShader.mjs';\n\n\"use strict\";\nlet defaultShader = null;\nconst _DefaultBatcher = class _DefaultBatcher extends Batcher {\n  constructor(options) {\n    super(options);\n    this.geometry = new BatchGeometry();\n    this.name = _DefaultBatcher.extension.name;\n    /** The size of one attribute. 1 = 32 bit. x, y, u, v, color, textureIdAndRound -> total = 6 */\n    this.vertexSize = 6;\n    defaultShader ?? (defaultShader = new DefaultShader(options.maxTextures));\n    this.shader = defaultShader;\n  }\n  /**\n   * Packs the attributes of a DefaultBatchableMeshElement into the provided views.\n   * @param element - The DefaultBatchableMeshElement to pack.\n   * @param float32View - The Float32Array view to pack into.\n   * @param uint32View - The Uint32Array view to pack into.\n   * @param index - The starting index in the views.\n   * @param textureId - The texture ID to use.\n   */\n  packAttributes(element, float32View, uint32View, index, textureId) {\n    const textureIdAndRound = textureId << 16 | element.roundPixels & 65535;\n    const wt = element.transform;\n    const a = wt.a;\n    const b = wt.b;\n    const c = wt.c;\n    const d = wt.d;\n    const tx = wt.tx;\n    const ty = wt.ty;\n    const { positions, uvs } = element;\n    const argb = element.color;\n    const offset = element.attributeOffset;\n    const end = offset + element.attributeSize;\n    for (let i = offset; i < end; i++) {\n      const i2 = i * 2;\n      const x = positions[i2];\n      const y = positions[i2 + 1];\n      float32View[index++] = a * x + c * y + tx;\n      float32View[index++] = d * y + b * x + ty;\n      float32View[index++] = uvs[i2];\n      float32View[index++] = uvs[i2 + 1];\n      uint32View[index++] = argb;\n      uint32View[index++] = textureIdAndRound;\n    }\n  }\n  /**\n   * Packs the attributes of a DefaultBatchableQuadElement into the provided views.\n   * @param element - The DefaultBatchableQuadElement to pack.\n   * @param float32View - The Float32Array view to pack into.\n   * @param uint32View - The Uint32Array view to pack into.\n   * @param index - The starting index in the views.\n   * @param textureId - The texture ID to use.\n   */\n  packQuadAttributes(element, float32View, uint32View, index, textureId) {\n    const texture = element.texture;\n    const wt = element.transform;\n    const a = wt.a;\n    const b = wt.b;\n    const c = wt.c;\n    const d = wt.d;\n    const tx = wt.tx;\n    const ty = wt.ty;\n    const bounds = element.bounds;\n    const w0 = bounds.maxX;\n    const w1 = bounds.minX;\n    const h0 = bounds.maxY;\n    const h1 = bounds.minY;\n    const uvs = texture.uvs;\n    const argb = element.color;\n    const textureIdAndRound = textureId << 16 | element.roundPixels & 65535;\n    float32View[index + 0] = a * w1 + c * h1 + tx;\n    float32View[index + 1] = d * h1 + b * w1 + ty;\n    float32View[index + 2] = uvs.x0;\n    float32View[index + 3] = uvs.y0;\n    uint32View[index + 4] = argb;\n    uint32View[index + 5] = textureIdAndRound;\n    float32View[index + 6] = a * w0 + c * h1 + tx;\n    float32View[index + 7] = d * h1 + b * w0 + ty;\n    float32View[index + 8] = uvs.x1;\n    float32View[index + 9] = uvs.y1;\n    uint32View[index + 10] = argb;\n    uint32View[index + 11] = textureIdAndRound;\n    float32View[index + 12] = a * w0 + c * h0 + tx;\n    float32View[index + 13] = d * h0 + b * w0 + ty;\n    float32View[index + 14] = uvs.x2;\n    float32View[index + 15] = uvs.y2;\n    uint32View[index + 16] = argb;\n    uint32View[index + 17] = textureIdAndRound;\n    float32View[index + 18] = a * w1 + c * h0 + tx;\n    float32View[index + 19] = d * h0 + b * w1 + ty;\n    float32View[index + 20] = uvs.x3;\n    float32View[index + 21] = uvs.y3;\n    uint32View[index + 22] = argb;\n    uint32View[index + 23] = textureIdAndRound;\n  }\n};\n/** @ignore */\n_DefaultBatcher.extension = {\n  type: [\n    ExtensionType.Batcher\n  ],\n  name: \"default\"\n};\nlet DefaultBatcher = _DefaultBatcher;\n\nexport { DefaultBatcher };\n//# sourceMappingURL=DefaultBatcher.mjs.map\n","\"use strict\";\nfunction buildUvs(vertices, verticesStride, verticesOffset, uvs, uvsOffset, uvsStride, size, matrix = null) {\n  let index = 0;\n  verticesOffset *= verticesStride;\n  uvsOffset *= uvsStride;\n  const a = matrix.a;\n  const b = matrix.b;\n  const c = matrix.c;\n  const d = matrix.d;\n  const tx = matrix.tx;\n  const ty = matrix.ty;\n  while (index < size) {\n    const x = vertices[verticesOffset];\n    const y = vertices[verticesOffset + 1];\n    uvs[uvsOffset] = a * x + c * y + tx;\n    uvs[uvsOffset + 1] = b * x + d * y + ty;\n    uvsOffset += uvsStride;\n    verticesOffset += verticesStride;\n    index++;\n  }\n}\nfunction buildSimpleUvs(uvs, uvsOffset, uvsStride, size) {\n  let index = 0;\n  uvsOffset *= uvsStride;\n  while (index < size) {\n    uvs[uvsOffset] = 0;\n    uvs[uvsOffset + 1] = 0;\n    uvsOffset += uvsStride;\n    index++;\n  }\n}\n\nexport { buildSimpleUvs, buildUvs };\n//# sourceMappingURL=buildUvs.mjs.map\n","\"use strict\";\nfunction transformVertices(vertices, m, offset, stride, size) {\n  const a = m.a;\n  const b = m.b;\n  const c = m.c;\n  const d = m.d;\n  const tx = m.tx;\n  const ty = m.ty;\n  offset || (offset = 0);\n  stride || (stride = 2);\n  size || (size = vertices.length / stride - offset);\n  let index = offset * stride;\n  for (let i = 0; i < size; i++) {\n    const x = vertices[index];\n    const y = vertices[index + 1];\n    vertices[index] = a * x + c * y + tx;\n    vertices[index + 1] = b * x + d * y + ty;\n    index += stride;\n  }\n}\n\nexport { transformVertices };\n//# sourceMappingURL=transformVertices.mjs.map\n","import { Matrix } from '../../../maths/matrix/Matrix.mjs';\nimport { multiplyHexColors } from '../../container/utils/multiplyHexColors.mjs';\n\n\"use strict\";\nconst identityMatrix = new Matrix();\nclass BatchableGraphics {\n  constructor() {\n    this.packAsQuad = false;\n    this.batcherName = \"default\";\n    this.topology = \"triangle-list\";\n    this.applyTransform = true;\n    this.roundPixels = 0;\n    this._batcher = null;\n    this._batch = null;\n  }\n  get uvs() {\n    return this.geometryData.uvs;\n  }\n  get positions() {\n    return this.geometryData.vertices;\n  }\n  get indices() {\n    return this.geometryData.indices;\n  }\n  get blendMode() {\n    if (this.renderable && this.applyTransform) {\n      return this.renderable.groupBlendMode;\n    }\n    return \"normal\";\n  }\n  get color() {\n    const rgb = this.baseColor;\n    const bgr = rgb >> 16 | rgb & 65280 | (rgb & 255) << 16;\n    const renderable = this.renderable;\n    if (renderable) {\n      return multiplyHexColors(bgr, renderable.groupColor) + (this.alpha * renderable.groupAlpha * 255 << 24);\n    }\n    return bgr + (this.alpha * 255 << 24);\n  }\n  get transform() {\n    return this.renderable?.groupTransform || identityMatrix;\n  }\n  copyTo(gpuBuffer) {\n    gpuBuffer.indexOffset = this.indexOffset;\n    gpuBuffer.indexSize = this.indexSize;\n    gpuBuffer.attributeOffset = this.attributeOffset;\n    gpuBuffer.attributeSize = this.attributeSize;\n    gpuBuffer.baseColor = this.baseColor;\n    gpuBuffer.alpha = this.alpha;\n    gpuBuffer.texture = this.texture;\n    gpuBuffer.geometryData = this.geometryData;\n    gpuBuffer.topology = this.topology;\n  }\n  reset() {\n    this.applyTransform = true;\n    this.renderable = null;\n    this.topology = \"triangle-list\";\n  }\n  destroy() {\n    this.renderable = null;\n    this.texture = null;\n    this.geometryData = null;\n    this._batcher = null;\n    this._batch = null;\n  }\n}\n\nexport { BatchableGraphics };\n//# sourceMappingURL=BatchableGraphics.mjs.map\n","import { ExtensionType } from '../../../../extensions/Extensions.mjs';\n\n\"use strict\";\nconst buildCircle = {\n  extension: {\n    type: ExtensionType.ShapeBuilder,\n    name: \"circle\"\n  },\n  build(shape, points) {\n    let x;\n    let y;\n    let dx;\n    let dy;\n    let rx;\n    let ry;\n    if (shape.type === \"circle\") {\n      const circle = shape;\n      rx = ry = circle.radius;\n      if (rx <= 0) {\n        return false;\n      }\n      x = circle.x;\n      y = circle.y;\n      dx = dy = 0;\n    } else if (shape.type === \"ellipse\") {\n      const ellipse = shape;\n      rx = ellipse.halfWidth;\n      ry = ellipse.halfHeight;\n      if (rx <= 0 || ry <= 0) {\n        return false;\n      }\n      x = ellipse.x;\n      y = ellipse.y;\n      dx = dy = 0;\n    } else {\n      const roundedRect = shape;\n      const halfWidth = roundedRect.width / 2;\n      const halfHeight = roundedRect.height / 2;\n      x = roundedRect.x + halfWidth;\n      y = roundedRect.y + halfHeight;\n      rx = ry = Math.max(0, Math.min(roundedRect.radius, Math.min(halfWidth, halfHeight)));\n      dx = halfWidth - rx;\n      dy = halfHeight - ry;\n    }\n    if (dx < 0 || dy < 0) {\n      return false;\n    }\n    const n = Math.ceil(2.3 * Math.sqrt(rx + ry));\n    const m = n * 8 + (dx ? 4 : 0) + (dy ? 4 : 0);\n    if (m === 0) {\n      return false;\n    }\n    if (n === 0) {\n      points[0] = points[6] = x + dx;\n      points[1] = points[3] = y + dy;\n      points[2] = points[4] = x - dx;\n      points[5] = points[7] = y - dy;\n      return true;\n    }\n    let j1 = 0;\n    let j2 = n * 4 + (dx ? 2 : 0) + 2;\n    let j3 = j2;\n    let j4 = m;\n    let x0 = dx + rx;\n    let y0 = dy;\n    let x1 = x + x0;\n    let x2 = x - x0;\n    let y1 = y + y0;\n    points[j1++] = x1;\n    points[j1++] = y1;\n    points[--j2] = y1;\n    points[--j2] = x2;\n    if (dy) {\n      const y22 = y - y0;\n      points[j3++] = x2;\n      points[j3++] = y22;\n      points[--j4] = y22;\n      points[--j4] = x1;\n    }\n    for (let i = 1; i < n; i++) {\n      const a = Math.PI / 2 * (i / n);\n      const x02 = dx + Math.cos(a) * rx;\n      const y02 = dy + Math.sin(a) * ry;\n      const x12 = x + x02;\n      const x22 = x - x02;\n      const y12 = y + y02;\n      const y22 = y - y02;\n      points[j1++] = x12;\n      points[j1++] = y12;\n      points[--j2] = y12;\n      points[--j2] = x22;\n      points[j3++] = x22;\n      points[j3++] = y22;\n      points[--j4] = y22;\n      points[--j4] = x12;\n    }\n    x0 = dx;\n    y0 = dy + ry;\n    x1 = x + x0;\n    x2 = x - x0;\n    y1 = y + y0;\n    const y2 = y - y0;\n    points[j1++] = x1;\n    points[j1++] = y1;\n    points[--j4] = y2;\n    points[--j4] = x1;\n    if (dx) {\n      points[j1++] = x2;\n      points[j1++] = y1;\n      points[--j4] = y2;\n      points[--j4] = x2;\n    }\n    return true;\n  },\n  triangulate(points, vertices, verticesStride, verticesOffset, indices, indicesOffset) {\n    if (points.length === 0) {\n      return;\n    }\n    let centerX = 0;\n    let centerY = 0;\n    for (let i = 0; i < points.length; i += 2) {\n      centerX += points[i];\n      centerY += points[i + 1];\n    }\n    centerX /= points.length / 2;\n    centerY /= points.length / 2;\n    let count = verticesOffset;\n    vertices[count * verticesStride] = centerX;\n    vertices[count * verticesStride + 1] = centerY;\n    const centerIndex = count++;\n    for (let i = 0; i < points.length; i += 2) {\n      vertices[count * verticesStride] = points[i];\n      vertices[count * verticesStride + 1] = points[i + 1];\n      if (i > 0) {\n        indices[indicesOffset++] = count;\n        indices[indicesOffset++] = centerIndex;\n        indices[indicesOffset++] = count - 1;\n      }\n      count++;\n    }\n    indices[indicesOffset++] = centerIndex + 1;\n    indices[indicesOffset++] = centerIndex;\n    indices[indicesOffset++] = count - 1;\n  }\n};\nconst buildEllipse = { ...buildCircle, extension: { ...buildCircle.extension, name: \"ellipse\" } };\nconst buildRoundedRectangle = { ...buildCircle, extension: { ...buildCircle.extension, name: \"roundedRectangle\" } };\n\nexport { buildCircle, buildEllipse, buildRoundedRectangle };\n//# sourceMappingURL=buildCircle.mjs.map\n","\"use strict\";\nconst closePointEps = 1e-4;\nconst curveEps = 1e-4;\n\nexport { closePointEps, curveEps };\n//# sourceMappingURL=const.mjs.map\n","\"use strict\";\nfunction getOrientationOfPoints(points) {\n  const m = points.length;\n  if (m < 6) {\n    return 1;\n  }\n  let area = 0;\n  for (let i = 0, x1 = points[m - 2], y1 = points[m - 1]; i < m; i += 2) {\n    const x2 = points[i];\n    const y2 = points[i + 1];\n    area += (x2 - x1) * (y2 + y1);\n    x1 = x2;\n    y1 = y2;\n  }\n  if (area < 0) {\n    return -1;\n  }\n  return 1;\n}\n\nexport { getOrientationOfPoints };\n//# sourceMappingURL=getOrientationOfPoints.mjs.map\n","import { Point } from '../../../../maths/point/Point.mjs';\nimport { closePointEps, curveEps } from '../const.mjs';\nimport { getOrientationOfPoints } from '../utils/getOrientationOfPoints.mjs';\n\n\"use strict\";\nfunction square(x, y, nx, ny, innerWeight, outerWeight, clockwise, verts) {\n  const ix = x - nx * innerWeight;\n  const iy = y - ny * innerWeight;\n  const ox = x + nx * outerWeight;\n  const oy = y + ny * outerWeight;\n  let exx;\n  let eyy;\n  if (clockwise) {\n    exx = ny;\n    eyy = -nx;\n  } else {\n    exx = -ny;\n    eyy = nx;\n  }\n  const eix = ix + exx;\n  const eiy = iy + eyy;\n  const eox = ox + exx;\n  const eoy = oy + eyy;\n  verts.push(eix, eiy);\n  verts.push(eox, eoy);\n  return 2;\n}\nfunction round(cx, cy, sx, sy, ex, ey, verts, clockwise) {\n  const cx2p0x = sx - cx;\n  const cy2p0y = sy - cy;\n  let angle0 = Math.atan2(cx2p0x, cy2p0y);\n  let angle1 = Math.atan2(ex - cx, ey - cy);\n  if (clockwise && angle0 < angle1) {\n    angle0 += Math.PI * 2;\n  } else if (!clockwise && angle0 > angle1) {\n    angle1 += Math.PI * 2;\n  }\n  let startAngle = angle0;\n  const angleDiff = angle1 - angle0;\n  const absAngleDiff = Math.abs(angleDiff);\n  const radius = Math.sqrt(cx2p0x * cx2p0x + cy2p0y * cy2p0y);\n  const segCount = (15 * absAngleDiff * Math.sqrt(radius) / Math.PI >> 0) + 1;\n  const angleInc = angleDiff / segCount;\n  startAngle += angleInc;\n  if (clockwise) {\n    verts.push(cx, cy);\n    verts.push(sx, sy);\n    for (let i = 1, angle = startAngle; i < segCount; i++, angle += angleInc) {\n      verts.push(cx, cy);\n      verts.push(\n        cx + Math.sin(angle) * radius,\n        cy + Math.cos(angle) * radius\n      );\n    }\n    verts.push(cx, cy);\n    verts.push(ex, ey);\n  } else {\n    verts.push(sx, sy);\n    verts.push(cx, cy);\n    for (let i = 1, angle = startAngle; i < segCount; i++, angle += angleInc) {\n      verts.push(\n        cx + Math.sin(angle) * radius,\n        cy + Math.cos(angle) * radius\n      );\n      verts.push(cx, cy);\n    }\n    verts.push(ex, ey);\n    verts.push(cx, cy);\n  }\n  return segCount * 2;\n}\nfunction buildLine(points, lineStyle, flipAlignment, closed, vertices, indices) {\n  const eps = closePointEps;\n  if (points.length === 0) {\n    return;\n  }\n  const style = lineStyle;\n  let alignment = style.alignment;\n  if (lineStyle.alignment !== 0.5) {\n    let orientation = getOrientationOfPoints(points);\n    if (flipAlignment)\n      orientation *= -1;\n    alignment = (alignment - 0.5) * orientation + 0.5;\n  }\n  const firstPoint = new Point(points[0], points[1]);\n  const lastPoint = new Point(points[points.length - 2], points[points.length - 1]);\n  const closedShape = closed;\n  const closedPath = Math.abs(firstPoint.x - lastPoint.x) < eps && Math.abs(firstPoint.y - lastPoint.y) < eps;\n  if (closedShape) {\n    points = points.slice();\n    if (closedPath) {\n      points.pop();\n      points.pop();\n      lastPoint.set(points[points.length - 2], points[points.length - 1]);\n    }\n    const midPointX = (firstPoint.x + lastPoint.x) * 0.5;\n    const midPointY = (lastPoint.y + firstPoint.y) * 0.5;\n    points.unshift(midPointX, midPointY);\n    points.push(midPointX, midPointY);\n  }\n  const verts = vertices;\n  const length = points.length / 2;\n  let indexCount = points.length;\n  const indexStart = verts.length / 2;\n  const width = style.width / 2;\n  const widthSquared = width * width;\n  const miterLimitSquared = style.miterLimit * style.miterLimit;\n  let x0 = points[0];\n  let y0 = points[1];\n  let x1 = points[2];\n  let y1 = points[3];\n  let x2 = 0;\n  let y2 = 0;\n  let perpX = -(y0 - y1);\n  let perpY = x0 - x1;\n  let perp1x = 0;\n  let perp1y = 0;\n  let dist = Math.sqrt(perpX * perpX + perpY * perpY);\n  perpX /= dist;\n  perpY /= dist;\n  perpX *= width;\n  perpY *= width;\n  const ratio = alignment;\n  const innerWeight = (1 - ratio) * 2;\n  const outerWeight = ratio * 2;\n  if (!closedShape) {\n    if (style.cap === \"round\") {\n      indexCount += round(\n        x0 - perpX * (innerWeight - outerWeight) * 0.5,\n        y0 - perpY * (innerWeight - outerWeight) * 0.5,\n        x0 - perpX * innerWeight,\n        y0 - perpY * innerWeight,\n        x0 + perpX * outerWeight,\n        y0 + perpY * outerWeight,\n        verts,\n        true\n      ) + 2;\n    } else if (style.cap === \"square\") {\n      indexCount += square(x0, y0, perpX, perpY, innerWeight, outerWeight, true, verts);\n    }\n  }\n  verts.push(\n    x0 - perpX * innerWeight,\n    y0 - perpY * innerWeight\n  );\n  verts.push(\n    x0 + perpX * outerWeight,\n    y0 + perpY * outerWeight\n  );\n  for (let i = 1; i < length - 1; ++i) {\n    x0 = points[(i - 1) * 2];\n    y0 = points[(i - 1) * 2 + 1];\n    x1 = points[i * 2];\n    y1 = points[i * 2 + 1];\n    x2 = points[(i + 1) * 2];\n    y2 = points[(i + 1) * 2 + 1];\n    perpX = -(y0 - y1);\n    perpY = x0 - x1;\n    dist = Math.sqrt(perpX * perpX + perpY * perpY);\n    perpX /= dist;\n    perpY /= dist;\n    perpX *= width;\n    perpY *= width;\n    perp1x = -(y1 - y2);\n    perp1y = x1 - x2;\n    dist = Math.sqrt(perp1x * perp1x + perp1y * perp1y);\n    perp1x /= dist;\n    perp1y /= dist;\n    perp1x *= width;\n    perp1y *= width;\n    const dx0 = x1 - x0;\n    const dy0 = y0 - y1;\n    const dx1 = x1 - x2;\n    const dy1 = y2 - y1;\n    const dot = dx0 * dx1 + dy0 * dy1;\n    const cross = dy0 * dx1 - dy1 * dx0;\n    const clockwise = cross < 0;\n    if (Math.abs(cross) < 1e-3 * Math.abs(dot)) {\n      verts.push(\n        x1 - perpX * innerWeight,\n        y1 - perpY * innerWeight\n      );\n      verts.push(\n        x1 + perpX * outerWeight,\n        y1 + perpY * outerWeight\n      );\n      if (dot >= 0) {\n        if (style.join === \"round\") {\n          indexCount += round(\n            x1,\n            y1,\n            x1 - perpX * innerWeight,\n            y1 - perpY * innerWeight,\n            x1 - perp1x * innerWeight,\n            y1 - perp1y * innerWeight,\n            verts,\n            false\n          ) + 4;\n        } else {\n          indexCount += 2;\n        }\n        verts.push(\n          x1 - perp1x * outerWeight,\n          y1 - perp1y * outerWeight\n        );\n        verts.push(\n          x1 + perp1x * innerWeight,\n          y1 + perp1y * innerWeight\n        );\n      }\n      continue;\n    }\n    const c1 = (-perpX + x0) * (-perpY + y1) - (-perpX + x1) * (-perpY + y0);\n    const c2 = (-perp1x + x2) * (-perp1y + y1) - (-perp1x + x1) * (-perp1y + y2);\n    const px = (dx0 * c2 - dx1 * c1) / cross;\n    const py = (dy1 * c1 - dy0 * c2) / cross;\n    const pDist = (px - x1) * (px - x1) + (py - y1) * (py - y1);\n    const imx = x1 + (px - x1) * innerWeight;\n    const imy = y1 + (py - y1) * innerWeight;\n    const omx = x1 - (px - x1) * outerWeight;\n    const omy = y1 - (py - y1) * outerWeight;\n    const smallerInsideSegmentSq = Math.min(dx0 * dx0 + dy0 * dy0, dx1 * dx1 + dy1 * dy1);\n    const insideWeight = clockwise ? innerWeight : outerWeight;\n    const smallerInsideDiagonalSq = smallerInsideSegmentSq + insideWeight * insideWeight * widthSquared;\n    const insideMiterOk = pDist <= smallerInsideDiagonalSq;\n    if (insideMiterOk) {\n      if (style.join === \"bevel\" || pDist / widthSquared > miterLimitSquared) {\n        if (clockwise) {\n          verts.push(imx, imy);\n          verts.push(x1 + perpX * outerWeight, y1 + perpY * outerWeight);\n          verts.push(imx, imy);\n          verts.push(x1 + perp1x * outerWeight, y1 + perp1y * outerWeight);\n        } else {\n          verts.push(x1 - perpX * innerWeight, y1 - perpY * innerWeight);\n          verts.push(omx, omy);\n          verts.push(x1 - perp1x * innerWeight, y1 - perp1y * innerWeight);\n          verts.push(omx, omy);\n        }\n        indexCount += 2;\n      } else if (style.join === \"round\") {\n        if (clockwise) {\n          verts.push(imx, imy);\n          verts.push(x1 + perpX * outerWeight, y1 + perpY * outerWeight);\n          indexCount += round(\n            x1,\n            y1,\n            x1 + perpX * outerWeight,\n            y1 + perpY * outerWeight,\n            x1 + perp1x * outerWeight,\n            y1 + perp1y * outerWeight,\n            verts,\n            true\n          ) + 4;\n          verts.push(imx, imy);\n          verts.push(x1 + perp1x * outerWeight, y1 + perp1y * outerWeight);\n        } else {\n          verts.push(x1 - perpX * innerWeight, y1 - perpY * innerWeight);\n          verts.push(omx, omy);\n          indexCount += round(\n            x1,\n            y1,\n            x1 - perpX * innerWeight,\n            y1 - perpY * innerWeight,\n            x1 - perp1x * innerWeight,\n            y1 - perp1y * innerWeight,\n            verts,\n            false\n          ) + 4;\n          verts.push(x1 - perp1x * innerWeight, y1 - perp1y * innerWeight);\n          verts.push(omx, omy);\n        }\n      } else {\n        verts.push(imx, imy);\n        verts.push(omx, omy);\n      }\n    } else {\n      verts.push(x1 - perpX * innerWeight, y1 - perpY * innerWeight);\n      verts.push(x1 + perpX * outerWeight, y1 + perpY * outerWeight);\n      if (style.join === \"round\") {\n        if (clockwise) {\n          indexCount += round(\n            x1,\n            y1,\n            x1 + perpX * outerWeight,\n            y1 + perpY * outerWeight,\n            x1 + perp1x * outerWeight,\n            y1 + perp1y * outerWeight,\n            verts,\n            true\n          ) + 2;\n        } else {\n          indexCount += round(\n            x1,\n            y1,\n            x1 - perpX * innerWeight,\n            y1 - perpY * innerWeight,\n            x1 - perp1x * innerWeight,\n            y1 - perp1y * innerWeight,\n            verts,\n            false\n          ) + 2;\n        }\n      } else if (style.join === \"miter\" && pDist / widthSquared <= miterLimitSquared) {\n        if (clockwise) {\n          verts.push(omx, omy);\n          verts.push(omx, omy);\n        } else {\n          verts.push(imx, imy);\n          verts.push(imx, imy);\n        }\n        indexCount += 2;\n      }\n      verts.push(x1 - perp1x * innerWeight, y1 - perp1y * innerWeight);\n      verts.push(x1 + perp1x * outerWeight, y1 + perp1y * outerWeight);\n      indexCount += 2;\n    }\n  }\n  x0 = points[(length - 2) * 2];\n  y0 = points[(length - 2) * 2 + 1];\n  x1 = points[(length - 1) * 2];\n  y1 = points[(length - 1) * 2 + 1];\n  perpX = -(y0 - y1);\n  perpY = x0 - x1;\n  dist = Math.sqrt(perpX * perpX + perpY * perpY);\n  perpX /= dist;\n  perpY /= dist;\n  perpX *= width;\n  perpY *= width;\n  verts.push(x1 - perpX * innerWeight, y1 - perpY * innerWeight);\n  verts.push(x1 + perpX * outerWeight, y1 + perpY * outerWeight);\n  if (!closedShape) {\n    if (style.cap === \"round\") {\n      indexCount += round(\n        x1 - perpX * (innerWeight - outerWeight) * 0.5,\n        y1 - perpY * (innerWeight - outerWeight) * 0.5,\n        x1 - perpX * innerWeight,\n        y1 - perpY * innerWeight,\n        x1 + perpX * outerWeight,\n        y1 + perpY * outerWeight,\n        verts,\n        false\n      ) + 2;\n    } else if (style.cap === \"square\") {\n      indexCount += square(x1, y1, perpX, perpY, innerWeight, outerWeight, false, verts);\n    }\n  }\n  const eps2 = curveEps * curveEps;\n  for (let i = indexStart; i < indexCount + indexStart - 2; ++i) {\n    x0 = verts[i * 2];\n    y0 = verts[i * 2 + 1];\n    x1 = verts[(i + 1) * 2];\n    y1 = verts[(i + 1) * 2 + 1];\n    x2 = verts[(i + 2) * 2];\n    y2 = verts[(i + 2) * 2 + 1];\n    if (Math.abs(x0 * (y1 - y2) + x1 * (y2 - y0) + x2 * (y0 - y1)) < eps2) {\n      continue;\n    }\n    indices.push(i, i + 1, i + 2);\n  }\n}\n\nexport { buildLine };\n//# sourceMappingURL=buildLine.mjs.map\n","import { closePointEps } from '../const.mjs';\n\n\"use strict\";\nfunction buildPixelLine(points, closed, vertices, indices) {\n  const eps = closePointEps;\n  if (points.length === 0) {\n    return;\n  }\n  const fx = points[0];\n  const fy = points[1];\n  const lx = points[points.length - 2];\n  const ly = points[points.length - 1];\n  const closePath = closed || Math.abs(fx - lx) < eps && Math.abs(fy - ly) < eps;\n  const verts = vertices;\n  const length = points.length / 2;\n  const indexStart = verts.length / 2;\n  for (let i = 0; i < length; i++) {\n    verts.push(points[i * 2]);\n    verts.push(points[i * 2 + 1]);\n  }\n  for (let i = 0; i < length - 1; i++) {\n    indices.push(indexStart + i, indexStart + i + 1);\n  }\n  if (closePath) {\n    indices.push(indexStart + length - 1, indexStart);\n  }\n}\n\nexport { buildPixelLine };\n//# sourceMappingURL=buildPixelLine.mjs.map\n","import { earcut } from '../../../../utils/utils.mjs';\n\n\"use strict\";\nfunction triangulateWithHoles(points, holes, vertices, verticesStride, verticesOffset, indices, indicesOffset) {\n  const triangles = earcut(points, holes, 2);\n  if (!triangles) {\n    return;\n  }\n  for (let i = 0; i < triangles.length; i += 3) {\n    indices[indicesOffset++] = triangles[i] + verticesOffset;\n    indices[indicesOffset++] = triangles[i + 1] + verticesOffset;\n    indices[indicesOffset++] = triangles[i + 2] + verticesOffset;\n  }\n  let index = verticesOffset * verticesStride;\n  for (let i = 0; i < points.length; i += 2) {\n    vertices[index] = points[i];\n    vertices[index + 1] = points[i + 1];\n    index += verticesStride;\n  }\n}\n\nexport { triangulateWithHoles };\n//# sourceMappingURL=triangulateWithHoles.mjs.map\n","import { ExtensionType } from '../../../../extensions/Extensions.mjs';\nimport { triangulateWithHoles } from '../utils/triangulateWithHoles.mjs';\n\n\"use strict\";\nconst emptyArray = [];\nconst buildPolygon = {\n  extension: {\n    type: ExtensionType.ShapeBuilder,\n    name: \"polygon\"\n  },\n  build(shape, points) {\n    for (let i = 0; i < shape.points.length; i++) {\n      points[i] = shape.points[i];\n    }\n    return true;\n  },\n  triangulate(points, vertices, verticesStride, verticesOffset, indices, indicesOffset) {\n    triangulateWithHoles(points, emptyArray, vertices, verticesStride, verticesOffset, indices, indicesOffset);\n  }\n};\n\nexport { buildPolygon };\n//# sourceMappingURL=buildPolygon.mjs.map\n","import { ExtensionType } from '../../../../extensions/Extensions.mjs';\n\n\"use strict\";\nconst buildRectangle = {\n  extension: {\n    type: ExtensionType.ShapeBuilder,\n    name: \"rectangle\"\n  },\n  build(shape, points) {\n    const rectData = shape;\n    const x = rectData.x;\n    const y = rectData.y;\n    const width = rectData.width;\n    const height = rectData.height;\n    if (!(width > 0 && height > 0)) {\n      return false;\n    }\n    points[0] = x;\n    points[1] = y;\n    points[2] = x + width;\n    points[3] = y;\n    points[4] = x + width;\n    points[5] = y + height;\n    points[6] = x;\n    points[7] = y + height;\n    return true;\n  },\n  triangulate(points, vertices, verticesStride, verticesOffset, indices, indicesOffset) {\n    let count = 0;\n    verticesOffset *= verticesStride;\n    vertices[verticesOffset + count] = points[0];\n    vertices[verticesOffset + count + 1] = points[1];\n    count += verticesStride;\n    vertices[verticesOffset + count] = points[2];\n    vertices[verticesOffset + count + 1] = points[3];\n    count += verticesStride;\n    vertices[verticesOffset + count] = points[6];\n    vertices[verticesOffset + count + 1] = points[7];\n    count += verticesStride;\n    vertices[verticesOffset + count] = points[4];\n    vertices[verticesOffset + count + 1] = points[5];\n    count += verticesStride;\n    const verticesIndex = verticesOffset / verticesStride;\n    indices[indicesOffset++] = verticesIndex;\n    indices[indicesOffset++] = verticesIndex + 1;\n    indices[indicesOffset++] = verticesIndex + 2;\n    indices[indicesOffset++] = verticesIndex + 1;\n    indices[indicesOffset++] = verticesIndex + 3;\n    indices[indicesOffset++] = verticesIndex + 2;\n  }\n};\n\nexport { buildRectangle };\n//# sourceMappingURL=buildRectangle.mjs.map\n","import { ExtensionType } from '../../../../extensions/Extensions.mjs';\n\n\"use strict\";\nconst buildTriangle = {\n  extension: {\n    type: ExtensionType.ShapeBuilder,\n    name: \"triangle\"\n  },\n  build(shape, points) {\n    points[0] = shape.x;\n    points[1] = shape.y;\n    points[2] = shape.x2;\n    points[3] = shape.y2;\n    points[4] = shape.x3;\n    points[5] = shape.y3;\n    return true;\n  },\n  triangulate(points, vertices, verticesStride, verticesOffset, indices, indicesOffset) {\n    let count = 0;\n    verticesOffset *= verticesStride;\n    vertices[verticesOffset + count] = points[0];\n    vertices[verticesOffset + count + 1] = points[1];\n    count += verticesStride;\n    vertices[verticesOffset + count] = points[2];\n    vertices[verticesOffset + count + 1] = points[3];\n    count += verticesStride;\n    vertices[verticesOffset + count] = points[4];\n    vertices[verticesOffset + count + 1] = points[5];\n    const verticesIndex = verticesOffset / verticesStride;\n    indices[indicesOffset++] = verticesIndex;\n    indices[indicesOffset++] = verticesIndex + 1;\n    indices[indicesOffset++] = verticesIndex + 2;\n  }\n};\n\nexport { buildTriangle };\n//# sourceMappingURL=buildTriangle.mjs.map\n","import { Matrix } from '../../../../maths/matrix/Matrix.mjs';\nimport { Rectangle } from '../../../../maths/shapes/Rectangle.mjs';\nimport { FillGradient } from '../fill/FillGradient.mjs';\n\n\"use strict\";\nconst tempTextureMatrix = new Matrix();\nconst tempRect = new Rectangle();\nfunction generateTextureMatrix(out, style, shape, matrix) {\n  const textureMatrix = style.matrix ? out.copyFrom(style.matrix).invert() : out.identity();\n  if (style.textureSpace === \"local\") {\n    const bounds = shape.getBounds(tempRect);\n    if (style.width) {\n      bounds.pad(style.width);\n    }\n    const { x: tx, y: ty } = bounds;\n    const sx = 1 / bounds.width;\n    const sy = 1 / bounds.height;\n    const mTx = -tx * sx;\n    const mTy = -ty * sy;\n    const a1 = textureMatrix.a;\n    const b1 = textureMatrix.b;\n    const c1 = textureMatrix.c;\n    const d1 = textureMatrix.d;\n    textureMatrix.a *= sx;\n    textureMatrix.b *= sx;\n    textureMatrix.c *= sy;\n    textureMatrix.d *= sy;\n    textureMatrix.tx = mTx * a1 + mTy * c1 + textureMatrix.tx;\n    textureMatrix.ty = mTx * b1 + mTy * d1 + textureMatrix.ty;\n  } else {\n    textureMatrix.translate(style.texture.frame.x, style.texture.frame.y);\n    textureMatrix.scale(1 / style.texture.source.width, 1 / style.texture.source.height);\n  }\n  const sourceStyle = style.texture.source.style;\n  if (!(style.fill instanceof FillGradient) && sourceStyle.addressMode === \"clamp-to-edge\") {\n    sourceStyle.addressMode = \"repeat\";\n    sourceStyle.update();\n  }\n  if (matrix) {\n    textureMatrix.append(tempTextureMatrix.copyFrom(matrix).invert());\n  }\n  return textureMatrix;\n}\n\nexport { generateTextureMatrix };\n//# sourceMappingURL=generateTextureFillMatrix.mjs.map\n","import { extensions, ExtensionType } from '../../../../extensions/Extensions.mjs';\nimport { Matrix } from '../../../../maths/matrix/Matrix.mjs';\nimport { Rectangle } from '../../../../maths/shapes/Rectangle.mjs';\nimport { buildUvs, buildSimpleUvs } from '../../../../rendering/renderers/shared/geometry/utils/buildUvs.mjs';\nimport { transformVertices } from '../../../../rendering/renderers/shared/geometry/utils/transformVertices.mjs';\nimport { Texture } from '../../../../rendering/renderers/shared/texture/Texture.mjs';\nimport { BigPool } from '../../../../utils/pool/PoolGroup.mjs';\nimport { BatchableGraphics } from '../BatchableGraphics.mjs';\nimport { buildCircle, buildEllipse, buildRoundedRectangle } from '../buildCommands/buildCircle.mjs';\nimport { buildLine } from '../buildCommands/buildLine.mjs';\nimport { buildPixelLine } from '../buildCommands/buildPixelLine.mjs';\nimport { buildPolygon } from '../buildCommands/buildPolygon.mjs';\nimport { buildRectangle } from '../buildCommands/buildRectangle.mjs';\nimport { buildTriangle } from '../buildCommands/buildTriangle.mjs';\nimport { generateTextureMatrix } from './generateTextureFillMatrix.mjs';\nimport { triangulateWithHoles } from './triangulateWithHoles.mjs';\n\n\"use strict\";\nconst shapeBuilders = {};\nextensions.handleByMap(ExtensionType.ShapeBuilder, shapeBuilders);\nextensions.add(buildRectangle, buildPolygon, buildTriangle, buildCircle, buildEllipse, buildRoundedRectangle);\nconst tempRect = new Rectangle();\nconst tempTextureMatrix = new Matrix();\nfunction buildContextBatches(context, gpuContext) {\n  const { geometryData, batches } = gpuContext;\n  batches.length = 0;\n  geometryData.indices.length = 0;\n  geometryData.vertices.length = 0;\n  geometryData.uvs.length = 0;\n  for (let i = 0; i < context.instructions.length; i++) {\n    const instruction = context.instructions[i];\n    if (instruction.action === \"texture\") {\n      addTextureToGeometryData(instruction.data, batches, geometryData);\n    } else if (instruction.action === \"fill\" || instruction.action === \"stroke\") {\n      const isStroke = instruction.action === \"stroke\";\n      const shapePath = instruction.data.path.shapePath;\n      const style = instruction.data.style;\n      const hole = instruction.data.hole;\n      if (isStroke && hole) {\n        addShapePathToGeometryData(hole.shapePath, style, true, batches, geometryData);\n      }\n      if (hole) {\n        shapePath.shapePrimitives[shapePath.shapePrimitives.length - 1].holes = hole.shapePath.shapePrimitives;\n      }\n      addShapePathToGeometryData(shapePath, style, isStroke, batches, geometryData);\n    }\n  }\n}\nfunction addTextureToGeometryData(data, batches, geometryData) {\n  const points = [];\n  const build = shapeBuilders.rectangle;\n  const rect = tempRect;\n  rect.x = data.dx;\n  rect.y = data.dy;\n  rect.width = data.dw;\n  rect.height = data.dh;\n  const matrix = data.transform;\n  if (!build.build(rect, points)) {\n    return;\n  }\n  const { vertices, uvs, indices } = geometryData;\n  const indexOffset = indices.length;\n  const vertOffset = vertices.length / 2;\n  if (matrix) {\n    transformVertices(points, matrix);\n  }\n  build.triangulate(points, vertices, 2, vertOffset, indices, indexOffset);\n  const texture = data.image;\n  const textureUvs = texture.uvs;\n  uvs.push(\n    textureUvs.x0,\n    textureUvs.y0,\n    textureUvs.x1,\n    textureUvs.y1,\n    textureUvs.x3,\n    textureUvs.y3,\n    textureUvs.x2,\n    textureUvs.y2\n  );\n  const graphicsBatch = BigPool.get(BatchableGraphics);\n  graphicsBatch.indexOffset = indexOffset;\n  graphicsBatch.indexSize = indices.length - indexOffset;\n  graphicsBatch.attributeOffset = vertOffset;\n  graphicsBatch.attributeSize = vertices.length / 2 - vertOffset;\n  graphicsBatch.baseColor = data.style;\n  graphicsBatch.alpha = data.alpha;\n  graphicsBatch.texture = texture;\n  graphicsBatch.geometryData = geometryData;\n  batches.push(graphicsBatch);\n}\nfunction addShapePathToGeometryData(shapePath, style, isStroke, batches, geometryData) {\n  const { vertices, uvs, indices } = geometryData;\n  shapePath.shapePrimitives.forEach(({ shape, transform: matrix, holes }) => {\n    const points = [];\n    const build = shapeBuilders[shape.type];\n    if (!build.build(shape, points)) {\n      return;\n    }\n    const indexOffset = indices.length;\n    const vertOffset = vertices.length / 2;\n    let topology = \"triangle-list\";\n    if (matrix) {\n      transformVertices(points, matrix);\n    }\n    if (!isStroke) {\n      if (holes) {\n        const holeIndices = [];\n        const otherPoints = points.slice();\n        const holeArrays = getHoleArrays(holes);\n        holeArrays.forEach((holePoints) => {\n          holeIndices.push(otherPoints.length / 2);\n          otherPoints.push(...holePoints);\n        });\n        triangulateWithHoles(otherPoints, holeIndices, vertices, 2, vertOffset, indices, indexOffset);\n      } else {\n        build.triangulate(points, vertices, 2, vertOffset, indices, indexOffset);\n      }\n    } else {\n      const close = shape.closePath ?? true;\n      const lineStyle = style;\n      if (!lineStyle.pixelLine) {\n        buildLine(points, lineStyle, false, close, vertices, indices);\n      } else {\n        buildPixelLine(points, close, vertices, indices);\n        topology = \"line-list\";\n      }\n    }\n    const uvsOffset = uvs.length / 2;\n    const texture = style.texture;\n    if (texture !== Texture.WHITE) {\n      const textureMatrix = generateTextureMatrix(tempTextureMatrix, style, shape, matrix);\n      buildUvs(vertices, 2, vertOffset, uvs, uvsOffset, 2, vertices.length / 2 - vertOffset, textureMatrix);\n    } else {\n      buildSimpleUvs(uvs, uvsOffset, 2, vertices.length / 2 - vertOffset);\n    }\n    const graphicsBatch = BigPool.get(BatchableGraphics);\n    graphicsBatch.indexOffset = indexOffset;\n    graphicsBatch.indexSize = indices.length - indexOffset;\n    graphicsBatch.attributeOffset = vertOffset;\n    graphicsBatch.attributeSize = vertices.length / 2 - vertOffset;\n    graphicsBatch.baseColor = style.color;\n    graphicsBatch.alpha = style.alpha;\n    graphicsBatch.texture = texture;\n    graphicsBatch.geometryData = geometryData;\n    graphicsBatch.topology = topology;\n    batches.push(graphicsBatch);\n  });\n}\nfunction getHoleArrays(holePrimitives) {\n  const holeArrays = [];\n  for (let k = 0; k < holePrimitives.length; k++) {\n    const holePrimitive = holePrimitives[k].shape;\n    const holePoints = [];\n    const holeBuilder = shapeBuilders[holePrimitive.type];\n    if (holeBuilder.build(holePrimitive, holePoints)) {\n      holeArrays.push(holePoints);\n    }\n  }\n  return holeArrays;\n}\n\nexport { buildContextBatches, shapeBuilders };\n//# sourceMappingURL=buildContextBatches.mjs.map\n","import { ExtensionType } from '../../../extensions/Extensions.mjs';\nimport { getTextureBatchBindGroup } from '../../../rendering/batcher/gpu/getTextureBatchBindGroup.mjs';\nimport { DefaultBatcher } from '../../../rendering/batcher/shared/DefaultBatcher.mjs';\nimport { InstructionSet } from '../../../rendering/renderers/shared/instructions/InstructionSet.mjs';\nimport { deprecation, v8_3_4 } from '../../../utils/logging/deprecation.mjs';\nimport { BigPool } from '../../../utils/pool/PoolGroup.mjs';\nimport { buildContextBatches } from './utils/buildContextBatches.mjs';\n\n\"use strict\";\nclass GpuGraphicsContext {\n  constructor() {\n    this.batches = [];\n    this.geometryData = {\n      vertices: [],\n      uvs: [],\n      indices: []\n    };\n  }\n}\nclass GraphicsContextRenderData {\n  constructor() {\n    this.instructions = new InstructionSet();\n  }\n  init(maxTextures) {\n    this.batcher = new DefaultBatcher({\n      maxTextures\n    });\n    this.instructions.reset();\n  }\n  /**\n   * @deprecated since version 8.0.0\n   * Use `batcher.geometry` instead.\n   * @see {Batcher#geometry}\n   */\n  get geometry() {\n    deprecation(v8_3_4, \"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead.\");\n    return this.batcher.geometry;\n  }\n  destroy() {\n    this.batcher.destroy();\n    this.instructions.destroy();\n    this.batcher = null;\n    this.instructions = null;\n  }\n}\nconst _GraphicsContextSystem = class _GraphicsContextSystem {\n  constructor(renderer) {\n    // the root context batches, used to either make a batch or geometry\n    // all graphics use this as a base\n    this._gpuContextHash = {};\n    // used for non-batchable graphics\n    this._graphicsDataContextHash = /* @__PURE__ */ Object.create(null);\n    this._renderer = renderer;\n    renderer.renderableGC.addManagedHash(this, \"_gpuContextHash\");\n    renderer.renderableGC.addManagedHash(this, \"_graphicsDataContextHash\");\n  }\n  /**\n   * Runner init called, update the default options\n   * @ignore\n   */\n  init(options) {\n    _GraphicsContextSystem.defaultOptions.bezierSmoothness = options?.bezierSmoothness ?? _GraphicsContextSystem.defaultOptions.bezierSmoothness;\n  }\n  /**\n   * Returns the render data for a given GraphicsContext.\n   * @param context - The GraphicsContext to get the render data for.\n   * @internal\n   */\n  getContextRenderData(context) {\n    return this._graphicsDataContextHash[context.uid] || this._initContextRenderData(context);\n  }\n  /**\n   * Updates the GPU context for a given GraphicsContext.\n   * If the context is dirty, it will rebuild the batches and geometry data.\n   * @param context - The GraphicsContext to update.\n   * @returns The updated GpuGraphicsContext.\n   * @internal\n   */\n  updateGpuContext(context) {\n    let gpuContext = this._gpuContextHash[context.uid] || this._initContext(context);\n    if (context.dirty) {\n      if (gpuContext) {\n        this._cleanGraphicsContextData(context);\n      } else {\n        gpuContext = this._initContext(context);\n      }\n      buildContextBatches(context, gpuContext);\n      const batchMode = context.batchMode;\n      if (context.customShader || batchMode === \"no-batch\") {\n        gpuContext.isBatchable = false;\n      } else if (batchMode === \"auto\") {\n        gpuContext.isBatchable = gpuContext.geometryData.vertices.length < 400;\n      } else {\n        gpuContext.isBatchable = true;\n      }\n      context.dirty = false;\n    }\n    return gpuContext;\n  }\n  /**\n   * Returns the GpuGraphicsContext for a given GraphicsContext.\n   * If it does not exist, it will initialize a new one.\n   * @param context - The GraphicsContext to get the GpuGraphicsContext for.\n   * @returns The GpuGraphicsContext for the given GraphicsContext.\n   * @internal\n   */\n  getGpuContext(context) {\n    return this._gpuContextHash[context.uid] || this._initContext(context);\n  }\n  _initContextRenderData(context) {\n    const graphicsData = BigPool.get(GraphicsContextRenderData, {\n      maxTextures: this._renderer.limits.maxBatchableTextures\n    });\n    const { batches, geometryData } = this._gpuContextHash[context.uid];\n    const vertexSize = geometryData.vertices.length;\n    const indexSize = geometryData.indices.length;\n    for (let i = 0; i < batches.length; i++) {\n      batches[i].applyTransform = false;\n    }\n    const batcher = graphicsData.batcher;\n    batcher.ensureAttributeBuffer(vertexSize);\n    batcher.ensureIndexBuffer(indexSize);\n    batcher.begin();\n    for (let i = 0; i < batches.length; i++) {\n      const batch = batches[i];\n      batcher.add(batch);\n    }\n    batcher.finish(graphicsData.instructions);\n    const geometry = batcher.geometry;\n    geometry.indexBuffer.setDataWithSize(batcher.indexBuffer, batcher.indexSize, true);\n    geometry.buffers[0].setDataWithSize(batcher.attributeBuffer.float32View, batcher.attributeSize, true);\n    const drawBatches = batcher.batches;\n    for (let i = 0; i < drawBatches.length; i++) {\n      const batch = drawBatches[i];\n      batch.bindGroup = getTextureBatchBindGroup(\n        batch.textures.textures,\n        batch.textures.count,\n        this._renderer.limits.maxBatchableTextures\n      );\n    }\n    this._graphicsDataContextHash[context.uid] = graphicsData;\n    return graphicsData;\n  }\n  _initContext(context) {\n    const gpuContext = new GpuGraphicsContext();\n    gpuContext.context = context;\n    this._gpuContextHash[context.uid] = gpuContext;\n    context.on(\"destroy\", this.onGraphicsContextDestroy, this);\n    return this._gpuContextHash[context.uid];\n  }\n  onGraphicsContextDestroy(context) {\n    this._cleanGraphicsContextData(context);\n    context.off(\"destroy\", this.onGraphicsContextDestroy, this);\n    this._gpuContextHash[context.uid] = null;\n  }\n  _cleanGraphicsContextData(context) {\n    const gpuContext = this._gpuContextHash[context.uid];\n    if (!gpuContext.isBatchable) {\n      if (this._graphicsDataContextHash[context.uid]) {\n        BigPool.return(this.getContextRenderData(context));\n        this._graphicsDataContextHash[context.uid] = null;\n      }\n    }\n    if (gpuContext.batches) {\n      gpuContext.batches.forEach((batch) => {\n        BigPool.return(batch);\n      });\n    }\n  }\n  destroy() {\n    for (const i in this._gpuContextHash) {\n      if (this._gpuContextHash[i]) {\n        this.onGraphicsContextDestroy(this._gpuContextHash[i].context);\n      }\n    }\n  }\n};\n/** @ignore */\n_GraphicsContextSystem.extension = {\n  type: [\n    ExtensionType.WebGLSystem,\n    ExtensionType.WebGPUSystem,\n    ExtensionType.CanvasSystem\n  ],\n  name: \"graphicsContext\"\n};\n/** The default options for the GraphicsContextSystem. */\n_GraphicsContextSystem.defaultOptions = {\n  /**\n   * A value from 0 to 1 that controls the smoothness of bezier curves (the higher the smoother)\n   * @default 0.5\n   */\n  bezierSmoothness: 0.5\n};\nlet GraphicsContextSystem = _GraphicsContextSystem;\n\nexport { GpuGraphicsContext, GraphicsContextRenderData, GraphicsContextSystem };\n//# sourceMappingURL=GraphicsContextSystem.mjs.map\n","import { GraphicsContextSystem } from '../GraphicsContextSystem.mjs';\n\n\"use strict\";\nconst RECURSION_LIMIT = 8;\nconst FLT_EPSILON = 11920929e-14;\nconst PATH_DISTANCE_EPSILON = 1;\nconst curveAngleToleranceEpsilon = 0.01;\nconst mAngleTolerance = 0;\nconst mCuspLimit = 0;\nfunction buildAdaptiveBezier(points, sX, sY, cp1x, cp1y, cp2x, cp2y, eX, eY, smoothness) {\n  const scale = 1;\n  const smoothing = Math.min(\n    0.99,\n    // a value of 1.0 actually inverts smoothing, so we cap it at 0.99\n    Math.max(0, smoothness ?? GraphicsContextSystem.defaultOptions.bezierSmoothness)\n  );\n  let distanceTolerance = (PATH_DISTANCE_EPSILON - smoothing) / scale;\n  distanceTolerance *= distanceTolerance;\n  begin(sX, sY, cp1x, cp1y, cp2x, cp2y, eX, eY, points, distanceTolerance);\n  return points;\n}\nfunction begin(sX, sY, cp1x, cp1y, cp2x, cp2y, eX, eY, points, distanceTolerance) {\n  recursive(sX, sY, cp1x, cp1y, cp2x, cp2y, eX, eY, points, distanceTolerance, 0);\n  points.push(eX, eY);\n}\nfunction recursive(x1, y1, x2, y2, x3, y3, x4, y4, points, distanceTolerance, level) {\n  if (level > RECURSION_LIMIT) {\n    return;\n  }\n  const pi = Math.PI;\n  const x12 = (x1 + x2) / 2;\n  const y12 = (y1 + y2) / 2;\n  const x23 = (x2 + x3) / 2;\n  const y23 = (y2 + y3) / 2;\n  const x34 = (x3 + x4) / 2;\n  const y34 = (y3 + y4) / 2;\n  const x123 = (x12 + x23) / 2;\n  const y123 = (y12 + y23) / 2;\n  const x234 = (x23 + x34) / 2;\n  const y234 = (y23 + y34) / 2;\n  const x1234 = (x123 + x234) / 2;\n  const y1234 = (y123 + y234) / 2;\n  if (level > 0) {\n    let dx = x4 - x1;\n    let dy = y4 - y1;\n    const d2 = Math.abs((x2 - x4) * dy - (y2 - y4) * dx);\n    const d3 = Math.abs((x3 - x4) * dy - (y3 - y4) * dx);\n    let da1;\n    let da2;\n    if (d2 > FLT_EPSILON && d3 > FLT_EPSILON) {\n      if ((d2 + d3) * (d2 + d3) <= distanceTolerance * (dx * dx + dy * dy)) {\n        if (mAngleTolerance < curveAngleToleranceEpsilon) {\n          points.push(x1234, y1234);\n          return;\n        }\n        const a23 = Math.atan2(y3 - y2, x3 - x2);\n        da1 = Math.abs(a23 - Math.atan2(y2 - y1, x2 - x1));\n        da2 = Math.abs(Math.atan2(y4 - y3, x4 - x3) - a23);\n        if (da1 >= pi)\n          da1 = 2 * pi - da1;\n        if (da2 >= pi)\n          da2 = 2 * pi - da2;\n        if (da1 + da2 < mAngleTolerance) {\n          points.push(x1234, y1234);\n          return;\n        }\n        if (mCuspLimit !== 0) {\n          if (da1 > mCuspLimit) {\n            points.push(x2, y2);\n            return;\n          }\n          if (da2 > mCuspLimit) {\n            points.push(x3, y3);\n            return;\n          }\n        }\n      }\n    } else if (d2 > FLT_EPSILON) {\n      if (d2 * d2 <= distanceTolerance * (dx * dx + dy * dy)) {\n        if (mAngleTolerance < curveAngleToleranceEpsilon) {\n          points.push(x1234, y1234);\n          return;\n        }\n        da1 = Math.abs(Math.atan2(y3 - y2, x3 - x2) - Math.atan2(y2 - y1, x2 - x1));\n        if (da1 >= pi)\n          da1 = 2 * pi - da1;\n        if (da1 < mAngleTolerance) {\n          points.push(x2, y2);\n          points.push(x3, y3);\n          return;\n        }\n        if (mCuspLimit !== 0) {\n          if (da1 > mCuspLimit) {\n            points.push(x2, y2);\n            return;\n          }\n        }\n      }\n    } else if (d3 > FLT_EPSILON) {\n      if (d3 * d3 <= distanceTolerance * (dx * dx + dy * dy)) {\n        if (mAngleTolerance < curveAngleToleranceEpsilon) {\n          points.push(x1234, y1234);\n          return;\n        }\n        da1 = Math.abs(Math.atan2(y4 - y3, x4 - x3) - Math.atan2(y3 - y2, x3 - x2));\n        if (da1 >= pi)\n          da1 = 2 * pi - da1;\n        if (da1 < mAngleTolerance) {\n          points.push(x2, y2);\n          points.push(x3, y3);\n          return;\n        }\n        if (mCuspLimit !== 0) {\n          if (da1 > mCuspLimit) {\n            points.push(x3, y3);\n            return;\n          }\n        }\n      }\n    } else {\n      dx = x1234 - (x1 + x4) / 2;\n      dy = y1234 - (y1 + y4) / 2;\n      if (dx * dx + dy * dy <= distanceTolerance) {\n        points.push(x1234, y1234);\n        return;\n      }\n    }\n  }\n  recursive(x1, y1, x12, y12, x123, y123, x1234, y1234, points, distanceTolerance, level + 1);\n  recursive(x1234, y1234, x234, y234, x34, y34, x4, y4, points, distanceTolerance, level + 1);\n}\n\nexport { buildAdaptiveBezier };\n//# sourceMappingURL=buildAdaptiveBezier.mjs.map\n","import { GraphicsContextSystem } from '../GraphicsContextSystem.mjs';\n\n\"use strict\";\nconst RECURSION_LIMIT = 8;\nconst FLT_EPSILON = 11920929e-14;\nconst PATH_DISTANCE_EPSILON = 1;\nconst curveAngleToleranceEpsilon = 0.01;\nconst mAngleTolerance = 0;\nfunction buildAdaptiveQuadratic(points, sX, sY, cp1x, cp1y, eX, eY, smoothness) {\n  const scale = 1;\n  const smoothing = Math.min(\n    0.99,\n    // a value of 1.0 actually inverts smoothing, so we cap it at 0.99\n    Math.max(0, smoothness ?? GraphicsContextSystem.defaultOptions.bezierSmoothness)\n  );\n  let distanceTolerance = (PATH_DISTANCE_EPSILON - smoothing) / scale;\n  distanceTolerance *= distanceTolerance;\n  begin(sX, sY, cp1x, cp1y, eX, eY, points, distanceTolerance);\n  return points;\n}\nfunction begin(sX, sY, cp1x, cp1y, eX, eY, points, distanceTolerance) {\n  recursive(points, sX, sY, cp1x, cp1y, eX, eY, distanceTolerance, 0);\n  points.push(eX, eY);\n}\nfunction recursive(points, x1, y1, x2, y2, x3, y3, distanceTolerance, level) {\n  if (level > RECURSION_LIMIT) {\n    return;\n  }\n  const pi = Math.PI;\n  const x12 = (x1 + x2) / 2;\n  const y12 = (y1 + y2) / 2;\n  const x23 = (x2 + x3) / 2;\n  const y23 = (y2 + y3) / 2;\n  const x123 = (x12 + x23) / 2;\n  const y123 = (y12 + y23) / 2;\n  let dx = x3 - x1;\n  let dy = y3 - y1;\n  const d = Math.abs((x2 - x3) * dy - (y2 - y3) * dx);\n  if (d > FLT_EPSILON) {\n    if (d * d <= distanceTolerance * (dx * dx + dy * dy)) {\n      if (mAngleTolerance < curveAngleToleranceEpsilon) {\n        points.push(x123, y123);\n        return;\n      }\n      let da = Math.abs(Math.atan2(y3 - y2, x3 - x2) - Math.atan2(y2 - y1, x2 - x1));\n      if (da >= pi)\n        da = 2 * pi - da;\n      if (da < mAngleTolerance) {\n        points.push(x123, y123);\n        return;\n      }\n    }\n  } else {\n    dx = x123 - (x1 + x3) / 2;\n    dy = y123 - (y1 + y3) / 2;\n    if (dx * dx + dy * dy <= distanceTolerance) {\n      points.push(x123, y123);\n      return;\n    }\n  }\n  recursive(points, x1, y1, x12, y12, x123, y123, distanceTolerance, level + 1);\n  recursive(points, x123, y123, x23, y23, x3, y3, distanceTolerance, level + 1);\n}\n\nexport { buildAdaptiveQuadratic };\n//# sourceMappingURL=buildAdaptiveQuadratic.mjs.map\n","\"use strict\";\nfunction buildArc(points, x, y, radius, start, end, clockwise, steps) {\n  let dist = Math.abs(start - end);\n  if (!clockwise && start > end) {\n    dist = 2 * Math.PI - dist;\n  } else if (clockwise && end > start) {\n    dist = 2 * Math.PI - dist;\n  }\n  steps || (steps = Math.max(6, Math.floor(6 * Math.pow(radius, 1 / 3) * (dist / Math.PI))));\n  steps = Math.max(steps, 3);\n  let f = dist / steps;\n  let t = start;\n  f *= clockwise ? -1 : 1;\n  for (let i = 0; i < steps + 1; i++) {\n    const cs = Math.cos(t);\n    const sn = Math.sin(t);\n    const nx = x + cs * radius;\n    const ny = y + sn * radius;\n    points.push(nx, ny);\n    t += f;\n  }\n}\n\nexport { buildArc };\n//# sourceMappingURL=buildArc.mjs.map\n","import { buildArc } from './buildArc.mjs';\n\n\"use strict\";\nfunction buildArcTo(points, x1, y1, x2, y2, radius) {\n  const fromX = points[points.length - 2];\n  const fromY = points[points.length - 1];\n  const a1 = fromY - y1;\n  const b1 = fromX - x1;\n  const a2 = y2 - y1;\n  const b2 = x2 - x1;\n  const mm = Math.abs(a1 * b2 - b1 * a2);\n  if (mm < 1e-8 || radius === 0) {\n    if (points[points.length - 2] !== x1 || points[points.length - 1] !== y1) {\n      points.push(x1, y1);\n    }\n    return;\n  }\n  const dd = a1 * a1 + b1 * b1;\n  const cc = a2 * a2 + b2 * b2;\n  const tt = a1 * a2 + b1 * b2;\n  const k1 = radius * Math.sqrt(dd) / mm;\n  const k2 = radius * Math.sqrt(cc) / mm;\n  const j1 = k1 * tt / dd;\n  const j2 = k2 * tt / cc;\n  const cx = k1 * b2 + k2 * b1;\n  const cy = k1 * a2 + k2 * a1;\n  const px = b1 * (k2 + j1);\n  const py = a1 * (k2 + j1);\n  const qx = b2 * (k1 + j2);\n  const qy = a2 * (k1 + j2);\n  const startAngle = Math.atan2(py - cy, px - cx);\n  const endAngle = Math.atan2(qy - cy, qx - cx);\n  buildArc(\n    points,\n    cx + x1,\n    cy + y1,\n    radius,\n    startAngle,\n    endAngle,\n    b1 * a2 > b2 * a1\n  );\n}\n\nexport { buildArcTo };\n//# sourceMappingURL=buildArcTo.mjs.map\n","import { buildAdaptiveBezier } from './buildAdaptiveBezier.mjs';\n\n\"use strict\";\nconst TAU = Math.PI * 2;\nconst out = {\n  centerX: 0,\n  centerY: 0,\n  ang1: 0,\n  ang2: 0\n};\nconst mapToEllipse = ({ x, y }, rx, ry, cosPhi, sinPhi, centerX, centerY, out2) => {\n  x *= rx;\n  y *= ry;\n  const xp = cosPhi * x - sinPhi * y;\n  const yp = sinPhi * x + cosPhi * y;\n  out2.x = xp + centerX;\n  out2.y = yp + centerY;\n  return out2;\n};\nfunction approxUnitArc(ang1, ang2) {\n  const a1 = ang2 === -1.5707963267948966 ? -0.551915024494 : 4 / 3 * Math.tan(ang2 / 4);\n  const a = ang2 === 1.5707963267948966 ? 0.551915024494 : a1;\n  const x1 = Math.cos(ang1);\n  const y1 = Math.sin(ang1);\n  const x2 = Math.cos(ang1 + ang2);\n  const y2 = Math.sin(ang1 + ang2);\n  return [\n    {\n      x: x1 - y1 * a,\n      y: y1 + x1 * a\n    },\n    {\n      x: x2 + y2 * a,\n      y: y2 - x2 * a\n    },\n    {\n      x: x2,\n      y: y2\n    }\n  ];\n}\nconst vectorAngle = (ux, uy, vx, vy) => {\n  const sign = ux * vy - uy * vx < 0 ? -1 : 1;\n  let dot = ux * vx + uy * vy;\n  if (dot > 1) {\n    dot = 1;\n  }\n  if (dot < -1) {\n    dot = -1;\n  }\n  return sign * Math.acos(dot);\n};\nconst getArcCenter = (px, py, cx, cy, rx, ry, largeArcFlag, sweepFlag, sinPhi, cosPhi, pxp, pyp, out2) => {\n  const rxSq = Math.pow(rx, 2);\n  const rySq = Math.pow(ry, 2);\n  const pxpSq = Math.pow(pxp, 2);\n  const pypSq = Math.pow(pyp, 2);\n  let radicant = rxSq * rySq - rxSq * pypSq - rySq * pxpSq;\n  if (radicant < 0) {\n    radicant = 0;\n  }\n  radicant /= rxSq * pypSq + rySq * pxpSq;\n  radicant = Math.sqrt(radicant) * (largeArcFlag === sweepFlag ? -1 : 1);\n  const centerXp = radicant * rx / ry * pyp;\n  const centerYp = radicant * -ry / rx * pxp;\n  const centerX = cosPhi * centerXp - sinPhi * centerYp + (px + cx) / 2;\n  const centerY = sinPhi * centerXp + cosPhi * centerYp + (py + cy) / 2;\n  const vx1 = (pxp - centerXp) / rx;\n  const vy1 = (pyp - centerYp) / ry;\n  const vx2 = (-pxp - centerXp) / rx;\n  const vy2 = (-pyp - centerYp) / ry;\n  const ang1 = vectorAngle(1, 0, vx1, vy1);\n  let ang2 = vectorAngle(vx1, vy1, vx2, vy2);\n  if (sweepFlag === 0 && ang2 > 0) {\n    ang2 -= TAU;\n  }\n  if (sweepFlag === 1 && ang2 < 0) {\n    ang2 += TAU;\n  }\n  out2.centerX = centerX;\n  out2.centerY = centerY;\n  out2.ang1 = ang1;\n  out2.ang2 = ang2;\n};\nfunction buildArcToSvg(points, px, py, cx, cy, rx, ry, xAxisRotation = 0, largeArcFlag = 0, sweepFlag = 0) {\n  if (rx === 0 || ry === 0) {\n    return;\n  }\n  const sinPhi = Math.sin(xAxisRotation * TAU / 360);\n  const cosPhi = Math.cos(xAxisRotation * TAU / 360);\n  const pxp = cosPhi * (px - cx) / 2 + sinPhi * (py - cy) / 2;\n  const pyp = -sinPhi * (px - cx) / 2 + cosPhi * (py - cy) / 2;\n  if (pxp === 0 && pyp === 0) {\n    return;\n  }\n  rx = Math.abs(rx);\n  ry = Math.abs(ry);\n  const lambda = Math.pow(pxp, 2) / Math.pow(rx, 2) + Math.pow(pyp, 2) / Math.pow(ry, 2);\n  if (lambda > 1) {\n    rx *= Math.sqrt(lambda);\n    ry *= Math.sqrt(lambda);\n  }\n  getArcCenter(\n    px,\n    py,\n    cx,\n    cy,\n    rx,\n    ry,\n    largeArcFlag,\n    sweepFlag,\n    sinPhi,\n    cosPhi,\n    pxp,\n    pyp,\n    out\n  );\n  let { ang1, ang2 } = out;\n  const { centerX, centerY } = out;\n  let ratio = Math.abs(ang2) / (TAU / 4);\n  if (Math.abs(1 - ratio) < 1e-7) {\n    ratio = 1;\n  }\n  const segments = Math.max(Math.ceil(ratio), 1);\n  ang2 /= segments;\n  let lastX = points[points.length - 2];\n  let lastY = points[points.length - 1];\n  const outCurvePoint = { x: 0, y: 0 };\n  for (let i = 0; i < segments; i++) {\n    const curve = approxUnitArc(ang1, ang2);\n    const { x: x1, y: y1 } = mapToEllipse(curve[0], rx, ry, cosPhi, sinPhi, centerX, centerY, outCurvePoint);\n    const { x: x2, y: y2 } = mapToEllipse(curve[1], rx, ry, cosPhi, sinPhi, centerX, centerY, outCurvePoint);\n    const { x, y } = mapToEllipse(curve[2], rx, ry, cosPhi, sinPhi, centerX, centerY, outCurvePoint);\n    buildAdaptiveBezier(\n      points,\n      lastX,\n      lastY,\n      x1,\n      y1,\n      x2,\n      y2,\n      x,\n      y\n    );\n    lastX = x;\n    lastY = y;\n    ang1 += ang2;\n  }\n}\n\nexport { buildArcToSvg };\n//# sourceMappingURL=buildArcToSvg.mjs.map\n","\"use strict\";\nfunction roundedShapeArc(g, points, radius) {\n  const vecFrom = (p, pp) => {\n    const x = pp.x - p.x;\n    const y = pp.y - p.y;\n    const len = Math.sqrt(x * x + y * y);\n    const nx = x / len;\n    const ny = y / len;\n    return { len, nx, ny };\n  };\n  const sharpCorner = (i, p) => {\n    if (i === 0) {\n      g.moveTo(p.x, p.y);\n    } else {\n      g.lineTo(p.x, p.y);\n    }\n  };\n  let p1 = points[points.length - 1];\n  for (let i = 0; i < points.length; i++) {\n    const p2 = points[i % points.length];\n    const pRadius = p2.radius ?? radius;\n    if (pRadius <= 0) {\n      sharpCorner(i, p2);\n      p1 = p2;\n      continue;\n    }\n    const p3 = points[(i + 1) % points.length];\n    const v1 = vecFrom(p2, p1);\n    const v2 = vecFrom(p2, p3);\n    if (v1.len < 1e-4 || v2.len < 1e-4) {\n      sharpCorner(i, p2);\n      p1 = p2;\n      continue;\n    }\n    let angle = Math.asin(v1.nx * v2.ny - v1.ny * v2.nx);\n    let radDirection = 1;\n    let drawDirection = false;\n    if (v1.nx * v2.nx - v1.ny * -v2.ny < 0) {\n      if (angle < 0) {\n        angle = Math.PI + angle;\n      } else {\n        angle = Math.PI - angle;\n        radDirection = -1;\n        drawDirection = true;\n      }\n    } else if (angle > 0) {\n      radDirection = -1;\n      drawDirection = true;\n    }\n    const halfAngle = angle / 2;\n    let cRadius;\n    let lenOut = Math.abs(\n      Math.cos(halfAngle) * pRadius / Math.sin(halfAngle)\n    );\n    if (lenOut > Math.min(v1.len / 2, v2.len / 2)) {\n      lenOut = Math.min(v1.len / 2, v2.len / 2);\n      cRadius = Math.abs(lenOut * Math.sin(halfAngle) / Math.cos(halfAngle));\n    } else {\n      cRadius = pRadius;\n    }\n    const cX = p2.x + v2.nx * lenOut + -v2.ny * cRadius * radDirection;\n    const cY = p2.y + v2.ny * lenOut + v2.nx * cRadius * radDirection;\n    const startAngle = Math.atan2(v1.ny, v1.nx) + Math.PI / 2 * radDirection;\n    const endAngle = Math.atan2(v2.ny, v2.nx) - Math.PI / 2 * radDirection;\n    if (i === 0) {\n      g.moveTo(\n        cX + Math.cos(startAngle) * cRadius,\n        cY + Math.sin(startAngle) * cRadius\n      );\n    }\n    g.arc(cX, cY, cRadius, startAngle, endAngle, drawDirection);\n    p1 = p2;\n  }\n}\nfunction roundedShapeQuadraticCurve(g, points, radius, smoothness) {\n  const distance = (p1, p2) => Math.sqrt((p1.x - p2.x) ** 2 + (p1.y - p2.y) ** 2);\n  const pointLerp = (p1, p2, t) => ({\n    x: p1.x + (p2.x - p1.x) * t,\n    y: p1.y + (p2.y - p1.y) * t\n  });\n  const numPoints = points.length;\n  for (let i = 0; i < numPoints; i++) {\n    const thisPoint = points[(i + 1) % numPoints];\n    const pRadius = thisPoint.radius ?? radius;\n    if (pRadius <= 0) {\n      if (i === 0) {\n        g.moveTo(thisPoint.x, thisPoint.y);\n      } else {\n        g.lineTo(thisPoint.x, thisPoint.y);\n      }\n      continue;\n    }\n    const lastPoint = points[i];\n    const nextPoint = points[(i + 2) % numPoints];\n    const lastEdgeLength = distance(lastPoint, thisPoint);\n    let start;\n    if (lastEdgeLength < 1e-4) {\n      start = thisPoint;\n    } else {\n      const lastOffsetDistance = Math.min(lastEdgeLength / 2, pRadius);\n      start = pointLerp(\n        thisPoint,\n        lastPoint,\n        lastOffsetDistance / lastEdgeLength\n      );\n    }\n    const nextEdgeLength = distance(nextPoint, thisPoint);\n    let end;\n    if (nextEdgeLength < 1e-4) {\n      end = thisPoint;\n    } else {\n      const nextOffsetDistance = Math.min(nextEdgeLength / 2, pRadius);\n      end = pointLerp(\n        thisPoint,\n        nextPoint,\n        nextOffsetDistance / nextEdgeLength\n      );\n    }\n    if (i === 0) {\n      g.moveTo(start.x, start.y);\n    } else {\n      g.lineTo(start.x, start.y);\n    }\n    g.quadraticCurveTo(thisPoint.x, thisPoint.y, end.x, end.y, smoothness);\n  }\n}\n\nexport { roundedShapeArc, roundedShapeQuadraticCurve };\n//# sourceMappingURL=roundShape.mjs.map\n","import { Circle } from '../../../../maths/shapes/Circle.mjs';\nimport { Ellipse } from '../../../../maths/shapes/Ellipse.mjs';\nimport { Polygon } from '../../../../maths/shapes/Polygon.mjs';\nimport { Rectangle } from '../../../../maths/shapes/Rectangle.mjs';\nimport { RoundedRectangle } from '../../../../maths/shapes/RoundedRectangle.mjs';\nimport { Bounds } from '../../../container/bounds/Bounds.mjs';\nimport { buildAdaptiveBezier } from '../buildCommands/buildAdaptiveBezier.mjs';\nimport { buildAdaptiveQuadratic } from '../buildCommands/buildAdaptiveQuadratic.mjs';\nimport { buildArc } from '../buildCommands/buildArc.mjs';\nimport { buildArcTo } from '../buildCommands/buildArcTo.mjs';\nimport { buildArcToSvg } from '../buildCommands/buildArcToSvg.mjs';\nimport { roundedShapeQuadraticCurve, roundedShapeArc } from './roundShape.mjs';\n\n\"use strict\";\nconst tempRectangle = new Rectangle();\nclass ShapePath {\n  constructor(graphicsPath2D) {\n    /** The list of shape primitives that make up the path. */\n    this.shapePrimitives = [];\n    this._currentPoly = null;\n    this._bounds = new Bounds();\n    this._graphicsPath2D = graphicsPath2D;\n    this.signed = graphicsPath2D.checkForHoles;\n  }\n  /**\n   * Sets the starting point for a new sub-path. Any subsequent drawing commands are considered part of this path.\n   * @param x - The x-coordinate for the starting point.\n   * @param y - The y-coordinate for the starting point.\n   * @returns The instance of the current object for chaining.\n   */\n  moveTo(x, y) {\n    this.startPoly(x, y);\n    return this;\n  }\n  /**\n   * Connects the current point to a new point with a straight line. This method updates the current path.\n   * @param x - The x-coordinate of the new point to connect to.\n   * @param y - The y-coordinate of the new point to connect to.\n   * @returns The instance of the current object for chaining.\n   */\n  lineTo(x, y) {\n    this._ensurePoly();\n    const points = this._currentPoly.points;\n    const fromX = points[points.length - 2];\n    const fromY = points[points.length - 1];\n    if (fromX !== x || fromY !== y) {\n      points.push(x, y);\n    }\n    return this;\n  }\n  /**\n   * Adds an arc to the path. The arc is centered at (x, y)\n   *  position with radius `radius` starting at `startAngle` and ending at `endAngle`.\n   * @param x - The x-coordinate of the arc's center.\n   * @param y - The y-coordinate of the arc's center.\n   * @param radius - The radius of the arc.\n   * @param startAngle - The starting angle of the arc, in radians.\n   * @param endAngle - The ending angle of the arc, in radians.\n   * @param counterclockwise - Specifies whether the arc should be drawn in the anticlockwise direction. False by default.\n   * @returns The instance of the current object for chaining.\n   */\n  arc(x, y, radius, startAngle, endAngle, counterclockwise) {\n    this._ensurePoly(false);\n    const points = this._currentPoly.points;\n    buildArc(points, x, y, radius, startAngle, endAngle, counterclockwise);\n    return this;\n  }\n  /**\n   * Adds an arc to the path with the arc tangent to the line joining two specified points.\n   * The arc radius is specified by `radius`.\n   * @param x1 - The x-coordinate of the first point.\n   * @param y1 - The y-coordinate of the first point.\n   * @param x2 - The x-coordinate of the second point.\n   * @param y2 - The y-coordinate of the second point.\n   * @param radius - The radius of the arc.\n   * @returns The instance of the current object for chaining.\n   */\n  arcTo(x1, y1, x2, y2, radius) {\n    this._ensurePoly();\n    const points = this._currentPoly.points;\n    buildArcTo(points, x1, y1, x2, y2, radius);\n    return this;\n  }\n  /**\n   * Adds an SVG-style arc to the path, allowing for elliptical arcs based on the SVG spec.\n   * @param rx - The x-radius of the ellipse.\n   * @param ry - The y-radius of the ellipse.\n   * @param xAxisRotation - The rotation of the ellipse's x-axis relative\n   * to the x-axis of the coordinate system, in degrees.\n   * @param largeArcFlag - Determines if the arc should be greater than or less than 180 degrees.\n   * @param sweepFlag - Determines if the arc should be swept in a positive angle direction.\n   * @param x - The x-coordinate of the arc's end point.\n   * @param y - The y-coordinate of the arc's end point.\n   * @returns The instance of the current object for chaining.\n   */\n  arcToSvg(rx, ry, xAxisRotation, largeArcFlag, sweepFlag, x, y) {\n    const points = this._currentPoly.points;\n    buildArcToSvg(\n      points,\n      this._currentPoly.lastX,\n      this._currentPoly.lastY,\n      x,\n      y,\n      rx,\n      ry,\n      xAxisRotation,\n      largeArcFlag,\n      sweepFlag\n    );\n    return this;\n  }\n  /**\n   * Adds a cubic Bezier curve to the path.\n   * It requires three points: the first two are control points and the third one is the end point.\n   * The starting point is the last point in the current path.\n   * @param cp1x - The x-coordinate of the first control point.\n   * @param cp1y - The y-coordinate of the first control point.\n   * @param cp2x - The x-coordinate of the second control point.\n   * @param cp2y - The y-coordinate of the second control point.\n   * @param x - The x-coordinate of the end point.\n   * @param y - The y-coordinate of the end point.\n   * @param smoothness - Optional parameter to adjust the smoothness of the curve.\n   * @returns The instance of the current object for chaining.\n   */\n  bezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y, smoothness) {\n    this._ensurePoly();\n    const currentPoly = this._currentPoly;\n    buildAdaptiveBezier(\n      this._currentPoly.points,\n      currentPoly.lastX,\n      currentPoly.lastY,\n      cp1x,\n      cp1y,\n      cp2x,\n      cp2y,\n      x,\n      y,\n      smoothness\n    );\n    return this;\n  }\n  /**\n   * Adds a quadratic curve to the path. It requires two points: the control point and the end point.\n   * The starting point is the last point in the current path.\n   * @param cp1x - The x-coordinate of the control point.\n   * @param cp1y - The y-coordinate of the control point.\n   * @param x - The x-coordinate of the end point.\n   * @param y - The y-coordinate of the end point.\n   * @param smoothing - Optional parameter to adjust the smoothness of the curve.\n   * @returns The instance of the current object for chaining.\n   */\n  quadraticCurveTo(cp1x, cp1y, x, y, smoothing) {\n    this._ensurePoly();\n    const currentPoly = this._currentPoly;\n    buildAdaptiveQuadratic(\n      this._currentPoly.points,\n      currentPoly.lastX,\n      currentPoly.lastY,\n      cp1x,\n      cp1y,\n      x,\n      y,\n      smoothing\n    );\n    return this;\n  }\n  /**\n   * Closes the current path by drawing a straight line back to the start.\n   * If the shape is already closed or there are no points in the path, this method does nothing.\n   * @returns The instance of the current object for chaining.\n   */\n  closePath() {\n    this.endPoly(true);\n    return this;\n  }\n  /**\n   * Adds another path to the current path. This method allows for the combination of multiple paths into one.\n   * @param path - The `GraphicsPath` object representing the path to add.\n   * @param transform - An optional `Matrix` object to apply a transformation to the path before adding it.\n   * @returns The instance of the current object for chaining.\n   */\n  addPath(path, transform) {\n    this.endPoly();\n    if (transform && !transform.isIdentity()) {\n      path = path.clone(true);\n      path.transform(transform);\n    }\n    const shapePrimitives = this.shapePrimitives;\n    const start = shapePrimitives.length;\n    for (let i = 0; i < path.instructions.length; i++) {\n      const instruction = path.instructions[i];\n      this[instruction.action](...instruction.data);\n    }\n    if (path.checkForHoles && shapePrimitives.length - start > 1) {\n      let mainShape = null;\n      for (let i = start; i < shapePrimitives.length; i++) {\n        const shapePrimitive = shapePrimitives[i];\n        if (shapePrimitive.shape.type === \"polygon\") {\n          const polygon = shapePrimitive.shape;\n          const mainPolygon = mainShape?.shape;\n          if (mainPolygon && mainPolygon.containsPolygon(polygon)) {\n            mainShape.holes || (mainShape.holes = []);\n            mainShape.holes.push(shapePrimitive);\n            shapePrimitives.copyWithin(i, i + 1);\n            shapePrimitives.length--;\n            i--;\n          } else {\n            mainShape = shapePrimitive;\n          }\n        }\n      }\n    }\n    return this;\n  }\n  /**\n   * Finalizes the drawing of the current path. Optionally, it can close the path.\n   * @param closePath - A boolean indicating whether to close the path after finishing. False by default.\n   */\n  finish(closePath = false) {\n    this.endPoly(closePath);\n  }\n  /**\n   * Draws a rectangle shape. This method adds a new rectangle path to the current drawing.\n   * @param x - The x-coordinate of the top-left corner of the rectangle.\n   * @param y - The y-coordinate of the top-left corner of the rectangle.\n   * @param w - The width of the rectangle.\n   * @param h - The height of the rectangle.\n   * @param transform - An optional `Matrix` object to apply a transformation to the rectangle.\n   * @returns The instance of the current object for chaining.\n   */\n  rect(x, y, w, h, transform) {\n    this.drawShape(new Rectangle(x, y, w, h), transform);\n    return this;\n  }\n  /**\n   * Draws a circle shape. This method adds a new circle path to the current drawing.\n   * @param x - The x-coordinate of the center of the circle.\n   * @param y - The y-coordinate of the center of the circle.\n   * @param radius - The radius of the circle.\n   * @param transform - An optional `Matrix` object to apply a transformation to the circle.\n   * @returns The instance of the current object for chaining.\n   */\n  circle(x, y, radius, transform) {\n    this.drawShape(new Circle(x, y, radius), transform);\n    return this;\n  }\n  /**\n   * Draws a polygon shape. This method allows for the creation of complex polygons by specifying a sequence of points.\n   * @param points - An array of numbers, or or an array of PointData objects eg [{x,y}, {x,y}, {x,y}]\n   * representing the x and y coordinates of the polygon's vertices, in sequence.\n   * @param close - A boolean indicating whether to close the polygon path. True by default.\n   * @param transform - An optional `Matrix` object to apply a transformation to the polygon.\n   * @returns The instance of the current object for chaining.\n   */\n  poly(points, close, transform) {\n    const polygon = new Polygon(points);\n    polygon.closePath = close;\n    this.drawShape(polygon, transform);\n    return this;\n  }\n  /**\n   * Draws a regular polygon with a specified number of sides. All sides and angles are equal.\n   * @param x - The x-coordinate of the center of the polygon.\n   * @param y - The y-coordinate of the center of the polygon.\n   * @param radius - The radius of the circumscribed circle of the polygon.\n   * @param sides - The number of sides of the polygon. Must be 3 or more.\n   * @param rotation - The rotation angle of the polygon, in radians. Zero by default.\n   * @param transform - An optional `Matrix` object to apply a transformation to the polygon.\n   * @returns The instance of the current object for chaining.\n   */\n  regularPoly(x, y, radius, sides, rotation = 0, transform) {\n    sides = Math.max(sides | 0, 3);\n    const startAngle = -1 * Math.PI / 2 + rotation;\n    const delta = Math.PI * 2 / sides;\n    const polygon = [];\n    for (let i = 0; i < sides; i++) {\n      const angle = startAngle - i * delta;\n      polygon.push(\n        x + radius * Math.cos(angle),\n        y + radius * Math.sin(angle)\n      );\n    }\n    this.poly(polygon, true, transform);\n    return this;\n  }\n  /**\n   * Draws a polygon with rounded corners.\n   * Similar to `regularPoly` but with the ability to round the corners of the polygon.\n   * @param x - The x-coordinate of the center of the polygon.\n   * @param y - The y-coordinate of the center of the polygon.\n   * @param radius - The radius of the circumscribed circle of the polygon.\n   * @param sides - The number of sides of the polygon. Must be 3 or more.\n   * @param corner - The radius of the rounding of the corners.\n   * @param rotation - The rotation angle of the polygon, in radians. Zero by default.\n   * @param smoothness - Optional parameter to adjust the smoothness of the rounding.\n   * @returns The instance of the current object for chaining.\n   */\n  roundPoly(x, y, radius, sides, corner, rotation = 0, smoothness) {\n    sides = Math.max(sides | 0, 3);\n    if (corner <= 0) {\n      return this.regularPoly(x, y, radius, sides, rotation);\n    }\n    const sideLength = radius * Math.sin(Math.PI / sides) - 1e-3;\n    corner = Math.min(corner, sideLength);\n    const startAngle = -1 * Math.PI / 2 + rotation;\n    const delta = Math.PI * 2 / sides;\n    const internalAngle = (sides - 2) * Math.PI / sides / 2;\n    for (let i = 0; i < sides; i++) {\n      const angle = i * delta + startAngle;\n      const x0 = x + radius * Math.cos(angle);\n      const y0 = y + radius * Math.sin(angle);\n      const a1 = angle + Math.PI + internalAngle;\n      const a2 = angle - Math.PI - internalAngle;\n      const x1 = x0 + corner * Math.cos(a1);\n      const y1 = y0 + corner * Math.sin(a1);\n      const x3 = x0 + corner * Math.cos(a2);\n      const y3 = y0 + corner * Math.sin(a2);\n      if (i === 0) {\n        this.moveTo(x1, y1);\n      } else {\n        this.lineTo(x1, y1);\n      }\n      this.quadraticCurveTo(x0, y0, x3, y3, smoothness);\n    }\n    return this.closePath();\n  }\n  /**\n   * Draws a shape with rounded corners. This function supports custom radius for each corner of the shape.\n   * Optionally, corners can be rounded using a quadratic curve instead of an arc, providing a different aesthetic.\n   * @param points - An array of `RoundedPoint` representing the corners of the shape to draw.\n   * A minimum of 3 points is required.\n   * @param radius - The default radius for the corners.\n   * This radius is applied to all corners unless overridden in `points`.\n   * @param useQuadratic - If set to true, rounded corners are drawn using a quadraticCurve\n   *  method instead of an arc method. Defaults to false.\n   * @param smoothness - Specifies the smoothness of the curve when `useQuadratic` is true.\n   * Higher values make the curve smoother.\n   * @returns The instance of the current object for chaining.\n   */\n  roundShape(points, radius, useQuadratic = false, smoothness) {\n    if (points.length < 3) {\n      return this;\n    }\n    if (useQuadratic) {\n      roundedShapeQuadraticCurve(this, points, radius, smoothness);\n    } else {\n      roundedShapeArc(this, points, radius);\n    }\n    return this.closePath();\n  }\n  /**\n   * Draw Rectangle with fillet corners. This is much like rounded rectangle\n   * however it support negative numbers as well for the corner radius.\n   * @param x - Upper left corner of rect\n   * @param y - Upper right corner of rect\n   * @param width - Width of rect\n   * @param height - Height of rect\n   * @param fillet - accept negative or positive values\n   */\n  filletRect(x, y, width, height, fillet) {\n    if (fillet === 0) {\n      return this.rect(x, y, width, height);\n    }\n    const maxFillet = Math.min(width, height) / 2;\n    const inset = Math.min(maxFillet, Math.max(-maxFillet, fillet));\n    const right = x + width;\n    const bottom = y + height;\n    const dir = inset < 0 ? -inset : 0;\n    const size = Math.abs(inset);\n    return this.moveTo(x, y + size).arcTo(x + dir, y + dir, x + size, y, size).lineTo(right - size, y).arcTo(right - dir, y + dir, right, y + size, size).lineTo(right, bottom - size).arcTo(right - dir, bottom - dir, x + width - size, bottom, size).lineTo(x + size, bottom).arcTo(x + dir, bottom - dir, x, bottom - size, size).closePath();\n  }\n  /**\n   * Draw Rectangle with chamfer corners. These are angled corners.\n   * @param x - Upper left corner of rect\n   * @param y - Upper right corner of rect\n   * @param width - Width of rect\n   * @param height - Height of rect\n   * @param chamfer - non-zero real number, size of corner cutout\n   * @param transform\n   */\n  chamferRect(x, y, width, height, chamfer, transform) {\n    if (chamfer <= 0) {\n      return this.rect(x, y, width, height);\n    }\n    const inset = Math.min(chamfer, Math.min(width, height) / 2);\n    const right = x + width;\n    const bottom = y + height;\n    const points = [\n      x + inset,\n      y,\n      right - inset,\n      y,\n      right,\n      y + inset,\n      right,\n      bottom - inset,\n      right - inset,\n      bottom,\n      x + inset,\n      bottom,\n      x,\n      bottom - inset,\n      x,\n      y + inset\n    ];\n    for (let i = points.length - 1; i >= 2; i -= 2) {\n      if (points[i] === points[i - 2] && points[i - 1] === points[i - 3]) {\n        points.splice(i - 1, 2);\n      }\n    }\n    return this.poly(points, true, transform);\n  }\n  /**\n   * Draws an ellipse at the specified location and with the given x and y radii.\n   * An optional transformation can be applied, allowing for rotation, scaling, and translation.\n   * @param x - The x-coordinate of the center of the ellipse.\n   * @param y - The y-coordinate of the center of the ellipse.\n   * @param radiusX - The horizontal radius of the ellipse.\n   * @param radiusY - The vertical radius of the ellipse.\n   * @param transform - An optional `Matrix` object to apply a transformation to the ellipse. This can include rotations.\n   * @returns The instance of the current object for chaining.\n   */\n  ellipse(x, y, radiusX, radiusY, transform) {\n    this.drawShape(new Ellipse(x, y, radiusX, radiusY), transform);\n    return this;\n  }\n  /**\n   * Draws a rectangle with rounded corners.\n   * The corner radius can be specified to determine how rounded the corners should be.\n   * An optional transformation can be applied, which allows for rotation, scaling, and translation of the rectangle.\n   * @param x - The x-coordinate of the top-left corner of the rectangle.\n   * @param y - The y-coordinate of the top-left corner of the rectangle.\n   * @param w - The width of the rectangle.\n   * @param h - The height of the rectangle.\n   * @param radius - The radius of the rectangle's corners. If not specified, corners will be sharp.\n   * @param transform - An optional `Matrix` object to apply a transformation to the rectangle.\n   * @returns The instance of the current object for chaining.\n   */\n  roundRect(x, y, w, h, radius, transform) {\n    this.drawShape(new RoundedRectangle(x, y, w, h, radius), transform);\n    return this;\n  }\n  /**\n   * Draws a given shape on the canvas.\n   * This is a generic method that can draw any type of shape specified by the `ShapePrimitive` parameter.\n   * An optional transformation matrix can be applied to the shape, allowing for complex transformations.\n   * @param shape - The shape to draw, defined as a `ShapePrimitive` object.\n   * @param matrix - An optional `Matrix` for transforming the shape. This can include rotations,\n   * scaling, and translations.\n   * @returns The instance of the current object for chaining.\n   */\n  drawShape(shape, matrix) {\n    this.endPoly();\n    this.shapePrimitives.push({ shape, transform: matrix });\n    return this;\n  }\n  /**\n   * Starts a new polygon path from the specified starting point.\n   * This method initializes a new polygon or ends the current one if it exists.\n   * @param x - The x-coordinate of the starting point of the new polygon.\n   * @param y - The y-coordinate of the starting point of the new polygon.\n   * @returns The instance of the current object for chaining.\n   */\n  startPoly(x, y) {\n    let currentPoly = this._currentPoly;\n    if (currentPoly) {\n      this.endPoly();\n    }\n    currentPoly = new Polygon();\n    currentPoly.points.push(x, y);\n    this._currentPoly = currentPoly;\n    return this;\n  }\n  /**\n   * Ends the current polygon path. If `closePath` is set to true,\n   * the path is closed by connecting the last point to the first one.\n   * This method finalizes the current polygon and prepares it for drawing or adding to the shape primitives.\n   * @param closePath - A boolean indicating whether to close the polygon by connecting the last point\n   *  back to the starting point. False by default.\n   * @returns The instance of the current object for chaining.\n   */\n  endPoly(closePath = false) {\n    const shape = this._currentPoly;\n    if (shape && shape.points.length > 2) {\n      shape.closePath = closePath;\n      this.shapePrimitives.push({ shape });\n    }\n    this._currentPoly = null;\n    return this;\n  }\n  _ensurePoly(start = true) {\n    if (this._currentPoly)\n      return;\n    this._currentPoly = new Polygon();\n    if (start) {\n      const lastShape = this.shapePrimitives[this.shapePrimitives.length - 1];\n      if (lastShape) {\n        let lx = lastShape.shape.x;\n        let ly = lastShape.shape.y;\n        if (lastShape.transform && !lastShape.transform.isIdentity()) {\n          const t = lastShape.transform;\n          const tempX = lx;\n          lx = t.a * lx + t.c * ly + t.tx;\n          ly = t.b * tempX + t.d * ly + t.ty;\n        }\n        this._currentPoly.points.push(lx, ly);\n      } else {\n        this._currentPoly.points.push(0, 0);\n      }\n    }\n  }\n  /** Builds the path. */\n  buildPath() {\n    const path = this._graphicsPath2D;\n    this.shapePrimitives.length = 0;\n    this._currentPoly = null;\n    for (let i = 0; i < path.instructions.length; i++) {\n      const instruction = path.instructions[i];\n      this[instruction.action](...instruction.data);\n    }\n    this.finish();\n  }\n  /** Gets the bounds of the path. */\n  get bounds() {\n    const bounds = this._bounds;\n    bounds.clear();\n    const shapePrimitives = this.shapePrimitives;\n    for (let i = 0; i < shapePrimitives.length; i++) {\n      const shapePrimitive = shapePrimitives[i];\n      const boundsRect = shapePrimitive.shape.getBounds(tempRectangle);\n      if (shapePrimitive.transform) {\n        bounds.addRect(boundsRect, shapePrimitive.transform);\n      } else {\n        bounds.addRect(boundsRect);\n      }\n    }\n    return bounds;\n  }\n}\n\nexport { ShapePath };\n//# sourceMappingURL=ShapePath.mjs.map\n","import { Point } from '../../../../maths/point/Point.mjs';\nimport { uid } from '../../../../utils/data/uid.mjs';\nimport { warn } from '../../../../utils/logging/warn.mjs';\nimport { parseSVGPath } from '../svg/parseSVGPath.mjs';\nimport { ShapePath } from './ShapePath.mjs';\n\n\"use strict\";\nclass GraphicsPath {\n  /**\n   * Creates a `GraphicsPath` instance optionally from an SVG path string or an array of `PathInstruction`.\n   * @param instructions - An SVG path string or an array of `PathInstruction` objects.\n   * @param signed\n   */\n  constructor(instructions, signed = false) {\n    this.instructions = [];\n    /** unique id for this graphics path */\n    this.uid = uid(\"graphicsPath\");\n    this._dirty = true;\n    this.checkForHoles = signed;\n    if (typeof instructions === \"string\") {\n      parseSVGPath(instructions, this);\n    } else {\n      this.instructions = instructions?.slice() ?? [];\n    }\n  }\n  /**\n   * Provides access to the internal shape path, ensuring it is up-to-date with the current instructions.\n   * @returns The `ShapePath` instance associated with this `GraphicsPath`.\n   */\n  get shapePath() {\n    if (!this._shapePath) {\n      this._shapePath = new ShapePath(this);\n    }\n    if (this._dirty) {\n      this._dirty = false;\n      this._shapePath.buildPath();\n    }\n    return this._shapePath;\n  }\n  /**\n   * Adds another `GraphicsPath` to this path, optionally applying a transformation.\n   * @param path - The `GraphicsPath` to add.\n   * @param transform - An optional transformation to apply to the added path.\n   * @returns The instance of the current object for chaining.\n   */\n  addPath(path, transform) {\n    path = path.clone();\n    this.instructions.push({ action: \"addPath\", data: [path, transform] });\n    this._dirty = true;\n    return this;\n  }\n  arc(...args) {\n    this.instructions.push({ action: \"arc\", data: args });\n    this._dirty = true;\n    return this;\n  }\n  arcTo(...args) {\n    this.instructions.push({ action: \"arcTo\", data: args });\n    this._dirty = true;\n    return this;\n  }\n  arcToSvg(...args) {\n    this.instructions.push({ action: \"arcToSvg\", data: args });\n    this._dirty = true;\n    return this;\n  }\n  bezierCurveTo(...args) {\n    this.instructions.push({ action: \"bezierCurveTo\", data: args });\n    this._dirty = true;\n    return this;\n  }\n  /**\n   * Adds a cubic Bezier curve to the path.\n   * It requires two points: the second control point and the end point. The first control point is assumed to be\n   * The starting point is the last point in the current path.\n   * @param cp2x - The x-coordinate of the second control point.\n   * @param cp2y - The y-coordinate of the second control point.\n   * @param x - The x-coordinate of the end point.\n   * @param y - The y-coordinate of the end point.\n   * @param smoothness - Optional parameter to adjust the smoothness of the curve.\n   * @returns The instance of the current object for chaining.\n   */\n  bezierCurveToShort(cp2x, cp2y, x, y, smoothness) {\n    const last = this.instructions[this.instructions.length - 1];\n    const lastPoint = this.getLastPoint(Point.shared);\n    let cp1x = 0;\n    let cp1y = 0;\n    if (!last || last.action !== \"bezierCurveTo\") {\n      cp1x = lastPoint.x;\n      cp1y = lastPoint.y;\n    } else {\n      cp1x = last.data[2];\n      cp1y = last.data[3];\n      const currentX = lastPoint.x;\n      const currentY = lastPoint.y;\n      cp1x = currentX + (currentX - cp1x);\n      cp1y = currentY + (currentY - cp1y);\n    }\n    this.instructions.push({ action: \"bezierCurveTo\", data: [cp1x, cp1y, cp2x, cp2y, x, y, smoothness] });\n    this._dirty = true;\n    return this;\n  }\n  /**\n   * Closes the current path by drawing a straight line back to the start.\n   * If the shape is already closed or there are no points in the path, this method does nothing.\n   * @returns The instance of the current object for chaining.\n   */\n  closePath() {\n    this.instructions.push({ action: \"closePath\", data: [] });\n    this._dirty = true;\n    return this;\n  }\n  ellipse(...args) {\n    this.instructions.push({ action: \"ellipse\", data: args });\n    this._dirty = true;\n    return this;\n  }\n  lineTo(...args) {\n    this.instructions.push({ action: \"lineTo\", data: args });\n    this._dirty = true;\n    return this;\n  }\n  moveTo(...args) {\n    this.instructions.push({ action: \"moveTo\", data: args });\n    return this;\n  }\n  quadraticCurveTo(...args) {\n    this.instructions.push({ action: \"quadraticCurveTo\", data: args });\n    this._dirty = true;\n    return this;\n  }\n  /**\n   * Adds a quadratic curve to the path. It uses the previous point as the control point.\n   * @param x - The x-coordinate of the end point.\n   * @param y - The y-coordinate of the end point.\n   * @param smoothness - Optional parameter to adjust the smoothness of the curve.\n   * @returns The instance of the current object for chaining.\n   */\n  quadraticCurveToShort(x, y, smoothness) {\n    const last = this.instructions[this.instructions.length - 1];\n    const lastPoint = this.getLastPoint(Point.shared);\n    let cpx1 = 0;\n    let cpy1 = 0;\n    if (!last || last.action !== \"quadraticCurveTo\") {\n      cpx1 = lastPoint.x;\n      cpy1 = lastPoint.y;\n    } else {\n      cpx1 = last.data[0];\n      cpy1 = last.data[1];\n      const currentX = lastPoint.x;\n      const currentY = lastPoint.y;\n      cpx1 = currentX + (currentX - cpx1);\n      cpy1 = currentY + (currentY - cpy1);\n    }\n    this.instructions.push({ action: \"quadraticCurveTo\", data: [cpx1, cpy1, x, y, smoothness] });\n    this._dirty = true;\n    return this;\n  }\n  /**\n   * Draws a rectangle shape. This method adds a new rectangle path to the current drawing.\n   * @param x - The x-coordinate of the top-left corner of the rectangle.\n   * @param y - The y-coordinate of the top-left corner of the rectangle.\n   * @param w - The width of the rectangle.\n   * @param h - The height of the rectangle.\n   * @param transform - An optional `Matrix` object to apply a transformation to the rectangle.\n   * @returns The instance of the current object for chaining.\n   */\n  rect(x, y, w, h, transform) {\n    this.instructions.push({ action: \"rect\", data: [x, y, w, h, transform] });\n    this._dirty = true;\n    return this;\n  }\n  /**\n   * Draws a circle shape. This method adds a new circle path to the current drawing.\n   * @param x - The x-coordinate of the center of the circle.\n   * @param y - The y-coordinate of the center of the circle.\n   * @param radius - The radius of the circle.\n   * @param transform - An optional `Matrix` object to apply a transformation to the circle.\n   * @returns The instance of the current object for chaining.\n   */\n  circle(x, y, radius, transform) {\n    this.instructions.push({ action: \"circle\", data: [x, y, radius, transform] });\n    this._dirty = true;\n    return this;\n  }\n  roundRect(...args) {\n    this.instructions.push({ action: \"roundRect\", data: args });\n    this._dirty = true;\n    return this;\n  }\n  poly(...args) {\n    this.instructions.push({ action: \"poly\", data: args });\n    this._dirty = true;\n    return this;\n  }\n  regularPoly(...args) {\n    this.instructions.push({ action: \"regularPoly\", data: args });\n    this._dirty = true;\n    return this;\n  }\n  roundPoly(...args) {\n    this.instructions.push({ action: \"roundPoly\", data: args });\n    this._dirty = true;\n    return this;\n  }\n  roundShape(...args) {\n    this.instructions.push({ action: \"roundShape\", data: args });\n    this._dirty = true;\n    return this;\n  }\n  filletRect(...args) {\n    this.instructions.push({ action: \"filletRect\", data: args });\n    this._dirty = true;\n    return this;\n  }\n  chamferRect(...args) {\n    this.instructions.push({ action: \"chamferRect\", data: args });\n    this._dirty = true;\n    return this;\n  }\n  /**\n   * Draws a star shape centered at a specified location. This method allows for the creation\n   *  of stars with a variable number of points, outer radius, optional inner radius, and rotation.\n   * The star is drawn as a closed polygon with alternating outer and inner vertices to create the star's points.\n   * An optional transformation can be applied to scale, rotate, or translate the star as needed.\n   * @param x - The x-coordinate of the center of the star.\n   * @param y - The y-coordinate of the center of the star.\n   * @param points - The number of points of the star.\n   * @param radius - The outer radius of the star (distance from the center to the outer points).\n   * @param innerRadius - Optional. The inner radius of the star\n   * (distance from the center to the inner points between the outer points).\n   * If not provided, defaults to half of the `radius`.\n   * @param rotation - Optional. The rotation of the star in radians, where 0 is aligned with the y-axis.\n   * Defaults to 0, meaning one point is directly upward.\n   * @param transform - An optional `Matrix` object to apply a transformation to the star.\n   * This can include rotations, scaling, and translations.\n   * @returns The instance of the current object for chaining further drawing commands.\n   */\n  // eslint-disable-next-line max-len\n  star(x, y, points, radius, innerRadius, rotation, transform) {\n    innerRadius || (innerRadius = radius / 2);\n    const startAngle = -1 * Math.PI / 2 + rotation;\n    const len = points * 2;\n    const delta = Math.PI * 2 / len;\n    const polygon = [];\n    for (let i = 0; i < len; i++) {\n      const r = i % 2 ? innerRadius : radius;\n      const angle = i * delta + startAngle;\n      polygon.push(\n        x + r * Math.cos(angle),\n        y + r * Math.sin(angle)\n      );\n    }\n    this.poly(polygon, true, transform);\n    return this;\n  }\n  /**\n   * Creates a copy of the current `GraphicsPath` instance. This method supports both shallow and deep cloning.\n   * A shallow clone copies the reference of the instructions array, while a deep clone creates a new array and\n   * copies each instruction individually, ensuring that modifications to the instructions of the cloned `GraphicsPath`\n   * do not affect the original `GraphicsPath` and vice versa.\n   * @param deep - A boolean flag indicating whether the clone should be deep.\n   * @returns A new `GraphicsPath` instance that is a clone of the current instance.\n   */\n  clone(deep = false) {\n    const newGraphicsPath2D = new GraphicsPath();\n    newGraphicsPath2D.checkForHoles = this.checkForHoles;\n    if (!deep) {\n      newGraphicsPath2D.instructions = this.instructions.slice();\n    } else {\n      for (let i = 0; i < this.instructions.length; i++) {\n        const instruction = this.instructions[i];\n        newGraphicsPath2D.instructions.push({ action: instruction.action, data: instruction.data.slice() });\n      }\n    }\n    return newGraphicsPath2D;\n  }\n  clear() {\n    this.instructions.length = 0;\n    this._dirty = true;\n    return this;\n  }\n  /**\n   * Applies a transformation matrix to all drawing instructions within the `GraphicsPath`.\n   * This method enables the modification of the path's geometry according to the provided\n   * transformation matrix, which can include translations, rotations, scaling, and skewing.\n   *\n   * Each drawing instruction in the path is updated to reflect the transformation,\n   * ensuring the visual representation of the path is consistent with the applied matrix.\n   *\n   * Note: The transformation is applied directly to the coordinates and control points of the drawing instructions,\n   * not to the path as a whole. This means the transformation's effects are baked into the individual instructions,\n   * allowing for fine-grained control over the path's appearance.\n   * @param matrix - A `Matrix` object representing the transformation to apply.\n   * @returns The instance of the current object for chaining further operations.\n   */\n  transform(matrix) {\n    if (matrix.isIdentity())\n      return this;\n    const a = matrix.a;\n    const b = matrix.b;\n    const c = matrix.c;\n    const d = matrix.d;\n    const tx = matrix.tx;\n    const ty = matrix.ty;\n    let x = 0;\n    let y = 0;\n    let cpx1 = 0;\n    let cpy1 = 0;\n    let cpx2 = 0;\n    let cpy2 = 0;\n    let rx = 0;\n    let ry = 0;\n    for (let i = 0; i < this.instructions.length; i++) {\n      const instruction = this.instructions[i];\n      const data = instruction.data;\n      switch (instruction.action) {\n        case \"moveTo\":\n        case \"lineTo\":\n          x = data[0];\n          y = data[1];\n          data[0] = a * x + c * y + tx;\n          data[1] = b * x + d * y + ty;\n          break;\n        case \"bezierCurveTo\":\n          cpx1 = data[0];\n          cpy1 = data[1];\n          cpx2 = data[2];\n          cpy2 = data[3];\n          x = data[4];\n          y = data[5];\n          data[0] = a * cpx1 + c * cpy1 + tx;\n          data[1] = b * cpx1 + d * cpy1 + ty;\n          data[2] = a * cpx2 + c * cpy2 + tx;\n          data[3] = b * cpx2 + d * cpy2 + ty;\n          data[4] = a * x + c * y + tx;\n          data[5] = b * x + d * y + ty;\n          break;\n        case \"quadraticCurveTo\":\n          cpx1 = data[0];\n          cpy1 = data[1];\n          x = data[2];\n          y = data[3];\n          data[0] = a * cpx1 + c * cpy1 + tx;\n          data[1] = b * cpx1 + d * cpy1 + ty;\n          data[2] = a * x + c * y + tx;\n          data[3] = b * x + d * y + ty;\n          break;\n        case \"arcToSvg\":\n          x = data[5];\n          y = data[6];\n          rx = data[0];\n          ry = data[1];\n          data[0] = a * rx + c * ry;\n          data[1] = b * rx + d * ry;\n          data[5] = a * x + c * y + tx;\n          data[6] = b * x + d * y + ty;\n          break;\n        case \"circle\":\n          data[4] = adjustTransform(data[3], matrix);\n          break;\n        case \"rect\":\n          data[4] = adjustTransform(data[4], matrix);\n          break;\n        case \"ellipse\":\n          data[8] = adjustTransform(data[8], matrix);\n          break;\n        case \"roundRect\":\n          data[5] = adjustTransform(data[5], matrix);\n          break;\n        case \"addPath\":\n          data[0].transform(matrix);\n          break;\n        case \"poly\":\n          data[2] = adjustTransform(data[2], matrix);\n          break;\n        default:\n          warn(\"unknown transform action\", instruction.action);\n          break;\n      }\n    }\n    this._dirty = true;\n    return this;\n  }\n  get bounds() {\n    return this.shapePath.bounds;\n  }\n  /**\n   * Retrieves the last point from the current drawing instructions in the `GraphicsPath`.\n   * This method is useful for operations that depend on the path's current endpoint,\n   * such as connecting subsequent shapes or paths. It supports various drawing instructions,\n   * ensuring the last point's position is accurately determined regardless of the path's complexity.\n   *\n   * If the last instruction is a `closePath`, the method iterates backward through the instructions\n   *  until it finds an actionable instruction that defines a point (e.g., `moveTo`, `lineTo`,\n   * `quadraticCurveTo`, etc.). For compound paths added via `addPath`, it recursively retrieves\n   * the last point from the nested path.\n   * @param out - A `Point` object where the last point's coordinates will be stored.\n   * This object is modified directly to contain the result.\n   * @returns The `Point` object containing the last point's coordinates.\n   */\n  getLastPoint(out) {\n    let index = this.instructions.length - 1;\n    let lastInstruction = this.instructions[index];\n    if (!lastInstruction) {\n      out.x = 0;\n      out.y = 0;\n      return out;\n    }\n    while (lastInstruction.action === \"closePath\") {\n      index--;\n      if (index < 0) {\n        out.x = 0;\n        out.y = 0;\n        return out;\n      }\n      lastInstruction = this.instructions[index];\n    }\n    switch (lastInstruction.action) {\n      case \"moveTo\":\n      case \"lineTo\":\n        out.x = lastInstruction.data[0];\n        out.y = lastInstruction.data[1];\n        break;\n      case \"quadraticCurveTo\":\n        out.x = lastInstruction.data[2];\n        out.y = lastInstruction.data[3];\n        break;\n      case \"bezierCurveTo\":\n        out.x = lastInstruction.data[4];\n        out.y = lastInstruction.data[5];\n        break;\n      case \"arc\":\n      case \"arcToSvg\":\n        out.x = lastInstruction.data[5];\n        out.y = lastInstruction.data[6];\n        break;\n      case \"addPath\":\n        lastInstruction.data[0].getLastPoint(out);\n        break;\n    }\n    return out;\n  }\n}\nfunction adjustTransform(currentMatrix, transform) {\n  if (currentMatrix) {\n    return currentMatrix.prepend(transform);\n  }\n  return transform.clone();\n}\n\nexport { GraphicsPath };\n//# sourceMappingURL=GraphicsPath.mjs.map\n","\"use strict\";\nfunction parseSVGFloatAttribute(svg, id, defaultValue) {\n  const value = svg.getAttribute(id);\n  return value ? Number(value) : defaultValue;\n}\n\nexport { parseSVGFloatAttribute };\n//# sourceMappingURL=parseSVGFloatAttribute.mjs.map\n","import { Color } from '../../../../color/Color.mjs';\nimport { warn } from '../../../../utils/logging/warn.mjs';\nimport { FillGradient } from '../fill/FillGradient.mjs';\nimport { parseSVGFloatAttribute } from './parseSVGFloatAttribute.mjs';\n\n\"use strict\";\nfunction parseSVGDefinitions(svg, session) {\n  const definitions = svg.querySelectorAll(\"defs\");\n  for (let i = 0; i < definitions.length; i++) {\n    const definition = definitions[i];\n    for (let j = 0; j < definition.children.length; j++) {\n      const child = definition.children[j];\n      switch (child.nodeName.toLowerCase()) {\n        case \"lineargradient\":\n          session.defs[child.id] = parseLinearGradient(child);\n          break;\n        case \"radialgradient\":\n          session.defs[child.id] = parseRadialGradient(child);\n          break;\n        default:\n          break;\n      }\n    }\n  }\n}\nfunction parseLinearGradient(child) {\n  const x0 = parseSVGFloatAttribute(child, \"x1\", 0);\n  const y0 = parseSVGFloatAttribute(child, \"y1\", 0);\n  const x1 = parseSVGFloatAttribute(child, \"x2\", 1);\n  const y1 = parseSVGFloatAttribute(child, \"y2\", 0);\n  const gradientUnit = child.getAttribute(\"gradientUnits\") || \"objectBoundingBox\";\n  const gradient = new FillGradient(\n    x0,\n    y0,\n    x1,\n    y1,\n    gradientUnit === \"objectBoundingBox\" ? \"local\" : \"global\"\n  );\n  for (let k = 0; k < child.children.length; k++) {\n    const stop = child.children[k];\n    const offset = parseSVGFloatAttribute(stop, \"offset\", 0);\n    const color = Color.shared.setValue(stop.getAttribute(\"stop-color\")).toNumber();\n    gradient.addColorStop(offset, color);\n  }\n  return gradient;\n}\nfunction parseRadialGradient(_child) {\n  warn(\"[SVG Parser] Radial gradients are not yet supported\");\n  return new FillGradient(0, 0, 1, 0);\n}\n\nexport { parseSVGDefinitions };\n//# sourceMappingURL=parseSVGDefinitions.mjs.map\n","\"use strict\";\nfunction extractSvgUrlId(url) {\n  const match = url.match(/url\\s*\\(\\s*['\"]?\\s*#([^'\"\\s)]+)\\s*['\"]?\\s*\\)/i);\n  return match ? match[1] : \"\";\n}\n\nexport { extractSvgUrlId };\n//# sourceMappingURL=extractSvgUrlId.mjs.map\n","import { Color } from '../../../../color/Color.mjs';\nimport { extractSvgUrlId } from './utils/extractSvgUrlId.mjs';\n\n\"use strict\";\nconst styleAttributes = {\n  // Fill properties\n  fill: { type: \"paint\", default: 0 },\n  // Fill color/gradient\n  \"fill-opacity\": { type: \"number\", default: 1 },\n  // Fill transparency\n  // Stroke properties\n  stroke: { type: \"paint\", default: 0 },\n  // Stroke color/gradient\n  \"stroke-width\": { type: \"number\", default: 1 },\n  // Width of stroke\n  \"stroke-opacity\": { type: \"number\", default: 1 },\n  // Stroke transparency\n  \"stroke-linecap\": { type: \"string\", default: \"butt\" },\n  // End cap style: butt, round, square\n  \"stroke-linejoin\": { type: \"string\", default: \"miter\" },\n  // Join style: miter, round, bevel\n  \"stroke-miterlimit\": { type: \"number\", default: 10 },\n  // Limit on miter join sharpness\n  \"stroke-dasharray\": { type: \"string\", default: \"none\" },\n  // Dash pattern\n  \"stroke-dashoffset\": { type: \"number\", default: 0 },\n  // Offset for dash pattern\n  // Global properties\n  opacity: { type: \"number\", default: 1 }\n  // Overall opacity\n};\nfunction parseSVGStyle(svg, session) {\n  const style = svg.getAttribute(\"style\");\n  const strokeStyle = {};\n  const fillStyle = {};\n  const result = {\n    strokeStyle,\n    fillStyle,\n    useFill: false,\n    useStroke: false\n  };\n  for (const key in styleAttributes) {\n    const attribute = svg.getAttribute(key);\n    if (attribute) {\n      parseAttribute(session, result, key, attribute.trim());\n    }\n  }\n  if (style) {\n    const styleParts = style.split(\";\");\n    for (let i = 0; i < styleParts.length; i++) {\n      const stylePart = styleParts[i].trim();\n      const [key, value] = stylePart.split(\":\");\n      if (styleAttributes[key]) {\n        parseAttribute(session, result, key, value.trim());\n      }\n    }\n  }\n  return {\n    strokeStyle: result.useStroke ? strokeStyle : null,\n    fillStyle: result.useFill ? fillStyle : null,\n    useFill: result.useFill,\n    useStroke: result.useStroke\n  };\n}\nfunction parseAttribute(session, result, id, value) {\n  switch (id) {\n    case \"stroke\":\n      if (value !== \"none\") {\n        if (value.startsWith(\"url(\")) {\n          const id2 = extractSvgUrlId(value);\n          result.strokeStyle.fill = session.defs[id2];\n        } else {\n          result.strokeStyle.color = Color.shared.setValue(value).toNumber();\n        }\n        result.useStroke = true;\n      }\n      break;\n    case \"stroke-width\":\n      result.strokeStyle.width = Number(value);\n      break;\n    case \"fill\":\n      if (value !== \"none\") {\n        if (value.startsWith(\"url(\")) {\n          const id2 = extractSvgUrlId(value);\n          result.fillStyle.fill = session.defs[id2];\n        } else {\n          result.fillStyle.color = Color.shared.setValue(value).toNumber();\n        }\n        result.useFill = true;\n      }\n      break;\n    case \"fill-opacity\":\n      result.fillStyle.alpha = Number(value);\n      break;\n    case \"stroke-opacity\":\n      result.strokeStyle.alpha = Number(value);\n      break;\n    case \"opacity\":\n      result.fillStyle.alpha = Number(value);\n      result.strokeStyle.alpha = Number(value);\n      break;\n  }\n}\n\nexport { parseSVGStyle, styleAttributes };\n//# sourceMappingURL=parseSVGStyle.mjs.map\n","\"use strict\";\nfunction checkForNestedPattern(subpathsWithArea) {\n  if (subpathsWithArea.length <= 2) {\n    return true;\n  }\n  const areas = subpathsWithArea.map((s) => s.area).sort((a, b) => b - a);\n  const [largestArea, secondArea] = areas;\n  const smallestArea = areas[areas.length - 1];\n  const largestToSecondRatio = largestArea / secondArea;\n  const secondToSmallestRatio = secondArea / smallestArea;\n  if (largestToSecondRatio > 3 && secondToSmallestRatio < 2) {\n    return false;\n  }\n  return true;\n}\nfunction getFillInstructionData(context, index = 0) {\n  const instruction = context.instructions[index];\n  if (!instruction || instruction.action !== \"fill\") {\n    throw new Error(`Expected fill instruction at index ${index}, got ${instruction?.action || \"undefined\"}`);\n  }\n  return instruction.data;\n}\n\nexport { checkForNestedPattern, getFillInstructionData };\n//# sourceMappingURL=fillOperations.mjs.map\n","import { GraphicsPath } from '../../path/GraphicsPath.mjs';\n\n\"use strict\";\nfunction extractSubpaths(pathData) {\n  const parts = pathData.split(/(?=[Mm])/);\n  const subpaths = parts.filter((part) => part.trim().length > 0);\n  return subpaths;\n}\nfunction calculatePathArea(pathData) {\n  const coords = pathData.match(/[-+]?[0-9]*\\.?[0-9]+/g);\n  if (!coords || coords.length < 4)\n    return 0;\n  const numbers = coords.map(Number);\n  const xs = [];\n  const ys = [];\n  for (let i = 0; i < numbers.length; i += 2) {\n    if (i + 1 < numbers.length) {\n      xs.push(numbers[i]);\n      ys.push(numbers[i + 1]);\n    }\n  }\n  if (xs.length === 0 || ys.length === 0)\n    return 0;\n  const minX = Math.min(...xs);\n  const maxX = Math.max(...xs);\n  const minY = Math.min(...ys);\n  const maxY = Math.max(...ys);\n  const area = (maxX - minX) * (maxY - minY);\n  return area;\n}\nfunction appendSVGPath(pathData, graphicsPath) {\n  const tempPath = new GraphicsPath(pathData, false);\n  for (const instruction of tempPath.instructions) {\n    graphicsPath.instructions.push(instruction);\n  }\n}\n\nexport { appendSVGPath, calculatePathArea, extractSubpaths };\n//# sourceMappingURL=pathOperations.mjs.map\n","import { warn } from '../../../../utils/logging/warn.mjs';\nimport { GraphicsPath } from '../path/GraphicsPath.mjs';\nimport { parseSVGDefinitions } from './parseSVGDefinitions.mjs';\nimport { parseSVGFloatAttribute } from './parseSVGFloatAttribute.mjs';\nimport { parseSVGStyle } from './parseSVGStyle.mjs';\nimport { checkForNestedPattern } from './utils/fillOperations.mjs';\nimport { extractSubpaths, calculatePathArea, appendSVGPath } from './utils/pathOperations.mjs';\n\n\"use strict\";\nfunction SVGParser(svg, graphicsContext) {\n  if (typeof svg === \"string\") {\n    const div = document.createElement(\"div\");\n    div.innerHTML = svg.trim();\n    svg = div.querySelector(\"svg\");\n  }\n  const session = {\n    context: graphicsContext,\n    defs: {},\n    path: new GraphicsPath()\n  };\n  parseSVGDefinitions(svg, session);\n  const children = svg.children;\n  const { fillStyle, strokeStyle } = parseSVGStyle(svg, session);\n  for (let i = 0; i < children.length; i++) {\n    const child = children[i];\n    if (child.nodeName.toLowerCase() === \"defs\")\n      continue;\n    renderChildren(child, session, fillStyle, strokeStyle);\n  }\n  return graphicsContext;\n}\nfunction renderChildren(svg, session, fillStyle, strokeStyle) {\n  const children = svg.children;\n  const { fillStyle: f1, strokeStyle: s1 } = parseSVGStyle(svg, session);\n  if (f1 && fillStyle) {\n    fillStyle = { ...fillStyle, ...f1 };\n  } else if (f1) {\n    fillStyle = f1;\n  }\n  if (s1 && strokeStyle) {\n    strokeStyle = { ...strokeStyle, ...s1 };\n  } else if (s1) {\n    strokeStyle = s1;\n  }\n  const noStyle = !fillStyle && !strokeStyle;\n  if (noStyle) {\n    fillStyle = { color: 0 };\n  }\n  let x;\n  let y;\n  let x1;\n  let y1;\n  let x2;\n  let y2;\n  let cx;\n  let cy;\n  let r;\n  let rx;\n  let ry;\n  let points;\n  let pointsString;\n  let d;\n  let graphicsPath;\n  let width;\n  let height;\n  switch (svg.nodeName.toLowerCase()) {\n    case \"path\": {\n      d = svg.getAttribute(\"d\");\n      const fillRule = svg.getAttribute(\"fill-rule\");\n      const subpaths = extractSubpaths(d);\n      const hasExplicitEvenodd = fillRule === \"evenodd\";\n      const hasMultipleSubpaths = subpaths.length > 1;\n      const shouldProcessHoles = hasExplicitEvenodd && hasMultipleSubpaths;\n      if (shouldProcessHoles) {\n        const subpathsWithArea = subpaths.map((subpath) => ({\n          path: subpath,\n          area: calculatePathArea(subpath)\n        }));\n        subpathsWithArea.sort((a, b) => b.area - a.area);\n        const useMultipleHolesApproach = subpaths.length > 3 || !checkForNestedPattern(subpathsWithArea);\n        if (useMultipleHolesApproach) {\n          for (let i = 0; i < subpathsWithArea.length; i++) {\n            const subpath = subpathsWithArea[i];\n            const isMainShape = i === 0;\n            session.context.beginPath();\n            const newPath = new GraphicsPath(void 0, true);\n            appendSVGPath(subpath.path, newPath);\n            session.context.path(newPath);\n            if (isMainShape) {\n              if (fillStyle)\n                session.context.fill(fillStyle);\n              if (strokeStyle)\n                session.context.stroke(strokeStyle);\n            } else {\n              session.context.cut();\n            }\n          }\n        } else {\n          for (let i = 0; i < subpathsWithArea.length; i++) {\n            const subpath = subpathsWithArea[i];\n            const isHole = i % 2 === 1;\n            session.context.beginPath();\n            const newPath = new GraphicsPath(void 0, true);\n            appendSVGPath(subpath.path, newPath);\n            session.context.path(newPath);\n            if (isHole) {\n              session.context.cut();\n            } else {\n              if (fillStyle)\n                session.context.fill(fillStyle);\n              if (strokeStyle)\n                session.context.stroke(strokeStyle);\n            }\n          }\n        }\n      } else {\n        const useEvenoddForGraphicsPath = fillRule ? fillRule === \"evenodd\" : true;\n        graphicsPath = new GraphicsPath(d, useEvenoddForGraphicsPath);\n        session.context.path(graphicsPath);\n        if (fillStyle)\n          session.context.fill(fillStyle);\n        if (strokeStyle)\n          session.context.stroke(strokeStyle);\n      }\n      break;\n    }\n    case \"circle\":\n      cx = parseSVGFloatAttribute(svg, \"cx\", 0);\n      cy = parseSVGFloatAttribute(svg, \"cy\", 0);\n      r = parseSVGFloatAttribute(svg, \"r\", 0);\n      session.context.ellipse(cx, cy, r, r);\n      if (fillStyle)\n        session.context.fill(fillStyle);\n      if (strokeStyle)\n        session.context.stroke(strokeStyle);\n      break;\n    case \"rect\":\n      x = parseSVGFloatAttribute(svg, \"x\", 0);\n      y = parseSVGFloatAttribute(svg, \"y\", 0);\n      width = parseSVGFloatAttribute(svg, \"width\", 0);\n      height = parseSVGFloatAttribute(svg, \"height\", 0);\n      rx = parseSVGFloatAttribute(svg, \"rx\", 0);\n      ry = parseSVGFloatAttribute(svg, \"ry\", 0);\n      if (rx || ry) {\n        session.context.roundRect(x, y, width, height, rx || ry);\n      } else {\n        session.context.rect(x, y, width, height);\n      }\n      if (fillStyle)\n        session.context.fill(fillStyle);\n      if (strokeStyle)\n        session.context.stroke(strokeStyle);\n      break;\n    case \"ellipse\":\n      cx = parseSVGFloatAttribute(svg, \"cx\", 0);\n      cy = parseSVGFloatAttribute(svg, \"cy\", 0);\n      rx = parseSVGFloatAttribute(svg, \"rx\", 0);\n      ry = parseSVGFloatAttribute(svg, \"ry\", 0);\n      session.context.beginPath();\n      session.context.ellipse(cx, cy, rx, ry);\n      if (fillStyle)\n        session.context.fill(fillStyle);\n      if (strokeStyle)\n        session.context.stroke(strokeStyle);\n      break;\n    case \"line\":\n      x1 = parseSVGFloatAttribute(svg, \"x1\", 0);\n      y1 = parseSVGFloatAttribute(svg, \"y1\", 0);\n      x2 = parseSVGFloatAttribute(svg, \"x2\", 0);\n      y2 = parseSVGFloatAttribute(svg, \"y2\", 0);\n      session.context.beginPath();\n      session.context.moveTo(x1, y1);\n      session.context.lineTo(x2, y2);\n      if (strokeStyle)\n        session.context.stroke(strokeStyle);\n      break;\n    case \"polygon\":\n      pointsString = svg.getAttribute(\"points\");\n      points = pointsString.match(/\\d+/g).map((n) => parseInt(n, 10));\n      session.context.poly(points, true);\n      if (fillStyle)\n        session.context.fill(fillStyle);\n      if (strokeStyle)\n        session.context.stroke(strokeStyle);\n      break;\n    case \"polyline\":\n      pointsString = svg.getAttribute(\"points\");\n      points = pointsString.match(/\\d+/g).map((n) => parseInt(n, 10));\n      session.context.poly(points, false);\n      if (strokeStyle)\n        session.context.stroke(strokeStyle);\n      break;\n    case \"g\":\n    case \"svg\":\n      break;\n    default: {\n      warn(`[SVG parser] <${svg.nodeName}> elements unsupported`);\n      break;\n    }\n  }\n  if (noStyle) {\n    fillStyle = null;\n  }\n  for (let i = 0; i < children.length; i++) {\n    renderChildren(children[i], session, fillStyle, strokeStyle);\n  }\n}\n\nexport { SVGParser };\n//# sourceMappingURL=SVGParser.mjs.map\n","import { Color } from '../../../../color/Color.mjs';\nimport { Texture } from '../../../../rendering/renderers/shared/texture/Texture.mjs';\nimport { FillGradient } from '../fill/FillGradient.mjs';\nimport { FillPattern } from '../fill/FillPattern.mjs';\n\n\"use strict\";\nfunction isColorLike(value) {\n  return Color.isColorLike(value);\n}\nfunction isFillPattern(value) {\n  return value instanceof FillPattern;\n}\nfunction isFillGradient(value) {\n  return value instanceof FillGradient;\n}\nfunction isTexture(value) {\n  return value instanceof Texture;\n}\nfunction handleColorLike(fill, value, defaultStyle) {\n  const temp = Color.shared.setValue(value ?? 0);\n  fill.color = temp.toNumber();\n  fill.alpha = temp.alpha === 1 ? defaultStyle.alpha : temp.alpha;\n  fill.texture = Texture.WHITE;\n  return { ...defaultStyle, ...fill };\n}\nfunction handleTexture(fill, value, defaultStyle) {\n  fill.texture = value;\n  return { ...defaultStyle, ...fill };\n}\nfunction handleFillPattern(fill, value, defaultStyle) {\n  fill.fill = value;\n  fill.color = 16777215;\n  fill.texture = value.texture;\n  fill.matrix = value.transform;\n  return { ...defaultStyle, ...fill };\n}\nfunction handleFillGradient(fill, value, defaultStyle) {\n  value.buildGradient();\n  fill.fill = value;\n  fill.color = 16777215;\n  fill.texture = value.texture;\n  fill.matrix = value.transform;\n  fill.textureSpace = value.textureSpace;\n  return { ...defaultStyle, ...fill };\n}\nfunction handleFillObject(value, defaultStyle) {\n  const style = { ...defaultStyle, ...value };\n  const color = Color.shared.setValue(style.color);\n  style.alpha *= color.alpha;\n  style.color = color.toNumber();\n  return style;\n}\nfunction toFillStyle(value, defaultStyle) {\n  if (value === void 0 || value === null) {\n    return null;\n  }\n  const fill = {};\n  const objectStyle = value;\n  if (isColorLike(value)) {\n    return handleColorLike(fill, value, defaultStyle);\n  } else if (isTexture(value)) {\n    return handleTexture(fill, value, defaultStyle);\n  } else if (isFillPattern(value)) {\n    return handleFillPattern(fill, value, defaultStyle);\n  } else if (isFillGradient(value)) {\n    return handleFillGradient(fill, value, defaultStyle);\n  } else if (objectStyle.fill && isFillPattern(objectStyle.fill)) {\n    return handleFillPattern(objectStyle, objectStyle.fill, defaultStyle);\n  } else if (objectStyle.fill && isFillGradient(objectStyle.fill)) {\n    return handleFillGradient(objectStyle, objectStyle.fill, defaultStyle);\n  }\n  return handleFillObject(objectStyle, defaultStyle);\n}\nfunction toStrokeStyle(value, defaultStyle) {\n  const { width, alignment, miterLimit, cap, join, pixelLine, ...rest } = defaultStyle;\n  const fill = toFillStyle(value, rest);\n  if (!fill) {\n    return null;\n  }\n  return {\n    width,\n    alignment,\n    miterLimit,\n    cap,\n    join,\n    pixelLine,\n    ...fill\n  };\n}\n\nexport { toFillStyle, toStrokeStyle };\n//# sourceMappingURL=convertFillInputToFillStyle.mjs.map\n","import EventEmitter from 'eventemitter3';\nimport { Color } from '../../../color/Color.mjs';\nimport { Matrix } from '../../../maths/matrix/Matrix.mjs';\nimport { Point } from '../../../maths/point/Point.mjs';\nimport { Texture } from '../../../rendering/renderers/shared/texture/Texture.mjs';\nimport { uid } from '../../../utils/data/uid.mjs';\nimport { deprecation, v8_0_0 } from '../../../utils/logging/deprecation.mjs';\nimport { Bounds } from '../../container/bounds/Bounds.mjs';\nimport { GraphicsPath } from './path/GraphicsPath.mjs';\nimport { SVGParser } from './svg/SVGParser.mjs';\nimport { toFillStyle, toStrokeStyle } from './utils/convertFillInputToFillStyle.mjs';\n\n\"use strict\";\nconst tmpPoint = new Point();\nconst tempMatrix = new Matrix();\nconst _GraphicsContext = class _GraphicsContext extends EventEmitter {\n  constructor() {\n    super(...arguments);\n    /**\n     * unique id for this graphics context\n     * @internal\n     */\n    this.uid = uid(\"graphicsContext\");\n    /**\n     * Indicates whether content is updated and have to be re-rendered.\n     * @internal\n     */\n    this.dirty = true;\n    /** The batch mode for this graphics context. It can be 'auto', 'batch', or 'no-batch'. */\n    this.batchMode = \"auto\";\n    /** @internal */\n    this.instructions = [];\n    this._activePath = new GraphicsPath();\n    this._transform = new Matrix();\n    this._fillStyle = { ..._GraphicsContext.defaultFillStyle };\n    this._strokeStyle = { ..._GraphicsContext.defaultStrokeStyle };\n    this._stateStack = [];\n    this._tick = 0;\n    this._bounds = new Bounds();\n    this._boundsDirty = true;\n  }\n  /**\n   * Creates a new GraphicsContext object that is a clone of this instance, copying all properties,\n   * including the current drawing state, transformations, styles, and instructions.\n   * @returns A new GraphicsContext instance with the same properties and state as this one.\n   */\n  clone() {\n    const clone = new _GraphicsContext();\n    clone.batchMode = this.batchMode;\n    clone.instructions = this.instructions.slice();\n    clone._activePath = this._activePath.clone();\n    clone._transform = this._transform.clone();\n    clone._fillStyle = { ...this._fillStyle };\n    clone._strokeStyle = { ...this._strokeStyle };\n    clone._stateStack = this._stateStack.slice();\n    clone._bounds = this._bounds.clone();\n    clone._boundsDirty = true;\n    return clone;\n  }\n  /**\n   * The current fill style of the graphics context. This can be a color, gradient, pattern, or a more complex style defined by a FillStyle object.\n   */\n  get fillStyle() {\n    return this._fillStyle;\n  }\n  set fillStyle(value) {\n    this._fillStyle = toFillStyle(value, _GraphicsContext.defaultFillStyle);\n  }\n  /**\n   * The current stroke style of the graphics context. Similar to fill styles, stroke styles can encompass colors, gradients, patterns, or more detailed configurations via a StrokeStyle object.\n   */\n  get strokeStyle() {\n    return this._strokeStyle;\n  }\n  set strokeStyle(value) {\n    this._strokeStyle = toStrokeStyle(value, _GraphicsContext.defaultStrokeStyle);\n  }\n  /**\n   * Sets the current fill style of the graphics context. The fill style can be a color, gradient,\n   * pattern, or a more complex style defined by a FillStyle object.\n   * @param style - The fill style to apply. This can be a simple color, a gradient or pattern object,\n   *                or a FillStyle or ConvertedFillStyle object.\n   * @returns The instance of the current GraphicsContext for method chaining.\n   */\n  setFillStyle(style) {\n    this._fillStyle = toFillStyle(style, _GraphicsContext.defaultFillStyle);\n    return this;\n  }\n  /**\n   * Sets the current stroke style of the graphics context. Similar to fill styles, stroke styles can\n   * encompass colors, gradients, patterns, or more detailed configurations via a StrokeStyle object.\n   * @param style - The stroke style to apply. Can be defined as a color, a gradient or pattern,\n   *                or a StrokeStyle or ConvertedStrokeStyle object.\n   * @returns The instance of the current GraphicsContext for method chaining.\n   */\n  setStrokeStyle(style) {\n    this._strokeStyle = toFillStyle(style, _GraphicsContext.defaultStrokeStyle);\n    return this;\n  }\n  texture(texture, tint, dx, dy, dw, dh) {\n    this.instructions.push({\n      action: \"texture\",\n      data: {\n        image: texture,\n        dx: dx || 0,\n        dy: dy || 0,\n        dw: dw || texture.frame.width,\n        dh: dh || texture.frame.height,\n        transform: this._transform.clone(),\n        alpha: this._fillStyle.alpha,\n        style: tint ? Color.shared.setValue(tint).toNumber() : 16777215\n      }\n    });\n    this.onUpdate();\n    return this;\n  }\n  /**\n   * Resets the current path. Any previous path and its commands are discarded and a new path is\n   * started. This is typically called before beginning a new shape or series of drawing commands.\n   * @returns The instance of the current GraphicsContext for method chaining.\n   */\n  beginPath() {\n    this._activePath = new GraphicsPath();\n    return this;\n  }\n  fill(style, alpha) {\n    let path;\n    const lastInstruction = this.instructions[this.instructions.length - 1];\n    if (this._tick === 0 && lastInstruction && lastInstruction.action === \"stroke\") {\n      path = lastInstruction.data.path;\n    } else {\n      path = this._activePath.clone();\n    }\n    if (!path)\n      return this;\n    if (style != null) {\n      if (alpha !== void 0 && typeof style === \"number\") {\n        deprecation(v8_0_0, \"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead\");\n        style = { color: style, alpha };\n      }\n      this._fillStyle = toFillStyle(style, _GraphicsContext.defaultFillStyle);\n    }\n    this.instructions.push({\n      action: \"fill\",\n      // TODO copy fill style!\n      data: { style: this.fillStyle, path }\n    });\n    this.onUpdate();\n    this._initNextPathLocation();\n    this._tick = 0;\n    return this;\n  }\n  _initNextPathLocation() {\n    const { x, y } = this._activePath.getLastPoint(Point.shared);\n    this._activePath.clear();\n    this._activePath.moveTo(x, y);\n  }\n  /**\n   * Strokes the current path with the current stroke style. This method can take an optional\n   * FillInput parameter to define the stroke's appearance, including its color, width, and other properties.\n   * @param style - (Optional) The stroke style to apply. Can be defined as a simple color or a more complex style object. If omitted, uses the current stroke style.\n   * @returns The instance of the current GraphicsContext for method chaining.\n   */\n  stroke(style) {\n    let path;\n    const lastInstruction = this.instructions[this.instructions.length - 1];\n    if (this._tick === 0 && lastInstruction && lastInstruction.action === \"fill\") {\n      path = lastInstruction.data.path;\n    } else {\n      path = this._activePath.clone();\n    }\n    if (!path)\n      return this;\n    if (style != null) {\n      this._strokeStyle = toStrokeStyle(style, _GraphicsContext.defaultStrokeStyle);\n    }\n    this.instructions.push({\n      action: \"stroke\",\n      // TODO copy fill style!\n      data: { style: this.strokeStyle, path }\n    });\n    this.onUpdate();\n    this._initNextPathLocation();\n    this._tick = 0;\n    return this;\n  }\n  /**\n   * Applies a cutout to the last drawn shape. This is used to create holes or complex shapes by\n   * subtracting a path from the previously drawn path. If a hole is not completely in a shape, it will\n   * fail to cut correctly!\n   * @returns The instance of the current GraphicsContext for method chaining.\n   */\n  cut() {\n    for (let i = 0; i < 2; i++) {\n      const lastInstruction = this.instructions[this.instructions.length - 1 - i];\n      const holePath = this._activePath.clone();\n      if (lastInstruction) {\n        if (lastInstruction.action === \"stroke\" || lastInstruction.action === \"fill\") {\n          if (lastInstruction.data.hole) {\n            lastInstruction.data.hole.addPath(holePath);\n          } else {\n            lastInstruction.data.hole = holePath;\n            break;\n          }\n        }\n      }\n    }\n    this._initNextPathLocation();\n    return this;\n  }\n  /**\n   * Adds an arc to the current path, which is centered at (x, y) with the specified radius,\n   * starting and ending angles, and direction.\n   * @param x - The x-coordinate of the arc's center.\n   * @param y - The y-coordinate of the arc's center.\n   * @param radius - The arc's radius.\n   * @param startAngle - The starting angle, in radians.\n   * @param endAngle - The ending angle, in radians.\n   * @param counterclockwise - (Optional) Specifies whether the arc is drawn counterclockwise (true) or clockwise (false). Defaults to false.\n   * @returns The instance of the current GraphicsContext for method chaining.\n   */\n  arc(x, y, radius, startAngle, endAngle, counterclockwise) {\n    this._tick++;\n    const t = this._transform;\n    this._activePath.arc(\n      t.a * x + t.c * y + t.tx,\n      t.b * x + t.d * y + t.ty,\n      radius,\n      startAngle,\n      endAngle,\n      counterclockwise\n    );\n    return this;\n  }\n  /**\n   * Adds an arc to the current path with the given control points and radius, connected to the previous point\n   * by a straight line if necessary.\n   * @param x1 - The x-coordinate of the first control point.\n   * @param y1 - The y-coordinate of the first control point.\n   * @param x2 - The x-coordinate of the second control point.\n   * @param y2 - The y-coordinate of the second control point.\n   * @param radius - The arc's radius.\n   * @returns The instance of the current GraphicsContext for method chaining.\n   */\n  arcTo(x1, y1, x2, y2, radius) {\n    this._tick++;\n    const t = this._transform;\n    this._activePath.arcTo(\n      t.a * x1 + t.c * y1 + t.tx,\n      t.b * x1 + t.d * y1 + t.ty,\n      t.a * x2 + t.c * y2 + t.tx,\n      t.b * x2 + t.d * y2 + t.ty,\n      radius\n    );\n    return this;\n  }\n  /**\n   * Adds an SVG-style arc to the path, allowing for elliptical arcs based on the SVG spec.\n   * @param rx - The x-radius of the ellipse.\n   * @param ry - The y-radius of the ellipse.\n   * @param xAxisRotation - The rotation of the ellipse's x-axis relative\n   * to the x-axis of the coordinate system, in degrees.\n   * @param largeArcFlag - Determines if the arc should be greater than or less than 180 degrees.\n   * @param sweepFlag - Determines if the arc should be swept in a positive angle direction.\n   * @param x - The x-coordinate of the arc's end point.\n   * @param y - The y-coordinate of the arc's end point.\n   * @returns The instance of the current object for chaining.\n   */\n  arcToSvg(rx, ry, xAxisRotation, largeArcFlag, sweepFlag, x, y) {\n    this._tick++;\n    const t = this._transform;\n    this._activePath.arcToSvg(\n      rx,\n      ry,\n      xAxisRotation,\n      // should we rotate this with transform??\n      largeArcFlag,\n      sweepFlag,\n      t.a * x + t.c * y + t.tx,\n      t.b * x + t.d * y + t.ty\n    );\n    return this;\n  }\n  /**\n   * Adds a cubic Bezier curve to the path.\n   * It requires three points: the first two are control points and the third one is the end point.\n   * The starting point is the last point in the current path.\n   * @param cp1x - The x-coordinate of the first control point.\n   * @param cp1y - The y-coordinate of the first control point.\n   * @param cp2x - The x-coordinate of the second control point.\n   * @param cp2y - The y-coordinate of the second control point.\n   * @param x - The x-coordinate of the end point.\n   * @param y - The y-coordinate of the end point.\n   * @param smoothness - Optional parameter to adjust the smoothness of the curve.\n   * @returns The instance of the current object for chaining.\n   */\n  bezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y, smoothness) {\n    this._tick++;\n    const t = this._transform;\n    this._activePath.bezierCurveTo(\n      t.a * cp1x + t.c * cp1y + t.tx,\n      t.b * cp1x + t.d * cp1y + t.ty,\n      t.a * cp2x + t.c * cp2y + t.tx,\n      t.b * cp2x + t.d * cp2y + t.ty,\n      t.a * x + t.c * y + t.tx,\n      t.b * x + t.d * y + t.ty,\n      smoothness\n    );\n    return this;\n  }\n  /**\n   * Closes the current path by drawing a straight line back to the start.\n   * If the shape is already closed or there are no points in the path, this method does nothing.\n   * @returns The instance of the current object for chaining.\n   */\n  closePath() {\n    this._tick++;\n    this._activePath?.closePath();\n    return this;\n  }\n  /**\n   * Draws an ellipse at the specified location and with the given x and y radii.\n   * An optional transformation can be applied, allowing for rotation, scaling, and translation.\n   * @param x - The x-coordinate of the center of the ellipse.\n   * @param y - The y-coordinate of the center of the ellipse.\n   * @param radiusX - The horizontal radius of the ellipse.\n   * @param radiusY - The vertical radius of the ellipse.\n   * @returns The instance of the current object for chaining.\n   */\n  ellipse(x, y, radiusX, radiusY) {\n    this._tick++;\n    this._activePath.ellipse(x, y, radiusX, radiusY, this._transform.clone());\n    return this;\n  }\n  /**\n   * Draws a circle shape. This method adds a new circle path to the current drawing.\n   * @param x - The x-coordinate of the center of the circle.\n   * @param y - The y-coordinate of the center of the circle.\n   * @param radius - The radius of the circle.\n   * @returns The instance of the current object for chaining.\n   */\n  circle(x, y, radius) {\n    this._tick++;\n    this._activePath.circle(x, y, radius, this._transform.clone());\n    return this;\n  }\n  /**\n   * Adds another `GraphicsPath` to this path, optionally applying a transformation.\n   * @param path - The `GraphicsPath` to add.\n   * @returns The instance of the current object for chaining.\n   */\n  path(path) {\n    this._tick++;\n    this._activePath.addPath(path, this._transform.clone());\n    return this;\n  }\n  /**\n   * Connects the current point to a new point with a straight line. This method updates the current path.\n   * @param x - The x-coordinate of the new point to connect to.\n   * @param y - The y-coordinate of the new point to connect to.\n   * @returns The instance of the current object for chaining.\n   */\n  lineTo(x, y) {\n    this._tick++;\n    const t = this._transform;\n    this._activePath.lineTo(\n      t.a * x + t.c * y + t.tx,\n      t.b * x + t.d * y + t.ty\n    );\n    return this;\n  }\n  /**\n   * Sets the starting point for a new sub-path. Any subsequent drawing commands are considered part of this path.\n   * @param x - The x-coordinate for the starting point.\n   * @param y - The y-coordinate for the starting point.\n   * @returns The instance of the current object for chaining.\n   */\n  moveTo(x, y) {\n    this._tick++;\n    const t = this._transform;\n    const instructions = this._activePath.instructions;\n    const transformedX = t.a * x + t.c * y + t.tx;\n    const transformedY = t.b * x + t.d * y + t.ty;\n    if (instructions.length === 1 && instructions[0].action === \"moveTo\") {\n      instructions[0].data[0] = transformedX;\n      instructions[0].data[1] = transformedY;\n      return this;\n    }\n    this._activePath.moveTo(\n      transformedX,\n      transformedY\n    );\n    return this;\n  }\n  /**\n   * Adds a quadratic curve to the path. It requires two points: the control point and the end point.\n   * The starting point is the last point in the current path.\n   * @param cpx - The x-coordinate of the control point.\n   * @param cpy - The y-coordinate of the control point.\n   * @param x - The x-coordinate of the end point.\n   * @param y - The y-coordinate of the end point.\n   * @param smoothness - Optional parameter to adjust the smoothness of the curve.\n   * @returns The instance of the current object for chaining.\n   */\n  quadraticCurveTo(cpx, cpy, x, y, smoothness) {\n    this._tick++;\n    const t = this._transform;\n    this._activePath.quadraticCurveTo(\n      t.a * cpx + t.c * cpy + t.tx,\n      t.b * cpx + t.d * cpy + t.ty,\n      t.a * x + t.c * y + t.tx,\n      t.b * x + t.d * y + t.ty,\n      smoothness\n    );\n    return this;\n  }\n  /**\n   * Draws a rectangle shape. This method adds a new rectangle path to the current drawing.\n   * @param x - The x-coordinate of the top-left corner of the rectangle.\n   * @param y - The y-coordinate of the top-left corner of the rectangle.\n   * @param w - The width of the rectangle.\n   * @param h - The height of the rectangle.\n   * @returns The instance of the current object for chaining.\n   */\n  rect(x, y, w, h) {\n    this._tick++;\n    this._activePath.rect(x, y, w, h, this._transform.clone());\n    return this;\n  }\n  /**\n   * Draws a rectangle with rounded corners.\n   * The corner radius can be specified to determine how rounded the corners should be.\n   * An optional transformation can be applied, which allows for rotation, scaling, and translation of the rectangle.\n   * @param x - The x-coordinate of the top-left corner of the rectangle.\n   * @param y - The y-coordinate of the top-left corner of the rectangle.\n   * @param w - The width of the rectangle.\n   * @param h - The height of the rectangle.\n   * @param radius - The radius of the rectangle's corners. If not specified, corners will be sharp.\n   * @returns The instance of the current object for chaining.\n   */\n  roundRect(x, y, w, h, radius) {\n    this._tick++;\n    this._activePath.roundRect(x, y, w, h, radius, this._transform.clone());\n    return this;\n  }\n  /**\n   * Draws a polygon shape by specifying a sequence of points. This method allows for the creation of complex polygons,\n   * which can be both open and closed. An optional transformation can be applied, enabling the polygon to be scaled,\n   * rotated, or translated as needed.\n   * @param points - An array of numbers, or an array of PointData objects eg [{x,y}, {x,y}, {x,y}]\n   * representing the x and y coordinates, of the polygon's vertices, in sequence.\n   * @param close - A boolean indicating whether to close the polygon path. True by default.\n   */\n  poly(points, close) {\n    this._tick++;\n    this._activePath.poly(points, close, this._transform.clone());\n    return this;\n  }\n  /**\n   * Draws a regular polygon with a specified number of sides. All sides and angles are equal.\n   * @param x - The x-coordinate of the center of the polygon.\n   * @param y - The y-coordinate of the center of the polygon.\n   * @param radius - The radius of the circumscribed circle of the polygon.\n   * @param sides - The number of sides of the polygon. Must be 3 or more.\n   * @param rotation - The rotation angle of the polygon, in radians. Zero by default.\n   * @param transform - An optional `Matrix` object to apply a transformation to the polygon.\n   * @returns The instance of the current object for chaining.\n   */\n  regularPoly(x, y, radius, sides, rotation = 0, transform) {\n    this._tick++;\n    this._activePath.regularPoly(x, y, radius, sides, rotation, transform);\n    return this;\n  }\n  /**\n   * Draws a polygon with rounded corners.\n   * Similar to `regularPoly` but with the ability to round the corners of the polygon.\n   * @param x - The x-coordinate of the center of the polygon.\n   * @param y - The y-coordinate of the center of the polygon.\n   * @param radius - The radius of the circumscribed circle of the polygon.\n   * @param sides - The number of sides of the polygon. Must be 3 or more.\n   * @param corner - The radius of the rounding of the corners.\n   * @param rotation - The rotation angle of the polygon, in radians. Zero by default.\n   * @returns The instance of the current object for chaining.\n   */\n  roundPoly(x, y, radius, sides, corner, rotation) {\n    this._tick++;\n    this._activePath.roundPoly(x, y, radius, sides, corner, rotation);\n    return this;\n  }\n  /**\n   * Draws a shape with rounded corners. This function supports custom radius for each corner of the shape.\n   * Optionally, corners can be rounded using a quadratic curve instead of an arc, providing a different aesthetic.\n   * @param points - An array of `RoundedPoint` representing the corners of the shape to draw.\n   * A minimum of 3 points is required.\n   * @param radius - The default radius for the corners.\n   * This radius is applied to all corners unless overridden in `points`.\n   * @param useQuadratic - If set to true, rounded corners are drawn using a quadraticCurve\n   *  method instead of an arc method. Defaults to false.\n   * @param smoothness - Specifies the smoothness of the curve when `useQuadratic` is true.\n   * Higher values make the curve smoother.\n   * @returns The instance of the current object for chaining.\n   */\n  roundShape(points, radius, useQuadratic, smoothness) {\n    this._tick++;\n    this._activePath.roundShape(points, radius, useQuadratic, smoothness);\n    return this;\n  }\n  /**\n   * Draw Rectangle with fillet corners. This is much like rounded rectangle\n   * however it support negative numbers as well for the corner radius.\n   * @param x - Upper left corner of rect\n   * @param y - Upper right corner of rect\n   * @param width - Width of rect\n   * @param height - Height of rect\n   * @param fillet - accept negative or positive values\n   */\n  filletRect(x, y, width, height, fillet) {\n    this._tick++;\n    this._activePath.filletRect(x, y, width, height, fillet);\n    return this;\n  }\n  /**\n   * Draw Rectangle with chamfer corners. These are angled corners.\n   * @param x - Upper left corner of rect\n   * @param y - Upper right corner of rect\n   * @param width - Width of rect\n   * @param height - Height of rect\n   * @param chamfer - non-zero real number, size of corner cutout\n   * @param transform\n   */\n  chamferRect(x, y, width, height, chamfer, transform) {\n    this._tick++;\n    this._activePath.chamferRect(x, y, width, height, chamfer, transform);\n    return this;\n  }\n  /**\n   * Draws a star shape centered at a specified location. This method allows for the creation\n   *  of stars with a variable number of points, outer radius, optional inner radius, and rotation.\n   * The star is drawn as a closed polygon with alternating outer and inner vertices to create the star's points.\n   * An optional transformation can be applied to scale, rotate, or translate the star as needed.\n   * @param x - The x-coordinate of the center of the star.\n   * @param y - The y-coordinate of the center of the star.\n   * @param points - The number of points of the star.\n   * @param radius - The outer radius of the star (distance from the center to the outer points).\n   * @param innerRadius - Optional. The inner radius of the star\n   * (distance from the center to the inner points between the outer points).\n   * If not provided, defaults to half of the `radius`.\n   * @param rotation - Optional. The rotation of the star in radians, where 0 is aligned with the y-axis.\n   * Defaults to 0, meaning one point is directly upward.\n   * @returns The instance of the current object for chaining further drawing commands.\n   */\n  star(x, y, points, radius, innerRadius = 0, rotation = 0) {\n    this._tick++;\n    this._activePath.star(x, y, points, radius, innerRadius, rotation, this._transform.clone());\n    return this;\n  }\n  /**\n   * Parses and renders an SVG string into the graphics context. This allows for complex shapes and paths\n   * defined in SVG format to be drawn within the graphics context.\n   * @param svg - The SVG string to be parsed and rendered.\n   */\n  svg(svg) {\n    this._tick++;\n    SVGParser(svg, this);\n    return this;\n  }\n  /**\n   * Restores the most recently saved graphics state by popping the top of the graphics state stack.\n   * This includes transformations, fill styles, and stroke styles.\n   */\n  restore() {\n    const state = this._stateStack.pop();\n    if (state) {\n      this._transform = state.transform;\n      this._fillStyle = state.fillStyle;\n      this._strokeStyle = state.strokeStyle;\n    }\n    return this;\n  }\n  /** Saves the current graphics state, including transformations, fill styles, and stroke styles, onto a stack. */\n  save() {\n    this._stateStack.push({\n      transform: this._transform.clone(),\n      fillStyle: { ...this._fillStyle },\n      strokeStyle: { ...this._strokeStyle }\n    });\n    return this;\n  }\n  /**\n   * Returns the current transformation matrix of the graphics context.\n   * @returns The current transformation matrix.\n   */\n  getTransform() {\n    return this._transform;\n  }\n  /**\n   * Resets the current transformation matrix to the identity matrix, effectively removing any transformations (rotation, scaling, translation) previously applied.\n   * @returns The instance of the current GraphicsContext for method chaining.\n   */\n  resetTransform() {\n    this._transform.identity();\n    return this;\n  }\n  /**\n   * Applies a rotation transformation to the graphics context around the current origin.\n   * @param angle - The angle of rotation in radians.\n   * @returns The instance of the current GraphicsContext for method chaining.\n   */\n  rotate(angle) {\n    this._transform.rotate(angle);\n    return this;\n  }\n  /**\n   * Applies a scaling transformation to the graphics context, scaling drawings by x horizontally and by y vertically.\n   * @param x - The scale factor in the horizontal direction.\n   * @param y - (Optional) The scale factor in the vertical direction. If not specified, the x value is used for both directions.\n   * @returns The instance of the current GraphicsContext for method chaining.\n   */\n  scale(x, y = x) {\n    this._transform.scale(x, y);\n    return this;\n  }\n  setTransform(a, b, c, d, dx, dy) {\n    if (a instanceof Matrix) {\n      this._transform.set(a.a, a.b, a.c, a.d, a.tx, a.ty);\n      return this;\n    }\n    this._transform.set(a, b, c, d, dx, dy);\n    return this;\n  }\n  transform(a, b, c, d, dx, dy) {\n    if (a instanceof Matrix) {\n      this._transform.append(a);\n      return this;\n    }\n    tempMatrix.set(a, b, c, d, dx, dy);\n    this._transform.append(tempMatrix);\n    return this;\n  }\n  /**\n   * Applies a translation transformation to the graphics context, moving the origin by the specified amounts.\n   * @param x - The amount to translate in the horizontal direction.\n   * @param y - (Optional) The amount to translate in the vertical direction. If not specified, the x value is used for both directions.\n   * @returns The instance of the current GraphicsContext for method chaining.\n   */\n  translate(x, y = x) {\n    this._transform.translate(x, y);\n    return this;\n  }\n  /**\n   * Clears all drawing commands from the graphics context, effectively resetting it. This includes clearing the path,\n   * and optionally resetting transformations to the identity matrix.\n   * @returns The instance of the current GraphicsContext for method chaining.\n   */\n  clear() {\n    this._activePath.clear();\n    this.instructions.length = 0;\n    this.resetTransform();\n    this.onUpdate();\n    return this;\n  }\n  onUpdate() {\n    this._boundsDirty = true;\n    if (this.dirty)\n      return;\n    this.emit(\"update\", this, 16);\n    this.dirty = true;\n  }\n  /** The bounds of the graphic shape. */\n  get bounds() {\n    if (!this._boundsDirty)\n      return this._bounds;\n    this._boundsDirty = false;\n    const bounds = this._bounds;\n    bounds.clear();\n    for (let i = 0; i < this.instructions.length; i++) {\n      const instruction = this.instructions[i];\n      const action = instruction.action;\n      if (action === \"fill\") {\n        const data = instruction.data;\n        bounds.addBounds(data.path.bounds);\n      } else if (action === \"texture\") {\n        const data = instruction.data;\n        bounds.addFrame(data.dx, data.dy, data.dx + data.dw, data.dy + data.dh, data.transform);\n      }\n      if (action === \"stroke\") {\n        const data = instruction.data;\n        const alignment = data.style.alignment;\n        const outerPadding = data.style.width * (1 - alignment);\n        const _bounds = data.path.bounds;\n        bounds.addFrame(\n          _bounds.minX - outerPadding,\n          _bounds.minY - outerPadding,\n          _bounds.maxX + outerPadding,\n          _bounds.maxY + outerPadding\n        );\n      }\n    }\n    return bounds;\n  }\n  /**\n   * Check to see if a point is contained within this geometry.\n   * @param point - Point to check if it's contained.\n   * @returns {boolean} `true` if the point is contained within geometry.\n   */\n  containsPoint(point) {\n    if (!this.bounds.containsPoint(point.x, point.y))\n      return false;\n    const instructions = this.instructions;\n    let hasHit = false;\n    for (let k = 0; k < instructions.length; k++) {\n      const instruction = instructions[k];\n      const data = instruction.data;\n      const path = data.path;\n      if (!instruction.action || !path)\n        continue;\n      const style = data.style;\n      const shapes = path.shapePath.shapePrimitives;\n      for (let i = 0; i < shapes.length; i++) {\n        const shape = shapes[i].shape;\n        if (!style || !shape)\n          continue;\n        const transform = shapes[i].transform;\n        const transformedPoint = transform ? transform.applyInverse(point, tmpPoint) : point;\n        if (instruction.action === \"fill\") {\n          hasHit = shape.contains(transformedPoint.x, transformedPoint.y);\n        } else {\n          const strokeStyle = style;\n          hasHit = shape.strokeContains(transformedPoint.x, transformedPoint.y, strokeStyle.width, strokeStyle.alignment);\n        }\n        const holes = data.hole;\n        if (holes) {\n          const holeShapes = holes.shapePath?.shapePrimitives;\n          if (holeShapes) {\n            for (let j = 0; j < holeShapes.length; j++) {\n              if (holeShapes[j].shape.contains(transformedPoint.x, transformedPoint.y)) {\n                hasHit = false;\n              }\n            }\n          }\n        }\n        if (hasHit) {\n          return true;\n        }\n      }\n    }\n    return hasHit;\n  }\n  /**\n   * Destroys the GraphicsData object.\n   * @param options - Options parameter. A boolean will act as if all options\n   *  have been set to that value\n   * @example\n   * context.destroy();\n   * context.destroy(true);\n   * context.destroy({ texture: true, textureSource: true });\n   */\n  destroy(options = false) {\n    this._stateStack.length = 0;\n    this._transform = null;\n    this.emit(\"destroy\", this);\n    this.removeAllListeners();\n    const destroyTexture = typeof options === \"boolean\" ? options : options?.texture;\n    if (destroyTexture) {\n      const destroyTextureSource = typeof options === \"boolean\" ? options : options?.textureSource;\n      if (this._fillStyle.texture) {\n        this._fillStyle.fill && \"uid\" in this._fillStyle.fill ? this._fillStyle.fill.destroy() : this._fillStyle.texture.destroy(destroyTextureSource);\n      }\n      if (this._strokeStyle.texture) {\n        this._strokeStyle.fill && \"uid\" in this._strokeStyle.fill ? this._strokeStyle.fill.destroy() : this._strokeStyle.texture.destroy(destroyTextureSource);\n      }\n    }\n    this._fillStyle = null;\n    this._strokeStyle = null;\n    this.instructions = null;\n    this._activePath = null;\n    this._bounds = null;\n    this._stateStack = null;\n    this.customShader = null;\n    this._transform = null;\n  }\n};\n/** The default fill style to use when none is provided. */\n_GraphicsContext.defaultFillStyle = {\n  /** The color to use for the fill. */\n  color: 16777215,\n  /** The alpha value to use for the fill. */\n  alpha: 1,\n  /** The texture to use for the fill. */\n  texture: Texture.WHITE,\n  /** The matrix to apply. */\n  matrix: null,\n  /** The fill pattern to use. */\n  fill: null,\n  /** Whether coordinates are 'global' or 'local' */\n  textureSpace: \"local\"\n};\n/** The default stroke style to use when none is provided. */\n_GraphicsContext.defaultStrokeStyle = {\n  /** The width of the stroke. */\n  width: 1,\n  /** The color to use for the stroke. */\n  color: 16777215,\n  /** The alpha value to use for the stroke. */\n  alpha: 1,\n  /** The alignment of the stroke. */\n  alignment: 0.5,\n  /** The miter limit to use. */\n  miterLimit: 10,\n  /** The line cap style to use. */\n  cap: \"butt\",\n  /** The line join style to use. */\n  join: \"miter\",\n  /** The texture to use for the fill. */\n  texture: Texture.WHITE,\n  /** The matrix to apply. */\n  matrix: null,\n  /** The fill pattern to use. */\n  fill: null,\n  /** Whether coordinates are 'global' or 'local' */\n  textureSpace: \"local\",\n  /** If the stroke is a pixel line. */\n  pixelLine: false\n};\nlet GraphicsContext = _GraphicsContext;\n\nexport { GraphicsContext };\n//# sourceMappingURL=GraphicsContext.mjs.map\n","import EventEmitter from 'eventemitter3';\nimport { Color } from '../../color/Color.mjs';\nimport { uid } from '../../utils/data/uid.mjs';\nimport { deprecation, v8_0_0 } from '../../utils/logging/deprecation.mjs';\nimport { warn } from '../../utils/logging/warn.mjs';\nimport { FillGradient } from '../graphics/shared/fill/FillGradient.mjs';\nimport { FillPattern } from '../graphics/shared/fill/FillPattern.mjs';\nimport { GraphicsContext } from '../graphics/shared/GraphicsContext.mjs';\nimport { toFillStyle, toStrokeStyle } from '../graphics/shared/utils/convertFillInputToFillStyle.mjs';\n\n\"use strict\";\nconst _TextStyle = class _TextStyle extends EventEmitter {\n  constructor(style = {}) {\n    super();\n    /**\n     * Unique identifier for the TextStyle class.\n     * This is used to track instances and ensure uniqueness.\n     * @internal\n     */\n    this.uid = uid(\"textStyle\");\n    /**\n     * Internal tick counter used to track updates and changes.\n     * This is incremented whenever the style is modified, allowing for efficient change detection.\n     * @internal\n     */\n    this._tick = 0;\n    convertV7Tov8Style(style);\n    const fullStyle = { ..._TextStyle.defaultTextStyle, ...style };\n    for (const key in fullStyle) {\n      const thisKey = key;\n      this[thisKey] = fullStyle[key];\n    }\n    this.update();\n    this._tick = 0;\n  }\n  /**\n   * Alignment for multiline text, does not affect single line text.\n   * @type {'left'|'center'|'right'|'justify'}\n   */\n  get align() {\n    return this._align;\n  }\n  set align(value) {\n    if (this._align === value)\n      return;\n    this._align = value;\n    this.update();\n  }\n  /** Indicates if lines can be wrapped within words, it needs wordWrap to be set to true. */\n  get breakWords() {\n    return this._breakWords;\n  }\n  set breakWords(value) {\n    if (this._breakWords === value)\n      return;\n    this._breakWords = value;\n    this.update();\n  }\n  /** Set a drop shadow for the text. */\n  get dropShadow() {\n    return this._dropShadow;\n  }\n  set dropShadow(value) {\n    if (this._dropShadow === value)\n      return;\n    if (value !== null && typeof value === \"object\") {\n      this._dropShadow = this._createProxy({ ..._TextStyle.defaultDropShadow, ...value });\n    } else {\n      this._dropShadow = value ? this._createProxy({ ..._TextStyle.defaultDropShadow }) : null;\n    }\n    this.update();\n  }\n  /** The font family, can be a single font name, or a list of names where the first is the preferred font. */\n  get fontFamily() {\n    return this._fontFamily;\n  }\n  set fontFamily(value) {\n    if (this._fontFamily === value)\n      return;\n    this._fontFamily = value;\n    this.update();\n  }\n  /** The font size (as a number it converts to px, but as a string, equivalents are '26px','20pt','160%' or '1.6em') */\n  get fontSize() {\n    return this._fontSize;\n  }\n  set fontSize(value) {\n    if (this._fontSize === value)\n      return;\n    if (typeof value === \"string\") {\n      this._fontSize = parseInt(value, 10);\n    } else {\n      this._fontSize = value;\n    }\n    this.update();\n  }\n  /**\n   * The font style.\n   * @type {'normal'|'italic'|'oblique'}\n   */\n  get fontStyle() {\n    return this._fontStyle;\n  }\n  set fontStyle(value) {\n    if (this._fontStyle === value)\n      return;\n    this._fontStyle = value.toLowerCase();\n    this.update();\n  }\n  /**\n   * The font variant.\n   * @type {'normal'|'small-caps'}\n   */\n  get fontVariant() {\n    return this._fontVariant;\n  }\n  set fontVariant(value) {\n    if (this._fontVariant === value)\n      return;\n    this._fontVariant = value;\n    this.update();\n  }\n  /**\n   * The font weight.\n   * @type {'normal'|'bold'|'bolder'|'lighter'|'100'|'200'|'300'|'400'|'500'|'600'|'700'|'800'|'900'}\n   */\n  get fontWeight() {\n    return this._fontWeight;\n  }\n  set fontWeight(value) {\n    if (this._fontWeight === value)\n      return;\n    this._fontWeight = value;\n    this.update();\n  }\n  /** The space between lines. */\n  get leading() {\n    return this._leading;\n  }\n  set leading(value) {\n    if (this._leading === value)\n      return;\n    this._leading = value;\n    this.update();\n  }\n  /** The amount of spacing between letters, default is 0. */\n  get letterSpacing() {\n    return this._letterSpacing;\n  }\n  set letterSpacing(value) {\n    if (this._letterSpacing === value)\n      return;\n    this._letterSpacing = value;\n    this.update();\n  }\n  /** The line height, a number that represents the vertical space that a letter uses. */\n  get lineHeight() {\n    return this._lineHeight;\n  }\n  set lineHeight(value) {\n    if (this._lineHeight === value)\n      return;\n    this._lineHeight = value;\n    this.update();\n  }\n  /**\n   * Occasionally some fonts are cropped. Adding some padding will prevent this from happening\n   * by adding padding to all sides of the text.\n   * > [!NOTE] This will NOT affect the positioning or bounds of the text.\n   */\n  get padding() {\n    return this._padding;\n  }\n  set padding(value) {\n    if (this._padding === value)\n      return;\n    this._padding = value;\n    this.update();\n  }\n  /**\n   * An optional filter or array of filters to apply to the text, allowing for advanced visual effects.\n   * These filters will be applied to the text as it is created, resulting in faster rendering for static text\n   * compared to applying the filter directly to the text object (which would be applied at run time).\n   * @default null\n   */\n  get filters() {\n    return this._filters;\n  }\n  set filters(value) {\n    if (this._filters === value)\n      return;\n    this._filters = Object.freeze(value);\n    this.update();\n  }\n  /**\n   * Trim transparent borders from the text texture.\n   * > [!IMPORTANT] PERFORMANCE WARNING:\n   * > This is a costly operation as it requires scanning pixel alpha values.\n   * > Avoid using `trim: true` for dynamic text, as it could significantly impact performance.\n   */\n  get trim() {\n    return this._trim;\n  }\n  set trim(value) {\n    if (this._trim === value)\n      return;\n    this._trim = value;\n    this.update();\n  }\n  /**\n   * The baseline of the text that is rendered.\n   * @type {'alphabetic'|'top'|'hanging'|'middle'|'ideographic'|'bottom'}\n   */\n  get textBaseline() {\n    return this._textBaseline;\n  }\n  set textBaseline(value) {\n    if (this._textBaseline === value)\n      return;\n    this._textBaseline = value;\n    this.update();\n  }\n  /**\n   * How newlines and spaces should be handled.\n   * Default is 'pre' (preserve, preserve).\n   *\n   *  value       | New lines     |   Spaces\n   *  ---         | ---           |   ---\n   * 'normal'     | Collapse      |   Collapse\n   * 'pre'        | Preserve      |   Preserve\n   * 'pre-line'   | Preserve      |   Collapse\n   * @type {'normal'|'pre'|'pre-line'}\n   */\n  get whiteSpace() {\n    return this._whiteSpace;\n  }\n  set whiteSpace(value) {\n    if (this._whiteSpace === value)\n      return;\n    this._whiteSpace = value;\n    this.update();\n  }\n  /** Indicates if word wrap should be used. */\n  get wordWrap() {\n    return this._wordWrap;\n  }\n  set wordWrap(value) {\n    if (this._wordWrap === value)\n      return;\n    this._wordWrap = value;\n    this.update();\n  }\n  /** The width at which text will wrap, it needs wordWrap to be set to true. */\n  get wordWrapWidth() {\n    return this._wordWrapWidth;\n  }\n  set wordWrapWidth(value) {\n    if (this._wordWrapWidth === value)\n      return;\n    this._wordWrapWidth = value;\n    this.update();\n  }\n  /**\n   * The fill style that will be used to color the text.\n   * This can be:\n   * - A color string like 'red', '#00FF00', or 'rgba(255,0,0,0.5)'\n   * - A hex number like 0xff0000 for red\n   * - A FillStyle object with properties like { color: 0xff0000, alpha: 0.5 }\n   * - A FillGradient for gradient fills\n   * - A FillPattern for pattern/texture fills\n   *\n   * When using a FillGradient, vertical gradients (angle of 90 degrees) are applied per line of text,\n   * while gradients at any other angle are spread across the entire text body as a whole.\n   * @example\n   * // Vertical gradient applied per line\n   * const verticalGradient = new FillGradient(0, 0, 0, 1)\n   *     .addColorStop(0, 0xff0000)\n   *     .addColorStop(1, 0x0000ff);\n   *\n   * const text = new Text({\n   *     text: 'Line 1\\nLine 2',\n   *     style: { fill: verticalGradient }\n   * });\n   *\n   * To manage the gradient in a global scope, set the textureSpace property of the FillGradient to 'global'.\n   * @type {string|number|FillStyle|FillGradient|FillPattern}\n   */\n  get fill() {\n    return this._originalFill;\n  }\n  set fill(value) {\n    if (value === this._originalFill)\n      return;\n    this._originalFill = value;\n    if (this._isFillStyle(value)) {\n      this._originalFill = this._createProxy({ ...GraphicsContext.defaultFillStyle, ...value }, () => {\n        this._fill = toFillStyle(\n          { ...this._originalFill },\n          GraphicsContext.defaultFillStyle\n        );\n      });\n    }\n    this._fill = toFillStyle(\n      value === 0 ? \"black\" : value,\n      GraphicsContext.defaultFillStyle\n    );\n    this.update();\n  }\n  /** A fillstyle that will be used on the text stroke, e.g., 'blue', '#FCFF00'. */\n  get stroke() {\n    return this._originalStroke;\n  }\n  set stroke(value) {\n    if (value === this._originalStroke)\n      return;\n    this._originalStroke = value;\n    if (this._isFillStyle(value)) {\n      this._originalStroke = this._createProxy({ ...GraphicsContext.defaultStrokeStyle, ...value }, () => {\n        this._stroke = toStrokeStyle(\n          { ...this._originalStroke },\n          GraphicsContext.defaultStrokeStyle\n        );\n      });\n    }\n    this._stroke = toStrokeStyle(value, GraphicsContext.defaultStrokeStyle);\n    this.update();\n  }\n  update() {\n    this._tick++;\n    this.emit(\"update\", this);\n  }\n  /** Resets all properties to the default values */\n  reset() {\n    const defaultStyle = _TextStyle.defaultTextStyle;\n    for (const key in defaultStyle) {\n      this[key] = defaultStyle[key];\n    }\n  }\n  /**\n   * Returns a unique key for this instance.\n   * This key is used for caching.\n   * @returns {string} Unique key for the instance\n   */\n  get styleKey() {\n    return `${this.uid}-${this._tick}`;\n  }\n  /**\n   * Creates a new TextStyle object with the same values as this one.\n   * @returns New cloned TextStyle object\n   */\n  clone() {\n    return new _TextStyle({\n      align: this.align,\n      breakWords: this.breakWords,\n      dropShadow: this._dropShadow ? { ...this._dropShadow } : null,\n      fill: this._fill,\n      fontFamily: this.fontFamily,\n      fontSize: this.fontSize,\n      fontStyle: this.fontStyle,\n      fontVariant: this.fontVariant,\n      fontWeight: this.fontWeight,\n      leading: this.leading,\n      letterSpacing: this.letterSpacing,\n      lineHeight: this.lineHeight,\n      padding: this.padding,\n      stroke: this._stroke,\n      textBaseline: this.textBaseline,\n      whiteSpace: this.whiteSpace,\n      wordWrap: this.wordWrap,\n      wordWrapWidth: this.wordWrapWidth,\n      filters: this._filters ? [...this._filters] : void 0\n    });\n  }\n  /**\n   * Returns the final padding for the text style, taking into account any filters applied.\n   * Used internally for correct measurements\n   * @internal\n   * @returns {number} The final padding for the text style.\n   */\n  _getFinalPadding() {\n    let filterPadding = 0;\n    if (this._filters) {\n      for (let i = 0; i < this._filters.length; i++) {\n        filterPadding += this._filters[i].padding;\n      }\n    }\n    return Math.max(this._padding, filterPadding);\n  }\n  /**\n   * Destroys this text style.\n   * @param options - Options parameter. A boolean will act as if all options\n   *  have been set to that value\n   * @example\n   * // Destroy the text style and its textures\n   * textStyle.destroy({ texture: true, textureSource: true });\n   * textStyle.destroy(true);\n   */\n  destroy(options = false) {\n    this.removeAllListeners();\n    const destroyTexture = typeof options === \"boolean\" ? options : options?.texture;\n    if (destroyTexture) {\n      const destroyTextureSource = typeof options === \"boolean\" ? options : options?.textureSource;\n      if (this._fill?.texture) {\n        this._fill.texture.destroy(destroyTextureSource);\n      }\n      if (this._originalFill?.texture) {\n        this._originalFill.texture.destroy(destroyTextureSource);\n      }\n      if (this._stroke?.texture) {\n        this._stroke.texture.destroy(destroyTextureSource);\n      }\n      if (this._originalStroke?.texture) {\n        this._originalStroke.texture.destroy(destroyTextureSource);\n      }\n    }\n    this._fill = null;\n    this._stroke = null;\n    this.dropShadow = null;\n    this._originalStroke = null;\n    this._originalFill = null;\n  }\n  _createProxy(value, cb) {\n    return new Proxy(value, {\n      set: (target, property, newValue) => {\n        if (target[property] === newValue)\n          return true;\n        target[property] = newValue;\n        cb?.(property, newValue);\n        this.update();\n        return true;\n      }\n    });\n  }\n  _isFillStyle(value) {\n    return (value ?? null) !== null && !(Color.isColorLike(value) || value instanceof FillGradient || value instanceof FillPattern);\n  }\n};\n/**\n * Default drop shadow settings used when enabling drop shadows on text.\n * These values are used as the base configuration when drop shadows are enabled without specific settings.\n * @example\n * ```ts\n * // Customize default settings globally\n * TextStyle.defaultDropShadow.alpha = 0.5;    // 50% opacity for all shadows\n * TextStyle.defaultDropShadow.blur = 2;       // 2px blur for all shadows\n * TextStyle.defaultDropShadow.color = 'blue'; // Blue shadows by default\n * ```\n */\n_TextStyle.defaultDropShadow = {\n  alpha: 1,\n  angle: Math.PI / 6,\n  blur: 0,\n  color: \"black\",\n  distance: 5\n};\n/**\n * Default text style settings used when creating new text objects.\n * These values serve as the base configuration and can be customized globally.\n * @example\n * ```ts\n * // Customize default text style globally\n * TextStyle.defaultTextStyle.fontSize = 16;\n * TextStyle.defaultTextStyle.fill = 0x333333;\n * TextStyle.defaultTextStyle.fontFamily = ['Arial', 'Helvetica', 'sans-serif'];\n * ```\n */\n_TextStyle.defaultTextStyle = {\n  align: \"left\",\n  breakWords: false,\n  dropShadow: null,\n  fill: \"black\",\n  fontFamily: \"Arial\",\n  fontSize: 26,\n  fontStyle: \"normal\",\n  fontVariant: \"normal\",\n  fontWeight: \"normal\",\n  leading: 0,\n  letterSpacing: 0,\n  lineHeight: 0,\n  padding: 0,\n  stroke: null,\n  textBaseline: \"alphabetic\",\n  trim: false,\n  whiteSpace: \"pre\",\n  wordWrap: false,\n  wordWrapWidth: 100\n};\nlet TextStyle = _TextStyle;\nfunction convertV7Tov8Style(style) {\n  const oldStyle = style;\n  if (typeof oldStyle.dropShadow === \"boolean\" && oldStyle.dropShadow) {\n    const defaults = TextStyle.defaultDropShadow;\n    style.dropShadow = {\n      alpha: oldStyle.dropShadowAlpha ?? defaults.alpha,\n      angle: oldStyle.dropShadowAngle ?? defaults.angle,\n      blur: oldStyle.dropShadowBlur ?? defaults.blur,\n      color: oldStyle.dropShadowColor ?? defaults.color,\n      distance: oldStyle.dropShadowDistance ?? defaults.distance\n    };\n  }\n  if (oldStyle.strokeThickness !== void 0) {\n    deprecation(v8_0_0, \"strokeThickness is now a part of stroke\");\n    const color = oldStyle.stroke;\n    let obj = {};\n    if (Color.isColorLike(color)) {\n      obj.color = color;\n    } else if (color instanceof FillGradient || color instanceof FillPattern) {\n      obj.fill = color;\n    } else if (Object.hasOwnProperty.call(color, \"color\") || Object.hasOwnProperty.call(color, \"fill\")) {\n      obj = color;\n    } else {\n      throw new Error(\"Invalid stroke value.\");\n    }\n    style.stroke = {\n      ...obj,\n      width: oldStyle.strokeThickness\n    };\n  }\n  if (Array.isArray(oldStyle.fillGradientStops)) {\n    deprecation(v8_0_0, \"gradient fill is now a fill pattern: `new FillGradient(...)`\");\n    if (!Array.isArray(oldStyle.fill) || oldStyle.fill.length === 0) {\n      throw new Error(\"Invalid fill value. Expected an array of colors for gradient fill.\");\n    }\n    if (oldStyle.fill.length !== oldStyle.fillGradientStops.length) {\n      warn(\"The number of fill colors must match the number of fill gradient stops.\");\n    }\n    const gradientFill = new FillGradient({\n      start: { x: 0, y: 0 },\n      end: { x: 0, y: 1 },\n      textureSpace: \"local\"\n    });\n    const fillGradientStops = oldStyle.fillGradientStops.slice();\n    const fills = oldStyle.fill.map((color) => Color.shared.setValue(color).toNumber());\n    fillGradientStops.forEach((stop, index) => {\n      gradientFill.addColorStop(stop, fills[index]);\n    });\n    style.fill = {\n      fill: gradientFill\n    };\n  }\n}\n\nexport { TextStyle };\n//# sourceMappingURL=TextStyle.mjs.map\n","import { DOMAdapter } from '../../../../environment/adapter.mjs';\nimport { nextPow2 } from '../../../../maths/misc/pow2.mjs';\nimport { GlobalResourceRegistry } from '../../../../utils/pool/GlobalResourceRegistry.mjs';\n\n\"use strict\";\nclass CanvasPoolClass {\n  constructor(canvasOptions) {\n    this._canvasPool = /* @__PURE__ */ Object.create(null);\n    this.canvasOptions = canvasOptions || {};\n    this.enableFullScreen = false;\n  }\n  /**\n   * Creates texture with params that were specified in pool constructor.\n   * @param pixelWidth - Width of texture in pixels.\n   * @param pixelHeight - Height of texture in pixels.\n   */\n  _createCanvasAndContext(pixelWidth, pixelHeight) {\n    const canvas = DOMAdapter.get().createCanvas();\n    canvas.width = pixelWidth;\n    canvas.height = pixelHeight;\n    const context = canvas.getContext(\"2d\");\n    return { canvas, context };\n  }\n  /**\n   * Gets a Power-of-Two render texture or fullScreen texture\n   * @param minWidth - The minimum width of the render texture.\n   * @param minHeight - The minimum height of the render texture.\n   * @param resolution - The resolution of the render texture.\n   * @returns The new render texture.\n   */\n  getOptimalCanvasAndContext(minWidth, minHeight, resolution = 1) {\n    minWidth = Math.ceil(minWidth * resolution - 1e-6);\n    minHeight = Math.ceil(minHeight * resolution - 1e-6);\n    minWidth = nextPow2(minWidth);\n    minHeight = nextPow2(minHeight);\n    const key = (minWidth << 17) + (minHeight << 1);\n    if (!this._canvasPool[key]) {\n      this._canvasPool[key] = [];\n    }\n    let canvasAndContext = this._canvasPool[key].pop();\n    if (!canvasAndContext) {\n      canvasAndContext = this._createCanvasAndContext(minWidth, minHeight);\n    }\n    return canvasAndContext;\n  }\n  /**\n   * Place a render texture back into the pool.\n   * @param canvasAndContext\n   */\n  returnCanvasAndContext(canvasAndContext) {\n    const canvas = canvasAndContext.canvas;\n    const { width, height } = canvas;\n    const key = (width << 17) + (height << 1);\n    canvasAndContext.context.resetTransform();\n    canvasAndContext.context.clearRect(0, 0, width, height);\n    this._canvasPool[key].push(canvasAndContext);\n  }\n  clear() {\n    this._canvasPool = {};\n  }\n}\nconst CanvasPool = new CanvasPoolClass();\nGlobalResourceRegistry.register(CanvasPool);\n\nexport { CanvasPool, CanvasPoolClass };\n//# sourceMappingURL=CanvasPool.mjs.map\n","import { Color } from '../../../../color/Color.mjs';\nimport { Matrix } from '../../../../maths/matrix/Matrix.mjs';\nimport { Texture } from '../../../../rendering/renderers/shared/texture/Texture.mjs';\nimport { warn } from '../../../../utils/logging/warn.mjs';\nimport { FillGradient } from '../../../graphics/shared/fill/FillGradient.mjs';\nimport { FillPattern } from '../../../graphics/shared/fill/FillPattern.mjs';\n\n\"use strict\";\nconst PRECISION = 1e5;\nfunction getCanvasFillStyle(fillStyle, context, textMetrics, padding = 0) {\n  if (fillStyle.texture === Texture.WHITE && !fillStyle.fill) {\n    return Color.shared.setValue(fillStyle.color).setAlpha(fillStyle.alpha ?? 1).toHexa();\n  } else if (!fillStyle.fill) {\n    const pattern = context.createPattern(fillStyle.texture.source.resource, \"repeat\");\n    const tempMatrix = fillStyle.matrix.copyTo(Matrix.shared);\n    tempMatrix.scale(fillStyle.texture.frame.width, fillStyle.texture.frame.height);\n    pattern.setTransform(tempMatrix);\n    return pattern;\n  } else if (fillStyle.fill instanceof FillPattern) {\n    const fillPattern = fillStyle.fill;\n    const pattern = context.createPattern(fillPattern.texture.source.resource, \"repeat\");\n    const tempMatrix = fillPattern.transform.copyTo(Matrix.shared);\n    tempMatrix.scale(\n      fillPattern.texture.frame.width,\n      fillPattern.texture.frame.height\n    );\n    pattern.setTransform(tempMatrix);\n    return pattern;\n  } else if (fillStyle.fill instanceof FillGradient) {\n    const fillGradient = fillStyle.fill;\n    const isLinear = fillGradient.type === \"linear\";\n    const isLocal = fillGradient.textureSpace === \"local\";\n    let width = 1;\n    let height = 1;\n    if (isLocal && textMetrics) {\n      width = textMetrics.width + padding;\n      height = textMetrics.height + padding;\n    }\n    let gradient;\n    let isNearlyVertical = false;\n    if (isLinear) {\n      const { start, end } = fillGradient;\n      gradient = context.createLinearGradient(\n        start.x * width,\n        start.y * height,\n        end.x * width,\n        end.y * height\n      );\n      isNearlyVertical = Math.abs(end.x - start.x) < Math.abs((end.y - start.y) * 0.1);\n    } else {\n      const { center, innerRadius, outerCenter, outerRadius } = fillGradient;\n      gradient = context.createRadialGradient(\n        center.x * width,\n        center.y * height,\n        innerRadius * width,\n        outerCenter.x * width,\n        outerCenter.y * height,\n        outerRadius * width\n      );\n    }\n    if (isNearlyVertical && isLocal && textMetrics) {\n      const ratio = textMetrics.lineHeight / height;\n      for (let i = 0; i < textMetrics.lines.length; i++) {\n        const start = (i * textMetrics.lineHeight + padding / 2) / height;\n        fillGradient.colorStops.forEach((stop) => {\n          const globalStop = start + stop.offset * ratio;\n          gradient.addColorStop(\n            // fix to 5 decimal places to avoid floating point precision issues\n            Math.floor(globalStop * PRECISION) / PRECISION,\n            Color.shared.setValue(stop.color).toHex()\n          );\n        });\n      }\n    } else {\n      fillGradient.colorStops.forEach((stop) => {\n        gradient.addColorStop(stop.offset, Color.shared.setValue(stop.color).toHex());\n      });\n    }\n    return gradient;\n  }\n  warn(\"FillStyle not recognised\", fillStyle);\n  return \"red\";\n}\n\nexport { getCanvasFillStyle };\n//# sourceMappingURL=getCanvasFillStyle.mjs.map\n","import { Color } from '../../color/Color.mjs';\nimport { Rectangle } from '../../maths/shapes/Rectangle.mjs';\nimport { CanvasPool } from '../../rendering/renderers/shared/texture/CanvasPool.mjs';\nimport { ImageSource } from '../../rendering/renderers/shared/texture/sources/ImageSource.mjs';\nimport { Texture } from '../../rendering/renderers/shared/texture/Texture.mjs';\nimport { TextureStyle } from '../../rendering/renderers/shared/texture/TextureStyle.mjs';\nimport { deprecation, v8_0_0 } from '../../utils/logging/deprecation.mjs';\nimport { CanvasTextMetrics } from '../text/canvas/CanvasTextMetrics.mjs';\nimport { fontStringFromTextStyle } from '../text/canvas/utils/fontStringFromTextStyle.mjs';\nimport { getCanvasFillStyle } from '../text/canvas/utils/getCanvasFillStyle.mjs';\nimport { TextStyle } from '../text/TextStyle.mjs';\nimport { AbstractBitmapFont } from './AbstractBitmapFont.mjs';\n\n\"use strict\";\nconst _DynamicBitmapFont = class _DynamicBitmapFont extends AbstractBitmapFont {\n  /**\n   * @param options - The options for the dynamic bitmap font.\n   */\n  constructor(options) {\n    super();\n    /**\n     * this is a resolution modifier for the font size..\n     * texture resolution will also be used to scale texture according to its font size also\n     */\n    this.resolution = 1;\n    /** The pages of the font. */\n    this.pages = [];\n    this._padding = 0;\n    this._measureCache = /* @__PURE__ */ Object.create(null);\n    this._currentChars = [];\n    this._currentX = 0;\n    this._currentY = 0;\n    this._currentMaxCharHeight = 0;\n    this._currentPageIndex = -1;\n    this._skipKerning = false;\n    const dynamicOptions = { ..._DynamicBitmapFont.defaultOptions, ...options };\n    this._textureSize = dynamicOptions.textureSize;\n    this._mipmap = dynamicOptions.mipmap;\n    const style = dynamicOptions.style.clone();\n    if (dynamicOptions.overrideFill) {\n      style._fill.color = 16777215;\n      style._fill.alpha = 1;\n      style._fill.texture = Texture.WHITE;\n      style._fill.fill = null;\n    }\n    this.applyFillAsTint = dynamicOptions.overrideFill;\n    const requestedFontSize = style.fontSize;\n    style.fontSize = this.baseMeasurementFontSize;\n    const font = fontStringFromTextStyle(style);\n    if (dynamicOptions.overrideSize) {\n      if (style._stroke) {\n        style._stroke.width *= this.baseRenderedFontSize / requestedFontSize;\n      }\n    } else {\n      style.fontSize = this.baseRenderedFontSize = requestedFontSize;\n    }\n    this._style = style;\n    this._skipKerning = dynamicOptions.skipKerning ?? false;\n    this.resolution = dynamicOptions.resolution ?? 1;\n    this._padding = dynamicOptions.padding ?? 4;\n    if (dynamicOptions.textureStyle) {\n      this._textureStyle = dynamicOptions.textureStyle instanceof TextureStyle ? dynamicOptions.textureStyle : new TextureStyle(dynamicOptions.textureStyle);\n    }\n    this.fontMetrics = CanvasTextMetrics.measureFont(font);\n    this.lineHeight = style.lineHeight || this.fontMetrics.fontSize || style.fontSize;\n  }\n  ensureCharacters(chars) {\n    const charList = CanvasTextMetrics.graphemeSegmenter(chars).filter((char) => !this._currentChars.includes(char)).filter((char, index, self) => self.indexOf(char) === index);\n    if (!charList.length)\n      return;\n    this._currentChars = [...this._currentChars, ...charList];\n    let pageData;\n    if (this._currentPageIndex === -1) {\n      pageData = this._nextPage();\n    } else {\n      pageData = this.pages[this._currentPageIndex];\n    }\n    let { canvas, context } = pageData.canvasAndContext;\n    let textureSource = pageData.texture.source;\n    const style = this._style;\n    let currentX = this._currentX;\n    let currentY = this._currentY;\n    let currentMaxCharHeight = this._currentMaxCharHeight;\n    const fontScale = this.baseRenderedFontSize / this.baseMeasurementFontSize;\n    const padding = this._padding * fontScale;\n    let skipTexture = false;\n    const maxTextureWidth = canvas.width / this.resolution;\n    const maxTextureHeight = canvas.height / this.resolution;\n    for (let i = 0; i < charList.length; i++) {\n      const char = charList[i];\n      const metrics = CanvasTextMetrics.measureText(char, style, canvas, false);\n      metrics.lineHeight = metrics.height;\n      const width = metrics.width * fontScale;\n      const textureGlyphWidth = Math.ceil((style.fontStyle === \"italic\" ? 2 : 1) * width);\n      const height = metrics.height * fontScale;\n      const paddedWidth = textureGlyphWidth + padding * 2;\n      const paddedHeight = height + padding * 2;\n      skipTexture = false;\n      if (char !== \"\\n\" && char !== \"\\r\" && char !== \"\t\" && char !== \" \") {\n        skipTexture = true;\n        currentMaxCharHeight = Math.ceil(Math.max(paddedHeight, currentMaxCharHeight));\n      }\n      if (currentX + paddedWidth > maxTextureWidth) {\n        currentY += currentMaxCharHeight;\n        currentMaxCharHeight = paddedHeight;\n        currentX = 0;\n        if (currentY + currentMaxCharHeight > maxTextureHeight) {\n          textureSource.update();\n          const pageData2 = this._nextPage();\n          canvas = pageData2.canvasAndContext.canvas;\n          context = pageData2.canvasAndContext.context;\n          textureSource = pageData2.texture.source;\n          currentX = 0;\n          currentY = 0;\n          currentMaxCharHeight = 0;\n        }\n      }\n      const xAdvance = width / fontScale - (style.dropShadow?.distance ?? 0) - (style._stroke?.width ?? 0);\n      this.chars[char] = {\n        id: char.codePointAt(0),\n        xOffset: -this._padding,\n        yOffset: -this._padding,\n        xAdvance,\n        kerning: {}\n      };\n      if (skipTexture) {\n        this._drawGlyph(\n          context,\n          metrics,\n          currentX + padding,\n          currentY + padding,\n          fontScale,\n          style\n        );\n        const px = textureSource.width * fontScale;\n        const py = textureSource.height * fontScale;\n        const frame = new Rectangle(\n          currentX / px * textureSource.width,\n          currentY / py * textureSource.height,\n          paddedWidth / px * textureSource.width,\n          paddedHeight / py * textureSource.height\n        );\n        this.chars[char].texture = new Texture({\n          source: textureSource,\n          frame\n        });\n        currentX += Math.ceil(paddedWidth);\n      }\n    }\n    textureSource.update();\n    this._currentX = currentX;\n    this._currentY = currentY;\n    this._currentMaxCharHeight = currentMaxCharHeight;\n    this._skipKerning && this._applyKerning(charList, context);\n  }\n  /**\n   * @deprecated since 8.0.0\n   * The map of base page textures (i.e., sheets of glyphs).\n   */\n  get pageTextures() {\n    deprecation(v8_0_0, \"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead.\");\n    return this.pages;\n  }\n  _applyKerning(newChars, context) {\n    const measureCache = this._measureCache;\n    for (let i = 0; i < newChars.length; i++) {\n      const first = newChars[i];\n      for (let j = 0; j < this._currentChars.length; j++) {\n        const second = this._currentChars[j];\n        let c1 = measureCache[first];\n        if (!c1)\n          c1 = measureCache[first] = context.measureText(first).width;\n        let c2 = measureCache[second];\n        if (!c2)\n          c2 = measureCache[second] = context.measureText(second).width;\n        let total = context.measureText(first + second).width;\n        let amount = total - (c1 + c2);\n        if (amount) {\n          this.chars[first].kerning[second] = amount;\n        }\n        total = context.measureText(first + second).width;\n        amount = total - (c1 + c2);\n        if (amount) {\n          this.chars[second].kerning[first] = amount;\n        }\n      }\n    }\n  }\n  _nextPage() {\n    this._currentPageIndex++;\n    const textureResolution = this.resolution;\n    const canvasAndContext = CanvasPool.getOptimalCanvasAndContext(\n      this._textureSize,\n      this._textureSize,\n      textureResolution\n    );\n    this._setupContext(canvasAndContext.context, this._style, textureResolution);\n    const resolution = textureResolution * (this.baseRenderedFontSize / this.baseMeasurementFontSize);\n    const texture = new Texture({\n      source: new ImageSource({\n        resource: canvasAndContext.canvas,\n        resolution,\n        alphaMode: \"premultiply-alpha-on-upload\",\n        autoGenerateMipmaps: this._mipmap\n      })\n    });\n    if (this._textureStyle) {\n      texture.source.style = this._textureStyle;\n    }\n    const pageData = {\n      canvasAndContext,\n      texture\n    };\n    this.pages[this._currentPageIndex] = pageData;\n    return pageData;\n  }\n  // canvas style!\n  _setupContext(context, style, resolution) {\n    style.fontSize = this.baseRenderedFontSize;\n    context.scale(resolution, resolution);\n    context.font = fontStringFromTextStyle(style);\n    style.fontSize = this.baseMeasurementFontSize;\n    context.textBaseline = style.textBaseline;\n    const stroke = style._stroke;\n    const strokeThickness = stroke?.width ?? 0;\n    if (stroke) {\n      context.lineWidth = strokeThickness;\n      context.lineJoin = stroke.join;\n      context.miterLimit = stroke.miterLimit;\n      context.strokeStyle = getCanvasFillStyle(stroke, context);\n    }\n    if (style._fill) {\n      context.fillStyle = getCanvasFillStyle(style._fill, context);\n    }\n    if (style.dropShadow) {\n      const shadowOptions = style.dropShadow;\n      const rgb = Color.shared.setValue(shadowOptions.color).toArray();\n      const dropShadowBlur = shadowOptions.blur * resolution;\n      const dropShadowDistance = shadowOptions.distance * resolution;\n      context.shadowColor = `rgba(${rgb[0] * 255},${rgb[1] * 255},${rgb[2] * 255},${shadowOptions.alpha})`;\n      context.shadowBlur = dropShadowBlur;\n      context.shadowOffsetX = Math.cos(shadowOptions.angle) * dropShadowDistance;\n      context.shadowOffsetY = Math.sin(shadowOptions.angle) * dropShadowDistance;\n    } else {\n      context.shadowColor = \"black\";\n      context.shadowBlur = 0;\n      context.shadowOffsetX = 0;\n      context.shadowOffsetY = 0;\n    }\n  }\n  _drawGlyph(context, metrics, x, y, fontScale, style) {\n    const char = metrics.text;\n    const fontProperties = metrics.fontProperties;\n    const stroke = style._stroke;\n    const strokeThickness = (stroke?.width ?? 0) * fontScale;\n    const tx = x + strokeThickness / 2;\n    const ty = y - strokeThickness / 2;\n    const descent = fontProperties.descent * fontScale;\n    const lineHeight = metrics.lineHeight * fontScale;\n    let removeShadow = false;\n    if (style.stroke && strokeThickness) {\n      removeShadow = true;\n      context.strokeText(char, tx, ty + lineHeight - descent);\n    }\n    const { shadowBlur, shadowOffsetX, shadowOffsetY } = context;\n    if (style._fill) {\n      if (removeShadow) {\n        context.shadowBlur = 0;\n        context.shadowOffsetX = 0;\n        context.shadowOffsetY = 0;\n      }\n      context.fillText(char, tx, ty + lineHeight - descent);\n    }\n    if (removeShadow) {\n      context.shadowBlur = shadowBlur;\n      context.shadowOffsetX = shadowOffsetX;\n      context.shadowOffsetY = shadowOffsetY;\n    }\n  }\n  destroy() {\n    super.destroy();\n    for (let i = 0; i < this.pages.length; i++) {\n      const { canvasAndContext, texture } = this.pages[i];\n      CanvasPool.returnCanvasAndContext(canvasAndContext);\n      texture.destroy(true);\n    }\n    this.pages = null;\n  }\n};\n_DynamicBitmapFont.defaultOptions = {\n  textureSize: 512,\n  style: new TextStyle(),\n  mipmap: true\n};\nlet DynamicBitmapFont = _DynamicBitmapFont;\n\nexport { DynamicBitmapFont };\n//# sourceMappingURL=DynamicBitmapFont.mjs.map\n","\"use strict\";\nfunction getBitmapTextLayout(chars, style, font, trimEnd) {\n  const layoutData = {\n    width: 0,\n    height: 0,\n    offsetY: 0,\n    scale: style.fontSize / font.baseMeasurementFontSize,\n    lines: [{\n      width: 0,\n      charPositions: [],\n      spaceWidth: 0,\n      spacesIndex: [],\n      chars: []\n    }]\n  };\n  layoutData.offsetY = font.baseLineOffset;\n  let currentLine = layoutData.lines[0];\n  let previousChar = null;\n  let firstWord = true;\n  const currentWord = {\n    spaceWord: false,\n    width: 0,\n    start: 0,\n    index: 0,\n    // use index to not modify the array as we use it a lot!\n    positions: [],\n    chars: []\n  };\n  const scale = font.baseMeasurementFontSize / style.fontSize;\n  const adjustedLetterSpacing = style.letterSpacing * scale;\n  const adjustedWordWrapWidth = style.wordWrapWidth * scale;\n  const adjustedLineHeight = style.lineHeight ? style.lineHeight * scale : font.lineHeight;\n  const breakWords = style.wordWrap && style.breakWords;\n  const nextWord = (word) => {\n    const start = currentLine.width;\n    for (let j = 0; j < currentWord.index; j++) {\n      const position = word.positions[j];\n      currentLine.chars.push(word.chars[j]);\n      currentLine.charPositions.push(position + start);\n    }\n    currentLine.width += word.width;\n    firstWord = false;\n    currentWord.width = 0;\n    currentWord.index = 0;\n    currentWord.chars.length = 0;\n  };\n  const nextLine = () => {\n    let index = currentLine.chars.length - 1;\n    if (trimEnd) {\n      let lastChar = currentLine.chars[index];\n      while (lastChar === \" \") {\n        currentLine.width -= font.chars[lastChar].xAdvance;\n        lastChar = currentLine.chars[--index];\n      }\n    }\n    layoutData.width = Math.max(layoutData.width, currentLine.width);\n    currentLine = {\n      width: 0,\n      charPositions: [],\n      chars: [],\n      spaceWidth: 0,\n      spacesIndex: []\n    };\n    firstWord = true;\n    layoutData.lines.push(currentLine);\n    layoutData.height += adjustedLineHeight;\n  };\n  const checkIsOverflow = (lineWidth) => lineWidth - adjustedLetterSpacing > adjustedWordWrapWidth;\n  for (let i = 0; i < chars.length + 1; i++) {\n    let char;\n    const isEnd = i === chars.length;\n    if (!isEnd) {\n      char = chars[i];\n    }\n    const charData = font.chars[char] || font.chars[\" \"];\n    const isSpace = /(?:\\s)/.test(char);\n    const isWordBreak = isSpace || char === \"\\r\" || char === \"\\n\" || isEnd;\n    if (isWordBreak) {\n      const addWordToNextLine = !firstWord && style.wordWrap && checkIsOverflow(currentLine.width + currentWord.width);\n      if (addWordToNextLine) {\n        nextLine();\n        nextWord(currentWord);\n        if (!isEnd) {\n          currentLine.charPositions.push(0);\n        }\n      } else {\n        currentWord.start = currentLine.width;\n        nextWord(currentWord);\n        if (!isEnd) {\n          currentLine.charPositions.push(0);\n        }\n      }\n      if (char === \"\\r\" || char === \"\\n\") {\n        nextLine();\n      } else if (!isEnd) {\n        const spaceWidth = charData.xAdvance + (charData.kerning[previousChar] || 0) + adjustedLetterSpacing;\n        currentLine.width += spaceWidth;\n        currentLine.spaceWidth = spaceWidth;\n        currentLine.spacesIndex.push(currentLine.charPositions.length);\n        currentLine.chars.push(char);\n      }\n    } else {\n      const kerning = charData.kerning[previousChar] || 0;\n      const nextCharWidth = charData.xAdvance + kerning + adjustedLetterSpacing;\n      const addWordToNextLine = breakWords && checkIsOverflow(currentLine.width + currentWord.width + nextCharWidth);\n      if (addWordToNextLine) {\n        nextWord(currentWord);\n        nextLine();\n      }\n      currentWord.positions[currentWord.index++] = currentWord.width + kerning;\n      currentWord.chars.push(char);\n      currentWord.width += nextCharWidth;\n    }\n    previousChar = char;\n  }\n  nextLine();\n  if (style.align === \"center\") {\n    alignCenter(layoutData);\n  } else if (style.align === \"right\") {\n    alignRight(layoutData);\n  } else if (style.align === \"justify\") {\n    alignJustify(layoutData);\n  }\n  return layoutData;\n}\nfunction alignCenter(measurementData) {\n  for (let i = 0; i < measurementData.lines.length; i++) {\n    const line = measurementData.lines[i];\n    const offset = measurementData.width / 2 - line.width / 2;\n    for (let j = 0; j < line.charPositions.length; j++) {\n      line.charPositions[j] += offset;\n    }\n  }\n}\nfunction alignRight(measurementData) {\n  for (let i = 0; i < measurementData.lines.length; i++) {\n    const line = measurementData.lines[i];\n    const offset = measurementData.width - line.width;\n    for (let j = 0; j < line.charPositions.length; j++) {\n      line.charPositions[j] += offset;\n    }\n  }\n}\nfunction alignJustify(measurementData) {\n  const width = measurementData.width;\n  for (let i = 0; i < measurementData.lines.length; i++) {\n    const line = measurementData.lines[i];\n    let indy = 0;\n    let spaceIndex = line.spacesIndex[indy++];\n    let offset = 0;\n    const totalSpaces = line.spacesIndex.length;\n    const newSpaceWidth = (width - line.width) / totalSpaces;\n    const spaceWidth = newSpaceWidth;\n    for (let j = 0; j < line.charPositions.length; j++) {\n      if (j === spaceIndex) {\n        spaceIndex = line.spacesIndex[indy++];\n        offset += spaceWidth;\n      }\n      line.charPositions[j] += offset;\n    }\n  }\n}\n\nexport { getBitmapTextLayout };\n//# sourceMappingURL=getBitmapTextLayout.mjs.map\n","\"use strict\";\nfunction resolveCharacters(chars) {\n  if (chars === \"\") {\n    return [];\n  }\n  if (typeof chars === \"string\") {\n    chars = [chars];\n  }\n  const result = [];\n  for (let i = 0, j = chars.length; i < j; i++) {\n    const item = chars[i];\n    if (Array.isArray(item)) {\n      if (item.length !== 2) {\n        throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${item.length}.`);\n      }\n      if (item[0].length === 0 || item[1].length === 0) {\n        throw new Error(\"[BitmapFont]: Invalid character delimiter.\");\n      }\n      const startCode = item[0].charCodeAt(0);\n      const endCode = item[1].charCodeAt(0);\n      if (endCode < startCode) {\n        throw new Error(\"[BitmapFont]: Invalid character range.\");\n      }\n      for (let i2 = startCode, j2 = endCode; i2 <= j2; i2++) {\n        result.push(String.fromCharCode(i2));\n      }\n    } else {\n      result.push(...Array.from(item));\n    }\n  }\n  if (result.length === 0) {\n    throw new Error(\"[BitmapFont]: Empty set when resolving characters.\");\n  }\n  return result;\n}\n\nexport { resolveCharacters };\n//# sourceMappingURL=resolveCharacters.mjs.map\n","import { lru } from 'tiny-lru';\nimport { Cache } from '../../assets/cache/Cache.mjs';\nimport { deprecation, v8_0_0 } from '../../utils/logging/deprecation.mjs';\nimport { warn } from '../../utils/logging/warn.mjs';\nimport { CanvasTextMetrics } from '../text/canvas/CanvasTextMetrics.mjs';\nimport { TextStyle } from '../text/TextStyle.mjs';\nimport { DynamicBitmapFont } from './DynamicBitmapFont.mjs';\nimport { getBitmapTextLayout } from './utils/getBitmapTextLayout.mjs';\nimport { resolveCharacters } from './utils/resolveCharacters.mjs';\n\n\"use strict\";\nlet fontCount = 0;\nclass BitmapFontManagerClass {\n  constructor() {\n    /**\n     * This character set includes all the letters in the alphabet (both lower- and upper- case).\n     * @type {string[][]}\n     * @example\n     * BitmapFont.from('ExampleFont', style, { chars: BitmapFont.ALPHA })\n     */\n    this.ALPHA = [[\"a\", \"z\"], [\"A\", \"Z\"], \" \"];\n    /**\n     * This character set includes all decimal digits (from 0 to 9).\n     * @type {string[][]}\n     * @example\n     * BitmapFont.from('ExampleFont', style, { chars: BitmapFont.NUMERIC })\n     */\n    this.NUMERIC = [[\"0\", \"9\"]];\n    /**\n     * This character set is the union of `BitmapFont.ALPHA` and `BitmapFont.NUMERIC`.\n     * @type {string[][]}\n     */\n    this.ALPHANUMERIC = [[\"a\", \"z\"], [\"A\", \"Z\"], [\"0\", \"9\"], \" \"];\n    /**\n     * This character set consists of all the ASCII table.\n     * @type {string[][]}\n     * @see http://www.asciitable.com/\n     */\n    this.ASCII = [[\" \", \"~\"]];\n    /** Default options for installing a new BitmapFont. */\n    this.defaultOptions = {\n      chars: this.ALPHANUMERIC,\n      resolution: 1,\n      padding: 4,\n      skipKerning: false,\n      textureStyle: null\n    };\n    /** Cache for measured text layouts to avoid recalculating them multiple times. */\n    this.measureCache = lru(1e3);\n  }\n  /**\n   * Get a font for the specified text and style.\n   * @param text - The text to get the font for\n   * @param style - The style to use\n   */\n  getFont(text, style) {\n    let fontFamilyKey = `${style.fontFamily}-bitmap`;\n    let overrideFill = true;\n    if (style._fill.fill && !style._stroke) {\n      fontFamilyKey += style._fill.fill.styleKey;\n      overrideFill = false;\n    } else if (style._stroke || style.dropShadow) {\n      fontFamilyKey = `${style.styleKey}-bitmap`;\n      overrideFill = false;\n    }\n    if (!Cache.has(fontFamilyKey)) {\n      const styleCopy = Object.create(style);\n      styleCopy.lineHeight = 0;\n      const fnt = new DynamicBitmapFont({\n        style: styleCopy,\n        overrideFill,\n        overrideSize: true,\n        ...this.defaultOptions\n      });\n      fontCount++;\n      if (fontCount > 50) {\n        warn(\"BitmapText\", `You have dynamically created ${fontCount} bitmap fonts, this can be inefficient. Try pre installing your font styles using \\`BitmapFont.install({name:\"style1\", style})\\``);\n      }\n      fnt.once(\"destroy\", () => {\n        fontCount--;\n        Cache.remove(fontFamilyKey);\n      });\n      Cache.set(\n        fontFamilyKey,\n        fnt\n      );\n    }\n    const dynamicFont = Cache.get(fontFamilyKey);\n    dynamicFont.ensureCharacters?.(text);\n    return dynamicFont;\n  }\n  /**\n   * Get the layout of a text for the specified style.\n   * @param text - The text to get the layout for\n   * @param style - The style to use\n   * @param trimEnd - Whether to ignore whitespaces at the end of each line\n   */\n  getLayout(text, style, trimEnd = true) {\n    const bitmapFont = this.getFont(text, style);\n    const id = `${text}-${style.styleKey}-${trimEnd}`;\n    if (this.measureCache.has(id)) {\n      return this.measureCache.get(id);\n    }\n    const segments = CanvasTextMetrics.graphemeSegmenter(text);\n    const layoutData = getBitmapTextLayout(segments, style, bitmapFont, trimEnd);\n    this.measureCache.set(id, layoutData);\n    return layoutData;\n  }\n  /**\n   * Measure the text using the specified style.\n   * @param text - The text to measure\n   * @param style - The style to use\n   * @param trimEnd - Whether to ignore whitespaces at the end of each line\n   */\n  measureText(text, style, trimEnd = true) {\n    return this.getLayout(text, style, trimEnd);\n  }\n  // eslint-disable-next-line max-len\n  install(...args) {\n    let options = args[0];\n    if (typeof options === \"string\") {\n      options = {\n        name: options,\n        style: args[1],\n        chars: args[2]?.chars,\n        resolution: args[2]?.resolution,\n        padding: args[2]?.padding,\n        skipKerning: args[2]?.skipKerning\n      };\n      deprecation(v8_0_0, \"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})\");\n    }\n    const name = options?.name;\n    if (!name) {\n      throw new Error(\"[BitmapFontManager] Property `name` is required.\");\n    }\n    options = { ...this.defaultOptions, ...options };\n    const textStyle = options.style;\n    const style = textStyle instanceof TextStyle ? textStyle : new TextStyle(textStyle);\n    const overrideFill = options.dynamicFill ?? this._canUseTintForStyle(style);\n    const font = new DynamicBitmapFont({\n      style,\n      overrideFill,\n      skipKerning: options.skipKerning,\n      padding: options.padding,\n      resolution: options.resolution,\n      overrideSize: false,\n      textureStyle: options.textureStyle\n    });\n    const flatChars = resolveCharacters(options.chars);\n    font.ensureCharacters(flatChars.join(\"\"));\n    Cache.set(`${name}-bitmap`, font);\n    font.once(\"destroy\", () => Cache.remove(`${name}-bitmap`));\n    return font;\n  }\n  /**\n   * Uninstalls a bitmap font from the cache.\n   * @param {string} name - The name of the bitmap font to uninstall.\n   */\n  uninstall(name) {\n    const cacheKey = `${name}-bitmap`;\n    const font = Cache.get(cacheKey);\n    if (font) {\n      font.destroy();\n    }\n  }\n  /**\n   * Determines if a style can use tinting instead of baking colors into the bitmap.\n   * Tinting is more efficient as it allows reusing the same bitmap with different colors.\n   * @param style - The text style to evaluate\n   * @returns true if the style can use tinting, false if colors must be baked in\n   * @private\n   */\n  _canUseTintForStyle(style) {\n    return !style._stroke && (!style.dropShadow || style.dropShadow.color === 0) && !style._fill.fill && style._fill.color === 16777215;\n  }\n}\nconst BitmapFontManager = new BitmapFontManagerClass();\n\nexport { BitmapFontManager };\n//# sourceMappingURL=BitmapFontManager.mjs.map\n","import { groupD8 } from '../../maths/matrix/groupD8.mjs';\nimport { Rectangle } from '../../maths/shapes/Rectangle.mjs';\nimport { Texture } from '../../rendering/renderers/shared/texture/Texture.mjs';\nimport { AbstractBitmapFont } from './AbstractBitmapFont.mjs';\nimport { BitmapFontManager } from './BitmapFontManager.mjs';\n\n\"use strict\";\nclass BitmapFont extends AbstractBitmapFont {\n  constructor(options, url) {\n    super();\n    const { textures, data } = options;\n    Object.keys(data.pages).forEach((key) => {\n      const pageData = data.pages[parseInt(key, 10)];\n      const texture = textures[pageData.id];\n      this.pages.push({ texture });\n    });\n    Object.keys(data.chars).forEach((key) => {\n      const charData = data.chars[key];\n      const {\n        frame: textureFrame,\n        source: textureSource,\n        rotate: textureRotate\n      } = textures[charData.page];\n      const frame = groupD8.transformRectCoords(\n        charData,\n        textureFrame,\n        textureRotate,\n        new Rectangle()\n      );\n      const texture = new Texture({\n        frame,\n        orig: new Rectangle(0, 0, charData.width, charData.height),\n        source: textureSource,\n        rotate: textureRotate\n      });\n      this.chars[key] = {\n        id: key.codePointAt(0),\n        xOffset: charData.xOffset,\n        yOffset: charData.yOffset,\n        xAdvance: charData.xAdvance,\n        kerning: charData.kerning ?? {},\n        texture\n      };\n    });\n    this.baseRenderedFontSize = data.fontSize;\n    this.baseMeasurementFontSize = data.fontSize;\n    this.fontMetrics = {\n      ascent: 0,\n      descent: 0,\n      fontSize: data.fontSize\n    };\n    this.baseLineOffset = data.baseLineOffset;\n    this.lineHeight = data.lineHeight;\n    this.fontFamily = data.fontFamily;\n    this.distanceField = data.distanceField ?? {\n      type: \"none\",\n      range: 0\n    };\n    this.url = url;\n  }\n  /** Destroys the BitmapFont object. */\n  destroy() {\n    super.destroy();\n    for (let i = 0; i < this.pages.length; i++) {\n      const { texture } = this.pages[i];\n      texture.destroy(true);\n    }\n    this.pages = null;\n  }\n  /**\n   * Generates and installs a bitmap font with the specified options.\n   * The font will be cached and available for use in BitmapText objects.\n   * @param options - Setup options for font generation\n   * @returns Installed font instance\n   * @example\n   * ```ts\n   * // Install a basic font\n   * BitmapFont.install({\n   *     name: 'Title',\n   *     style: {\n   *         fontFamily: 'Arial',\n   *         fontSize: 32,\n   *         fill: '#ffffff'\n   *     }\n   * });\n   *\n   * // Install with advanced options\n   * BitmapFont.install({\n   *     name: 'Custom',\n   *     style: {\n   *         fontFamily: 'Arial',\n   *         fontSize: 24,\n   *         fill: '#00ff00',\n   *         stroke: { color: '#000000', width: 2 }\n   *     },\n   *     chars: [['a', 'z'], ['A', 'Z'], ['0', '9']],\n   *     resolution: 2,\n   *     padding: 4,\n   *     textureStyle: {\n   *         scaleMode: 'nearest'\n   *     }\n   * });\n   * ```\n   */\n  static install(options) {\n    BitmapFontManager.install(options);\n  }\n  /**\n   * Uninstalls a bitmap font from the cache.\n   * This frees up memory and resources associated with the font.\n   * @param name - The name of the bitmap font to uninstall\n   * @example\n   * ```ts\n   * // Remove a font when it's no longer needed\n   * BitmapFont.uninstall('MyCustomFont');\n   *\n   * // Clear multiple fonts\n   * ['Title', 'Heading', 'Body'].forEach(BitmapFont.uninstall);\n   * ```\n   */\n  static uninstall(name) {\n    BitmapFontManager.uninstall(name);\n  }\n}\n\nexport { BitmapFont };\n//# sourceMappingURL=BitmapFont.mjs.map\n","\"use strict\";\nconst bitmapFontTextParser = {\n  test(data) {\n    return typeof data === \"string\" && data.startsWith(\"info face=\");\n  },\n  parse(txt) {\n    const items = txt.match(/^[a-z]+\\s+.+$/gm);\n    const rawData = {\n      info: [],\n      common: [],\n      page: [],\n      char: [],\n      chars: [],\n      kerning: [],\n      kernings: [],\n      distanceField: []\n    };\n    for (const i in items) {\n      const name = items[i].match(/^[a-z]+/gm)[0];\n      const attributeList = items[i].match(/[a-zA-Z]+=([^\\s\"']+|\"([^\"]*)\")/gm);\n      const itemData = {};\n      for (const i2 in attributeList) {\n        const split = attributeList[i2].split(\"=\");\n        const key = split[0];\n        const strValue = split[1].replace(/\"/gm, \"\");\n        const floatValue = parseFloat(strValue);\n        const value = isNaN(floatValue) ? strValue : floatValue;\n        itemData[key] = value;\n      }\n      rawData[name].push(itemData);\n    }\n    const font = {\n      chars: {},\n      pages: [],\n      lineHeight: 0,\n      fontSize: 0,\n      fontFamily: \"\",\n      distanceField: null,\n      baseLineOffset: 0\n    };\n    const [info] = rawData.info;\n    const [common] = rawData.common;\n    const [distanceField] = rawData.distanceField ?? [];\n    if (distanceField) {\n      font.distanceField = {\n        range: parseInt(distanceField.distanceRange, 10),\n        type: distanceField.fieldType\n      };\n    }\n    font.fontSize = parseInt(info.size, 10);\n    font.fontFamily = info.face;\n    font.lineHeight = parseInt(common.lineHeight, 10);\n    const page = rawData.page;\n    for (let i = 0; i < page.length; i++) {\n      font.pages.push({\n        id: parseInt(page[i].id, 10) || 0,\n        file: page[i].file\n      });\n    }\n    const map = {};\n    font.baseLineOffset = font.lineHeight - parseInt(common.base, 10);\n    const char = rawData.char;\n    for (let i = 0; i < char.length; i++) {\n      const charNode = char[i];\n      const id = parseInt(charNode.id, 10);\n      let letter = charNode.letter ?? charNode.char ?? String.fromCharCode(id);\n      if (letter === \"space\")\n        letter = \" \";\n      map[id] = letter;\n      font.chars[letter] = {\n        id,\n        // texture deets..\n        page: parseInt(charNode.page, 10) || 0,\n        x: parseInt(charNode.x, 10),\n        y: parseInt(charNode.y, 10),\n        width: parseInt(charNode.width, 10),\n        height: parseInt(charNode.height, 10),\n        xOffset: parseInt(charNode.xoffset, 10),\n        yOffset: parseInt(charNode.yoffset, 10),\n        xAdvance: parseInt(charNode.xadvance, 10),\n        kerning: {}\n      };\n    }\n    const kerning = rawData.kerning || [];\n    for (let i = 0; i < kerning.length; i++) {\n      const first = parseInt(kerning[i].first, 10);\n      const second = parseInt(kerning[i].second, 10);\n      const amount = parseInt(kerning[i].amount, 10);\n      font.chars[map[second]].kerning[map[first]] = amount;\n    }\n    return font;\n  }\n};\n\nexport { bitmapFontTextParser };\n//# sourceMappingURL=bitmapFontTextParser.mjs.map\n","\"use strict\";\nconst bitmapFontXMLParser = {\n  test(data) {\n    const xml = data;\n    return typeof xml !== \"string\" && \"getElementsByTagName\" in xml && xml.getElementsByTagName(\"page\").length && xml.getElementsByTagName(\"info\")[0].getAttribute(\"face\") !== null;\n  },\n  parse(xml) {\n    const data = {\n      chars: {},\n      pages: [],\n      lineHeight: 0,\n      fontSize: 0,\n      fontFamily: \"\",\n      distanceField: null,\n      baseLineOffset: 0\n    };\n    const info = xml.getElementsByTagName(\"info\")[0];\n    const common = xml.getElementsByTagName(\"common\")[0];\n    const distanceField = xml.getElementsByTagName(\"distanceField\")[0];\n    if (distanceField) {\n      data.distanceField = {\n        type: distanceField.getAttribute(\"fieldType\"),\n        range: parseInt(distanceField.getAttribute(\"distanceRange\"), 10)\n      };\n    }\n    const page = xml.getElementsByTagName(\"page\");\n    const char = xml.getElementsByTagName(\"char\");\n    const kerning = xml.getElementsByTagName(\"kerning\");\n    data.fontSize = parseInt(info.getAttribute(\"size\"), 10);\n    data.fontFamily = info.getAttribute(\"face\");\n    data.lineHeight = parseInt(common.getAttribute(\"lineHeight\"), 10);\n    for (let i = 0; i < page.length; i++) {\n      data.pages.push({\n        id: parseInt(page[i].getAttribute(\"id\"), 10) || 0,\n        file: page[i].getAttribute(\"file\")\n      });\n    }\n    const map = {};\n    data.baseLineOffset = data.lineHeight - parseInt(common.getAttribute(\"base\"), 10);\n    for (let i = 0; i < char.length; i++) {\n      const charNode = char[i];\n      const id = parseInt(charNode.getAttribute(\"id\"), 10);\n      let letter = charNode.getAttribute(\"letter\") ?? charNode.getAttribute(\"char\") ?? String.fromCharCode(id);\n      if (letter === \"space\")\n        letter = \" \";\n      map[id] = letter;\n      data.chars[letter] = {\n        id,\n        // texture deets..\n        page: parseInt(charNode.getAttribute(\"page\"), 10) || 0,\n        x: parseInt(charNode.getAttribute(\"x\"), 10),\n        y: parseInt(charNode.getAttribute(\"y\"), 10),\n        width: parseInt(charNode.getAttribute(\"width\"), 10),\n        height: parseInt(charNode.getAttribute(\"height\"), 10),\n        // render deets..\n        xOffset: parseInt(charNode.getAttribute(\"xoffset\"), 10),\n        yOffset: parseInt(charNode.getAttribute(\"yoffset\"), 10),\n        // + baseLineOffset,\n        xAdvance: parseInt(charNode.getAttribute(\"xadvance\"), 10),\n        kerning: {}\n      };\n    }\n    for (let i = 0; i < kerning.length; i++) {\n      const first = parseInt(kerning[i].getAttribute(\"first\"), 10);\n      const second = parseInt(kerning[i].getAttribute(\"second\"), 10);\n      const amount = parseInt(kerning[i].getAttribute(\"amount\"), 10);\n      data.chars[map[second]].kerning[map[first]] = amount;\n    }\n    return data;\n  }\n};\n\nexport { bitmapFontXMLParser };\n//# sourceMappingURL=bitmapFontXMLParser.mjs.map\n","import { DOMAdapter } from '../../../environment/adapter.mjs';\nimport { bitmapFontXMLParser } from './bitmapFontXMLParser.mjs';\n\n\"use strict\";\nconst bitmapFontXMLStringParser = {\n  test(data) {\n    if (typeof data === \"string\" && data.includes(\"<font>\")) {\n      return bitmapFontXMLParser.test(DOMAdapter.get().parseXML(data));\n    }\n    return false;\n  },\n  parse(data) {\n    return bitmapFontXMLParser.parse(DOMAdapter.get().parseXML(data));\n  }\n};\n\nexport { bitmapFontXMLStringParser };\n//# sourceMappingURL=bitmapFontXMLStringParser.mjs.map\n","import { LoaderParserPriority } from '../../../assets/loader/parsers/LoaderParser.mjs';\nimport { copySearchParams } from '../../../assets/utils/copySearchParams.mjs';\nimport { DOMAdapter } from '../../../environment/adapter.mjs';\nimport { ExtensionType } from '../../../extensions/Extensions.mjs';\nimport { path } from '../../../utils/path.mjs';\nimport { BitmapFont } from '../BitmapFont.mjs';\nimport { bitmapFontTextParser } from './bitmapFontTextParser.mjs';\nimport { bitmapFontXMLStringParser } from './bitmapFontXMLStringParser.mjs';\n\n\"use strict\";\nconst validExtensions = [\".xml\", \".fnt\"];\nconst bitmapFontCachePlugin = {\n  extension: {\n    type: ExtensionType.CacheParser,\n    name: \"cacheBitmapFont\"\n  },\n  test: (asset) => asset instanceof BitmapFont,\n  getCacheableAssets(keys, asset) {\n    const out = {};\n    keys.forEach((key) => {\n      out[key] = asset;\n      out[`${key}-bitmap`] = asset;\n    });\n    out[`${asset.fontFamily}-bitmap`] = asset;\n    return out;\n  }\n};\nconst loadBitmapFont = {\n  extension: {\n    type: ExtensionType.LoadParser,\n    priority: LoaderParserPriority.Normal\n  },\n  /** used for deprecation purposes */\n  name: \"loadBitmapFont\",\n  id: \"bitmap-font\",\n  test(url) {\n    return validExtensions.includes(path.extname(url).toLowerCase());\n  },\n  async testParse(data) {\n    return bitmapFontTextParser.test(data) || bitmapFontXMLStringParser.test(data);\n  },\n  async parse(asset, data, loader) {\n    const bitmapFontData = bitmapFontTextParser.test(asset) ? bitmapFontTextParser.parse(asset) : bitmapFontXMLStringParser.parse(asset);\n    const { src } = data;\n    const { pages } = bitmapFontData;\n    const textureUrls = [];\n    const textureOptions = bitmapFontData.distanceField ? {\n      scaleMode: \"linear\",\n      alphaMode: \"premultiply-alpha-on-upload\",\n      autoGenerateMipmaps: false,\n      resolution: 1\n    } : {};\n    for (let i = 0; i < pages.length; ++i) {\n      const pageFile = pages[i].file;\n      let imagePath = path.join(path.dirname(src), pageFile);\n      imagePath = copySearchParams(imagePath, src);\n      textureUrls.push({\n        src: imagePath,\n        data: textureOptions\n      });\n    }\n    const loadedTextures = await loader.load(textureUrls);\n    const textures = textureUrls.map((url) => loadedTextures[url.src]);\n    const bitmapFont = new BitmapFont({\n      data: bitmapFontData,\n      textures\n    }, src);\n    return bitmapFont;\n  },\n  async load(url, _options) {\n    const response = await DOMAdapter.get().fetch(url);\n    return await response.text();\n  },\n  async unload(bitmapFont, _resolvedAsset, loader) {\n    await Promise.all(bitmapFont.pages.map((page) => loader.unload(page.texture.source._sourceOrigin)));\n    bitmapFont.destroy();\n  }\n};\n\nexport { bitmapFontCachePlugin, loadBitmapFont };\n//# sourceMappingURL=loadBitmapFont.mjs.map\n","\"use strict\";\nclass BackgroundLoader {\n  /**\n   * @param loader\n   * @param verbose - should the loader log to the console\n   */\n  constructor(loader, verbose = false) {\n    this._loader = loader;\n    this._assetList = [];\n    this._isLoading = false;\n    this._maxConcurrent = 1;\n    this.verbose = verbose;\n  }\n  /**\n   * Adds assets to the background loading queue. Assets are loaded one at a time to minimize\n   * performance impact.\n   * @param assetUrls - Array of resolved assets to load in the background\n   * @example\n   * ```ts\n   * // Add assets to background load queue\n   * backgroundLoader.add([\n   *     { src: 'images/level1/bg.png' },\n   *     { src: 'images/level1/characters.json' }\n   * ]);\n   *\n   * // Assets will load sequentially in the background\n   * // The loader automatically pauses when high-priority loads occur\n   * // e.g. Assets.load() is called\n   * ```\n   * @remarks\n   * - Assets are loaded one at a time to minimize performance impact\n   * - Loading automatically pauses when Assets.load() is called\n   * - No progress tracking is available for background loading\n   * - Assets are cached as they complete loading\n   * @internal\n   */\n  add(assetUrls) {\n    assetUrls.forEach((a) => {\n      this._assetList.push(a);\n    });\n    if (this.verbose) {\n      console.log(\"[BackgroundLoader] assets: \", this._assetList);\n    }\n    if (this._isActive && !this._isLoading) {\n      void this._next();\n    }\n  }\n  /**\n   * Loads the next set of assets. Will try to load as many assets as it can at the same time.\n   *\n   * The max assets it will try to load at one time will be 4.\n   */\n  async _next() {\n    if (this._assetList.length && this._isActive) {\n      this._isLoading = true;\n      const toLoad = [];\n      const toLoadAmount = Math.min(this._assetList.length, this._maxConcurrent);\n      for (let i = 0; i < toLoadAmount; i++) {\n        toLoad.push(this._assetList.pop());\n      }\n      await this._loader.load(toLoad);\n      this._isLoading = false;\n      void this._next();\n    }\n  }\n  /**\n   * Controls the active state of the background loader. When active, the loader will\n   * continue processing its queue. When inactive, loading is paused.\n   * @returns Whether the background loader is currently active\n   * @example\n   * ```ts\n   * // Pause background loading\n   * backgroundLoader.active = false;\n   *\n   * // Resume background loading\n   * backgroundLoader.active = true;\n   *\n   * // Check current state\n   * console.log(backgroundLoader.active); // true/false\n   *\n   * // Common use case: Pause during intensive operations\n   * backgroundLoader.active = false;  // Pause background loading\n   * ... // Perform high-priority tasks\n   * backgroundLoader.active = true;   // Resume background loading\n   * ```\n   * @remarks\n   * - Setting to true resumes loading immediately\n   * - Setting to false pauses after current asset completes\n   * - Background loading is automatically paused during `Assets.load()`\n   * - Assets already being loaded will complete even when set to false\n   */\n  get active() {\n    return this._isActive;\n  }\n  set active(value) {\n    if (this._isActive === value)\n      return;\n    this._isActive = value;\n    if (value && !this._isLoading) {\n      void this._next();\n    }\n  }\n}\n\nexport { BackgroundLoader };\n//# sourceMappingURL=BackgroundLoader.mjs.map\n","import { ExtensionType } from '../../../extensions/Extensions.mjs';\nimport { Texture } from '../../../rendering/renderers/shared/texture/Texture.mjs';\n\n\"use strict\";\nconst cacheTextureArray = {\n  extension: {\n    type: ExtensionType.CacheParser,\n    name: \"cacheTextureArray\"\n  },\n  test: (asset) => Array.isArray(asset) && asset.every((t) => t instanceof Texture),\n  getCacheableAssets: (keys, asset) => {\n    const out = {};\n    keys.forEach((key) => {\n      asset.forEach((item, i) => {\n        out[key + (i === 0 ? \"\" : i + 1)] = item;\n      });\n    });\n    return out;\n  }\n};\n\nexport { cacheTextureArray };\n//# sourceMappingURL=cacheTextureArray.mjs.map\n","\"use strict\";\nasync function testImageFormat(imageData) {\n  if (\"Image\" in globalThis) {\n    return new Promise((resolve) => {\n      const image = new Image();\n      image.onload = () => {\n        resolve(true);\n      };\n      image.onerror = () => {\n        resolve(false);\n      };\n      image.src = imageData;\n    });\n  }\n  if (\"createImageBitmap\" in globalThis && \"fetch\" in globalThis) {\n    try {\n      const blob = await (await fetch(imageData)).blob();\n      await createImageBitmap(blob);\n    } catch (_e) {\n      return false;\n    }\n    return true;\n  }\n  return false;\n}\n\nexport { testImageFormat };\n//# sourceMappingURL=testImageFormat.mjs.map\n","import { ExtensionType } from '../../../extensions/Extensions.mjs';\nimport { testImageFormat } from '../utils/testImageFormat.mjs';\n\n\"use strict\";\nconst detectAvif = {\n  extension: {\n    type: ExtensionType.DetectionParser,\n    priority: 1\n  },\n  test: async () => testImageFormat(\n    // eslint-disable-next-line max-len\n    \"data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=\"\n  ),\n  add: async (formats) => [...formats, \"avif\"],\n  remove: async (formats) => formats.filter((f) => f !== \"avif\")\n};\n\nexport { detectAvif };\n//# sourceMappingURL=detectAvif.mjs.map\n","import { ExtensionType } from '../../../extensions/Extensions.mjs';\n\n\"use strict\";\nconst imageFormats = [\"png\", \"jpg\", \"jpeg\"];\nconst detectDefaults = {\n  extension: {\n    type: ExtensionType.DetectionParser,\n    priority: -1\n  },\n  test: () => Promise.resolve(true),\n  add: async (formats) => [...formats, ...imageFormats],\n  remove: async (formats) => formats.filter((f) => !imageFormats.includes(f))\n};\n\nexport { detectDefaults };\n//# sourceMappingURL=detectDefaults.mjs.map\n","\"use strict\";\nconst inWorker = \"WorkerGlobalScope\" in globalThis && globalThis instanceof globalThis.WorkerGlobalScope;\nfunction testVideoFormat(mimeType) {\n  if (inWorker) {\n    return false;\n  }\n  const video = document.createElement(\"video\");\n  return video.canPlayType(mimeType) !== \"\";\n}\n\nexport { testVideoFormat };\n//# sourceMappingURL=testVideoFormat.mjs.map\n","import { ExtensionType } from '../../../extensions/Extensions.mjs';\nimport { testVideoFormat } from '../utils/testVideoFormat.mjs';\n\n\"use strict\";\nconst detectMp4 = {\n  extension: {\n    type: ExtensionType.DetectionParser,\n    priority: 0\n  },\n  test: async () => testVideoFormat(\"video/mp4\"),\n  add: async (formats) => [...formats, \"mp4\", \"m4v\"],\n  remove: async (formats) => formats.filter((f) => f !== \"mp4\" && f !== \"m4v\")\n};\n\nexport { detectMp4 };\n//# sourceMappingURL=detectMp4.mjs.map\n","import { ExtensionType } from '../../../extensions/Extensions.mjs';\nimport { testVideoFormat } from '../utils/testVideoFormat.mjs';\n\n\"use strict\";\nconst detectOgv = {\n  extension: {\n    type: ExtensionType.DetectionParser,\n    priority: 0\n  },\n  test: async () => testVideoFormat(\"video/ogg\"),\n  add: async (formats) => [...formats, \"ogv\"],\n  remove: async (formats) => formats.filter((f) => f !== \"ogv\")\n};\n\nexport { detectOgv };\n//# sourceMappingURL=detectOgv.mjs.map\n","import { ExtensionType } from '../../../extensions/Extensions.mjs';\nimport { testVideoFormat } from '../utils/testVideoFormat.mjs';\n\n\"use strict\";\nconst detectWebm = {\n  extension: {\n    type: ExtensionType.DetectionParser,\n    priority: 0\n  },\n  test: async () => testVideoFormat(\"video/webm\"),\n  add: async (formats) => [...formats, \"webm\"],\n  remove: async (formats) => formats.filter((f) => f !== \"webm\")\n};\n\nexport { detectWebm };\n//# sourceMappingURL=detectWebm.mjs.map\n","import { ExtensionType } from '../../../extensions/Extensions.mjs';\nimport { testImageFormat } from '../utils/testImageFormat.mjs';\n\n\"use strict\";\nconst detectWebp = {\n  extension: {\n    type: ExtensionType.DetectionParser,\n    priority: 0\n  },\n  test: async () => testImageFormat(\n    \"data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=\"\n  ),\n  add: async (formats) => [...formats, \"webp\"],\n  remove: async (formats) => formats.filter((f) => f !== \"webp\")\n};\n\nexport { detectWebp };\n//# sourceMappingURL=detectWebp.mjs.map\n","import { warn } from '../../utils/logging/warn.mjs';\nimport { path } from '../../utils/path.mjs';\nimport { convertToList } from '../utils/convertToList.mjs';\nimport { isSingleItem } from '../utils/isSingleItem.mjs';\n\n\"use strict\";\nconst _Loader = class _Loader {\n  constructor() {\n    /**\n     * Options for loading assets with the loader.\n     * These options will be used as defaults for all load calls made with this loader instance.\n     * They can be overridden by passing options directly to the load method.\n     * @example\n     * ```ts\n     * // Create a loader with custom default options\n     * const loader = new Loader();\n     * loader.loadOptions = {\n     *   strategy: 'skip', // Default strategy to 'skip'\n     *   retryCount: 5,   // Default retry count to 5\n     *   retryDelay: 500, // Default retry delay to 500ms\n     * };\n     *\n     * // This load call will use the loader's default options\n     * await loader.load('image1.png');\n     */\n    this.loadOptions = { ..._Loader.defaultOptions };\n    this._parsers = [];\n    this._parsersValidated = false;\n    /**\n     * All loader parsers registered\n     * @type {assets.LoaderParser[]}\n     */\n    this.parsers = new Proxy(this._parsers, {\n      set: (target, key, value) => {\n        this._parsersValidated = false;\n        target[key] = value;\n        return true;\n      }\n    });\n    /** Cache loading promises that ae currently active */\n    this.promiseCache = {};\n  }\n  /** function used for testing */\n  reset() {\n    this._parsersValidated = false;\n    this.promiseCache = {};\n  }\n  /**\n   * Used internally to generate a promise for the asset to be loaded.\n   * @param url - The URL to be loaded\n   * @param data - any custom additional information relevant to the asset being loaded\n   * @returns - a promise that will resolve to an Asset for example a Texture of a JSON object\n   */\n  _getLoadPromiseAndParser(url, data) {\n    const result = {\n      promise: null,\n      parser: null\n    };\n    result.promise = (async () => {\n      let asset = null;\n      let parser = null;\n      if (data.parser || data.loadParser) {\n        parser = this._parserHash[data.parser || data.loadParser];\n        if (data.loadParser) {\n          warn(\n            `[Assets] \"loadParser\" is deprecated, use \"parser\" instead for ${url}`\n          );\n        }\n        if (!parser) {\n          warn(\n            `[Assets] specified load parser \"${data.parser || data.loadParser}\" not found while loading ${url}`\n          );\n        }\n      }\n      if (!parser) {\n        for (let i = 0; i < this.parsers.length; i++) {\n          const parserX = this.parsers[i];\n          if (parserX.load && parserX.test?.(url, data, this)) {\n            parser = parserX;\n            break;\n          }\n        }\n        if (!parser) {\n          warn(`[Assets] ${url} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`);\n          return null;\n        }\n      }\n      asset = await parser.load(url, data, this);\n      result.parser = parser;\n      for (let i = 0; i < this.parsers.length; i++) {\n        const parser2 = this.parsers[i];\n        if (parser2.parse) {\n          if (parser2.parse && await parser2.testParse?.(asset, data, this)) {\n            asset = await parser2.parse(asset, data, this) || asset;\n            result.parser = parser2;\n          }\n        }\n      }\n      return asset;\n    })();\n    return result;\n  }\n  async load(assetsToLoadIn, onProgressOrOptions) {\n    if (!this._parsersValidated) {\n      this._validateParsers();\n    }\n    const options = typeof onProgressOrOptions === \"function\" ? { ..._Loader.defaultOptions, ...this.loadOptions, onProgress: onProgressOrOptions } : { ..._Loader.defaultOptions, ...this.loadOptions, ...onProgressOrOptions || {} };\n    const { onProgress, onError, strategy, retryCount, retryDelay } = options;\n    let count = 0;\n    const assets = {};\n    const singleAsset = isSingleItem(assetsToLoadIn);\n    const assetsToLoad = convertToList(assetsToLoadIn, (item) => ({\n      alias: [item],\n      src: item,\n      data: {}\n    }));\n    const total = assetsToLoad.reduce((sum, asset) => sum + (asset.progressSize || 1), 0);\n    const promises = assetsToLoad.map(async (asset) => {\n      const url = path.toAbsolute(asset.src);\n      if (assets[asset.src])\n        return;\n      await this._loadAssetWithRetry(url, asset, { onProgress, onError, strategy, retryCount, retryDelay }, assets);\n      count += asset.progressSize || 1;\n      if (onProgress)\n        onProgress(count / total);\n    });\n    await Promise.all(promises);\n    return singleAsset ? assets[assetsToLoad[0].src] : assets;\n  }\n  /**\n   * Unloads one or more assets. Any unloaded assets will be destroyed, freeing up memory for your app.\n   * The parser that created the asset, will be the one that unloads it.\n   * @example\n   * // Single asset:\n   * const asset = await Loader.load('cool.png');\n   *\n   * await Loader.unload('cool.png');\n   *\n   * console.log(asset.destroyed); // true\n   * @param assetsToUnloadIn - urls that you want to unload, or a single one!\n   */\n  async unload(assetsToUnloadIn) {\n    const assetsToUnload = convertToList(assetsToUnloadIn, (item) => ({\n      alias: [item],\n      src: item\n    }));\n    const promises = assetsToUnload.map(async (asset) => {\n      const url = path.toAbsolute(asset.src);\n      const loadPromise = this.promiseCache[url];\n      if (loadPromise) {\n        const loadedAsset = await loadPromise.promise;\n        delete this.promiseCache[url];\n        await loadPromise.parser?.unload?.(loadedAsset, asset, this);\n      }\n    });\n    await Promise.all(promises);\n  }\n  /** validates our parsers, right now it only checks for name conflicts but we can add more here as required! */\n  _validateParsers() {\n    this._parsersValidated = true;\n    this._parserHash = this._parsers.filter((parser) => parser.name || parser.id).reduce((hash, parser) => {\n      if (!parser.name && !parser.id) {\n        warn(`[Assets] parser should have an id`);\n      } else if (hash[parser.name] || hash[parser.id]) {\n        warn(`[Assets] parser id conflict \"${parser.id}\"`);\n      }\n      hash[parser.name] = parser;\n      if (parser.id)\n        hash[parser.id] = parser;\n      return hash;\n    }, {});\n  }\n  async _loadAssetWithRetry(url, asset, options, assets) {\n    let attempt = 0;\n    const { onError, strategy, retryCount, retryDelay } = options;\n    const wait = (ms) => new Promise((r) => setTimeout(r, ms));\n    while (true) {\n      try {\n        if (!this.promiseCache[url]) {\n          this.promiseCache[url] = this._getLoadPromiseAndParser(url, asset);\n        }\n        assets[asset.src] = await this.promiseCache[url].promise;\n        return;\n      } catch (e) {\n        delete this.promiseCache[url];\n        delete assets[asset.src];\n        attempt++;\n        const isLast = strategy !== \"retry\" || attempt > retryCount;\n        if (strategy === \"retry\" && !isLast) {\n          if (onError)\n            onError(e, asset);\n          await wait(retryDelay);\n          continue;\n        }\n        if (strategy === \"skip\") {\n          if (onError)\n            onError(e, asset);\n          return;\n        }\n        if (onError)\n          onError(e, asset);\n        throw new Error(`[Loader.load] Failed to load ${url}.\n${e}`);\n      }\n    }\n  }\n};\n/**\n * Default options for loading assets\n * @example\n * ```ts\n * // Change default load options globally\n * Loader.defaultOptions = {\n *   strategy: 'skip', // Change default strategy to 'skip'\n *   retryCount: 5,   // Change default retry count to 5\n *   retryDelay: 500, // Change default retry delay to 500ms\n * };\n * ```\n */\n_Loader.defaultOptions = {\n  onProgress: void 0,\n  onError: void 0,\n  strategy: \"throw\",\n  retryCount: 3,\n  retryDelay: 250\n};\nlet Loader = _Loader;\n\nexport { Loader };\n//# sourceMappingURL=Loader.mjs.map\n","\"use strict\";\nfunction checkDataUrl(url, mimes) {\n  if (Array.isArray(mimes)) {\n    for (const mime of mimes) {\n      if (url.startsWith(`data:${mime}`))\n        return true;\n    }\n    return false;\n  }\n  return url.startsWith(`data:${mimes}`);\n}\n\nexport { checkDataUrl };\n//# sourceMappingURL=checkDataUrl.mjs.map\n","import { path } from '../../utils/path.mjs';\n\n\"use strict\";\nfunction checkExtension(url, extension) {\n  const tempURL = url.split(\"?\")[0];\n  const ext = path.extname(tempURL).toLowerCase();\n  if (Array.isArray(extension)) {\n    return extension.includes(ext);\n  }\n  return ext === extension;\n}\n\nexport { checkExtension };\n//# sourceMappingURL=checkExtension.mjs.map\n","import { DOMAdapter } from '../../../environment/adapter.mjs';\nimport { ExtensionType } from '../../../extensions/Extensions.mjs';\nimport { checkDataUrl } from '../../utils/checkDataUrl.mjs';\nimport { checkExtension } from '../../utils/checkExtension.mjs';\nimport { LoaderParserPriority } from './LoaderParser.mjs';\n\n\"use strict\";\nconst validJSONExtension = \".json\";\nconst validJSONMIME = \"application/json\";\nconst loadJson = {\n  extension: {\n    type: ExtensionType.LoadParser,\n    priority: LoaderParserPriority.Low\n  },\n  /** used for deprecation purposes */\n  name: \"loadJson\",\n  id: \"json\",\n  test(url) {\n    return checkDataUrl(url, validJSONMIME) || checkExtension(url, validJSONExtension);\n  },\n  async load(url) {\n    const response = await DOMAdapter.get().fetch(url);\n    const json = await response.json();\n    return json;\n  }\n};\n\nexport { loadJson };\n//# sourceMappingURL=loadJson.mjs.map\n","import { DOMAdapter } from '../../../environment/adapter.mjs';\nimport { ExtensionType } from '../../../extensions/Extensions.mjs';\nimport { checkDataUrl } from '../../utils/checkDataUrl.mjs';\nimport { checkExtension } from '../../utils/checkExtension.mjs';\nimport { LoaderParserPriority } from './LoaderParser.mjs';\n\n\"use strict\";\nconst validTXTExtension = \".txt\";\nconst validTXTMIME = \"text/plain\";\nconst loadTxt = {\n  /** used for deprecation purposes */\n  name: \"loadTxt\",\n  id: \"text\",\n  extension: {\n    type: ExtensionType.LoadParser,\n    priority: LoaderParserPriority.Low,\n    name: \"loadTxt\"\n  },\n  test(url) {\n    return checkDataUrl(url, validTXTMIME) || checkExtension(url, validTXTExtension);\n  },\n  async load(url) {\n    const response = await DOMAdapter.get().fetch(url);\n    const txt = await response.text();\n    return txt;\n  }\n};\n\nexport { loadTxt };\n//# sourceMappingURL=loadTxt.mjs.map\n","import { DOMAdapter } from '../../../environment/adapter.mjs';\nimport { ExtensionType } from '../../../extensions/Extensions.mjs';\nimport { warn } from '../../../utils/logging/warn.mjs';\nimport { path } from '../../../utils/path.mjs';\nimport { Cache } from '../../cache/Cache.mjs';\nimport { checkDataUrl } from '../../utils/checkDataUrl.mjs';\nimport { checkExtension } from '../../utils/checkExtension.mjs';\nimport { LoaderParserPriority } from './LoaderParser.mjs';\n\n\"use strict\";\nconst validWeights = [\n  \"normal\",\n  \"bold\",\n  \"100\",\n  \"200\",\n  \"300\",\n  \"400\",\n  \"500\",\n  \"600\",\n  \"700\",\n  \"800\",\n  \"900\"\n];\nconst validFontExtensions = [\".ttf\", \".otf\", \".woff\", \".woff2\"];\nconst validFontMIMEs = [\n  \"font/ttf\",\n  \"font/otf\",\n  \"font/woff\",\n  \"font/woff2\"\n];\nconst CSS_IDENT_TOKEN_REGEX = /^(--|-?[A-Z_])[0-9A-Z_-]*$/i;\nfunction getFontFamilyName(url) {\n  const ext = path.extname(url);\n  const name = path.basename(url, ext);\n  const nameWithSpaces = name.replace(/(-|_)/g, \" \");\n  const nameTokens = nameWithSpaces.toLowerCase().split(\" \").map((word) => word.charAt(0).toUpperCase() + word.slice(1));\n  let valid = nameTokens.length > 0;\n  for (const token of nameTokens) {\n    if (!token.match(CSS_IDENT_TOKEN_REGEX)) {\n      valid = false;\n      break;\n    }\n  }\n  let fontFamilyName = nameTokens.join(\" \");\n  if (!valid) {\n    fontFamilyName = `\"${fontFamilyName.replace(/[\\\\\"]/g, \"\\\\$&\")}\"`;\n  }\n  return fontFamilyName;\n}\nconst validURICharactersRegex = /^[0-9A-Za-z%:/?#\\[\\]@!\\$&'()\\*\\+,;=\\-._~]*$/;\nfunction encodeURIWhenNeeded(uri) {\n  if (validURICharactersRegex.test(uri)) {\n    return uri;\n  }\n  return encodeURI(uri);\n}\nconst loadWebFont = {\n  extension: {\n    type: ExtensionType.LoadParser,\n    priority: LoaderParserPriority.Low\n  },\n  /** used for deprecation purposes */\n  name: \"loadWebFont\",\n  id: \"web-font\",\n  test(url) {\n    return checkDataUrl(url, validFontMIMEs) || checkExtension(url, validFontExtensions);\n  },\n  async load(url, options) {\n    const fonts = DOMAdapter.get().getFontFaceSet();\n    if (fonts) {\n      const fontFaces = [];\n      const name = options.data?.family ?? getFontFamilyName(url);\n      const weights = options.data?.weights?.filter((weight) => validWeights.includes(weight)) ?? [\"normal\"];\n      const data = options.data ?? {};\n      for (let i = 0; i < weights.length; i++) {\n        const weight = weights[i];\n        const font = new FontFace(name, `url(${encodeURIWhenNeeded(url)})`, {\n          ...data,\n          weight\n        });\n        await font.load();\n        fonts.add(font);\n        fontFaces.push(font);\n      }\n      if (Cache.has(`${name}-and-url`)) {\n        const cached = Cache.get(`${name}-and-url`);\n        cached.entries.push({ url, faces: fontFaces });\n      } else {\n        Cache.set(`${name}-and-url`, {\n          entries: [{ url, faces: fontFaces }]\n        });\n      }\n      return fontFaces.length === 1 ? fontFaces[0] : fontFaces;\n    }\n    warn(\"[loadWebFont] FontFace API is not supported. Skipping loading font\");\n    return null;\n  },\n  unload(font) {\n    const fonts = Array.isArray(font) ? font : [font];\n    const fontFamily = fonts[0].family;\n    const cached = Cache.get(`${fontFamily}-and-url`);\n    const entry = cached.entries.find((f) => f.faces.some((t) => fonts.indexOf(t) !== -1));\n    entry.faces = entry.faces.filter((f) => fonts.indexOf(f) === -1);\n    if (entry.faces.length === 0) {\n      cached.entries = cached.entries.filter((f) => f !== entry);\n    }\n    fonts.forEach((t) => {\n      DOMAdapter.get().getFontFaceSet().delete(t);\n    });\n    if (cached.entries.length === 0) {\n      Cache.remove(`${fontFamily}-and-url`);\n    }\n  }\n};\n\nexport { getFontFamilyName, loadWebFont };\n//# sourceMappingURL=loadWebFont.mjs.map\n","import { Resolver } from '../../assets/resolver/Resolver.mjs';\n\n\"use strict\";\nfunction getResolutionOfUrl(url, defaultValue = 1) {\n  const resolution = Resolver.RETINA_PREFIX?.exec(url);\n  if (resolution) {\n    return parseFloat(resolution[1]);\n  }\n  return defaultValue;\n}\n\nexport { getResolutionOfUrl };\n//# sourceMappingURL=getResolutionOfUrl.mjs.map\n","import { Texture } from '../../../../../rendering/renderers/shared/texture/Texture.mjs';\nimport { warn } from '../../../../../utils/logging/warn.mjs';\nimport { Cache } from '../../../../cache/Cache.mjs';\n\n\"use strict\";\nfunction createTexture(source, loader, url) {\n  source.label = url;\n  source._sourceOrigin = url;\n  const texture = new Texture({\n    source,\n    label: url\n  });\n  const unload = () => {\n    delete loader.promiseCache[url];\n    if (Cache.has(url)) {\n      Cache.remove(url);\n    }\n  };\n  texture.source.once(\"destroy\", () => {\n    if (loader.promiseCache[url]) {\n      warn(\"[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource.\");\n      unload();\n    }\n  });\n  texture.once(\"destroy\", () => {\n    if (!source.destroyed) {\n      warn(\"[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture.\");\n      unload();\n    }\n  });\n  return texture;\n}\n\nexport { createTexture };\n//# sourceMappingURL=createTexture.mjs.map\n","import { DOMAdapter } from '../../../../environment/adapter.mjs';\nimport { ExtensionType } from '../../../../extensions/Extensions.mjs';\nimport { ImageSource } from '../../../../rendering/renderers/shared/texture/sources/ImageSource.mjs';\nimport { GraphicsContext } from '../../../../scene/graphics/shared/GraphicsContext.mjs';\nimport { getResolutionOfUrl } from '../../../../utils/network/getResolutionOfUrl.mjs';\nimport { checkDataUrl } from '../../../utils/checkDataUrl.mjs';\nimport { checkExtension } from '../../../utils/checkExtension.mjs';\nimport { LoaderParserPriority } from '../LoaderParser.mjs';\nimport { createTexture } from './utils/createTexture.mjs';\n\n\"use strict\";\nconst validSVGExtension = \".svg\";\nconst validSVGMIME = \"image/svg+xml\";\nconst loadSvg = {\n  extension: {\n    type: ExtensionType.LoadParser,\n    priority: LoaderParserPriority.Low,\n    name: \"loadSVG\"\n  },\n  /** used for deprecation purposes */\n  name: \"loadSVG\",\n  id: \"svg\",\n  config: {\n    crossOrigin: \"anonymous\",\n    parseAsGraphicsContext: false\n  },\n  test(url) {\n    return checkDataUrl(url, validSVGMIME) || checkExtension(url, validSVGExtension);\n  },\n  async load(url, asset, loader) {\n    if (asset.data?.parseAsGraphicsContext ?? this.config.parseAsGraphicsContext) {\n      return loadAsGraphics(url);\n    }\n    return loadAsTexture(url, asset, loader, this.config.crossOrigin);\n  },\n  unload(asset) {\n    asset.destroy(true);\n  }\n};\nasync function loadAsTexture(url, asset, loader, crossOrigin) {\n  const response = await DOMAdapter.get().fetch(url);\n  const image = DOMAdapter.get().createImage();\n  image.src = `data:image/svg+xml;charset=utf-8,${encodeURIComponent(await response.text())}`;\n  image.crossOrigin = crossOrigin;\n  await image.decode();\n  const width = asset.data?.width ?? image.width;\n  const height = asset.data?.height ?? image.height;\n  const resolution = asset.data?.resolution || getResolutionOfUrl(url);\n  const canvasWidth = Math.ceil(width * resolution);\n  const canvasHeight = Math.ceil(height * resolution);\n  const canvas = DOMAdapter.get().createCanvas(canvasWidth, canvasHeight);\n  const context = canvas.getContext(\"2d\");\n  context.imageSmoothingEnabled = true;\n  context.imageSmoothingQuality = \"high\";\n  context.drawImage(image, 0, 0, width * resolution, height * resolution);\n  const { parseAsGraphicsContext: _p, ...rest } = asset.data ?? {};\n  const base = new ImageSource({\n    resource: canvas,\n    alphaMode: \"premultiply-alpha-on-upload\",\n    resolution,\n    ...rest\n  });\n  return createTexture(base, loader, url);\n}\nasync function loadAsGraphics(url) {\n  const response = await DOMAdapter.get().fetch(url);\n  const svgSource = await response.text();\n  const context = new GraphicsContext();\n  context.svg(svgSource);\n  return context;\n}\n\nexport { loadSvg };\n//# sourceMappingURL=loadSVG.mjs.map\n","const WORKER_CODE = \"(function () {\\n    'use strict';\\n\\n    const WHITE_PNG = \\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=\\\";\\n    async function checkImageBitmap() {\\n      try {\\n        if (typeof createImageBitmap !== \\\"function\\\")\\n          return false;\\n        const response = await fetch(WHITE_PNG);\\n        const imageBlob = await response.blob();\\n        const imageBitmap = await createImageBitmap(imageBlob);\\n        return imageBitmap.width === 1 && imageBitmap.height === 1;\\n      } catch (_e) {\\n        return false;\\n      }\\n    }\\n    void checkImageBitmap().then((result) => {\\n      self.postMessage(result);\\n    });\\n\\n})();\\n\";\nlet WORKER_URL = null;\nclass WorkerInstance\n{\n    constructor()\n    {\n        if (!WORKER_URL)\n        {\n            WORKER_URL = URL.createObjectURL(new Blob([WORKER_CODE], { type: 'application/javascript' }));\n        }\n        this.worker = new Worker(WORKER_URL);\n    }\n}\nWorkerInstance.revokeObjectURL = function revokeObjectURL()\n{\n    if (WORKER_URL)\n    {\n        URL.revokeObjectURL(WORKER_URL);\n        WORKER_URL = null;\n    }\n};\n\nexport { WorkerInstance as default };\n//# sourceMappingURL=checkImageBitmap.worker.mjs.map\n","const WORKER_CODE = \"(function () {\\n    'use strict';\\n\\n    async function loadImageBitmap(url, alphaMode) {\\n      const response = await fetch(url);\\n      if (!response.ok) {\\n        throw new Error(`[WorkerManager.loadImageBitmap] Failed to fetch ${url}: ${response.status} ${response.statusText}`);\\n      }\\n      const imageBlob = await response.blob();\\n      return alphaMode === \\\"premultiplied-alpha\\\" ? createImageBitmap(imageBlob, { premultiplyAlpha: \\\"none\\\" }) : createImageBitmap(imageBlob);\\n    }\\n    self.onmessage = async (event) => {\\n      try {\\n        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);\\n        self.postMessage({\\n          data: imageBitmap,\\n          uuid: event.data.uuid,\\n          id: event.data.id\\n        }, [imageBitmap]);\\n      } catch (e) {\\n        self.postMessage({\\n          error: e,\\n          uuid: event.data.uuid,\\n          id: event.data.id\\n        });\\n      }\\n    };\\n\\n})();\\n\";\nlet WORKER_URL = null;\nclass WorkerInstance\n{\n    constructor()\n    {\n        if (!WORKER_URL)\n        {\n            WORKER_URL = URL.createObjectURL(new Blob([WORKER_CODE], { type: 'application/javascript' }));\n        }\n        this.worker = new Worker(WORKER_URL);\n    }\n}\nWorkerInstance.revokeObjectURL = function revokeObjectURL()\n{\n    if (WORKER_URL)\n    {\n        URL.revokeObjectURL(WORKER_URL);\n        WORKER_URL = null;\n    }\n};\n\nexport { WorkerInstance as default };\n//# sourceMappingURL=loadImageBitmap.worker.mjs.map\n","import WorkerInstance from '../../../_virtual/checkImageBitmap.worker.mjs';\nimport WorkerInstance$1 from '../../../_virtual/loadImageBitmap.worker.mjs';\n\n\"use strict\";\nlet UUID = 0;\nlet MAX_WORKERS;\nclass WorkerManagerClass {\n  constructor() {\n    /** Whether the worker manager has been initialized */\n    this._initialized = false;\n    /** Current number of created workers (used to enforce MAX_WORKERS limit) */\n    this._createdWorkers = 0;\n    this._workerPool = [];\n    this._queue = [];\n    this._resolveHash = {};\n  }\n  /**\n   * Checks if ImageBitmap is supported in the current environment.\n   *\n   * This method uses a dedicated worker to test ImageBitmap support\n   * and caches the result for subsequent calls.\n   * @returns Promise that resolves to true if ImageBitmap is supported, false otherwise\n   */\n  isImageBitmapSupported() {\n    if (this._isImageBitmapSupported !== void 0)\n      return this._isImageBitmapSupported;\n    this._isImageBitmapSupported = new Promise((resolve) => {\n      const { worker } = new WorkerInstance();\n      worker.addEventListener(\"message\", (event) => {\n        worker.terminate();\n        WorkerInstance.revokeObjectURL();\n        resolve(event.data);\n      });\n    });\n    return this._isImageBitmapSupported;\n  }\n  /**\n   * Loads an image as an ImageBitmap using a web worker.\n   * @param src - The source URL or path of the image to load\n   * @param asset - Optional resolved asset containing additional texture source options\n   * @returns Promise that resolves to the loaded ImageBitmap\n   * @example\n   * ```typescript\n   * const bitmap = await WorkerManager.loadImageBitmap('image.png');\n   * const bitmapWithOptions = await WorkerManager.loadImageBitmap('image.png', asset);\n   * ```\n   */\n  loadImageBitmap(src, asset) {\n    return this._run(\"loadImageBitmap\", [src, asset?.data?.alphaMode]);\n  }\n  /**\n   * Initializes the worker pool if not already initialized.\n   * Currently a no-op but reserved for future initialization logic.\n   */\n  async _initWorkers() {\n    if (this._initialized)\n      return;\n    this._initialized = true;\n  }\n  /**\n   * Gets an available worker from the pool or creates a new one if needed.\n   *\n   * Workers are created up to the MAX_WORKERS limit (based on navigator.hardwareConcurrency).\n   * Each worker is configured with a message handler for processing results.\n   * @returns Available worker or undefined if pool is at capacity and no workers are free\n   */\n  _getWorker() {\n    if (MAX_WORKERS === void 0) {\n      MAX_WORKERS = navigator.hardwareConcurrency || 4;\n    }\n    let worker = this._workerPool.pop();\n    if (!worker && this._createdWorkers < MAX_WORKERS) {\n      this._createdWorkers++;\n      worker = new WorkerInstance$1().worker;\n      worker.addEventListener(\"message\", (event) => {\n        this._complete(event.data);\n        this._returnWorker(event.target);\n        this._next();\n      });\n    }\n    return worker;\n  }\n  /**\n   * Returns a worker to the pool after completing a task.\n   * @param worker - The worker to return to the pool\n   */\n  _returnWorker(worker) {\n    this._workerPool.push(worker);\n  }\n  /**\n   * Handles completion of a worker task by resolving or rejecting the corresponding promise.\n   * @param data - Result data from the worker containing uuid, data, and optional error\n   */\n  _complete(data) {\n    if (data.error !== void 0) {\n      this._resolveHash[data.uuid].reject(data.error);\n    } else {\n      this._resolveHash[data.uuid].resolve(data.data);\n    }\n    this._resolveHash[data.uuid] = null;\n  }\n  /**\n   * Executes a task using the worker pool system.\n   *\n   * Queues the task and processes it when a worker becomes available.\n   * @param id - Identifier for the type of task to run\n   * @param args - Arguments to pass to the worker\n   * @returns Promise that resolves with the worker's result\n   */\n  async _run(id, args) {\n    await this._initWorkers();\n    const promise = new Promise((resolve, reject) => {\n      this._queue.push({ id, arguments: args, resolve, reject });\n    });\n    this._next();\n    return promise;\n  }\n  /**\n   * Processes the next item in the queue if workers are available.\n   *\n   * This method is called after worker initialization and when workers\n   * complete tasks to continue processing the queue.\n   */\n  _next() {\n    if (!this._queue.length)\n      return;\n    const worker = this._getWorker();\n    if (!worker) {\n      return;\n    }\n    const toDo = this._queue.pop();\n    const id = toDo.id;\n    this._resolveHash[UUID] = { resolve: toDo.resolve, reject: toDo.reject };\n    worker.postMessage({\n      data: toDo.arguments,\n      uuid: UUID++,\n      id\n    });\n  }\n  /**\n   * Resets the worker manager, terminating all workers and clearing the queue.\n   *\n   * This method:\n   * - Terminates all active workers\n   * - Rejects all pending promises with an error\n   * - Clears all internal state\n   * - Resets initialization flags\n   *\n   * This should be called when the worker manager is no longer needed\n   * to prevent memory leaks and ensure proper cleanup.\n   * @example\n   * ```typescript\n   * // Clean up when shutting down\n   * WorkerManager.reset();\n   * ```\n   */\n  reset() {\n    this._workerPool.forEach((worker) => worker.terminate());\n    this._workerPool.length = 0;\n    Object.values(this._resolveHash).forEach(({ reject }) => {\n      reject?.(new Error(\"WorkerManager destroyed\"));\n    });\n    this._resolveHash = {};\n    this._queue.length = 0;\n    this._initialized = false;\n    this._createdWorkers = 0;\n  }\n}\nconst WorkerManager = new WorkerManagerClass();\n\nexport { WorkerManager };\n//# sourceMappingURL=WorkerManager.mjs.map\n","import { DOMAdapter } from '../../../../environment/adapter.mjs';\nimport { ExtensionType } from '../../../../extensions/Extensions.mjs';\nimport { ImageSource } from '../../../../rendering/renderers/shared/texture/sources/ImageSource.mjs';\nimport { getResolutionOfUrl } from '../../../../utils/network/getResolutionOfUrl.mjs';\nimport { checkDataUrl } from '../../../utils/checkDataUrl.mjs';\nimport { checkExtension } from '../../../utils/checkExtension.mjs';\nimport { WorkerManager } from '../../workers/WorkerManager.mjs';\nimport { LoaderParserPriority } from '../LoaderParser.mjs';\nimport { createTexture } from './utils/createTexture.mjs';\n\n\"use strict\";\nconst validImageExtensions = [\".jpeg\", \".jpg\", \".png\", \".webp\", \".avif\"];\nconst validImageMIMEs = [\n  \"image/jpeg\",\n  \"image/png\",\n  \"image/webp\",\n  \"image/avif\"\n];\nasync function loadImageBitmap(url, asset) {\n  const response = await DOMAdapter.get().fetch(url);\n  if (!response.ok) {\n    throw new Error(`[loadImageBitmap] Failed to fetch ${url}: ${response.status} ${response.statusText}`);\n  }\n  const imageBlob = await response.blob();\n  return asset?.data?.alphaMode === \"premultiplied-alpha\" ? createImageBitmap(imageBlob, { premultiplyAlpha: \"none\" }) : createImageBitmap(imageBlob);\n}\nconst loadTextures = {\n  /** used for deprecation purposes */\n  name: \"loadTextures\",\n  id: \"texture\",\n  extension: {\n    type: ExtensionType.LoadParser,\n    priority: LoaderParserPriority.High,\n    name: \"loadTextures\"\n  },\n  config: {\n    preferWorkers: true,\n    preferCreateImageBitmap: true,\n    crossOrigin: \"anonymous\"\n  },\n  test(url) {\n    return checkDataUrl(url, validImageMIMEs) || checkExtension(url, validImageExtensions);\n  },\n  async load(url, asset, loader) {\n    let src = null;\n    if (globalThis.createImageBitmap && this.config.preferCreateImageBitmap) {\n      if (this.config.preferWorkers && await WorkerManager.isImageBitmapSupported()) {\n        src = await WorkerManager.loadImageBitmap(url, asset);\n      } else {\n        src = await loadImageBitmap(url, asset);\n      }\n    } else {\n      src = await new Promise((resolve, reject) => {\n        src = DOMAdapter.get().createImage();\n        src.crossOrigin = this.config.crossOrigin;\n        src.src = url;\n        if (src.complete) {\n          resolve(src);\n        } else {\n          src.onload = () => {\n            resolve(src);\n          };\n          src.onerror = reject;\n        }\n      });\n    }\n    const base = new ImageSource({\n      resource: src,\n      alphaMode: \"premultiply-alpha-on-upload\",\n      resolution: asset.data?.resolution || getResolutionOfUrl(url),\n      ...asset.data\n    });\n    return createTexture(base, loader, url);\n  },\n  unload(texture) {\n    texture.destroy(true);\n  }\n};\n\nexport { loadImageBitmap, loadTextures };\n//# sourceMappingURL=loadTextures.mjs.map\n","import { ExtensionType } from '../../../../extensions/Extensions.mjs';\nimport { VideoSource } from '../../../../rendering/renderers/shared/texture/sources/VideoSource.mjs';\nimport { detectVideoAlphaMode } from '../../../../utils/browser/detectVideoAlphaMode.mjs';\nimport { getResolutionOfUrl } from '../../../../utils/network/getResolutionOfUrl.mjs';\nimport { testVideoFormat } from '../../../detections/utils/testVideoFormat.mjs';\nimport { checkDataUrl } from '../../../utils/checkDataUrl.mjs';\nimport { checkExtension } from '../../../utils/checkExtension.mjs';\nimport { createTexture } from './utils/createTexture.mjs';\n\n\"use strict\";\nconst potentialVideoExtensions = [\".mp4\", \".m4v\", \".webm\", \".ogg\", \".ogv\", \".h264\", \".avi\", \".mov\"];\nlet validVideoExtensions;\nlet validVideoMIMEs;\nfunction crossOrigin(element, url, crossorigin) {\n  if (crossorigin === void 0 && !url.startsWith(\"data:\")) {\n    element.crossOrigin = determineCrossOrigin(url);\n  } else if (crossorigin !== false) {\n    element.crossOrigin = typeof crossorigin === \"string\" ? crossorigin : \"anonymous\";\n  }\n}\nfunction preloadVideo(element) {\n  return new Promise((resolve, reject) => {\n    element.addEventListener(\"canplaythrough\", loaded);\n    element.addEventListener(\"error\", error);\n    element.load();\n    function loaded() {\n      cleanup();\n      resolve();\n    }\n    function error(err) {\n      cleanup();\n      reject(err);\n    }\n    function cleanup() {\n      element.removeEventListener(\"canplaythrough\", loaded);\n      element.removeEventListener(\"error\", error);\n    }\n  });\n}\nfunction determineCrossOrigin(url, loc = globalThis.location) {\n  if (url.startsWith(\"data:\")) {\n    return \"\";\n  }\n  loc || (loc = globalThis.location);\n  const parsedUrl = new URL(url, document.baseURI);\n  if (parsedUrl.hostname !== loc.hostname || parsedUrl.port !== loc.port || parsedUrl.protocol !== loc.protocol) {\n    return \"anonymous\";\n  }\n  return \"\";\n}\nfunction getBrowserSupportedVideoExtensions() {\n  const supportedExtensions = [];\n  const supportedMimes = [];\n  for (const ext of potentialVideoExtensions) {\n    const mimeType = VideoSource.MIME_TYPES[ext.substring(1)] || `video/${ext.substring(1)}`;\n    if (testVideoFormat(mimeType)) {\n      supportedExtensions.push(ext);\n      if (!supportedMimes.includes(mimeType)) {\n        supportedMimes.push(mimeType);\n      }\n    }\n  }\n  return {\n    validVideoExtensions: supportedExtensions,\n    validVideoMime: supportedMimes\n  };\n}\nconst loadVideoTextures = {\n  /** used for deprecation purposes */\n  name: \"loadVideo\",\n  id: \"video\",\n  extension: {\n    type: ExtensionType.LoadParser,\n    name: \"loadVideo\"\n  },\n  test(url) {\n    if (!validVideoExtensions || !validVideoMIMEs) {\n      const { validVideoExtensions: ve, validVideoMime: vm } = getBrowserSupportedVideoExtensions();\n      validVideoExtensions = ve;\n      validVideoMIMEs = vm;\n    }\n    const isValidDataUrl = checkDataUrl(url, validVideoMIMEs);\n    const isValidExtension = checkExtension(url, validVideoExtensions);\n    return isValidDataUrl || isValidExtension;\n  },\n  async load(url, asset, loader) {\n    const options = {\n      ...VideoSource.defaultOptions,\n      resolution: asset.data?.resolution || getResolutionOfUrl(url),\n      alphaMode: asset.data?.alphaMode || await detectVideoAlphaMode(),\n      ...asset.data\n    };\n    const videoElement = document.createElement(\"video\");\n    const attributeMap = {\n      preload: options.autoLoad !== false ? \"auto\" : void 0,\n      \"webkit-playsinline\": options.playsinline !== false ? \"\" : void 0,\n      playsinline: options.playsinline !== false ? \"\" : void 0,\n      muted: options.muted === true ? \"\" : void 0,\n      loop: options.loop === true ? \"\" : void 0,\n      autoplay: options.autoPlay !== false ? \"\" : void 0\n    };\n    Object.keys(attributeMap).forEach((key) => {\n      const value = attributeMap[key];\n      if (value !== void 0)\n        videoElement.setAttribute(key, value);\n    });\n    if (options.muted === true) {\n      videoElement.muted = true;\n    }\n    crossOrigin(videoElement, url, options.crossorigin);\n    const sourceElement = document.createElement(\"source\");\n    let mime;\n    if (options.mime) {\n      mime = options.mime;\n    } else if (url.startsWith(\"data:\")) {\n      mime = url.slice(5, url.indexOf(\";\"));\n    } else if (!url.startsWith(\"blob:\")) {\n      const ext = url.split(\"?\")[0].slice(url.lastIndexOf(\".\") + 1).toLowerCase();\n      mime = VideoSource.MIME_TYPES[ext] || `video/${ext}`;\n    }\n    sourceElement.src = url;\n    if (mime) {\n      sourceElement.type = mime;\n    }\n    return new Promise((resolve) => {\n      const onCanPlay = async () => {\n        const base = new VideoSource({ ...options, resource: videoElement });\n        videoElement.removeEventListener(\"canplay\", onCanPlay);\n        if (asset.data.preload) {\n          await preloadVideo(videoElement);\n        }\n        resolve(createTexture(base, loader, url));\n      };\n      if (options.preload && !options.autoPlay) {\n        videoElement.load();\n      }\n      videoElement.addEventListener(\"canplay\", onCanPlay);\n      videoElement.appendChild(sourceElement);\n    });\n  },\n  unload(texture) {\n    texture.destroy(true);\n  }\n};\n\nexport { crossOrigin, determineCrossOrigin, loadVideoTextures, preloadVideo };\n//# sourceMappingURL=loadVideoTextures.mjs.map\n","import { ExtensionType } from '../../../extensions/Extensions.mjs';\nimport { loadTextures } from '../../loader/parsers/textures/loadTextures.mjs';\nimport { Resolver } from '../Resolver.mjs';\n\n\"use strict\";\nconst resolveTextureUrl = {\n  extension: {\n    type: ExtensionType.ResolveParser,\n    name: \"resolveTexture\"\n  },\n  test: loadTextures.test,\n  parse: (value) => ({\n    resolution: parseFloat(Resolver.RETINA_PREFIX.exec(value)?.[1] ?? \"1\"),\n    format: value.split(\".\").pop(),\n    src: value\n  })\n};\n\nexport { resolveTextureUrl };\n//# sourceMappingURL=resolveTextureUrl.mjs.map\n","import { ExtensionType } from '../../../extensions/Extensions.mjs';\nimport { Resolver } from '../Resolver.mjs';\nimport { resolveTextureUrl } from './resolveTextureUrl.mjs';\n\n\"use strict\";\nconst resolveJsonUrl = {\n  extension: {\n    type: ExtensionType.ResolveParser,\n    priority: -2,\n    name: \"resolveJson\"\n  },\n  test: (value) => Resolver.RETINA_PREFIX.test(value) && value.endsWith(\".json\"),\n  parse: resolveTextureUrl.parse\n};\n\nexport { resolveJsonUrl };\n//# sourceMappingURL=resolveJsonUrl.mjs.map\n","import { extensions, ExtensionType } from '../extensions/Extensions.mjs';\nimport { loadBitmapFont, bitmapFontCachePlugin } from '../scene/text-bitmap/asset/loadBitmapFont.mjs';\nimport { warn } from '../utils/logging/warn.mjs';\nimport { BackgroundLoader } from './BackgroundLoader.mjs';\nimport { Cache } from './cache/Cache.mjs';\nimport { cacheTextureArray } from './cache/parsers/cacheTextureArray.mjs';\nimport { detectAvif } from './detections/parsers/detectAvif.mjs';\nimport { detectDefaults } from './detections/parsers/detectDefaults.mjs';\nimport { detectMp4 } from './detections/parsers/detectMp4.mjs';\nimport { detectOgv } from './detections/parsers/detectOgv.mjs';\nimport { detectWebm } from './detections/parsers/detectWebm.mjs';\nimport { detectWebp } from './detections/parsers/detectWebp.mjs';\nimport { Loader } from './loader/Loader.mjs';\nimport { loadJson } from './loader/parsers/loadJson.mjs';\nimport { loadTxt } from './loader/parsers/loadTxt.mjs';\nimport { loadWebFont } from './loader/parsers/loadWebFont.mjs';\nimport { loadSvg } from './loader/parsers/textures/loadSVG.mjs';\nimport { loadTextures } from './loader/parsers/textures/loadTextures.mjs';\nimport { loadVideoTextures } from './loader/parsers/textures/loadVideoTextures.mjs';\nimport { resolveJsonUrl } from './resolver/parsers/resolveJsonUrl.mjs';\nimport { resolveTextureUrl } from './resolver/parsers/resolveTextureUrl.mjs';\nimport { Resolver } from './resolver/Resolver.mjs';\nimport { convertToList } from './utils/convertToList.mjs';\nimport { isSingleItem } from './utils/isSingleItem.mjs';\n\n\"use strict\";\nclass AssetsClass {\n  constructor() {\n    this._detections = [];\n    this._initialized = false;\n    this.resolver = new Resolver();\n    this.loader = new Loader();\n    this.cache = Cache;\n    this._backgroundLoader = new BackgroundLoader(this.loader);\n    this._backgroundLoader.active = true;\n    this.reset();\n  }\n  /**\n   * Initializes the Assets class with configuration options. While not required,\n   * calling this before loading assets is recommended to set up default behaviors.\n   * @param options - Configuration options for the Assets system\n   * @example\n   * ```ts\n   * // Basic initialization (optional as Assets.load will call this automatically)\n   * await Assets.init();\n   *\n   * // With CDN configuration\n   * await Assets.init({\n   *     basePath: 'https://my-cdn.com/assets/',\n   *     defaultSearchParams: { version: '1.0.0' }\n   * });\n   *\n   * // With manifest and preferences\n   * await Assets.init({\n   *     manifest: {\n   *         bundles: [{\n   *             name: 'game-screen',\n   *             assets: [\n   *                 {\n   *                     alias: 'hero',\n   *                     src: 'hero.{png,webp}',\n   *                     data: { scaleMode: SCALE_MODES.NEAREST }\n   *                 },\n   *                 {\n   *                     alias: 'map',\n   *                     src: 'map.json'\n   *                 }\n   *             ]\n   *         }]\n   *     },\n   *     // Optimize for device capabilities\n   *     texturePreference: {\n   *         resolution: window.devicePixelRatio,\n   *         format: ['webp', 'png']\n   *     },\n   *     // Set global preferences\n   *     preferences: {\n   *         crossOrigin: 'anonymous',\n   *     }\n   * });\n   *\n   * // Load assets after initialization\n   * const heroTexture = await Assets.load('hero');\n   * ```\n   * @remarks\n   * - Can be called only once; subsequent calls will be ignored with a warning\n   * - Format detection runs automatically unless `skipDetections` is true\n   * - The manifest can be a URL to a JSON file or an inline object\n   * @see {@link AssetInitOptions} For all available initialization options\n   * @see {@link AssetsManifest} For manifest format details\n   */\n  async init(options = {}) {\n    if (this._initialized) {\n      warn(\"[Assets]AssetManager already initialized, did you load before calling this Assets.init()?\");\n      return;\n    }\n    this._initialized = true;\n    if (options.defaultSearchParams) {\n      this.resolver.setDefaultSearchParams(options.defaultSearchParams);\n    }\n    if (options.basePath) {\n      this.resolver.basePath = options.basePath;\n    }\n    if (options.bundleIdentifier) {\n      this.resolver.setBundleIdentifier(options.bundleIdentifier);\n    }\n    if (options.manifest) {\n      let manifest = options.manifest;\n      if (typeof manifest === \"string\") {\n        manifest = await this.load(manifest);\n      }\n      this.resolver.addManifest(manifest);\n    }\n    const resolutionPref = options.texturePreference?.resolution ?? 1;\n    const resolution = typeof resolutionPref === \"number\" ? [resolutionPref] : resolutionPref;\n    const formats = await this._detectFormats({\n      preferredFormats: options.texturePreference?.format,\n      skipDetections: options.skipDetections,\n      detections: this._detections\n    });\n    this.resolver.prefer({\n      params: {\n        format: formats,\n        resolution\n      }\n    });\n    if (options.preferences) {\n      this.setPreferences(options.preferences);\n    }\n    if (options.loadOptions) {\n      this.loader.loadOptions = {\n        ...this.loader.loadOptions,\n        ...options.loadOptions\n      };\n    }\n  }\n  /**\n   * Registers assets with the Assets resolver. This method maps keys (aliases) to asset sources,\n   * allowing you to load assets using friendly names instead of direct URLs.\n   * @param assets - The unresolved assets to add to the resolver\n   * @example\n   * ```ts\n   * // Basic usage - single asset\n   * Assets.add({\n   *     alias: 'myTexture',\n   *     src: 'assets/texture.png'\n   * });\n   * const texture = await Assets.load('myTexture');\n   *\n   * // Multiple aliases for the same asset\n   * Assets.add({\n   *     alias: ['hero', 'player'],\n   *     src: 'hero.png'\n   * });\n   * const hero1 = await Assets.load('hero');\n   * const hero2 = await Assets.load('player'); // Same texture\n   *\n   * // Multiple format support\n   * Assets.add({\n   *     alias: 'character',\n   *     src: 'character.{webp,png}' // Will choose best format\n   * });\n   * Assets.add({\n   *     alias: 'character',\n   *     src: ['character.webp', 'character.png'], // Explicitly specify formats\n   * });\n   *\n   * // With texture options\n   * Assets.add({\n   *     alias: 'sprite',\n   *     src: 'sprite.png',\n   *     data: { scaleMode: 'nearest' }\n   * });\n   *\n   * // Multiple assets at once\n   * Assets.add([\n   *     { alias: 'bg', src: 'background.png' },\n   *     { alias: 'music', src: 'music.mp3' },\n   *     { alias: 'spritesheet', src: 'sheet.json', data: { ignoreMultiPack: false } }\n   * ]);\n   * ```\n   * @remarks\n   * - Assets are resolved when loaded, not when added\n   * - Multiple formats use the best available format for the browser\n   * - Adding with same alias overwrites previous definition\n   * - The `data` property is passed to the asset loader\n   * @see {@link Resolver} For details on asset resolution\n   * @see {@link LoaderParser} For asset-specific data options\n   * @advanced\n   */\n  add(assets) {\n    this.resolver.add(assets);\n  }\n  async load(urls, onProgress) {\n    if (!this._initialized) {\n      await this.init();\n    }\n    const singleAsset = isSingleItem(urls);\n    const urlArray = convertToList(urls).map((url) => {\n      if (typeof url !== \"string\") {\n        const aliases = this.resolver.getAlias(url);\n        if (aliases.some((alias) => !this.resolver.hasKey(alias))) {\n          this.add(url);\n        }\n        return Array.isArray(aliases) ? aliases[0] : aliases;\n      }\n      if (!this.resolver.hasKey(url))\n        this.add({ alias: url, src: url });\n      return url;\n    });\n    const resolveResults = this.resolver.resolve(urlArray);\n    const out = await this._mapLoadToResolve(resolveResults, onProgress);\n    return singleAsset ? out[urlArray[0]] : out;\n  }\n  /**\n   * Registers a bundle of assets that can be loaded as a group. Bundles are useful for organizing\n   * assets into logical groups, such as game levels or UI screens.\n   * @param bundleId - Unique identifier for the bundle\n   * @param assets - Assets to include in the bundle\n   * @example\n   * ```ts\n   * // Add a bundle using array format\n   * Assets.addBundle('animals', [\n   *     { alias: 'bunny', src: 'bunny.png' },\n   *     { alias: 'chicken', src: 'chicken.png' },\n   *     { alias: 'thumper', src: 'thumper.png' },\n   * ]);\n   *\n   * // Add a bundle using object format\n   * Assets.addBundle('animals', {\n   *     bunny: 'bunny.png',\n   *     chicken: 'chicken.png',\n   *     thumper: 'thumper.png',\n   * });\n   *\n   * // Add a bundle with advanced options\n   * Assets.addBundle('ui', [\n   *     {\n   *         alias: 'button',\n   *         src: 'button.{webp,png}',\n   *         data: { scaleMode: 'nearest' }\n   *     },\n   *     {\n   *         alias: ['logo', 'brand'],  // Multiple aliases\n   *         src: 'logo.svg',\n   *         data: { resolution: 2 }\n   *     }\n   * ]);\n   *\n   * // Load the bundle\n   * await Assets.loadBundle('animals');\n   *\n   * // Use the loaded assets\n   * const bunny = Sprite.from('bunny');\n   * const chicken = Sprite.from('chicken');\n   * ```\n   * @remarks\n   * - Bundle IDs must be unique\n   * - Assets in bundles are not loaded until `loadBundle` is called\n   * - Bundles can be background loaded using `backgroundLoadBundle`\n   * - Assets in bundles can be loaded individually using their aliases\n   * @see {@link Assets.loadBundle} For loading bundles\n   * @see {@link Assets.backgroundLoadBundle} For background loading bundles\n   * @see {@link Assets.unloadBundle} For unloading bundles\n   * @see {@link AssetsManifest} For manifest format details\n   */\n  addBundle(bundleId, assets) {\n    this.resolver.addBundle(bundleId, assets);\n  }\n  /**\n   * Loads a bundle or multiple bundles of assets. Bundles are collections of related assets\n   * that can be loaded together.\n   * @param bundleIds - Single bundle ID or array of bundle IDs to load\n   * @param onProgress - Optional callback for load progress (0.0 to 1.0)\n   * @returns Promise that resolves with the loaded bundle assets\n   * @example\n   * ```ts\n   * // Define bundles in your manifest\n   * const manifest = {\n   *     bundles: [\n   *         {\n   *             name: 'load-screen',\n   *             assets: [\n   *                 {\n   *                     alias: 'background',\n   *                     src: 'sunset.png',\n   *                 },\n   *                 {\n   *                     alias: 'bar',\n   *                     src: 'load-bar.{png,webp}', // use an array of individual assets\n   *                 },\n   *             ],\n   *         },\n   *         {\n   *             name: 'game-screen',\n   *             assets: [\n   *                 {\n   *                     alias: 'character',\n   *                     src: 'robot.png',\n   *                 },\n   *                 {\n   *                     alias: 'enemy',\n   *                     src: 'bad-guy.png',\n   *                 },\n   *             ],\n   *         },\n   *     ]\n   * };\n   *\n   * // Initialize with manifest\n   * await Assets.init({ manifest });\n   *\n   * // Or add bundles programmatically\n   * Assets.addBundle('load-screen', [...]);\n   * Assets.loadBundle('load-screen');\n   *\n   * // Load a single bundle\n   * await Assets.loadBundle('load-screen');\n   * const bg = Sprite.from('background'); // Uses alias from bundle\n   *\n   * // Load multiple bundles\n   * await Assets.loadBundle([\n   *     'load-screen',\n   *     'game-screen'\n   * ]);\n   *\n   * // Load with progress tracking\n   * await Assets.loadBundle('game-screen', (progress) => {\n   *     console.log(`Loading: ${Math.round(progress * 100)}%`);\n   * });\n   * ```\n   * @remarks\n   * - Bundle assets are cached automatically\n   * - Bundles can be pre-loaded using `backgroundLoadBundle`\n   * - Assets in bundles can be accessed by their aliases\n   * - Progress callback receives values from 0.0 to 1.0\n   * @throws {Error} If the bundle ID doesn't exist in the manifest\n   * @see {@link Assets.addBundle} For adding bundles programmatically\n   * @see {@link Assets.backgroundLoadBundle} For background loading bundles\n   * @see {@link Assets.unloadBundle} For unloading bundles\n   * @see {@link AssetsManifest} For manifest format details\n   */\n  async loadBundle(bundleIds, onProgress) {\n    if (!this._initialized) {\n      await this.init();\n    }\n    let singleAsset = false;\n    if (typeof bundleIds === \"string\") {\n      singleAsset = true;\n      bundleIds = [bundleIds];\n    }\n    const resolveResults = this.resolver.resolveBundle(bundleIds);\n    const out = {};\n    const keys = Object.keys(resolveResults);\n    let total = 0;\n    const counts = [];\n    const _onProgress = () => {\n      onProgress?.(counts.reduce((a, b) => a + b, 0) / total);\n    };\n    const promises = keys.map((bundleId, i) => {\n      const resolveResult = resolveResults[bundleId];\n      const values = Object.values(resolveResult);\n      const totalAssetsToLoad = [...new Set(values.flat())];\n      const progressSize = totalAssetsToLoad.reduce((sum, asset) => sum + (asset.progressSize || 1), 0);\n      counts.push(0);\n      total += progressSize;\n      return this._mapLoadToResolve(resolveResult, (e) => {\n        counts[i] = e * progressSize;\n        _onProgress();\n      }).then((resolveResult2) => {\n        out[bundleId] = resolveResult2;\n      });\n    });\n    await Promise.all(promises);\n    return singleAsset ? out[bundleIds[0]] : out;\n  }\n  /**\n   * Initiates background loading of assets. This allows assets to be loaded passively while other operations\n   * continue, making them instantly available when needed later.\n   *\n   * Background loading is useful for:\n   * - Preloading game levels while in a menu\n   * - Loading non-critical assets during gameplay\n   * - Reducing visible loading screens\n   * @param urls - Single URL/alias or array of URLs/aliases to load in the background\n   * @example\n   * ```ts\n   * // Basic background loading\n   * Assets.backgroundLoad('images/level2-assets.png');\n   *\n   * // Background load multiple assets\n   * Assets.backgroundLoad([\n   *     'images/sprite1.png',\n   *     'images/sprite2.png',\n   *     'images/background.png'\n   * ]);\n   *\n   * // Later, when you need the assets\n   * const textures = await Assets.load([\n   *     'images/sprite1.png',\n   *     'images/sprite2.png'\n   * ]); // Resolves immediately if background loading completed\n   * ```\n   * @remarks\n   * - Background loading happens one asset at a time to avoid blocking the main thread\n   * - Loading can be interrupted safely by calling `Assets.load()`\n   * - Assets are cached as they complete loading\n   * - No progress tracking is available for background loading\n   */\n  async backgroundLoad(urls) {\n    if (!this._initialized) {\n      await this.init();\n    }\n    if (typeof urls === \"string\") {\n      urls = [urls];\n    }\n    const resolveResults = this.resolver.resolve(urls);\n    this._backgroundLoader.add(Object.values(resolveResults));\n  }\n  /**\n   * Initiates background loading of asset bundles. Similar to backgroundLoad but works with\n   * predefined bundles of assets.\n   *\n   * Perfect for:\n   * - Preloading level bundles during gameplay\n   * - Loading UI assets during splash screens\n   * - Preparing assets for upcoming game states\n   * @param bundleIds - Single bundle ID or array of bundle IDs to load in the background\n   * @example\n   * ```ts\n   * // Define bundles in your manifest\n   * await Assets.init({\n   *     manifest: {\n   *         bundles: [\n   *             {\n   *               name: 'home',\n   *               assets: [\n   *                 {\n   *                     alias: 'background',\n   *                     src: 'images/home-bg.png',\n   *                 },\n   *                 {\n   *                     alias: 'logo',\n   *                     src: 'images/logo.png',\n   *                 }\n   *              ]\n   *            },\n   *            {\n   *             name: 'level-1',\n   *             assets: [\n   *                 {\n   *                     alias: 'background',\n   *                     src: 'images/level1/bg.png',\n   *                 },\n   *                 {\n   *                     alias: 'sprites',\n   *                     src: 'images/level1/sprites.json'\n   *                 }\n   *             ]\n   *         }]\n   *     }\n   * });\n   *\n   * // Load the home screen assets right away\n   * await Assets.loadBundle('home');\n   * showHomeScreen();\n   *\n   * // Start background loading while showing home screen\n   * Assets.backgroundLoadBundle('level-1');\n   *\n   * // When player starts level, load completes faster\n   * await Assets.loadBundle('level-1');\n   * hideHomeScreen();\n   * startLevel();\n   * ```\n   * @remarks\n   * - Bundle assets are loaded one at a time\n   * - Loading can be interrupted safely by calling `Assets.loadBundle()`\n   * - Assets are cached as they complete loading\n   * - Requires bundles to be registered via manifest or `addBundle`\n   * @see {@link Assets.addBundle} For adding bundles programmatically\n   * @see {@link Assets.loadBundle} For immediate bundle loading\n   * @see {@link AssetsManifest} For manifest format details\n   */\n  async backgroundLoadBundle(bundleIds) {\n    if (!this._initialized) {\n      await this.init();\n    }\n    if (typeof bundleIds === \"string\") {\n      bundleIds = [bundleIds];\n    }\n    const resolveResults = this.resolver.resolveBundle(bundleIds);\n    Object.values(resolveResults).forEach((resolveResult) => {\n      this._backgroundLoader.add(Object.values(resolveResult));\n    });\n  }\n  /**\n   * Only intended for development purposes.\n   * This will wipe the resolver and caches.\n   * You will need to reinitialize the Asset\n   * @internal\n   */\n  reset() {\n    this.resolver.reset();\n    this.loader.reset();\n    this.cache.reset();\n    this._initialized = false;\n  }\n  get(keys) {\n    if (typeof keys === \"string\") {\n      return Cache.get(keys);\n    }\n    const assets = {};\n    for (let i = 0; i < keys.length; i++) {\n      assets[i] = Cache.get(keys[i]);\n    }\n    return assets;\n  }\n  /**\n   * helper function to map resolved assets back to loaded assets\n   * @param resolveResults - the resolve results from the resolver\n   * @param progressOrLoadOptions - the progress callback or load options\n   */\n  async _mapLoadToResolve(resolveResults, progressOrLoadOptions) {\n    const resolveArray = [...new Set(Object.values(resolveResults))];\n    this._backgroundLoader.active = false;\n    const loadedAssets = await this.loader.load(resolveArray, progressOrLoadOptions);\n    this._backgroundLoader.active = true;\n    const out = {};\n    resolveArray.forEach((resolveResult) => {\n      const asset = loadedAssets[resolveResult.src];\n      const keys = [resolveResult.src];\n      if (resolveResult.alias) {\n        keys.push(...resolveResult.alias);\n      }\n      keys.forEach((key) => {\n        out[key] = asset;\n      });\n      Cache.set(keys, asset);\n    });\n    return out;\n  }\n  /**\n   * Unloads assets and releases them from memory. This method ensures proper cleanup of\n   * loaded assets when they're no longer needed.\n   * @param urls - Single URL/alias or array of URLs/aliases to unload\n   * @example\n   * ```ts\n   * // Unload a single asset\n   * await Assets.unload('images/sprite.png');\n   *\n   * // Unload using an alias\n   * await Assets.unload('hero'); // Unloads the asset registered with 'hero' alias\n   *\n   * // Unload multiple assets\n   * await Assets.unload([\n   *     'images/background.png',\n   *     'images/character.png',\n   *     'hero'\n   * ]);\n   *\n   * // Unload and handle creation of new instances\n   * await Assets.unload('hero');\n   * const newHero = await Assets.load('hero'); // Will load fresh from source\n   * ```\n   * @remarks\n   * > [!WARNING]\n   * > Make sure assets aren't being used before unloading:\n   * > - Remove sprites using the texture\n   * > - Clear any references to the asset\n   * > - Textures will be destroyed and can't be used after unloading\n   * @throws {Error} If the asset is not found in cache\n   */\n  async unload(urls) {\n    if (!this._initialized) {\n      await this.init();\n    }\n    const urlArray = convertToList(urls).map((url) => typeof url !== \"string\" ? url.src : url);\n    const resolveResults = this.resolver.resolve(urlArray);\n    await this._unloadFromResolved(resolveResults);\n  }\n  /**\n   * Unloads all assets in a bundle. Use this to free memory when a bundle's assets\n   * are no longer needed, such as when switching game levels.\n   * @param bundleIds - Single bundle ID or array of bundle IDs to unload\n   * @example\n   * ```ts\n   * // Define and load a bundle\n   * Assets.addBundle('level-1', {\n   *     background: 'level1/bg.png',\n   *     sprites: 'level1/sprites.json',\n   *     music: 'level1/music.mp3'\n   * });\n   *\n   * // Load the bundle\n   * const level1 = await Assets.loadBundle('level-1');\n   *\n   * // Use the assets\n   * const background = Sprite.from(level1.background);\n   *\n   * // When done with the level, unload everything\n   * await Assets.unloadBundle('level-1');\n   * // background sprite is now invalid!\n   *\n   * // Unload multiple bundles\n   * await Assets.unloadBundle([\n   *     'level-1',\n   *     'level-2',\n   *     'ui-elements'\n   * ]);\n   * ```\n   * @remarks\n   * > [!WARNING]\n   * > - All assets in the bundle will be destroyed\n   * > - Bundle needs to be reloaded to use assets again\n   * > - Make sure no sprites or other objects are using the assets\n   * @throws {Error} If the bundle is not found\n   * @see {@link Assets.addBundle} For adding bundles\n   * @see {@link Assets.loadBundle} For loading bundles\n   */\n  async unloadBundle(bundleIds) {\n    if (!this._initialized) {\n      await this.init();\n    }\n    bundleIds = convertToList(bundleIds);\n    const resolveResults = this.resolver.resolveBundle(bundleIds);\n    const promises = Object.keys(resolveResults).map((bundleId) => this._unloadFromResolved(resolveResults[bundleId]));\n    await Promise.all(promises);\n  }\n  async _unloadFromResolved(resolveResult) {\n    const resolveArray = Object.values(resolveResult);\n    resolveArray.forEach((resolveResult2) => {\n      Cache.remove(resolveResult2.src);\n    });\n    await this.loader.unload(resolveArray);\n  }\n  /**\n   * Detects the supported formats for the browser, and returns an array of supported formats, respecting\n   * the users preferred formats order.\n   * @param options - the options to use when detecting formats\n   * @param options.preferredFormats - the preferred formats to use\n   * @param options.skipDetections - if we should skip the detections altogether\n   * @param options.detections - the detections to use\n   * @returns - the detected formats\n   */\n  async _detectFormats(options) {\n    let formats = [];\n    if (options.preferredFormats) {\n      formats = Array.isArray(options.preferredFormats) ? options.preferredFormats : [options.preferredFormats];\n    }\n    for (const detection of options.detections) {\n      if (options.skipDetections || await detection.test()) {\n        formats = await detection.add(formats);\n      } else if (!options.skipDetections) {\n        formats = await detection.remove(formats);\n      }\n    }\n    formats = formats.filter((format, index) => formats.indexOf(format) === index);\n    return formats;\n  }\n  /**\n   * All the detection parsers currently added to the Assets class.\n   * @advanced\n   */\n  get detections() {\n    return this._detections;\n  }\n  /**\n   * Sets global preferences for asset loading behavior. This method configures how assets\n   * are loaded and processed across all parsers.\n   * @param preferences - Asset loading preferences\n   * @example\n   * ```ts\n   * // Basic preferences\n   * Assets.setPreferences({\n   *     crossOrigin: 'anonymous',\n   *     parseAsGraphicsContext: false\n   * });\n   * ```\n   * @remarks\n   * Preferences are applied to all compatible parsers and affect future asset loading.\n   * Common preferences include:\n   * - `crossOrigin`: CORS setting for loaded assets\n   * - `preferWorkers`: Whether to use web workers for loading textures\n   * - `preferCreateImageBitmap`: Use `createImageBitmap` for texture creation. Turning this off will use the `Image` constructor instead.\n   * @see {@link AssetsPreferences} For all available preferences\n   */\n  setPreferences(preferences) {\n    this.loader.parsers.forEach((parser) => {\n      if (!parser.config)\n        return;\n      Object.keys(parser.config).filter((key) => key in preferences).forEach((key) => {\n        parser.config[key] = preferences[key];\n      });\n    });\n  }\n}\nconst Assets = new AssetsClass();\nextensions.handleByList(ExtensionType.LoadParser, Assets.loader.parsers).handleByList(ExtensionType.ResolveParser, Assets.resolver.parsers).handleByList(ExtensionType.CacheParser, Assets.cache.parsers).handleByList(ExtensionType.DetectionParser, Assets.detections);\nextensions.add(\n  cacheTextureArray,\n  detectDefaults,\n  detectAvif,\n  detectWebp,\n  detectMp4,\n  detectOgv,\n  detectWebm,\n  loadJson,\n  loadTxt,\n  loadWebFont,\n  loadSvg,\n  loadTextures,\n  loadVideoTextures,\n  loadBitmapFont,\n  bitmapFontCachePlugin,\n  resolveTextureUrl,\n  resolveJsonUrl\n);\nconst assetKeyMap = {\n  loader: ExtensionType.LoadParser,\n  resolver: ExtensionType.ResolveParser,\n  cache: ExtensionType.CacheParser,\n  detection: ExtensionType.DetectionParser\n};\nextensions.handle(ExtensionType.Asset, (extension) => {\n  const ref = extension.ref;\n  Object.entries(assetKeyMap).filter(([key]) => !!ref[key]).forEach(([key, type]) => extensions.add(Object.assign(\n    ref[key],\n    // Allow the function to optionally define it's own\n    // ExtensionMetadata, the use cases here is priority for LoaderParsers\n    { extension: ref[key].extension ?? type }\n  )));\n}, (extension) => {\n  const ref = extension.ref;\n  Object.keys(assetKeyMap).filter((key) => !!ref[key]).forEach((key) => extensions.remove(ref[key]));\n});\n\nexport { Assets, AssetsClass };\n//# sourceMappingURL=Assets.mjs.map\n","import { deprecation, v8_0_0 } from '../../../utils/logging/deprecation.mjs';\nimport { ViewContainer } from '../../view/ViewContainer.mjs';\nimport { GraphicsContext } from './GraphicsContext.mjs';\n\n\"use strict\";\nclass Graphics extends ViewContainer {\n  /**\n   * Creates a new Graphics object.\n   * @param options - Options for the Graphics.\n   */\n  constructor(options) {\n    if (options instanceof GraphicsContext) {\n      options = { context: options };\n    }\n    const { context, roundPixels, ...rest } = options || {};\n    super({\n      label: \"Graphics\",\n      ...rest\n    });\n    /** @internal */\n    this.renderPipeId = \"graphics\";\n    if (!context) {\n      this._context = this._ownedContext = new GraphicsContext();\n    } else {\n      this._context = context;\n    }\n    this._context.on(\"update\", this.onViewUpdate, this);\n    this.didViewUpdate = true;\n    this.allowChildren = false;\n    this.roundPixels = roundPixels ?? false;\n  }\n  set context(context) {\n    if (context === this._context)\n      return;\n    this._context.off(\"update\", this.onViewUpdate, this);\n    this._context = context;\n    this._context.on(\"update\", this.onViewUpdate, this);\n    this.onViewUpdate();\n  }\n  /**\n   * The underlying graphics context used for drawing operations.\n   * Controls how shapes and paths are rendered.\n   * @example\n   * ```ts\n   * // Create a shared context\n   * const sharedContext = new GraphicsContext();\n   *\n   * // Create graphics objects sharing the same context\n   * const graphics1 = new Graphics();\n   * const graphics2 = new Graphics();\n   *\n   * // Assign shared context\n   * graphics1.context = sharedContext;\n   * graphics2.context = sharedContext;\n   *\n   * // Both graphics will show the same shapes\n   * sharedContext\n   *     .rect(0, 0, 100, 100)\n   *     .fill({ color: 0xff0000 });\n   * ```\n   * @see {@link GraphicsContext} For drawing operations\n   * @see {@link GraphicsOptions} For context configuration\n   */\n  get context() {\n    return this._context;\n  }\n  /**\n   * The local bounds of the graphics object.\n   * Returns the boundaries after all graphical operations but before any transforms.\n   * @example\n   * ```ts\n   * const graphics = new Graphics();\n   *\n   * // Draw a shape\n   * graphics\n   *     .rect(0, 0, 100, 100)\n   *     .fill({ color: 0xff0000 });\n   *\n   * // Get bounds information\n   * const bounds = graphics.bounds;\n   * console.log(bounds.width);  // 100\n   * console.log(bounds.height); // 100\n   * ```\n   * @readonly\n   * @see {@link Bounds} For bounds operations\n   * @see {@link Container#getBounds} For transformed bounds\n   */\n  get bounds() {\n    return this._context.bounds;\n  }\n  /**\n   * Graphics objects do not need to update their bounds as the context handles this.\n   * @private\n   */\n  updateBounds() {\n  }\n  /**\n   * Checks if the object contains the given point.\n   * Returns true if the point lies within the Graphics object's rendered area.\n   * @example\n   * ```ts\n   * const graphics = new Graphics();\n   *\n   * // Draw a shape\n   * graphics\n   *     .rect(0, 0, 100, 100)\n   *     .fill({ color: 0xff0000 });\n   *\n   * // Check point intersection\n   * if (graphics.containsPoint({ x: 50, y: 50 })) {\n   *     console.log('Point is inside rectangle!');\n   * }\n   * ```\n   * @param point - The point to check in local coordinates\n   * @returns True if the point is inside the Graphics object\n   * @see {@link Graphics#bounds} For bounding box checks\n   * @see {@link PointData} For point data structure\n   */\n  containsPoint(point) {\n    return this._context.containsPoint(point);\n  }\n  /**\n   * Destroys this graphics renderable and optionally its context.\n   * @param options - Options parameter. A boolean will act as if all options\n   *\n   * If the context was created by this graphics and `destroy(false)` or `destroy()` is called\n   * then the context will still be destroyed.\n   *\n   * If you want to explicitly not destroy this context that this graphics created,\n   * then you should pass destroy({ context: false })\n   *\n   * If the context was passed in as an argument to the constructor then it will not be destroyed\n   * @example\n   * ```ts\n   * // Destroy the graphics and its context\n   * graphics.destroy();\n   * graphics.destroy(true);\n   * graphics.destroy({ context: true, texture: true, textureSource: true });\n   * ```\n   */\n  destroy(options) {\n    if (this._ownedContext && !options) {\n      this._ownedContext.destroy(options);\n    } else if (options === true || options?.context === true) {\n      this._context.destroy(options);\n    }\n    this._ownedContext = null;\n    this._context = null;\n    super.destroy(options);\n  }\n  _callContextMethod(method, args) {\n    this.context[method](...args);\n    return this;\n  }\n  // --------------------------------------- GraphicsContext methods ---------------------------------------\n  /**\n   * Sets the current fill style of the graphics context.\n   * The fill style can be a color, gradient, pattern, or a complex style object.\n   * @example\n   * ```ts\n   * const graphics = new Graphics();\n   *\n   * // Basic color fill\n   * graphics\n   *     .setFillStyle({ color: 0xff0000 }) // Red fill\n   *     .rect(0, 0, 100, 100)\n   *     .fill();\n   *\n   * // Gradient fill\n   * const gradient = new FillGradient({\n   *    end: { x: 1, y: 0 },\n   *    colorStops: [\n   *         { offset: 0, color: 0xff0000 }, // Red at start\n   *         { offset: 0.5, color: 0x00ff00 }, // Green at middle\n   *         { offset: 1, color: 0x0000ff }, // Blue at end\n   *    ],\n   * });\n   *\n   * graphics\n   *     .setFillStyle(gradient)\n   *     .circle(100, 100, 50)\n   *     .fill();\n   *\n   * // Pattern fill\n   * const pattern = new FillPattern(texture);\n   * graphics\n   *     .setFillStyle({\n   *         fill: pattern,\n   *         alpha: 0.5\n   *     })\n   *     .rect(0, 0, 200, 200)\n   *     .fill();\n   * ```\n   * @param {FillInput} args - The fill style to apply\n   * @returns The Graphics instance for chaining\n   * @see {@link FillStyle} For fill style options\n   * @see {@link FillGradient} For gradient fills\n   * @see {@link FillPattern} For pattern fills\n   */\n  setFillStyle(...args) {\n    return this._callContextMethod(\"setFillStyle\", args);\n  }\n  /**\n   * Sets the current stroke style of the graphics context.\n   * Similar to fill styles, stroke styles can encompass colors, gradients, patterns, or more detailed configurations.\n   * @example\n   * ```ts\n   * const graphics = new Graphics();\n   *\n   * // Basic color stroke\n   * graphics\n   *     .setStrokeStyle({\n   *         width: 2,\n   *         color: 0x000000\n   *     })\n   *     .rect(0, 0, 100, 100)\n   *     .stroke();\n   *\n   * // Complex stroke style\n   * graphics\n   *     .setStrokeStyle({\n   *         width: 4,\n   *         color: 0xff0000,\n   *         alpha: 0.5,\n   *         join: 'round',\n   *         cap: 'round',\n   *         alignment: 0.5\n   *     })\n   *     .circle(100, 100, 50)\n   *     .stroke();\n   *\n   * // Gradient stroke\n   * const gradient = new FillGradient({\n   *    end: { x: 1, y: 0 },\n   *    colorStops: [\n   *         { offset: 0, color: 0xff0000 }, // Red at start\n   *         { offset: 0.5, color: 0x00ff00 }, // Green at middle\n   *         { offset: 1, color: 0x0000ff }, // Blue at end\n   *    ],\n   * });\n   *\n   * graphics\n   *     .setStrokeStyle({\n   *         width: 10,\n   *         fill: gradient\n   *     })\n   *     .poly([0,0, 100,50, 0,100])\n   *     .stroke();\n   * ```\n   * @param {StrokeInput} args - The stroke style to apply\n   * @returns The Graphics instance for chaining\n   * @see {@link StrokeStyle} For stroke style options\n   * @see {@link FillGradient} For gradient strokes\n   * @see {@link FillPattern} For pattern strokes\n   */\n  setStrokeStyle(...args) {\n    return this._callContextMethod(\"setStrokeStyle\", args);\n  }\n  fill(...args) {\n    return this._callContextMethod(\"fill\", args);\n  }\n  /**\n   * Strokes the current path with the current stroke style or specified style.\n   * Outlines the shape using the stroke settings.\n   * @example\n   * ```ts\n   * const graphics = new Graphics();\n   *\n   * // Stroke with direct color\n   * graphics\n   *     .circle(50, 50, 25)\n   *     .stroke({\n   *         width: 2,\n   *         color: 0xff0000\n   *     }); // 2px red stroke\n   *\n   * // Fill with texture\n   * graphics\n   *    .rect(0, 0, 100, 100)\n   *    .stroke(myTexture); // Fill with texture\n   *\n   * // Stroke with gradient\n   * const gradient = new FillGradient({\n   *     end: { x: 1, y: 0 },\n   *     colorStops: [\n   *         { offset: 0, color: 0xff0000 },\n   *         { offset: 0.5, color: 0x00ff00 },\n   *         { offset: 1, color: 0x0000ff },\n   *     ],\n   * });\n   *\n   * graphics\n   *     .rect(0, 0, 100, 100)\n   *     .stroke({\n   *         width: 4,\n   *         fill: gradient,\n   *         alignment: 0.5,\n   *         join: 'round'\n   *     });\n   * ```\n   * @param {StrokeStyle} args - Optional stroke style to apply. Can be:\n   * - A stroke style object with width, color, etc.\n   * - A gradient\n   * - A pattern\n   * If omitted, uses current stroke style.\n   * @returns The Graphics instance for chaining\n   * @see {@link StrokeStyle} For stroke style options\n   * @see {@link FillGradient} For gradient strokes\n   * @see {@link setStrokeStyle} For setting default stroke style\n   */\n  stroke(...args) {\n    return this._callContextMethod(\"stroke\", args);\n  }\n  texture(...args) {\n    return this._callContextMethod(\"texture\", args);\n  }\n  /**\n   * Resets the current path. Any previous path and its commands are discarded and a new path is\n   * started. This is typically called before beginning a new shape or series of drawing commands.\n   * @example\n   * ```ts\n   * const graphics = new Graphics();\n   * graphics\n   *     .circle(150, 150, 50)\n   *     .fill({ color: 0x00ff00 })\n   *     .beginPath() // Starts a new path\n   *     .circle(250, 150, 50)\n   *     .fill({ color: 0x0000ff });\n   * ```\n   * @returns The Graphics instance for chaining\n   * @see {@link Graphics#moveTo} For starting a new subpath\n   * @see {@link Graphics#closePath} For closing the current path\n   */\n  beginPath() {\n    return this._callContextMethod(\"beginPath\", []);\n  }\n  /**\n   * Applies a cutout to the last drawn shape. This is used to create holes or complex shapes by\n   * subtracting a path from the previously drawn path.\n   *\n   * If a hole is not completely in a shape, it will fail to cut correctly.\n   * @example\n   * ```ts\n   * const graphics = new Graphics();\n   *\n   * // Draw outer circle\n   * graphics\n   *     .circle(100, 100, 50)\n   *     .fill({ color: 0xff0000 });\n   *     .circle(100, 100, 25) // Inner circle\n   *     .cut() // Cuts out the inner circle from the outer circle\n   * ```\n   */\n  cut() {\n    return this._callContextMethod(\"cut\", []);\n  }\n  arc(...args) {\n    return this._callContextMethod(\"arc\", args);\n  }\n  arcTo(...args) {\n    return this._callContextMethod(\"arcTo\", args);\n  }\n  arcToSvg(...args) {\n    return this._callContextMethod(\"arcToSvg\", args);\n  }\n  bezierCurveTo(...args) {\n    return this._callContextMethod(\"bezierCurveTo\", args);\n  }\n  /**\n   * Closes the current path by drawing a straight line back to the start point.\n   *\n   * This is useful for completing shapes and ensuring they are properly closed for fills.\n   * @example\n   * ```ts\n   * // Create a triangle with closed path\n   * const graphics = new Graphics();\n   * graphics\n   *     .moveTo(50, 50)\n   *     .lineTo(100, 100)\n   *     .lineTo(0, 100)\n   *     .closePath()\n   * ```\n   * @returns The Graphics instance for method chaining\n   * @see {@link Graphics#beginPath} For starting a new path\n   * @see {@link Graphics#fill} For filling closed paths\n   * @see {@link Graphics#stroke} For stroking paths\n   */\n  closePath() {\n    return this._callContextMethod(\"closePath\", []);\n  }\n  ellipse(...args) {\n    return this._callContextMethod(\"ellipse\", args);\n  }\n  circle(...args) {\n    return this._callContextMethod(\"circle\", args);\n  }\n  path(...args) {\n    return this._callContextMethod(\"path\", args);\n  }\n  lineTo(...args) {\n    return this._callContextMethod(\"lineTo\", args);\n  }\n  moveTo(...args) {\n    return this._callContextMethod(\"moveTo\", args);\n  }\n  quadraticCurveTo(...args) {\n    return this._callContextMethod(\"quadraticCurveTo\", args);\n  }\n  rect(...args) {\n    return this._callContextMethod(\"rect\", args);\n  }\n  roundRect(...args) {\n    return this._callContextMethod(\"roundRect\", args);\n  }\n  poly(...args) {\n    return this._callContextMethod(\"poly\", args);\n  }\n  regularPoly(...args) {\n    return this._callContextMethod(\"regularPoly\", args);\n  }\n  roundPoly(...args) {\n    return this._callContextMethod(\"roundPoly\", args);\n  }\n  roundShape(...args) {\n    return this._callContextMethod(\"roundShape\", args);\n  }\n  filletRect(...args) {\n    return this._callContextMethod(\"filletRect\", args);\n  }\n  chamferRect(...args) {\n    return this._callContextMethod(\"chamferRect\", args);\n  }\n  star(...args) {\n    return this._callContextMethod(\"star\", args);\n  }\n  svg(...args) {\n    return this._callContextMethod(\"svg\", args);\n  }\n  restore(...args) {\n    return this._callContextMethod(\"restore\", args);\n  }\n  /**\n   * Saves the current graphics state onto a stack. The state includes:\n   * - Current transformation matrix\n   * - Current fill style\n   * - Current stroke style\n   * @example\n   * ```ts\n   * const graphics = new Graphics();\n   *\n   * // Save state before complex operations\n   * graphics.save();\n   *\n   * // Create transformed and styled shape\n   * graphics\n   *     .translateTransform(100, 100)\n   *     .rotateTransform(Math.PI / 4)\n   *     .setFillStyle({\n   *         color: 0xff0000,\n   *         alpha: 0.5\n   *     })\n   *     .rect(-25, -25, 50, 50)\n   *     .fill();\n   *\n   * // Restore to original state\n   * graphics.restore();\n   *\n   * // Continue drawing with previous state\n   * graphics\n   *     .circle(50, 50, 25)\n   *     .fill();\n   * ```\n   * @returns The Graphics instance for method chaining\n   * @see {@link Graphics#restore} For restoring the saved state\n   * @see {@link Graphics#setTransform} For setting transformations\n   */\n  save() {\n    return this._callContextMethod(\"save\", []);\n  }\n  /**\n   * Returns the current transformation matrix of the graphics context.\n   * This matrix represents all accumulated transformations including translate, scale, and rotate.\n   * @example\n   * ```ts\n   * const graphics = new Graphics();\n   *\n   * // Apply some transformations\n   * graphics\n   *     .translateTransform(100, 100)\n   *     .rotateTransform(Math.PI / 4);\n   *\n   * // Get the current transform matrix\n   * const matrix = graphics.getTransform();\n   * console.log(matrix.tx, matrix.ty); // 100, 100\n   *\n   * // Use the matrix for other operations\n   * graphics\n   *     .setTransform(matrix)\n   *     .circle(0, 0, 50)\n   *     .fill({ color: 0xff0000 });\n   * ```\n   * @returns The current transformation matrix.\n   * @see {@link Graphics#setTransform} For setting the transform matrix\n   * @see {@link Matrix} For matrix operations\n   */\n  getTransform() {\n    return this.context.getTransform();\n  }\n  /**\n   * Resets the current transformation matrix to the identity matrix, effectively removing\n   * any transformations (rotation, scaling, translation) previously applied.\n   * @example\n   * ```ts\n   * const graphics = new Graphics();\n   *\n   * // Apply transformations\n   * graphics\n   *     .translateTransform(100, 100)\n   *     .scaleTransform(2, 2)\n   *     .circle(0, 0, 25)\n   *     .fill({ color: 0xff0000 });\n   * // Reset transform to default state\n   * graphics\n   *     .resetTransform()\n   *     .circle(50, 50, 25) // Will draw at actual coordinates\n   *     .fill({ color: 0x00ff00 });\n   * ```\n   * @returns The Graphics instance for method chaining\n   * @see {@link Graphics#getTransform} For getting the current transform\n   * @see {@link Graphics#setTransform} For setting a specific transform\n   * @see {@link Graphics#save} For saving the current transform state\n   * @see {@link Graphics#restore} For restoring a previous transform state\n   */\n  resetTransform() {\n    return this._callContextMethod(\"resetTransform\", []);\n  }\n  rotateTransform(...args) {\n    return this._callContextMethod(\"rotate\", args);\n  }\n  scaleTransform(...args) {\n    return this._callContextMethod(\"scale\", args);\n  }\n  setTransform(...args) {\n    return this._callContextMethod(\"setTransform\", args);\n  }\n  transform(...args) {\n    return this._callContextMethod(\"transform\", args);\n  }\n  translateTransform(...args) {\n    return this._callContextMethod(\"translate\", args);\n  }\n  /**\n   * Clears all drawing commands from the graphics context, effectively resetting it.\n   * This includes clearing the current path, fill style, stroke style, and transformations.\n   *\n   * > [!NOTE] Graphics objects are not designed to be continuously cleared and redrawn.\n   * > Instead, they are intended to be used for static or semi-static graphics that\n   * > can be redrawn as needed. Frequent clearing and redrawing may lead to performance issues.\n   * @example\n   * ```ts\n   * const graphics = new Graphics();\n   *\n   * // Draw some shapes\n   * graphics\n   *     .circle(100, 100, 50)\n   *     .fill({ color: 0xff0000 })\n   *     .rect(200, 100, 100, 50)\n   *     .fill({ color: 0x00ff00 });\n   *\n   * // Clear all graphics\n   * graphics.clear();\n   *\n   * // Start fresh with new shapes\n   * graphics\n   *     .circle(150, 150, 30)\n   *     .fill({ color: 0x0000ff });\n   * ```\n   * @returns The Graphics instance for method chaining\n   * @see {@link Graphics#beginPath} For starting a new path without clearing styles\n   * @see {@link Graphics#save} For saving the current state\n   * @see {@link Graphics#restore} For restoring a previous state\n   */\n  clear() {\n    return this._callContextMethod(\"clear\", []);\n  }\n  /**\n   * Gets or sets the current fill style for the graphics context. The fill style determines\n   * how shapes are filled when using the fill() method.\n   * @example\n   * ```ts\n   * const graphics = new Graphics();\n   *\n   * // Basic color fill\n   * graphics.fillStyle = {\n   *     color: 0xff0000,  // Red\n   *     alpha: 1\n   * };\n   *\n   * // Using gradients\n   * const gradient = new FillGradient({\n   *     end: { x: 0, y: 1 }, // Vertical gradient\n   *     stops: [\n   *         { offset: 0, color: 0xff0000, alpha: 1 }, // Start color\n   *         { offset: 1, color: 0x0000ff, alpha: 1 }  // End color\n   *     ]\n   * });\n   *\n   * graphics.fillStyle = {\n   *     fill: gradient,\n   *     alpha: 0.8\n   * };\n   *\n   * // Using patterns\n   * graphics.fillStyle = {\n   *     texture: myTexture,\n   *     alpha: 1,\n   *     matrix: new Matrix()\n   *         .scale(0.5, 0.5)\n   *         .rotate(Math.PI / 4)\n   * };\n   * ```\n   * @type {ConvertedFillStyle}\n   * @see {@link FillStyle} For all available fill style options\n   * @see {@link FillGradient} For creating gradient fills\n   * @see {@link Graphics#fill} For applying the fill to paths\n   */\n  get fillStyle() {\n    return this._context.fillStyle;\n  }\n  set fillStyle(value) {\n    this._context.fillStyle = value;\n  }\n  /**\n   * Gets or sets the current stroke style for the graphics context. The stroke style determines\n   * how paths are outlined when using the stroke() method.\n   * @example\n   * ```ts\n   * const graphics = new Graphics();\n   *\n   * // Basic stroke style\n   * graphics.strokeStyle = {\n   *     width: 2,\n   *     color: 0xff0000,\n   *     alpha: 1\n   * };\n   *\n   * // Using with gradients\n   * const gradient = new FillGradient({\n   *   end: { x: 0, y: 1 },\n   *   stops: [\n   *       { offset: 0, color: 0xff0000, alpha: 1 },\n   *       { offset: 1, color: 0x0000ff, alpha: 1 }\n   *   ]\n   * });\n   *\n   * graphics.strokeStyle = {\n   *     width: 4,\n   *     fill: gradient,\n   *     alignment: 0.5,\n   *     join: 'round',\n   *     cap: 'round'\n   * };\n   *\n   * // Complex stroke settings\n   * graphics.strokeStyle = {\n   *     width: 6,\n   *     color: 0x00ff00,\n   *     alpha: 0.5,\n   *     join: 'miter',\n   *     miterLimit: 10,\n   * };\n   * ```\n   * @see {@link StrokeStyle} For all available stroke style options\n   * @see {@link Graphics#stroke} For applying the stroke to paths\n   */\n  get strokeStyle() {\n    return this._context.strokeStyle;\n  }\n  set strokeStyle(value) {\n    this._context.strokeStyle = value;\n  }\n  /**\n   * Creates a new Graphics object that copies the current graphics content.\n   * The clone can either share the same context (shallow clone) or have its own independent\n   * context (deep clone).\n   * @example\n   * ```ts\n   * const graphics = new Graphics();\n   *\n   * // Create original graphics content\n   * graphics\n   *     .circle(100, 100, 50)\n   *     .fill({ color: 0xff0000 });\n   *\n   * // Create a shallow clone (shared context)\n   * const shallowClone = graphics.clone();\n   *\n   * // Changes to original affect the clone\n   * graphics\n   *     .circle(200, 100, 30)\n   *     .fill({ color: 0x00ff00 });\n   *\n   * // Create a deep clone (independent context)\n   * const deepClone = graphics.clone(true);\n   *\n   * // Modify deep clone independently\n   * deepClone\n   *     .translateTransform(100, 100)\n   *     .circle(0, 0, 40)\n   *     .fill({ color: 0x0000ff });\n   * ```\n   * @param deep - Whether to create a deep clone of the graphics object.\n   *              If false (default), the context will be shared between objects.\n   *              If true, creates an independent copy of the context.\n   * @returns A new Graphics instance with either shared or copied context\n   * @see {@link Graphics#context} For accessing the underlying graphics context\n   * @see {@link GraphicsContext} For understanding the shared context behavior\n   */\n  clone(deep = false) {\n    if (deep) {\n      return new Graphics(this._context.clone());\n    }\n    this._ownedContext = null;\n    const clone = new Graphics(this._context);\n    return clone;\n  }\n  // -------- v7 deprecations ---------\n  /**\n   * @param width\n   * @param color\n   * @param alpha\n   * @deprecated since 8.0.0 Use {@link Graphics#setStrokeStyle} instead\n   */\n  lineStyle(width, color, alpha) {\n    deprecation(v8_0_0, \"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.\");\n    const strokeStyle = {};\n    width && (strokeStyle.width = width);\n    color && (strokeStyle.color = color);\n    alpha && (strokeStyle.alpha = alpha);\n    this.context.strokeStyle = strokeStyle;\n    return this;\n  }\n  /**\n   * @param color\n   * @param alpha\n   * @deprecated since 8.0.0 Use {@link Graphics#fill} instead\n   */\n  beginFill(color, alpha) {\n    deprecation(v8_0_0, \"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.\");\n    const fillStyle = {};\n    if (color !== void 0)\n      fillStyle.color = color;\n    if (alpha !== void 0)\n      fillStyle.alpha = alpha;\n    this.context.fillStyle = fillStyle;\n    return this;\n  }\n  /**\n   * @deprecated since 8.0.0 Use {@link Graphics#fill} instead\n   */\n  endFill() {\n    deprecation(v8_0_0, \"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.\");\n    this.context.fill();\n    const strokeStyle = this.context.strokeStyle;\n    if (strokeStyle.width !== GraphicsContext.defaultStrokeStyle.width || strokeStyle.color !== GraphicsContext.defaultStrokeStyle.color || strokeStyle.alpha !== GraphicsContext.defaultStrokeStyle.alpha) {\n      this.context.stroke();\n    }\n    return this;\n  }\n  /**\n   * @param {...any} args\n   * @deprecated since 8.0.0 Use {@link Graphics#circle} instead\n   */\n  drawCircle(...args) {\n    deprecation(v8_0_0, \"Graphics#drawCircle has been renamed to Graphics#circle\");\n    return this._callContextMethod(\"circle\", args);\n  }\n  /**\n   * @param {...any} args\n   * @deprecated since 8.0.0 Use {@link Graphics#ellipse} instead\n   */\n  drawEllipse(...args) {\n    deprecation(v8_0_0, \"Graphics#drawEllipse has been renamed to Graphics#ellipse\");\n    return this._callContextMethod(\"ellipse\", args);\n  }\n  /**\n   * @param {...any} args\n   * @deprecated since 8.0.0 Use {@link Graphics#poly} instead\n   */\n  drawPolygon(...args) {\n    deprecation(v8_0_0, \"Graphics#drawPolygon has been renamed to Graphics#poly\");\n    return this._callContextMethod(\"poly\", args);\n  }\n  /**\n   * @param {...any} args\n   * @deprecated since 8.0.0 Use {@link Graphics#rect} instead\n   */\n  drawRect(...args) {\n    deprecation(v8_0_0, \"Graphics#drawRect has been renamed to Graphics#rect\");\n    return this._callContextMethod(\"rect\", args);\n  }\n  /**\n   * @param {...any} args\n   * @deprecated since 8.0.0 Use {@link Graphics#roundRect} instead\n   */\n  drawRoundedRect(...args) {\n    deprecation(v8_0_0, \"Graphics#drawRoundedRect has been renamed to Graphics#roundRect\");\n    return this._callContextMethod(\"roundRect\", args);\n  }\n  /**\n   * @param {...any} args\n   * @deprecated since 8.0.0 Use {@link Graphics#star} instead\n   */\n  drawStar(...args) {\n    deprecation(v8_0_0, \"Graphics#drawStar has been renamed to Graphics#star\");\n    return this._callContextMethod(\"star\", args);\n  }\n}\n\nexport { Graphics };\n//# sourceMappingURL=Graphics.mjs.map\n","import { ObservablePoint } from '../../maths/point/ObservablePoint.mjs';\nimport { deprecation, v8_0_0 } from '../../utils/logging/deprecation.mjs';\nimport { ViewContainer } from '../view/ViewContainer.mjs';\n\n\"use strict\";\nclass AbstractText extends ViewContainer {\n  constructor(options, styleClass) {\n    const { text, resolution, style, anchor, width, height, roundPixels, ...rest } = options;\n    super({\n      ...rest\n    });\n    /** @internal */\n    this.batched = true;\n    /** @internal */\n    this._resolution = null;\n    /** @internal */\n    this._autoResolution = true;\n    /** @internal */\n    this._didTextUpdate = true;\n    this._styleClass = styleClass;\n    this.text = text ?? \"\";\n    this.style = style;\n    this.resolution = resolution ?? null;\n    this.allowChildren = false;\n    this._anchor = new ObservablePoint(\n      {\n        _onUpdate: () => {\n          this.onViewUpdate();\n        }\n      }\n    );\n    if (anchor)\n      this.anchor = anchor;\n    this.roundPixels = roundPixels ?? false;\n    if (width !== void 0)\n      this.width = width;\n    if (height !== void 0)\n      this.height = height;\n  }\n  /**\n   * The anchor point of the text that controls the origin point for positioning and rotation.\n   * Can be a number (same value for x/y) or a PointData object.\n   * - (0,0) is top-left\n   * - (0.5,0.5) is center\n   * - (1,1) is bottom-right\n   * ```ts\n   * // Set anchor to center\n   * const text = new Text({\n   *     text: 'Hello Pixi!',\n   *     anchor: 0.5 // Same as { x: 0.5, y: 0.5 }\n   * });\n   * // Set anchor to top-left\n   * const text2 = new Text({\n   *     text: 'Hello Pixi!',\n   *     anchor: { x: 0, y: 0 } // Top-left corner\n   * });\n   * // Set anchor to bottom-right\n   * const text3 = new Text({\n   *     text: 'Hello Pixi!',\n   *     anchor: { x: 1, y: 1 } // Bottom-right corner\n   * });\n   * ```\n   * @default { x: 0, y: 0 }\n   */\n  get anchor() {\n    return this._anchor;\n  }\n  set anchor(value) {\n    typeof value === \"number\" ? this._anchor.set(value) : this._anchor.copyFrom(value);\n  }\n  /**\n   * The text content to display. Use '\\n' for line breaks.\n   * Accepts strings, numbers, or objects with toString() method.\n   * @example\n   * ```ts\n   * const text = new Text({\n   *     text: 'Hello Pixi!',\n   * });\n   * const multilineText = new Text({\n   *     text: 'Line 1\\nLine 2\\nLine 3',\n   * });\n   * const numberText = new Text({\n   *     text: 12345, // Will be converted to '12345'\n   * });\n   * const objectText = new Text({\n   *     text: { toString: () => 'Object Text' }, // Custom toString\n   * });\n   *\n   * // Update text dynamically\n   * text.text = 'Updated Text'; // Re-renders with new text\n   * text.text = 67890; // Updates to '67890'\n   * text.text = { toString: () => 'Dynamic Text' }; // Uses custom toString method\n   * // Clear text\n   * text.text = ''; // Clears the text\n   * ```\n   * @default ''\n   */\n  set text(value) {\n    value = value.toString();\n    if (this._text === value)\n      return;\n    this._text = value;\n    this.onViewUpdate();\n  }\n  get text() {\n    return this._text;\n  }\n  /**\n   * The resolution/device pixel ratio for rendering.\n   * Higher values result in sharper text at the cost of performance.\n   * Set to null for auto-resolution based on device.\n   * @example\n   * ```ts\n   * const text = new Text({\n   *     text: 'Hello Pixi!',\n   *     resolution: 2 // High DPI for sharper text\n   * });\n   * const autoResText = new Text({\n   *     text: 'Auto Resolution',\n   *     resolution: null // Use device's pixel ratio\n   * });\n   * ```\n   * @default null\n   */\n  set resolution(value) {\n    this._autoResolution = value === null;\n    this._resolution = value;\n    this.onViewUpdate();\n  }\n  get resolution() {\n    return this._resolution;\n  }\n  get style() {\n    return this._style;\n  }\n  /**\n   * The style configuration for the text.\n   * Can be a TextStyle instance or a configuration object.\n   * Supports canvas text styles, HTML text styles, and bitmap text styles.\n   * @example\n   * ```ts\n   * const text = new Text({\n   *     text: 'Styled Text',\n   *     style: {\n   *         fontSize: 24,\n   *         fill: 0xff1010, // Red color\n   *         fontFamily: 'Arial',\n   *         align: 'center', // Center alignment\n   *         stroke: { color: '#4a1850', width: 5 }, // Purple stroke\n   *         dropShadow: {\n   *             color: '#000000', // Black shadow\n   *             blur: 4, // Shadow blur\n   *             distance: 6 // Shadow distance\n   *         }\n   *     }\n   * });\n   * const htmlText = new HTMLText({\n   *     text: 'HTML Styled Text',\n   *     style: {\n   *         fontSize: '20px',\n   *         fill: 'blue',\n   *         fontFamily: 'Verdana',\n   *     }\n   * });\n   * const bitmapText = new BitmapText({\n   *     text: 'Bitmap Styled Text',\n   *     style: {\n   *         fontName: 'Arial',\n   *         fontSize: 32,\n   *     }\n   * })\n   *\n   * // Update style dynamically\n   * text.style = {\n   *     fontSize: 30, // Change font size\n   *     fill: 0x00ff00, // Change color to green\n   *     align: 'right', // Change alignment to right\n   *     stroke: { color: '#000000', width: 2 }, // Add black stroke\n   * }\n   */\n  set style(style) {\n    style || (style = {});\n    this._style?.off(\"update\", this.onViewUpdate, this);\n    if (style instanceof this._styleClass) {\n      this._style = style;\n    } else {\n      this._style = new this._styleClass(style);\n    }\n    this._style.on(\"update\", this.onViewUpdate, this);\n    this.onViewUpdate();\n  }\n  /**\n   * The width of the sprite, setting this will actually modify the scale to achieve the value set.\n   * @example\n   * ```ts\n   * // Set width directly\n   * texture.width = 200;\n   * console.log(texture.scale.x); // Scale adjusted to match width\n   *\n   * // For better performance when setting both width and height\n   * texture.setSize(300, 400); // Avoids recalculating bounds twice\n   * ```\n   */\n  get width() {\n    return Math.abs(this.scale.x) * this.bounds.width;\n  }\n  set width(value) {\n    this._setWidth(value, this.bounds.width);\n  }\n  /**\n   * The height of the sprite, setting this will actually modify the scale to achieve the value set.\n   * @example\n   * ```ts\n   * // Set height directly\n   * texture.height = 200;\n   * console.log(texture.scale.y); // Scale adjusted to match height\n   *\n   * // For better performance when setting both width and height\n   * texture.setSize(300, 400); // Avoids recalculating bounds twice\n   * ```\n   */\n  get height() {\n    return Math.abs(this.scale.y) * this.bounds.height;\n  }\n  set height(value) {\n    this._setHeight(value, this.bounds.height);\n  }\n  /**\n   * Retrieves the size of the Text as a [Size]{@link Size} object based on the texture dimensions and scale.\n   * This is faster than getting width and height separately as it only calculates the bounds once.\n   * @example\n   * ```ts\n   * // Basic size retrieval\n   * const text = new Text({\n   *     text: 'Hello Pixi!',\n   *     style: { fontSize: 24 }\n   * });\n   * const size = text.getSize();\n   * console.log(`Size: ${size.width}x${size.height}`);\n   *\n   * // Reuse existing size object\n   * const reuseSize = { width: 0, height: 0 };\n   * text.getSize(reuseSize);\n   * ```\n   * @param out - Optional object to store the size in, to avoid allocating a new object\n   * @returns The size of the Sprite\n   * @see {@link Text#width} For getting just the width\n   * @see {@link Text#height} For getting just the height\n   * @see {@link Text#setSize} For setting both width and height\n   */\n  getSize(out) {\n    out || (out = {});\n    out.width = Math.abs(this.scale.x) * this.bounds.width;\n    out.height = Math.abs(this.scale.y) * this.bounds.height;\n    return out;\n  }\n  /**\n   * Sets the size of the Text to the specified width and height.\n   * This is faster than setting width and height separately as it only recalculates bounds once.\n   * @example\n   * ```ts\n   * // Basic size setting\n   * const text = new Text({\n   *    text: 'Hello Pixi!',\n   *    style: { fontSize: 24 }\n   * });\n   * text.setSize(100, 200); // Width: 100, Height: 200\n   *\n   * // Set uniform size\n   * text.setSize(100); // Sets both width and height to 100\n   *\n   * // Set size with object\n   * text.setSize({\n   *     width: 200,\n   *     height: 300\n   * });\n   * ```\n   * @param value - This can be either a number or a {@link Size} object\n   * @param height - The height to set. Defaults to the value of `width` if not provided\n   * @see {@link Text#width} For setting width only\n   * @see {@link Text#height} For setting height only\n   */\n  setSize(value, height) {\n    if (typeof value === \"object\") {\n      height = value.height ?? value.width;\n      value = value.width;\n    } else {\n      height ?? (height = value);\n    }\n    value !== void 0 && this._setWidth(value, this.bounds.width);\n    height !== void 0 && this._setHeight(height, this.bounds.height);\n  }\n  /**\n   * Checks if the object contains the given point in local coordinates.\n   * Uses the text's bounds for hit testing.\n   * @example\n   * ```ts\n   * // Basic point check\n   * const localPoint = { x: 50, y: 25 };\n   * const contains = text.containsPoint(localPoint);\n   * console.log('Point is inside:', contains);\n   * ```\n   * @param point - The point to check in local coordinates\n   * @returns True if the point is within the text's bounds\n   * @see {@link Container#toLocal} For converting global coordinates to local\n   */\n  containsPoint(point) {\n    const width = this.bounds.width;\n    const height = this.bounds.height;\n    const x1 = -width * this.anchor.x;\n    let y1 = 0;\n    if (point.x >= x1 && point.x <= x1 + width) {\n      y1 = -height * this.anchor.y;\n      if (point.y >= y1 && point.y <= y1 + height)\n        return true;\n    }\n    return false;\n  }\n  /** @internal */\n  onViewUpdate() {\n    if (!this.didViewUpdate)\n      this._didTextUpdate = true;\n    super.onViewUpdate();\n  }\n  /**\n   * Destroys this text renderable and optionally its style texture.\n   * @param options - Options parameter. A boolean will act as if all options\n   *  have been set to that value\n   * @example\n   * // Destroys the text and its style\n   * text.destroy({ style: true, texture: true, textureSource: true });\n   * text.destroy(true);\n   * text.destroy() // Destroys the text, but not its style\n   */\n  destroy(options = false) {\n    super.destroy(options);\n    this.owner = null;\n    this._bounds = null;\n    this._anchor = null;\n    if (typeof options === \"boolean\" ? options : options?.style) {\n      this._style.destroy(options);\n    }\n    this._style = null;\n    this._text = null;\n  }\n  /**\n   * Returns a unique key for this instance.\n   * This key is used for caching.\n   * @returns {string} Unique key for the instance\n   */\n  get styleKey() {\n    return `${this._text}:${this._style.styleKey}:${this._resolution}`;\n  }\n}\nfunction ensureTextOptions(args, name) {\n  let options = args[0] ?? {};\n  if (typeof options === \"string\" || args[1]) {\n    deprecation(v8_0_0, `use new ${name}({ text: \"hi!\", style }) instead`);\n    options = {\n      text: options,\n      style: args[1]\n    };\n  }\n  return options;\n}\n\nexport { AbstractText, ensureTextOptions };\n//# sourceMappingURL=AbstractText.mjs.map\n","import { DOMAdapter } from '../../environment/adapter.mjs';\nimport { nextPow2 } from '../../maths/misc/pow2.mjs';\nimport { Rectangle } from '../../maths/shapes/Rectangle.mjs';\n\n\"use strict\";\nlet _internalCanvas = null;\nlet _internalContext = null;\nfunction ensureInternalCanvas(width, height) {\n  if (!_internalCanvas) {\n    _internalCanvas = DOMAdapter.get().createCanvas(256, 128);\n    _internalContext = _internalCanvas.getContext(\"2d\", { willReadFrequently: true });\n    _internalContext.globalCompositeOperation = \"copy\";\n    _internalContext.globalAlpha = 1;\n  }\n  if (_internalCanvas.width < width || _internalCanvas.height < height) {\n    _internalCanvas.width = nextPow2(width);\n    _internalCanvas.height = nextPow2(height);\n  }\n}\nfunction checkRow(data, width, y) {\n  for (let x = 0, index = 4 * y * width; x < width; ++x, index += 4) {\n    if (data[index + 3] !== 0)\n      return false;\n  }\n  return true;\n}\nfunction checkColumn(data, width, x, top, bottom) {\n  const stride = 4 * width;\n  for (let y = top, index = top * stride + 4 * x; y <= bottom; ++y, index += stride) {\n    if (data[index + 3] !== 0)\n      return false;\n  }\n  return true;\n}\nfunction getCanvasBoundingBox(...args) {\n  let options = args[0];\n  if (!options.canvas) {\n    options = { canvas: args[0], resolution: args[1] };\n  }\n  const { canvas } = options;\n  const resolution = Math.min(options.resolution ?? 1, 1);\n  const width = options.width ?? canvas.width;\n  const height = options.height ?? canvas.height;\n  let output = options.output;\n  ensureInternalCanvas(width, height);\n  if (!_internalContext) {\n    throw new TypeError(\"Failed to get canvas 2D context\");\n  }\n  _internalContext.drawImage(\n    canvas,\n    0,\n    0,\n    width,\n    height,\n    0,\n    0,\n    width * resolution,\n    height * resolution\n  );\n  const imageData = _internalContext.getImageData(0, 0, width, height);\n  const data = imageData.data;\n  let left = 0;\n  let top = 0;\n  let right = width - 1;\n  let bottom = height - 1;\n  while (top < height && checkRow(data, width, top))\n    ++top;\n  if (top === height)\n    return Rectangle.EMPTY;\n  while (checkRow(data, width, bottom))\n    --bottom;\n  while (checkColumn(data, width, left, top, bottom))\n    ++left;\n  while (checkColumn(data, width, right, top, bottom))\n    --right;\n  ++right;\n  ++bottom;\n  _internalContext.globalCompositeOperation = \"source-over\";\n  _internalContext.strokeRect(left, top, right - left, bottom - top);\n  _internalContext.globalCompositeOperation = \"copy\";\n  output ?? (output = new Rectangle());\n  output.set(left / resolution, top / resolution, (right - left) / resolution, (bottom - top) / resolution);\n  return output;\n}\n\nexport { getCanvasBoundingBox };\n//# sourceMappingURL=getCanvasBoundingBox.mjs.map\n","import { Color } from '../../../color/Color.mjs';\nimport { Rectangle } from '../../../maths/shapes/Rectangle.mjs';\nimport { CanvasPool } from '../../../rendering/renderers/shared/texture/CanvasPool.mjs';\nimport { getCanvasBoundingBox } from '../../../utils/canvas/getCanvasBoundingBox.mjs';\nimport { CanvasTextMetrics } from './CanvasTextMetrics.mjs';\nimport { fontStringFromTextStyle } from './utils/fontStringFromTextStyle.mjs';\nimport { getCanvasFillStyle } from './utils/getCanvasFillStyle.mjs';\n\n\"use strict\";\nconst tempRect = new Rectangle();\nclass CanvasTextGeneratorClass {\n  /**\n   * Creates a canvas with the specified text rendered to it.\n   *\n   * Generates a canvas of appropriate size, renders the text with the provided style,\n   * and returns both the canvas/context and a Rectangle representing the text bounds.\n   *\n   * When trim is enabled in the style, the frame will represent the bounds of the\n   * non-transparent pixels, which can be smaller than the full canvas.\n   * @param options - The options for generating the text canvas\n   * @param options.text - The text to render\n   * @param options.style - The style to apply to the text\n   * @param options.resolution - The resolution of the canvas (defaults to 1)\n   * @param options.padding\n   * @returns An object containing the canvas/context and the frame (bounds) of the text\n   */\n  getCanvasAndContext(options) {\n    const { text, style, resolution = 1 } = options;\n    const padding = style._getFinalPadding();\n    const measured = CanvasTextMetrics.measureText(text || \" \", style);\n    const width = Math.ceil(Math.ceil(Math.max(1, measured.width) + padding * 2) * resolution);\n    const height = Math.ceil(Math.ceil(Math.max(1, measured.height) + padding * 2) * resolution);\n    const canvasAndContext = CanvasPool.getOptimalCanvasAndContext(width, height);\n    this._renderTextToCanvas(text, style, padding, resolution, canvasAndContext);\n    const frame = style.trim ? getCanvasBoundingBox({ canvas: canvasAndContext.canvas, width, height, resolution: 1, output: tempRect }) : tempRect.set(0, 0, width, height);\n    return {\n      canvasAndContext,\n      frame\n    };\n  }\n  /**\n   * Returns a canvas and context to the pool.\n   *\n   * This should be called when you're done with the canvas to allow reuse\n   * and prevent memory leaks.\n   * @param canvasAndContext - The canvas and context to return to the pool\n   */\n  returnCanvasAndContext(canvasAndContext) {\n    CanvasPool.returnCanvasAndContext(canvasAndContext);\n  }\n  /**\n   * Renders text to its canvas, and updates its texture.\n   * @param text - The text to render\n   * @param style - The style of the text\n   * @param padding - The padding of the text\n   * @param resolution - The resolution of the text\n   * @param canvasAndContext - The canvas and context to render the text to\n   */\n  _renderTextToCanvas(text, style, padding, resolution, canvasAndContext) {\n    const { canvas, context } = canvasAndContext;\n    const font = fontStringFromTextStyle(style);\n    const measured = CanvasTextMetrics.measureText(text || \" \", style);\n    const lines = measured.lines;\n    const lineHeight = measured.lineHeight;\n    const lineWidths = measured.lineWidths;\n    const maxLineWidth = measured.maxLineWidth;\n    const fontProperties = measured.fontProperties;\n    const height = canvas.height;\n    context.resetTransform();\n    context.scale(resolution, resolution);\n    context.textBaseline = style.textBaseline;\n    if (style._stroke?.width) {\n      const strokeStyle = style._stroke;\n      context.lineWidth = strokeStyle.width;\n      context.miterLimit = strokeStyle.miterLimit;\n      context.lineJoin = strokeStyle.join;\n      context.lineCap = strokeStyle.cap;\n    }\n    context.font = font;\n    let linePositionX;\n    let linePositionY;\n    const passesCount = style.dropShadow ? 2 : 1;\n    for (let i = 0; i < passesCount; ++i) {\n      const isShadowPass = style.dropShadow && i === 0;\n      const dsOffsetText = isShadowPass ? Math.ceil(Math.max(1, height) + padding * 2) : 0;\n      const dsOffsetShadow = dsOffsetText * resolution;\n      if (isShadowPass) {\n        context.fillStyle = \"black\";\n        context.strokeStyle = \"black\";\n        const shadowOptions = style.dropShadow;\n        const dropShadowColor = shadowOptions.color;\n        const dropShadowAlpha = shadowOptions.alpha;\n        context.shadowColor = Color.shared.setValue(dropShadowColor).setAlpha(dropShadowAlpha).toRgbaString();\n        const dropShadowBlur = shadowOptions.blur * resolution;\n        const dropShadowDistance = shadowOptions.distance * resolution;\n        context.shadowBlur = dropShadowBlur;\n        context.shadowOffsetX = Math.cos(shadowOptions.angle) * dropShadowDistance;\n        context.shadowOffsetY = Math.sin(shadowOptions.angle) * dropShadowDistance + dsOffsetShadow;\n      } else {\n        context.fillStyle = style._fill ? getCanvasFillStyle(style._fill, context, measured, padding * 2) : null;\n        if (style._stroke?.width) {\n          const strokePadding = style._stroke.width * 0.5 + padding * 2;\n          context.strokeStyle = getCanvasFillStyle(style._stroke, context, measured, strokePadding);\n        }\n        context.shadowColor = \"black\";\n      }\n      let linePositionYShift = (lineHeight - fontProperties.fontSize) / 2;\n      if (lineHeight - fontProperties.fontSize < 0) {\n        linePositionYShift = 0;\n      }\n      const strokeWidth = style._stroke?.width ?? 0;\n      for (let i2 = 0; i2 < lines.length; i2++) {\n        linePositionX = strokeWidth / 2;\n        linePositionY = strokeWidth / 2 + i2 * lineHeight + fontProperties.ascent + linePositionYShift;\n        if (style.align === \"right\") {\n          linePositionX += maxLineWidth - lineWidths[i2];\n        } else if (style.align === \"center\") {\n          linePositionX += (maxLineWidth - lineWidths[i2]) / 2;\n        }\n        if (style._stroke?.width) {\n          this._drawLetterSpacing(\n            lines[i2],\n            style,\n            canvasAndContext,\n            linePositionX + padding,\n            linePositionY + padding - dsOffsetText,\n            true\n          );\n        }\n        if (style._fill !== void 0) {\n          this._drawLetterSpacing(\n            lines[i2],\n            style,\n            canvasAndContext,\n            linePositionX + padding,\n            linePositionY + padding - dsOffsetText\n          );\n        }\n      }\n    }\n  }\n  /**\n   * Render the text with letter-spacing.\n   *\n   * This method handles rendering text with the correct letter spacing, using either:\n   * 1. Native letter spacing if supported by the browser\n   * 2. Manual letter spacing calculation if not natively supported\n   *\n   * For manual letter spacing, it calculates the position of each character\n   * based on its width and the desired spacing.\n   * @param text - The text to draw\n   * @param style - The text style to apply\n   * @param canvasAndContext - The canvas and context to draw to\n   * @param x - Horizontal position to draw the text\n   * @param y - Vertical position to draw the text\n   * @param isStroke - Whether to render the stroke (true) or fill (false)\n   * @private\n   */\n  _drawLetterSpacing(text, style, canvasAndContext, x, y, isStroke = false) {\n    const { context } = canvasAndContext;\n    const letterSpacing = style.letterSpacing;\n    let useExperimentalLetterSpacing = false;\n    if (CanvasTextMetrics.experimentalLetterSpacingSupported) {\n      if (CanvasTextMetrics.experimentalLetterSpacing) {\n        context.letterSpacing = `${letterSpacing}px`;\n        context.textLetterSpacing = `${letterSpacing}px`;\n        useExperimentalLetterSpacing = true;\n      } else {\n        context.letterSpacing = \"0px\";\n        context.textLetterSpacing = \"0px\";\n      }\n    }\n    if (letterSpacing === 0 || useExperimentalLetterSpacing) {\n      if (isStroke) {\n        context.strokeText(text, x, y);\n      } else {\n        context.fillText(text, x, y);\n      }\n      return;\n    }\n    let currentPosition = x;\n    const stringArray = CanvasTextMetrics.graphemeSegmenter(text);\n    let previousWidth = context.measureText(text).width;\n    let currentWidth = 0;\n    for (let i = 0; i < stringArray.length; ++i) {\n      const currentChar = stringArray[i];\n      if (isStroke) {\n        context.strokeText(currentChar, currentPosition, y);\n      } else {\n        context.fillText(currentChar, currentPosition, y);\n      }\n      let textStr = \"\";\n      for (let j = i + 1; j < stringArray.length; ++j) {\n        textStr += stringArray[j];\n      }\n      currentWidth = context.measureText(textStr).width;\n      currentPosition += previousWidth - currentWidth + letterSpacing;\n      previousWidth = currentWidth;\n    }\n  }\n}\nconst CanvasTextGenerator = new CanvasTextGeneratorClass();\n\nexport { CanvasTextGenerator };\n//# sourceMappingURL=CanvasTextGenerator.mjs.map\n","import { TextureStyle } from '../../rendering/renderers/shared/texture/TextureStyle.mjs';\nimport { AbstractText, ensureTextOptions } from './AbstractText.mjs';\nimport { CanvasTextGenerator } from './canvas/CanvasTextGenerator.mjs';\nimport { CanvasTextMetrics } from './canvas/CanvasTextMetrics.mjs';\nimport { TextStyle } from './TextStyle.mjs';\n\n\"use strict\";\nclass Text extends AbstractText {\n  constructor(...args) {\n    const options = ensureTextOptions(args, \"Text\");\n    super(options, TextStyle);\n    /** @internal */\n    this.renderPipeId = \"text\";\n    if (options.textureStyle) {\n      this.textureStyle = options.textureStyle instanceof TextureStyle ? options.textureStyle : new TextureStyle(options.textureStyle);\n    }\n  }\n  /** @private */\n  updateBounds() {\n    const bounds = this._bounds;\n    const anchor = this._anchor;\n    let width = 0;\n    let height = 0;\n    if (this._style.trim) {\n      const { frame, canvasAndContext } = CanvasTextGenerator.getCanvasAndContext({\n        text: this.text,\n        style: this._style,\n        resolution: 1\n      });\n      CanvasTextGenerator.returnCanvasAndContext(canvasAndContext);\n      width = frame.width;\n      height = frame.height;\n    } else {\n      const canvasMeasurement = CanvasTextMetrics.measureText(\n        this._text,\n        this._style\n      );\n      width = canvasMeasurement.width;\n      height = canvasMeasurement.height;\n    }\n    bounds.minX = -anchor._x * width;\n    bounds.maxX = bounds.minX + width;\n    bounds.minY = -anchor._y * height;\n    bounds.maxY = bounds.minY + height;\n  }\n}\n\nexport { Text };\n//# sourceMappingURL=Text.mjs.map\n","import { browserExt } from './environment-browser/browserExt.mjs';\nimport { webworkerExt } from './environment-webworker/webworkerExt.mjs';\nimport { extensions } from './extensions/Extensions.mjs';\nexport { ExtensionType, normalizeExtensionPriority } from './extensions/Extensions.mjs';\nimport './rendering/init.mjs';\nimport './spritesheet/init.mjs';\nimport './accessibility/index.mjs';\nimport './advanced-blend-modes/index.mjs';\nimport './app/index.mjs';\nimport './assets/index.mjs';\nimport './color/index.mjs';\nimport './compressed-textures/index.mjs';\nimport './culling/index.mjs';\nimport './dom/index.mjs';\nimport './environment/index.mjs';\nimport './environment-browser/index.mjs';\nimport './environment-webworker/index.mjs';\nimport './events/index.mjs';\nimport './extensions/index.mjs';\nimport './filters/index.mjs';\nimport './maths/index.mjs';\nimport './prepare/index.mjs';\nimport './rendering/index.mjs';\nimport './scene/index.mjs';\nimport './spritesheet/index.mjs';\nimport './ticker/index.mjs';\nimport './utils/index.mjs';\nexport { AccessibilitySystem } from './accessibility/AccessibilitySystem.mjs';\nexport { accessibilityTarget } from './accessibility/accessibilityTarget.mjs';\nexport { ColorBlend } from './advanced-blend-modes/ColorBlend.mjs';\nexport { ColorBurnBlend } from './advanced-blend-modes/ColorBurnBlend.mjs';\nexport { ColorDodgeBlend } from './advanced-blend-modes/ColorDodgeBlend.mjs';\nexport { DarkenBlend } from './advanced-blend-modes/DarkenBlend.mjs';\nexport { DifferenceBlend } from './advanced-blend-modes/DifferenceBlend.mjs';\nexport { DivideBlend } from './advanced-blend-modes/DivideBlend.mjs';\nexport { ExclusionBlend } from './advanced-blend-modes/ExclusionBlend.mjs';\nexport { HardLightBlend } from './advanced-blend-modes/HardLightBlend.mjs';\nexport { HardMixBlend } from './advanced-blend-modes/HardMixBlend.mjs';\nexport { LightenBlend } from './advanced-blend-modes/LightenBlend.mjs';\nexport { LinearBurnBlend } from './advanced-blend-modes/LinearBurnBlend.mjs';\nexport { LinearDodgeBlend } from './advanced-blend-modes/LinearDodgeBlend.mjs';\nexport { LinearLightBlend } from './advanced-blend-modes/LinearLightBlend.mjs';\nexport { LuminosityBlend } from './advanced-blend-modes/LuminosityBlend.mjs';\nexport { NegationBlend } from './advanced-blend-modes/NegationBlend.mjs';\nexport { OverlayBlend } from './advanced-blend-modes/OverlayBlend.mjs';\nexport { PinLightBlend } from './advanced-blend-modes/PinLightBlend.mjs';\nexport { SaturationBlend } from './advanced-blend-modes/SaturationBlend.mjs';\nexport { SoftLightBlend } from './advanced-blend-modes/SoftLightBlend.mjs';\nexport { SubtractBlend } from './advanced-blend-modes/SubtractBlend.mjs';\nexport { VividLightBlend } from './advanced-blend-modes/VividLightBlend.mjs';\nexport { Application } from './app/Application.mjs';\nexport { ResizePlugin } from './app/ResizePlugin.mjs';\nexport { TickerPlugin } from './app/TickerPlugin.mjs';\nexport { Assets, AssetsClass } from './assets/Assets.mjs';\nexport { BackgroundLoader } from './assets/BackgroundLoader.mjs';\nexport { Cache } from './assets/cache/Cache.mjs';\nexport { cacheTextureArray } from './assets/cache/parsers/cacheTextureArray.mjs';\nexport { detectAvif } from './assets/detections/parsers/detectAvif.mjs';\nexport { detectDefaults } from './assets/detections/parsers/detectDefaults.mjs';\nexport { detectMp4 } from './assets/detections/parsers/detectMp4.mjs';\nexport { detectOgv } from './assets/detections/parsers/detectOgv.mjs';\nexport { detectWebm } from './assets/detections/parsers/detectWebm.mjs';\nexport { detectWebp } from './assets/detections/parsers/detectWebp.mjs';\nexport { testImageFormat } from './assets/detections/utils/testImageFormat.mjs';\nexport { testVideoFormat } from './assets/detections/utils/testVideoFormat.mjs';\nexport { Loader } from './assets/loader/Loader.mjs';\nexport { LoaderParserPriority } from './assets/loader/parsers/LoaderParser.mjs';\nexport { loadJson } from './assets/loader/parsers/loadJson.mjs';\nexport { loadTxt } from './assets/loader/parsers/loadTxt.mjs';\nexport { getFontFamilyName, loadWebFont } from './assets/loader/parsers/loadWebFont.mjs';\nexport { loadSvg } from './assets/loader/parsers/textures/loadSVG.mjs';\nexport { loadImageBitmap, loadTextures } from './assets/loader/parsers/textures/loadTextures.mjs';\nexport { crossOrigin, determineCrossOrigin, loadVideoTextures, preloadVideo } from './assets/loader/parsers/textures/loadVideoTextures.mjs';\nexport { createTexture } from './assets/loader/parsers/textures/utils/createTexture.mjs';\nexport { WorkerManager } from './assets/loader/workers/WorkerManager.mjs';\nexport { resolveJsonUrl } from './assets/resolver/parsers/resolveJsonUrl.mjs';\nexport { resolveTextureUrl } from './assets/resolver/parsers/resolveTextureUrl.mjs';\nexport { Resolver, getUrlExtension } from './assets/resolver/Resolver.mjs';\nexport { checkDataUrl } from './assets/utils/checkDataUrl.mjs';\nexport { checkExtension } from './assets/utils/checkExtension.mjs';\nexport { convertToList } from './assets/utils/convertToList.mjs';\nexport { copySearchParams } from './assets/utils/copySearchParams.mjs';\nexport { createStringVariations } from './assets/utils/createStringVariations.mjs';\nexport { isSingleItem } from './assets/utils/isSingleItem.mjs';\nexport { Color } from './color/Color.mjs';\nexport { detectBasis } from './compressed-textures/basis/detectBasis.mjs';\nexport { loadBasis } from './compressed-textures/basis/loadBasis.mjs';\nexport { createLevelBuffers } from './compressed-textures/basis/utils/createLevelBuffers.mjs';\nexport { gpuFormatToBasisTranscoderFormat } from './compressed-textures/basis/utils/gpuFormatToBasisTranscoderFormat.mjs';\nexport { basisTranscoderUrls, setBasisTranscoderPath } from './compressed-textures/basis/utils/setBasisTranscoderPath.mjs';\nexport { loadBasisOnWorker } from './compressed-textures/basis/worker/loadBasisOnWorker.mjs';\nexport { D3D10_RESOURCE_DIMENSION, D3DFMT, DDS, DXGI_FORMAT, DXGI_TO_TEXTURE_FORMAT, FOURCC_TO_TEXTURE_FORMAT, TEXTURE_FORMAT_BLOCK_SIZE } from './compressed-textures/dds/const.mjs';\nexport { loadDDS } from './compressed-textures/dds/loadDDS.mjs';\nexport { parseDDS } from './compressed-textures/dds/parseDDS.mjs';\nexport { loadKTX } from './compressed-textures/ktx/loadKTX.mjs';\nexport { parseKTX } from './compressed-textures/ktx/parseKTX.mjs';\nexport { GL_INTERNAL_FORMAT, KTX } from './compressed-textures/ktx2/const.mjs';\nexport { loadKTX2 } from './compressed-textures/ktx2/loadKTX2.mjs';\nexport { convertFormatIfRequired } from './compressed-textures/ktx2/utils/convertFormatIfRequired.mjs';\nexport { createLevelBuffersFromKTX } from './compressed-textures/ktx2/utils/createLevelBuffersFromKTX.mjs';\nexport { getTextureFormatFromKTXTexture } from './compressed-textures/ktx2/utils/getTextureFormatFromKTXTexture.mjs';\nexport { glFormatToGPUFormat } from './compressed-textures/ktx2/utils/glFormatToGPUFormat.mjs';\nexport { gpuFormatToKTXBasisTranscoderFormat } from './compressed-textures/ktx2/utils/gpuFormatToKTXBasisTranscoderFormat.mjs';\nexport { ktxTranscoderUrls, setKTXTranscoderPath } from './compressed-textures/ktx2/utils/setKTXTranscoderPath.mjs';\nexport { vkFormatToGPUFormat } from './compressed-textures/ktx2/utils/vkFormatToGPUFormat.mjs';\nexport { loadKTX2onWorker } from './compressed-textures/ktx2/worker/loadKTX2onWorker.mjs';\nexport { detectCompressed } from './compressed-textures/shared/detectCompressed.mjs';\nexport { resolveCompressedTextureUrl, validFormats } from './compressed-textures/shared/resolveCompressedTextureUrl.mjs';\nexport { Culler } from './culling/Culler.mjs';\nexport { CullerPlugin } from './culling/CullerPlugin.mjs';\nexport { cullingMixin } from './culling/cullingMixin.mjs';\nexport { CanvasObserver } from './dom/CanvasObserver.mjs';\nexport { DOMContainer } from './dom/DOMContainer.mjs';\nexport { DOMPipe } from './dom/DOMPipe.mjs';\nexport { DOMAdapter } from './environment/adapter.mjs';\nexport { autoDetectEnvironment, loadEnvironmentExtensions } from './environment/autoDetectEnvironment.mjs';\nexport { BrowserAdapter } from './environment-browser/BrowserAdapter.mjs';\nexport { WebWorkerAdapter } from './environment-webworker/WebWorkerAdapter.mjs';\nexport { EventBoundary } from './events/EventBoundary.mjs';\nexport { EventSystem } from './events/EventSystem.mjs';\nexport { EventsTicker } from './events/EventTicker.mjs';\nexport { FederatedEvent } from './events/FederatedEvent.mjs';\nexport { FederatedContainer } from './events/FederatedEventTarget.mjs';\nexport { FederatedMouseEvent } from './events/FederatedMouseEvent.mjs';\nexport { FederatedPointerEvent } from './events/FederatedPointerEvent.mjs';\nexport { FederatedWheelEvent } from './events/FederatedWheelEvent.mjs';\nexport { default as blendTemplateFrag } from './filters/blend-modes/blend-template.frag.mjs';\nexport { default as blendTemplateVert } from './filters/blend-modes/blend-template.vert.mjs';\nexport { default as blendTemplateWgsl } from './filters/blend-modes/blend-template.wgsl.mjs';\nexport { default as hslWgsl } from './filters/blend-modes/hsl.wgsl.mjs';\nexport { default as alphaFrag } from './filters/defaults/alpha/alpha.frag.mjs';\nexport { default as alphaWgsl } from './filters/defaults/alpha/alpha.wgsl.mjs';\nexport { default as blurTemplateWgsl } from './filters/defaults/blur/gpu/blur-template.wgsl.mjs';\nexport { default as colorMatrixFilterFrag } from './filters/defaults/color-matrix/colorMatrixFilter.frag.mjs';\nexport { default as colorMatrixFilterWgsl } from './filters/defaults/color-matrix/colorMatrixFilter.wgsl.mjs';\nexport { default as defaultFilterVert } from './filters/defaults/defaultFilter.vert.mjs';\nexport { default as displacementFrag } from './filters/defaults/displacement/displacement.frag.mjs';\nexport { default as displacementVert } from './filters/defaults/displacement/displacement.vert.mjs';\nexport { default as displacementWgsl } from './filters/defaults/displacement/displacement.wgsl.mjs';\nexport { default as noiseFrag } from './filters/defaults/noise/noise.frag.mjs';\nexport { default as noiseWgsl } from './filters/defaults/noise/noise.wgsl.mjs';\nexport { default as passthroughFrag } from './filters/defaults/passthrough/passthrough.frag.mjs';\nexport { default as passthroughWgsl } from './filters/defaults/passthrough/passthrough.wgsl.mjs';\nexport { default as maskFrag } from './filters/mask/mask.frag.mjs';\nexport { default as maskVert } from './filters/mask/mask.vert.mjs';\nexport { default as maskWgsl } from './filters/mask/mask.wgsl.mjs';\nexport { BlendModeFilter } from './filters/blend-modes/BlendModeFilter.mjs';\nexport { hslgl } from './filters/blend-modes/hls/GLhls.mjs';\nexport { hslgpu } from './filters/blend-modes/hls/GPUhls.mjs';\nexport { AlphaFilter } from './filters/defaults/alpha/AlphaFilter.mjs';\nexport { BlurFilter } from './filters/defaults/blur/BlurFilter.mjs';\nexport { BlurFilterPass } from './filters/defaults/blur/BlurFilterPass.mjs';\nexport { GAUSSIAN_VALUES } from './filters/defaults/blur/const.mjs';\nexport { generateBlurFragSource } from './filters/defaults/blur/gl/generateBlurFragSource.mjs';\nexport { generateBlurGlProgram } from './filters/defaults/blur/gl/generateBlurGlProgram.mjs';\nexport { generateBlurVertSource } from './filters/defaults/blur/gl/generateBlurVertSource.mjs';\nexport { generateBlurProgram } from './filters/defaults/blur/gpu/generateBlurProgram.mjs';\nexport { ColorMatrixFilter } from './filters/defaults/color-matrix/ColorMatrixFilter.mjs';\nexport { DisplacementFilter } from './filters/defaults/displacement/DisplacementFilter.mjs';\nexport { NoiseFilter } from './filters/defaults/noise/NoiseFilter.mjs';\nexport { PassthroughFilter } from './filters/defaults/passthrough/PassthroughFilter.mjs';\nexport { Filter } from './filters/Filter.mjs';\nexport { FilterEffect } from './filters/FilterEffect.mjs';\nexport { FilterPipe } from './filters/FilterPipe.mjs';\nexport { FilterSystem } from './filters/FilterSystem.mjs';\nexport { MaskFilter } from './filters/mask/MaskFilter.mjs';\nexport { groupD8 } from './maths/matrix/groupD8.mjs';\nexport { Matrix } from './maths/matrix/Matrix.mjs';\nexport { DEG_TO_RAD, PI_2, RAD_TO_DEG } from './maths/misc/const.mjs';\nexport { isPow2, log2, nextPow2 } from './maths/misc/pow2.mjs';\nexport { squaredDistanceToLineSegment } from './maths/misc/squaredDistanceToLineSegment.mjs';\nexport { ObservablePoint } from './maths/point/ObservablePoint.mjs';\nexport { Point } from './maths/point/Point.mjs';\nexport { pointInTriangle } from './maths/point/pointInTriangle.mjs';\nexport { Circle } from './maths/shapes/Circle.mjs';\nexport { Ellipse } from './maths/shapes/Ellipse.mjs';\nexport { Polygon } from './maths/shapes/Polygon.mjs';\nexport { Rectangle } from './maths/shapes/Rectangle.mjs';\nexport { RoundedRectangle } from './maths/shapes/RoundedRectangle.mjs';\nexport { Triangle } from './maths/shapes/Triangle.mjs';\nexport { PrepareBase } from './prepare/PrepareBase.mjs';\nexport { PrepareQueue } from './prepare/PrepareQueue.mjs';\nexport { PrepareSystem } from './prepare/PrepareSystem.mjs';\nexport { PrepareUpload } from './prepare/PrepareUpload.mjs';\nexport { GlBatchAdaptor } from './rendering/batcher/gl/GlBatchAdaptor.mjs';\nexport { checkMaxIfStatementsInShader } from './rendering/batcher/gl/utils/checkMaxIfStatementsInShader.mjs';\nexport { getMaxTexturesPerBatch } from './rendering/batcher/gl/utils/maxRecommendedTextures.mjs';\nexport { generateGPULayout } from './rendering/batcher/gpu/generateGPULayout.mjs';\nexport { generateLayout } from './rendering/batcher/gpu/generateLayout.mjs';\nexport { getTextureBatchBindGroup } from './rendering/batcher/gpu/getTextureBatchBindGroup.mjs';\nexport { GpuBatchAdaptor } from './rendering/batcher/gpu/GpuBatchAdaptor.mjs';\nexport { Batch, Batcher } from './rendering/batcher/shared/Batcher.mjs';\nexport { BatcherPipe } from './rendering/batcher/shared/BatcherPipe.mjs';\nexport { BatchGeometry } from './rendering/batcher/shared/BatchGeometry.mjs';\nexport { BatchTextureArray } from './rendering/batcher/shared/BatchTextureArray.mjs';\nexport { DefaultBatcher } from './rendering/batcher/shared/DefaultBatcher.mjs';\nexport { DefaultShader } from './rendering/batcher/shared/DefaultShader.mjs';\nexport { compileHighShaderGlProgram, compileHighShaderGpuProgram } from './rendering/high-shader/compileHighShaderToProgram.mjs';\nexport { compileHighShader, compileHighShaderGl } from './rendering/high-shader/compiler/compileHighShader.mjs';\nexport { addBits } from './rendering/high-shader/compiler/utils/addBits.mjs';\nexport { compileHooks } from './rendering/high-shader/compiler/utils/compileHooks.mjs';\nexport { compileInputs } from './rendering/high-shader/compiler/utils/compileInputs.mjs';\nexport { compileOutputs } from './rendering/high-shader/compiler/utils/compileOutputs.mjs';\nexport { formatShader } from './rendering/high-shader/compiler/utils/formatShader.mjs';\nexport { injectBits } from './rendering/high-shader/compiler/utils/injectBits.mjs';\nexport { fragmentGPUTemplate, fragmentGlTemplate, vertexGPUTemplate, vertexGlTemplate } from './rendering/high-shader/defaultProgramTemplate.mjs';\nexport { colorBit, colorBitGl } from './rendering/high-shader/shader-bits/colorBit.mjs';\nexport { generateTextureBatchBit, generateTextureBatchBitGl } from './rendering/high-shader/shader-bits/generateTextureBatchBit.mjs';\nexport { globalUniformsBit, globalUniformsBitGl, globalUniformsUBOBitGl } from './rendering/high-shader/shader-bits/globalUniformsBit.mjs';\nexport { localUniformBit, localUniformBitGl, localUniformBitGroup2 } from './rendering/high-shader/shader-bits/localUniformBit.mjs';\nexport { roundPixelsBit, roundPixelsBitGl } from './rendering/high-shader/shader-bits/roundPixelsBit.mjs';\nexport { textureBit, textureBitGl } from './rendering/high-shader/shader-bits/textureBit.mjs';\nexport { AlphaMask } from './rendering/mask/alpha/AlphaMask.mjs';\nexport { AlphaMaskPipe } from './rendering/mask/alpha/AlphaMaskPipe.mjs';\nexport { ColorMask } from './rendering/mask/color/ColorMask.mjs';\nexport { ColorMaskPipe } from './rendering/mask/color/ColorMaskPipe.mjs';\nexport { MaskEffectManager, MaskEffectManagerClass } from './rendering/mask/MaskEffectManager.mjs';\nexport { ScissorMask } from './rendering/mask/scissor/ScissorMask.mjs';\nexport { StencilMask } from './rendering/mask/stencil/StencilMask.mjs';\nexport { StencilMaskPipe } from './rendering/mask/stencil/StencilMaskPipe.mjs';\nexport { addMaskBounds } from './rendering/mask/utils/addMaskBounds.mjs';\nexport { addMaskLocalBounds } from './rendering/mask/utils/addMaskLocalBounds.mjs';\nexport { autoDetectRenderer } from './rendering/renderers/autoDetectRenderer.mjs';\nexport { BUFFER_TYPE } from './rendering/renderers/gl/buffer/const.mjs';\nexport { GlBuffer } from './rendering/renderers/gl/buffer/GlBuffer.mjs';\nexport { GlBufferSystem } from './rendering/renderers/gl/buffer/GlBufferSystem.mjs';\nexport { CLEAR } from './rendering/renderers/gl/const.mjs';\nexport { GlContextSystem } from './rendering/renderers/gl/context/GlContextSystem.mjs';\nexport { GlGeometrySystem } from './rendering/renderers/gl/geometry/GlGeometrySystem.mjs';\nexport { getGlTypeFromFormat } from './rendering/renderers/gl/geometry/utils/getGlTypeFromFormat.mjs';\nexport { GlBackBufferSystem } from './rendering/renderers/gl/GlBackBufferSystem.mjs';\nexport { GlColorMaskSystem } from './rendering/renderers/gl/GlColorMaskSystem.mjs';\nexport { GlEncoderSystem } from './rendering/renderers/gl/GlEncoderSystem.mjs';\nexport { GlLimitsSystem } from './rendering/renderers/gl/GlLimitsSystem.mjs';\nexport { GlRenderTarget } from './rendering/renderers/gl/GlRenderTarget.mjs';\nexport { GlStencilSystem } from './rendering/renderers/gl/GlStencilSystem.mjs';\nexport { GlUboSystem } from './rendering/renderers/gl/GlUboSystem.mjs';\nexport { GlRenderTargetAdaptor } from './rendering/renderers/gl/renderTarget/GlRenderTargetAdaptor.mjs';\nexport { GlRenderTargetSystem } from './rendering/renderers/gl/renderTarget/GlRenderTargetSystem.mjs';\nexport { generateShaderSyncCode } from './rendering/renderers/gl/shader/GenerateShaderSyncCode.mjs';\nexport { getBatchSamplersUniformGroup } from './rendering/renderers/gl/shader/getBatchSamplersUniformGroup.mjs';\nexport { GlProgram } from './rendering/renderers/gl/shader/GlProgram.mjs';\nexport { GlProgramData, IGLUniformData } from './rendering/renderers/gl/shader/GlProgramData.mjs';\nexport { GlShaderSystem } from './rendering/renderers/gl/shader/GlShaderSystem.mjs';\nexport { GlUniformGroupSystem } from './rendering/renderers/gl/shader/GlUniformGroupSystem.mjs';\nexport { migrateFragmentFromV7toV8 } from './rendering/renderers/gl/shader/migrateFragmentFromV7toV8.mjs';\nexport { compileShader } from './rendering/renderers/gl/shader/program/compileShader.mjs';\nexport { defaultValue } from './rendering/renderers/gl/shader/program/defaultValue.mjs';\nexport { ensureAttributes } from './rendering/renderers/gl/shader/program/ensureAttributes.mjs';\nexport { extractAttributesFromGlProgram } from './rendering/renderers/gl/shader/program/extractAttributesFromGlProgram.mjs';\nexport { generateProgram } from './rendering/renderers/gl/shader/program/generateProgram.mjs';\nexport { getMaxFragmentPrecision } from './rendering/renderers/gl/shader/program/getMaxFragmentPrecision.mjs';\nexport { getTestContext } from './rendering/renderers/gl/shader/program/getTestContext.mjs';\nexport { getUboData } from './rendering/renderers/gl/shader/program/getUboData.mjs';\nexport { getUniformData } from './rendering/renderers/gl/shader/program/getUniformData.mjs';\nexport { logProgramError } from './rendering/renderers/gl/shader/program/logProgramError.mjs';\nexport { mapSize } from './rendering/renderers/gl/shader/program/mapSize.mjs';\nexport { mapGlToVertexFormat, mapType } from './rendering/renderers/gl/shader/program/mapType.mjs';\nexport { addProgramDefines } from './rendering/renderers/gl/shader/program/preprocessors/addProgramDefines.mjs';\nexport { ensurePrecision } from './rendering/renderers/gl/shader/program/preprocessors/ensurePrecision.mjs';\nexport { insertVersion } from './rendering/renderers/gl/shader/program/preprocessors/insertVersion.mjs';\nexport { setProgramName } from './rendering/renderers/gl/shader/program/preprocessors/setProgramName.mjs';\nexport { stripVersion } from './rendering/renderers/gl/shader/program/preprocessors/stripVersion.mjs';\nexport { WGSL_TO_STD40_SIZE, createUboElementsSTD40 } from './rendering/renderers/gl/shader/utils/createUboElementsSTD40.mjs';\nexport { createUboSyncFunctionSTD40 } from './rendering/renderers/gl/shader/utils/createUboSyncSTD40.mjs';\nexport { generateArraySyncSTD40 } from './rendering/renderers/gl/shader/utils/generateArraySyncSTD40.mjs';\nexport { generateUniformsSync } from './rendering/renderers/gl/shader/utils/generateUniformsSync.mjs';\nexport { UNIFORM_TO_ARRAY_SETTERS, UNIFORM_TO_SINGLE_SETTERS } from './rendering/renderers/gl/shader/utils/generateUniformsSyncTypes.mjs';\nexport { GlStateSystem } from './rendering/renderers/gl/state/GlStateSystem.mjs';\nexport { mapWebGLBlendModesToPixi } from './rendering/renderers/gl/state/mapWebGLBlendModesToPixi.mjs';\nexport { GL_FORMATS, GL_TARGETS, GL_TYPES, GL_WRAP_MODES } from './rendering/renderers/gl/texture/const.mjs';\nexport { GlTexture } from './rendering/renderers/gl/texture/GlTexture.mjs';\nexport { GlTextureSystem } from './rendering/renderers/gl/texture/GlTextureSystem.mjs';\nexport { glUploadBufferImageResource } from './rendering/renderers/gl/texture/uploaders/glUploadBufferImageResource.mjs';\nexport { glUploadCompressedTextureResource } from './rendering/renderers/gl/texture/uploaders/glUploadCompressedTextureResource.mjs';\nexport { glUploadImageResource } from './rendering/renderers/gl/texture/uploaders/glUploadImageResource.mjs';\nexport { glUploadVideoResource } from './rendering/renderers/gl/texture/uploaders/glUploadVideoResource.mjs';\nexport { applyStyleParams } from './rendering/renderers/gl/texture/utils/applyStyleParams.mjs';\nexport { getSupportedGlCompressedTextureFormats } from './rendering/renderers/gl/texture/utils/getSupportedGlCompressedTextureFormats.mjs';\nexport { mapFormatToGlFormat } from './rendering/renderers/gl/texture/utils/mapFormatToGlFormat.mjs';\nexport { mapFormatToGlInternalFormat } from './rendering/renderers/gl/texture/utils/mapFormatToGlInternalFormat.mjs';\nexport { mapFormatToGlType } from './rendering/renderers/gl/texture/utils/mapFormatToGlType.mjs';\nexport { compareModeToGlCompare, mipmapScaleModeToGlFilter, scaleModeToGlFilter, wrapModeToGlAddress } from './rendering/renderers/gl/texture/utils/pixiToGlMaps.mjs';\nexport { unpremultiplyAlpha } from './rendering/renderers/gl/texture/utils/unpremultiplyAlpha.mjs';\nexport { WebGLRenderer } from './rendering/renderers/gl/WebGLRenderer.mjs';\nexport { BindGroupSystem } from './rendering/renderers/gpu/BindGroupSystem.mjs';\nexport { GpuBufferSystem } from './rendering/renderers/gpu/buffer/GpuBufferSystem.mjs';\nexport { UboBatch } from './rendering/renderers/gpu/buffer/UboBatch.mjs';\nexport { GpuColorMaskSystem } from './rendering/renderers/gpu/GpuColorMaskSystem.mjs';\nexport { GpuDeviceSystem } from './rendering/renderers/gpu/GpuDeviceSystem.mjs';\nexport { GpuEncoderSystem } from './rendering/renderers/gpu/GpuEncoderSystem.mjs';\nexport { GpuLimitsSystem } from './rendering/renderers/gpu/GpuLimitsSystem.mjs';\nexport { GpuStencilSystem } from './rendering/renderers/gpu/GpuStencilSystem.mjs';\nexport { GpuUboSystem } from './rendering/renderers/gpu/GpuUboSystem.mjs';\nexport { GpuUniformBatchPipe } from './rendering/renderers/gpu/GpuUniformBatchPipe.mjs';\nexport { PipelineSystem } from './rendering/renderers/gpu/pipeline/PipelineSystem.mjs';\nexport { calculateProjection } from './rendering/renderers/gpu/renderTarget/calculateProjection.mjs';\nexport { GpuRenderTarget } from './rendering/renderers/gpu/renderTarget/GpuRenderTarget.mjs';\nexport { GpuRenderTargetAdaptor } from './rendering/renderers/gpu/renderTarget/GpuRenderTargetAdaptor.mjs';\nexport { GpuRenderTargetSystem } from './rendering/renderers/gpu/renderTarget/GpuRenderTargetSystem.mjs';\nexport { BindGroup } from './rendering/renderers/gpu/shader/BindGroup.mjs';\nexport { GpuProgram } from './rendering/renderers/gpu/shader/GpuProgram.mjs';\nexport { GpuShaderSystem } from './rendering/renderers/gpu/shader/GpuShaderSystem.mjs';\nexport { WGSL_ALIGN_SIZE_DATA, createUboElementsWGSL } from './rendering/renderers/gpu/shader/utils/createUboElementsWGSL.mjs';\nexport { createUboSyncFunctionWGSL } from './rendering/renderers/gpu/shader/utils/createUboSyncFunctionWGSL.mjs';\nexport { extractAttributesFromGpuProgram } from './rendering/renderers/gpu/shader/utils/extractAttributesFromGpuProgram.mjs';\nexport { extractStructAndGroups } from './rendering/renderers/gpu/shader/utils/extractStructAndGroups.mjs';\nexport { generateArraySyncWGSL } from './rendering/renderers/gpu/shader/utils/generateArraySyncWGSL.mjs';\nexport { generateGpuLayoutGroups } from './rendering/renderers/gpu/shader/utils/generateGpuLayoutGroups.mjs';\nexport { generateLayoutHash } from './rendering/renderers/gpu/shader/utils/generateLayoutHash.mjs';\nexport { removeStructAndGroupDuplicates } from './rendering/renderers/gpu/shader/utils/removeStructAndGroupDuplicates.mjs';\nexport { GpuBlendModesToPixi } from './rendering/renderers/gpu/state/GpuBlendModesToPixi.mjs';\nexport { GpuStateSystem } from './rendering/renderers/gpu/state/GpuStateSystem.mjs';\nexport { GpuStencilModesToPixi } from './rendering/renderers/gpu/state/GpuStencilModesToPixi.mjs';\nexport { GpuTextureSystem } from './rendering/renderers/gpu/texture/GpuTextureSystem.mjs';\nexport { gpuUploadBufferImageResource } from './rendering/renderers/gpu/texture/uploaders/gpuUploadBufferImageResource.mjs';\nexport { blockDataMap, gpuUploadCompressedTextureResource } from './rendering/renderers/gpu/texture/uploaders/gpuUploadCompressedTextureResource.mjs';\nexport { gpuUploadImageResource } from './rendering/renderers/gpu/texture/uploaders/gpuUploadImageSource.mjs';\nexport { gpuUploadVideoResource } from './rendering/renderers/gpu/texture/uploaders/gpuUploadVideoSource.mjs';\nexport { getSupportedGPUCompressedTextureFormats } from './rendering/renderers/gpu/texture/utils/getSupportedGPUCompressedTextureFormats.mjs';\nexport { GpuMipmapGenerator } from './rendering/renderers/gpu/texture/utils/GpuMipmapGenerator.mjs';\nexport { WebGPURenderer } from './rendering/renderers/gpu/WebGPURenderer.mjs';\nexport { BackgroundSystem } from './rendering/renderers/shared/background/BackgroundSystem.mjs';\nexport { BlendModePipe } from './rendering/renderers/shared/blendModes/BlendModePipe.mjs';\nexport { Buffer } from './rendering/renderers/shared/buffer/Buffer.mjs';\nexport { BufferResource } from './rendering/renderers/shared/buffer/BufferResource.mjs';\nexport { BufferUsage } from './rendering/renderers/shared/buffer/const.mjs';\nexport { fastCopy } from './rendering/renderers/shared/buffer/utils/fastCopy.mjs';\nexport { ExtractSystem } from './rendering/renderers/shared/extract/ExtractSystem.mjs';\nexport { GenerateTextureSystem } from './rendering/renderers/shared/extract/GenerateTextureSystem.mjs';\nexport { DRAW_MODES } from './rendering/renderers/shared/geometry/const.mjs';\nexport { Geometry } from './rendering/renderers/shared/geometry/Geometry.mjs';\nexport { buildSimpleUvs, buildUvs } from './rendering/renderers/shared/geometry/utils/buildUvs.mjs';\nexport { ensureIsBuffer } from './rendering/renderers/shared/geometry/utils/ensureIsBuffer.mjs';\nexport { getAttributeInfoFromFormat } from './rendering/renderers/shared/geometry/utils/getAttributeInfoFromFormat.mjs';\nexport { getGeometryBounds } from './rendering/renderers/shared/geometry/utils/getGeometryBounds.mjs';\nexport { transformVertices } from './rendering/renderers/shared/geometry/utils/transformVertices.mjs';\nexport { InstructionSet } from './rendering/renderers/shared/instructions/InstructionSet.mjs';\nexport { GlobalUniformSystem } from './rendering/renderers/shared/renderTarget/GlobalUniformSystem.mjs';\nexport { isRenderingToScreen } from './rendering/renderers/shared/renderTarget/isRenderingToScreen.mjs';\nexport { RenderTarget } from './rendering/renderers/shared/renderTarget/RenderTarget.mjs';\nexport { RenderTargetSystem } from './rendering/renderers/shared/renderTarget/RenderTargetSystem.mjs';\nexport { SchedulerSystem } from './rendering/renderers/shared/SchedulerSystem.mjs';\nexport { ShaderStage } from './rendering/renderers/shared/shader/const.mjs';\nexport { Shader } from './rendering/renderers/shared/shader/Shader.mjs';\nexport { UNIFORM_TYPES_MAP, UNIFORM_TYPES_VALUES } from './rendering/renderers/shared/shader/types.mjs';\nexport { UboSystem } from './rendering/renderers/shared/shader/UboSystem.mjs';\nexport { UniformGroup } from './rendering/renderers/shared/shader/UniformGroup.mjs';\nexport { createUboSyncFunction } from './rendering/renderers/shared/shader/utils/createUboSyncFunction.mjs';\nexport { getDefaultUniformValue } from './rendering/renderers/shared/shader/utils/getDefaultUniformValue.mjs';\nexport { uboSyncFunctionsSTD40, uboSyncFunctionsWGSL } from './rendering/renderers/shared/shader/utils/uboSyncFunctions.mjs';\nexport { uniformParsers } from './rendering/renderers/shared/shader/utils/uniformParsers.mjs';\nexport { HelloSystem } from './rendering/renderers/shared/startup/HelloSystem.mjs';\nexport { BLEND_TO_NPM, STENCIL_MODES } from './rendering/renderers/shared/state/const.mjs';\nexport { getAdjustedBlendModeBlend } from './rendering/renderers/shared/state/getAdjustedBlendModeBlend.mjs';\nexport { State } from './rendering/renderers/shared/state/State.mjs';\nexport { AbstractRenderer } from './rendering/renderers/shared/system/AbstractRenderer.mjs';\nexport { SharedRenderPipes, SharedSystems } from './rendering/renderers/shared/system/SharedSystems.mjs';\nexport { SystemRunner } from './rendering/renderers/shared/system/SystemRunner.mjs';\nexport { CanvasPool, CanvasPoolClass } from './rendering/renderers/shared/texture/CanvasPool.mjs';\nexport { DEPRECATED_SCALE_MODES, DEPRECATED_WRAP_MODES, SCALE_MODES, WRAP_MODES } from './rendering/renderers/shared/texture/const.mjs';\nexport { RenderableGCSystem } from './rendering/renderers/shared/texture/RenderableGCSystem.mjs';\nexport { RenderTexture } from './rendering/renderers/shared/texture/RenderTexture.mjs';\nexport { BufferImageSource } from './rendering/renderers/shared/texture/sources/BufferImageSource.mjs';\nexport { CanvasSource } from './rendering/renderers/shared/texture/sources/CanvasSource.mjs';\nexport { CompressedSource } from './rendering/renderers/shared/texture/sources/CompressedSource.mjs';\nexport { ImageSource } from './rendering/renderers/shared/texture/sources/ImageSource.mjs';\nexport { TextureSource } from './rendering/renderers/shared/texture/sources/TextureSource.mjs';\nexport { VideoSource } from './rendering/renderers/shared/texture/sources/VideoSource.mjs';\nexport { Texture } from './rendering/renderers/shared/texture/Texture.mjs';\nexport { TextureGCSystem } from './rendering/renderers/shared/texture/TextureGCSystem.mjs';\nexport { TextureMatrix } from './rendering/renderers/shared/texture/TextureMatrix.mjs';\nexport { TexturePool, TexturePoolClass } from './rendering/renderers/shared/texture/TexturePool.mjs';\nexport { TextureStyle } from './rendering/renderers/shared/texture/TextureStyle.mjs';\nexport { TextureUvs } from './rendering/renderers/shared/texture/TextureUvs.mjs';\nexport { getCanvasTexture, hasCachedCanvasTexture } from './rendering/renderers/shared/texture/utils/getCanvasTexture.mjs';\nexport { getSupportedCompressedTextureFormats } from './rendering/renderers/shared/texture/utils/getSupportedCompressedTextureFormats.mjs';\nexport { getSupportedTextureFormats, nonCompressedFormats } from './rendering/renderers/shared/texture/utils/getSupportedTextureFormats.mjs';\nexport { autoDetectSource, resourceToTexture, textureFrom } from './rendering/renderers/shared/texture/utils/textureFrom.mjs';\nexport { createIdFromString } from './rendering/renderers/shared/utils/createIdFromString.mjs';\nexport { parseFunctionBody } from './rendering/renderers/shared/utils/parseFunctionBody.mjs';\nexport { ViewSystem } from './rendering/renderers/shared/view/ViewSystem.mjs';\nexport { RendererType } from './rendering/renderers/types.mjs';\nexport { default as particlesFrag } from './scene/particle-container/shared/shader/particles.frag.mjs';\nexport { default as particlesVert } from './scene/particle-container/shared/shader/particles.vert.mjs';\nexport { default as particlesWgsl } from './scene/particle-container/shared/shader/particles.wgsl.mjs';\nexport { Bounds } from './scene/container/bounds/Bounds.mjs';\nexport { getFastGlobalBounds } from './scene/container/bounds/getFastGlobalBounds.mjs';\nexport { getGlobalBounds, updateTransformBackwards } from './scene/container/bounds/getGlobalBounds.mjs';\nexport { getLocalBounds } from './scene/container/bounds/getLocalBounds.mjs';\nexport { getGlobalRenderableBounds } from './scene/container/bounds/getRenderableBounds.mjs';\nexport { boundsPool, matrixPool } from './scene/container/bounds/utils/matrixAndBoundsPool.mjs';\nexport { cacheAsTextureMixin } from './scene/container/container-mixins/cacheAsTextureMixin.mjs';\nexport { childrenHelperMixin } from './scene/container/container-mixins/childrenHelperMixin.mjs';\nexport { collectRenderablesMixin } from './scene/container/container-mixins/collectRenderablesMixin.mjs';\nexport { effectsMixin } from './scene/container/container-mixins/effectsMixin.mjs';\nexport { findMixin } from './scene/container/container-mixins/findMixin.mjs';\nexport { getFastGlobalBoundsMixin } from './scene/container/container-mixins/getFastGlobalBoundsMixin.mjs';\nexport { bgr2rgb, getGlobalMixin } from './scene/container/container-mixins/getGlobalMixin.mjs';\nexport { measureMixin } from './scene/container/container-mixins/measureMixin.mjs';\nexport { onRenderMixin } from './scene/container/container-mixins/onRenderMixin.mjs';\nexport { sortMixin } from './scene/container/container-mixins/sortMixin.mjs';\nexport { toLocalGlobalMixin } from './scene/container/container-mixins/toLocalGlobalMixin.mjs';\nexport { Container, UPDATE_BLEND, UPDATE_COLOR, UPDATE_TRANSFORM, UPDATE_VISIBLE } from './scene/container/Container.mjs';\nexport { CustomRenderPipe } from './scene/container/CustomRenderPipe.mjs';\nexport { RenderContainer } from './scene/container/RenderContainer.mjs';\nexport { RenderGroup } from './scene/container/RenderGroup.mjs';\nexport { RenderGroupPipe } from './scene/container/RenderGroupPipe.mjs';\nexport { RenderGroupSystem } from './scene/container/RenderGroupSystem.mjs';\nexport { assignWithIgnore } from './scene/container/utils/assignWithIgnore.mjs';\nexport { checkChildrenDidChange } from './scene/container/utils/checkChildrenDidChange.mjs';\nexport { clearList } from './scene/container/utils/clearList.mjs';\nexport { collectAllRenderables } from './scene/container/utils/collectAllRenderables.mjs';\nexport { definedProps } from './scene/container/utils/definedProps.mjs';\nexport { executeInstructions } from './scene/container/utils/executeInstructions.mjs';\nexport { multiplyColors } from './scene/container/utils/multiplyColors.mjs';\nexport { multiplyHexColors } from './scene/container/utils/multiplyHexColors.mjs';\nexport { updateLocalTransform } from './scene/container/utils/updateLocalTransform.mjs';\nexport { updateRenderGroupTransform, updateRenderGroupTransforms, updateTransformAndChildren } from './scene/container/utils/updateRenderGroupTransforms.mjs';\nexport { updateWorldTransform } from './scene/container/utils/updateWorldTransform.mjs';\nexport { validateRenderables } from './scene/container/utils/validateRenderables.mjs';\nexport { GlGraphicsAdaptor } from './scene/graphics/gl/GlGraphicsAdaptor.mjs';\nexport { color32BitToUniform, colorToUniform } from './scene/graphics/gpu/colorToUniform.mjs';\nexport { GpuGraphicsAdaptor } from './scene/graphics/gpu/GpuGraphicsAdaptor.mjs';\nexport { BatchableGraphics } from './scene/graphics/shared/BatchableGraphics.mjs';\nexport { buildAdaptiveBezier } from './scene/graphics/shared/buildCommands/buildAdaptiveBezier.mjs';\nexport { buildAdaptiveQuadratic } from './scene/graphics/shared/buildCommands/buildAdaptiveQuadratic.mjs';\nexport { buildArc } from './scene/graphics/shared/buildCommands/buildArc.mjs';\nexport { buildArcTo } from './scene/graphics/shared/buildCommands/buildArcTo.mjs';\nexport { buildArcToSvg } from './scene/graphics/shared/buildCommands/buildArcToSvg.mjs';\nexport { buildCircle, buildEllipse, buildRoundedRectangle } from './scene/graphics/shared/buildCommands/buildCircle.mjs';\nexport { buildLine } from './scene/graphics/shared/buildCommands/buildLine.mjs';\nexport { buildPixelLine } from './scene/graphics/shared/buildCommands/buildPixelLine.mjs';\nexport { buildPolygon } from './scene/graphics/shared/buildCommands/buildPolygon.mjs';\nexport { buildRectangle } from './scene/graphics/shared/buildCommands/buildRectangle.mjs';\nexport { buildTriangle } from './scene/graphics/shared/buildCommands/buildTriangle.mjs';\nexport { closePointEps, curveEps } from './scene/graphics/shared/const.mjs';\nexport { FillGradient } from './scene/graphics/shared/fill/FillGradient.mjs';\nexport { FillPattern } from './scene/graphics/shared/fill/FillPattern.mjs';\nexport { Graphics } from './scene/graphics/shared/Graphics.mjs';\nexport { GraphicsContext } from './scene/graphics/shared/GraphicsContext.mjs';\nexport { GpuGraphicsContext, GraphicsContextRenderData, GraphicsContextSystem } from './scene/graphics/shared/GraphicsContextSystem.mjs';\nexport { GraphicsGpuData, GraphicsPipe } from './scene/graphics/shared/GraphicsPipe.mjs';\nexport { GraphicsPath } from './scene/graphics/shared/path/GraphicsPath.mjs';\nexport { roundedShapeArc, roundedShapeQuadraticCurve } from './scene/graphics/shared/path/roundShape.mjs';\nexport { ShapePath } from './scene/graphics/shared/path/ShapePath.mjs';\nexport { parseSVGDefinitions } from './scene/graphics/shared/svg/parseSVGDefinitions.mjs';\nexport { parseSVGFloatAttribute } from './scene/graphics/shared/svg/parseSVGFloatAttribute.mjs';\nexport { parseSVGPath } from './scene/graphics/shared/svg/parseSVGPath.mjs';\nexport { parseSVGStyle, styleAttributes } from './scene/graphics/shared/svg/parseSVGStyle.mjs';\nexport { SVGParser } from './scene/graphics/shared/svg/SVGParser.mjs';\nexport { extractSvgUrlId } from './scene/graphics/shared/svg/utils/extractSvgUrlId.mjs';\nexport { checkForNestedPattern, getFillInstructionData } from './scene/graphics/shared/svg/utils/fillOperations.mjs';\nexport { appendSVGPath, calculatePathArea, extractSubpaths } from './scene/graphics/shared/svg/utils/pathOperations.mjs';\nexport { buildContextBatches, shapeBuilders } from './scene/graphics/shared/utils/buildContextBatches.mjs';\nexport { buildGeometryFromPath } from './scene/graphics/shared/utils/buildGeometryFromPath.mjs';\nexport { toFillStyle, toStrokeStyle } from './scene/graphics/shared/utils/convertFillInputToFillStyle.mjs';\nexport { generateTextureMatrix } from './scene/graphics/shared/utils/generateTextureFillMatrix.mjs';\nexport { getOrientationOfPoints } from './scene/graphics/shared/utils/getOrientationOfPoints.mjs';\nexport { triangulateWithHoles } from './scene/graphics/shared/utils/triangulateWithHoles.mjs';\nexport { RenderLayer } from './scene/layers/RenderLayer.mjs';\nexport { PerspectiveMesh } from './scene/mesh-perspective/PerspectiveMesh.mjs';\nexport { PerspectivePlaneGeometry } from './scene/mesh-perspective/PerspectivePlaneGeometry.mjs';\nexport { applyProjectiveTransformationToPlane } from './scene/mesh-perspective/utils/applyProjectiveTransformationToPlane.mjs';\nexport { compute2DProjection } from './scene/mesh-perspective/utils/compute2DProjections.mjs';\nexport { MeshPlane } from './scene/mesh-plane/MeshPlane.mjs';\nexport { PlaneGeometry } from './scene/mesh-plane/PlaneGeometry.mjs';\nexport { MeshRope } from './scene/mesh-simple/MeshRope.mjs';\nexport { MeshSimple } from './scene/mesh-simple/MeshSimple.mjs';\nexport { RopeGeometry } from './scene/mesh-simple/RopeGeometry.mjs';\nexport { GlMeshAdaptor } from './scene/mesh/gl/GlMeshAdaptor.mjs';\nexport { GpuMeshAdapter } from './scene/mesh/gpu/GpuMeshAdapter.mjs';\nexport { BatchableMesh } from './scene/mesh/shared/BatchableMesh.mjs';\nexport { getTextureDefaultMatrix } from './scene/mesh/shared/getTextureDefaultMatrix.mjs';\nexport { Mesh } from './scene/mesh/shared/Mesh.mjs';\nexport { MeshGeometry } from './scene/mesh/shared/MeshGeometry.mjs';\nexport { MeshGpuData, MeshPipe } from './scene/mesh/shared/MeshPipe.mjs';\nexport { GlParticleContainerAdaptor } from './scene/particle-container/gl/GlParticleContainerAdaptor.mjs';\nexport { GpuParticleContainerAdaptor } from './scene/particle-container/gpu/GpuParticleContainerAdaptor.mjs';\nexport { GlParticleContainerPipe } from './scene/particle-container/shared/GlParticleContainerPipe.mjs';\nexport { GpuParticleContainerPipe } from './scene/particle-container/shared/GpuParticleContainerPipe.mjs';\nexport { Particle } from './scene/particle-container/shared/Particle.mjs';\nexport { ParticleBuffer } from './scene/particle-container/shared/ParticleBuffer.mjs';\nexport { ParticleContainer } from './scene/particle-container/shared/ParticleContainer.mjs';\nexport { ParticleContainerPipe } from './scene/particle-container/shared/ParticleContainerPipe.mjs';\nexport { particleData } from './scene/particle-container/shared/particleData.mjs';\nexport { ParticleShader } from './scene/particle-container/shared/shader/ParticleShader.mjs';\nexport { createIndicesForQuads } from './scene/particle-container/shared/utils/createIndicesForQuads.mjs';\nexport { generateParticleUpdateFunction } from './scene/particle-container/shared/utils/generateParticleUpdateFunction.mjs';\nexport { AnimatedSprite } from './scene/sprite-animated/AnimatedSprite.mjs';\nexport { NineSliceGeometry } from './scene/sprite-nine-slice/NineSliceGeometry.mjs';\nexport { NineSlicePlane, NineSliceSprite } from './scene/sprite-nine-slice/NineSliceSprite.mjs';\nexport { NineSliceSpriteGpuData, NineSliceSpritePipe } from './scene/sprite-nine-slice/NineSliceSpritePipe.mjs';\nexport { tilingBit, tilingBitGl } from './scene/sprite-tiling/shader/tilingBit.mjs';\nexport { TilingSpriteShader } from './scene/sprite-tiling/shader/TilingSpriteShader.mjs';\nexport { TilingSprite } from './scene/sprite-tiling/TilingSprite.mjs';\nexport { TilingSpriteGpuData, TilingSpritePipe } from './scene/sprite-tiling/TilingSpritePipe.mjs';\nexport { applyMatrix } from './scene/sprite-tiling/utils/applyMatrix.mjs';\nexport { QuadGeometry } from './scene/sprite-tiling/utils/QuadGeometry.mjs';\nexport { setPositions } from './scene/sprite-tiling/utils/setPositions.mjs';\nexport { setUvs } from './scene/sprite-tiling/utils/setUvs.mjs';\nexport { BatchableSprite } from './scene/sprite/BatchableSprite.mjs';\nexport { Sprite } from './scene/sprite/Sprite.mjs';\nexport { SpritePipe } from './scene/sprite/SpritePipe.mjs';\nexport { AbstractBitmapFont } from './scene/text-bitmap/AbstractBitmapFont.mjs';\nexport { bitmapFontTextParser } from './scene/text-bitmap/asset/bitmapFontTextParser.mjs';\nexport { bitmapFontXMLParser } from './scene/text-bitmap/asset/bitmapFontXMLParser.mjs';\nexport { bitmapFontXMLStringParser } from './scene/text-bitmap/asset/bitmapFontXMLStringParser.mjs';\nexport { bitmapFontCachePlugin, loadBitmapFont } from './scene/text-bitmap/asset/loadBitmapFont.mjs';\nexport { BitmapFont } from './scene/text-bitmap/BitmapFont.mjs';\nexport { BitmapFontManager } from './scene/text-bitmap/BitmapFontManager.mjs';\nexport { BitmapText } from './scene/text-bitmap/BitmapText.mjs';\nexport { BitmapTextGraphics, BitmapTextPipe } from './scene/text-bitmap/BitmapTextPipe.mjs';\nexport { DynamicBitmapFont } from './scene/text-bitmap/DynamicBitmapFont.mjs';\nexport { bitmapTextSplit } from './scene/text-bitmap/utils/bitmapTextSplit.mjs';\nexport { getBitmapTextLayout } from './scene/text-bitmap/utils/getBitmapTextLayout.mjs';\nexport { resolveCharacters } from './scene/text-bitmap/utils/resolveCharacters.mjs';\nexport { BatchableHTMLText } from './scene/text-html/BatchableHTMLText.mjs';\nexport { HTMLText } from './scene/text-html/HTMLText.mjs';\nexport { HTMLTextPipe } from './scene/text-html/HTMLTextPipe.mjs';\nexport { HTMLTextRenderData } from './scene/text-html/HTMLTextRenderData.mjs';\nexport { HTMLTextStyle } from './scene/text-html/HTMLTextStyle.mjs';\nexport { HTMLTextSystem } from './scene/text-html/HTMLTextSystem.mjs';\nexport { extractFontFamilies } from './scene/text-html/utils/extractFontFamilies.mjs';\nexport { FontStylePromiseCache, getFontCss } from './scene/text-html/utils/getFontCss.mjs';\nexport { getSVGUrl } from './scene/text-html/utils/getSVGUrl.mjs';\nexport { getTemporaryCanvasFromImage } from './scene/text-html/utils/getTemporaryCanvasFromImage.mjs';\nexport { loadFontAsBase64 } from './scene/text-html/utils/loadFontAsBase64.mjs';\nexport { loadFontCSS } from './scene/text-html/utils/loadFontCSS.mjs';\nexport { loadSVGImage } from './scene/text-html/utils/loadSVGImage.mjs';\nexport { measureHtmlText } from './scene/text-html/utils/measureHtmlText.mjs';\nexport { textStyleToCSS } from './scene/text-html/utils/textStyleToCSS.mjs';\nexport { AbstractSplitText } from './scene/text-split/AbstractSplitText.mjs';\nexport { SplitBitmapText } from './scene/text-split/SplitBitmapText.mjs';\nexport { SplitText } from './scene/text-split/SplitText.mjs';\nexport { AbstractText, ensureTextOptions } from './scene/text/AbstractText.mjs';\nexport { BatchableText } from './scene/text/canvas/BatchableText.mjs';\nexport { CanvasTextGenerator } from './scene/text/canvas/CanvasTextGenerator.mjs';\nexport { CanvasTextMetrics } from './scene/text/canvas/CanvasTextMetrics.mjs';\nexport { CanvasTextPipe } from './scene/text/canvas/CanvasTextPipe.mjs';\nexport { CanvasTextSystem } from './scene/text/canvas/CanvasTextSystem.mjs';\nexport { fontStringFromTextStyle } from './scene/text/canvas/utils/fontStringFromTextStyle.mjs';\nexport { getCanvasFillStyle } from './scene/text/canvas/utils/getCanvasFillStyle.mjs';\nexport { SdfShader } from './scene/text/sdfShader/SdfShader.mjs';\nexport { localUniformMSDFBit, localUniformMSDFBitGl } from './scene/text/sdfShader/shader-bits/localUniformMSDFBit.mjs';\nexport { mSDFBit, mSDFBitGl } from './scene/text/sdfShader/shader-bits/mSDFBit.mjs';\nexport { Text } from './scene/text/Text.mjs';\nexport { TextStyle } from './scene/text/TextStyle.mjs';\nexport { canvasTextSplit } from './scene/text/utils/canvasTextSplit.mjs';\nexport { generateTextStyleKey } from './scene/text/utils/generateTextStyleKey.mjs';\nexport { getPo2TextureFromSource } from './scene/text/utils/getPo2TextureFromSource.mjs';\nexport { updateTextBounds } from './scene/text/utils/updateTextBounds.mjs';\nexport { ViewContainer } from './scene/view/ViewContainer.mjs';\nexport { Spritesheet } from './spritesheet/Spritesheet.mjs';\nexport { spritesheetAsset } from './spritesheet/spritesheetAsset.mjs';\nexport { UPDATE_PRIORITY } from './ticker/const.mjs';\nexport { Ticker } from './ticker/Ticker.mjs';\nexport { TickerListener } from './ticker/TickerListener.mjs';\nexport { detectVideoAlphaMode } from './utils/browser/detectVideoAlphaMode.mjs';\nexport { isMobile } from './utils/browser/isMobile.mjs';\nexport { isSafari } from './utils/browser/isSafari.mjs';\nexport { isWebGLSupported } from './utils/browser/isWebGLSupported.mjs';\nexport { isWebGPUSupported } from './utils/browser/isWebGPUSupported.mjs';\nexport { unsafeEvalSupported } from './utils/browser/unsafeEvalSupported.mjs';\nexport { getCanvasBoundingBox } from './utils/canvas/getCanvasBoundingBox.mjs';\nexport { DATA_URI, VERSION } from './utils/const.mjs';\nexport { default as EventEmitter } from 'eventemitter3';\nexport { cleanArray, cleanHash } from './utils/data/clean.mjs';\nexport { removeItems } from './utils/data/removeItems.mjs';\nexport { resetUids, uid } from './utils/data/uid.mjs';\nexport { updateQuadBounds } from './utils/data/updateQuadBounds.mjs';\nexport { ViewableBuffer } from './utils/data/ViewableBuffer.mjs';\nexport { ApplicationInitHook, RendererInitHook } from './utils/global/globalHooks.mjs';\nexport { deprecation, v8_0_0, v8_3_4 } from './utils/logging/deprecation.mjs';\nexport { logDebugTexture } from './utils/logging/logDebugTexture.mjs';\nexport { logRenderGroupScene, logScene } from './utils/logging/logScene.mjs';\nexport { warn } from './utils/logging/warn.mjs';\nexport { NOOP } from './utils/misc/NOOP.mjs';\nexport { Transform } from './utils/misc/Transform.mjs';\nexport { getResolutionOfUrl } from './utils/network/getResolutionOfUrl.mjs';\nexport { path } from './utils/path.mjs';\nexport { GlobalResourceRegistry } from './utils/pool/GlobalResourceRegistry.mjs';\nexport { Pool } from './utils/pool/Pool.mjs';\nexport { BigPool, PoolGroupClass } from './utils/pool/PoolGroup.mjs';\nexport { sayHello } from './utils/sayHello.mjs';\nexport { earcut } from './utils/utils.mjs';\n\n\"use strict\";\nextensions.add(browserExt, webworkerExt);\n\nexport { browserExt, extensions, webworkerExt };\n//# sourceMappingURL=index.mjs.map\n","const DEFAULT_CHARACTER = 'Ariana';\nconst DEFAULT_TYPE = 'Attack';\nconst DEFAULT_RARITY = 'Normal';\nfunction toTitleCase(value) {\n    if (!value)\n        return DEFAULT_CHARACTER;\n    const trimmed = value.trim();\n    if (!trimmed)\n        return DEFAULT_CHARACTER;\n    return trimmed.charAt(0).toUpperCase() + trimmed.slice(1).toLowerCase();\n}\n/**\n *  ID   .\n * ID : {TYPE}_{CHARACTER}_{RARITY}_{NUMBER}\n */\nfunction extractCharacterFromId(cardId) {\n    if (!cardId || typeof cardId !== 'string') {\n        return DEFAULT_CHARACTER;\n    }\n    const parts = cardId.split('_');\n    if (parts.length >= 2) {\n        return toTitleCase(parts[1]);\n    }\n    return DEFAULT_CHARACTER;\n}\nfunction resolveCardMeta(card) {\n    if (!card || typeof card !== 'object') {\n        return {\n            character: DEFAULT_CHARACTER,\n            type: DEFAULT_TYPE,\n            rarity: DEFAULT_RARITY,\n        };\n    }\n    const rawId = card?.id ??\n        card.cardId ??\n        card.baseId;\n    const character = extractCharacterFromId(rawId ?? undefined);\n    const type = typeof card.type === 'string' && card.type ? card.type : DEFAULT_TYPE;\n    const rarity = typeof card.rarity === 'string' && card.rarity ? card.rarity : DEFAULT_RARITY;\n    return {\n        character,\n        type,\n        rarity,\n    };\n}\n/**\n *  ID   /   .\n */\nexport function getCardImagePath(card) {\n    const { character, type, rarity } = resolveCardMeta(card);\n    return `cards/${character}_${type}_${rarity}.webp`;\n}\nexport function getCardImagePathFallback(card) {\n    const { character, type, rarity } = resolveCardMeta(card);\n    return `cards/${character}_${type}_${rarity}.png`;\n}\n","const ko = {\n    // /\n    'ui.profile.title': '',\n    'ui.currency.gold': '',\n    'ui.currency.shard': '',\n    'ui.currency.ticket': '',\n    'ui.btn.ok': '',\n    'ui.btn.cancel': '',\n    'ui.btn.confirm': '',\n    'ui.btn.back': '',\n    //  \n    'ui.mode.campaign': '',\n    'ui.mode.daily': ' ',\n    'ui.mode.draft': '',\n    'ui.mode.pvp': '',\n    'ui.mode.deck': ' ',\n    'ui.mode.shop': '',\n    'ui.mode.archive': '',\n    // /HUD\n    'battle.energy': '',\n    'battle.round': '',\n    'battle.initiative': '',\n    'battle.lockin': ' ',\n    'battle.reveal': '',\n    'battle.pass': '',\n    'battle.endTurn': ' ',\n    'battle.declared': '',\n    'battle.reservedEnergy': ' ',\n    'battle.noCards': '  ',\n    'battle.player': '',\n    'battle.enemy': '',\n    'battle.victory': '!',\n    'battle.defeat': '!',\n    'battle.hp': 'HP',\n    'battle.seed': '',\n    // \n    'tuto.select_card': ' 1  .',\n    'tuto.lockin': ' .',\n    'tuto.reveal': '  .',\n    'tuto.use_fire': '   .',\n    'tuto.burn_tick': '    .',\n    'tuto.use_ice': '   -1  .',\n    'tuto.nullify_hint': '    .',\n    // /\n    'shop.daily_deal': ' ',\n    'shop.buy': '',\n    'reward.first_clear': '  ',\n    'reward.repeat': ' ',\n    //  \n    'log.view.all': '',\n    'log.view.summary': '',\n    'log.filter.all': '',\n    'log.filter.card': '',\n    'log.filter.effect': '',\n    'log.filter.system': '',\n    'log.search': '...',\n    'log.noResults': '  ',\n    //  \n    'card.type.Attack': '',\n    'card.type.Heal': '',\n    'card.type.Defense': '',\n    'card.type.Special': '',\n    // \n    'status.none': '',\n};\nconst en = {\n    // Main/Common\n    'ui.profile.title': 'Profile',\n    'ui.currency.gold': 'Gold',\n    'ui.currency.shard': 'Shards',\n    'ui.currency.ticket': 'Tickets',\n    'ui.btn.ok': 'OK',\n    'ui.btn.cancel': 'Cancel',\n    'ui.btn.confirm': 'Confirm',\n    'ui.btn.back': 'Back',\n    // Mode Selection\n    'ui.mode.campaign': 'Campaign',\n    'ui.mode.daily': 'Daily Dungeon',\n    'ui.mode.draft': 'Draft',\n    'ui.mode.pvp': 'PvP',\n    'ui.mode.deck': 'Deck Editor',\n    'ui.mode.shop': 'Shop',\n    'ui.mode.archive': 'Archive',\n    // Battle/HUD\n    'battle.energy': 'Energy',\n    'battle.round': 'Round',\n    'battle.initiative': 'Initiative',\n    'battle.lockin': 'Lock-in',\n    'battle.reveal': 'Reveal',\n    'battle.pass': 'Pass',\n    'battle.endTurn': 'End Turn',\n    'battle.declared': 'Declared',\n    'battle.reservedEnergy': 'Reserved Energy',\n    'battle.noCards': 'No cards declared',\n    'battle.player': 'Player',\n    'battle.enemy': 'Enemy',\n    'battle.victory': 'Victory!',\n    'battle.defeat': 'Defeat!',\n    'battle.hp': 'HP',\n    'battle.seed': 'Seed',\n    // Tutorial\n    'tuto.select_card': 'Select and declare a card.',\n    'tuto.lockin': 'Declaration locked.',\n    'tuto.reveal': 'Revealing both declarations.',\n    'tuto.use_fire': 'Try applying Burn with Fireball.',\n    'tuto.burn_tick': 'Burn damage applies at turn start.',\n    'tuto.use_ice': 'Try reducing actions with Ice Spike.',\n    'tuto.nullify_hint': 'Try using Nullify before reveal.',\n    // Shop/Rewards\n    'shop.daily_deal': 'Daily Deal',\n    'shop.buy': 'Buy',\n    'reward.first_clear': 'First Clear Reward',\n    'reward.repeat': 'Repeat Reward',\n    // Log Viewer\n    'log.view.all': 'Detailed',\n    'log.view.summary': 'Summary',\n    'log.filter.all': 'All',\n    'log.filter.card': 'Cards',\n    'log.filter.effect': 'Effects',\n    'log.filter.system': 'System',\n    'log.search': 'Search...',\n    'log.noResults': 'No results',\n    // Card Types\n    'card.type.Attack': 'Attack',\n    'card.type.Heal': 'Heal',\n    'card.type.Defense': 'Defense',\n    'card.type.Special': 'Special',\n    // Status\n    'status.none': 'None',\n};\nconst bundles = { ko, en };\n// localStorage   (: 'ko')\nconst LOCALE_STORAGE_KEY = 'gals_locale';\nlet currentLocale = localStorage.getItem(LOCALE_STORAGE_KEY) || 'ko';\n//    Set\nconst missingKeys = new Set();\nexport function setLocale(locale) {\n    const validLocale = locale in bundles ? locale : 'ko';\n    currentLocale = validLocale;\n    // localStorage \n    localStorage.setItem(LOCALE_STORAGE_KEY, validLocale);\n    console.log(`[i18n] Locale changed to: ${validLocale}`);\n}\nexport function t(key) {\n    const bundle = bundles[currentLocale] || {};\n    const translated = bundle[key];\n    if (!translated) {\n        //   \n        if (!missingKeys.has(key)) {\n            missingKeys.add(key);\n            console.warn(`[i18n] Missing translation key: \"${key}\" (locale: ${currentLocale})`);\n        }\n        return key; //    ()\n    }\n    return translated;\n}\nexport function getMissingKeys() {\n    return Array.from(missingKeys).sort();\n}\nexport function getCurrentLocale() {\n    return currentLocale;\n}\n","const createStoreImpl = (createState) => {\n  let state;\n  const listeners = /* @__PURE__ */ new Set();\n  const setState = (partial, replace) => {\n    const nextState = typeof partial === \"function\" ? partial(state) : partial;\n    if (!Object.is(nextState, state)) {\n      const previousState = state;\n      state = (replace != null ? replace : typeof nextState !== \"object\" || nextState === null) ? nextState : Object.assign({}, state, nextState);\n      listeners.forEach((listener) => listener(state, previousState));\n    }\n  };\n  const getState = () => state;\n  const getInitialState = () => initialState;\n  const subscribe = (listener) => {\n    listeners.add(listener);\n    return () => listeners.delete(listener);\n  };\n  const destroy = () => {\n    if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n      console.warn(\n        \"[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected.\"\n      );\n    }\n    listeners.clear();\n  };\n  const api = { setState, getState, getInitialState, subscribe, destroy };\n  const initialState = state = createState(setState, getState, api);\n  return api;\n};\nconst createStore = (createState) => createState ? createStoreImpl(createState) : createStoreImpl;\nvar vanilla = (createState) => {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n    console.warn(\n      \"[DEPRECATED] Default export is deprecated. Instead use import { createStore } from 'zustand/vanilla'.\"\n    );\n  }\n  return createStore(createState);\n};\n\nexport { createStore, vanilla as default };\n","/**\n * @license React\n * react.production.js\n *\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\"use strict\";\nvar REACT_ELEMENT_TYPE = Symbol.for(\"react.transitional.element\"),\n  REACT_PORTAL_TYPE = Symbol.for(\"react.portal\"),\n  REACT_FRAGMENT_TYPE = Symbol.for(\"react.fragment\"),\n  REACT_STRICT_MODE_TYPE = Symbol.for(\"react.strict_mode\"),\n  REACT_PROFILER_TYPE = Symbol.for(\"react.profiler\"),\n  REACT_CONSUMER_TYPE = Symbol.for(\"react.consumer\"),\n  REACT_CONTEXT_TYPE = Symbol.for(\"react.context\"),\n  REACT_FORWARD_REF_TYPE = Symbol.for(\"react.forward_ref\"),\n  REACT_SUSPENSE_TYPE = Symbol.for(\"react.suspense\"),\n  REACT_MEMO_TYPE = Symbol.for(\"react.memo\"),\n  REACT_LAZY_TYPE = Symbol.for(\"react.lazy\"),\n  REACT_ACTIVITY_TYPE = Symbol.for(\"react.activity\"),\n  MAYBE_ITERATOR_SYMBOL = Symbol.iterator;\nfunction getIteratorFn(maybeIterable) {\n  if (null === maybeIterable || \"object\" !== typeof maybeIterable) return null;\n  maybeIterable =\n    (MAYBE_ITERATOR_SYMBOL && maybeIterable[MAYBE_ITERATOR_SYMBOL]) ||\n    maybeIterable[\"@@iterator\"];\n  return \"function\" === typeof maybeIterable ? maybeIterable : null;\n}\nvar ReactNoopUpdateQueue = {\n    isMounted: function () {\n      return !1;\n    },\n    enqueueForceUpdate: function () {},\n    enqueueReplaceState: function () {},\n    enqueueSetState: function () {}\n  },\n  assign = Object.assign,\n  emptyObject = {};\nfunction Component(props, context, updater) {\n  this.props = props;\n  this.context = context;\n  this.refs = emptyObject;\n  this.updater = updater || ReactNoopUpdateQueue;\n}\nComponent.prototype.isReactComponent = {};\nComponent.prototype.setState = function (partialState, callback) {\n  if (\n    \"object\" !== typeof partialState &&\n    \"function\" !== typeof partialState &&\n    null != partialState\n  )\n    throw Error(\n      \"takes an object of state variables to update or a function which returns an object of state variables.\"\n    );\n  this.updater.enqueueSetState(this, partialState, callback, \"setState\");\n};\nComponent.prototype.forceUpdate = function (callback) {\n  this.updater.enqueueForceUpdate(this, callback, \"forceUpdate\");\n};\nfunction ComponentDummy() {}\nComponentDummy.prototype = Component.prototype;\nfunction PureComponent(props, context, updater) {\n  this.props = props;\n  this.context = context;\n  this.refs = emptyObject;\n  this.updater = updater || ReactNoopUpdateQueue;\n}\nvar pureComponentPrototype = (PureComponent.prototype = new ComponentDummy());\npureComponentPrototype.constructor = PureComponent;\nassign(pureComponentPrototype, Component.prototype);\npureComponentPrototype.isPureReactComponent = !0;\nvar isArrayImpl = Array.isArray;\nfunction noop() {}\nvar ReactSharedInternals = { H: null, A: null, T: null, S: null },\n  hasOwnProperty = Object.prototype.hasOwnProperty;\nfunction ReactElement(type, key, props) {\n  var refProp = props.ref;\n  return {\n    $$typeof: REACT_ELEMENT_TYPE,\n    type: type,\n    key: key,\n    ref: void 0 !== refProp ? refProp : null,\n    props: props\n  };\n}\nfunction cloneAndReplaceKey(oldElement, newKey) {\n  return ReactElement(oldElement.type, newKey, oldElement.props);\n}\nfunction isValidElement(object) {\n  return (\n    \"object\" === typeof object &&\n    null !== object &&\n    object.$$typeof === REACT_ELEMENT_TYPE\n  );\n}\nfunction escape(key) {\n  var escaperLookup = { \"=\": \"=0\", \":\": \"=2\" };\n  return (\n    \"$\" +\n    key.replace(/[=:]/g, function (match) {\n      return escaperLookup[match];\n    })\n  );\n}\nvar userProvidedKeyEscapeRegex = /\\/+/g;\nfunction getElementKey(element, index) {\n  return \"object\" === typeof element && null !== element && null != element.key\n    ? escape(\"\" + element.key)\n    : index.toString(36);\n}\nfunction resolveThenable(thenable) {\n  switch (thenable.status) {\n    case \"fulfilled\":\n      return thenable.value;\n    case \"rejected\":\n      throw thenable.reason;\n    default:\n      switch (\n        (\"string\" === typeof thenable.status\n          ? thenable.then(noop, noop)\n          : ((thenable.status = \"pending\"),\n            thenable.then(\n              function (fulfilledValue) {\n                \"pending\" === thenable.status &&\n                  ((thenable.status = \"fulfilled\"),\n                  (thenable.value = fulfilledValue));\n              },\n              function (error) {\n                \"pending\" === thenable.status &&\n                  ((thenable.status = \"rejected\"), (thenable.reason = error));\n              }\n            )),\n        thenable.status)\n      ) {\n        case \"fulfilled\":\n          return thenable.value;\n        case \"rejected\":\n          throw thenable.reason;\n      }\n  }\n  throw thenable;\n}\nfunction mapIntoArray(children, array, escapedPrefix, nameSoFar, callback) {\n  var type = typeof children;\n  if (\"undefined\" === type || \"boolean\" === type) children = null;\n  var invokeCallback = !1;\n  if (null === children) invokeCallback = !0;\n  else\n    switch (type) {\n      case \"bigint\":\n      case \"string\":\n      case \"number\":\n        invokeCallback = !0;\n        break;\n      case \"object\":\n        switch (children.$$typeof) {\n          case REACT_ELEMENT_TYPE:\n          case REACT_PORTAL_TYPE:\n            invokeCallback = !0;\n            break;\n          case REACT_LAZY_TYPE:\n            return (\n              (invokeCallback = children._init),\n              mapIntoArray(\n                invokeCallback(children._payload),\n                array,\n                escapedPrefix,\n                nameSoFar,\n                callback\n              )\n            );\n        }\n    }\n  if (invokeCallback)\n    return (\n      (callback = callback(children)),\n      (invokeCallback =\n        \"\" === nameSoFar ? \".\" + getElementKey(children, 0) : nameSoFar),\n      isArrayImpl(callback)\n        ? ((escapedPrefix = \"\"),\n          null != invokeCallback &&\n            (escapedPrefix =\n              invokeCallback.replace(userProvidedKeyEscapeRegex, \"$&/\") + \"/\"),\n          mapIntoArray(callback, array, escapedPrefix, \"\", function (c) {\n            return c;\n          }))\n        : null != callback &&\n          (isValidElement(callback) &&\n            (callback = cloneAndReplaceKey(\n              callback,\n              escapedPrefix +\n                (null == callback.key ||\n                (children && children.key === callback.key)\n                  ? \"\"\n                  : (\"\" + callback.key).replace(\n                      userProvidedKeyEscapeRegex,\n                      \"$&/\"\n                    ) + \"/\") +\n                invokeCallback\n            )),\n          array.push(callback)),\n      1\n    );\n  invokeCallback = 0;\n  var nextNamePrefix = \"\" === nameSoFar ? \".\" : nameSoFar + \":\";\n  if (isArrayImpl(children))\n    for (var i = 0; i < children.length; i++)\n      (nameSoFar = children[i]),\n        (type = nextNamePrefix + getElementKey(nameSoFar, i)),\n        (invokeCallback += mapIntoArray(\n          nameSoFar,\n          array,\n          escapedPrefix,\n          type,\n          callback\n        ));\n  else if (((i = getIteratorFn(children)), \"function\" === typeof i))\n    for (\n      children = i.call(children), i = 0;\n      !(nameSoFar = children.next()).done;\n\n    )\n      (nameSoFar = nameSoFar.value),\n        (type = nextNamePrefix + getElementKey(nameSoFar, i++)),\n        (invokeCallback += mapIntoArray(\n          nameSoFar,\n          array,\n          escapedPrefix,\n          type,\n          callback\n        ));\n  else if (\"object\" === type) {\n    if (\"function\" === typeof children.then)\n      return mapIntoArray(\n        resolveThenable(children),\n        array,\n        escapedPrefix,\n        nameSoFar,\n        callback\n      );\n    array = String(children);\n    throw Error(\n      \"Objects are not valid as a React child (found: \" +\n        (\"[object Object]\" === array\n          ? \"object with keys {\" + Object.keys(children).join(\", \") + \"}\"\n          : array) +\n        \"). If you meant to render a collection of children, use an array instead.\"\n    );\n  }\n  return invokeCallback;\n}\nfunction mapChildren(children, func, context) {\n  if (null == children) return children;\n  var result = [],\n    count = 0;\n  mapIntoArray(children, result, \"\", \"\", function (child) {\n    return func.call(context, child, count++);\n  });\n  return result;\n}\nfunction lazyInitializer(payload) {\n  if (-1 === payload._status) {\n    var ctor = payload._result;\n    ctor = ctor();\n    ctor.then(\n      function (moduleObject) {\n        if (0 === payload._status || -1 === payload._status)\n          (payload._status = 1), (payload._result = moduleObject);\n      },\n      function (error) {\n        if (0 === payload._status || -1 === payload._status)\n          (payload._status = 2), (payload._result = error);\n      }\n    );\n    -1 === payload._status && ((payload._status = 0), (payload._result = ctor));\n  }\n  if (1 === payload._status) return payload._result.default;\n  throw payload._result;\n}\nvar reportGlobalError =\n    \"function\" === typeof reportError\n      ? reportError\n      : function (error) {\n          if (\n            \"object\" === typeof window &&\n            \"function\" === typeof window.ErrorEvent\n          ) {\n            var event = new window.ErrorEvent(\"error\", {\n              bubbles: !0,\n              cancelable: !0,\n              message:\n                \"object\" === typeof error &&\n                null !== error &&\n                \"string\" === typeof error.message\n                  ? String(error.message)\n                  : String(error),\n              error: error\n            });\n            if (!window.dispatchEvent(event)) return;\n          } else if (\n            \"object\" === typeof process &&\n            \"function\" === typeof process.emit\n          ) {\n            process.emit(\"uncaughtException\", error);\n            return;\n          }\n          console.error(error);\n        },\n  Children = {\n    map: mapChildren,\n    forEach: function (children, forEachFunc, forEachContext) {\n      mapChildren(\n        children,\n        function () {\n          forEachFunc.apply(this, arguments);\n        },\n        forEachContext\n      );\n    },\n    count: function (children) {\n      var n = 0;\n      mapChildren(children, function () {\n        n++;\n      });\n      return n;\n    },\n    toArray: function (children) {\n      return (\n        mapChildren(children, function (child) {\n          return child;\n        }) || []\n      );\n    },\n    only: function (children) {\n      if (!isValidElement(children))\n        throw Error(\n          \"React.Children.only expected to receive a single React element child.\"\n        );\n      return children;\n    }\n  };\nexports.Activity = REACT_ACTIVITY_TYPE;\nexports.Children = Children;\nexports.Component = Component;\nexports.Fragment = REACT_FRAGMENT_TYPE;\nexports.Profiler = REACT_PROFILER_TYPE;\nexports.PureComponent = PureComponent;\nexports.StrictMode = REACT_STRICT_MODE_TYPE;\nexports.Suspense = REACT_SUSPENSE_TYPE;\nexports.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE =\n  ReactSharedInternals;\nexports.__COMPILER_RUNTIME = {\n  __proto__: null,\n  c: function (size) {\n    return ReactSharedInternals.H.useMemoCache(size);\n  }\n};\nexports.cache = function (fn) {\n  return function () {\n    return fn.apply(null, arguments);\n  };\n};\nexports.cacheSignal = function () {\n  return null;\n};\nexports.cloneElement = function (element, config, children) {\n  if (null === element || void 0 === element)\n    throw Error(\n      \"The argument must be a React element, but you passed \" + element + \".\"\n    );\n  var props = assign({}, element.props),\n    key = element.key;\n  if (null != config)\n    for (propName in (void 0 !== config.key && (key = \"\" + config.key), config))\n      !hasOwnProperty.call(config, propName) ||\n        \"key\" === propName ||\n        \"__self\" === propName ||\n        \"__source\" === propName ||\n        (\"ref\" === propName && void 0 === config.ref) ||\n        (props[propName] = config[propName]);\n  var propName = arguments.length - 2;\n  if (1 === propName) props.children = children;\n  else if (1 < propName) {\n    for (var childArray = Array(propName), i = 0; i < propName; i++)\n      childArray[i] = arguments[i + 2];\n    props.children = childArray;\n  }\n  return ReactElement(element.type, key, props);\n};\nexports.createContext = function (defaultValue) {\n  defaultValue = {\n    $$typeof: REACT_CONTEXT_TYPE,\n    _currentValue: defaultValue,\n    _currentValue2: defaultValue,\n    _threadCount: 0,\n    Provider: null,\n    Consumer: null\n  };\n  defaultValue.Provider = defaultValue;\n  defaultValue.Consumer = {\n    $$typeof: REACT_CONSUMER_TYPE,\n    _context: defaultValue\n  };\n  return defaultValue;\n};\nexports.createElement = function (type, config, children) {\n  var propName,\n    props = {},\n    key = null;\n  if (null != config)\n    for (propName in (void 0 !== config.key && (key = \"\" + config.key), config))\n      hasOwnProperty.call(config, propName) &&\n        \"key\" !== propName &&\n        \"__self\" !== propName &&\n        \"__source\" !== propName &&\n        (props[propName] = config[propName]);\n  var childrenLength = arguments.length - 2;\n  if (1 === childrenLength) props.children = children;\n  else if (1 < childrenLength) {\n    for (var childArray = Array(childrenLength), i = 0; i < childrenLength; i++)\n      childArray[i] = arguments[i + 2];\n    props.children = childArray;\n  }\n  if (type && type.defaultProps)\n    for (propName in ((childrenLength = type.defaultProps), childrenLength))\n      void 0 === props[propName] &&\n        (props[propName] = childrenLength[propName]);\n  return ReactElement(type, key, props);\n};\nexports.createRef = function () {\n  return { current: null };\n};\nexports.forwardRef = function (render) {\n  return { $$typeof: REACT_FORWARD_REF_TYPE, render: render };\n};\nexports.isValidElement = isValidElement;\nexports.lazy = function (ctor) {\n  return {\n    $$typeof: REACT_LAZY_TYPE,\n    _payload: { _status: -1, _result: ctor },\n    _init: lazyInitializer\n  };\n};\nexports.memo = function (type, compare) {\n  return {\n    $$typeof: REACT_MEMO_TYPE,\n    type: type,\n    compare: void 0 === compare ? null : compare\n  };\n};\nexports.startTransition = function (scope) {\n  var prevTransition = ReactSharedInternals.T,\n    currentTransition = {};\n  ReactSharedInternals.T = currentTransition;\n  try {\n    var returnValue = scope(),\n      onStartTransitionFinish = ReactSharedInternals.S;\n    null !== onStartTransitionFinish &&\n      onStartTransitionFinish(currentTransition, returnValue);\n    \"object\" === typeof returnValue &&\n      null !== returnValue &&\n      \"function\" === typeof returnValue.then &&\n      returnValue.then(noop, reportGlobalError);\n  } catch (error) {\n    reportGlobalError(error);\n  } finally {\n    null !== prevTransition &&\n      null !== currentTransition.types &&\n      (prevTransition.types = currentTransition.types),\n      (ReactSharedInternals.T = prevTransition);\n  }\n};\nexports.unstable_useCacheRefresh = function () {\n  return ReactSharedInternals.H.useCacheRefresh();\n};\nexports.use = function (usable) {\n  return ReactSharedInternals.H.use(usable);\n};\nexports.useActionState = function (action, initialState, permalink) {\n  return ReactSharedInternals.H.useActionState(action, initialState, permalink);\n};\nexports.useCallback = function (callback, deps) {\n  return ReactSharedInternals.H.useCallback(callback, deps);\n};\nexports.useContext = function (Context) {\n  return ReactSharedInternals.H.useContext(Context);\n};\nexports.useDebugValue = function () {};\nexports.useDeferredValue = function (value, initialValue) {\n  return ReactSharedInternals.H.useDeferredValue(value, initialValue);\n};\nexports.useEffect = function (create, deps) {\n  return ReactSharedInternals.H.useEffect(create, deps);\n};\nexports.useEffectEvent = function (callback) {\n  return ReactSharedInternals.H.useEffectEvent(callback);\n};\nexports.useId = function () {\n  return ReactSharedInternals.H.useId();\n};\nexports.useImperativeHandle = function (ref, create, deps) {\n  return ReactSharedInternals.H.useImperativeHandle(ref, create, deps);\n};\nexports.useInsertionEffect = function (create, deps) {\n  return ReactSharedInternals.H.useInsertionEffect(create, deps);\n};\nexports.useLayoutEffect = function (create, deps) {\n  return ReactSharedInternals.H.useLayoutEffect(create, deps);\n};\nexports.useMemo = function (create, deps) {\n  return ReactSharedInternals.H.useMemo(create, deps);\n};\nexports.useOptimistic = function (passthrough, reducer) {\n  return ReactSharedInternals.H.useOptimistic(passthrough, reducer);\n};\nexports.useReducer = function (reducer, initialArg, init) {\n  return ReactSharedInternals.H.useReducer(reducer, initialArg, init);\n};\nexports.useRef = function (initialValue) {\n  return ReactSharedInternals.H.useRef(initialValue);\n};\nexports.useState = function (initialState) {\n  return ReactSharedInternals.H.useState(initialState);\n};\nexports.useSyncExternalStore = function (\n  subscribe,\n  getSnapshot,\n  getServerSnapshot\n) {\n  return ReactSharedInternals.H.useSyncExternalStore(\n    subscribe,\n    getSnapshot,\n    getServerSnapshot\n  );\n};\nexports.useTransition = function () {\n  return ReactSharedInternals.H.useTransition();\n};\nexports.version = \"19.2.0\";\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react.production.js');\n} else {\n  module.exports = require('./cjs/react.development.js');\n}\n","/**\n * @license React\n * use-sync-external-store-shim.production.js\n *\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\"use strict\";\nvar React = require(\"react\");\nfunction is(x, y) {\n  return (x === y && (0 !== x || 1 / x === 1 / y)) || (x !== x && y !== y);\n}\nvar objectIs = \"function\" === typeof Object.is ? Object.is : is,\n  useState = React.useState,\n  useEffect = React.useEffect,\n  useLayoutEffect = React.useLayoutEffect,\n  useDebugValue = React.useDebugValue;\nfunction useSyncExternalStore$2(subscribe, getSnapshot) {\n  var value = getSnapshot(),\n    _useState = useState({ inst: { value: value, getSnapshot: getSnapshot } }),\n    inst = _useState[0].inst,\n    forceUpdate = _useState[1];\n  useLayoutEffect(\n    function () {\n      inst.value = value;\n      inst.getSnapshot = getSnapshot;\n      checkIfSnapshotChanged(inst) && forceUpdate({ inst: inst });\n    },\n    [subscribe, value, getSnapshot]\n  );\n  useEffect(\n    function () {\n      checkIfSnapshotChanged(inst) && forceUpdate({ inst: inst });\n      return subscribe(function () {\n        checkIfSnapshotChanged(inst) && forceUpdate({ inst: inst });\n      });\n    },\n    [subscribe]\n  );\n  useDebugValue(value);\n  return value;\n}\nfunction checkIfSnapshotChanged(inst) {\n  var latestGetSnapshot = inst.getSnapshot;\n  inst = inst.value;\n  try {\n    var nextValue = latestGetSnapshot();\n    return !objectIs(inst, nextValue);\n  } catch (error) {\n    return !0;\n  }\n}\nfunction useSyncExternalStore$1(subscribe, getSnapshot) {\n  return getSnapshot();\n}\nvar shim =\n  \"undefined\" === typeof window ||\n  \"undefined\" === typeof window.document ||\n  \"undefined\" === typeof window.document.createElement\n    ? useSyncExternalStore$1\n    : useSyncExternalStore$2;\nexports.useSyncExternalStore =\n  void 0 !== React.useSyncExternalStore ? React.useSyncExternalStore : shim;\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('../cjs/use-sync-external-store-shim.production.js');\n} else {\n  module.exports = require('../cjs/use-sync-external-store-shim.development.js');\n}\n","/**\n * @license React\n * use-sync-external-store-shim/with-selector.production.js\n *\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\"use strict\";\nvar React = require(\"react\"),\n  shim = require(\"use-sync-external-store/shim\");\nfunction is(x, y) {\n  return (x === y && (0 !== x || 1 / x === 1 / y)) || (x !== x && y !== y);\n}\nvar objectIs = \"function\" === typeof Object.is ? Object.is : is,\n  useSyncExternalStore = shim.useSyncExternalStore,\n  useRef = React.useRef,\n  useEffect = React.useEffect,\n  useMemo = React.useMemo,\n  useDebugValue = React.useDebugValue;\nexports.useSyncExternalStoreWithSelector = function (\n  subscribe,\n  getSnapshot,\n  getServerSnapshot,\n  selector,\n  isEqual\n) {\n  var instRef = useRef(null);\n  if (null === instRef.current) {\n    var inst = { hasValue: !1, value: null };\n    instRef.current = inst;\n  } else inst = instRef.current;\n  instRef = useMemo(\n    function () {\n      function memoizedSelector(nextSnapshot) {\n        if (!hasMemo) {\n          hasMemo = !0;\n          memoizedSnapshot = nextSnapshot;\n          nextSnapshot = selector(nextSnapshot);\n          if (void 0 !== isEqual && inst.hasValue) {\n            var currentSelection = inst.value;\n            if (isEqual(currentSelection, nextSnapshot))\n              return (memoizedSelection = currentSelection);\n          }\n          return (memoizedSelection = nextSnapshot);\n        }\n        currentSelection = memoizedSelection;\n        if (objectIs(memoizedSnapshot, nextSnapshot)) return currentSelection;\n        var nextSelection = selector(nextSnapshot);\n        if (void 0 !== isEqual && isEqual(currentSelection, nextSelection))\n          return (memoizedSnapshot = nextSnapshot), currentSelection;\n        memoizedSnapshot = nextSnapshot;\n        return (memoizedSelection = nextSelection);\n      }\n      var hasMemo = !1,\n        memoizedSnapshot,\n        memoizedSelection,\n        maybeGetServerSnapshot =\n          void 0 === getServerSnapshot ? null : getServerSnapshot;\n      return [\n        function () {\n          return memoizedSelector(getSnapshot());\n        },\n        null === maybeGetServerSnapshot\n          ? void 0\n          : function () {\n              return memoizedSelector(maybeGetServerSnapshot());\n            }\n      ];\n    },\n    [getSnapshot, getServerSnapshot, selector, isEqual]\n  );\n  var value = useSyncExternalStore(subscribe, instRef[0], instRef[1]);\n  useEffect(\n    function () {\n      inst.hasValue = !0;\n      inst.value = value;\n    },\n    [value]\n  );\n  useDebugValue(value);\n  return value;\n};\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('../cjs/use-sync-external-store-shim/with-selector.production.js');\n} else {\n  module.exports = require('../cjs/use-sync-external-store-shim/with-selector.development.js');\n}\n","import { createStore } from 'zustand/vanilla';\nexport * from 'zustand/vanilla';\nimport ReactExports from 'react';\nimport useSyncExternalStoreExports from 'use-sync-external-store/shim/with-selector.js';\n\nconst { useDebugValue } = ReactExports;\nconst { useSyncExternalStoreWithSelector } = useSyncExternalStoreExports;\nlet didWarnAboutEqualityFn = false;\nconst identity = (arg) => arg;\nfunction useStore(api, selector = identity, equalityFn) {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && equalityFn && !didWarnAboutEqualityFn) {\n    console.warn(\n      \"[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937\"\n    );\n    didWarnAboutEqualityFn = true;\n  }\n  const slice = useSyncExternalStoreWithSelector(\n    api.subscribe,\n    api.getState,\n    api.getServerState || api.getInitialState,\n    selector,\n    equalityFn\n  );\n  useDebugValue(slice);\n  return slice;\n}\nconst createImpl = (createState) => {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && typeof createState !== \"function\") {\n    console.warn(\n      \"[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.\"\n    );\n  }\n  const api = typeof createState === \"function\" ? createStore(createState) : createState;\n  const useBoundStore = (selector, equalityFn) => useStore(api, selector, equalityFn);\n  Object.assign(useBoundStore, api);\n  return useBoundStore;\n};\nconst create = (createState) => createState ? createImpl(createState) : createImpl;\nvar react = (createState) => {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n    console.warn(\n      \"[DEPRECATED] Default export is deprecated. Instead use `import { create } from 'zustand'`.\"\n    );\n  }\n  return create(createState);\n};\n\nexport { create, react as default, useStore };\n","/******************************************************************************\nCopyright (c) Microsoft Corporation.\n\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE.\n***************************************************************************** */\n/* global Reflect, Promise, SuppressedError, Symbol, Iterator */\n\nvar extendStatics = function(d, b) {\n  extendStatics = Object.setPrototypeOf ||\n      ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n      function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n  return extendStatics(d, b);\n};\n\nexport function __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null)\n      throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n  function __() { this.constructor = d; }\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nexport var __assign = function() {\n  __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n      return t;\n  }\n  return __assign.apply(this, arguments);\n}\n\nexport function __rest(s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n      t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n      for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n              t[p[i]] = s[p[i]];\n      }\n  return t;\n}\n\nexport function __decorate(decorators, target, key, desc) {\n  var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n  else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\n\nexport function __param(paramIndex, decorator) {\n  return function (target, key) { decorator(target, key, paramIndex); }\n}\n\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n  function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n  var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n  var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n  var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n  var _, done = false;\n  for (var i = decorators.length - 1; i >= 0; i--) {\n      var context = {};\n      for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n      for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n      context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n      var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n      if (kind === \"accessor\") {\n          if (result === void 0) continue;\n          if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n          if (_ = accept(result.get)) descriptor.get = _;\n          if (_ = accept(result.set)) descriptor.set = _;\n          if (_ = accept(result.init)) initializers.unshift(_);\n      }\n      else if (_ = accept(result)) {\n          if (kind === \"field\") initializers.unshift(_);\n          else descriptor[key] = _;\n      }\n  }\n  if (target) Object.defineProperty(target, contextIn.name, descriptor);\n  done = true;\n};\n\nexport function __runInitializers(thisArg, initializers, value) {\n  var useValue = arguments.length > 2;\n  for (var i = 0; i < initializers.length; i++) {\n      value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n  }\n  return useValue ? value : void 0;\n};\n\nexport function __propKey(x) {\n  return typeof x === \"symbol\" ? x : \"\".concat(x);\n};\n\nexport function __setFunctionName(f, name, prefix) {\n  if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\n  return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\n};\n\nexport function __metadata(metadataKey, metadataValue) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\n}\n\nexport function __awaiter(thisArg, _arguments, P, generator) {\n  function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n  return new (P || (P = Promise))(function (resolve, reject) {\n      function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n      function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n      function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n      step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n}\n\nexport function __generator(thisArg, body) {\n  var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === \"function\" ? Iterator : Object).prototype);\n  return g.next = verb(0), g[\"throw\"] = verb(1), g[\"return\"] = verb(2), typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n  function verb(n) { return function (v) { return step([n, v]); }; }\n  function step(op) {\n      if (f) throw new TypeError(\"Generator is already executing.\");\n      while (g && (g = 0, op[0] && (_ = 0)), _) try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n          switch (op[0]) {\n              case 0: case 1: t = op; break;\n              case 4: _.label++; return { value: op[1], done: false };\n              case 5: _.label++; y = op[1]; op = [0]; continue;\n              case 7: op = _.ops.pop(); _.trys.pop(); continue;\n              default:\n                  if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                  if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                  if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                  if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                  if (t[2]) _.ops.pop();\n                  _.trys.pop(); continue;\n          }\n          op = body.call(thisArg, _);\n      } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n      if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n  }\n}\n\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n  }\n  Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nexport function __exportStar(m, o) {\n  for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\n}\n\nexport function __values(o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n      next: function () {\n          if (o && i >= o.length) o = void 0;\n          return { value: o && o[i++], done: !o };\n      }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n}\n\nexport function __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o), r, ar = [], e;\n  try {\n      while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  }\n  catch (error) { e = { error: error }; }\n  finally {\n      try {\n          if (r && !r.done && (m = i[\"return\"])) m.call(i);\n      }\n      finally { if (e) throw e.error; }\n  }\n  return ar;\n}\n\n/** @deprecated */\nexport function __spread() {\n  for (var ar = [], i = 0; i < arguments.length; i++)\n      ar = ar.concat(__read(arguments[i]));\n  return ar;\n}\n\n/** @deprecated */\nexport function __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n  for (var r = Array(s), k = 0, i = 0; i < il; i++)\n      for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n          r[k] = a[j];\n  return r;\n}\n\nexport function __spreadArray(to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n      if (ar || !(i in from)) {\n          if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n          ar[i] = from[i];\n      }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n}\n\nexport function __await(v) {\n  return this instanceof __await ? (this.v = v, this) : new __await(v);\n}\n\nexport function __asyncGenerator(thisArg, _arguments, generator) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var g = generator.apply(thisArg, _arguments || []), i, q = [];\n  return i = Object.create((typeof AsyncIterator === \"function\" ? AsyncIterator : Object).prototype), verb(\"next\"), verb(\"throw\"), verb(\"return\", awaitReturn), i[Symbol.asyncIterator] = function () { return this; }, i;\n  function awaitReturn(f) { return function (v) { return Promise.resolve(v).then(f, reject); }; }\n  function verb(n, f) { if (g[n]) { i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; if (f) i[n] = f(i[n]); } }\n  function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\n  function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\n  function fulfill(value) { resume(\"next\", value); }\n  function reject(value) { resume(\"throw\", value); }\n  function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\n}\n\nexport function __asyncDelegator(o) {\n  var i, p;\n  return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\n  function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\n}\n\nexport function __asyncValues(o) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var m = o[Symbol.asyncIterator], i;\n  return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\n  function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\n  function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\n}\n\nexport function __makeTemplateObject(cooked, raw) {\n  if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n  return cooked;\n};\n\nvar __setModuleDefault = Object.create ? (function(o, v) {\n  Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n  o[\"default\"] = v;\n};\n\nvar ownKeys = function(o) {\n  ownKeys = Object.getOwnPropertyNames || function (o) {\n    var ar = [];\n    for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n    return ar;\n  };\n  return ownKeys(o);\n};\n\nexport function __importStar(mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n  __setModuleDefault(result, mod);\n  return result;\n}\n\nexport function __importDefault(mod) {\n  return (mod && mod.__esModule) ? mod : { default: mod };\n}\n\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n}\n\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n}\n\nexport function __classPrivateFieldIn(state, receiver) {\n  if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\n  return typeof state === \"function\" ? receiver === state : state.has(receiver);\n}\n\nexport function __addDisposableResource(env, value, async) {\n  if (value !== null && value !== void 0) {\n    if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\n    var dispose, inner;\n    if (async) {\n      if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\n      dispose = value[Symbol.asyncDispose];\n    }\n    if (dispose === void 0) {\n      if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\n      dispose = value[Symbol.dispose];\n      if (async) inner = dispose;\n    }\n    if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\n    if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\n    env.stack.push({ value: value, dispose: dispose, async: async });\n  }\n  else if (async) {\n    env.stack.push({ async: true });\n  }\n  return value;\n}\n\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\n  var e = new Error(message);\n  return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\n};\n\nexport function __disposeResources(env) {\n  function fail(e) {\n    env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\n    env.hasError = true;\n  }\n  var r, s = 0;\n  function next() {\n    while (r = env.stack.pop()) {\n      try {\n        if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\n        if (r.dispose) {\n          var result = r.dispose.call(r.value);\n          if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\n        }\n        else s |= 1;\n      }\n      catch (e) {\n        fail(e);\n      }\n    }\n    if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\n    if (env.hasError) throw env.error;\n  }\n  return next();\n}\n\nexport function __rewriteRelativeImportExtension(path, preserveJsx) {\n  if (typeof path === \"string\" && /^\\.\\.?\\//.test(path)) {\n      return path.replace(/\\.(tsx)$|((?:\\.d)?)((?:\\.[^./]+?)?)\\.([cm]?)ts$/i, function (m, tsx, d, ext, cm) {\n          return tsx ? preserveJsx ? \".jsx\" : \".js\" : d && (!ext || !cm) ? m : (d + ext + \".\" + cm.toLowerCase() + \"js\");\n      });\n  }\n  return path;\n}\n\nexport default {\n  __extends,\n  __assign,\n  __rest,\n  __decorate,\n  __param,\n  __esDecorate,\n  __runInitializers,\n  __propKey,\n  __setFunctionName,\n  __metadata,\n  __awaiter,\n  __generator,\n  __createBinding,\n  __exportStar,\n  __values,\n  __read,\n  __spread,\n  __spreadArrays,\n  __spreadArray,\n  __await,\n  __asyncGenerator,\n  __asyncDelegator,\n  __asyncValues,\n  __makeTemplateObject,\n  __importStar,\n  __importDefault,\n  __classPrivateFieldGet,\n  __classPrivateFieldSet,\n  __classPrivateFieldIn,\n  __addDisposableResource,\n  __disposeResources,\n  __rewriteRelativeImportExtension,\n};\n","export const resolveFetch = (customFetch) => {\n    if (customFetch) {\n        return (...args) => customFetch(...args);\n    }\n    return (...args) => fetch(...args);\n};\n//# sourceMappingURL=helper.js.map","export class FunctionsError extends Error {\n    constructor(message, name = 'FunctionsError', context) {\n        super(message);\n        this.name = name;\n        this.context = context;\n    }\n}\nexport class FunctionsFetchError extends FunctionsError {\n    constructor(context) {\n        super('Failed to send a request to the Edge Function', 'FunctionsFetchError', context);\n    }\n}\nexport class FunctionsRelayError extends FunctionsError {\n    constructor(context) {\n        super('Relay Error invoking the Edge Function', 'FunctionsRelayError', context);\n    }\n}\nexport class FunctionsHttpError extends FunctionsError {\n    constructor(context) {\n        super('Edge Function returned a non-2xx status code', 'FunctionsHttpError', context);\n    }\n}\n// Define the enum for the 'region' property\nexport var FunctionRegion;\n(function (FunctionRegion) {\n    FunctionRegion[\"Any\"] = \"any\";\n    FunctionRegion[\"ApNortheast1\"] = \"ap-northeast-1\";\n    FunctionRegion[\"ApNortheast2\"] = \"ap-northeast-2\";\n    FunctionRegion[\"ApSouth1\"] = \"ap-south-1\";\n    FunctionRegion[\"ApSoutheast1\"] = \"ap-southeast-1\";\n    FunctionRegion[\"ApSoutheast2\"] = \"ap-southeast-2\";\n    FunctionRegion[\"CaCentral1\"] = \"ca-central-1\";\n    FunctionRegion[\"EuCentral1\"] = \"eu-central-1\";\n    FunctionRegion[\"EuWest1\"] = \"eu-west-1\";\n    FunctionRegion[\"EuWest2\"] = \"eu-west-2\";\n    FunctionRegion[\"EuWest3\"] = \"eu-west-3\";\n    FunctionRegion[\"SaEast1\"] = \"sa-east-1\";\n    FunctionRegion[\"UsEast1\"] = \"us-east-1\";\n    FunctionRegion[\"UsWest1\"] = \"us-west-1\";\n    FunctionRegion[\"UsWest2\"] = \"us-west-2\";\n})(FunctionRegion || (FunctionRegion = {}));\n//# sourceMappingURL=types.js.map","import { __awaiter } from \"tslib\";\nimport { resolveFetch } from './helper';\nimport { FunctionRegion, FunctionsFetchError, FunctionsHttpError, FunctionsRelayError, } from './types';\nexport class FunctionsClient {\n    constructor(url, { headers = {}, customFetch, region = FunctionRegion.Any, } = {}) {\n        this.url = url;\n        this.headers = headers;\n        this.region = region;\n        this.fetch = resolveFetch(customFetch);\n    }\n    /**\n     * Updates the authorization header\n     * @param token - the new jwt token sent in the authorisation header\n     */\n    setAuth(token) {\n        this.headers.Authorization = `Bearer ${token}`;\n    }\n    /**\n     * Invokes a function\n     * @param functionName - The name of the Function to invoke.\n     * @param options - Options for invoking the Function.\n     */\n    invoke(functionName_1) {\n        return __awaiter(this, arguments, void 0, function* (functionName, options = {}) {\n            var _a;\n            try {\n                const { headers, method, body: functionArgs, signal } = options;\n                let _headers = {};\n                let { region } = options;\n                if (!region) {\n                    region = this.region;\n                }\n                // Add region as query parameter using URL API\n                const url = new URL(`${this.url}/${functionName}`);\n                if (region && region !== 'any') {\n                    _headers['x-region'] = region;\n                    url.searchParams.set('forceFunctionRegion', region);\n                }\n                let body;\n                if (functionArgs &&\n                    ((headers && !Object.prototype.hasOwnProperty.call(headers, 'Content-Type')) || !headers)) {\n                    if ((typeof Blob !== 'undefined' && functionArgs instanceof Blob) ||\n                        functionArgs instanceof ArrayBuffer) {\n                        // will work for File as File inherits Blob\n                        // also works for ArrayBuffer as it is the same underlying structure as a Blob\n                        _headers['Content-Type'] = 'application/octet-stream';\n                        body = functionArgs;\n                    }\n                    else if (typeof functionArgs === 'string') {\n                        // plain string\n                        _headers['Content-Type'] = 'text/plain';\n                        body = functionArgs;\n                    }\n                    else if (typeof FormData !== 'undefined' && functionArgs instanceof FormData) {\n                        // don't set content-type headers\n                        // Request will automatically add the right boundary value\n                        body = functionArgs;\n                    }\n                    else {\n                        // default, assume this is JSON\n                        _headers['Content-Type'] = 'application/json';\n                        body = JSON.stringify(functionArgs);\n                    }\n                }\n                else {\n                    // if the Content-Type was supplied, simply set the body\n                    body = functionArgs;\n                }\n                const response = yield this.fetch(url.toString(), {\n                    method: method || 'POST',\n                    // headers priority is (high to low):\n                    // 1. invoke-level headers\n                    // 2. client-level headers\n                    // 3. default Content-Type header\n                    headers: Object.assign(Object.assign(Object.assign({}, _headers), this.headers), headers),\n                    body,\n                    signal,\n                }).catch((fetchError) => {\n                    if (fetchError.name === 'AbortError') {\n                        throw fetchError;\n                    }\n                    throw new FunctionsFetchError(fetchError);\n                });\n                const isRelayError = response.headers.get('x-relay-error');\n                if (isRelayError && isRelayError === 'true') {\n                    throw new FunctionsRelayError(response);\n                }\n                if (!response.ok) {\n                    throw new FunctionsHttpError(response);\n                }\n                let responseType = ((_a = response.headers.get('Content-Type')) !== null && _a !== void 0 ? _a : 'text/plain').split(';')[0].trim();\n                let data;\n                if (responseType === 'application/json') {\n                    data = yield response.json();\n                }\n                else if (responseType === 'application/octet-stream' ||\n                    responseType === 'application/pdf') {\n                    data = yield response.blob();\n                }\n                else if (responseType === 'text/event-stream') {\n                    data = response;\n                }\n                else if (responseType === 'multipart/form-data') {\n                    data = yield response.formData();\n                }\n                else {\n                    // default to text\n                    data = yield response.text();\n                }\n                return { data, error: null, response };\n            }\n            catch (error) {\n                if (error instanceof Error && error.name === 'AbortError') {\n                    return { data: null, error: new FunctionsFetchError(error) };\n                }\n                return {\n                    data: null,\n                    error,\n                    response: error instanceof FunctionsHttpError || error instanceof FunctionsRelayError\n                        ? error.context\n                        : undefined,\n                };\n            }\n        });\n    }\n}\n//# sourceMappingURL=FunctionsClient.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Error format\n *\n * {@link https://postgrest.org/en/stable/api.html?highlight=options#errors-and-http-status-codes}\n */\nclass PostgrestError extends Error {\n    constructor(context) {\n        super(context.message);\n        this.name = 'PostgrestError';\n        this.details = context.details;\n        this.hint = context.hint;\n        this.code = context.code;\n    }\n}\nexports.default = PostgrestError;\n//# sourceMappingURL=PostgrestError.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst tslib_1 = require(\"tslib\");\nconst PostgrestError_1 = tslib_1.__importDefault(require(\"./PostgrestError\"));\nclass PostgrestBuilder {\n    constructor(builder) {\n        var _a, _b;\n        this.shouldThrowOnError = false;\n        this.method = builder.method;\n        this.url = builder.url;\n        this.headers = new Headers(builder.headers);\n        this.schema = builder.schema;\n        this.body = builder.body;\n        this.shouldThrowOnError = (_a = builder.shouldThrowOnError) !== null && _a !== void 0 ? _a : false;\n        this.signal = builder.signal;\n        this.isMaybeSingle = (_b = builder.isMaybeSingle) !== null && _b !== void 0 ? _b : false;\n        if (builder.fetch) {\n            this.fetch = builder.fetch;\n        }\n        else {\n            this.fetch = fetch;\n        }\n    }\n    /**\n     * If there's an error with the query, throwOnError will reject the promise by\n     * throwing the error instead of returning it as part of a successful response.\n     *\n     * {@link https://github.com/supabase/supabase-js/issues/92}\n     */\n    throwOnError() {\n        this.shouldThrowOnError = true;\n        return this;\n    }\n    /**\n     * Set an HTTP header for the request.\n     */\n    setHeader(name, value) {\n        this.headers = new Headers(this.headers);\n        this.headers.set(name, value);\n        return this;\n    }\n    then(onfulfilled, onrejected) {\n        // https://postgrest.org/en/stable/api.html#switching-schemas\n        if (this.schema === undefined) {\n            // skip\n        }\n        else if (['GET', 'HEAD'].includes(this.method)) {\n            this.headers.set('Accept-Profile', this.schema);\n        }\n        else {\n            this.headers.set('Content-Profile', this.schema);\n        }\n        if (this.method !== 'GET' && this.method !== 'HEAD') {\n            this.headers.set('Content-Type', 'application/json');\n        }\n        // NOTE: Invoke w/o `this` to avoid illegal invocation error.\n        // https://github.com/supabase/postgrest-js/pull/247\n        const _fetch = this.fetch;\n        let res = _fetch(this.url.toString(), {\n            method: this.method,\n            headers: this.headers,\n            body: JSON.stringify(this.body),\n            signal: this.signal,\n        }).then(async (res) => {\n            var _a, _b, _c, _d;\n            let error = null;\n            let data = null;\n            let count = null;\n            let status = res.status;\n            let statusText = res.statusText;\n            if (res.ok) {\n                if (this.method !== 'HEAD') {\n                    const body = await res.text();\n                    if (body === '') {\n                        // Prefer: return=minimal\n                    }\n                    else if (this.headers.get('Accept') === 'text/csv') {\n                        data = body;\n                    }\n                    else if (this.headers.get('Accept') &&\n                        ((_a = this.headers.get('Accept')) === null || _a === void 0 ? void 0 : _a.includes('application/vnd.pgrst.plan+text'))) {\n                        data = body;\n                    }\n                    else {\n                        data = JSON.parse(body);\n                    }\n                }\n                const countHeader = (_b = this.headers.get('Prefer')) === null || _b === void 0 ? void 0 : _b.match(/count=(exact|planned|estimated)/);\n                const contentRange = (_c = res.headers.get('content-range')) === null || _c === void 0 ? void 0 : _c.split('/');\n                if (countHeader && contentRange && contentRange.length > 1) {\n                    count = parseInt(contentRange[1]);\n                }\n                // Temporary partial fix for https://github.com/supabase/postgrest-js/issues/361\n                // Issue persists e.g. for `.insert([...]).select().maybeSingle()`\n                if (this.isMaybeSingle && this.method === 'GET' && Array.isArray(data)) {\n                    if (data.length > 1) {\n                        error = {\n                            // https://github.com/PostgREST/postgrest/blob/a867d79c42419af16c18c3fb019eba8df992626f/src/PostgREST/Error.hs#L553\n                            code: 'PGRST116',\n                            details: `Results contain ${data.length} rows, application/vnd.pgrst.object+json requires 1 row`,\n                            hint: null,\n                            message: 'JSON object requested, multiple (or no) rows returned',\n                        };\n                        data = null;\n                        count = null;\n                        status = 406;\n                        statusText = 'Not Acceptable';\n                    }\n                    else if (data.length === 1) {\n                        data = data[0];\n                    }\n                    else {\n                        data = null;\n                    }\n                }\n            }\n            else {\n                const body = await res.text();\n                try {\n                    error = JSON.parse(body);\n                    // Workaround for https://github.com/supabase/postgrest-js/issues/295\n                    if (Array.isArray(error) && res.status === 404) {\n                        data = [];\n                        error = null;\n                        status = 200;\n                        statusText = 'OK';\n                    }\n                }\n                catch (_e) {\n                    // Workaround for https://github.com/supabase/postgrest-js/issues/295\n                    if (res.status === 404 && body === '') {\n                        status = 204;\n                        statusText = 'No Content';\n                    }\n                    else {\n                        error = {\n                            message: body,\n                        };\n                    }\n                }\n                if (error && this.isMaybeSingle && ((_d = error === null || error === void 0 ? void 0 : error.details) === null || _d === void 0 ? void 0 : _d.includes('0 rows'))) {\n                    error = null;\n                    status = 200;\n                    statusText = 'OK';\n                }\n                if (error && this.shouldThrowOnError) {\n                    throw new PostgrestError_1.default(error);\n                }\n            }\n            const postgrestResponse = {\n                error,\n                data,\n                count,\n                status,\n                statusText,\n            };\n            return postgrestResponse;\n        });\n        if (!this.shouldThrowOnError) {\n            res = res.catch((fetchError) => {\n                var _a, _b, _c;\n                return ({\n                    error: {\n                        message: `${(_a = fetchError === null || fetchError === void 0 ? void 0 : fetchError.name) !== null && _a !== void 0 ? _a : 'FetchError'}: ${fetchError === null || fetchError === void 0 ? void 0 : fetchError.message}`,\n                        details: `${(_b = fetchError === null || fetchError === void 0 ? void 0 : fetchError.stack) !== null && _b !== void 0 ? _b : ''}`,\n                        hint: '',\n                        code: `${(_c = fetchError === null || fetchError === void 0 ? void 0 : fetchError.code) !== null && _c !== void 0 ? _c : ''}`,\n                    },\n                    data: null,\n                    count: null,\n                    status: 0,\n                    statusText: '',\n                });\n            });\n        }\n        return res.then(onfulfilled, onrejected);\n    }\n    /**\n     * Override the type of the returned `data`.\n     *\n     * @typeParam NewResult - The new result type to override with\n     * @deprecated Use overrideTypes<yourType, { merge: false }>() method at the end of your call chain instead\n     */\n    returns() {\n        /* istanbul ignore next */\n        return this;\n    }\n    /**\n     * Override the type of the returned `data` field in the response.\n     *\n     * @typeParam NewResult - The new type to cast the response data to\n     * @typeParam Options - Optional type configuration (defaults to { merge: true })\n     * @typeParam Options.merge - When true, merges the new type with existing return type. When false, replaces the existing types entirely (defaults to true)\n     * @example\n     * ```typescript\n     * // Merge with existing types (default behavior)\n     * const query = supabase\n     *   .from('users')\n     *   .select()\n     *   .overrideTypes<{ custom_field: string }>()\n     *\n     * // Replace existing types completely\n     * const replaceQuery = supabase\n     *   .from('users')\n     *   .select()\n     *   .overrideTypes<{ id: number; name: string }, { merge: false }>()\n     * ```\n     * @returns A PostgrestBuilder instance with the new type\n     */\n    overrideTypes() {\n        return this;\n    }\n}\nexports.default = PostgrestBuilder;\n//# sourceMappingURL=PostgrestBuilder.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst tslib_1 = require(\"tslib\");\nconst PostgrestBuilder_1 = tslib_1.__importDefault(require(\"./PostgrestBuilder\"));\nclass PostgrestTransformBuilder extends PostgrestBuilder_1.default {\n    /**\n     * Perform a SELECT on the query result.\n     *\n     * By default, `.insert()`, `.update()`, `.upsert()`, and `.delete()` do not\n     * return modified rows. By calling this method, modified rows are returned in\n     * `data`.\n     *\n     * @param columns - The columns to retrieve, separated by commas\n     */\n    select(columns) {\n        // Remove whitespaces except when quoted\n        let quoted = false;\n        const cleanedColumns = (columns !== null && columns !== void 0 ? columns : '*')\n            .split('')\n            .map((c) => {\n            if (/\\s/.test(c) && !quoted) {\n                return '';\n            }\n            if (c === '\"') {\n                quoted = !quoted;\n            }\n            return c;\n        })\n            .join('');\n        this.url.searchParams.set('select', cleanedColumns);\n        this.headers.append('Prefer', 'return=representation');\n        return this;\n    }\n    /**\n     * Order the query result by `column`.\n     *\n     * You can call this method multiple times to order by multiple columns.\n     *\n     * You can order referenced tables, but it only affects the ordering of the\n     * parent table if you use `!inner` in the query.\n     *\n     * @param column - The column to order by\n     * @param options - Named parameters\n     * @param options.ascending - If `true`, the result will be in ascending order\n     * @param options.nullsFirst - If `true`, `null`s appear first. If `false`,\n     * `null`s appear last.\n     * @param options.referencedTable - Set this to order a referenced table by\n     * its columns\n     * @param options.foreignTable - Deprecated, use `options.referencedTable`\n     * instead\n     */\n    order(column, { ascending = true, nullsFirst, foreignTable, referencedTable = foreignTable, } = {}) {\n        const key = referencedTable ? `${referencedTable}.order` : 'order';\n        const existingOrder = this.url.searchParams.get(key);\n        this.url.searchParams.set(key, `${existingOrder ? `${existingOrder},` : ''}${column}.${ascending ? 'asc' : 'desc'}${nullsFirst === undefined ? '' : nullsFirst ? '.nullsfirst' : '.nullslast'}`);\n        return this;\n    }\n    /**\n     * Limit the query result by `count`.\n     *\n     * @param count - The maximum number of rows to return\n     * @param options - Named parameters\n     * @param options.referencedTable - Set this to limit rows of referenced\n     * tables instead of the parent table\n     * @param options.foreignTable - Deprecated, use `options.referencedTable`\n     * instead\n     */\n    limit(count, { foreignTable, referencedTable = foreignTable, } = {}) {\n        const key = typeof referencedTable === 'undefined' ? 'limit' : `${referencedTable}.limit`;\n        this.url.searchParams.set(key, `${count}`);\n        return this;\n    }\n    /**\n     * Limit the query result by starting at an offset `from` and ending at the offset `to`.\n     * Only records within this range are returned.\n     * This respects the query order and if there is no order clause the range could behave unexpectedly.\n     * The `from` and `to` values are 0-based and inclusive: `range(1, 3)` will include the second, third\n     * and fourth rows of the query.\n     *\n     * @param from - The starting index from which to limit the result\n     * @param to - The last index to which to limit the result\n     * @param options - Named parameters\n     * @param options.referencedTable - Set this to limit rows of referenced\n     * tables instead of the parent table\n     * @param options.foreignTable - Deprecated, use `options.referencedTable`\n     * instead\n     */\n    range(from, to, { foreignTable, referencedTable = foreignTable, } = {}) {\n        const keyOffset = typeof referencedTable === 'undefined' ? 'offset' : `${referencedTable}.offset`;\n        const keyLimit = typeof referencedTable === 'undefined' ? 'limit' : `${referencedTable}.limit`;\n        this.url.searchParams.set(keyOffset, `${from}`);\n        // Range is inclusive, so add 1\n        this.url.searchParams.set(keyLimit, `${to - from + 1}`);\n        return this;\n    }\n    /**\n     * Set the AbortSignal for the fetch request.\n     *\n     * @param signal - The AbortSignal to use for the fetch request\n     */\n    abortSignal(signal) {\n        this.signal = signal;\n        return this;\n    }\n    /**\n     * Return `data` as a single object instead of an array of objects.\n     *\n     * Query result must be one row (e.g. using `.limit(1)`), otherwise this\n     * returns an error.\n     */\n    single() {\n        this.headers.set('Accept', 'application/vnd.pgrst.object+json');\n        return this;\n    }\n    /**\n     * Return `data` as a single object instead of an array of objects.\n     *\n     * Query result must be zero or one row (e.g. using `.limit(1)`), otherwise\n     * this returns an error.\n     */\n    maybeSingle() {\n        // Temporary partial fix for https://github.com/supabase/postgrest-js/issues/361\n        // Issue persists e.g. for `.insert([...]).select().maybeSingle()`\n        if (this.method === 'GET') {\n            this.headers.set('Accept', 'application/json');\n        }\n        else {\n            this.headers.set('Accept', 'application/vnd.pgrst.object+json');\n        }\n        this.isMaybeSingle = true;\n        return this;\n    }\n    /**\n     * Return `data` as a string in CSV format.\n     */\n    csv() {\n        this.headers.set('Accept', 'text/csv');\n        return this;\n    }\n    /**\n     * Return `data` as an object in [GeoJSON](https://geojson.org) format.\n     */\n    geojson() {\n        this.headers.set('Accept', 'application/geo+json');\n        return this;\n    }\n    /**\n     * Return `data` as the EXPLAIN plan for the query.\n     *\n     * You need to enable the\n     * [db_plan_enabled](https://supabase.com/docs/guides/database/debugging-performance#enabling-explain)\n     * setting before using this method.\n     *\n     * @param options - Named parameters\n     *\n     * @param options.analyze - If `true`, the query will be executed and the\n     * actual run time will be returned\n     *\n     * @param options.verbose - If `true`, the query identifier will be returned\n     * and `data` will include the output columns of the query\n     *\n     * @param options.settings - If `true`, include information on configuration\n     * parameters that affect query planning\n     *\n     * @param options.buffers - If `true`, include information on buffer usage\n     *\n     * @param options.wal - If `true`, include information on WAL record generation\n     *\n     * @param options.format - The format of the output, can be `\"text\"` (default)\n     * or `\"json\"`\n     */\n    explain({ analyze = false, verbose = false, settings = false, buffers = false, wal = false, format = 'text', } = {}) {\n        var _a;\n        const options = [\n            analyze ? 'analyze' : null,\n            verbose ? 'verbose' : null,\n            settings ? 'settings' : null,\n            buffers ? 'buffers' : null,\n            wal ? 'wal' : null,\n        ]\n            .filter(Boolean)\n            .join('|');\n        // An Accept header can carry multiple media types but postgrest-js always sends one\n        const forMediatype = (_a = this.headers.get('Accept')) !== null && _a !== void 0 ? _a : 'application/json';\n        this.headers.set('Accept', `application/vnd.pgrst.plan+${format}; for=\"${forMediatype}\"; options=${options};`);\n        if (format === 'json') {\n            return this;\n        }\n        else {\n            return this;\n        }\n    }\n    /**\n     * Rollback the query.\n     *\n     * `data` will still be returned, but the query is not committed.\n     */\n    rollback() {\n        this.headers.append('Prefer', 'tx=rollback');\n        return this;\n    }\n    /**\n     * Override the type of the returned `data`.\n     *\n     * @typeParam NewResult - The new result type to override with\n     * @deprecated Use overrideTypes<yourType, { merge: false }>() method at the end of your call chain instead\n     */\n    returns() {\n        return this;\n    }\n    /**\n     * Set the maximum number of rows that can be affected by the query.\n     * Only available in PostgREST v13+ and only works with PATCH and DELETE methods.\n     *\n     * @param value - The maximum number of rows that can be affected\n     */\n    maxAffected(value) {\n        this.headers.append('Prefer', 'handling=strict');\n        this.headers.append('Prefer', `max-affected=${value}`);\n        return this;\n    }\n}\nexports.default = PostgrestTransformBuilder;\n//# sourceMappingURL=PostgrestTransformBuilder.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst tslib_1 = require(\"tslib\");\nconst PostgrestTransformBuilder_1 = tslib_1.__importDefault(require(\"./PostgrestTransformBuilder\"));\nconst PostgrestReservedCharsRegexp = new RegExp('[,()]');\nclass PostgrestFilterBuilder extends PostgrestTransformBuilder_1.default {\n    /**\n     * Match only rows where `column` is equal to `value`.\n     *\n     * To check if the value of `column` is NULL, you should use `.is()` instead.\n     *\n     * @param column - The column to filter on\n     * @param value - The value to filter with\n     */\n    eq(column, value) {\n        this.url.searchParams.append(column, `eq.${value}`);\n        return this;\n    }\n    /**\n     * Match only rows where `column` is not equal to `value`.\n     *\n     * @param column - The column to filter on\n     * @param value - The value to filter with\n     */\n    neq(column, value) {\n        this.url.searchParams.append(column, `neq.${value}`);\n        return this;\n    }\n    /**\n     * Match only rows where `column` is greater than `value`.\n     *\n     * @param column - The column to filter on\n     * @param value - The value to filter with\n     */\n    gt(column, value) {\n        this.url.searchParams.append(column, `gt.${value}`);\n        return this;\n    }\n    /**\n     * Match only rows where `column` is greater than or equal to `value`.\n     *\n     * @param column - The column to filter on\n     * @param value - The value to filter with\n     */\n    gte(column, value) {\n        this.url.searchParams.append(column, `gte.${value}`);\n        return this;\n    }\n    /**\n     * Match only rows where `column` is less than `value`.\n     *\n     * @param column - The column to filter on\n     * @param value - The value to filter with\n     */\n    lt(column, value) {\n        this.url.searchParams.append(column, `lt.${value}`);\n        return this;\n    }\n    /**\n     * Match only rows where `column` is less than or equal to `value`.\n     *\n     * @param column - The column to filter on\n     * @param value - The value to filter with\n     */\n    lte(column, value) {\n        this.url.searchParams.append(column, `lte.${value}`);\n        return this;\n    }\n    /**\n     * Match only rows where `column` matches `pattern` case-sensitively.\n     *\n     * @param column - The column to filter on\n     * @param pattern - The pattern to match with\n     */\n    like(column, pattern) {\n        this.url.searchParams.append(column, `like.${pattern}`);\n        return this;\n    }\n    /**\n     * Match only rows where `column` matches all of `patterns` case-sensitively.\n     *\n     * @param column - The column to filter on\n     * @param patterns - The patterns to match with\n     */\n    likeAllOf(column, patterns) {\n        this.url.searchParams.append(column, `like(all).{${patterns.join(',')}}`);\n        return this;\n    }\n    /**\n     * Match only rows where `column` matches any of `patterns` case-sensitively.\n     *\n     * @param column - The column to filter on\n     * @param patterns - The patterns to match with\n     */\n    likeAnyOf(column, patterns) {\n        this.url.searchParams.append(column, `like(any).{${patterns.join(',')}}`);\n        return this;\n    }\n    /**\n     * Match only rows where `column` matches `pattern` case-insensitively.\n     *\n     * @param column - The column to filter on\n     * @param pattern - The pattern to match with\n     */\n    ilike(column, pattern) {\n        this.url.searchParams.append(column, `ilike.${pattern}`);\n        return this;\n    }\n    /**\n     * Match only rows where `column` matches all of `patterns` case-insensitively.\n     *\n     * @param column - The column to filter on\n     * @param patterns - The patterns to match with\n     */\n    ilikeAllOf(column, patterns) {\n        this.url.searchParams.append(column, `ilike(all).{${patterns.join(',')}}`);\n        return this;\n    }\n    /**\n     * Match only rows where `column` matches any of `patterns` case-insensitively.\n     *\n     * @param column - The column to filter on\n     * @param patterns - The patterns to match with\n     */\n    ilikeAnyOf(column, patterns) {\n        this.url.searchParams.append(column, `ilike(any).{${patterns.join(',')}}`);\n        return this;\n    }\n    /**\n     * Match only rows where `column` IS `value`.\n     *\n     * For non-boolean columns, this is only relevant for checking if the value of\n     * `column` is NULL by setting `value` to `null`.\n     *\n     * For boolean columns, you can also set `value` to `true` or `false` and it\n     * will behave the same way as `.eq()`.\n     *\n     * @param column - The column to filter on\n     * @param value - The value to filter with\n     */\n    is(column, value) {\n        this.url.searchParams.append(column, `is.${value}`);\n        return this;\n    }\n    /**\n     * Match only rows where `column` is included in the `values` array.\n     *\n     * @param column - The column to filter on\n     * @param values - The values array to filter with\n     */\n    in(column, values) {\n        const cleanedValues = Array.from(new Set(values))\n            .map((s) => {\n            // handle postgrest reserved characters\n            // https://postgrest.org/en/v7.0.0/api.html#reserved-characters\n            if (typeof s === 'string' && PostgrestReservedCharsRegexp.test(s))\n                return `\"${s}\"`;\n            else\n                return `${s}`;\n        })\n            .join(',');\n        this.url.searchParams.append(column, `in.(${cleanedValues})`);\n        return this;\n    }\n    /**\n     * Only relevant for jsonb, array, and range columns. Match only rows where\n     * `column` contains every element appearing in `value`.\n     *\n     * @param column - The jsonb, array, or range column to filter on\n     * @param value - The jsonb, array, or range value to filter with\n     */\n    contains(column, value) {\n        if (typeof value === 'string') {\n            // range types can be inclusive '[', ']' or exclusive '(', ')' so just\n            // keep it simple and accept a string\n            this.url.searchParams.append(column, `cs.${value}`);\n        }\n        else if (Array.isArray(value)) {\n            // array\n            this.url.searchParams.append(column, `cs.{${value.join(',')}}`);\n        }\n        else {\n            // json\n            this.url.searchParams.append(column, `cs.${JSON.stringify(value)}`);\n        }\n        return this;\n    }\n    /**\n     * Only relevant for jsonb, array, and range columns. Match only rows where\n     * every element appearing in `column` is contained by `value`.\n     *\n     * @param column - The jsonb, array, or range column to filter on\n     * @param value - The jsonb, array, or range value to filter with\n     */\n    containedBy(column, value) {\n        if (typeof value === 'string') {\n            // range\n            this.url.searchParams.append(column, `cd.${value}`);\n        }\n        else if (Array.isArray(value)) {\n            // array\n            this.url.searchParams.append(column, `cd.{${value.join(',')}}`);\n        }\n        else {\n            // json\n            this.url.searchParams.append(column, `cd.${JSON.stringify(value)}`);\n        }\n        return this;\n    }\n    /**\n     * Only relevant for range columns. Match only rows where every element in\n     * `column` is greater than any element in `range`.\n     *\n     * @param column - The range column to filter on\n     * @param range - The range to filter with\n     */\n    rangeGt(column, range) {\n        this.url.searchParams.append(column, `sr.${range}`);\n        return this;\n    }\n    /**\n     * Only relevant for range columns. Match only rows where every element in\n     * `column` is either contained in `range` or greater than any element in\n     * `range`.\n     *\n     * @param column - The range column to filter on\n     * @param range - The range to filter with\n     */\n    rangeGte(column, range) {\n        this.url.searchParams.append(column, `nxl.${range}`);\n        return this;\n    }\n    /**\n     * Only relevant for range columns. Match only rows where every element in\n     * `column` is less than any element in `range`.\n     *\n     * @param column - The range column to filter on\n     * @param range - The range to filter with\n     */\n    rangeLt(column, range) {\n        this.url.searchParams.append(column, `sl.${range}`);\n        return this;\n    }\n    /**\n     * Only relevant for range columns. Match only rows where every element in\n     * `column` is either contained in `range` or less than any element in\n     * `range`.\n     *\n     * @param column - The range column to filter on\n     * @param range - The range to filter with\n     */\n    rangeLte(column, range) {\n        this.url.searchParams.append(column, `nxr.${range}`);\n        return this;\n    }\n    /**\n     * Only relevant for range columns. Match only rows where `column` is\n     * mutually exclusive to `range` and there can be no element between the two\n     * ranges.\n     *\n     * @param column - The range column to filter on\n     * @param range - The range to filter with\n     */\n    rangeAdjacent(column, range) {\n        this.url.searchParams.append(column, `adj.${range}`);\n        return this;\n    }\n    /**\n     * Only relevant for array and range columns. Match only rows where\n     * `column` and `value` have an element in common.\n     *\n     * @param column - The array or range column to filter on\n     * @param value - The array or range value to filter with\n     */\n    overlaps(column, value) {\n        if (typeof value === 'string') {\n            // range\n            this.url.searchParams.append(column, `ov.${value}`);\n        }\n        else {\n            // array\n            this.url.searchParams.append(column, `ov.{${value.join(',')}}`);\n        }\n        return this;\n    }\n    /**\n     * Only relevant for text and tsvector columns. Match only rows where\n     * `column` matches the query string in `query`.\n     *\n     * @param column - The text or tsvector column to filter on\n     * @param query - The query text to match with\n     * @param options - Named parameters\n     * @param options.config - The text search configuration to use\n     * @param options.type - Change how the `query` text is interpreted\n     */\n    textSearch(column, query, { config, type } = {}) {\n        let typePart = '';\n        if (type === 'plain') {\n            typePart = 'pl';\n        }\n        else if (type === 'phrase') {\n            typePart = 'ph';\n        }\n        else if (type === 'websearch') {\n            typePart = 'w';\n        }\n        const configPart = config === undefined ? '' : `(${config})`;\n        this.url.searchParams.append(column, `${typePart}fts${configPart}.${query}`);\n        return this;\n    }\n    /**\n     * Match only rows where each column in `query` keys is equal to its\n     * associated value. Shorthand for multiple `.eq()`s.\n     *\n     * @param query - The object to filter with, with column names as keys mapped\n     * to their filter values\n     */\n    match(query) {\n        Object.entries(query).forEach(([column, value]) => {\n            this.url.searchParams.append(column, `eq.${value}`);\n        });\n        return this;\n    }\n    /**\n     * Match only rows which doesn't satisfy the filter.\n     *\n     * Unlike most filters, `opearator` and `value` are used as-is and need to\n     * follow [PostgREST\n     * syntax](https://postgrest.org/en/stable/api.html#operators). You also need\n     * to make sure they are properly sanitized.\n     *\n     * @param column - The column to filter on\n     * @param operator - The operator to be negated to filter with, following\n     * PostgREST syntax\n     * @param value - The value to filter with, following PostgREST syntax\n     */\n    not(column, operator, value) {\n        this.url.searchParams.append(column, `not.${operator}.${value}`);\n        return this;\n    }\n    /**\n     * Match only rows which satisfy at least one of the filters.\n     *\n     * Unlike most filters, `filters` is used as-is and needs to follow [PostgREST\n     * syntax](https://postgrest.org/en/stable/api.html#operators). You also need\n     * to make sure it's properly sanitized.\n     *\n     * It's currently not possible to do an `.or()` filter across multiple tables.\n     *\n     * @param filters - The filters to use, following PostgREST syntax\n     * @param options - Named parameters\n     * @param options.referencedTable - Set this to filter on referenced tables\n     * instead of the parent table\n     * @param options.foreignTable - Deprecated, use `referencedTable` instead\n     */\n    or(filters, { foreignTable, referencedTable = foreignTable, } = {}) {\n        const key = referencedTable ? `${referencedTable}.or` : 'or';\n        this.url.searchParams.append(key, `(${filters})`);\n        return this;\n    }\n    /**\n     * Match only rows which satisfy the filter. This is an escape hatch - you\n     * should use the specific filter methods wherever possible.\n     *\n     * Unlike most filters, `opearator` and `value` are used as-is and need to\n     * follow [PostgREST\n     * syntax](https://postgrest.org/en/stable/api.html#operators). You also need\n     * to make sure they are properly sanitized.\n     *\n     * @param column - The column to filter on\n     * @param operator - The operator to filter with, following PostgREST syntax\n     * @param value - The value to filter with, following PostgREST syntax\n     */\n    filter(column, operator, value) {\n        this.url.searchParams.append(column, `${operator}.${value}`);\n        return this;\n    }\n}\nexports.default = PostgrestFilterBuilder;\n//# sourceMappingURL=PostgrestFilterBuilder.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst tslib_1 = require(\"tslib\");\nconst PostgrestFilterBuilder_1 = tslib_1.__importDefault(require(\"./PostgrestFilterBuilder\"));\nclass PostgrestQueryBuilder {\n    constructor(url, { headers = {}, schema, fetch, }) {\n        this.url = url;\n        this.headers = new Headers(headers);\n        this.schema = schema;\n        this.fetch = fetch;\n    }\n    /**\n     * Perform a SELECT query on the table or view.\n     *\n     * @param columns - The columns to retrieve, separated by commas. Columns can be renamed when returned with `customName:columnName`\n     *\n     * @param options - Named parameters\n     *\n     * @param options.head - When set to `true`, `data` will not be returned.\n     * Useful if you only need the count.\n     *\n     * @param options.count - Count algorithm to use to count rows in the table or view.\n     *\n     * `\"exact\"`: Exact but slow count algorithm. Performs a `COUNT(*)` under the\n     * hood.\n     *\n     * `\"planned\"`: Approximated but fast count algorithm. Uses the Postgres\n     * statistics under the hood.\n     *\n     * `\"estimated\"`: Uses exact count for low numbers and planned count for high\n     * numbers.\n     */\n    select(columns, options) {\n        const { head = false, count } = options !== null && options !== void 0 ? options : {};\n        const method = head ? 'HEAD' : 'GET';\n        // Remove whitespaces except when quoted\n        let quoted = false;\n        const cleanedColumns = (columns !== null && columns !== void 0 ? columns : '*')\n            .split('')\n            .map((c) => {\n            if (/\\s/.test(c) && !quoted) {\n                return '';\n            }\n            if (c === '\"') {\n                quoted = !quoted;\n            }\n            return c;\n        })\n            .join('');\n        this.url.searchParams.set('select', cleanedColumns);\n        if (count) {\n            this.headers.append('Prefer', `count=${count}`);\n        }\n        return new PostgrestFilterBuilder_1.default({\n            method,\n            url: this.url,\n            headers: this.headers,\n            schema: this.schema,\n            fetch: this.fetch,\n        });\n    }\n    /**\n     * Perform an INSERT into the table or view.\n     *\n     * By default, inserted rows are not returned. To return it, chain the call\n     * with `.select()`.\n     *\n     * @param values - The values to insert. Pass an object to insert a single row\n     * or an array to insert multiple rows.\n     *\n     * @param options - Named parameters\n     *\n     * @param options.count - Count algorithm to use to count inserted rows.\n     *\n     * `\"exact\"`: Exact but slow count algorithm. Performs a `COUNT(*)` under the\n     * hood.\n     *\n     * `\"planned\"`: Approximated but fast count algorithm. Uses the Postgres\n     * statistics under the hood.\n     *\n     * `\"estimated\"`: Uses exact count for low numbers and planned count for high\n     * numbers.\n     *\n     * @param options.defaultToNull - Make missing fields default to `null`.\n     * Otherwise, use the default value for the column. Only applies for bulk\n     * inserts.\n     */\n    insert(values, { count, defaultToNull = true, } = {}) {\n        var _a;\n        const method = 'POST';\n        if (count) {\n            this.headers.append('Prefer', `count=${count}`);\n        }\n        if (!defaultToNull) {\n            this.headers.append('Prefer', `missing=default`);\n        }\n        if (Array.isArray(values)) {\n            const columns = values.reduce((acc, x) => acc.concat(Object.keys(x)), []);\n            if (columns.length > 0) {\n                const uniqueColumns = [...new Set(columns)].map((column) => `\"${column}\"`);\n                this.url.searchParams.set('columns', uniqueColumns.join(','));\n            }\n        }\n        return new PostgrestFilterBuilder_1.default({\n            method,\n            url: this.url,\n            headers: this.headers,\n            schema: this.schema,\n            body: values,\n            fetch: (_a = this.fetch) !== null && _a !== void 0 ? _a : fetch,\n        });\n    }\n    /**\n     * Perform an UPSERT on the table or view. Depending on the column(s) passed\n     * to `onConflict`, `.upsert()` allows you to perform the equivalent of\n     * `.insert()` if a row with the corresponding `onConflict` columns doesn't\n     * exist, or if it does exist, perform an alternative action depending on\n     * `ignoreDuplicates`.\n     *\n     * By default, upserted rows are not returned. To return it, chain the call\n     * with `.select()`.\n     *\n     * @param values - The values to upsert with. Pass an object to upsert a\n     * single row or an array to upsert multiple rows.\n     *\n     * @param options - Named parameters\n     *\n     * @param options.onConflict - Comma-separated UNIQUE column(s) to specify how\n     * duplicate rows are determined. Two rows are duplicates if all the\n     * `onConflict` columns are equal.\n     *\n     * @param options.ignoreDuplicates - If `true`, duplicate rows are ignored. If\n     * `false`, duplicate rows are merged with existing rows.\n     *\n     * @param options.count - Count algorithm to use to count upserted rows.\n     *\n     * `\"exact\"`: Exact but slow count algorithm. Performs a `COUNT(*)` under the\n     * hood.\n     *\n     * `\"planned\"`: Approximated but fast count algorithm. Uses the Postgres\n     * statistics under the hood.\n     *\n     * `\"estimated\"`: Uses exact count for low numbers and planned count for high\n     * numbers.\n     *\n     * @param options.defaultToNull - Make missing fields default to `null`.\n     * Otherwise, use the default value for the column. This only applies when\n     * inserting new rows, not when merging with existing rows under\n     * `ignoreDuplicates: false`. This also only applies when doing bulk upserts.\n     */\n    upsert(values, { onConflict, ignoreDuplicates = false, count, defaultToNull = true, } = {}) {\n        var _a;\n        const method = 'POST';\n        this.headers.append('Prefer', `resolution=${ignoreDuplicates ? 'ignore' : 'merge'}-duplicates`);\n        if (onConflict !== undefined)\n            this.url.searchParams.set('on_conflict', onConflict);\n        if (count) {\n            this.headers.append('Prefer', `count=${count}`);\n        }\n        if (!defaultToNull) {\n            this.headers.append('Prefer', 'missing=default');\n        }\n        if (Array.isArray(values)) {\n            const columns = values.reduce((acc, x) => acc.concat(Object.keys(x)), []);\n            if (columns.length > 0) {\n                const uniqueColumns = [...new Set(columns)].map((column) => `\"${column}\"`);\n                this.url.searchParams.set('columns', uniqueColumns.join(','));\n            }\n        }\n        return new PostgrestFilterBuilder_1.default({\n            method,\n            url: this.url,\n            headers: this.headers,\n            schema: this.schema,\n            body: values,\n            fetch: (_a = this.fetch) !== null && _a !== void 0 ? _a : fetch,\n        });\n    }\n    /**\n     * Perform an UPDATE on the table or view.\n     *\n     * By default, updated rows are not returned. To return it, chain the call\n     * with `.select()` after filters.\n     *\n     * @param values - The values to update with\n     *\n     * @param options - Named parameters\n     *\n     * @param options.count - Count algorithm to use to count updated rows.\n     *\n     * `\"exact\"`: Exact but slow count algorithm. Performs a `COUNT(*)` under the\n     * hood.\n     *\n     * `\"planned\"`: Approximated but fast count algorithm. Uses the Postgres\n     * statistics under the hood.\n     *\n     * `\"estimated\"`: Uses exact count for low numbers and planned count for high\n     * numbers.\n     */\n    update(values, { count, } = {}) {\n        var _a;\n        const method = 'PATCH';\n        if (count) {\n            this.headers.append('Prefer', `count=${count}`);\n        }\n        return new PostgrestFilterBuilder_1.default({\n            method,\n            url: this.url,\n            headers: this.headers,\n            schema: this.schema,\n            body: values,\n            fetch: (_a = this.fetch) !== null && _a !== void 0 ? _a : fetch,\n        });\n    }\n    /**\n     * Perform a DELETE on the table or view.\n     *\n     * By default, deleted rows are not returned. To return it, chain the call\n     * with `.select()` after filters.\n     *\n     * @param options - Named parameters\n     *\n     * @param options.count - Count algorithm to use to count deleted rows.\n     *\n     * `\"exact\"`: Exact but slow count algorithm. Performs a `COUNT(*)` under the\n     * hood.\n     *\n     * `\"planned\"`: Approximated but fast count algorithm. Uses the Postgres\n     * statistics under the hood.\n     *\n     * `\"estimated\"`: Uses exact count for low numbers and planned count for high\n     * numbers.\n     */\n    delete({ count, } = {}) {\n        var _a;\n        const method = 'DELETE';\n        if (count) {\n            this.headers.append('Prefer', `count=${count}`);\n        }\n        return new PostgrestFilterBuilder_1.default({\n            method,\n            url: this.url,\n            headers: this.headers,\n            schema: this.schema,\n            fetch: (_a = this.fetch) !== null && _a !== void 0 ? _a : fetch,\n        });\n    }\n}\nexports.default = PostgrestQueryBuilder;\n//# sourceMappingURL=PostgrestQueryBuilder.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst tslib_1 = require(\"tslib\");\nconst PostgrestQueryBuilder_1 = tslib_1.__importDefault(require(\"./PostgrestQueryBuilder\"));\nconst PostgrestFilterBuilder_1 = tslib_1.__importDefault(require(\"./PostgrestFilterBuilder\"));\n/**\n * PostgREST client.\n *\n * @typeParam Database - Types for the schema from the [type\n * generator](https://supabase.com/docs/reference/javascript/next/typescript-support)\n *\n * @typeParam SchemaName - Postgres schema to switch to. Must be a string\n * literal, the same one passed to the constructor. If the schema is not\n * `\"public\"`, this must be supplied manually.\n */\nclass PostgrestClient {\n    // TODO: Add back shouldThrowOnError once we figure out the typings\n    /**\n     * Creates a PostgREST client.\n     *\n     * @param url - URL of the PostgREST endpoint\n     * @param options - Named parameters\n     * @param options.headers - Custom headers\n     * @param options.schema - Postgres schema to switch to\n     * @param options.fetch - Custom fetch\n     */\n    constructor(url, { headers = {}, schema, fetch, } = {}) {\n        this.url = url;\n        this.headers = new Headers(headers);\n        this.schemaName = schema;\n        this.fetch = fetch;\n    }\n    /**\n     * Perform a query on a table or a view.\n     *\n     * @param relation - The table or view name to query\n     */\n    from(relation) {\n        const url = new URL(`${this.url}/${relation}`);\n        return new PostgrestQueryBuilder_1.default(url, {\n            headers: new Headers(this.headers),\n            schema: this.schemaName,\n            fetch: this.fetch,\n        });\n    }\n    /**\n     * Select a schema to query or perform an function (rpc) call.\n     *\n     * The schema needs to be on the list of exposed schemas inside Supabase.\n     *\n     * @param schema - The schema to query\n     */\n    schema(schema) {\n        return new PostgrestClient(this.url, {\n            headers: this.headers,\n            schema,\n            fetch: this.fetch,\n        });\n    }\n    /**\n     * Perform a function call.\n     *\n     * @param fn - The function name to call\n     * @param args - The arguments to pass to the function call\n     * @param options - Named parameters\n     * @param options.head - When set to `true`, `data` will not be returned.\n     * Useful if you only need the count.\n     * @param options.get - When set to `true`, the function will be called with\n     * read-only access mode.\n     * @param options.count - Count algorithm to use to count rows returned by the\n     * function. Only applicable for [set-returning\n     * functions](https://www.postgresql.org/docs/current/functions-srf.html).\n     *\n     * `\"exact\"`: Exact but slow count algorithm. Performs a `COUNT(*)` under the\n     * hood.\n     *\n     * `\"planned\"`: Approximated but fast count algorithm. Uses the Postgres\n     * statistics under the hood.\n     *\n     * `\"estimated\"`: Uses exact count for low numbers and planned count for high\n     * numbers.\n     */\n    rpc(fn, args = {}, { head = false, get = false, count, } = {}) {\n        var _a;\n        let method;\n        const url = new URL(`${this.url}/rpc/${fn}`);\n        let body;\n        if (head || get) {\n            method = head ? 'HEAD' : 'GET';\n            Object.entries(args)\n                // params with undefined value needs to be filtered out, otherwise it'll\n                // show up as `?param=undefined`\n                .filter(([_, value]) => value !== undefined)\n                // array values need special syntax\n                .map(([name, value]) => [name, Array.isArray(value) ? `{${value.join(',')}}` : `${value}`])\n                .forEach(([name, value]) => {\n                url.searchParams.append(name, value);\n            });\n        }\n        else {\n            method = 'POST';\n            body = args;\n        }\n        const headers = new Headers(this.headers);\n        if (count) {\n            headers.set('Prefer', `count=${count}`);\n        }\n        return new PostgrestFilterBuilder_1.default({\n            method,\n            url,\n            headers,\n            schema: this.schemaName,\n            body,\n            fetch: (_a = this.fetch) !== null && _a !== void 0 ? _a : fetch,\n        });\n    }\n}\nexports.default = PostgrestClient;\n//# sourceMappingURL=PostgrestClient.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PostgrestError = exports.PostgrestBuilder = exports.PostgrestTransformBuilder = exports.PostgrestFilterBuilder = exports.PostgrestQueryBuilder = exports.PostgrestClient = void 0;\nconst tslib_1 = require(\"tslib\");\n// Always update wrapper.mjs when updating this file.\nconst PostgrestClient_1 = tslib_1.__importDefault(require(\"./PostgrestClient\"));\nexports.PostgrestClient = PostgrestClient_1.default;\nconst PostgrestQueryBuilder_1 = tslib_1.__importDefault(require(\"./PostgrestQueryBuilder\"));\nexports.PostgrestQueryBuilder = PostgrestQueryBuilder_1.default;\nconst PostgrestFilterBuilder_1 = tslib_1.__importDefault(require(\"./PostgrestFilterBuilder\"));\nexports.PostgrestFilterBuilder = PostgrestFilterBuilder_1.default;\nconst PostgrestTransformBuilder_1 = tslib_1.__importDefault(require(\"./PostgrestTransformBuilder\"));\nexports.PostgrestTransformBuilder = PostgrestTransformBuilder_1.default;\nconst PostgrestBuilder_1 = tslib_1.__importDefault(require(\"./PostgrestBuilder\"));\nexports.PostgrestBuilder = PostgrestBuilder_1.default;\nconst PostgrestError_1 = tslib_1.__importDefault(require(\"./PostgrestError\"));\nexports.PostgrestError = PostgrestError_1.default;\nexports.default = {\n    PostgrestClient: PostgrestClient_1.default,\n    PostgrestQueryBuilder: PostgrestQueryBuilder_1.default,\n    PostgrestFilterBuilder: PostgrestFilterBuilder_1.default,\n    PostgrestTransformBuilder: PostgrestTransformBuilder_1.default,\n    PostgrestBuilder: PostgrestBuilder_1.default,\n    PostgrestError: PostgrestError_1.default,\n};\n//# sourceMappingURL=index.js.map","import * as index from '../cjs/index.js'\nconst {\n  PostgrestClient,\n  PostgrestQueryBuilder,\n  PostgrestFilterBuilder,\n  PostgrestTransformBuilder,\n  PostgrestBuilder,\n  PostgrestError,\n} = index.default || index\n\nexport {\n  PostgrestBuilder,\n  PostgrestClient,\n  PostgrestFilterBuilder,\n  PostgrestQueryBuilder,\n  PostgrestTransformBuilder,\n  PostgrestError,\n}\n\n// compatibility with CJS output\nexport default {\n  PostgrestClient,\n  PostgrestQueryBuilder,\n  PostgrestFilterBuilder,\n  PostgrestTransformBuilder,\n  PostgrestBuilder,\n  PostgrestError,\n}\n","export class WebSocketFactory {\n    static detectEnvironment() {\n        var _a;\n        if (typeof WebSocket !== 'undefined') {\n            return { type: 'native', constructor: WebSocket };\n        }\n        if (typeof globalThis !== 'undefined' && typeof globalThis.WebSocket !== 'undefined') {\n            return { type: 'native', constructor: globalThis.WebSocket };\n        }\n        if (typeof global !== 'undefined' && typeof global.WebSocket !== 'undefined') {\n            return { type: 'native', constructor: global.WebSocket };\n        }\n        if (typeof globalThis !== 'undefined' &&\n            typeof globalThis.WebSocketPair !== 'undefined' &&\n            typeof globalThis.WebSocket === 'undefined') {\n            return {\n                type: 'cloudflare',\n                error: 'Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.',\n                workaround: 'Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime.',\n            };\n        }\n        if ((typeof globalThis !== 'undefined' && globalThis.EdgeRuntime) ||\n            (typeof navigator !== 'undefined' && ((_a = navigator.userAgent) === null || _a === void 0 ? void 0 : _a.includes('Vercel-Edge')))) {\n            return {\n                type: 'unsupported',\n                error: 'Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.',\n                workaround: 'Use serverless functions or a different deployment target for WebSocket functionality.',\n            };\n        }\n        if (typeof process !== 'undefined') {\n            // Use dynamic property access to avoid Next.js Edge Runtime static analysis warnings\n            const processVersions = process['versions'];\n            if (processVersions && processVersions['node']) {\n                // Remove 'v' prefix if present and parse the major version\n                const versionString = processVersions['node'];\n                const nodeVersion = parseInt(versionString.replace(/^v/, '').split('.')[0]);\n                // Node.js 22+ should have native WebSocket\n                if (nodeVersion >= 22) {\n                    // Check if native WebSocket is available (should be in Node.js 22+)\n                    if (typeof globalThis.WebSocket !== 'undefined') {\n                        return { type: 'native', constructor: globalThis.WebSocket };\n                    }\n                    // If not available, user needs to provide it\n                    return {\n                        type: 'unsupported',\n                        error: `Node.js ${nodeVersion} detected but native WebSocket not found.`,\n                        workaround: 'Provide a WebSocket implementation via the transport option.',\n                    };\n                }\n                // Node.js < 22 doesn't have native WebSocket\n                return {\n                    type: 'unsupported',\n                    error: `Node.js ${nodeVersion} detected without native WebSocket support.`,\n                    workaround: 'For Node.js < 22, install \"ws\" package and provide it via the transport option:\\n' +\n                        'import ws from \"ws\"\\n' +\n                        'new RealtimeClient(url, { transport: ws })',\n                };\n            }\n        }\n        return {\n            type: 'unsupported',\n            error: 'Unknown JavaScript runtime without WebSocket support.',\n            workaround: \"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation.\",\n        };\n    }\n    static getWebSocketConstructor() {\n        const env = this.detectEnvironment();\n        if (env.constructor) {\n            return env.constructor;\n        }\n        let errorMessage = env.error || 'WebSocket not supported in this environment.';\n        if (env.workaround) {\n            errorMessage += `\\n\\nSuggested solution: ${env.workaround}`;\n        }\n        throw new Error(errorMessage);\n    }\n    static createWebSocket(url, protocols) {\n        const WS = this.getWebSocketConstructor();\n        return new WS(url, protocols);\n    }\n    static isWebSocketSupported() {\n        try {\n            const env = this.detectEnvironment();\n            return env.type === 'native' || env.type === 'ws';\n        }\n        catch (_a) {\n            return false;\n        }\n    }\n}\nexport default WebSocketFactory;\n//# sourceMappingURL=websocket-factory.js.map","// Generated automatically during releases by scripts/update-version-files.ts\n// This file provides runtime access to the package version for:\n// - HTTP request headers (e.g., X-Client-Info header for API requests)\n// - Debugging and support (identifying which version is running)\n// - Telemetry and logging (version reporting in errors/analytics)\n// - Ensuring build artifacts match the published package version\nexport const version = '2.80.0';\n//# sourceMappingURL=version.js.map","import { version } from './version';\nexport const DEFAULT_VERSION = `realtime-js/${version}`;\nexport const VSN = '1.0.0';\nexport const VERSION = version;\nexport const DEFAULT_TIMEOUT = 10000;\nexport const WS_CLOSE_NORMAL = 1000;\nexport const MAX_PUSH_BUFFER_SIZE = 100;\nexport var SOCKET_STATES;\n(function (SOCKET_STATES) {\n    SOCKET_STATES[SOCKET_STATES[\"connecting\"] = 0] = \"connecting\";\n    SOCKET_STATES[SOCKET_STATES[\"open\"] = 1] = \"open\";\n    SOCKET_STATES[SOCKET_STATES[\"closing\"] = 2] = \"closing\";\n    SOCKET_STATES[SOCKET_STATES[\"closed\"] = 3] = \"closed\";\n})(SOCKET_STATES || (SOCKET_STATES = {}));\nexport var CHANNEL_STATES;\n(function (CHANNEL_STATES) {\n    CHANNEL_STATES[\"closed\"] = \"closed\";\n    CHANNEL_STATES[\"errored\"] = \"errored\";\n    CHANNEL_STATES[\"joined\"] = \"joined\";\n    CHANNEL_STATES[\"joining\"] = \"joining\";\n    CHANNEL_STATES[\"leaving\"] = \"leaving\";\n})(CHANNEL_STATES || (CHANNEL_STATES = {}));\nexport var CHANNEL_EVENTS;\n(function (CHANNEL_EVENTS) {\n    CHANNEL_EVENTS[\"close\"] = \"phx_close\";\n    CHANNEL_EVENTS[\"error\"] = \"phx_error\";\n    CHANNEL_EVENTS[\"join\"] = \"phx_join\";\n    CHANNEL_EVENTS[\"reply\"] = \"phx_reply\";\n    CHANNEL_EVENTS[\"leave\"] = \"phx_leave\";\n    CHANNEL_EVENTS[\"access_token\"] = \"access_token\";\n})(CHANNEL_EVENTS || (CHANNEL_EVENTS = {}));\nexport var TRANSPORTS;\n(function (TRANSPORTS) {\n    TRANSPORTS[\"websocket\"] = \"websocket\";\n})(TRANSPORTS || (TRANSPORTS = {}));\nexport var CONNECTION_STATE;\n(function (CONNECTION_STATE) {\n    CONNECTION_STATE[\"Connecting\"] = \"connecting\";\n    CONNECTION_STATE[\"Open\"] = \"open\";\n    CONNECTION_STATE[\"Closing\"] = \"closing\";\n    CONNECTION_STATE[\"Closed\"] = \"closed\";\n})(CONNECTION_STATE || (CONNECTION_STATE = {}));\n//# sourceMappingURL=constants.js.map","// This file draws heavily from https://github.com/phoenixframework/phoenix/commit/cf098e9cf7a44ee6479d31d911a97d3c7430c6fe\n// License: https://github.com/phoenixframework/phoenix/blob/master/LICENSE.md\nexport default class Serializer {\n    constructor() {\n        this.HEADER_LENGTH = 1;\n    }\n    decode(rawPayload, callback) {\n        if (rawPayload.constructor === ArrayBuffer) {\n            return callback(this._binaryDecode(rawPayload));\n        }\n        if (typeof rawPayload === 'string') {\n            return callback(JSON.parse(rawPayload));\n        }\n        return callback({});\n    }\n    _binaryDecode(buffer) {\n        const view = new DataView(buffer);\n        const decoder = new TextDecoder();\n        return this._decodeBroadcast(buffer, view, decoder);\n    }\n    _decodeBroadcast(buffer, view, decoder) {\n        const topicSize = view.getUint8(1);\n        const eventSize = view.getUint8(2);\n        let offset = this.HEADER_LENGTH + 2;\n        const topic = decoder.decode(buffer.slice(offset, offset + topicSize));\n        offset = offset + topicSize;\n        const event = decoder.decode(buffer.slice(offset, offset + eventSize));\n        offset = offset + eventSize;\n        const data = JSON.parse(decoder.decode(buffer.slice(offset, buffer.byteLength)));\n        return { ref: null, topic: topic, event: event, payload: data };\n    }\n}\n//# sourceMappingURL=serializer.js.map","/**\n * Creates a timer that accepts a `timerCalc` function to perform calculated timeout retries, such as exponential backoff.\n *\n * @example\n *    let reconnectTimer = new Timer(() => this.connect(), function(tries){\n *      return [1000, 5000, 10000][tries - 1] || 10000\n *    })\n *    reconnectTimer.scheduleTimeout() // fires after 1000\n *    reconnectTimer.scheduleTimeout() // fires after 5000\n *    reconnectTimer.reset()\n *    reconnectTimer.scheduleTimeout() // fires after 1000\n */\nexport default class Timer {\n    constructor(callback, timerCalc) {\n        this.callback = callback;\n        this.timerCalc = timerCalc;\n        this.timer = undefined;\n        this.tries = 0;\n        this.callback = callback;\n        this.timerCalc = timerCalc;\n    }\n    reset() {\n        this.tries = 0;\n        clearTimeout(this.timer);\n        this.timer = undefined;\n    }\n    // Cancels any previous scheduleTimeout and schedules callback\n    scheduleTimeout() {\n        clearTimeout(this.timer);\n        this.timer = setTimeout(() => {\n            this.tries = this.tries + 1;\n            this.callback();\n        }, this.timerCalc(this.tries + 1));\n    }\n}\n//# sourceMappingURL=timer.js.map","/**\n * Helpers to convert the change Payload into native JS types.\n */\n// Adapted from epgsql (src/epgsql_binary.erl), this module licensed under\n// 3-clause BSD found here: https://raw.githubusercontent.com/epgsql/epgsql/devel/LICENSE\nexport var PostgresTypes;\n(function (PostgresTypes) {\n    PostgresTypes[\"abstime\"] = \"abstime\";\n    PostgresTypes[\"bool\"] = \"bool\";\n    PostgresTypes[\"date\"] = \"date\";\n    PostgresTypes[\"daterange\"] = \"daterange\";\n    PostgresTypes[\"float4\"] = \"float4\";\n    PostgresTypes[\"float8\"] = \"float8\";\n    PostgresTypes[\"int2\"] = \"int2\";\n    PostgresTypes[\"int4\"] = \"int4\";\n    PostgresTypes[\"int4range\"] = \"int4range\";\n    PostgresTypes[\"int8\"] = \"int8\";\n    PostgresTypes[\"int8range\"] = \"int8range\";\n    PostgresTypes[\"json\"] = \"json\";\n    PostgresTypes[\"jsonb\"] = \"jsonb\";\n    PostgresTypes[\"money\"] = \"money\";\n    PostgresTypes[\"numeric\"] = \"numeric\";\n    PostgresTypes[\"oid\"] = \"oid\";\n    PostgresTypes[\"reltime\"] = \"reltime\";\n    PostgresTypes[\"text\"] = \"text\";\n    PostgresTypes[\"time\"] = \"time\";\n    PostgresTypes[\"timestamp\"] = \"timestamp\";\n    PostgresTypes[\"timestamptz\"] = \"timestamptz\";\n    PostgresTypes[\"timetz\"] = \"timetz\";\n    PostgresTypes[\"tsrange\"] = \"tsrange\";\n    PostgresTypes[\"tstzrange\"] = \"tstzrange\";\n})(PostgresTypes || (PostgresTypes = {}));\n/**\n * Takes an array of columns and an object of string values then converts each string value\n * to its mapped type.\n *\n * @param {{name: String, type: String}[]} columns\n * @param {Object} record\n * @param {Object} options The map of various options that can be applied to the mapper\n * @param {Array} options.skipTypes The array of types that should not be converted\n *\n * @example convertChangeData([{name: 'first_name', type: 'text'}, {name: 'age', type: 'int4'}], {first_name: 'Paul', age:'33'}, {})\n * //=>{ first_name: 'Paul', age: 33 }\n */\nexport const convertChangeData = (columns, record, options = {}) => {\n    var _a;\n    const skipTypes = (_a = options.skipTypes) !== null && _a !== void 0 ? _a : [];\n    if (!record) {\n        return {};\n    }\n    return Object.keys(record).reduce((acc, rec_key) => {\n        acc[rec_key] = convertColumn(rec_key, columns, record, skipTypes);\n        return acc;\n    }, {});\n};\n/**\n * Converts the value of an individual column.\n *\n * @param {String} columnName The column that you want to convert\n * @param {{name: String, type: String}[]} columns All of the columns\n * @param {Object} record The map of string values\n * @param {Array} skipTypes An array of types that should not be converted\n * @return {object} Useless information\n *\n * @example convertColumn('age', [{name: 'first_name', type: 'text'}, {name: 'age', type: 'int4'}], {first_name: 'Paul', age: '33'}, [])\n * //=> 33\n * @example convertColumn('age', [{name: 'first_name', type: 'text'}, {name: 'age', type: 'int4'}], {first_name: 'Paul', age: '33'}, ['int4'])\n * //=> \"33\"\n */\nexport const convertColumn = (columnName, columns, record, skipTypes) => {\n    const column = columns.find((x) => x.name === columnName);\n    const colType = column === null || column === void 0 ? void 0 : column.type;\n    const value = record[columnName];\n    if (colType && !skipTypes.includes(colType)) {\n        return convertCell(colType, value);\n    }\n    return noop(value);\n};\n/**\n * If the value of the cell is `null`, returns null.\n * Otherwise converts the string value to the correct type.\n * @param {String} type A postgres column type\n * @param {String} value The cell value\n *\n * @example convertCell('bool', 't')\n * //=> true\n * @example convertCell('int8', '10')\n * //=> 10\n * @example convertCell('_int4', '{1,2,3,4}')\n * //=> [1,2,3,4]\n */\nexport const convertCell = (type, value) => {\n    // if data type is an array\n    if (type.charAt(0) === '_') {\n        const dataType = type.slice(1, type.length);\n        return toArray(value, dataType);\n    }\n    // If not null, convert to correct type.\n    switch (type) {\n        case PostgresTypes.bool:\n            return toBoolean(value);\n        case PostgresTypes.float4:\n        case PostgresTypes.float8:\n        case PostgresTypes.int2:\n        case PostgresTypes.int4:\n        case PostgresTypes.int8:\n        case PostgresTypes.numeric:\n        case PostgresTypes.oid:\n            return toNumber(value);\n        case PostgresTypes.json:\n        case PostgresTypes.jsonb:\n            return toJson(value);\n        case PostgresTypes.timestamp:\n            return toTimestampString(value); // Format to be consistent with PostgREST\n        case PostgresTypes.abstime: // To allow users to cast it based on Timezone\n        case PostgresTypes.date: // To allow users to cast it based on Timezone\n        case PostgresTypes.daterange:\n        case PostgresTypes.int4range:\n        case PostgresTypes.int8range:\n        case PostgresTypes.money:\n        case PostgresTypes.reltime: // To allow users to cast it based on Timezone\n        case PostgresTypes.text:\n        case PostgresTypes.time: // To allow users to cast it based on Timezone\n        case PostgresTypes.timestamptz: // To allow users to cast it based on Timezone\n        case PostgresTypes.timetz: // To allow users to cast it based on Timezone\n        case PostgresTypes.tsrange:\n        case PostgresTypes.tstzrange:\n            return noop(value);\n        default:\n            // Return the value for remaining types\n            return noop(value);\n    }\n};\nconst noop = (value) => {\n    return value;\n};\nexport const toBoolean = (value) => {\n    switch (value) {\n        case 't':\n            return true;\n        case 'f':\n            return false;\n        default:\n            return value;\n    }\n};\nexport const toNumber = (value) => {\n    if (typeof value === 'string') {\n        const parsedValue = parseFloat(value);\n        if (!Number.isNaN(parsedValue)) {\n            return parsedValue;\n        }\n    }\n    return value;\n};\nexport const toJson = (value) => {\n    if (typeof value === 'string') {\n        try {\n            return JSON.parse(value);\n        }\n        catch (error) {\n            console.log(`JSON parse error: ${error}`);\n            return value;\n        }\n    }\n    return value;\n};\n/**\n * Converts a Postgres Array into a native JS array\n *\n * @example toArray('{}', 'int4')\n * //=> []\n * @example toArray('{\"[2021-01-01,2021-12-31)\",\"(2021-01-01,2021-12-32]\"}', 'daterange')\n * //=> ['[2021-01-01,2021-12-31)', '(2021-01-01,2021-12-32]']\n * @example toArray([1,2,3,4], 'int4')\n * //=> [1,2,3,4]\n */\nexport const toArray = (value, type) => {\n    if (typeof value !== 'string') {\n        return value;\n    }\n    const lastIdx = value.length - 1;\n    const closeBrace = value[lastIdx];\n    const openBrace = value[0];\n    // Confirm value is a Postgres array by checking curly brackets\n    if (openBrace === '{' && closeBrace === '}') {\n        let arr;\n        const valTrim = value.slice(1, lastIdx);\n        // TODO: find a better solution to separate Postgres array data\n        try {\n            arr = JSON.parse('[' + valTrim + ']');\n        }\n        catch (_) {\n            // WARNING: splitting on comma does not cover all edge cases\n            arr = valTrim ? valTrim.split(',') : [];\n        }\n        return arr.map((val) => convertCell(type, val));\n    }\n    return value;\n};\n/**\n * Fixes timestamp to be ISO-8601. Swaps the space between the date and time for a 'T'\n * See https://github.com/supabase/supabase/issues/18\n *\n * @example toTimestampString('2019-09-10 00:00:00')\n * //=> '2019-09-10T00:00:00'\n */\nexport const toTimestampString = (value) => {\n    if (typeof value === 'string') {\n        return value.replace(' ', 'T');\n    }\n    return value;\n};\nexport const httpEndpointURL = (socketUrl) => {\n    const wsUrl = new URL(socketUrl);\n    wsUrl.protocol = wsUrl.protocol.replace(/^ws/i, 'http');\n    wsUrl.pathname = wsUrl.pathname\n        .replace(/\\/+$/, '') // remove all trailing slashes\n        .replace(/\\/socket\\/websocket$/i, '') // remove the socket/websocket path\n        .replace(/\\/socket$/i, '') // remove the socket path\n        .replace(/\\/websocket$/i, ''); // remove the websocket path\n    if (wsUrl.pathname === '' || wsUrl.pathname === '/') {\n        wsUrl.pathname = '/api/broadcast';\n    }\n    else {\n        wsUrl.pathname = wsUrl.pathname + '/api/broadcast';\n    }\n    return wsUrl.href;\n};\n//# sourceMappingURL=transformers.js.map","import { DEFAULT_TIMEOUT } from '../lib/constants';\nexport default class Push {\n    /**\n     * Initializes the Push\n     *\n     * @param channel The Channel\n     * @param event The event, for example `\"phx_join\"`\n     * @param payload The payload, for example `{user_id: 123}`\n     * @param timeout The push timeout in milliseconds\n     */\n    constructor(channel, event, payload = {}, timeout = DEFAULT_TIMEOUT) {\n        this.channel = channel;\n        this.event = event;\n        this.payload = payload;\n        this.timeout = timeout;\n        this.sent = false;\n        this.timeoutTimer = undefined;\n        this.ref = '';\n        this.receivedResp = null;\n        this.recHooks = [];\n        this.refEvent = null;\n    }\n    resend(timeout) {\n        this.timeout = timeout;\n        this._cancelRefEvent();\n        this.ref = '';\n        this.refEvent = null;\n        this.receivedResp = null;\n        this.sent = false;\n        this.send();\n    }\n    send() {\n        if (this._hasReceived('timeout')) {\n            return;\n        }\n        this.startTimeout();\n        this.sent = true;\n        this.channel.socket.push({\n            topic: this.channel.topic,\n            event: this.event,\n            payload: this.payload,\n            ref: this.ref,\n            join_ref: this.channel._joinRef(),\n        });\n    }\n    updatePayload(payload) {\n        this.payload = Object.assign(Object.assign({}, this.payload), payload);\n    }\n    receive(status, callback) {\n        var _a;\n        if (this._hasReceived(status)) {\n            callback((_a = this.receivedResp) === null || _a === void 0 ? void 0 : _a.response);\n        }\n        this.recHooks.push({ status, callback });\n        return this;\n    }\n    startTimeout() {\n        if (this.timeoutTimer) {\n            return;\n        }\n        this.ref = this.channel.socket._makeRef();\n        this.refEvent = this.channel._replyEventName(this.ref);\n        const callback = (payload) => {\n            this._cancelRefEvent();\n            this._cancelTimeout();\n            this.receivedResp = payload;\n            this._matchReceive(payload);\n        };\n        this.channel._on(this.refEvent, {}, callback);\n        this.timeoutTimer = setTimeout(() => {\n            this.trigger('timeout', {});\n        }, this.timeout);\n    }\n    trigger(status, response) {\n        if (this.refEvent)\n            this.channel._trigger(this.refEvent, { status, response });\n    }\n    destroy() {\n        this._cancelRefEvent();\n        this._cancelTimeout();\n    }\n    _cancelRefEvent() {\n        if (!this.refEvent) {\n            return;\n        }\n        this.channel._off(this.refEvent, {});\n    }\n    _cancelTimeout() {\n        clearTimeout(this.timeoutTimer);\n        this.timeoutTimer = undefined;\n    }\n    _matchReceive({ status, response }) {\n        this.recHooks.filter((h) => h.status === status).forEach((h) => h.callback(response));\n    }\n    _hasReceived(status) {\n        return this.receivedResp && this.receivedResp.status === status;\n    }\n}\n//# sourceMappingURL=push.js.map","/*\n  This file draws heavily from https://github.com/phoenixframework/phoenix/blob/d344ec0a732ab4ee204215b31de69cf4be72e3bf/assets/js/phoenix/presence.js\n  License: https://github.com/phoenixframework/phoenix/blob/d344ec0a732ab4ee204215b31de69cf4be72e3bf/LICENSE.md\n*/\nexport var REALTIME_PRESENCE_LISTEN_EVENTS;\n(function (REALTIME_PRESENCE_LISTEN_EVENTS) {\n    REALTIME_PRESENCE_LISTEN_EVENTS[\"SYNC\"] = \"sync\";\n    REALTIME_PRESENCE_LISTEN_EVENTS[\"JOIN\"] = \"join\";\n    REALTIME_PRESENCE_LISTEN_EVENTS[\"LEAVE\"] = \"leave\";\n})(REALTIME_PRESENCE_LISTEN_EVENTS || (REALTIME_PRESENCE_LISTEN_EVENTS = {}));\nexport default class RealtimePresence {\n    /**\n     * Initializes the Presence.\n     *\n     * @param channel - The RealtimeChannel\n     * @param opts - The options,\n     *        for example `{events: {state: 'state', diff: 'diff'}}`\n     */\n    constructor(channel, opts) {\n        this.channel = channel;\n        this.state = {};\n        this.pendingDiffs = [];\n        this.joinRef = null;\n        this.enabled = false;\n        this.caller = {\n            onJoin: () => { },\n            onLeave: () => { },\n            onSync: () => { },\n        };\n        const events = (opts === null || opts === void 0 ? void 0 : opts.events) || {\n            state: 'presence_state',\n            diff: 'presence_diff',\n        };\n        this.channel._on(events.state, {}, (newState) => {\n            const { onJoin, onLeave, onSync } = this.caller;\n            this.joinRef = this.channel._joinRef();\n            this.state = RealtimePresence.syncState(this.state, newState, onJoin, onLeave);\n            this.pendingDiffs.forEach((diff) => {\n                this.state = RealtimePresence.syncDiff(this.state, diff, onJoin, onLeave);\n            });\n            this.pendingDiffs = [];\n            onSync();\n        });\n        this.channel._on(events.diff, {}, (diff) => {\n            const { onJoin, onLeave, onSync } = this.caller;\n            if (this.inPendingSyncState()) {\n                this.pendingDiffs.push(diff);\n            }\n            else {\n                this.state = RealtimePresence.syncDiff(this.state, diff, onJoin, onLeave);\n                onSync();\n            }\n        });\n        this.onJoin((key, currentPresences, newPresences) => {\n            this.channel._trigger('presence', {\n                event: 'join',\n                key,\n                currentPresences,\n                newPresences,\n            });\n        });\n        this.onLeave((key, currentPresences, leftPresences) => {\n            this.channel._trigger('presence', {\n                event: 'leave',\n                key,\n                currentPresences,\n                leftPresences,\n            });\n        });\n        this.onSync(() => {\n            this.channel._trigger('presence', { event: 'sync' });\n        });\n    }\n    /**\n     * Used to sync the list of presences on the server with the\n     * client's state.\n     *\n     * An optional `onJoin` and `onLeave` callback can be provided to\n     * react to changes in the client's local presences across\n     * disconnects and reconnects with the server.\n     *\n     * @internal\n     */\n    static syncState(currentState, newState, onJoin, onLeave) {\n        const state = this.cloneDeep(currentState);\n        const transformedState = this.transformState(newState);\n        const joins = {};\n        const leaves = {};\n        this.map(state, (key, presences) => {\n            if (!transformedState[key]) {\n                leaves[key] = presences;\n            }\n        });\n        this.map(transformedState, (key, newPresences) => {\n            const currentPresences = state[key];\n            if (currentPresences) {\n                const newPresenceRefs = newPresences.map((m) => m.presence_ref);\n                const curPresenceRefs = currentPresences.map((m) => m.presence_ref);\n                const joinedPresences = newPresences.filter((m) => curPresenceRefs.indexOf(m.presence_ref) < 0);\n                const leftPresences = currentPresences.filter((m) => newPresenceRefs.indexOf(m.presence_ref) < 0);\n                if (joinedPresences.length > 0) {\n                    joins[key] = joinedPresences;\n                }\n                if (leftPresences.length > 0) {\n                    leaves[key] = leftPresences;\n                }\n            }\n            else {\n                joins[key] = newPresences;\n            }\n        });\n        return this.syncDiff(state, { joins, leaves }, onJoin, onLeave);\n    }\n    /**\n     * Used to sync a diff of presence join and leave events from the\n     * server, as they happen.\n     *\n     * Like `syncState`, `syncDiff` accepts optional `onJoin` and\n     * `onLeave` callbacks to react to a user joining or leaving from a\n     * device.\n     *\n     * @internal\n     */\n    static syncDiff(state, diff, onJoin, onLeave) {\n        const { joins, leaves } = {\n            joins: this.transformState(diff.joins),\n            leaves: this.transformState(diff.leaves),\n        };\n        if (!onJoin) {\n            onJoin = () => { };\n        }\n        if (!onLeave) {\n            onLeave = () => { };\n        }\n        this.map(joins, (key, newPresences) => {\n            var _a;\n            const currentPresences = (_a = state[key]) !== null && _a !== void 0 ? _a : [];\n            state[key] = this.cloneDeep(newPresences);\n            if (currentPresences.length > 0) {\n                const joinedPresenceRefs = state[key].map((m) => m.presence_ref);\n                const curPresences = currentPresences.filter((m) => joinedPresenceRefs.indexOf(m.presence_ref) < 0);\n                state[key].unshift(...curPresences);\n            }\n            onJoin(key, currentPresences, newPresences);\n        });\n        this.map(leaves, (key, leftPresences) => {\n            let currentPresences = state[key];\n            if (!currentPresences)\n                return;\n            const presenceRefsToRemove = leftPresences.map((m) => m.presence_ref);\n            currentPresences = currentPresences.filter((m) => presenceRefsToRemove.indexOf(m.presence_ref) < 0);\n            state[key] = currentPresences;\n            onLeave(key, currentPresences, leftPresences);\n            if (currentPresences.length === 0)\n                delete state[key];\n        });\n        return state;\n    }\n    /** @internal */\n    static map(obj, func) {\n        return Object.getOwnPropertyNames(obj).map((key) => func(key, obj[key]));\n    }\n    /**\n     * Remove 'metas' key\n     * Change 'phx_ref' to 'presence_ref'\n     * Remove 'phx_ref' and 'phx_ref_prev'\n     *\n     * @example\n     * // returns {\n     *  abc123: [\n     *    { presence_ref: '2', user_id: 1 },\n     *    { presence_ref: '3', user_id: 2 }\n     *  ]\n     * }\n     * RealtimePresence.transformState({\n     *  abc123: {\n     *    metas: [\n     *      { phx_ref: '2', phx_ref_prev: '1' user_id: 1 },\n     *      { phx_ref: '3', user_id: 2 }\n     *    ]\n     *  }\n     * })\n     *\n     * @internal\n     */\n    static transformState(state) {\n        state = this.cloneDeep(state);\n        return Object.getOwnPropertyNames(state).reduce((newState, key) => {\n            const presences = state[key];\n            if ('metas' in presences) {\n                newState[key] = presences.metas.map((presence) => {\n                    presence['presence_ref'] = presence['phx_ref'];\n                    delete presence['phx_ref'];\n                    delete presence['phx_ref_prev'];\n                    return presence;\n                });\n            }\n            else {\n                newState[key] = presences;\n            }\n            return newState;\n        }, {});\n    }\n    /** @internal */\n    static cloneDeep(obj) {\n        return JSON.parse(JSON.stringify(obj));\n    }\n    /** @internal */\n    onJoin(callback) {\n        this.caller.onJoin = callback;\n    }\n    /** @internal */\n    onLeave(callback) {\n        this.caller.onLeave = callback;\n    }\n    /** @internal */\n    onSync(callback) {\n        this.caller.onSync = callback;\n    }\n    /** @internal */\n    inPendingSyncState() {\n        return !this.joinRef || this.joinRef !== this.channel._joinRef();\n    }\n}\n//# sourceMappingURL=RealtimePresence.js.map","import { CHANNEL_EVENTS, CHANNEL_STATES, MAX_PUSH_BUFFER_SIZE } from './lib/constants';\nimport Push from './lib/push';\nimport Timer from './lib/timer';\nimport RealtimePresence from './RealtimePresence';\nimport * as Transformers from './lib/transformers';\nimport { httpEndpointURL } from './lib/transformers';\nexport var REALTIME_POSTGRES_CHANGES_LISTEN_EVENT;\n(function (REALTIME_POSTGRES_CHANGES_LISTEN_EVENT) {\n    REALTIME_POSTGRES_CHANGES_LISTEN_EVENT[\"ALL\"] = \"*\";\n    REALTIME_POSTGRES_CHANGES_LISTEN_EVENT[\"INSERT\"] = \"INSERT\";\n    REALTIME_POSTGRES_CHANGES_LISTEN_EVENT[\"UPDATE\"] = \"UPDATE\";\n    REALTIME_POSTGRES_CHANGES_LISTEN_EVENT[\"DELETE\"] = \"DELETE\";\n})(REALTIME_POSTGRES_CHANGES_LISTEN_EVENT || (REALTIME_POSTGRES_CHANGES_LISTEN_EVENT = {}));\nexport var REALTIME_LISTEN_TYPES;\n(function (REALTIME_LISTEN_TYPES) {\n    REALTIME_LISTEN_TYPES[\"BROADCAST\"] = \"broadcast\";\n    REALTIME_LISTEN_TYPES[\"PRESENCE\"] = \"presence\";\n    REALTIME_LISTEN_TYPES[\"POSTGRES_CHANGES\"] = \"postgres_changes\";\n    REALTIME_LISTEN_TYPES[\"SYSTEM\"] = \"system\";\n})(REALTIME_LISTEN_TYPES || (REALTIME_LISTEN_TYPES = {}));\nexport var REALTIME_SUBSCRIBE_STATES;\n(function (REALTIME_SUBSCRIBE_STATES) {\n    REALTIME_SUBSCRIBE_STATES[\"SUBSCRIBED\"] = \"SUBSCRIBED\";\n    REALTIME_SUBSCRIBE_STATES[\"TIMED_OUT\"] = \"TIMED_OUT\";\n    REALTIME_SUBSCRIBE_STATES[\"CLOSED\"] = \"CLOSED\";\n    REALTIME_SUBSCRIBE_STATES[\"CHANNEL_ERROR\"] = \"CHANNEL_ERROR\";\n})(REALTIME_SUBSCRIBE_STATES || (REALTIME_SUBSCRIBE_STATES = {}));\nexport const REALTIME_CHANNEL_STATES = CHANNEL_STATES;\n/** A channel is the basic building block of Realtime\n * and narrows the scope of data flow to subscribed clients.\n * You can think of a channel as a chatroom where participants are able to see who's online\n * and send and receive messages.\n */\nexport default class RealtimeChannel {\n    constructor(\n    /** Topic name can be any string. */\n    topic, params = { config: {} }, socket) {\n        var _a, _b;\n        this.topic = topic;\n        this.params = params;\n        this.socket = socket;\n        this.bindings = {};\n        this.state = CHANNEL_STATES.closed;\n        this.joinedOnce = false;\n        this.pushBuffer = [];\n        this.subTopic = topic.replace(/^realtime:/i, '');\n        this.params.config = Object.assign({\n            broadcast: { ack: false, self: false },\n            presence: { key: '', enabled: false },\n            private: false,\n        }, params.config);\n        this.timeout = this.socket.timeout;\n        this.joinPush = new Push(this, CHANNEL_EVENTS.join, this.params, this.timeout);\n        this.rejoinTimer = new Timer(() => this._rejoinUntilConnected(), this.socket.reconnectAfterMs);\n        this.joinPush.receive('ok', () => {\n            this.state = CHANNEL_STATES.joined;\n            this.rejoinTimer.reset();\n            this.pushBuffer.forEach((pushEvent) => pushEvent.send());\n            this.pushBuffer = [];\n        });\n        this._onClose(() => {\n            this.rejoinTimer.reset();\n            this.socket.log('channel', `close ${this.topic} ${this._joinRef()}`);\n            this.state = CHANNEL_STATES.closed;\n            this.socket._remove(this);\n        });\n        this._onError((reason) => {\n            if (this._isLeaving() || this._isClosed()) {\n                return;\n            }\n            this.socket.log('channel', `error ${this.topic}`, reason);\n            this.state = CHANNEL_STATES.errored;\n            this.rejoinTimer.scheduleTimeout();\n        });\n        this.joinPush.receive('timeout', () => {\n            if (!this._isJoining()) {\n                return;\n            }\n            this.socket.log('channel', `timeout ${this.topic}`, this.joinPush.timeout);\n            this.state = CHANNEL_STATES.errored;\n            this.rejoinTimer.scheduleTimeout();\n        });\n        this.joinPush.receive('error', (reason) => {\n            if (this._isLeaving() || this._isClosed()) {\n                return;\n            }\n            this.socket.log('channel', `error ${this.topic}`, reason);\n            this.state = CHANNEL_STATES.errored;\n            this.rejoinTimer.scheduleTimeout();\n        });\n        this._on(CHANNEL_EVENTS.reply, {}, (payload, ref) => {\n            this._trigger(this._replyEventName(ref), payload);\n        });\n        this.presence = new RealtimePresence(this);\n        this.broadcastEndpointURL = httpEndpointURL(this.socket.endPoint);\n        this.private = this.params.config.private || false;\n        if (!this.private && ((_b = (_a = this.params.config) === null || _a === void 0 ? void 0 : _a.broadcast) === null || _b === void 0 ? void 0 : _b.replay)) {\n            throw `tried to use replay on public channel '${this.topic}'. It must be a private channel.`;\n        }\n    }\n    /** Subscribe registers your client with the server */\n    subscribe(callback, timeout = this.timeout) {\n        var _a, _b, _c;\n        if (!this.socket.isConnected()) {\n            this.socket.connect();\n        }\n        if (this.state == CHANNEL_STATES.closed) {\n            const { config: { broadcast, presence, private: isPrivate }, } = this.params;\n            const postgres_changes = (_b = (_a = this.bindings.postgres_changes) === null || _a === void 0 ? void 0 : _a.map((r) => r.filter)) !== null && _b !== void 0 ? _b : [];\n            const presence_enabled = (!!this.bindings[REALTIME_LISTEN_TYPES.PRESENCE] &&\n                this.bindings[REALTIME_LISTEN_TYPES.PRESENCE].length > 0) ||\n                ((_c = this.params.config.presence) === null || _c === void 0 ? void 0 : _c.enabled) === true;\n            const accessTokenPayload = {};\n            const config = {\n                broadcast,\n                presence: Object.assign(Object.assign({}, presence), { enabled: presence_enabled }),\n                postgres_changes,\n                private: isPrivate,\n            };\n            if (this.socket.accessTokenValue) {\n                accessTokenPayload.access_token = this.socket.accessTokenValue;\n            }\n            this._onError((e) => callback === null || callback === void 0 ? void 0 : callback(REALTIME_SUBSCRIBE_STATES.CHANNEL_ERROR, e));\n            this._onClose(() => callback === null || callback === void 0 ? void 0 : callback(REALTIME_SUBSCRIBE_STATES.CLOSED));\n            this.updateJoinPayload(Object.assign({ config }, accessTokenPayload));\n            this.joinedOnce = true;\n            this._rejoin(timeout);\n            this.joinPush\n                .receive('ok', async ({ postgres_changes }) => {\n                var _a;\n                this.socket.setAuth();\n                if (postgres_changes === undefined) {\n                    callback === null || callback === void 0 ? void 0 : callback(REALTIME_SUBSCRIBE_STATES.SUBSCRIBED);\n                    return;\n                }\n                else {\n                    const clientPostgresBindings = this.bindings.postgres_changes;\n                    const bindingsLen = (_a = clientPostgresBindings === null || clientPostgresBindings === void 0 ? void 0 : clientPostgresBindings.length) !== null && _a !== void 0 ? _a : 0;\n                    const newPostgresBindings = [];\n                    for (let i = 0; i < bindingsLen; i++) {\n                        const clientPostgresBinding = clientPostgresBindings[i];\n                        const { filter: { event, schema, table, filter }, } = clientPostgresBinding;\n                        const serverPostgresFilter = postgres_changes && postgres_changes[i];\n                        if (serverPostgresFilter &&\n                            serverPostgresFilter.event === event &&\n                            serverPostgresFilter.schema === schema &&\n                            serverPostgresFilter.table === table &&\n                            serverPostgresFilter.filter === filter) {\n                            newPostgresBindings.push(Object.assign(Object.assign({}, clientPostgresBinding), { id: serverPostgresFilter.id }));\n                        }\n                        else {\n                            this.unsubscribe();\n                            this.state = CHANNEL_STATES.errored;\n                            callback === null || callback === void 0 ? void 0 : callback(REALTIME_SUBSCRIBE_STATES.CHANNEL_ERROR, new Error('mismatch between server and client bindings for postgres changes'));\n                            return;\n                        }\n                    }\n                    this.bindings.postgres_changes = newPostgresBindings;\n                    callback && callback(REALTIME_SUBSCRIBE_STATES.SUBSCRIBED);\n                    return;\n                }\n            })\n                .receive('error', (error) => {\n                this.state = CHANNEL_STATES.errored;\n                callback === null || callback === void 0 ? void 0 : callback(REALTIME_SUBSCRIBE_STATES.CHANNEL_ERROR, new Error(JSON.stringify(Object.values(error).join(', ') || 'error')));\n                return;\n            })\n                .receive('timeout', () => {\n                callback === null || callback === void 0 ? void 0 : callback(REALTIME_SUBSCRIBE_STATES.TIMED_OUT);\n                return;\n            });\n        }\n        return this;\n    }\n    presenceState() {\n        return this.presence.state;\n    }\n    async track(payload, opts = {}) {\n        return await this.send({\n            type: 'presence',\n            event: 'track',\n            payload,\n        }, opts.timeout || this.timeout);\n    }\n    async untrack(opts = {}) {\n        return await this.send({\n            type: 'presence',\n            event: 'untrack',\n        }, opts);\n    }\n    on(type, filter, callback) {\n        if (this.state === CHANNEL_STATES.joined && type === REALTIME_LISTEN_TYPES.PRESENCE) {\n            this.socket.log('channel', `resubscribe to ${this.topic} due to change in presence callbacks on joined channel`);\n            this.unsubscribe().then(() => this.subscribe());\n        }\n        return this._on(type, filter, callback);\n    }\n    /**\n     * Sends a broadcast message explicitly via REST API.\n     *\n     * This method always uses the REST API endpoint regardless of WebSocket connection state.\n     * Useful when you want to guarantee REST delivery or when gradually migrating from implicit REST fallback.\n     *\n     * @param event The name of the broadcast event\n     * @param payload Payload to be sent (required)\n     * @param opts Options including timeout\n     * @returns Promise resolving to object with success status, and error details if failed\n     */\n    async httpSend(event, payload, opts = {}) {\n        var _a;\n        const authorization = this.socket.accessTokenValue\n            ? `Bearer ${this.socket.accessTokenValue}`\n            : '';\n        if (payload === undefined || payload === null) {\n            return Promise.reject('Payload is required for httpSend()');\n        }\n        const options = {\n            method: 'POST',\n            headers: {\n                Authorization: authorization,\n                apikey: this.socket.apiKey ? this.socket.apiKey : '',\n                'Content-Type': 'application/json',\n            },\n            body: JSON.stringify({\n                messages: [\n                    {\n                        topic: this.subTopic,\n                        event,\n                        payload: payload,\n                        private: this.private,\n                    },\n                ],\n            }),\n        };\n        const response = await this._fetchWithTimeout(this.broadcastEndpointURL, options, (_a = opts.timeout) !== null && _a !== void 0 ? _a : this.timeout);\n        if (response.status === 202) {\n            return { success: true };\n        }\n        let errorMessage = response.statusText;\n        try {\n            const errorBody = await response.json();\n            errorMessage = errorBody.error || errorBody.message || errorMessage;\n        }\n        catch (_b) { }\n        return Promise.reject(new Error(errorMessage));\n    }\n    /**\n     * Sends a message into the channel.\n     *\n     * @param args Arguments to send to channel\n     * @param args.type The type of event to send\n     * @param args.event The name of the event being sent\n     * @param args.payload Payload to be sent\n     * @param opts Options to be used during the send process\n     */\n    async send(args, opts = {}) {\n        var _a, _b;\n        if (!this._canPush() && args.type === 'broadcast') {\n            console.warn('Realtime send() is automatically falling back to REST API. ' +\n                'This behavior will be deprecated in the future. ' +\n                'Please use httpSend() explicitly for REST delivery.');\n            const { event, payload: endpoint_payload } = args;\n            const authorization = this.socket.accessTokenValue\n                ? `Bearer ${this.socket.accessTokenValue}`\n                : '';\n            const options = {\n                method: 'POST',\n                headers: {\n                    Authorization: authorization,\n                    apikey: this.socket.apiKey ? this.socket.apiKey : '',\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({\n                    messages: [\n                        {\n                            topic: this.subTopic,\n                            event,\n                            payload: endpoint_payload,\n                            private: this.private,\n                        },\n                    ],\n                }),\n            };\n            try {\n                const response = await this._fetchWithTimeout(this.broadcastEndpointURL, options, (_a = opts.timeout) !== null && _a !== void 0 ? _a : this.timeout);\n                await ((_b = response.body) === null || _b === void 0 ? void 0 : _b.cancel());\n                return response.ok ? 'ok' : 'error';\n            }\n            catch (error) {\n                if (error.name === 'AbortError') {\n                    return 'timed out';\n                }\n                else {\n                    return 'error';\n                }\n            }\n        }\n        else {\n            return new Promise((resolve) => {\n                var _a, _b, _c;\n                const push = this._push(args.type, args, opts.timeout || this.timeout);\n                if (args.type === 'broadcast' && !((_c = (_b = (_a = this.params) === null || _a === void 0 ? void 0 : _a.config) === null || _b === void 0 ? void 0 : _b.broadcast) === null || _c === void 0 ? void 0 : _c.ack)) {\n                    resolve('ok');\n                }\n                push.receive('ok', () => resolve('ok'));\n                push.receive('error', () => resolve('error'));\n                push.receive('timeout', () => resolve('timed out'));\n            });\n        }\n    }\n    updateJoinPayload(payload) {\n        this.joinPush.updatePayload(payload);\n    }\n    /**\n     * Leaves the channel.\n     *\n     * Unsubscribes from server events, and instructs channel to terminate on server.\n     * Triggers onClose() hooks.\n     *\n     * To receive leave acknowledgements, use the a `receive` hook to bind to the server ack, ie:\n     * channel.unsubscribe().receive(\"ok\", () => alert(\"left!\") )\n     */\n    unsubscribe(timeout = this.timeout) {\n        this.state = CHANNEL_STATES.leaving;\n        const onClose = () => {\n            this.socket.log('channel', `leave ${this.topic}`);\n            this._trigger(CHANNEL_EVENTS.close, 'leave', this._joinRef());\n        };\n        this.joinPush.destroy();\n        let leavePush = null;\n        return new Promise((resolve) => {\n            leavePush = new Push(this, CHANNEL_EVENTS.leave, {}, timeout);\n            leavePush\n                .receive('ok', () => {\n                onClose();\n                resolve('ok');\n            })\n                .receive('timeout', () => {\n                onClose();\n                resolve('timed out');\n            })\n                .receive('error', () => {\n                resolve('error');\n            });\n            leavePush.send();\n            if (!this._canPush()) {\n                leavePush.trigger('ok', {});\n            }\n        }).finally(() => {\n            leavePush === null || leavePush === void 0 ? void 0 : leavePush.destroy();\n        });\n    }\n    /**\n     * Teardown the channel.\n     *\n     * Destroys and stops related timers.\n     */\n    teardown() {\n        this.pushBuffer.forEach((push) => push.destroy());\n        this.pushBuffer = [];\n        this.rejoinTimer.reset();\n        this.joinPush.destroy();\n        this.state = CHANNEL_STATES.closed;\n        this.bindings = {};\n    }\n    /** @internal */\n    async _fetchWithTimeout(url, options, timeout) {\n        const controller = new AbortController();\n        const id = setTimeout(() => controller.abort(), timeout);\n        const response = await this.socket.fetch(url, Object.assign(Object.assign({}, options), { signal: controller.signal }));\n        clearTimeout(id);\n        return response;\n    }\n    /** @internal */\n    _push(event, payload, timeout = this.timeout) {\n        if (!this.joinedOnce) {\n            throw `tried to push '${event}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;\n        }\n        let pushEvent = new Push(this, event, payload, timeout);\n        if (this._canPush()) {\n            pushEvent.send();\n        }\n        else {\n            this._addToPushBuffer(pushEvent);\n        }\n        return pushEvent;\n    }\n    /** @internal */\n    _addToPushBuffer(pushEvent) {\n        pushEvent.startTimeout();\n        this.pushBuffer.push(pushEvent);\n        // Enforce buffer size limit\n        if (this.pushBuffer.length > MAX_PUSH_BUFFER_SIZE) {\n            const removedPush = this.pushBuffer.shift();\n            if (removedPush) {\n                removedPush.destroy();\n                this.socket.log('channel', `discarded push due to buffer overflow: ${removedPush.event}`, removedPush.payload);\n            }\n        }\n    }\n    /**\n     * Overridable message hook\n     *\n     * Receives all events for specialized message handling before dispatching to the channel callbacks.\n     * Must return the payload, modified or unmodified.\n     *\n     * @internal\n     */\n    _onMessage(_event, payload, _ref) {\n        return payload;\n    }\n    /** @internal */\n    _isMember(topic) {\n        return this.topic === topic;\n    }\n    /** @internal */\n    _joinRef() {\n        return this.joinPush.ref;\n    }\n    /** @internal */\n    _trigger(type, payload, ref) {\n        var _a, _b;\n        const typeLower = type.toLocaleLowerCase();\n        const { close, error, leave, join } = CHANNEL_EVENTS;\n        const events = [close, error, leave, join];\n        if (ref && events.indexOf(typeLower) >= 0 && ref !== this._joinRef()) {\n            return;\n        }\n        let handledPayload = this._onMessage(typeLower, payload, ref);\n        if (payload && !handledPayload) {\n            throw 'channel onMessage callbacks must return the payload, modified or unmodified';\n        }\n        if (['insert', 'update', 'delete'].includes(typeLower)) {\n            (_a = this.bindings.postgres_changes) === null || _a === void 0 ? void 0 : _a.filter((bind) => {\n                var _a, _b, _c;\n                return ((_a = bind.filter) === null || _a === void 0 ? void 0 : _a.event) === '*' || ((_c = (_b = bind.filter) === null || _b === void 0 ? void 0 : _b.event) === null || _c === void 0 ? void 0 : _c.toLocaleLowerCase()) === typeLower;\n            }).map((bind) => bind.callback(handledPayload, ref));\n        }\n        else {\n            (_b = this.bindings[typeLower]) === null || _b === void 0 ? void 0 : _b.filter((bind) => {\n                var _a, _b, _c, _d, _e, _f;\n                if (['broadcast', 'presence', 'postgres_changes'].includes(typeLower)) {\n                    if ('id' in bind) {\n                        const bindId = bind.id;\n                        const bindEvent = (_a = bind.filter) === null || _a === void 0 ? void 0 : _a.event;\n                        return (bindId &&\n                            ((_b = payload.ids) === null || _b === void 0 ? void 0 : _b.includes(bindId)) &&\n                            (bindEvent === '*' ||\n                                (bindEvent === null || bindEvent === void 0 ? void 0 : bindEvent.toLocaleLowerCase()) === ((_c = payload.data) === null || _c === void 0 ? void 0 : _c.type.toLocaleLowerCase())));\n                    }\n                    else {\n                        const bindEvent = (_e = (_d = bind === null || bind === void 0 ? void 0 : bind.filter) === null || _d === void 0 ? void 0 : _d.event) === null || _e === void 0 ? void 0 : _e.toLocaleLowerCase();\n                        return bindEvent === '*' || bindEvent === ((_f = payload === null || payload === void 0 ? void 0 : payload.event) === null || _f === void 0 ? void 0 : _f.toLocaleLowerCase());\n                    }\n                }\n                else {\n                    return bind.type.toLocaleLowerCase() === typeLower;\n                }\n            }).map((bind) => {\n                if (typeof handledPayload === 'object' && 'ids' in handledPayload) {\n                    const postgresChanges = handledPayload.data;\n                    const { schema, table, commit_timestamp, type, errors } = postgresChanges;\n                    const enrichedPayload = {\n                        schema: schema,\n                        table: table,\n                        commit_timestamp: commit_timestamp,\n                        eventType: type,\n                        new: {},\n                        old: {},\n                        errors: errors,\n                    };\n                    handledPayload = Object.assign(Object.assign({}, enrichedPayload), this._getPayloadRecords(postgresChanges));\n                }\n                bind.callback(handledPayload, ref);\n            });\n        }\n    }\n    /** @internal */\n    _isClosed() {\n        return this.state === CHANNEL_STATES.closed;\n    }\n    /** @internal */\n    _isJoined() {\n        return this.state === CHANNEL_STATES.joined;\n    }\n    /** @internal */\n    _isJoining() {\n        return this.state === CHANNEL_STATES.joining;\n    }\n    /** @internal */\n    _isLeaving() {\n        return this.state === CHANNEL_STATES.leaving;\n    }\n    /** @internal */\n    _replyEventName(ref) {\n        return `chan_reply_${ref}`;\n    }\n    /** @internal */\n    _on(type, filter, callback) {\n        const typeLower = type.toLocaleLowerCase();\n        const binding = {\n            type: typeLower,\n            filter: filter,\n            callback: callback,\n        };\n        if (this.bindings[typeLower]) {\n            this.bindings[typeLower].push(binding);\n        }\n        else {\n            this.bindings[typeLower] = [binding];\n        }\n        return this;\n    }\n    /** @internal */\n    _off(type, filter) {\n        const typeLower = type.toLocaleLowerCase();\n        if (this.bindings[typeLower]) {\n            this.bindings[typeLower] = this.bindings[typeLower].filter((bind) => {\n                var _a;\n                return !(((_a = bind.type) === null || _a === void 0 ? void 0 : _a.toLocaleLowerCase()) === typeLower &&\n                    RealtimeChannel.isEqual(bind.filter, filter));\n            });\n        }\n        return this;\n    }\n    /** @internal */\n    static isEqual(obj1, obj2) {\n        if (Object.keys(obj1).length !== Object.keys(obj2).length) {\n            return false;\n        }\n        for (const k in obj1) {\n            if (obj1[k] !== obj2[k]) {\n                return false;\n            }\n        }\n        return true;\n    }\n    /** @internal */\n    _rejoinUntilConnected() {\n        this.rejoinTimer.scheduleTimeout();\n        if (this.socket.isConnected()) {\n            this._rejoin();\n        }\n    }\n    /**\n     * Registers a callback that will be executed when the channel closes.\n     *\n     * @internal\n     */\n    _onClose(callback) {\n        this._on(CHANNEL_EVENTS.close, {}, callback);\n    }\n    /**\n     * Registers a callback that will be executed when the channel encounteres an error.\n     *\n     * @internal\n     */\n    _onError(callback) {\n        this._on(CHANNEL_EVENTS.error, {}, (reason) => callback(reason));\n    }\n    /**\n     * Returns `true` if the socket is connected and the channel has been joined.\n     *\n     * @internal\n     */\n    _canPush() {\n        return this.socket.isConnected() && this._isJoined();\n    }\n    /** @internal */\n    _rejoin(timeout = this.timeout) {\n        if (this._isLeaving()) {\n            return;\n        }\n        this.socket._leaveOpenTopic(this.topic);\n        this.state = CHANNEL_STATES.joining;\n        this.joinPush.resend(timeout);\n    }\n    /** @internal */\n    _getPayloadRecords(payload) {\n        const records = {\n            new: {},\n            old: {},\n        };\n        if (payload.type === 'INSERT' || payload.type === 'UPDATE') {\n            records.new = Transformers.convertChangeData(payload.columns, payload.record);\n        }\n        if (payload.type === 'UPDATE' || payload.type === 'DELETE') {\n            records.old = Transformers.convertChangeData(payload.columns, payload.old_record);\n        }\n        return records;\n    }\n}\n//# sourceMappingURL=RealtimeChannel.js.map","import WebSocketFactory from './lib/websocket-factory';\nimport { CHANNEL_EVENTS, CONNECTION_STATE, DEFAULT_VERSION, DEFAULT_TIMEOUT, SOCKET_STATES, TRANSPORTS, VSN, WS_CLOSE_NORMAL, } from './lib/constants';\nimport Serializer from './lib/serializer';\nimport Timer from './lib/timer';\nimport { httpEndpointURL } from './lib/transformers';\nimport RealtimeChannel from './RealtimeChannel';\nconst noop = () => { };\n// Connection-related constants\nconst CONNECTION_TIMEOUTS = {\n    HEARTBEAT_INTERVAL: 25000,\n    RECONNECT_DELAY: 10,\n    HEARTBEAT_TIMEOUT_FALLBACK: 100,\n};\nconst RECONNECT_INTERVALS = [1000, 2000, 5000, 10000];\nconst DEFAULT_RECONNECT_FALLBACK = 10000;\nconst WORKER_SCRIPT = `\n  addEventListener(\"message\", (e) => {\n    if (e.data.event === \"start\") {\n      setInterval(() => postMessage({ event: \"keepAlive\" }), e.data.interval);\n    }\n  });`;\nexport default class RealtimeClient {\n    /**\n     * Initializes the Socket.\n     *\n     * @param endPoint The string WebSocket endpoint, ie, \"ws://example.com/socket\", \"wss://example.com\", \"/socket\" (inherited host & protocol)\n     * @param httpEndpoint The string HTTP endpoint, ie, \"https://example.com\", \"/\" (inherited host & protocol)\n     * @param options.transport The Websocket Transport, for example WebSocket. This can be a custom implementation\n     * @param options.timeout The default timeout in milliseconds to trigger push timeouts.\n     * @param options.params The optional params to pass when connecting.\n     * @param options.headers Deprecated: headers cannot be set on websocket connections and this option will be removed in the future.\n     * @param options.heartbeatIntervalMs The millisec interval to send a heartbeat message.\n     * @param options.heartbeatCallback The optional function to handle heartbeat status.\n     * @param options.logger The optional function for specialized logging, ie: logger: (kind, msg, data) => { console.log(`${kind}: ${msg}`, data) }\n     * @param options.logLevel Sets the log level for Realtime\n     * @param options.encode The function to encode outgoing messages. Defaults to JSON: (payload, callback) => callback(JSON.stringify(payload))\n     * @param options.decode The function to decode incoming messages. Defaults to Serializer's decode.\n     * @param options.reconnectAfterMs he optional function that returns the millsec reconnect interval. Defaults to stepped backoff off.\n     * @param options.worker Use Web Worker to set a side flow. Defaults to false.\n     * @param options.workerUrl The URL of the worker script. Defaults to https://realtime.supabase.com/worker.js that includes a heartbeat event call to keep the connection alive.\n     */\n    constructor(endPoint, options) {\n        var _a;\n        this.accessTokenValue = null;\n        this.apiKey = null;\n        this.channels = new Array();\n        this.endPoint = '';\n        this.httpEndpoint = '';\n        /** @deprecated headers cannot be set on websocket connections */\n        this.headers = {};\n        this.params = {};\n        this.timeout = DEFAULT_TIMEOUT;\n        this.transport = null;\n        this.heartbeatIntervalMs = CONNECTION_TIMEOUTS.HEARTBEAT_INTERVAL;\n        this.heartbeatTimer = undefined;\n        this.pendingHeartbeatRef = null;\n        this.heartbeatCallback = noop;\n        this.ref = 0;\n        this.reconnectTimer = null;\n        this.logger = noop;\n        this.conn = null;\n        this.sendBuffer = [];\n        this.serializer = new Serializer();\n        this.stateChangeCallbacks = {\n            open: [],\n            close: [],\n            error: [],\n            message: [],\n        };\n        this.accessToken = null;\n        this._connectionState = 'disconnected';\n        this._wasManualDisconnect = false;\n        this._authPromise = null;\n        /**\n         * Use either custom fetch, if provided, or default fetch to make HTTP requests\n         *\n         * @internal\n         */\n        this._resolveFetch = (customFetch) => {\n            if (customFetch) {\n                return (...args) => customFetch(...args);\n            }\n            return (...args) => fetch(...args);\n        };\n        // Validate required parameters\n        if (!((_a = options === null || options === void 0 ? void 0 : options.params) === null || _a === void 0 ? void 0 : _a.apikey)) {\n            throw new Error('API key is required to connect to Realtime');\n        }\n        this.apiKey = options.params.apikey;\n        // Initialize endpoint URLs\n        this.endPoint = `${endPoint}/${TRANSPORTS.websocket}`;\n        this.httpEndpoint = httpEndpointURL(endPoint);\n        this._initializeOptions(options);\n        this._setupReconnectionTimer();\n        this.fetch = this._resolveFetch(options === null || options === void 0 ? void 0 : options.fetch);\n    }\n    /**\n     * Connects the socket, unless already connected.\n     */\n    connect() {\n        // Skip if already connecting, disconnecting, or connected\n        if (this.isConnecting() ||\n            this.isDisconnecting() ||\n            (this.conn !== null && this.isConnected())) {\n            return;\n        }\n        this._setConnectionState('connecting');\n        this._setAuthSafely('connect');\n        // Establish WebSocket connection\n        if (this.transport) {\n            // Use custom transport if provided\n            this.conn = new this.transport(this.endpointURL());\n        }\n        else {\n            // Try to use native WebSocket\n            try {\n                this.conn = WebSocketFactory.createWebSocket(this.endpointURL());\n            }\n            catch (error) {\n                this._setConnectionState('disconnected');\n                const errorMessage = error.message;\n                // Provide helpful error message based on environment\n                if (errorMessage.includes('Node.js')) {\n                    throw new Error(`${errorMessage}\\n\\n` +\n                        'To use Realtime in Node.js, you need to provide a WebSocket implementation:\\n\\n' +\n                        'Option 1: Use Node.js 22+ which has native WebSocket support\\n' +\n                        'Option 2: Install and provide the \"ws\" package:\\n\\n' +\n                        '  npm install ws\\n\\n' +\n                        '  import ws from \"ws\"\\n' +\n                        '  const client = new RealtimeClient(url, {\\n' +\n                        '    ...options,\\n' +\n                        '    transport: ws\\n' +\n                        '  })');\n                }\n                throw new Error(`WebSocket not available: ${errorMessage}`);\n            }\n        }\n        this._setupConnectionHandlers();\n    }\n    /**\n     * Returns the URL of the websocket.\n     * @returns string The URL of the websocket.\n     */\n    endpointURL() {\n        return this._appendParams(this.endPoint, Object.assign({}, this.params, { vsn: VSN }));\n    }\n    /**\n     * Disconnects the socket.\n     *\n     * @param code A numeric status code to send on disconnect.\n     * @param reason A custom reason for the disconnect.\n     */\n    disconnect(code, reason) {\n        if (this.isDisconnecting()) {\n            return;\n        }\n        this._setConnectionState('disconnecting', true);\n        if (this.conn) {\n            // Setup fallback timer to prevent hanging in disconnecting state\n            const fallbackTimer = setTimeout(() => {\n                this._setConnectionState('disconnected');\n            }, 100);\n            this.conn.onclose = () => {\n                clearTimeout(fallbackTimer);\n                this._setConnectionState('disconnected');\n            };\n            // Close the WebSocket connection\n            if (code) {\n                this.conn.close(code, reason !== null && reason !== void 0 ? reason : '');\n            }\n            else {\n                this.conn.close();\n            }\n            this._teardownConnection();\n        }\n        else {\n            this._setConnectionState('disconnected');\n        }\n    }\n    /**\n     * Returns all created channels\n     */\n    getChannels() {\n        return this.channels;\n    }\n    /**\n     * Unsubscribes and removes a single channel\n     * @param channel A RealtimeChannel instance\n     */\n    async removeChannel(channel) {\n        const status = await channel.unsubscribe();\n        if (this.channels.length === 0) {\n            this.disconnect();\n        }\n        return status;\n    }\n    /**\n     * Unsubscribes and removes all channels\n     */\n    async removeAllChannels() {\n        const values_1 = await Promise.all(this.channels.map((channel) => channel.unsubscribe()));\n        this.channels = [];\n        this.disconnect();\n        return values_1;\n    }\n    /**\n     * Logs the message.\n     *\n     * For customized logging, `this.logger` can be overridden.\n     */\n    log(kind, msg, data) {\n        this.logger(kind, msg, data);\n    }\n    /**\n     * Returns the current state of the socket.\n     */\n    connectionState() {\n        switch (this.conn && this.conn.readyState) {\n            case SOCKET_STATES.connecting:\n                return CONNECTION_STATE.Connecting;\n            case SOCKET_STATES.open:\n                return CONNECTION_STATE.Open;\n            case SOCKET_STATES.closing:\n                return CONNECTION_STATE.Closing;\n            default:\n                return CONNECTION_STATE.Closed;\n        }\n    }\n    /**\n     * Returns `true` is the connection is open.\n     */\n    isConnected() {\n        return this.connectionState() === CONNECTION_STATE.Open;\n    }\n    /**\n     * Returns `true` if the connection is currently connecting.\n     */\n    isConnecting() {\n        return this._connectionState === 'connecting';\n    }\n    /**\n     * Returns `true` if the connection is currently disconnecting.\n     */\n    isDisconnecting() {\n        return this._connectionState === 'disconnecting';\n    }\n    channel(topic, params = { config: {} }) {\n        const realtimeTopic = `realtime:${topic}`;\n        const exists = this.getChannels().find((c) => c.topic === realtimeTopic);\n        if (!exists) {\n            const chan = new RealtimeChannel(`realtime:${topic}`, params, this);\n            this.channels.push(chan);\n            return chan;\n        }\n        else {\n            return exists;\n        }\n    }\n    /**\n     * Push out a message if the socket is connected.\n     *\n     * If the socket is not connected, the message gets enqueued within a local buffer, and sent out when a connection is next established.\n     */\n    push(data) {\n        const { topic, event, payload, ref } = data;\n        const callback = () => {\n            this.encode(data, (result) => {\n                var _a;\n                (_a = this.conn) === null || _a === void 0 ? void 0 : _a.send(result);\n            });\n        };\n        this.log('push', `${topic} ${event} (${ref})`, payload);\n        if (this.isConnected()) {\n            callback();\n        }\n        else {\n            this.sendBuffer.push(callback);\n        }\n    }\n    /**\n     * Sets the JWT access token used for channel subscription authorization and Realtime RLS.\n     *\n     * If param is null it will use the `accessToken` callback function or the token set on the client.\n     *\n     * On callback used, it will set the value of the token internal to the client.\n     *\n     * @param token A JWT string to override the token set on the client.\n     */\n    async setAuth(token = null) {\n        this._authPromise = this._performAuth(token);\n        try {\n            await this._authPromise;\n        }\n        finally {\n            this._authPromise = null;\n        }\n    }\n    /**\n     * Sends a heartbeat message if the socket is connected.\n     */\n    async sendHeartbeat() {\n        var _a;\n        if (!this.isConnected()) {\n            try {\n                this.heartbeatCallback('disconnected');\n            }\n            catch (e) {\n                this.log('error', 'error in heartbeat callback', e);\n            }\n            return;\n        }\n        // Handle heartbeat timeout and force reconnection if needed\n        if (this.pendingHeartbeatRef) {\n            this.pendingHeartbeatRef = null;\n            this.log('transport', 'heartbeat timeout. Attempting to re-establish connection');\n            try {\n                this.heartbeatCallback('timeout');\n            }\n            catch (e) {\n                this.log('error', 'error in heartbeat callback', e);\n            }\n            // Force reconnection after heartbeat timeout\n            this._wasManualDisconnect = false;\n            (_a = this.conn) === null || _a === void 0 ? void 0 : _a.close(WS_CLOSE_NORMAL, 'heartbeat timeout');\n            setTimeout(() => {\n                var _a;\n                if (!this.isConnected()) {\n                    (_a = this.reconnectTimer) === null || _a === void 0 ? void 0 : _a.scheduleTimeout();\n                }\n            }, CONNECTION_TIMEOUTS.HEARTBEAT_TIMEOUT_FALLBACK);\n            return;\n        }\n        // Send heartbeat message to server\n        this.pendingHeartbeatRef = this._makeRef();\n        this.push({\n            topic: 'phoenix',\n            event: 'heartbeat',\n            payload: {},\n            ref: this.pendingHeartbeatRef,\n        });\n        try {\n            this.heartbeatCallback('sent');\n        }\n        catch (e) {\n            this.log('error', 'error in heartbeat callback', e);\n        }\n        this._setAuthSafely('heartbeat');\n    }\n    onHeartbeat(callback) {\n        this.heartbeatCallback = callback;\n    }\n    /**\n     * Flushes send buffer\n     */\n    flushSendBuffer() {\n        if (this.isConnected() && this.sendBuffer.length > 0) {\n            this.sendBuffer.forEach((callback) => callback());\n            this.sendBuffer = [];\n        }\n    }\n    /**\n     * Return the next message ref, accounting for overflows\n     *\n     * @internal\n     */\n    _makeRef() {\n        let newRef = this.ref + 1;\n        if (newRef === this.ref) {\n            this.ref = 0;\n        }\n        else {\n            this.ref = newRef;\n        }\n        return this.ref.toString();\n    }\n    /**\n     * Unsubscribe from channels with the specified topic.\n     *\n     * @internal\n     */\n    _leaveOpenTopic(topic) {\n        let dupChannel = this.channels.find((c) => c.topic === topic && (c._isJoined() || c._isJoining()));\n        if (dupChannel) {\n            this.log('transport', `leaving duplicate topic \"${topic}\"`);\n            dupChannel.unsubscribe();\n        }\n    }\n    /**\n     * Removes a subscription from the socket.\n     *\n     * @param channel An open subscription.\n     *\n     * @internal\n     */\n    _remove(channel) {\n        this.channels = this.channels.filter((c) => c.topic !== channel.topic);\n    }\n    /** @internal */\n    _onConnMessage(rawMessage) {\n        this.decode(rawMessage.data, (msg) => {\n            // Handle heartbeat responses\n            if (msg.topic === 'phoenix' && msg.event === 'phx_reply') {\n                try {\n                    this.heartbeatCallback(msg.payload.status === 'ok' ? 'ok' : 'error');\n                }\n                catch (e) {\n                    this.log('error', 'error in heartbeat callback', e);\n                }\n            }\n            // Handle pending heartbeat reference cleanup\n            if (msg.ref && msg.ref === this.pendingHeartbeatRef) {\n                this.pendingHeartbeatRef = null;\n            }\n            // Log incoming message\n            const { topic, event, payload, ref } = msg;\n            const refString = ref ? `(${ref})` : '';\n            const status = payload.status || '';\n            this.log('receive', `${status} ${topic} ${event} ${refString}`.trim(), payload);\n            // Route message to appropriate channels\n            this.channels\n                .filter((channel) => channel._isMember(topic))\n                .forEach((channel) => channel._trigger(event, payload, ref));\n            this._triggerStateCallbacks('message', msg);\n        });\n    }\n    /**\n     * Clear specific timer\n     * @internal\n     */\n    _clearTimer(timer) {\n        var _a;\n        if (timer === 'heartbeat' && this.heartbeatTimer) {\n            clearInterval(this.heartbeatTimer);\n            this.heartbeatTimer = undefined;\n        }\n        else if (timer === 'reconnect') {\n            (_a = this.reconnectTimer) === null || _a === void 0 ? void 0 : _a.reset();\n        }\n    }\n    /**\n     * Clear all timers\n     * @internal\n     */\n    _clearAllTimers() {\n        this._clearTimer('heartbeat');\n        this._clearTimer('reconnect');\n    }\n    /**\n     * Setup connection handlers for WebSocket events\n     * @internal\n     */\n    _setupConnectionHandlers() {\n        if (!this.conn)\n            return;\n        // Set binary type if supported (browsers and most WebSocket implementations)\n        if ('binaryType' in this.conn) {\n            ;\n            this.conn.binaryType = 'arraybuffer';\n        }\n        this.conn.onopen = () => this._onConnOpen();\n        this.conn.onerror = (error) => this._onConnError(error);\n        this.conn.onmessage = (event) => this._onConnMessage(event);\n        this.conn.onclose = (event) => this._onConnClose(event);\n    }\n    /**\n     * Teardown connection and cleanup resources\n     * @internal\n     */\n    _teardownConnection() {\n        if (this.conn) {\n            this.conn.onopen = null;\n            this.conn.onerror = null;\n            this.conn.onmessage = null;\n            this.conn.onclose = null;\n            this.conn = null;\n        }\n        this._clearAllTimers();\n        this.channels.forEach((channel) => channel.teardown());\n    }\n    /** @internal */\n    _onConnOpen() {\n        this._setConnectionState('connected');\n        this.log('transport', `connected to ${this.endpointURL()}`);\n        this.flushSendBuffer();\n        this._clearTimer('reconnect');\n        if (!this.worker) {\n            this._startHeartbeat();\n        }\n        else {\n            if (!this.workerRef) {\n                this._startWorkerHeartbeat();\n            }\n        }\n        this._triggerStateCallbacks('open');\n    }\n    /** @internal */\n    _startHeartbeat() {\n        this.heartbeatTimer && clearInterval(this.heartbeatTimer);\n        this.heartbeatTimer = setInterval(() => this.sendHeartbeat(), this.heartbeatIntervalMs);\n    }\n    /** @internal */\n    _startWorkerHeartbeat() {\n        if (this.workerUrl) {\n            this.log('worker', `starting worker for from ${this.workerUrl}`);\n        }\n        else {\n            this.log('worker', `starting default worker`);\n        }\n        const objectUrl = this._workerObjectUrl(this.workerUrl);\n        this.workerRef = new Worker(objectUrl);\n        this.workerRef.onerror = (error) => {\n            this.log('worker', 'worker error', error.message);\n            this.workerRef.terminate();\n        };\n        this.workerRef.onmessage = (event) => {\n            if (event.data.event === 'keepAlive') {\n                this.sendHeartbeat();\n            }\n        };\n        this.workerRef.postMessage({\n            event: 'start',\n            interval: this.heartbeatIntervalMs,\n        });\n    }\n    /** @internal */\n    _onConnClose(event) {\n        var _a;\n        this._setConnectionState('disconnected');\n        this.log('transport', 'close', event);\n        this._triggerChanError();\n        this._clearTimer('heartbeat');\n        // Only schedule reconnection if it wasn't a manual disconnect\n        if (!this._wasManualDisconnect) {\n            (_a = this.reconnectTimer) === null || _a === void 0 ? void 0 : _a.scheduleTimeout();\n        }\n        this._triggerStateCallbacks('close', event);\n    }\n    /** @internal */\n    _onConnError(error) {\n        this._setConnectionState('disconnected');\n        this.log('transport', `${error}`);\n        this._triggerChanError();\n        this._triggerStateCallbacks('error', error);\n    }\n    /** @internal */\n    _triggerChanError() {\n        this.channels.forEach((channel) => channel._trigger(CHANNEL_EVENTS.error));\n    }\n    /** @internal */\n    _appendParams(url, params) {\n        if (Object.keys(params).length === 0) {\n            return url;\n        }\n        const prefix = url.match(/\\?/) ? '&' : '?';\n        const query = new URLSearchParams(params);\n        return `${url}${prefix}${query}`;\n    }\n    _workerObjectUrl(url) {\n        let result_url;\n        if (url) {\n            result_url = url;\n        }\n        else {\n            const blob = new Blob([WORKER_SCRIPT], { type: 'application/javascript' });\n            result_url = URL.createObjectURL(blob);\n        }\n        return result_url;\n    }\n    /**\n     * Set connection state with proper state management\n     * @internal\n     */\n    _setConnectionState(state, manual = false) {\n        this._connectionState = state;\n        if (state === 'connecting') {\n            this._wasManualDisconnect = false;\n        }\n        else if (state === 'disconnecting') {\n            this._wasManualDisconnect = manual;\n        }\n    }\n    /**\n     * Perform the actual auth operation\n     * @internal\n     */\n    async _performAuth(token = null) {\n        let tokenToSend;\n        if (token) {\n            tokenToSend = token;\n        }\n        else if (this.accessToken) {\n            // Always call the accessToken callback to get fresh token\n            tokenToSend = await this.accessToken();\n        }\n        else {\n            tokenToSend = this.accessTokenValue;\n        }\n        if (this.accessTokenValue != tokenToSend) {\n            this.accessTokenValue = tokenToSend;\n            this.channels.forEach((channel) => {\n                const payload = {\n                    access_token: tokenToSend,\n                    version: DEFAULT_VERSION,\n                };\n                tokenToSend && channel.updateJoinPayload(payload);\n                if (channel.joinedOnce && channel._isJoined()) {\n                    channel._push(CHANNEL_EVENTS.access_token, {\n                        access_token: tokenToSend,\n                    });\n                }\n            });\n        }\n    }\n    /**\n     * Wait for any in-flight auth operations to complete\n     * @internal\n     */\n    async _waitForAuthIfNeeded() {\n        if (this._authPromise) {\n            await this._authPromise;\n        }\n    }\n    /**\n     * Safely call setAuth with standardized error handling\n     * @internal\n     */\n    _setAuthSafely(context = 'general') {\n        this.setAuth().catch((e) => {\n            this.log('error', `error setting auth in ${context}`, e);\n        });\n    }\n    /**\n     * Trigger state change callbacks with proper error handling\n     * @internal\n     */\n    _triggerStateCallbacks(event, data) {\n        try {\n            this.stateChangeCallbacks[event].forEach((callback) => {\n                try {\n                    callback(data);\n                }\n                catch (e) {\n                    this.log('error', `error in ${event} callback`, e);\n                }\n            });\n        }\n        catch (e) {\n            this.log('error', `error triggering ${event} callbacks`, e);\n        }\n    }\n    /**\n     * Setup reconnection timer with proper configuration\n     * @internal\n     */\n    _setupReconnectionTimer() {\n        this.reconnectTimer = new Timer(async () => {\n            setTimeout(async () => {\n                await this._waitForAuthIfNeeded();\n                if (!this.isConnected()) {\n                    this.connect();\n                }\n            }, CONNECTION_TIMEOUTS.RECONNECT_DELAY);\n        }, this.reconnectAfterMs);\n    }\n    /**\n     * Initialize client options with defaults\n     * @internal\n     */\n    _initializeOptions(options) {\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j;\n        // Set defaults\n        this.transport = (_a = options === null || options === void 0 ? void 0 : options.transport) !== null && _a !== void 0 ? _a : null;\n        this.timeout = (_b = options === null || options === void 0 ? void 0 : options.timeout) !== null && _b !== void 0 ? _b : DEFAULT_TIMEOUT;\n        this.heartbeatIntervalMs =\n            (_c = options === null || options === void 0 ? void 0 : options.heartbeatIntervalMs) !== null && _c !== void 0 ? _c : CONNECTION_TIMEOUTS.HEARTBEAT_INTERVAL;\n        this.worker = (_d = options === null || options === void 0 ? void 0 : options.worker) !== null && _d !== void 0 ? _d : false;\n        this.accessToken = (_e = options === null || options === void 0 ? void 0 : options.accessToken) !== null && _e !== void 0 ? _e : null;\n        this.heartbeatCallback = (_f = options === null || options === void 0 ? void 0 : options.heartbeatCallback) !== null && _f !== void 0 ? _f : noop;\n        // Handle special cases\n        if (options === null || options === void 0 ? void 0 : options.params)\n            this.params = options.params;\n        if (options === null || options === void 0 ? void 0 : options.logger)\n            this.logger = options.logger;\n        if ((options === null || options === void 0 ? void 0 : options.logLevel) || (options === null || options === void 0 ? void 0 : options.log_level)) {\n            this.logLevel = options.logLevel || options.log_level;\n            this.params = Object.assign(Object.assign({}, this.params), { log_level: this.logLevel });\n        }\n        // Set up functions with defaults\n        this.reconnectAfterMs =\n            (_g = options === null || options === void 0 ? void 0 : options.reconnectAfterMs) !== null && _g !== void 0 ? _g : ((tries) => {\n                return RECONNECT_INTERVALS[tries - 1] || DEFAULT_RECONNECT_FALLBACK;\n            });\n        this.encode =\n            (_h = options === null || options === void 0 ? void 0 : options.encode) !== null && _h !== void 0 ? _h : ((payload, callback) => {\n                return callback(JSON.stringify(payload));\n            });\n        this.decode = (_j = options === null || options === void 0 ? void 0 : options.decode) !== null && _j !== void 0 ? _j : this.serializer.decode.bind(this.serializer);\n        // Handle worker setup\n        if (this.worker) {\n            if (typeof window !== 'undefined' && !window.Worker) {\n                throw new Error('Web Worker is not supported');\n            }\n            this.workerUrl = options === null || options === void 0 ? void 0 : options.workerUrl;\n        }\n    }\n}\n//# sourceMappingURL=RealtimeClient.js.map","export class StorageError extends Error {\n    constructor(message) {\n        super(message);\n        this.__isStorageError = true;\n        this.name = 'StorageError';\n    }\n}\nexport function isStorageError(error) {\n    return typeof error === 'object' && error !== null && '__isStorageError' in error;\n}\nexport class StorageApiError extends StorageError {\n    constructor(message, status, statusCode) {\n        super(message);\n        this.name = 'StorageApiError';\n        this.status = status;\n        this.statusCode = statusCode;\n    }\n    toJSON() {\n        return {\n            name: this.name,\n            message: this.message,\n            status: this.status,\n            statusCode: this.statusCode,\n        };\n    }\n}\nexport class StorageUnknownError extends StorageError {\n    constructor(message, originalError) {\n        super(message);\n        this.name = 'StorageUnknownError';\n        this.originalError = originalError;\n    }\n}\n//# sourceMappingURL=errors.js.map","export const resolveFetch = (customFetch) => {\n    if (customFetch) {\n        return (...args) => customFetch(...args);\n    }\n    return (...args) => fetch(...args);\n};\nexport const resolveResponse = () => {\n    return Response;\n};\nexport const recursiveToCamel = (item) => {\n    if (Array.isArray(item)) {\n        return item.map((el) => recursiveToCamel(el));\n    }\n    else if (typeof item === 'function' || item !== Object(item)) {\n        return item;\n    }\n    const result = {};\n    Object.entries(item).forEach(([key, value]) => {\n        const newKey = key.replace(/([-_][a-z])/gi, (c) => c.toUpperCase().replace(/[-_]/g, ''));\n        result[newKey] = recursiveToCamel(value);\n    });\n    return result;\n};\n/**\n * Determine if input is a plain object\n * An object is plain if it's created by either {}, new Object(), or Object.create(null)\n * source: https://github.com/sindresorhus/is-plain-obj\n */\nexport const isPlainObject = (value) => {\n    if (typeof value !== 'object' || value === null) {\n        return false;\n    }\n    const prototype = Object.getPrototypeOf(value);\n    return ((prototype === null ||\n        prototype === Object.prototype ||\n        Object.getPrototypeOf(prototype) === null) &&\n        !(Symbol.toStringTag in value) &&\n        !(Symbol.iterator in value));\n};\n//# sourceMappingURL=helpers.js.map","import { __awaiter } from \"tslib\";\nimport { StorageApiError, StorageUnknownError } from './errors';\nimport { isPlainObject, resolveResponse } from './helpers';\nconst _getErrorMessage = (err) => {\n    var _a;\n    return err.msg ||\n        err.message ||\n        err.error_description ||\n        (typeof err.error === 'string' ? err.error : (_a = err.error) === null || _a === void 0 ? void 0 : _a.message) ||\n        JSON.stringify(err);\n};\nconst handleError = (error, reject, options) => __awaiter(void 0, void 0, void 0, function* () {\n    const Res = yield resolveResponse();\n    if (error instanceof Res && !(options === null || options === void 0 ? void 0 : options.noResolveJson)) {\n        error\n            .json()\n            .then((err) => {\n            const status = error.status || 500;\n            const statusCode = (err === null || err === void 0 ? void 0 : err.statusCode) || status + '';\n            reject(new StorageApiError(_getErrorMessage(err), status, statusCode));\n        })\n            .catch((err) => {\n            reject(new StorageUnknownError(_getErrorMessage(err), err));\n        });\n    }\n    else {\n        reject(new StorageUnknownError(_getErrorMessage(error), error));\n    }\n});\nconst _getRequestParams = (method, options, parameters, body) => {\n    const params = { method, headers: (options === null || options === void 0 ? void 0 : options.headers) || {} };\n    if (method === 'GET' || !body) {\n        return params;\n    }\n    if (isPlainObject(body)) {\n        params.headers = Object.assign({ 'Content-Type': 'application/json' }, options === null || options === void 0 ? void 0 : options.headers);\n        params.body = JSON.stringify(body);\n    }\n    else {\n        params.body = body;\n    }\n    if (options === null || options === void 0 ? void 0 : options.duplex) {\n        params.duplex = options.duplex;\n    }\n    return Object.assign(Object.assign({}, params), parameters);\n};\nfunction _handleRequest(fetcher, method, url, options, parameters, body) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return new Promise((resolve, reject) => {\n            fetcher(url, _getRequestParams(method, options, parameters, body))\n                .then((result) => {\n                if (!result.ok)\n                    throw result;\n                if (options === null || options === void 0 ? void 0 : options.noResolveJson)\n                    return result;\n                return result.json();\n            })\n                .then((data) => resolve(data))\n                .catch((error) => handleError(error, reject, options));\n        });\n    });\n}\nexport function get(fetcher, url, options, parameters) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return _handleRequest(fetcher, 'GET', url, options, parameters);\n    });\n}\nexport function post(fetcher, url, body, options, parameters) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return _handleRequest(fetcher, 'POST', url, options, parameters, body);\n    });\n}\nexport function put(fetcher, url, body, options, parameters) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return _handleRequest(fetcher, 'PUT', url, options, parameters, body);\n    });\n}\nexport function head(fetcher, url, options, parameters) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return _handleRequest(fetcher, 'HEAD', url, Object.assign(Object.assign({}, options), { noResolveJson: true }), parameters);\n    });\n}\nexport function remove(fetcher, url, body, options, parameters) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return _handleRequest(fetcher, 'DELETE', url, options, parameters, body);\n    });\n}\n//# sourceMappingURL=fetch.js.map","import { __awaiter } from \"tslib\";\nimport { isStorageError } from '../lib/errors';\nexport default class StreamDownloadBuilder {\n    constructor(downloadFn, shouldThrowOnError) {\n        this.downloadFn = downloadFn;\n        this.shouldThrowOnError = shouldThrowOnError;\n    }\n    then(onfulfilled, onrejected) {\n        return this.execute().then(onfulfilled, onrejected);\n    }\n    execute() {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const result = yield this.downloadFn();\n                return {\n                    data: result.body,\n                    error: null,\n                };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n}\n//# sourceMappingURL=StreamDownloadBuilder.js.map","var _a;\nimport { __awaiter } from \"tslib\";\nimport { isStorageError } from '../lib/errors';\nimport StreamDownloadBuilder from './StreamDownloadBuilder';\nclass BlobDownloadBuilder {\n    constructor(downloadFn, shouldThrowOnError) {\n        this.downloadFn = downloadFn;\n        this.shouldThrowOnError = shouldThrowOnError;\n        this[_a] = 'BlobDownloadBuilder';\n        this.promise = null;\n    }\n    asStream() {\n        return new StreamDownloadBuilder(this.downloadFn, this.shouldThrowOnError);\n    }\n    then(onfulfilled, onrejected) {\n        return this.getPromise().then(onfulfilled, onrejected);\n    }\n    catch(onrejected) {\n        return this.getPromise().catch(onrejected);\n    }\n    finally(onfinally) {\n        return this.getPromise().finally(onfinally);\n    }\n    getPromise() {\n        if (!this.promise) {\n            this.promise = this.execute();\n        }\n        return this.promise;\n    }\n    execute() {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const result = yield this.downloadFn();\n                return {\n                    data: yield result.blob(),\n                    error: null,\n                };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n}\n_a = Symbol.toStringTag;\nexport default BlobDownloadBuilder;\n//# sourceMappingURL=BlobDownloadBuilder.js.map","import { __awaiter } from \"tslib\";\nimport { isStorageError, StorageError, StorageUnknownError } from '../lib/errors';\nimport { get, head, post, put, remove } from '../lib/fetch';\nimport { recursiveToCamel, resolveFetch } from '../lib/helpers';\nimport BlobDownloadBuilder from './BlobDownloadBuilder';\nconst DEFAULT_SEARCH_OPTIONS = {\n    limit: 100,\n    offset: 0,\n    sortBy: {\n        column: 'name',\n        order: 'asc',\n    },\n};\nconst DEFAULT_FILE_OPTIONS = {\n    cacheControl: '3600',\n    contentType: 'text/plain;charset=UTF-8',\n    upsert: false,\n};\nexport default class StorageFileApi {\n    constructor(url, headers = {}, bucketId, fetch) {\n        this.shouldThrowOnError = false;\n        this.url = url;\n        this.headers = headers;\n        this.bucketId = bucketId;\n        this.fetch = resolveFetch(fetch);\n    }\n    /**\n     * Enable throwing errors instead of returning them.\n     */\n    throwOnError() {\n        this.shouldThrowOnError = true;\n        return this;\n    }\n    /**\n     * Uploads a file to an existing bucket or replaces an existing file at the specified path with a new one.\n     *\n     * @param method HTTP method.\n     * @param path The relative file path. Should be of the format `folder/subfolder/filename.png`. The bucket must already exist before attempting to upload.\n     * @param fileBody The body of the file to be stored in the bucket.\n     */\n    uploadOrUpdate(method, path, fileBody, fileOptions) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                let body;\n                const options = Object.assign(Object.assign({}, DEFAULT_FILE_OPTIONS), fileOptions);\n                let headers = Object.assign(Object.assign({}, this.headers), (method === 'POST' && { 'x-upsert': String(options.upsert) }));\n                const metadata = options.metadata;\n                if (typeof Blob !== 'undefined' && fileBody instanceof Blob) {\n                    body = new FormData();\n                    body.append('cacheControl', options.cacheControl);\n                    if (metadata) {\n                        body.append('metadata', this.encodeMetadata(metadata));\n                    }\n                    body.append('', fileBody);\n                }\n                else if (typeof FormData !== 'undefined' && fileBody instanceof FormData) {\n                    body = fileBody;\n                    // Only append if not already present\n                    if (!body.has('cacheControl')) {\n                        body.append('cacheControl', options.cacheControl);\n                    }\n                    if (metadata && !body.has('metadata')) {\n                        body.append('metadata', this.encodeMetadata(metadata));\n                    }\n                }\n                else {\n                    body = fileBody;\n                    headers['cache-control'] = `max-age=${options.cacheControl}`;\n                    headers['content-type'] = options.contentType;\n                    if (metadata) {\n                        headers['x-metadata'] = this.toBase64(this.encodeMetadata(metadata));\n                    }\n                    // Node.js streams require duplex option for fetch in Node 20+\n                    // Check for both web ReadableStream and Node.js streams\n                    const isStream = (typeof ReadableStream !== 'undefined' && body instanceof ReadableStream) ||\n                        (body && typeof body === 'object' && 'pipe' in body && typeof body.pipe === 'function');\n                    if (isStream && !options.duplex) {\n                        options.duplex = 'half';\n                    }\n                }\n                if (fileOptions === null || fileOptions === void 0 ? void 0 : fileOptions.headers) {\n                    headers = Object.assign(Object.assign({}, headers), fileOptions.headers);\n                }\n                const cleanPath = this._removeEmptyFolders(path);\n                const _path = this._getFinalPath(cleanPath);\n                const data = yield (method == 'PUT' ? put : post)(this.fetch, `${this.url}/object/${_path}`, body, Object.assign({ headers }, ((options === null || options === void 0 ? void 0 : options.duplex) ? { duplex: options.duplex } : {})));\n                return {\n                    data: { path: cleanPath, id: data.Id, fullPath: data.Key },\n                    error: null,\n                };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Uploads a file to an existing bucket.\n     *\n     * @param path The file path, including the file name. Should be of the format `folder/subfolder/filename.png`. The bucket must already exist before attempting to upload.\n     * @param fileBody The body of the file to be stored in the bucket.\n     */\n    upload(path, fileBody, fileOptions) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.uploadOrUpdate('POST', path, fileBody, fileOptions);\n        });\n    }\n    /**\n     * Upload a file with a token generated from `createSignedUploadUrl`.\n     * @param path The file path, including the file name. Should be of the format `folder/subfolder/filename.png`. The bucket must already exist before attempting to upload.\n     * @param token The token generated from `createSignedUploadUrl`\n     * @param fileBody The body of the file to be stored in the bucket.\n     */\n    uploadToSignedUrl(path, token, fileBody, fileOptions) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const cleanPath = this._removeEmptyFolders(path);\n            const _path = this._getFinalPath(cleanPath);\n            const url = new URL(this.url + `/object/upload/sign/${_path}`);\n            url.searchParams.set('token', token);\n            try {\n                let body;\n                const options = Object.assign({ upsert: DEFAULT_FILE_OPTIONS.upsert }, fileOptions);\n                const headers = Object.assign(Object.assign({}, this.headers), { 'x-upsert': String(options.upsert) });\n                if (typeof Blob !== 'undefined' && fileBody instanceof Blob) {\n                    body = new FormData();\n                    body.append('cacheControl', options.cacheControl);\n                    body.append('', fileBody);\n                }\n                else if (typeof FormData !== 'undefined' && fileBody instanceof FormData) {\n                    body = fileBody;\n                    body.append('cacheControl', options.cacheControl);\n                }\n                else {\n                    body = fileBody;\n                    headers['cache-control'] = `max-age=${options.cacheControl}`;\n                    headers['content-type'] = options.contentType;\n                }\n                const data = yield put(this.fetch, url.toString(), body, { headers });\n                return {\n                    data: { path: cleanPath, fullPath: data.Key },\n                    error: null,\n                };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Creates a signed upload URL.\n     * Signed upload URLs can be used to upload files to the bucket without further authentication.\n     * They are valid for 2 hours.\n     * @param path The file path, including the current file name. For example `folder/image.png`.\n     * @param options.upsert If set to true, allows the file to be overwritten if it already exists.\n     */\n    createSignedUploadUrl(path, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                let _path = this._getFinalPath(path);\n                const headers = Object.assign({}, this.headers);\n                if (options === null || options === void 0 ? void 0 : options.upsert) {\n                    headers['x-upsert'] = 'true';\n                }\n                const data = yield post(this.fetch, `${this.url}/object/upload/sign/${_path}`, {}, { headers });\n                const url = new URL(this.url + data.url);\n                const token = url.searchParams.get('token');\n                if (!token) {\n                    throw new StorageError('No token returned by API');\n                }\n                return { data: { signedUrl: url.toString(), path, token }, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Replaces an existing file at the specified path with a new one.\n     *\n     * @param path The relative file path. Should be of the format `folder/subfolder/filename.png`. The bucket must already exist before attempting to update.\n     * @param fileBody The body of the file to be stored in the bucket.\n     */\n    update(path, fileBody, fileOptions) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.uploadOrUpdate('PUT', path, fileBody, fileOptions);\n        });\n    }\n    /**\n     * Moves an existing file to a new path in the same bucket.\n     *\n     * @param fromPath The original file path, including the current file name. For example `folder/image.png`.\n     * @param toPath The new file path, including the new file name. For example `folder/image-new.png`.\n     * @param options The destination options.\n     */\n    move(fromPath, toPath, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield post(this.fetch, `${this.url}/object/move`, {\n                    bucketId: this.bucketId,\n                    sourceKey: fromPath,\n                    destinationKey: toPath,\n                    destinationBucket: options === null || options === void 0 ? void 0 : options.destinationBucket,\n                }, { headers: this.headers });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Copies an existing file to a new path in the same bucket.\n     *\n     * @param fromPath The original file path, including the current file name. For example `folder/image.png`.\n     * @param toPath The new file path, including the new file name. For example `folder/image-copy.png`.\n     * @param options The destination options.\n     */\n    copy(fromPath, toPath, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield post(this.fetch, `${this.url}/object/copy`, {\n                    bucketId: this.bucketId,\n                    sourceKey: fromPath,\n                    destinationKey: toPath,\n                    destinationBucket: options === null || options === void 0 ? void 0 : options.destinationBucket,\n                }, { headers: this.headers });\n                return { data: { path: data.Key }, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Creates a signed URL. Use a signed URL to share a file for a fixed amount of time.\n     *\n     * @param path The file path, including the current file name. For example `folder/image.png`.\n     * @param expiresIn The number of seconds until the signed URL expires. For example, `60` for a URL which is valid for one minute.\n     * @param options.download triggers the file as a download if set to true. Set this parameter as the name of the file if you want to trigger the download with a different filename.\n     * @param options.transform Transform the asset before serving it to the client.\n     */\n    createSignedUrl(path, expiresIn, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                let _path = this._getFinalPath(path);\n                let data = yield post(this.fetch, `${this.url}/object/sign/${_path}`, Object.assign({ expiresIn }, ((options === null || options === void 0 ? void 0 : options.transform) ? { transform: options.transform } : {})), { headers: this.headers });\n                const downloadQueryParam = (options === null || options === void 0 ? void 0 : options.download)\n                    ? `&download=${options.download === true ? '' : options.download}`\n                    : '';\n                const signedUrl = encodeURI(`${this.url}${data.signedURL}${downloadQueryParam}`);\n                data = { signedUrl };\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Creates multiple signed URLs. Use a signed URL to share a file for a fixed amount of time.\n     *\n     * @param paths The file paths to be downloaded, including the current file names. For example `['folder/image.png', 'folder2/image2.png']`.\n     * @param expiresIn The number of seconds until the signed URLs expire. For example, `60` for URLs which are valid for one minute.\n     * @param options.download triggers the file as a download if set to true. Set this parameter as the name of the file if you want to trigger the download with a different filename.\n     */\n    createSignedUrls(paths, expiresIn, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield post(this.fetch, `${this.url}/object/sign/${this.bucketId}`, { expiresIn, paths }, { headers: this.headers });\n                const downloadQueryParam = (options === null || options === void 0 ? void 0 : options.download)\n                    ? `&download=${options.download === true ? '' : options.download}`\n                    : '';\n                return {\n                    data: data.map((datum) => (Object.assign(Object.assign({}, datum), { signedUrl: datum.signedURL\n                            ? encodeURI(`${this.url}${datum.signedURL}${downloadQueryParam}`)\n                            : null }))),\n                    error: null,\n                };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Downloads a file from a private bucket. For public buckets, make a request to the URL returned from `getPublicUrl` instead.\n     *\n     * @param path The full path and file name of the file to be downloaded. For example `folder/image.png`.\n     * @param options.transform Transform the asset before serving it to the client.\n     */\n    download(path, options) {\n        const wantsTransformation = typeof (options === null || options === void 0 ? void 0 : options.transform) !== 'undefined';\n        const renderPath = wantsTransformation ? 'render/image/authenticated' : 'object';\n        const transformationQuery = this.transformOptsToQueryString((options === null || options === void 0 ? void 0 : options.transform) || {});\n        const queryString = transformationQuery ? `?${transformationQuery}` : '';\n        const _path = this._getFinalPath(path);\n        const downloadFn = () => get(this.fetch, `${this.url}/${renderPath}/${_path}${queryString}`, {\n            headers: this.headers,\n            noResolveJson: true,\n        });\n        return new BlobDownloadBuilder(downloadFn, this.shouldThrowOnError);\n    }\n    /**\n     * Retrieves the details of an existing file.\n     * @param path\n     */\n    info(path) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const _path = this._getFinalPath(path);\n            try {\n                const data = yield get(this.fetch, `${this.url}/object/info/${_path}`, {\n                    headers: this.headers,\n                });\n                return { data: recursiveToCamel(data), error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Checks the existence of a file.\n     * @param path\n     */\n    exists(path) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const _path = this._getFinalPath(path);\n            try {\n                yield head(this.fetch, `${this.url}/object/${_path}`, {\n                    headers: this.headers,\n                });\n                return { data: true, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error) && error instanceof StorageUnknownError) {\n                    const originalError = error.originalError;\n                    if ([400, 404].includes(originalError === null || originalError === void 0 ? void 0 : originalError.status)) {\n                        return { data: false, error };\n                    }\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * A simple convenience function to get the URL for an asset in a public bucket. If you do not want to use this function, you can construct the public URL by concatenating the bucket URL with the path to the asset.\n     * This function does not verify if the bucket is public. If a public URL is created for a bucket which is not public, you will not be able to download the asset.\n     *\n     * @param path The path and name of the file to generate the public URL for. For example `folder/image.png`.\n     * @param options.download Triggers the file as a download if set to true. Set this parameter as the name of the file if you want to trigger the download with a different filename.\n     * @param options.transform Transform the asset before serving it to the client.\n     */\n    getPublicUrl(path, options) {\n        const _path = this._getFinalPath(path);\n        const _queryString = [];\n        const downloadQueryParam = (options === null || options === void 0 ? void 0 : options.download)\n            ? `download=${options.download === true ? '' : options.download}`\n            : '';\n        if (downloadQueryParam !== '') {\n            _queryString.push(downloadQueryParam);\n        }\n        const wantsTransformation = typeof (options === null || options === void 0 ? void 0 : options.transform) !== 'undefined';\n        const renderPath = wantsTransformation ? 'render/image' : 'object';\n        const transformationQuery = this.transformOptsToQueryString((options === null || options === void 0 ? void 0 : options.transform) || {});\n        if (transformationQuery !== '') {\n            _queryString.push(transformationQuery);\n        }\n        let queryString = _queryString.join('&');\n        if (queryString !== '') {\n            queryString = `?${queryString}`;\n        }\n        return {\n            data: { publicUrl: encodeURI(`${this.url}/${renderPath}/public/${_path}${queryString}`) },\n        };\n    }\n    /**\n     * Deletes files within the same bucket\n     *\n     * @param paths An array of files to delete, including the path and file name. For example [`'folder/image.png'`].\n     */\n    remove(paths) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield remove(this.fetch, `${this.url}/object/${this.bucketId}`, { prefixes: paths }, { headers: this.headers });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Get file metadata\n     * @param id the file id to retrieve metadata\n     */\n    // async getMetadata(\n    //   id: string\n    // ): Promise<\n    //   | {\n    //       data: Metadata\n    //       error: null\n    //     }\n    //   | {\n    //       data: null\n    //       error: StorageError\n    //     }\n    // > {\n    //   try {\n    //     const data = await get(this.fetch, `${this.url}/metadata/${id}`, { headers: this.headers })\n    //     return { data, error: null }\n    //   } catch (error) {\n    //     if (isStorageError(error)) {\n    //       return { data: null, error }\n    //     }\n    //     throw error\n    //   }\n    // }\n    /**\n     * Update file metadata\n     * @param id the file id to update metadata\n     * @param meta the new file metadata\n     */\n    // async updateMetadata(\n    //   id: string,\n    //   meta: Metadata\n    // ): Promise<\n    //   | {\n    //       data: Metadata\n    //       error: null\n    //     }\n    //   | {\n    //       data: null\n    //       error: StorageError\n    //     }\n    // > {\n    //   try {\n    //     const data = await post(\n    //       this.fetch,\n    //       `${this.url}/metadata/${id}`,\n    //       { ...meta },\n    //       { headers: this.headers }\n    //     )\n    //     return { data, error: null }\n    //   } catch (error) {\n    //     if (isStorageError(error)) {\n    //       return { data: null, error }\n    //     }\n    //     throw error\n    //   }\n    // }\n    /**\n     * Lists all the files and folders within a path of the bucket.\n     * @param path The folder path.\n     * @param options Search options including limit (defaults to 100), offset, sortBy, and search\n     */\n    list(path, options, parameters) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const body = Object.assign(Object.assign(Object.assign({}, DEFAULT_SEARCH_OPTIONS), options), { prefix: path || '' });\n                const data = yield post(this.fetch, `${this.url}/object/list/${this.bucketId}`, body, { headers: this.headers }, parameters);\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * @experimental this method signature might change in the future\n     * @param options search options\n     * @param parameters\n     */\n    listV2(options, parameters) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const body = Object.assign({}, options);\n                const data = yield post(this.fetch, `${this.url}/object/list-v2/${this.bucketId}`, body, { headers: this.headers }, parameters);\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    encodeMetadata(metadata) {\n        return JSON.stringify(metadata);\n    }\n    toBase64(data) {\n        if (typeof Buffer !== 'undefined') {\n            return Buffer.from(data).toString('base64');\n        }\n        return btoa(data);\n    }\n    _getFinalPath(path) {\n        return `${this.bucketId}/${path.replace(/^\\/+/, '')}`;\n    }\n    _removeEmptyFolders(path) {\n        return path.replace(/^\\/|\\/$/g, '').replace(/\\/+/g, '/');\n    }\n    transformOptsToQueryString(transform) {\n        const params = [];\n        if (transform.width) {\n            params.push(`width=${transform.width}`);\n        }\n        if (transform.height) {\n            params.push(`height=${transform.height}`);\n        }\n        if (transform.resize) {\n            params.push(`resize=${transform.resize}`);\n        }\n        if (transform.format) {\n            params.push(`format=${transform.format}`);\n        }\n        if (transform.quality) {\n            params.push(`quality=${transform.quality}`);\n        }\n        return params.join('&');\n    }\n}\n//# sourceMappingURL=StorageFileApi.js.map","// Generated automatically during releases by scripts/update-version-files.ts\n// This file provides runtime access to the package version for:\n// - HTTP request headers (e.g., X-Client-Info header for API requests)\n// - Debugging and support (identifying which version is running)\n// - Telemetry and logging (version reporting in errors/analytics)\n// - Ensuring build artifacts match the published package version\nexport const version = '2.80.0';\n//# sourceMappingURL=version.js.map","import { version } from './version';\nexport const DEFAULT_HEADERS = {\n    'X-Client-Info': `storage-js/${version}`,\n};\n//# sourceMappingURL=constants.js.map","import { __awaiter } from \"tslib\";\nimport { DEFAULT_HEADERS } from '../lib/constants';\nimport { isStorageError } from '../lib/errors';\nimport { get, post, put, remove } from '../lib/fetch';\nimport { resolveFetch } from '../lib/helpers';\nexport default class StorageBucketApi {\n    constructor(url, headers = {}, fetch, opts) {\n        this.shouldThrowOnError = false;\n        const baseUrl = new URL(url);\n        // if legacy uri is used, replace with new storage host (disables request buffering to allow > 50GB uploads)\n        // \"project-ref.supabase.co\" becomes \"project-ref.storage.supabase.co\"\n        if (opts === null || opts === void 0 ? void 0 : opts.useNewHostname) {\n            const isSupabaseHost = /supabase\\.(co|in|red)$/.test(baseUrl.hostname);\n            if (isSupabaseHost && !baseUrl.hostname.includes('storage.supabase.')) {\n                baseUrl.hostname = baseUrl.hostname.replace('supabase.', 'storage.supabase.');\n            }\n        }\n        this.url = baseUrl.href.replace(/\\/$/, '');\n        this.headers = Object.assign(Object.assign({}, DEFAULT_HEADERS), headers);\n        this.fetch = resolveFetch(fetch);\n    }\n    /**\n     * Enable throwing errors instead of returning them.\n     */\n    throwOnError() {\n        this.shouldThrowOnError = true;\n        return this;\n    }\n    /**\n     * Retrieves the details of all Storage buckets within an existing project.\n     */\n    listBuckets(options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const queryString = this.listBucketOptionsToQueryString(options);\n                const data = yield get(this.fetch, `${this.url}/bucket${queryString}`, {\n                    headers: this.headers,\n                });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Retrieves the details of an existing Storage bucket.\n     *\n     * @param id The unique identifier of the bucket you would like to retrieve.\n     */\n    getBucket(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield get(this.fetch, `${this.url}/bucket/${id}`, { headers: this.headers });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Creates a new Storage bucket\n     *\n     * @param id A unique identifier for the bucket you are creating.\n     * @param options.public The visibility of the bucket. Public buckets don't require an authorization token to download objects, but still require a valid token for all other operations. By default, buckets are private.\n     * @param options.fileSizeLimit specifies the max file size in bytes that can be uploaded to this bucket.\n     * The global file size limit takes precedence over this value.\n     * The default value is null, which doesn't set a per bucket file size limit.\n     * @param options.allowedMimeTypes specifies the allowed mime types that this bucket can accept during upload.\n     * The default value is null, which allows files with all mime types to be uploaded.\n     * Each mime type specified can be a wildcard, e.g. image/*, or a specific mime type, e.g. image/png.\n     * @returns newly created bucket id\n     * @param options.type (private-beta) specifies the bucket type. see `BucketType` for more details.\n     *   - default bucket type is `STANDARD`\n     */\n    createBucket(id_1) {\n        return __awaiter(this, arguments, void 0, function* (id, options = {\n            public: false,\n        }) {\n            try {\n                const data = yield post(this.fetch, `${this.url}/bucket`, {\n                    id,\n                    name: id,\n                    type: options.type,\n                    public: options.public,\n                    file_size_limit: options.fileSizeLimit,\n                    allowed_mime_types: options.allowedMimeTypes,\n                }, { headers: this.headers });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Updates a Storage bucket\n     *\n     * @param id A unique identifier for the bucket you are updating.\n     * @param options.public The visibility of the bucket. Public buckets don't require an authorization token to download objects, but still require a valid token for all other operations.\n     * @param options.fileSizeLimit specifies the max file size in bytes that can be uploaded to this bucket.\n     * The global file size limit takes precedence over this value.\n     * The default value is null, which doesn't set a per bucket file size limit.\n     * @param options.allowedMimeTypes specifies the allowed mime types that this bucket can accept during upload.\n     * The default value is null, which allows files with all mime types to be uploaded.\n     * Each mime type specified can be a wildcard, e.g. image/*, or a specific mime type, e.g. image/png.\n     */\n    updateBucket(id, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield put(this.fetch, `${this.url}/bucket/${id}`, {\n                    id,\n                    name: id,\n                    public: options.public,\n                    file_size_limit: options.fileSizeLimit,\n                    allowed_mime_types: options.allowedMimeTypes,\n                }, { headers: this.headers });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Removes all objects inside a single bucket.\n     *\n     * @param id The unique identifier of the bucket you would like to empty.\n     */\n    emptyBucket(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield post(this.fetch, `${this.url}/bucket/${id}/empty`, {}, { headers: this.headers });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Deletes an existing bucket. A bucket can't be deleted with existing objects inside it.\n     * You must first `empty()` the bucket.\n     *\n     * @param id The unique identifier of the bucket you would like to delete.\n     */\n    deleteBucket(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield remove(this.fetch, `${this.url}/bucket/${id}`, {}, { headers: this.headers });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    listBucketOptionsToQueryString(options) {\n        const params = {};\n        if (options) {\n            if ('limit' in options) {\n                params.limit = String(options.limit);\n            }\n            if ('offset' in options) {\n                params.offset = String(options.offset);\n            }\n            if (options.search) {\n                params.search = options.search;\n            }\n            if (options.sortColumn) {\n                params.sortColumn = options.sortColumn;\n            }\n            if (options.sortOrder) {\n                params.sortOrder = options.sortOrder;\n            }\n        }\n        return Object.keys(params).length > 0 ? '?' + new URLSearchParams(params).toString() : '';\n    }\n}\n//# sourceMappingURL=StorageBucketApi.js.map","import { __awaiter } from \"tslib\";\nimport { DEFAULT_HEADERS } from '../lib/constants';\nimport { isStorageError } from '../lib/errors';\nimport { get, post, remove } from '../lib/fetch';\nimport { resolveFetch } from '../lib/helpers';\n/**\n * API class for managing Analytics Buckets using Iceberg tables\n * Provides methods for creating, listing, and deleting analytics buckets\n */\nexport default class StorageAnalyticsApi {\n    /**\n     * Creates a new StorageAnalyticsApi instance\n     * @param url - The base URL for the storage API\n     * @param headers - HTTP headers to include in requests\n     * @param fetch - Optional custom fetch implementation\n     */\n    constructor(url, headers = {}, fetch) {\n        this.shouldThrowOnError = false;\n        this.url = url.replace(/\\/$/, '');\n        this.headers = Object.assign(Object.assign({}, DEFAULT_HEADERS), headers);\n        this.fetch = resolveFetch(fetch);\n    }\n    /**\n     * Enable throwing errors instead of returning them in the response\n     * When enabled, failed operations will throw instead of returning { data: null, error }\n     *\n     * @returns This instance for method chaining\n     */\n    throwOnError() {\n        this.shouldThrowOnError = true;\n        return this;\n    }\n    /**\n     * Creates a new analytics bucket using Iceberg tables\n     * Analytics buckets are optimized for analytical queries and data processing\n     *\n     * @param name A unique name for the bucket you are creating\n     * @returns Promise with newly created bucket name or error\n     *\n     * @example\n     * ```typescript\n     * const { data, error } = await storage.analytics.createBucket('analytics-data')\n     * if (error) {\n     *   console.error('Failed to create analytics bucket:', error.message)\n     * } else {\n     *   console.log('Created bucket:', data.name)\n     * }\n     * ```\n     */\n    createBucket(name) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield post(this.fetch, `${this.url}/bucket`, { name }, { headers: this.headers });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Retrieves the details of all Analytics Storage buckets within an existing project\n     * Only returns buckets of type 'ANALYTICS'\n     *\n     * @param options Query parameters for listing buckets\n     * @param options.limit Maximum number of buckets to return\n     * @param options.offset Number of buckets to skip\n     * @param options.sortColumn Column to sort by ('id', 'name', 'created_at', 'updated_at')\n     * @param options.sortOrder Sort order ('asc' or 'desc')\n     * @param options.search Search term to filter bucket names\n     * @returns Promise with list of analytics buckets or error\n     *\n     * @example\n     * ```typescript\n     * const { data, error } = await storage.analytics.listBuckets({\n     *   limit: 10,\n     *   offset: 0,\n     *   sortColumn: 'created_at',\n     *   sortOrder: 'desc',\n     *   search: 'analytics'\n     * })\n     * if (data) {\n     *   console.log('Found analytics buckets:', data.length)\n     *   data.forEach(bucket => console.log(`- ${bucket.name}`))\n     * }\n     * ```\n     */\n    listBuckets(options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                // Build query string from options\n                const queryParams = new URLSearchParams();\n                if ((options === null || options === void 0 ? void 0 : options.limit) !== undefined)\n                    queryParams.set('limit', options.limit.toString());\n                if ((options === null || options === void 0 ? void 0 : options.offset) !== undefined)\n                    queryParams.set('offset', options.offset.toString());\n                if (options === null || options === void 0 ? void 0 : options.sortColumn)\n                    queryParams.set('sortColumn', options.sortColumn);\n                if (options === null || options === void 0 ? void 0 : options.sortOrder)\n                    queryParams.set('sortOrder', options.sortOrder);\n                if (options === null || options === void 0 ? void 0 : options.search)\n                    queryParams.set('search', options.search);\n                const queryString = queryParams.toString();\n                const url = queryString ? `${this.url}/bucket?${queryString}` : `${this.url}/bucket`;\n                const data = yield get(this.fetch, url, { headers: this.headers });\n                return { data: data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Deletes an existing analytics bucket\n     * A bucket can't be deleted with existing objects inside it\n     * You must first empty the bucket before deletion\n     *\n     * @param bucketId The unique identifier of the bucket you would like to delete\n     * @returns Promise with success message or error\n     *\n     * @example\n     * ```typescript\n     * const { data, error } = await analyticsApi.deleteBucket('old-analytics-bucket')\n     * if (error) {\n     *   console.error('Failed to delete bucket:', error.message)\n     * } else {\n     *   console.log('Bucket deleted successfully:', data.message)\n     * }\n     * ```\n     */\n    deleteBucket(bucketId) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield remove(this.fetch, `${this.url}/bucket/${bucketId}`, {}, { headers: this.headers });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n}\n//# sourceMappingURL=StorageAnalyticsApi.js.map","import { version } from '../version';\nexport const DEFAULT_HEADERS = {\n    'X-Client-Info': `storage-js/${version}`,\n    'Content-Type': 'application/json',\n};\n//# sourceMappingURL=constants.js.map","/**\n * Base error class for all Storage Vectors errors\n */\nexport class StorageVectorsError extends Error {\n    constructor(message) {\n        super(message);\n        this.__isStorageVectorsError = true;\n        this.name = 'StorageVectorsError';\n    }\n}\n/**\n * Type guard to check if an error is a StorageVectorsError\n * @param error - The error to check\n * @returns True if the error is a StorageVectorsError\n */\nexport function isStorageVectorsError(error) {\n    return typeof error === 'object' && error !== null && '__isStorageVectorsError' in error;\n}\n/**\n * API error returned from S3 Vectors service\n * Includes HTTP status code and service-specific error code\n */\nexport class StorageVectorsApiError extends StorageVectorsError {\n    constructor(message, status, statusCode) {\n        super(message);\n        this.name = 'StorageVectorsApiError';\n        this.status = status;\n        this.statusCode = statusCode;\n    }\n    toJSON() {\n        return {\n            name: this.name,\n            message: this.message,\n            status: this.status,\n            statusCode: this.statusCode,\n        };\n    }\n}\n/**\n * Unknown error that doesn't match expected error patterns\n * Wraps the original error for debugging\n */\nexport class StorageVectorsUnknownError extends StorageVectorsError {\n    constructor(message, originalError) {\n        super(message);\n        this.name = 'StorageVectorsUnknownError';\n        this.originalError = originalError;\n    }\n}\n/**\n * Error codes specific to S3 Vectors API\n * Maps AWS service errors to application-friendly error codes\n */\nexport var StorageVectorsErrorCode;\n(function (StorageVectorsErrorCode) {\n    /** Internal server fault (HTTP 500) */\n    StorageVectorsErrorCode[\"InternalError\"] = \"InternalError\";\n    /** Resource already exists / conflict (HTTP 409) */\n    StorageVectorsErrorCode[\"S3VectorConflictException\"] = \"S3VectorConflictException\";\n    /** Resource not found (HTTP 404) */\n    StorageVectorsErrorCode[\"S3VectorNotFoundException\"] = \"S3VectorNotFoundException\";\n    /** Delete bucket while not empty (HTTP 400) */\n    StorageVectorsErrorCode[\"S3VectorBucketNotEmpty\"] = \"S3VectorBucketNotEmpty\";\n    /** Exceeds bucket quota/limit (HTTP 400) */\n    StorageVectorsErrorCode[\"S3VectorMaxBucketsExceeded\"] = \"S3VectorMaxBucketsExceeded\";\n    /** Exceeds index quota/limit (HTTP 400) */\n    StorageVectorsErrorCode[\"S3VectorMaxIndexesExceeded\"] = \"S3VectorMaxIndexesExceeded\";\n})(StorageVectorsErrorCode || (StorageVectorsErrorCode = {}));\n//# sourceMappingURL=errors.js.map","/**\n * Resolves the fetch implementation to use\n * Uses custom fetch if provided, otherwise uses native fetch\n *\n * @param customFetch - Optional custom fetch implementation\n * @returns Resolved fetch function\n */\nexport const resolveFetch = (customFetch) => {\n    if (customFetch) {\n        return (...args) => customFetch(...args);\n    }\n    return (...args) => fetch(...args);\n};\n/**\n * Resolves the Response constructor to use\n * Returns native Response constructor\n *\n * @returns Response constructor\n */\nexport const resolveResponse = () => {\n    return Response;\n};\n/**\n * Determine if input is a plain object\n * An object is plain if it's created by either {}, new Object(), or Object.create(null)\n *\n * @param value - Value to check\n * @returns True if value is a plain object\n * @source https://github.com/sindresorhus/is-plain-obj\n */\nexport const isPlainObject = (value) => {\n    if (typeof value !== 'object' || value === null) {\n        return false;\n    }\n    const prototype = Object.getPrototypeOf(value);\n    return ((prototype === null ||\n        prototype === Object.prototype ||\n        Object.getPrototypeOf(prototype) === null) &&\n        !(Symbol.toStringTag in value) &&\n        !(Symbol.iterator in value));\n};\n/**\n * Normalizes a number array to float32 format\n * Ensures all vector values are valid 32-bit floats\n *\n * @param values - Array of numbers to normalize\n * @returns Normalized float32 array\n */\nexport const normalizeToFloat32 = (values) => {\n    // Use Float32Array to ensure proper precision\n    return Array.from(new Float32Array(values));\n};\n/**\n * Validates vector dimensions match expected dimension\n * Throws error if dimensions don't match\n *\n * @param vector - Vector data to validate\n * @param expectedDimension - Expected vector dimension\n * @throws Error if dimensions don't match\n */\nexport const validateVectorDimension = (vector, expectedDimension) => {\n    if (expectedDimension !== undefined && vector.float32.length !== expectedDimension) {\n        throw new Error(`Vector dimension mismatch: expected ${expectedDimension}, got ${vector.float32.length}`);\n    }\n};\n//# sourceMappingURL=helpers.js.map","import { __awaiter } from \"tslib\";\nimport { StorageVectorsApiError, StorageVectorsUnknownError } from './errors';\nimport { isPlainObject } from './helpers';\n/**\n * Extracts error message from various error response formats\n * @param err - Error object from API\n * @returns Human-readable error message\n */\nconst _getErrorMessage = (err) => err.msg || err.message || err.error_description || err.error || JSON.stringify(err);\n/**\n * Handles fetch errors and converts them to StorageVectors error types\n * @param error - The error caught from fetch\n * @param reject - Promise rejection function\n * @param options - Fetch options that may affect error handling\n */\nconst handleError = (error, reject, options) => __awaiter(void 0, void 0, void 0, function* () {\n    // Check if error is a Response-like object (has status and ok properties)\n    // This is more reliable than instanceof which can fail across realms\n    const isResponseLike = error &&\n        typeof error === 'object' &&\n        'status' in error &&\n        'ok' in error &&\n        typeof error.status === 'number';\n    if (isResponseLike && !(options === null || options === void 0 ? void 0 : options.noResolveJson)) {\n        const status = error.status || 500;\n        const responseError = error;\n        // Try to parse JSON body if available\n        if (typeof responseError.json === 'function') {\n            responseError\n                .json()\n                .then((err) => {\n                const statusCode = (err === null || err === void 0 ? void 0 : err.statusCode) || (err === null || err === void 0 ? void 0 : err.code) || status + '';\n                reject(new StorageVectorsApiError(_getErrorMessage(err), status, statusCode));\n            })\n                .catch(() => {\n                // If JSON parsing fails, create an ApiError with the HTTP status code\n                const statusCode = status + '';\n                const message = responseError.statusText || `HTTP ${status} error`;\n                reject(new StorageVectorsApiError(message, status, statusCode));\n            });\n        }\n        else {\n            // No json() method available, create error from status\n            const statusCode = status + '';\n            const message = responseError.statusText || `HTTP ${status} error`;\n            reject(new StorageVectorsApiError(message, status, statusCode));\n        }\n    }\n    else {\n        reject(new StorageVectorsUnknownError(_getErrorMessage(error), error));\n    }\n});\n/**\n * Builds request parameters for fetch calls\n * @param method - HTTP method\n * @param options - Custom fetch options\n * @param parameters - Additional fetch parameters like AbortSignal\n * @param body - Request body (will be JSON stringified if plain object)\n * @returns Complete fetch request parameters\n */\nconst _getRequestParams = (method, options, parameters, body) => {\n    const params = { method, headers: (options === null || options === void 0 ? void 0 : options.headers) || {} };\n    if (method === 'GET' || !body) {\n        return params;\n    }\n    if (isPlainObject(body)) {\n        params.headers = Object.assign({ 'Content-Type': 'application/json' }, options === null || options === void 0 ? void 0 : options.headers);\n        params.body = JSON.stringify(body);\n    }\n    else {\n        params.body = body;\n    }\n    return Object.assign(Object.assign({}, params), parameters);\n};\n/**\n * Internal request handler that wraps fetch with error handling\n * @param fetcher - Fetch function to use\n * @param method - HTTP method\n * @param url - Request URL\n * @param options - Custom fetch options\n * @param parameters - Additional fetch parameters\n * @param body - Request body\n * @returns Promise with parsed response or error\n */\nfunction _handleRequest(fetcher, method, url, options, parameters, body) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return new Promise((resolve, reject) => {\n            fetcher(url, _getRequestParams(method, options, parameters, body))\n                .then((result) => {\n                if (!result.ok)\n                    throw result;\n                if (options === null || options === void 0 ? void 0 : options.noResolveJson)\n                    return result;\n                // Handle empty responses (204, empty body)\n                const contentType = result.headers.get('content-type');\n                if (!contentType || !contentType.includes('application/json')) {\n                    return {};\n                }\n                return result.json();\n            })\n                .then((data) => resolve(data))\n                .catch((error) => handleError(error, reject, options));\n        });\n    });\n}\n/**\n * Performs a GET request\n * @param fetcher - Fetch function to use\n * @param url - Request URL\n * @param options - Custom fetch options\n * @param parameters - Additional fetch parameters\n * @returns Promise with parsed response\n */\nexport function get(fetcher, url, options, parameters) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return _handleRequest(fetcher, 'GET', url, options, parameters);\n    });\n}\n/**\n * Performs a POST request\n * @param fetcher - Fetch function to use\n * @param url - Request URL\n * @param body - Request body to be JSON stringified\n * @param options - Custom fetch options\n * @param parameters - Additional fetch parameters\n * @returns Promise with parsed response\n */\nexport function post(fetcher, url, body, options, parameters) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return _handleRequest(fetcher, 'POST', url, options, parameters, body);\n    });\n}\n/**\n * Performs a PUT request\n * @param fetcher - Fetch function to use\n * @param url - Request URL\n * @param body - Request body to be JSON stringified\n * @param options - Custom fetch options\n * @param parameters - Additional fetch parameters\n * @returns Promise with parsed response\n */\nexport function put(fetcher, url, body, options, parameters) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return _handleRequest(fetcher, 'PUT', url, options, parameters, body);\n    });\n}\n/**\n * Performs a DELETE request\n * @param fetcher - Fetch function to use\n * @param url - Request URL\n * @param body - Request body to be JSON stringified\n * @param options - Custom fetch options\n * @param parameters - Additional fetch parameters\n * @returns Promise with parsed response\n */\nexport function remove(fetcher, url, body, options, parameters) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return _handleRequest(fetcher, 'DELETE', url, options, parameters, body);\n    });\n}\n//# sourceMappingURL=fetch.js.map","import { __awaiter } from \"tslib\";\nimport { DEFAULT_HEADERS } from './constants';\nimport { isStorageVectorsError } from './errors';\nimport { post } from './fetch';\nimport { resolveFetch } from './helpers';\n/**\n * API class for managing Vector Indexes within Vector Buckets\n * Provides methods for creating, reading, listing, and deleting vector indexes\n */\nexport default class VectorIndexApi {\n    constructor(url, headers = {}, fetch) {\n        this.shouldThrowOnError = false;\n        this.url = url.replace(/\\/$/, '');\n        this.headers = Object.assign(Object.assign({}, DEFAULT_HEADERS), headers);\n        this.fetch = resolveFetch(fetch);\n    }\n    /**\n     * Enable throwing errors instead of returning them in the response\n     * When enabled, failed operations will throw instead of returning { data: null, error }\n     *\n     * @returns This instance for method chaining\n     * @example\n     * ```typescript\n     * const client = new VectorIndexApi(url, headers)\n     * client.throwOnError()\n     * const { data } = await client.createIndex(options) // throws on error\n     * ```\n     */\n    throwOnError() {\n        this.shouldThrowOnError = true;\n        return this;\n    }\n    /**\n     * Creates a new vector index within a bucket\n     * Defines the schema for vectors including dimensionality, distance metric, and metadata config\n     *\n     * @param options - Index configuration\n     * @param options.vectorBucketName - Name of the parent vector bucket\n     * @param options.indexName - Unique name for the index within the bucket\n     * @param options.dataType - Data type for vector components (currently only 'float32')\n     * @param options.dimension - Dimensionality of vectors (e.g., 384, 768, 1536)\n     * @param options.distanceMetric - Similarity metric ('cosine', 'euclidean', 'dotproduct')\n     * @param options.metadataConfiguration - Optional config for non-filterable metadata keys\n     * @returns Promise with empty response on success or error\n     *\n     * @throws {StorageVectorsApiError} With code:\n     * - `S3VectorConflictException` if index already exists (HTTP 409)\n     * - `S3VectorMaxIndexesExceeded` if quota exceeded (HTTP 400)\n     * - `S3VectorNotFoundException` if bucket doesn't exist (HTTP 404)\n     * - `InternalError` for server errors (HTTP 500)\n     *\n     * @example\n     * ```typescript\n     * const { data, error } = await client.createIndex({\n     *   vectorBucketName: 'embeddings-prod',\n     *   indexName: 'documents-openai-small',\n     *   dataType: 'float32',\n     *   dimension: 1536,\n     *   distanceMetric: 'cosine',\n     *   metadataConfiguration: {\n     *     nonFilterableMetadataKeys: ['raw_text', 'internal_id']\n     *   }\n     * })\n     * ```\n     */\n    createIndex(options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield post(this.fetch, `${this.url}/CreateIndex`, options, {\n                    headers: this.headers,\n                });\n                return { data: data || {}, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageVectorsError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Retrieves metadata for a specific vector index\n     * Returns index configuration including dimension, distance metric, and metadata settings\n     *\n     * @param vectorBucketName - Name of the parent vector bucket\n     * @param indexName - Name of the index to retrieve\n     * @returns Promise with index metadata or error\n     *\n     * @throws {StorageVectorsApiError} With code:\n     * - `S3VectorNotFoundException` if index or bucket doesn't exist (HTTP 404)\n     * - `InternalError` for server errors (HTTP 500)\n     *\n     * @example\n     * ```typescript\n     * const { data, error } = await client.getIndex('embeddings-prod', 'documents-openai-small')\n     * if (data) {\n     *   console.log('Index dimension:', data.index.dimension)\n     *   console.log('Distance metric:', data.index.distanceMetric)\n     * }\n     * ```\n     */\n    getIndex(vectorBucketName, indexName) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield post(this.fetch, `${this.url}/GetIndex`, { vectorBucketName, indexName }, { headers: this.headers });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageVectorsError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Lists vector indexes within a bucket with optional filtering and pagination\n     * Supports prefix-based filtering and paginated results\n     *\n     * @param options - Listing options\n     * @param options.vectorBucketName - Name of the parent vector bucket\n     * @param options.prefix - Filter indexes by name prefix\n     * @param options.maxResults - Maximum results per page (default: 100)\n     * @param options.nextToken - Pagination token from previous response\n     * @returns Promise with list of indexes and pagination token\n     *\n     * @throws {StorageVectorsApiError} With code:\n     * - `S3VectorNotFoundException` if bucket doesn't exist (HTTP 404)\n     * - `InternalError` for server errors (HTTP 500)\n     *\n     * @example\n     * ```typescript\n     * // List all indexes in a bucket\n     * const { data, error } = await client.listIndexes({\n     *   vectorBucketName: 'embeddings-prod',\n     *   prefix: 'documents-'\n     * })\n     * if (data) {\n     *   console.log('Found indexes:', data.indexes.map(i => i.indexName))\n     *   // Fetch next page if available\n     *   if (data.nextToken) {\n     *     const next = await client.listIndexes({\n     *       vectorBucketName: 'embeddings-prod',\n     *       nextToken: data.nextToken\n     *     })\n     *   }\n     * }\n     * ```\n     */\n    listIndexes(options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield post(this.fetch, `${this.url}/ListIndexes`, options, {\n                    headers: this.headers,\n                });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageVectorsError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Deletes a vector index and all its data\n     * This operation removes the index schema and all vectors stored in the index\n     *\n     * @param vectorBucketName - Name of the parent vector bucket\n     * @param indexName - Name of the index to delete\n     * @returns Promise with empty response on success or error\n     *\n     * @throws {StorageVectorsApiError} With code:\n     * - `S3VectorNotFoundException` if index or bucket doesn't exist (HTTP 404)\n     * - `InternalError` for server errors (HTTP 500)\n     *\n     * @example\n     * ```typescript\n     * // Delete an index and all its vectors\n     * const { error } = await client.deleteIndex('embeddings-prod', 'old-index')\n     * if (!error) {\n     *   console.log('Index deleted successfully')\n     * }\n     * ```\n     */\n    deleteIndex(vectorBucketName, indexName) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield post(this.fetch, `${this.url}/DeleteIndex`, { vectorBucketName, indexName }, { headers: this.headers });\n                return { data: data || {}, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageVectorsError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n}\n//# sourceMappingURL=VectorIndexApi.js.map","import { __awaiter } from \"tslib\";\nimport { DEFAULT_HEADERS } from './constants';\nimport { isStorageVectorsError } from './errors';\nimport { post } from './fetch';\nimport { resolveFetch } from './helpers';\n/**\n * API class for managing Vector Data within Vector Indexes\n * Provides methods for inserting, querying, listing, and deleting vector embeddings\n */\nexport default class VectorDataApi {\n    constructor(url, headers = {}, fetch) {\n        this.shouldThrowOnError = false;\n        this.url = url.replace(/\\/$/, '');\n        this.headers = Object.assign(Object.assign({}, DEFAULT_HEADERS), headers);\n        this.fetch = resolveFetch(fetch);\n    }\n    /**\n     * Enable throwing errors instead of returning them in the response\n     * When enabled, failed operations will throw instead of returning { data: null, error }\n     *\n     * @returns This instance for method chaining\n     * @example\n     * ```typescript\n     * const client = new VectorDataApi(url, headers)\n     * client.throwOnError()\n     * const { data } = await client.putVectors(options) // throws on error\n     * ```\n     */\n    throwOnError() {\n        this.shouldThrowOnError = true;\n        return this;\n    }\n    /**\n     * Inserts or updates vectors in batch (upsert operation)\n     * Accepts 1-500 vectors per request. Larger batches should be split\n     *\n     * @param options - Vector insertion options\n     * @param options.vectorBucketName - Name of the parent vector bucket\n     * @param options.indexName - Name of the target index\n     * @param options.vectors - Array of vectors to insert/update (1-500 items)\n     * @returns Promise with empty response on success or error\n     *\n     * @throws {StorageVectorsApiError} With code:\n     * - `S3VectorConflictException` if duplicate key conflict occurs (HTTP 409)\n     * - `S3VectorNotFoundException` if bucket or index doesn't exist (HTTP 404)\n     * - `InternalError` for server errors (HTTP 500)\n     *\n     * @example\n     * ```typescript\n     * const { data, error } = await client.putVectors({\n     *   vectorBucketName: 'embeddings-prod',\n     *   indexName: 'documents-openai-small',\n     *   vectors: [\n     *     {\n     *       key: 'doc-1',\n     *       data: { float32: [0.1, 0.2, 0.3, ...] }, // 1536 dimensions\n     *       metadata: { title: 'Introduction', page: 1 }\n     *     },\n     *     {\n     *       key: 'doc-2',\n     *       data: { float32: [0.4, 0.5, 0.6, ...] },\n     *       metadata: { title: 'Conclusion', page: 42 }\n     *     }\n     *   ]\n     * })\n     * ```\n     */\n    putVectors(options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                // Validate batch size\n                if (options.vectors.length < 1 || options.vectors.length > 500) {\n                    throw new Error('Vector batch size must be between 1 and 500 items');\n                }\n                const data = yield post(this.fetch, `${this.url}/PutVectors`, options, {\n                    headers: this.headers,\n                });\n                return { data: data || {}, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageVectorsError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Retrieves vectors by their keys in batch\n     * Optionally includes vector data and/or metadata in response\n     * Additional permissions required when returning data or metadata\n     *\n     * @param options - Vector retrieval options\n     * @param options.vectorBucketName - Name of the parent vector bucket\n     * @param options.indexName - Name of the index\n     * @param options.keys - Array of vector keys to retrieve\n     * @param options.returnData - Whether to include vector embeddings (requires permission)\n     * @param options.returnMetadata - Whether to include metadata (requires permission)\n     * @returns Promise with array of vectors or error\n     *\n     * @throws {StorageVectorsApiError} With code:\n     * - `S3VectorNotFoundException` if bucket or index doesn't exist (HTTP 404)\n     * - `InternalError` for server errors (HTTP 500)\n     *\n     * @example\n     * ```typescript\n     * const { data, error } = await client.getVectors({\n     *   vectorBucketName: 'embeddings-prod',\n     *   indexName: 'documents-openai-small',\n     *   keys: ['doc-1', 'doc-2', 'doc-3'],\n     *   returnData: false,     // Don't return embeddings\n     *   returnMetadata: true   // Return metadata only\n     * })\n     * if (data) {\n     *   data.vectors.forEach(v => console.log(v.key, v.metadata))\n     * }\n     * ```\n     */\n    getVectors(options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield post(this.fetch, `${this.url}/GetVectors`, options, {\n                    headers: this.headers,\n                });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageVectorsError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Lists/scans vectors in an index with pagination\n     * Supports parallel scanning via segment configuration for high-throughput scenarios\n     * Additional permissions required when returning data or metadata\n     *\n     * @param options - Vector listing options\n     * @param options.vectorBucketName - Name of the parent vector bucket\n     * @param options.indexName - Name of the index\n     * @param options.maxResults - Maximum results per page (default: 500, max: 1000)\n     * @param options.nextToken - Pagination token from previous response\n     * @param options.returnData - Whether to include vector embeddings (requires permission)\n     * @param options.returnMetadata - Whether to include metadata (requires permission)\n     * @param options.segmentCount - Total parallel segments (1-16) for distributed scanning\n     * @param options.segmentIndex - Zero-based segment index (0 to segmentCount-1)\n     * @returns Promise with array of vectors, pagination token, or error\n     *\n     * @throws {StorageVectorsApiError} With code:\n     * - `S3VectorNotFoundException` if bucket or index doesn't exist (HTTP 404)\n     * - `InternalError` for server errors (HTTP 500)\n     *\n     * @example\n     * ```typescript\n     * // Simple pagination\n     * let nextToken: string | undefined\n     * do {\n     *   const { data, error } = await client.listVectors({\n     *     vectorBucketName: 'embeddings-prod',\n     *     indexName: 'documents-openai-small',\n     *     maxResults: 500,\n     *     nextToken,\n     *     returnMetadata: true\n     *   })\n     *   if (error) break\n     *   console.log('Batch:', data.vectors.length)\n     *   nextToken = data.nextToken\n     * } while (nextToken)\n     *\n     * // Parallel scanning (4 concurrent workers)\n     * const workers = [0, 1, 2, 3].map(async (segmentIndex) => {\n     *   const { data } = await client.listVectors({\n     *     vectorBucketName: 'embeddings-prod',\n     *     indexName: 'documents-openai-small',\n     *     segmentCount: 4,\n     *     segmentIndex,\n     *     returnMetadata: true\n     *   })\n     *   return data?.vectors || []\n     * })\n     * const results = await Promise.all(workers)\n     * ```\n     */\n    listVectors(options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                // Validate segment configuration\n                if (options.segmentCount !== undefined) {\n                    if (options.segmentCount < 1 || options.segmentCount > 16) {\n                        throw new Error('segmentCount must be between 1 and 16');\n                    }\n                    if (options.segmentIndex !== undefined) {\n                        if (options.segmentIndex < 0 || options.segmentIndex >= options.segmentCount) {\n                            throw new Error(`segmentIndex must be between 0 and ${options.segmentCount - 1}`);\n                        }\n                    }\n                }\n                const data = yield post(this.fetch, `${this.url}/ListVectors`, options, {\n                    headers: this.headers,\n                });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageVectorsError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Queries for similar vectors using approximate nearest neighbor (ANN) search\n     * Returns top-K most similar vectors based on the configured distance metric\n     * Supports optional metadata filtering (requires GetVectors permission)\n     *\n     * @param options - Query options\n     * @param options.vectorBucketName - Name of the parent vector bucket\n     * @param options.indexName - Name of the index\n     * @param options.queryVector - Query embedding to find similar vectors\n     * @param options.topK - Number of nearest neighbors to return (default: 10)\n     * @param options.filter - Optional JSON filter for metadata (requires GetVectors permission)\n     * @param options.returnDistance - Whether to include similarity distances\n     * @param options.returnMetadata - Whether to include metadata (requires GetVectors permission)\n     * @returns Promise with array of similar vectors ordered by distance\n     *\n     * @throws {StorageVectorsApiError} With code:\n     * - `S3VectorNotFoundException` if bucket or index doesn't exist (HTTP 404)\n     * - `InternalError` for server errors (HTTP 500)\n     *\n     * @example\n     * ```typescript\n     * // Semantic search with filtering\n     * const { data, error } = await client.queryVectors({\n     *   vectorBucketName: 'embeddings-prod',\n     *   indexName: 'documents-openai-small',\n     *   queryVector: { float32: [0.1, 0.2, 0.3, ...] }, // 1536 dimensions\n     *   topK: 5,\n     *   filter: {\n     *     category: 'technical',\n     *     published: true\n     *   },\n     *   returnDistance: true,\n     *   returnMetadata: true\n     * })\n     * if (data) {\n     *   data.matches.forEach(match => {\n     *     console.log(`${match.key}: distance=${match.distance}`)\n     *     console.log('Metadata:', match.metadata)\n     *   })\n     * }\n     * ```\n     */\n    queryVectors(options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield post(this.fetch, `${this.url}/QueryVectors`, options, {\n                    headers: this.headers,\n                });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageVectorsError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Deletes vectors by their keys in batch\n     * Accepts 1-500 keys per request\n     *\n     * @param options - Vector deletion options\n     * @param options.vectorBucketName - Name of the parent vector bucket\n     * @param options.indexName - Name of the index\n     * @param options.keys - Array of vector keys to delete (1-500 items)\n     * @returns Promise with empty response on success or error\n     *\n     * @throws {StorageVectorsApiError} With code:\n     * - `S3VectorNotFoundException` if bucket or index doesn't exist (HTTP 404)\n     * - `InternalError` for server errors (HTTP 500)\n     *\n     * @example\n     * ```typescript\n     * const { error } = await client.deleteVectors({\n     *   vectorBucketName: 'embeddings-prod',\n     *   indexName: 'documents-openai-small',\n     *   keys: ['doc-1', 'doc-2', 'doc-3']\n     * })\n     * if (!error) {\n     *   console.log('Vectors deleted successfully')\n     * }\n     * ```\n     */\n    deleteVectors(options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                // Validate batch size\n                if (options.keys.length < 1 || options.keys.length > 500) {\n                    throw new Error('Keys batch size must be between 1 and 500 items');\n                }\n                const data = yield post(this.fetch, `${this.url}/DeleteVectors`, options, {\n                    headers: this.headers,\n                });\n                return { data: data || {}, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageVectorsError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n}\n//# sourceMappingURL=VectorDataApi.js.map","import { __awaiter } from \"tslib\";\nimport { DEFAULT_HEADERS } from './constants';\nimport { isStorageVectorsError } from './errors';\nimport { post } from './fetch';\nimport { resolveFetch } from './helpers';\n/**\n * API class for managing Vector Buckets\n * Provides methods for creating, reading, listing, and deleting vector buckets\n */\nexport default class VectorBucketApi {\n    /**\n     * Creates a new VectorBucketApi instance\n     * @param url - The base URL for the storage vectors API\n     * @param headers - HTTP headers to include in requests\n     * @param fetch - Optional custom fetch implementation\n     */\n    constructor(url, headers = {}, fetch) {\n        this.shouldThrowOnError = false;\n        this.url = url.replace(/\\/$/, '');\n        this.headers = Object.assign(Object.assign({}, DEFAULT_HEADERS), headers);\n        this.fetch = resolveFetch(fetch);\n    }\n    /**\n     * Enable throwing errors instead of returning them in the response\n     * When enabled, failed operations will throw instead of returning { data: null, error }\n     *\n     * @returns This instance for method chaining\n     * @example\n     * ```typescript\n     * const client = new VectorBucketApi(url, headers)\n     * client.throwOnError()\n     * const { data } = await client.createBucket('my-bucket') // throws on error\n     * ```\n     */\n    throwOnError() {\n        this.shouldThrowOnError = true;\n        return this;\n    }\n    /**\n     * Creates a new vector bucket\n     * Vector buckets are containers for vector indexes and their data\n     *\n     * @param vectorBucketName - Unique name for the vector bucket\n     * @returns Promise with empty response on success or error\n     *\n     * @throws {StorageVectorsApiError} With code:\n     * - `S3VectorConflictException` if bucket already exists (HTTP 409)\n     * - `S3VectorMaxBucketsExceeded` if quota exceeded (HTTP 400)\n     * - `InternalError` for server errors (HTTP 500)\n     *\n     * @example\n     * ```typescript\n     * const { data, error } = await client.createBucket('embeddings-prod')\n     * if (error) {\n     *   console.error('Failed to create bucket:', error.message)\n     * }\n     * ```\n     */\n    createBucket(vectorBucketName) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield post(this.fetch, `${this.url}/CreateVectorBucket`, { vectorBucketName }, { headers: this.headers });\n                return { data: data || {}, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageVectorsError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Retrieves metadata for a specific vector bucket\n     * Returns bucket configuration including encryption settings and creation time\n     *\n     * @param vectorBucketName - Name of the vector bucket to retrieve\n     * @returns Promise with bucket metadata or error\n     *\n     * @throws {StorageVectorsApiError} With code:\n     * - `S3VectorNotFoundException` if bucket doesn't exist (HTTP 404)\n     * - `InternalError` for server errors (HTTP 500)\n     *\n     * @example\n     * ```typescript\n     * const { data, error } = await client.getBucket('embeddings-prod')\n     * if (data) {\n     *   console.log('Bucket created at:', new Date(data.vectorBucket.creationTime! * 1000))\n     * }\n     * ```\n     */\n    getBucket(vectorBucketName) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield post(this.fetch, `${this.url}/GetVectorBucket`, { vectorBucketName }, { headers: this.headers });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageVectorsError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Lists vector buckets with optional filtering and pagination\n     * Supports prefix-based filtering and paginated results\n     *\n     * @param options - Listing options\n     * @param options.prefix - Filter buckets by name prefix\n     * @param options.maxResults - Maximum results per page (default: 100)\n     * @param options.nextToken - Pagination token from previous response\n     * @returns Promise with list of buckets and pagination token\n     *\n     * @throws {StorageVectorsApiError} With code:\n     * - `InternalError` for server errors (HTTP 500)\n     *\n     * @example\n     * ```typescript\n     * // List all buckets with prefix 'prod-'\n     * const { data, error } = await client.listBuckets({ prefix: 'prod-' })\n     * if (data) {\n     *   console.log('Found buckets:', data.buckets.length)\n     *   // Fetch next page if available\n     *   if (data.nextToken) {\n     *     const next = await client.listBuckets({ nextToken: data.nextToken })\n     *   }\n     * }\n     * ```\n     */\n    listBuckets() {\n        return __awaiter(this, arguments, void 0, function* (options = {}) {\n            try {\n                const data = yield post(this.fetch, `${this.url}/ListVectorBuckets`, options, {\n                    headers: this.headers,\n                });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageVectorsError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Deletes a vector bucket\n     * Bucket must be empty before deletion (all indexes must be removed first)\n     *\n     * @param vectorBucketName - Name of the vector bucket to delete\n     * @returns Promise with empty response on success or error\n     *\n     * @throws {StorageVectorsApiError} With code:\n     * - `S3VectorBucketNotEmpty` if bucket contains indexes (HTTP 400)\n     * - `S3VectorNotFoundException` if bucket doesn't exist (HTTP 404)\n     * - `InternalError` for server errors (HTTP 500)\n     *\n     * @example\n     * ```typescript\n     * // Delete all indexes first, then delete bucket\n     * const { error } = await client.deleteBucket('old-bucket')\n     * if (error?.statusCode === 'S3VectorBucketNotEmpty') {\n     *   console.error('Must delete all indexes first')\n     * }\n     * ```\n     */\n    deleteBucket(vectorBucketName) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield post(this.fetch, `${this.url}/DeleteVectorBucket`, { vectorBucketName }, { headers: this.headers });\n                return { data: data || {}, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageVectorsError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n}\n//# sourceMappingURL=VectorBucketApi.js.map","import { __awaiter } from \"tslib\";\nimport VectorIndexApi from './VectorIndexApi';\nimport VectorDataApi from './VectorDataApi';\nimport VectorBucketApi from './VectorBucketApi';\n/**\n * Main client for interacting with S3 Vectors API\n * Provides access to bucket, index, and vector data operations\n *\n * **Usage Patterns:**\n *\n * 1. **Via StorageClient (recommended for most use cases):**\n * ```typescript\n * import { StorageClient } from '@supabase/storage-js'\n *\n * const storageClient = new StorageClient(url, headers)\n * const vectors = storageClient.vectors\n *\n * // Use vector operations\n * await vectors.createBucket('embeddings-prod')\n * const bucket = vectors.from('embeddings-prod')\n * await bucket.createIndex({ ... })\n * ```\n *\n * 2. **Standalone (for vector-only applications):**\n * ```typescript\n * import { StorageVectorsClient } from '@supabase/storage-js'\n *\n * const vectorsClient = new StorageVectorsClient('https://api.example.com', {\n *   headers: { 'Authorization': 'Bearer token' }\n * })\n *\n * // Access bucket operations\n * await vectorsClient.createBucket('embeddings-prod')\n *\n * // Access index operations via buckets\n * const bucket = vectorsClient.from('embeddings-prod')\n * await bucket.createIndex({\n *   indexName: 'documents',\n *   dataType: 'float32',\n *   dimension: 1536,\n *   distanceMetric: 'cosine'\n * })\n *\n * // Access vector operations via index\n * const index = bucket.index('documents')\n * await index.putVectors({\n *   vectors: [\n *     { key: 'doc-1', data: { float32: [...] }, metadata: { title: 'Intro' } }\n *   ]\n * })\n *\n * // Query similar vectors\n * const { data } = await index.queryVectors({\n *   queryVector: { float32: [...] },\n *   topK: 5,\n *   returnDistance: true\n * })\n * ```\n */\nexport class StorageVectorsClient extends VectorBucketApi {\n    constructor(url, options = {}) {\n        super(url, options.headers || {}, options.fetch);\n    }\n    /**\n     * Access operations for a specific vector bucket\n     * Returns a scoped client for index and vector operations within the bucket\n     *\n     * @param vectorBucketName - Name of the vector bucket\n     * @returns Bucket-scoped client with index and vector operations\n     *\n     * @example\n     * ```typescript\n     * const bucket = client.bucket('embeddings-prod')\n     *\n     * // Create an index in this bucket\n     * await bucket.createIndex({\n     *   indexName: 'documents-openai',\n     *   dataType: 'float32',\n     *   dimension: 1536,\n     *   distanceMetric: 'cosine'\n     * })\n     *\n     * // List indexes in this bucket\n     * const { data } = await bucket.listIndexes()\n     * ```\n     */\n    from(vectorBucketName) {\n        return new VectorBucketScope(this.url, this.headers, vectorBucketName, this.fetch);\n    }\n}\n/**\n * Scoped client for operations within a specific vector bucket\n * Provides index management and access to vector operations\n */\nexport class VectorBucketScope extends VectorIndexApi {\n    constructor(url, headers, vectorBucketName, fetch) {\n        super(url, headers, fetch);\n        this.vectorBucketName = vectorBucketName;\n    }\n    /**\n     * Creates a new vector index in this bucket\n     * Convenience method that automatically includes the bucket name\n     *\n     * @param options - Index configuration (vectorBucketName is automatically set)\n     * @returns Promise with empty response on success or error\n     *\n     * @example\n     * ```typescript\n     * const bucket = client.bucket('embeddings-prod')\n     * await bucket.createIndex({\n     *   indexName: 'documents-openai',\n     *   dataType: 'float32',\n     *   dimension: 1536,\n     *   distanceMetric: 'cosine',\n     *   metadataConfiguration: {\n     *     nonFilterableMetadataKeys: ['raw_text']\n     *   }\n     * })\n     * ```\n     */\n    createIndex(options) {\n        const _super = Object.create(null, {\n            createIndex: { get: () => super.createIndex }\n        });\n        return __awaiter(this, void 0, void 0, function* () {\n            return _super.createIndex.call(this, Object.assign(Object.assign({}, options), { vectorBucketName: this.vectorBucketName }));\n        });\n    }\n    /**\n     * Lists indexes in this bucket\n     * Convenience method that automatically includes the bucket name\n     *\n     * @param options - Listing options (vectorBucketName is automatically set)\n     * @returns Promise with list of indexes or error\n     *\n     * @example\n     * ```typescript\n     * const bucket = client.bucket('embeddings-prod')\n     * const { data } = await bucket.listIndexes({ prefix: 'documents-' })\n     * ```\n     */\n    listIndexes() {\n        const _super = Object.create(null, {\n            listIndexes: { get: () => super.listIndexes }\n        });\n        return __awaiter(this, arguments, void 0, function* (options = {}) {\n            return _super.listIndexes.call(this, Object.assign(Object.assign({}, options), { vectorBucketName: this.vectorBucketName }));\n        });\n    }\n    /**\n     * Retrieves metadata for a specific index in this bucket\n     * Convenience method that automatically includes the bucket name\n     *\n     * @param indexName - Name of the index to retrieve\n     * @returns Promise with index metadata or error\n     *\n     * @example\n     * ```typescript\n     * const bucket = client.bucket('embeddings-prod')\n     * const { data } = await bucket.getIndex('documents-openai')\n     * console.log('Dimension:', data?.index.dimension)\n     * ```\n     */\n    getIndex(indexName) {\n        const _super = Object.create(null, {\n            getIndex: { get: () => super.getIndex }\n        });\n        return __awaiter(this, void 0, void 0, function* () {\n            return _super.getIndex.call(this, this.vectorBucketName, indexName);\n        });\n    }\n    /**\n     * Deletes an index from this bucket\n     * Convenience method that automatically includes the bucket name\n     *\n     * @param indexName - Name of the index to delete\n     * @returns Promise with empty response on success or error\n     *\n     * @example\n     * ```typescript\n     * const bucket = client.bucket('embeddings-prod')\n     * await bucket.deleteIndex('old-index')\n     * ```\n     */\n    deleteIndex(indexName) {\n        const _super = Object.create(null, {\n            deleteIndex: { get: () => super.deleteIndex }\n        });\n        return __awaiter(this, void 0, void 0, function* () {\n            return _super.deleteIndex.call(this, this.vectorBucketName, indexName);\n        });\n    }\n    /**\n     * Access operations for a specific index within this bucket\n     * Returns a scoped client for vector data operations\n     *\n     * @param indexName - Name of the index\n     * @returns Index-scoped client with vector data operations\n     *\n     * @example\n     * ```typescript\n     * const index = client.bucket('embeddings-prod').index('documents-openai')\n     *\n     * // Insert vectors\n     * await index.putVectors({\n     *   vectors: [\n     *     { key: 'doc-1', data: { float32: [...] }, metadata: { title: 'Intro' } }\n     *   ]\n     * })\n     *\n     * // Query similar vectors\n     * const { data } = await index.queryVectors({\n     *   queryVector: { float32: [...] },\n     *   topK: 5\n     * })\n     * ```\n     */\n    index(indexName) {\n        return new VectorIndexScope(this.url, this.headers, this.vectorBucketName, indexName, this.fetch);\n    }\n}\n/**\n * Scoped client for operations within a specific vector index\n * Provides vector data operations (put, get, list, query, delete)\n */\nexport class VectorIndexScope extends VectorDataApi {\n    constructor(url, headers, vectorBucketName, indexName, fetch) {\n        super(url, headers, fetch);\n        this.vectorBucketName = vectorBucketName;\n        this.indexName = indexName;\n    }\n    /**\n     * Inserts or updates vectors in this index\n     * Convenience method that automatically includes bucket and index names\n     *\n     * @param options - Vector insertion options (bucket and index names automatically set)\n     * @returns Promise with empty response on success or error\n     *\n     * @example\n     * ```typescript\n     * const index = client.bucket('embeddings-prod').index('documents-openai')\n     * await index.putVectors({\n     *   vectors: [\n     *     {\n     *       key: 'doc-1',\n     *       data: { float32: [0.1, 0.2, ...] },\n     *       metadata: { title: 'Introduction', page: 1 }\n     *     }\n     *   ]\n     * })\n     * ```\n     */\n    putVectors(options) {\n        const _super = Object.create(null, {\n            putVectors: { get: () => super.putVectors }\n        });\n        return __awaiter(this, void 0, void 0, function* () {\n            return _super.putVectors.call(this, Object.assign(Object.assign({}, options), { vectorBucketName: this.vectorBucketName, indexName: this.indexName }));\n        });\n    }\n    /**\n     * Retrieves vectors by keys from this index\n     * Convenience method that automatically includes bucket and index names\n     *\n     * @param options - Vector retrieval options (bucket and index names automatically set)\n     * @returns Promise with array of vectors or error\n     *\n     * @example\n     * ```typescript\n     * const index = client.bucket('embeddings-prod').index('documents-openai')\n     * const { data } = await index.getVectors({\n     *   keys: ['doc-1', 'doc-2'],\n     *   returnMetadata: true\n     * })\n     * ```\n     */\n    getVectors(options) {\n        const _super = Object.create(null, {\n            getVectors: { get: () => super.getVectors }\n        });\n        return __awaiter(this, void 0, void 0, function* () {\n            return _super.getVectors.call(this, Object.assign(Object.assign({}, options), { vectorBucketName: this.vectorBucketName, indexName: this.indexName }));\n        });\n    }\n    /**\n     * Lists vectors in this index with pagination\n     * Convenience method that automatically includes bucket and index names\n     *\n     * @param options - Listing options (bucket and index names automatically set)\n     * @returns Promise with array of vectors and pagination token\n     *\n     * @example\n     * ```typescript\n     * const index = client.bucket('embeddings-prod').index('documents-openai')\n     * const { data } = await index.listVectors({\n     *   maxResults: 500,\n     *   returnMetadata: true\n     * })\n     * ```\n     */\n    listVectors() {\n        const _super = Object.create(null, {\n            listVectors: { get: () => super.listVectors }\n        });\n        return __awaiter(this, arguments, void 0, function* (options = {}) {\n            return _super.listVectors.call(this, Object.assign(Object.assign({}, options), { vectorBucketName: this.vectorBucketName, indexName: this.indexName }));\n        });\n    }\n    /**\n     * Queries for similar vectors in this index\n     * Convenience method that automatically includes bucket and index names\n     *\n     * @param options - Query options (bucket and index names automatically set)\n     * @returns Promise with array of similar vectors ordered by distance\n     *\n     * @example\n     * ```typescript\n     * const index = client.bucket('embeddings-prod').index('documents-openai')\n     * const { data } = await index.queryVectors({\n     *   queryVector: { float32: [0.1, 0.2, ...] },\n     *   topK: 5,\n     *   filter: { category: 'technical' },\n     *   returnDistance: true,\n     *   returnMetadata: true\n     * })\n     * ```\n     */\n    queryVectors(options) {\n        const _super = Object.create(null, {\n            queryVectors: { get: () => super.queryVectors }\n        });\n        return __awaiter(this, void 0, void 0, function* () {\n            return _super.queryVectors.call(this, Object.assign(Object.assign({}, options), { vectorBucketName: this.vectorBucketName, indexName: this.indexName }));\n        });\n    }\n    /**\n     * Deletes vectors by keys from this index\n     * Convenience method that automatically includes bucket and index names\n     *\n     * @param options - Deletion options (bucket and index names automatically set)\n     * @returns Promise with empty response on success or error\n     *\n     * @example\n     * ```typescript\n     * const index = client.bucket('embeddings-prod').index('documents-openai')\n     * await index.deleteVectors({\n     *   keys: ['doc-1', 'doc-2', 'doc-3']\n     * })\n     * ```\n     */\n    deleteVectors(options) {\n        const _super = Object.create(null, {\n            deleteVectors: { get: () => super.deleteVectors }\n        });\n        return __awaiter(this, void 0, void 0, function* () {\n            return _super.deleteVectors.call(this, Object.assign(Object.assign({}, options), { vectorBucketName: this.vectorBucketName, indexName: this.indexName }));\n        });\n    }\n}\n//# sourceMappingURL=StorageVectorsClient.js.map","import StorageFileApi from './packages/StorageFileApi';\nimport StorageBucketApi from './packages/StorageBucketApi';\nimport StorageAnalyticsApi from './packages/StorageAnalyticsApi';\nimport { StorageVectorsClient } from './lib/vectors';\nexport class StorageClient extends StorageBucketApi {\n    constructor(url, headers = {}, fetch, opts) {\n        super(url, headers, fetch, opts);\n    }\n    /**\n     * Perform file operation in a bucket.\n     *\n     * @param id The bucket id to operate on.\n     */\n    from(id) {\n        return new StorageFileApi(this.url, this.headers, id, this.fetch);\n    }\n    /**\n     * Access vector storage operations.\n     *\n     * @returns A StorageVectorsClient instance configured with the current storage settings.\n     */\n    get vectors() {\n        return new StorageVectorsClient(this.url + '/vector', {\n            headers: this.headers,\n            fetch: this.fetch,\n        });\n    }\n    /**\n     * Access analytics storage operations using Iceberg tables.\n     *\n     * @returns A StorageAnalyticsApi instance configured with the current storage settings.\n     * @example\n     * ```typescript\n     * const client = createClient(url, key)\n     * const analytics = client.storage.analytics\n     *\n     * // Create an analytics bucket\n     * await analytics.createBucket('my-analytics-bucket')\n     *\n     * // List all analytics buckets\n     * const { data: buckets } = await analytics.listBuckets()\n     *\n     * // Delete an analytics bucket\n     * await analytics.deleteBucket('old-analytics-bucket')\n     * ```\n     */\n    get analytics() {\n        return new StorageAnalyticsApi(this.url + '/iceberg', this.headers, this.fetch);\n    }\n}\n//# sourceMappingURL=StorageClient.js.map","// Generated automatically during releases by scripts/update-version-files.ts\n// This file provides runtime access to the package version for:\n// - HTTP request headers (e.g., X-Client-Info header for API requests)\n// - Debugging and support (identifying which version is running)\n// - Telemetry and logging (version reporting in errors/analytics)\n// - Ensuring build artifacts match the published package version\nexport const version = '2.80.0';\n//# sourceMappingURL=version.js.map","import { version } from './version';\nlet JS_ENV = '';\n// @ts-ignore\nif (typeof Deno !== 'undefined') {\n    JS_ENV = 'deno';\n}\nelse if (typeof document !== 'undefined') {\n    JS_ENV = 'web';\n}\nelse if (typeof navigator !== 'undefined' && navigator.product === 'ReactNative') {\n    JS_ENV = 'react-native';\n}\nelse {\n    JS_ENV = 'node';\n}\nexport const DEFAULT_HEADERS = { 'X-Client-Info': `supabase-js-${JS_ENV}/${version}` };\nexport const DEFAULT_GLOBAL_OPTIONS = {\n    headers: DEFAULT_HEADERS,\n};\nexport const DEFAULT_DB_OPTIONS = {\n    schema: 'public',\n};\nexport const DEFAULT_AUTH_OPTIONS = {\n    autoRefreshToken: true,\n    persistSession: true,\n    detectSessionInUrl: true,\n    flowType: 'implicit',\n};\nexport const DEFAULT_REALTIME_OPTIONS = {};\n//# sourceMappingURL=constants.js.map","export const resolveFetch = (customFetch) => {\n    if (customFetch) {\n        return (...args) => customFetch(...args);\n    }\n    return (...args) => fetch(...args);\n};\nexport const resolveHeadersConstructor = () => {\n    return Headers;\n};\nexport const fetchWithAuth = (supabaseKey, getAccessToken, customFetch) => {\n    const fetch = resolveFetch(customFetch);\n    const HeadersConstructor = resolveHeadersConstructor();\n    return async (input, init) => {\n        var _a;\n        const accessToken = (_a = (await getAccessToken())) !== null && _a !== void 0 ? _a : supabaseKey;\n        let headers = new HeadersConstructor(init === null || init === void 0 ? void 0 : init.headers);\n        if (!headers.has('apikey')) {\n            headers.set('apikey', supabaseKey);\n        }\n        if (!headers.has('Authorization')) {\n            headers.set('Authorization', `Bearer ${accessToken}`);\n        }\n        return fetch(input, Object.assign(Object.assign({}, init), { headers }));\n    };\n};\n//# sourceMappingURL=fetch.js.map","export function uuid() {\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n        var r = (Math.random() * 16) | 0, v = c == 'x' ? r : (r & 0x3) | 0x8;\n        return v.toString(16);\n    });\n}\nexport function ensureTrailingSlash(url) {\n    return url.endsWith('/') ? url : url + '/';\n}\nexport const isBrowser = () => typeof window !== 'undefined';\nexport function applySettingDefaults(options, defaults) {\n    var _a, _b;\n    const { db: dbOptions, auth: authOptions, realtime: realtimeOptions, global: globalOptions, } = options;\n    const { db: DEFAULT_DB_OPTIONS, auth: DEFAULT_AUTH_OPTIONS, realtime: DEFAULT_REALTIME_OPTIONS, global: DEFAULT_GLOBAL_OPTIONS, } = defaults;\n    const result = {\n        db: Object.assign(Object.assign({}, DEFAULT_DB_OPTIONS), dbOptions),\n        auth: Object.assign(Object.assign({}, DEFAULT_AUTH_OPTIONS), authOptions),\n        realtime: Object.assign(Object.assign({}, DEFAULT_REALTIME_OPTIONS), realtimeOptions),\n        storage: {},\n        global: Object.assign(Object.assign(Object.assign({}, DEFAULT_GLOBAL_OPTIONS), globalOptions), { headers: Object.assign(Object.assign({}, ((_a = DEFAULT_GLOBAL_OPTIONS === null || DEFAULT_GLOBAL_OPTIONS === void 0 ? void 0 : DEFAULT_GLOBAL_OPTIONS.headers) !== null && _a !== void 0 ? _a : {})), ((_b = globalOptions === null || globalOptions === void 0 ? void 0 : globalOptions.headers) !== null && _b !== void 0 ? _b : {})) }),\n        accessToken: async () => '',\n    };\n    if (options.accessToken) {\n        result.accessToken = options.accessToken;\n    }\n    else {\n        // hack around Required<>\n        delete result.accessToken;\n    }\n    return result;\n}\n/**\n * Validates a Supabase client URL\n *\n * @param {string} supabaseUrl - The Supabase client URL string.\n * @returns {URL} - The validated base URL.\n * @throws {Error}\n */\nexport function validateSupabaseUrl(supabaseUrl) {\n    const trimmedUrl = supabaseUrl === null || supabaseUrl === void 0 ? void 0 : supabaseUrl.trim();\n    if (!trimmedUrl) {\n        throw new Error('supabaseUrl is required.');\n    }\n    if (!trimmedUrl.match(/^https?:\\/\\//i)) {\n        throw new Error('Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.');\n    }\n    try {\n        return new URL(ensureTrailingSlash(trimmedUrl));\n    }\n    catch (_a) {\n        throw Error('Invalid supabaseUrl: Provided URL is malformed.');\n    }\n}\n//# sourceMappingURL=helpers.js.map","// Generated automatically during releases by scripts/update-version-files.ts\n// This file provides runtime access to the package version for:\n// - HTTP request headers (e.g., X-Client-Info header for API requests)\n// - Debugging and support (identifying which version is running)\n// - Telemetry and logging (version reporting in errors/analytics)\n// - Ensuring build artifacts match the published package version\nexport const version = '2.80.0';\n//# sourceMappingURL=version.js.map","import { version } from './version';\n/** Current session will be checked for refresh at this interval. */\nexport const AUTO_REFRESH_TICK_DURATION_MS = 30 * 1000;\n/**\n * A token refresh will be attempted this many ticks before the current session expires. */\nexport const AUTO_REFRESH_TICK_THRESHOLD = 3;\n/*\n * Earliest time before an access token expires that the session should be refreshed.\n */\nexport const EXPIRY_MARGIN_MS = AUTO_REFRESH_TICK_THRESHOLD * AUTO_REFRESH_TICK_DURATION_MS;\nexport const GOTRUE_URL = 'http://localhost:9999';\nexport const STORAGE_KEY = 'supabase.auth.token';\nexport const AUDIENCE = '';\nexport const DEFAULT_HEADERS = { 'X-Client-Info': `gotrue-js/${version}` };\nexport const NETWORK_FAILURE = {\n    MAX_RETRIES: 10,\n    RETRY_INTERVAL: 2, // in deciseconds\n};\nexport const API_VERSION_HEADER_NAME = 'X-Supabase-Api-Version';\nexport const API_VERSIONS = {\n    '2024-01-01': {\n        timestamp: Date.parse('2024-01-01T00:00:00.0Z'),\n        name: '2024-01-01',\n    },\n};\nexport const BASE64URL_REGEX = /^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;\nexport const JWKS_TTL = 10 * 60 * 1000; // 10 minutes\n//# sourceMappingURL=constants.js.map","export class AuthError extends Error {\n    constructor(message, status, code) {\n        super(message);\n        this.__isAuthError = true;\n        this.name = 'AuthError';\n        this.status = status;\n        this.code = code;\n    }\n}\nexport function isAuthError(error) {\n    return typeof error === 'object' && error !== null && '__isAuthError' in error;\n}\nexport class AuthApiError extends AuthError {\n    constructor(message, status, code) {\n        super(message, status, code);\n        this.name = 'AuthApiError';\n        this.status = status;\n        this.code = code;\n    }\n}\nexport function isAuthApiError(error) {\n    return isAuthError(error) && error.name === 'AuthApiError';\n}\nexport class AuthUnknownError extends AuthError {\n    constructor(message, originalError) {\n        super(message);\n        this.name = 'AuthUnknownError';\n        this.originalError = originalError;\n    }\n}\nexport class CustomAuthError extends AuthError {\n    constructor(message, name, status, code) {\n        super(message, status, code);\n        this.name = name;\n        this.status = status;\n    }\n}\nexport class AuthSessionMissingError extends CustomAuthError {\n    constructor() {\n        super('Auth session missing!', 'AuthSessionMissingError', 400, undefined);\n    }\n}\nexport function isAuthSessionMissingError(error) {\n    return isAuthError(error) && error.name === 'AuthSessionMissingError';\n}\nexport class AuthInvalidTokenResponseError extends CustomAuthError {\n    constructor() {\n        super('Auth session or user missing', 'AuthInvalidTokenResponseError', 500, undefined);\n    }\n}\nexport class AuthInvalidCredentialsError extends CustomAuthError {\n    constructor(message) {\n        super(message, 'AuthInvalidCredentialsError', 400, undefined);\n    }\n}\nexport class AuthImplicitGrantRedirectError extends CustomAuthError {\n    constructor(message, details = null) {\n        super(message, 'AuthImplicitGrantRedirectError', 500, undefined);\n        this.details = null;\n        this.details = details;\n    }\n    toJSON() {\n        return {\n            name: this.name,\n            message: this.message,\n            status: this.status,\n            details: this.details,\n        };\n    }\n}\nexport function isAuthImplicitGrantRedirectError(error) {\n    return isAuthError(error) && error.name === 'AuthImplicitGrantRedirectError';\n}\nexport class AuthPKCEGrantCodeExchangeError extends CustomAuthError {\n    constructor(message, details = null) {\n        super(message, 'AuthPKCEGrantCodeExchangeError', 500, undefined);\n        this.details = null;\n        this.details = details;\n    }\n    toJSON() {\n        return {\n            name: this.name,\n            message: this.message,\n            status: this.status,\n            details: this.details,\n        };\n    }\n}\nexport class AuthRetryableFetchError extends CustomAuthError {\n    constructor(message, status) {\n        super(message, 'AuthRetryableFetchError', status, undefined);\n    }\n}\nexport function isAuthRetryableFetchError(error) {\n    return isAuthError(error) && error.name === 'AuthRetryableFetchError';\n}\n/**\n * This error is thrown on certain methods when the password used is deemed\n * weak. Inspect the reasons to identify what password strength rules are\n * inadequate.\n */\nexport class AuthWeakPasswordError extends CustomAuthError {\n    constructor(message, status, reasons) {\n        super(message, 'AuthWeakPasswordError', status, 'weak_password');\n        this.reasons = reasons;\n    }\n}\nexport function isAuthWeakPasswordError(error) {\n    return isAuthError(error) && error.name === 'AuthWeakPasswordError';\n}\nexport class AuthInvalidJwtError extends CustomAuthError {\n    constructor(message) {\n        super(message, 'AuthInvalidJwtError', 400, 'invalid_jwt');\n    }\n}\n//# sourceMappingURL=errors.js.map","/**\n * Avoid modifying this file. It's part of\n * https://github.com/supabase-community/base64url-js.  Submit all fixes on\n * that repo!\n */\n/**\n * An array of characters that encode 6 bits into a Base64-URL alphabet\n * character.\n */\nconst TO_BASE64URL = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_'.split('');\n/**\n * An array of characters that can appear in a Base64-URL encoded string but\n * should be ignored.\n */\nconst IGNORE_BASE64URL = ' \\t\\n\\r='.split('');\n/**\n * An array of 128 numbers that map a Base64-URL character to 6 bits, or if -2\n * used to skip the character, or if -1 used to error out.\n */\nconst FROM_BASE64URL = (() => {\n    const charMap = new Array(128);\n    for (let i = 0; i < charMap.length; i += 1) {\n        charMap[i] = -1;\n    }\n    for (let i = 0; i < IGNORE_BASE64URL.length; i += 1) {\n        charMap[IGNORE_BASE64URL[i].charCodeAt(0)] = -2;\n    }\n    for (let i = 0; i < TO_BASE64URL.length; i += 1) {\n        charMap[TO_BASE64URL[i].charCodeAt(0)] = i;\n    }\n    return charMap;\n})();\n/**\n * Converts a byte to a Base64-URL string.\n *\n * @param byte The byte to convert, or null to flush at the end of the byte sequence.\n * @param state The Base64 conversion state. Pass an initial value of `{ queue: 0, queuedBits: 0 }`.\n * @param emit A function called with the next Base64 character when ready.\n */\nexport function byteToBase64URL(byte, state, emit) {\n    if (byte !== null) {\n        state.queue = (state.queue << 8) | byte;\n        state.queuedBits += 8;\n        while (state.queuedBits >= 6) {\n            const pos = (state.queue >> (state.queuedBits - 6)) & 63;\n            emit(TO_BASE64URL[pos]);\n            state.queuedBits -= 6;\n        }\n    }\n    else if (state.queuedBits > 0) {\n        state.queue = state.queue << (6 - state.queuedBits);\n        state.queuedBits = 6;\n        while (state.queuedBits >= 6) {\n            const pos = (state.queue >> (state.queuedBits - 6)) & 63;\n            emit(TO_BASE64URL[pos]);\n            state.queuedBits -= 6;\n        }\n    }\n}\n/**\n * Converts a String char code (extracted using `string.charCodeAt(position)`) to a sequence of Base64-URL characters.\n *\n * @param charCode The char code of the JavaScript string.\n * @param state The Base64 state. Pass an initial value of `{ queue: 0, queuedBits: 0 }`.\n * @param emit A function called with the next byte.\n */\nexport function byteFromBase64URL(charCode, state, emit) {\n    const bits = FROM_BASE64URL[charCode];\n    if (bits > -1) {\n        // valid Base64-URL character\n        state.queue = (state.queue << 6) | bits;\n        state.queuedBits += 6;\n        while (state.queuedBits >= 8) {\n            emit((state.queue >> (state.queuedBits - 8)) & 0xff);\n            state.queuedBits -= 8;\n        }\n    }\n    else if (bits === -2) {\n        // ignore spaces, tabs, newlines, =\n        return;\n    }\n    else {\n        throw new Error(`Invalid Base64-URL character \"${String.fromCharCode(charCode)}\"`);\n    }\n}\n/**\n * Converts a JavaScript string (which may include any valid character) into a\n * Base64-URL encoded string. The string is first encoded in UTF-8 which is\n * then encoded as Base64-URL.\n *\n * @param str The string to convert.\n */\nexport function stringToBase64URL(str) {\n    const base64 = [];\n    const emitter = (char) => {\n        base64.push(char);\n    };\n    const state = { queue: 0, queuedBits: 0 };\n    stringToUTF8(str, (byte) => {\n        byteToBase64URL(byte, state, emitter);\n    });\n    byteToBase64URL(null, state, emitter);\n    return base64.join('');\n}\n/**\n * Converts a Base64-URL encoded string into a JavaScript string. It is assumed\n * that the underlying string has been encoded as UTF-8.\n *\n * @param str The Base64-URL encoded string.\n */\nexport function stringFromBase64URL(str) {\n    const conv = [];\n    const utf8Emit = (codepoint) => {\n        conv.push(String.fromCodePoint(codepoint));\n    };\n    const utf8State = {\n        utf8seq: 0,\n        codepoint: 0,\n    };\n    const b64State = { queue: 0, queuedBits: 0 };\n    const byteEmit = (byte) => {\n        stringFromUTF8(byte, utf8State, utf8Emit);\n    };\n    for (let i = 0; i < str.length; i += 1) {\n        byteFromBase64URL(str.charCodeAt(i), b64State, byteEmit);\n    }\n    return conv.join('');\n}\n/**\n * Converts a Unicode codepoint to a multi-byte UTF-8 sequence.\n *\n * @param codepoint The Unicode codepoint.\n * @param emit      Function which will be called for each UTF-8 byte that represents the codepoint.\n */\nexport function codepointToUTF8(codepoint, emit) {\n    if (codepoint <= 0x7f) {\n        emit(codepoint);\n        return;\n    }\n    else if (codepoint <= 0x7ff) {\n        emit(0xc0 | (codepoint >> 6));\n        emit(0x80 | (codepoint & 0x3f));\n        return;\n    }\n    else if (codepoint <= 0xffff) {\n        emit(0xe0 | (codepoint >> 12));\n        emit(0x80 | ((codepoint >> 6) & 0x3f));\n        emit(0x80 | (codepoint & 0x3f));\n        return;\n    }\n    else if (codepoint <= 0x10ffff) {\n        emit(0xf0 | (codepoint >> 18));\n        emit(0x80 | ((codepoint >> 12) & 0x3f));\n        emit(0x80 | ((codepoint >> 6) & 0x3f));\n        emit(0x80 | (codepoint & 0x3f));\n        return;\n    }\n    throw new Error(`Unrecognized Unicode codepoint: ${codepoint.toString(16)}`);\n}\n/**\n * Converts a JavaScript string to a sequence of UTF-8 bytes.\n *\n * @param str  The string to convert to UTF-8.\n * @param emit Function which will be called for each UTF-8 byte of the string.\n */\nexport function stringToUTF8(str, emit) {\n    for (let i = 0; i < str.length; i += 1) {\n        let codepoint = str.charCodeAt(i);\n        if (codepoint > 0xd7ff && codepoint <= 0xdbff) {\n            // most UTF-16 codepoints are Unicode codepoints, except values in this\n            // range where the next UTF-16 codepoint needs to be combined with the\n            // current one to get the Unicode codepoint\n            const highSurrogate = ((codepoint - 0xd800) * 0x400) & 0xffff;\n            const lowSurrogate = (str.charCodeAt(i + 1) - 0xdc00) & 0xffff;\n            codepoint = (lowSurrogate | highSurrogate) + 0x10000;\n            i += 1;\n        }\n        codepointToUTF8(codepoint, emit);\n    }\n}\n/**\n * Converts a UTF-8 byte to a Unicode codepoint.\n *\n * @param byte  The UTF-8 byte next in the sequence.\n * @param state The shared state between consecutive UTF-8 bytes in the\n *              sequence, an object with the shape `{ utf8seq: 0, codepoint: 0 }`.\n * @param emit  Function which will be called for each codepoint.\n */\nexport function stringFromUTF8(byte, state, emit) {\n    if (state.utf8seq === 0) {\n        if (byte <= 0x7f) {\n            emit(byte);\n            return;\n        }\n        // count the number of 1 leading bits until you reach 0\n        for (let leadingBit = 1; leadingBit < 6; leadingBit += 1) {\n            if (((byte >> (7 - leadingBit)) & 1) === 0) {\n                state.utf8seq = leadingBit;\n                break;\n            }\n        }\n        if (state.utf8seq === 2) {\n            state.codepoint = byte & 31;\n        }\n        else if (state.utf8seq === 3) {\n            state.codepoint = byte & 15;\n        }\n        else if (state.utf8seq === 4) {\n            state.codepoint = byte & 7;\n        }\n        else {\n            throw new Error('Invalid UTF-8 sequence');\n        }\n        state.utf8seq -= 1;\n    }\n    else if (state.utf8seq > 0) {\n        if (byte <= 0x7f) {\n            throw new Error('Invalid UTF-8 sequence');\n        }\n        state.codepoint = (state.codepoint << 6) | (byte & 63);\n        state.utf8seq -= 1;\n        if (state.utf8seq === 0) {\n            emit(state.codepoint);\n        }\n    }\n}\n/**\n * Helper functions to convert different types of strings to Uint8Array\n */\nexport function base64UrlToUint8Array(str) {\n    const result = [];\n    const state = { queue: 0, queuedBits: 0 };\n    const onByte = (byte) => {\n        result.push(byte);\n    };\n    for (let i = 0; i < str.length; i += 1) {\n        byteFromBase64URL(str.charCodeAt(i), state, onByte);\n    }\n    return new Uint8Array(result);\n}\nexport function stringToUint8Array(str) {\n    const result = [];\n    stringToUTF8(str, (byte) => result.push(byte));\n    return new Uint8Array(result);\n}\nexport function bytesToBase64URL(bytes) {\n    const result = [];\n    const state = { queue: 0, queuedBits: 0 };\n    const onChar = (char) => {\n        result.push(char);\n    };\n    bytes.forEach((byte) => byteToBase64URL(byte, state, onChar));\n    // always call with `null` after processing all bytes\n    byteToBase64URL(null, state, onChar);\n    return result.join('');\n}\n//# sourceMappingURL=base64url.js.map","import { API_VERSION_HEADER_NAME, BASE64URL_REGEX } from './constants';\nimport { AuthInvalidJwtError } from './errors';\nimport { base64UrlToUint8Array, stringFromBase64URL } from './base64url';\nexport function expiresAt(expiresIn) {\n    const timeNow = Math.round(Date.now() / 1000);\n    return timeNow + expiresIn;\n}\nexport function uuid() {\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n        const r = (Math.random() * 16) | 0, v = c == 'x' ? r : (r & 0x3) | 0x8;\n        return v.toString(16);\n    });\n}\nexport const isBrowser = () => typeof window !== 'undefined' && typeof document !== 'undefined';\nconst localStorageWriteTests = {\n    tested: false,\n    writable: false,\n};\n/**\n * Checks whether localStorage is supported on this browser.\n */\nexport const supportsLocalStorage = () => {\n    if (!isBrowser()) {\n        return false;\n    }\n    try {\n        if (typeof globalThis.localStorage !== 'object') {\n            return false;\n        }\n    }\n    catch (e) {\n        // DOM exception when accessing `localStorage`\n        return false;\n    }\n    if (localStorageWriteTests.tested) {\n        return localStorageWriteTests.writable;\n    }\n    const randomKey = `lswt-${Math.random()}${Math.random()}`;\n    try {\n        globalThis.localStorage.setItem(randomKey, randomKey);\n        globalThis.localStorage.removeItem(randomKey);\n        localStorageWriteTests.tested = true;\n        localStorageWriteTests.writable = true;\n    }\n    catch (e) {\n        // localStorage can't be written to\n        // https://www.chromium.org/for-testers/bug-reporting-guidelines/uncaught-securityerror-failed-to-read-the-localstorage-property-from-window-access-is-denied-for-this-document\n        localStorageWriteTests.tested = true;\n        localStorageWriteTests.writable = false;\n    }\n    return localStorageWriteTests.writable;\n};\n/**\n * Extracts parameters encoded in the URL both in the query and fragment.\n */\nexport function parseParametersFromURL(href) {\n    const result = {};\n    const url = new URL(href);\n    if (url.hash && url.hash[0] === '#') {\n        try {\n            const hashSearchParams = new URLSearchParams(url.hash.substring(1));\n            hashSearchParams.forEach((value, key) => {\n                result[key] = value;\n            });\n        }\n        catch (e) {\n            // hash is not a query string\n        }\n    }\n    // search parameters take precedence over hash parameters\n    url.searchParams.forEach((value, key) => {\n        result[key] = value;\n    });\n    return result;\n}\nexport const resolveFetch = (customFetch) => {\n    if (customFetch) {\n        return (...args) => customFetch(...args);\n    }\n    return (...args) => fetch(...args);\n};\nexport const looksLikeFetchResponse = (maybeResponse) => {\n    return (typeof maybeResponse === 'object' &&\n        maybeResponse !== null &&\n        'status' in maybeResponse &&\n        'ok' in maybeResponse &&\n        'json' in maybeResponse &&\n        typeof maybeResponse.json === 'function');\n};\n// Storage helpers\nexport const setItemAsync = async (storage, key, data) => {\n    await storage.setItem(key, JSON.stringify(data));\n};\nexport const getItemAsync = async (storage, key) => {\n    const value = await storage.getItem(key);\n    if (!value) {\n        return null;\n    }\n    try {\n        return JSON.parse(value);\n    }\n    catch (_a) {\n        return value;\n    }\n};\nexport const removeItemAsync = async (storage, key) => {\n    await storage.removeItem(key);\n};\n/**\n * A deferred represents some asynchronous work that is not yet finished, which\n * may or may not culminate in a value.\n * Taken from: https://github.com/mike-north/types/blob/master/src/async.ts\n */\nexport class Deferred {\n    constructor() {\n        // eslint-disable-next-line @typescript-eslint/no-extra-semi\n        ;\n        this.promise = new Deferred.promiseConstructor((res, rej) => {\n            // eslint-disable-next-line @typescript-eslint/no-extra-semi\n            ;\n            this.resolve = res;\n            this.reject = rej;\n        });\n    }\n}\nDeferred.promiseConstructor = Promise;\nexport function decodeJWT(token) {\n    const parts = token.split('.');\n    if (parts.length !== 3) {\n        throw new AuthInvalidJwtError('Invalid JWT structure');\n    }\n    // Regex checks for base64url format\n    for (let i = 0; i < parts.length; i++) {\n        if (!BASE64URL_REGEX.test(parts[i])) {\n            throw new AuthInvalidJwtError('JWT not in base64url format');\n        }\n    }\n    const data = {\n        // using base64url lib\n        header: JSON.parse(stringFromBase64URL(parts[0])),\n        payload: JSON.parse(stringFromBase64URL(parts[1])),\n        signature: base64UrlToUint8Array(parts[2]),\n        raw: {\n            header: parts[0],\n            payload: parts[1],\n        },\n    };\n    return data;\n}\n/**\n * Creates a promise that resolves to null after some time.\n */\nexport async function sleep(time) {\n    return await new Promise((accept) => {\n        setTimeout(() => accept(null), time);\n    });\n}\n/**\n * Converts the provided async function into a retryable function. Each result\n * or thrown error is sent to the isRetryable function which should return true\n * if the function should run again.\n */\nexport function retryable(fn, isRetryable) {\n    const promise = new Promise((accept, reject) => {\n        // eslint-disable-next-line @typescript-eslint/no-extra-semi\n        ;\n        (async () => {\n            for (let attempt = 0; attempt < Infinity; attempt++) {\n                try {\n                    const result = await fn(attempt);\n                    if (!isRetryable(attempt, null, result)) {\n                        accept(result);\n                        return;\n                    }\n                }\n                catch (e) {\n                    if (!isRetryable(attempt, e)) {\n                        reject(e);\n                        return;\n                    }\n                }\n            }\n        })();\n    });\n    return promise;\n}\nfunction dec2hex(dec) {\n    return ('0' + dec.toString(16)).substr(-2);\n}\n// Functions below taken from: https://stackoverflow.com/questions/63309409/creating-a-code-verifier-and-challenge-for-pkce-auth-on-spotify-api-in-reactjs\nexport function generatePKCEVerifier() {\n    const verifierLength = 56;\n    const array = new Uint32Array(verifierLength);\n    if (typeof crypto === 'undefined') {\n        const charSet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~';\n        const charSetLen = charSet.length;\n        let verifier = '';\n        for (let i = 0; i < verifierLength; i++) {\n            verifier += charSet.charAt(Math.floor(Math.random() * charSetLen));\n        }\n        return verifier;\n    }\n    crypto.getRandomValues(array);\n    return Array.from(array, dec2hex).join('');\n}\nasync function sha256(randomString) {\n    const encoder = new TextEncoder();\n    const encodedData = encoder.encode(randomString);\n    const hash = await crypto.subtle.digest('SHA-256', encodedData);\n    const bytes = new Uint8Array(hash);\n    return Array.from(bytes)\n        .map((c) => String.fromCharCode(c))\n        .join('');\n}\nexport async function generatePKCEChallenge(verifier) {\n    const hasCryptoSupport = typeof crypto !== 'undefined' &&\n        typeof crypto.subtle !== 'undefined' &&\n        typeof TextEncoder !== 'undefined';\n    if (!hasCryptoSupport) {\n        console.warn('WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256.');\n        return verifier;\n    }\n    const hashed = await sha256(verifier);\n    return btoa(hashed).replace(/\\+/g, '-').replace(/\\//g, '_').replace(/=+$/, '');\n}\nexport async function getCodeChallengeAndMethod(storage, storageKey, isPasswordRecovery = false) {\n    const codeVerifier = generatePKCEVerifier();\n    let storedCodeVerifier = codeVerifier;\n    if (isPasswordRecovery) {\n        storedCodeVerifier += '/PASSWORD_RECOVERY';\n    }\n    await setItemAsync(storage, `${storageKey}-code-verifier`, storedCodeVerifier);\n    const codeChallenge = await generatePKCEChallenge(codeVerifier);\n    const codeChallengeMethod = codeVerifier === codeChallenge ? 'plain' : 's256';\n    return [codeChallenge, codeChallengeMethod];\n}\n/** Parses the API version which is 2YYY-MM-DD. */\nconst API_VERSION_REGEX = /^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;\nexport function parseResponseAPIVersion(response) {\n    const apiVersion = response.headers.get(API_VERSION_HEADER_NAME);\n    if (!apiVersion) {\n        return null;\n    }\n    if (!apiVersion.match(API_VERSION_REGEX)) {\n        return null;\n    }\n    try {\n        const date = new Date(`${apiVersion}T00:00:00.0Z`);\n        return date;\n    }\n    catch (e) {\n        return null;\n    }\n}\nexport function validateExp(exp) {\n    if (!exp) {\n        throw new Error('Missing exp claim');\n    }\n    const timeNow = Math.floor(Date.now() / 1000);\n    if (exp <= timeNow) {\n        throw new Error('JWT has expired');\n    }\n}\nexport function getAlgorithm(alg) {\n    switch (alg) {\n        case 'RS256':\n            return {\n                name: 'RSASSA-PKCS1-v1_5',\n                hash: { name: 'SHA-256' },\n            };\n        case 'ES256':\n            return {\n                name: 'ECDSA',\n                namedCurve: 'P-256',\n                hash: { name: 'SHA-256' },\n            };\n        default:\n            throw new Error('Invalid alg claim');\n    }\n}\nconst UUID_REGEX = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;\nexport function validateUUID(str) {\n    if (!UUID_REGEX.test(str)) {\n        throw new Error('@supabase/auth-js: Expected parameter to be UUID but is not');\n    }\n}\nexport function userNotAvailableProxy() {\n    const proxyTarget = {};\n    return new Proxy(proxyTarget, {\n        get: (target, prop) => {\n            if (prop === '__isUserNotAvailableProxy') {\n                return true;\n            }\n            // Preventative check for common problematic symbols during cloning/inspection\n            // These symbols might be accessed by structuredClone or other internal mechanisms.\n            if (typeof prop === 'symbol') {\n                const sProp = prop.toString();\n                if (sProp === 'Symbol(Symbol.toPrimitive)' ||\n                    sProp === 'Symbol(Symbol.toStringTag)' ||\n                    sProp === 'Symbol(util.inspect.custom)') {\n                    // Node.js util.inspect\n                    return undefined;\n                }\n            }\n            throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the \"${prop}\" property of the session object is not supported. Please use getUser() instead.`);\n        },\n        set: (_target, prop) => {\n            throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the \"${prop}\" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`);\n        },\n        deleteProperty: (_target, prop) => {\n            throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the \"${prop}\" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`);\n        },\n    });\n}\n/**\n * Creates a proxy around a user object that warns when properties are accessed on the server.\n * This is used to alert developers that using user data from getSession() on the server is insecure.\n *\n * @param user The actual user object to wrap\n * @param suppressWarningRef An object with a 'value' property that controls warning suppression\n * @returns A proxied user object that warns on property access\n */\nexport function insecureUserWarningProxy(user, suppressWarningRef) {\n    return new Proxy(user, {\n        get: (target, prop, receiver) => {\n            // Allow internal checks without warning\n            if (prop === '__isInsecureUserWarningProxy') {\n                return true;\n            }\n            // Preventative check for common problematic symbols during cloning/inspection\n            // These symbols might be accessed by structuredClone or other internal mechanisms\n            if (typeof prop === 'symbol') {\n                const sProp = prop.toString();\n                if (sProp === 'Symbol(Symbol.toPrimitive)' ||\n                    sProp === 'Symbol(Symbol.toStringTag)' ||\n                    sProp === 'Symbol(util.inspect.custom)' ||\n                    sProp === 'Symbol(nodejs.util.inspect.custom)') {\n                    // Return the actual value for these symbols to allow proper inspection\n                    return Reflect.get(target, prop, receiver);\n                }\n            }\n            // Emit warning on first property access\n            if (!suppressWarningRef.value && typeof prop === 'string') {\n                console.warn('Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server.');\n                suppressWarningRef.value = true;\n            }\n            return Reflect.get(target, prop, receiver);\n        },\n    });\n}\n/**\n * Deep clones a JSON-serializable object using JSON.parse(JSON.stringify(obj)).\n * Note: Only works for JSON-safe data.\n */\nexport function deepClone(obj) {\n    return JSON.parse(JSON.stringify(obj));\n}\n//# sourceMappingURL=helpers.js.map","import { __rest } from \"tslib\";\nimport { API_VERSIONS, API_VERSION_HEADER_NAME } from './constants';\nimport { expiresAt, looksLikeFetchResponse, parseResponseAPIVersion } from './helpers';\nimport { AuthApiError, AuthRetryableFetchError, AuthWeakPasswordError, AuthUnknownError, AuthSessionMissingError, } from './errors';\nconst _getErrorMessage = (err) => err.msg || err.message || err.error_description || err.error || JSON.stringify(err);\nconst NETWORK_ERROR_CODES = [502, 503, 504];\nexport async function handleError(error) {\n    var _a;\n    if (!looksLikeFetchResponse(error)) {\n        throw new AuthRetryableFetchError(_getErrorMessage(error), 0);\n    }\n    if (NETWORK_ERROR_CODES.includes(error.status)) {\n        // status in 500...599 range - server had an error, request might be retryed.\n        throw new AuthRetryableFetchError(_getErrorMessage(error), error.status);\n    }\n    let data;\n    try {\n        data = await error.json();\n    }\n    catch (e) {\n        throw new AuthUnknownError(_getErrorMessage(e), e);\n    }\n    let errorCode = undefined;\n    const responseAPIVersion = parseResponseAPIVersion(error);\n    if (responseAPIVersion &&\n        responseAPIVersion.getTime() >= API_VERSIONS['2024-01-01'].timestamp &&\n        typeof data === 'object' &&\n        data &&\n        typeof data.code === 'string') {\n        errorCode = data.code;\n    }\n    else if (typeof data === 'object' && data && typeof data.error_code === 'string') {\n        errorCode = data.error_code;\n    }\n    if (!errorCode) {\n        // Legacy support for weak password errors, when there were no error codes\n        if (typeof data === 'object' &&\n            data &&\n            typeof data.weak_password === 'object' &&\n            data.weak_password &&\n            Array.isArray(data.weak_password.reasons) &&\n            data.weak_password.reasons.length &&\n            data.weak_password.reasons.reduce((a, i) => a && typeof i === 'string', true)) {\n            throw new AuthWeakPasswordError(_getErrorMessage(data), error.status, data.weak_password.reasons);\n        }\n    }\n    else if (errorCode === 'weak_password') {\n        throw new AuthWeakPasswordError(_getErrorMessage(data), error.status, ((_a = data.weak_password) === null || _a === void 0 ? void 0 : _a.reasons) || []);\n    }\n    else if (errorCode === 'session_not_found') {\n        // The `session_id` inside the JWT does not correspond to a row in the\n        // `sessions` table. This usually means the user has signed out, has been\n        // deleted, or their session has somehow been terminated.\n        throw new AuthSessionMissingError();\n    }\n    throw new AuthApiError(_getErrorMessage(data), error.status || 500, errorCode);\n}\nconst _getRequestParams = (method, options, parameters, body) => {\n    const params = { method, headers: (options === null || options === void 0 ? void 0 : options.headers) || {} };\n    if (method === 'GET') {\n        return params;\n    }\n    params.headers = Object.assign({ 'Content-Type': 'application/json;charset=UTF-8' }, options === null || options === void 0 ? void 0 : options.headers);\n    params.body = JSON.stringify(body);\n    return Object.assign(Object.assign({}, params), parameters);\n};\nexport async function _request(fetcher, method, url, options) {\n    var _a;\n    const headers = Object.assign({}, options === null || options === void 0 ? void 0 : options.headers);\n    if (!headers[API_VERSION_HEADER_NAME]) {\n        headers[API_VERSION_HEADER_NAME] = API_VERSIONS['2024-01-01'].name;\n    }\n    if (options === null || options === void 0 ? void 0 : options.jwt) {\n        headers['Authorization'] = `Bearer ${options.jwt}`;\n    }\n    const qs = (_a = options === null || options === void 0 ? void 0 : options.query) !== null && _a !== void 0 ? _a : {};\n    if (options === null || options === void 0 ? void 0 : options.redirectTo) {\n        qs['redirect_to'] = options.redirectTo;\n    }\n    const queryString = Object.keys(qs).length ? '?' + new URLSearchParams(qs).toString() : '';\n    const data = await _handleRequest(fetcher, method, url + queryString, {\n        headers,\n        noResolveJson: options === null || options === void 0 ? void 0 : options.noResolveJson,\n    }, {}, options === null || options === void 0 ? void 0 : options.body);\n    return (options === null || options === void 0 ? void 0 : options.xform) ? options === null || options === void 0 ? void 0 : options.xform(data) : { data: Object.assign({}, data), error: null };\n}\nasync function _handleRequest(fetcher, method, url, options, parameters, body) {\n    const requestParams = _getRequestParams(method, options, parameters, body);\n    let result;\n    try {\n        result = await fetcher(url, Object.assign({}, requestParams));\n    }\n    catch (e) {\n        console.error(e);\n        // fetch failed, likely due to a network or CORS error\n        throw new AuthRetryableFetchError(_getErrorMessage(e), 0);\n    }\n    if (!result.ok) {\n        await handleError(result);\n    }\n    if (options === null || options === void 0 ? void 0 : options.noResolveJson) {\n        return result;\n    }\n    try {\n        return await result.json();\n    }\n    catch (e) {\n        await handleError(e);\n    }\n}\nexport function _sessionResponse(data) {\n    var _a;\n    let session = null;\n    if (hasSession(data)) {\n        session = Object.assign({}, data);\n        if (!data.expires_at) {\n            session.expires_at = expiresAt(data.expires_in);\n        }\n    }\n    const user = (_a = data.user) !== null && _a !== void 0 ? _a : data;\n    return { data: { session, user }, error: null };\n}\nexport function _sessionResponsePassword(data) {\n    const response = _sessionResponse(data);\n    if (!response.error &&\n        data.weak_password &&\n        typeof data.weak_password === 'object' &&\n        Array.isArray(data.weak_password.reasons) &&\n        data.weak_password.reasons.length &&\n        data.weak_password.message &&\n        typeof data.weak_password.message === 'string' &&\n        data.weak_password.reasons.reduce((a, i) => a && typeof i === 'string', true)) {\n        response.data.weak_password = data.weak_password;\n    }\n    return response;\n}\nexport function _userResponse(data) {\n    var _a;\n    const user = (_a = data.user) !== null && _a !== void 0 ? _a : data;\n    return { data: { user }, error: null };\n}\nexport function _ssoResponse(data) {\n    return { data, error: null };\n}\nexport function _generateLinkResponse(data) {\n    const { action_link, email_otp, hashed_token, redirect_to, verification_type } = data, rest = __rest(data, [\"action_link\", \"email_otp\", \"hashed_token\", \"redirect_to\", \"verification_type\"]);\n    const properties = {\n        action_link,\n        email_otp,\n        hashed_token,\n        redirect_to,\n        verification_type,\n    };\n    const user = Object.assign({}, rest);\n    return {\n        data: {\n            properties,\n            user,\n        },\n        error: null,\n    };\n}\nexport function _noResolveJsonResponse(data) {\n    return data;\n}\n/**\n * hasSession checks if the response object contains a valid session\n * @param data A response object\n * @returns true if a session is in the response\n */\nfunction hasSession(data) {\n    return data.access_token && data.refresh_token && data.expires_in;\n}\n//# sourceMappingURL=fetch.js.map","const WeakPasswordReasons = ['length', 'characters', 'pwned'];\nconst AMRMethods = [\n    'password',\n    'otp',\n    'oauth',\n    'totp',\n    'mfa/totp',\n    'mfa/phone',\n    'mfa/webauthn',\n    'anonymous',\n    'sso/saml',\n    'magiclink',\n    'web3',\n];\nconst FactorTypes = ['totp', 'phone', 'webauthn'];\nconst FactorVerificationStatuses = ['verified', 'unverified'];\nconst MFATOTPChannels = ['sms', 'whatsapp'];\nexport const SIGN_OUT_SCOPES = ['global', 'local', 'others'];\n//# sourceMappingURL=types.js.map","import { __rest } from \"tslib\";\nimport { _generateLinkResponse, _noResolveJsonResponse, _request, _userResponse, } from './lib/fetch';\nimport { resolveFetch, validateUUID } from './lib/helpers';\nimport { SIGN_OUT_SCOPES, } from './lib/types';\nimport { isAuthError } from './lib/errors';\nexport default class GoTrueAdminApi {\n    constructor({ url = '', headers = {}, fetch, }) {\n        this.url = url;\n        this.headers = headers;\n        this.fetch = resolveFetch(fetch);\n        this.mfa = {\n            listFactors: this._listFactors.bind(this),\n            deleteFactor: this._deleteFactor.bind(this),\n        };\n        this.oauth = {\n            listClients: this._listOAuthClients.bind(this),\n            createClient: this._createOAuthClient.bind(this),\n            getClient: this._getOAuthClient.bind(this),\n            updateClient: this._updateOAuthClient.bind(this),\n            deleteClient: this._deleteOAuthClient.bind(this),\n            regenerateClientSecret: this._regenerateOAuthClientSecret.bind(this),\n        };\n    }\n    /**\n     * Removes a logged-in session.\n     * @param jwt A valid, logged-in JWT.\n     * @param scope The logout sope.\n     */\n    async signOut(jwt, scope = SIGN_OUT_SCOPES[0]) {\n        if (SIGN_OUT_SCOPES.indexOf(scope) < 0) {\n            throw new Error(`@supabase/auth-js: Parameter scope must be one of ${SIGN_OUT_SCOPES.join(', ')}`);\n        }\n        try {\n            await _request(this.fetch, 'POST', `${this.url}/logout?scope=${scope}`, {\n                headers: this.headers,\n                jwt,\n                noResolveJson: true,\n            });\n            return { data: null, error: null };\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: null, error };\n            }\n            throw error;\n        }\n    }\n    /**\n     * Sends an invite link to an email address.\n     * @param email The email address of the user.\n     * @param options Additional options to be included when inviting.\n     */\n    async inviteUserByEmail(email, options = {}) {\n        try {\n            return await _request(this.fetch, 'POST', `${this.url}/invite`, {\n                body: { email, data: options.data },\n                headers: this.headers,\n                redirectTo: options.redirectTo,\n                xform: _userResponse,\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: { user: null }, error };\n            }\n            throw error;\n        }\n    }\n    /**\n     * Generates email links and OTPs to be sent via a custom email provider.\n     * @param email The user's email.\n     * @param options.password User password. For signup only.\n     * @param options.data Optional user metadata. For signup only.\n     * @param options.redirectTo The redirect url which should be appended to the generated link\n     */\n    async generateLink(params) {\n        try {\n            const { options } = params, rest = __rest(params, [\"options\"]);\n            const body = Object.assign(Object.assign({}, rest), options);\n            if ('newEmail' in rest) {\n                // replace newEmail with new_email in request body\n                body.new_email = rest === null || rest === void 0 ? void 0 : rest.newEmail;\n                delete body['newEmail'];\n            }\n            return await _request(this.fetch, 'POST', `${this.url}/admin/generate_link`, {\n                body: body,\n                headers: this.headers,\n                xform: _generateLinkResponse,\n                redirectTo: options === null || options === void 0 ? void 0 : options.redirectTo,\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return {\n                    data: {\n                        properties: null,\n                        user: null,\n                    },\n                    error,\n                };\n            }\n            throw error;\n        }\n    }\n    // User Admin API\n    /**\n     * Creates a new user.\n     * This function should only be called on a server. Never expose your `service_role` key in the browser.\n     */\n    async createUser(attributes) {\n        try {\n            return await _request(this.fetch, 'POST', `${this.url}/admin/users`, {\n                body: attributes,\n                headers: this.headers,\n                xform: _userResponse,\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: { user: null }, error };\n            }\n            throw error;\n        }\n    }\n    /**\n     * Get a list of users.\n     *\n     * This function should only be called on a server. Never expose your `service_role` key in the browser.\n     * @param params An object which supports `page` and `perPage` as numbers, to alter the paginated results.\n     */\n    async listUsers(params) {\n        var _a, _b, _c, _d, _e, _f, _g;\n        try {\n            const pagination = { nextPage: null, lastPage: 0, total: 0 };\n            const response = await _request(this.fetch, 'GET', `${this.url}/admin/users`, {\n                headers: this.headers,\n                noResolveJson: true,\n                query: {\n                    page: (_b = (_a = params === null || params === void 0 ? void 0 : params.page) === null || _a === void 0 ? void 0 : _a.toString()) !== null && _b !== void 0 ? _b : '',\n                    per_page: (_d = (_c = params === null || params === void 0 ? void 0 : params.perPage) === null || _c === void 0 ? void 0 : _c.toString()) !== null && _d !== void 0 ? _d : '',\n                },\n                xform: _noResolveJsonResponse,\n            });\n            if (response.error)\n                throw response.error;\n            const users = await response.json();\n            const total = (_e = response.headers.get('x-total-count')) !== null && _e !== void 0 ? _e : 0;\n            const links = (_g = (_f = response.headers.get('link')) === null || _f === void 0 ? void 0 : _f.split(',')) !== null && _g !== void 0 ? _g : [];\n            if (links.length > 0) {\n                links.forEach((link) => {\n                    const page = parseInt(link.split(';')[0].split('=')[1].substring(0, 1));\n                    const rel = JSON.parse(link.split(';')[1].split('=')[1]);\n                    pagination[`${rel}Page`] = page;\n                });\n                pagination.total = parseInt(total);\n            }\n            return { data: Object.assign(Object.assign({}, users), pagination), error: null };\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: { users: [] }, error };\n            }\n            throw error;\n        }\n    }\n    /**\n     * Get user by id.\n     *\n     * @param uid The user's unique identifier\n     *\n     * This function should only be called on a server. Never expose your `service_role` key in the browser.\n     */\n    async getUserById(uid) {\n        validateUUID(uid);\n        try {\n            return await _request(this.fetch, 'GET', `${this.url}/admin/users/${uid}`, {\n                headers: this.headers,\n                xform: _userResponse,\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: { user: null }, error };\n            }\n            throw error;\n        }\n    }\n    /**\n     * Updates the user data.\n     *\n     * @param attributes The data you want to update.\n     *\n     * This function should only be called on a server. Never expose your `service_role` key in the browser.\n     */\n    async updateUserById(uid, attributes) {\n        validateUUID(uid);\n        try {\n            return await _request(this.fetch, 'PUT', `${this.url}/admin/users/${uid}`, {\n                body: attributes,\n                headers: this.headers,\n                xform: _userResponse,\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: { user: null }, error };\n            }\n            throw error;\n        }\n    }\n    /**\n     * Delete a user. Requires a `service_role` key.\n     *\n     * @param id The user id you want to remove.\n     * @param shouldSoftDelete If true, then the user will be soft-deleted from the auth schema. Soft deletion allows user identification from the hashed user ID but is not reversible.\n     * Defaults to false for backward compatibility.\n     *\n     * This function should only be called on a server. Never expose your `service_role` key in the browser.\n     */\n    async deleteUser(id, shouldSoftDelete = false) {\n        validateUUID(id);\n        try {\n            return await _request(this.fetch, 'DELETE', `${this.url}/admin/users/${id}`, {\n                headers: this.headers,\n                body: {\n                    should_soft_delete: shouldSoftDelete,\n                },\n                xform: _userResponse,\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: { user: null }, error };\n            }\n            throw error;\n        }\n    }\n    async _listFactors(params) {\n        validateUUID(params.userId);\n        try {\n            const { data, error } = await _request(this.fetch, 'GET', `${this.url}/admin/users/${params.userId}/factors`, {\n                headers: this.headers,\n                xform: (factors) => {\n                    return { data: { factors }, error: null };\n                },\n            });\n            return { data, error };\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: null, error };\n            }\n            throw error;\n        }\n    }\n    async _deleteFactor(params) {\n        validateUUID(params.userId);\n        validateUUID(params.id);\n        try {\n            const data = await _request(this.fetch, 'DELETE', `${this.url}/admin/users/${params.userId}/factors/${params.id}`, {\n                headers: this.headers,\n            });\n            return { data, error: null };\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: null, error };\n            }\n            throw error;\n        }\n    }\n    /**\n     * Lists all OAuth clients with optional pagination.\n     * Only relevant when the OAuth 2.1 server is enabled in Supabase Auth.\n     *\n     * This function should only be called on a server. Never expose your `service_role` key in the browser.\n     */\n    async _listOAuthClients(params) {\n        var _a, _b, _c, _d, _e, _f, _g;\n        try {\n            const pagination = { nextPage: null, lastPage: 0, total: 0 };\n            const response = await _request(this.fetch, 'GET', `${this.url}/admin/oauth/clients`, {\n                headers: this.headers,\n                noResolveJson: true,\n                query: {\n                    page: (_b = (_a = params === null || params === void 0 ? void 0 : params.page) === null || _a === void 0 ? void 0 : _a.toString()) !== null && _b !== void 0 ? _b : '',\n                    per_page: (_d = (_c = params === null || params === void 0 ? void 0 : params.perPage) === null || _c === void 0 ? void 0 : _c.toString()) !== null && _d !== void 0 ? _d : '',\n                },\n                xform: _noResolveJsonResponse,\n            });\n            if (response.error)\n                throw response.error;\n            const clients = await response.json();\n            const total = (_e = response.headers.get('x-total-count')) !== null && _e !== void 0 ? _e : 0;\n            const links = (_g = (_f = response.headers.get('link')) === null || _f === void 0 ? void 0 : _f.split(',')) !== null && _g !== void 0 ? _g : [];\n            if (links.length > 0) {\n                links.forEach((link) => {\n                    const page = parseInt(link.split(';')[0].split('=')[1].substring(0, 1));\n                    const rel = JSON.parse(link.split(';')[1].split('=')[1]);\n                    pagination[`${rel}Page`] = page;\n                });\n                pagination.total = parseInt(total);\n            }\n            return { data: Object.assign(Object.assign({}, clients), pagination), error: null };\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: { clients: [] }, error };\n            }\n            throw error;\n        }\n    }\n    /**\n     * Creates a new OAuth client.\n     * Only relevant when the OAuth 2.1 server is enabled in Supabase Auth.\n     *\n     * This function should only be called on a server. Never expose your `service_role` key in the browser.\n     */\n    async _createOAuthClient(params) {\n        try {\n            return await _request(this.fetch, 'POST', `${this.url}/admin/oauth/clients`, {\n                body: params,\n                headers: this.headers,\n                xform: (client) => {\n                    return { data: client, error: null };\n                },\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: null, error };\n            }\n            throw error;\n        }\n    }\n    /**\n     * Gets details of a specific OAuth client.\n     * Only relevant when the OAuth 2.1 server is enabled in Supabase Auth.\n     *\n     * This function should only be called on a server. Never expose your `service_role` key in the browser.\n     */\n    async _getOAuthClient(clientId) {\n        try {\n            return await _request(this.fetch, 'GET', `${this.url}/admin/oauth/clients/${clientId}`, {\n                headers: this.headers,\n                xform: (client) => {\n                    return { data: client, error: null };\n                },\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: null, error };\n            }\n            throw error;\n        }\n    }\n    /**\n     * Updates an existing OAuth client.\n     * Only relevant when the OAuth 2.1 server is enabled in Supabase Auth.\n     *\n     * This function should only be called on a server. Never expose your `service_role` key in the browser.\n     */\n    async _updateOAuthClient(clientId, params) {\n        try {\n            return await _request(this.fetch, 'PUT', `${this.url}/admin/oauth/clients/${clientId}`, {\n                body: params,\n                headers: this.headers,\n                xform: (client) => {\n                    return { data: client, error: null };\n                },\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: null, error };\n            }\n            throw error;\n        }\n    }\n    /**\n     * Deletes an OAuth client.\n     * Only relevant when the OAuth 2.1 server is enabled in Supabase Auth.\n     *\n     * This function should only be called on a server. Never expose your `service_role` key in the browser.\n     */\n    async _deleteOAuthClient(clientId) {\n        try {\n            await _request(this.fetch, 'DELETE', `${this.url}/admin/oauth/clients/${clientId}`, {\n                headers: this.headers,\n                noResolveJson: true,\n            });\n            return { data: null, error: null };\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: null, error };\n            }\n            throw error;\n        }\n    }\n    /**\n     * Regenerates the secret for an OAuth client.\n     * Only relevant when the OAuth 2.1 server is enabled in Supabase Auth.\n     *\n     * This function should only be called on a server. Never expose your `service_role` key in the browser.\n     */\n    async _regenerateOAuthClientSecret(clientId) {\n        try {\n            return await _request(this.fetch, 'POST', `${this.url}/admin/oauth/clients/${clientId}/regenerate_secret`, {\n                headers: this.headers,\n                xform: (client) => {\n                    return { data: client, error: null };\n                },\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: null, error };\n            }\n            throw error;\n        }\n    }\n}\n//# sourceMappingURL=GoTrueAdminApi.js.map","/**\n * Returns a localStorage-like object that stores the key-value pairs in\n * memory.\n */\nexport function memoryLocalStorageAdapter(store = {}) {\n    return {\n        getItem: (key) => {\n            return store[key] || null;\n        },\n        setItem: (key, value) => {\n            store[key] = value;\n        },\n        removeItem: (key) => {\n            delete store[key];\n        },\n    };\n}\n//# sourceMappingURL=local-storage.js.map","import { supportsLocalStorage } from './helpers';\n/**\n * @experimental\n */\nexport const internals = {\n    /**\n     * @experimental\n     */\n    debug: !!(globalThis &&\n        supportsLocalStorage() &&\n        globalThis.localStorage &&\n        globalThis.localStorage.getItem('supabase.gotrue-js.locks.debug') === 'true'),\n};\n/**\n * An error thrown when a lock cannot be acquired after some amount of time.\n *\n * Use the {@link #isAcquireTimeout} property instead of checking with `instanceof`.\n */\nexport class LockAcquireTimeoutError extends Error {\n    constructor(message) {\n        super(message);\n        this.isAcquireTimeout = true;\n    }\n}\nexport class NavigatorLockAcquireTimeoutError extends LockAcquireTimeoutError {\n}\nexport class ProcessLockAcquireTimeoutError extends LockAcquireTimeoutError {\n}\n/**\n * Implements a global exclusive lock using the Navigator LockManager API. It\n * is available on all browsers released after 2022-03-15 with Safari being the\n * last one to release support. If the API is not available, this function will\n * throw. Make sure you check availablility before configuring {@link\n * GoTrueClient}.\n *\n * You can turn on debugging by setting the `supabase.gotrue-js.locks.debug`\n * local storage item to `true`.\n *\n * Internals:\n *\n * Since the LockManager API does not preserve stack traces for the async\n * function passed in the `request` method, a trick is used where acquiring the\n * lock releases a previously started promise to run the operation in the `fn`\n * function. The lock waits for that promise to finish (with or without error),\n * while the function will finally wait for the result anyway.\n *\n * @param name Name of the lock to be acquired.\n * @param acquireTimeout If negative, no timeout. If 0 an error is thrown if\n *                       the lock can't be acquired without waiting. If positive, the lock acquire\n *                       will time out after so many milliseconds. An error is\n *                       a timeout if it has `isAcquireTimeout` set to true.\n * @param fn The operation to run once the lock is acquired.\n */\nexport async function navigatorLock(name, acquireTimeout, fn) {\n    if (internals.debug) {\n        console.log('@supabase/gotrue-js: navigatorLock: acquire lock', name, acquireTimeout);\n    }\n    const abortController = new globalThis.AbortController();\n    if (acquireTimeout > 0) {\n        setTimeout(() => {\n            abortController.abort();\n            if (internals.debug) {\n                console.log('@supabase/gotrue-js: navigatorLock acquire timed out', name);\n            }\n        }, acquireTimeout);\n    }\n    // MDN article: https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request\n    // Wrapping navigator.locks.request() with a plain Promise is done as some\n    // libraries like zone.js patch the Promise object to track the execution\n    // context. However, it appears that most browsers use an internal promise\n    // implementation when using the navigator.locks.request() API causing them\n    // to lose context and emit confusing log messages or break certain features.\n    // This wrapping is believed to help zone.js track the execution context\n    // better.\n    return await Promise.resolve().then(() => globalThis.navigator.locks.request(name, acquireTimeout === 0\n        ? {\n            mode: 'exclusive',\n            ifAvailable: true,\n        }\n        : {\n            mode: 'exclusive',\n            signal: abortController.signal,\n        }, async (lock) => {\n        if (lock) {\n            if (internals.debug) {\n                console.log('@supabase/gotrue-js: navigatorLock: acquired', name, lock.name);\n            }\n            try {\n                return await fn();\n            }\n            finally {\n                if (internals.debug) {\n                    console.log('@supabase/gotrue-js: navigatorLock: released', name, lock.name);\n                }\n            }\n        }\n        else {\n            if (acquireTimeout === 0) {\n                if (internals.debug) {\n                    console.log('@supabase/gotrue-js: navigatorLock: not immediately available', name);\n                }\n                throw new NavigatorLockAcquireTimeoutError(`Acquiring an exclusive Navigator LockManager lock \"${name}\" immediately failed`);\n            }\n            else {\n                if (internals.debug) {\n                    try {\n                        const result = await globalThis.navigator.locks.query();\n                        console.log('@supabase/gotrue-js: Navigator LockManager state', JSON.stringify(result, null, '  '));\n                    }\n                    catch (e) {\n                        console.warn('@supabase/gotrue-js: Error when querying Navigator LockManager state', e);\n                    }\n                }\n                // Browser is not following the Navigator LockManager spec, it\n                // returned a null lock when we didn't use ifAvailable. So we can\n                // pretend the lock is acquired in the name of backward compatibility\n                // and user experience and just run the function.\n                console.warn('@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request');\n                return await fn();\n            }\n        }\n    }));\n}\nconst PROCESS_LOCKS = {};\n/**\n * Implements a global exclusive lock that works only in the current process.\n * Useful for environments like React Native or other non-browser\n * single-process (i.e. no concept of \"tabs\") environments.\n *\n * Use {@link #navigatorLock} in browser environments.\n *\n * @param name Name of the lock to be acquired.\n * @param acquireTimeout If negative, no timeout. If 0 an error is thrown if\n *                       the lock can't be acquired without waiting. If positive, the lock acquire\n *                       will time out after so many milliseconds. An error is\n *                       a timeout if it has `isAcquireTimeout` set to true.\n * @param fn The operation to run once the lock is acquired.\n */\nexport async function processLock(name, acquireTimeout, fn) {\n    var _a;\n    const previousOperation = (_a = PROCESS_LOCKS[name]) !== null && _a !== void 0 ? _a : Promise.resolve();\n    const currentOperation = Promise.race([\n        previousOperation.catch(() => {\n            // ignore error of previous operation that we're waiting to finish\n            return null;\n        }),\n        acquireTimeout >= 0\n            ? new Promise((_, reject) => {\n                setTimeout(() => {\n                    reject(new ProcessLockAcquireTimeoutError(`Acquring process lock with name \"${name}\" timed out`));\n                }, acquireTimeout);\n            })\n            : null,\n    ].filter((x) => x))\n        .catch((e) => {\n        if (e && e.isAcquireTimeout) {\n            throw e;\n        }\n        return null;\n    })\n        .then(async () => {\n        // previous operations finished and we didn't get a race on the acquire\n        // timeout, so the current operation can finally start\n        return await fn();\n    });\n    PROCESS_LOCKS[name] = currentOperation.catch(async (e) => {\n        if (e && e.isAcquireTimeout) {\n            // if the current operation timed out, it doesn't mean that the previous\n            // operation finished, so we need contnue waiting for it to finish\n            await previousOperation;\n            return null;\n        }\n        throw e;\n    });\n    // finally wait for the current operation to finish successfully, with an\n    // error or with an acquire timeout error\n    return await currentOperation;\n}\n//# sourceMappingURL=locks.js.map","/**\n * https://mathiasbynens.be/notes/globalthis\n */\nexport function polyfillGlobalThis() {\n    if (typeof globalThis === 'object')\n        return;\n    try {\n        Object.defineProperty(Object.prototype, '__magic__', {\n            get: function () {\n                return this;\n            },\n            configurable: true,\n        });\n        // @ts-expect-error 'Allow access to magic'\n        __magic__.globalThis = __magic__;\n        // @ts-expect-error 'Allow access to magic'\n        delete Object.prototype.__magic__;\n    }\n    catch (e) {\n        if (typeof self !== 'undefined') {\n            // @ts-expect-error 'Allow access to globals'\n            self.globalThis = self;\n        }\n    }\n}\n//# sourceMappingURL=polyfills.js.map","// types and functions copied over from viem so this library doesn't depend on it\nexport function getAddress(address) {\n    if (!/^0x[a-fA-F0-9]{40}$/.test(address)) {\n        throw new Error(`@supabase/auth-js: Address \"${address}\" is invalid.`);\n    }\n    return address.toLowerCase();\n}\nexport function fromHex(hex) {\n    return parseInt(hex, 16);\n}\nexport function toHex(value) {\n    const bytes = new TextEncoder().encode(value);\n    const hex = Array.from(bytes, (byte) => byte.toString(16).padStart(2, '0')).join('');\n    return ('0x' + hex);\n}\n/**\n * Creates EIP-4361 formatted message.\n */\nexport function createSiweMessage(parameters) {\n    var _a;\n    const { chainId, domain, expirationTime, issuedAt = new Date(), nonce, notBefore, requestId, resources, scheme, uri, version, } = parameters;\n    // Validate fields\n    {\n        if (!Number.isInteger(chainId))\n            throw new Error(`@supabase/auth-js: Invalid SIWE message field \"chainId\". Chain ID must be a EIP-155 chain ID. Provided value: ${chainId}`);\n        if (!domain)\n            throw new Error(`@supabase/auth-js: Invalid SIWE message field \"domain\". Domain must be provided.`);\n        if (nonce && nonce.length < 8)\n            throw new Error(`@supabase/auth-js: Invalid SIWE message field \"nonce\". Nonce must be at least 8 characters. Provided value: ${nonce}`);\n        if (!uri)\n            throw new Error(`@supabase/auth-js: Invalid SIWE message field \"uri\". URI must be provided.`);\n        if (version !== '1')\n            throw new Error(`@supabase/auth-js: Invalid SIWE message field \"version\". Version must be '1'. Provided value: ${version}`);\n        if ((_a = parameters.statement) === null || _a === void 0 ? void 0 : _a.includes('\\n'))\n            throw new Error(`@supabase/auth-js: Invalid SIWE message field \"statement\". Statement must not include '\\\\n'. Provided value: ${parameters.statement}`);\n    }\n    // Construct message\n    const address = getAddress(parameters.address);\n    const origin = scheme ? `${scheme}://${domain}` : domain;\n    const statement = parameters.statement ? `${parameters.statement}\\n` : '';\n    const prefix = `${origin} wants you to sign in with your Ethereum account:\\n${address}\\n\\n${statement}`;\n    let suffix = `URI: ${uri}\\nVersion: ${version}\\nChain ID: ${chainId}${nonce ? `\\nNonce: ${nonce}` : ''}\\nIssued At: ${issuedAt.toISOString()}`;\n    if (expirationTime)\n        suffix += `\\nExpiration Time: ${expirationTime.toISOString()}`;\n    if (notBefore)\n        suffix += `\\nNot Before: ${notBefore.toISOString()}`;\n    if (requestId)\n        suffix += `\\nRequest ID: ${requestId}`;\n    if (resources) {\n        let content = '\\nResources:';\n        for (const resource of resources) {\n            if (!resource || typeof resource !== 'string')\n                throw new Error(`@supabase/auth-js: Invalid SIWE message field \"resources\". Every resource must be a valid string. Provided value: ${resource}`);\n            content += `\\n- ${resource}`;\n        }\n        suffix += content;\n    }\n    return `${prefix}\\n${suffix}`;\n}\n//# sourceMappingURL=ethereum.js.map","/* eslint-disable @typescript-eslint/ban-ts-comment */\nimport { isValidDomain } from './webauthn';\n/**\n * A custom Error used to return a more nuanced error detailing _why_ one of the eight documented\n * errors in the spec was raised after calling `navigator.credentials.create()` or\n * `navigator.credentials.get()`:\n *\n * - `AbortError`\n * - `ConstraintError`\n * - `InvalidStateError`\n * - `NotAllowedError`\n * - `NotSupportedError`\n * - `SecurityError`\n * - `TypeError`\n * - `UnknownError`\n *\n * Error messages were determined through investigation of the spec to determine under which\n * scenarios a given error would be raised.\n */\nexport class WebAuthnError extends Error {\n    constructor({ message, code, cause, name, }) {\n        var _a;\n        // @ts-ignore: help Rollup understand that `cause` is okay to set\n        super(message, { cause });\n        this.__isWebAuthnError = true;\n        this.name = (_a = name !== null && name !== void 0 ? name : (cause instanceof Error ? cause.name : undefined)) !== null && _a !== void 0 ? _a : 'Unknown Error';\n        this.code = code;\n    }\n}\n/**\n * Error class for unknown WebAuthn errors.\n * Wraps unexpected errors that don't match known WebAuthn error conditions.\n */\nexport class WebAuthnUnknownError extends WebAuthnError {\n    constructor(message, originalError) {\n        super({\n            code: 'ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY',\n            cause: originalError,\n            message,\n        });\n        this.name = 'WebAuthnUnknownError';\n        this.originalError = originalError;\n    }\n}\n/**\n * Type guard to check if an error is a WebAuthnError.\n * @param {unknown} error - The error to check\n * @returns {boolean} True if the error is a WebAuthnError\n */\nexport function isWebAuthnError(error) {\n    return typeof error === 'object' && error !== null && '__isWebAuthnError' in error;\n}\n/**\n * Attempt to intuit _why_ an error was raised after calling `navigator.credentials.create()`.\n * Maps browser errors to specific WebAuthn error codes for better debugging.\n * @param {Object} params - Error identification parameters\n * @param {Error} params.error - The error thrown by the browser\n * @param {CredentialCreationOptions} params.options - The options passed to credentials.create()\n * @returns {WebAuthnError} A WebAuthnError with a specific error code\n * @see {@link https://w3c.github.io/webauthn/#sctn-createCredential W3C WebAuthn Spec - Create Credential}\n */\nexport function identifyRegistrationError({ error, options, }) {\n    var _a, _b, _c;\n    const { publicKey } = options;\n    if (!publicKey) {\n        throw Error('options was missing required publicKey property');\n    }\n    if (error.name === 'AbortError') {\n        if (options.signal instanceof AbortSignal) {\n            // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 16)\n            return new WebAuthnError({\n                message: 'Registration ceremony was sent an abort signal',\n                code: 'ERROR_CEREMONY_ABORTED',\n                cause: error,\n            });\n        }\n    }\n    else if (error.name === 'ConstraintError') {\n        if (((_a = publicKey.authenticatorSelection) === null || _a === void 0 ? void 0 : _a.requireResidentKey) === true) {\n            // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 4)\n            return new WebAuthnError({\n                message: 'Discoverable credentials were required but no available authenticator supported it',\n                code: 'ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT',\n                cause: error,\n            });\n        }\n        else if (\n        // @ts-ignore: `mediation` doesn't yet exist on CredentialCreationOptions but it's possible as of Sept 2024\n        options.mediation === 'conditional' &&\n            ((_b = publicKey.authenticatorSelection) === null || _b === void 0 ? void 0 : _b.userVerification) === 'required') {\n            // https://w3c.github.io/webauthn/#sctn-createCredential (Step 22.4)\n            return new WebAuthnError({\n                message: 'User verification was required during automatic registration but it could not be performed',\n                code: 'ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE',\n                cause: error,\n            });\n        }\n        else if (((_c = publicKey.authenticatorSelection) === null || _c === void 0 ? void 0 : _c.userVerification) === 'required') {\n            // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 5)\n            return new WebAuthnError({\n                message: 'User verification was required but no available authenticator supported it',\n                code: 'ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT',\n                cause: error,\n            });\n        }\n    }\n    else if (error.name === 'InvalidStateError') {\n        // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 20)\n        // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 3)\n        return new WebAuthnError({\n            message: 'The authenticator was previously registered',\n            code: 'ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED',\n            cause: error,\n        });\n    }\n    else if (error.name === 'NotAllowedError') {\n        /**\n         * Pass the error directly through. Platforms are overloading this error beyond what the spec\n         * defines and we don't want to overwrite potentially useful error messages.\n         */\n        return new WebAuthnError({\n            message: error.message,\n            code: 'ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY',\n            cause: error,\n        });\n    }\n    else if (error.name === 'NotSupportedError') {\n        const validPubKeyCredParams = publicKey.pubKeyCredParams.filter((param) => param.type === 'public-key');\n        if (validPubKeyCredParams.length === 0) {\n            // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 10)\n            return new WebAuthnError({\n                message: 'No entry in pubKeyCredParams was of type \"public-key\"',\n                code: 'ERROR_MALFORMED_PUBKEYCREDPARAMS',\n                cause: error,\n            });\n        }\n        // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 2)\n        return new WebAuthnError({\n            message: 'No available authenticator supported any of the specified pubKeyCredParams algorithms',\n            code: 'ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG',\n            cause: error,\n        });\n    }\n    else if (error.name === 'SecurityError') {\n        const effectiveDomain = window.location.hostname;\n        if (!isValidDomain(effectiveDomain)) {\n            // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 7)\n            return new WebAuthnError({\n                message: `${window.location.hostname} is an invalid domain`,\n                code: 'ERROR_INVALID_DOMAIN',\n                cause: error,\n            });\n        }\n        else if (publicKey.rp.id !== effectiveDomain) {\n            // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 8)\n            return new WebAuthnError({\n                message: `The RP ID \"${publicKey.rp.id}\" is invalid for this domain`,\n                code: 'ERROR_INVALID_RP_ID',\n                cause: error,\n            });\n        }\n    }\n    else if (error.name === 'TypeError') {\n        if (publicKey.user.id.byteLength < 1 || publicKey.user.id.byteLength > 64) {\n            // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 5)\n            return new WebAuthnError({\n                message: 'User ID was not between 1 and 64 characters',\n                code: 'ERROR_INVALID_USER_ID_LENGTH',\n                cause: error,\n            });\n        }\n    }\n    else if (error.name === 'UnknownError') {\n        // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 1)\n        // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 8)\n        return new WebAuthnError({\n            message: 'The authenticator was unable to process the specified options, or could not create a new credential',\n            code: 'ERROR_AUTHENTICATOR_GENERAL_ERROR',\n            cause: error,\n        });\n    }\n    return new WebAuthnError({\n        message: 'a Non-Webauthn related error has occurred',\n        code: 'ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY',\n        cause: error,\n    });\n}\n/**\n * Attempt to intuit _why_ an error was raised after calling `navigator.credentials.get()`.\n * Maps browser errors to specific WebAuthn error codes for better debugging.\n * @param {Object} params - Error identification parameters\n * @param {Error} params.error - The error thrown by the browser\n * @param {CredentialRequestOptions} params.options - The options passed to credentials.get()\n * @returns {WebAuthnError} A WebAuthnError with a specific error code\n * @see {@link https://w3c.github.io/webauthn/#sctn-getAssertion W3C WebAuthn Spec - Get Assertion}\n */\nexport function identifyAuthenticationError({ error, options, }) {\n    const { publicKey } = options;\n    if (!publicKey) {\n        throw Error('options was missing required publicKey property');\n    }\n    if (error.name === 'AbortError') {\n        if (options.signal instanceof AbortSignal) {\n            // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 16)\n            return new WebAuthnError({\n                message: 'Authentication ceremony was sent an abort signal',\n                code: 'ERROR_CEREMONY_ABORTED',\n                cause: error,\n            });\n        }\n    }\n    else if (error.name === 'NotAllowedError') {\n        /**\n         * Pass the error directly through. Platforms are overloading this error beyond what the spec\n         * defines and we don't want to overwrite potentially useful error messages.\n         */\n        return new WebAuthnError({\n            message: error.message,\n            code: 'ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY',\n            cause: error,\n        });\n    }\n    else if (error.name === 'SecurityError') {\n        const effectiveDomain = window.location.hostname;\n        if (!isValidDomain(effectiveDomain)) {\n            // https://www.w3.org/TR/webauthn-2/#sctn-discover-from-external-source (Step 5)\n            return new WebAuthnError({\n                message: `${window.location.hostname} is an invalid domain`,\n                code: 'ERROR_INVALID_DOMAIN',\n                cause: error,\n            });\n        }\n        else if (publicKey.rpId !== effectiveDomain) {\n            // https://www.w3.org/TR/webauthn-2/#sctn-discover-from-external-source (Step 6)\n            return new WebAuthnError({\n                message: `The RP ID \"${publicKey.rpId}\" is invalid for this domain`,\n                code: 'ERROR_INVALID_RP_ID',\n                cause: error,\n            });\n        }\n    }\n    else if (error.name === 'UnknownError') {\n        // https://www.w3.org/TR/webauthn-2/#sctn-op-get-assertion (Step 1)\n        // https://www.w3.org/TR/webauthn-2/#sctn-op-get-assertion (Step 12)\n        return new WebAuthnError({\n            message: 'The authenticator was unable to process the specified options, or could not create a new assertion signature',\n            code: 'ERROR_AUTHENTICATOR_GENERAL_ERROR',\n            cause: error,\n        });\n    }\n    return new WebAuthnError({\n        message: 'a Non-Webauthn related error has occurred',\n        code: 'ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY',\n        cause: error,\n    });\n}\n//# sourceMappingURL=webauthn.errors.js.map","import { __rest } from \"tslib\";\nimport { base64UrlToUint8Array, bytesToBase64URL } from './base64url';\nimport { AuthError, AuthUnknownError, isAuthError } from './errors';\nimport { isBrowser } from './helpers';\nimport { identifyAuthenticationError, identifyRegistrationError, isWebAuthnError, WebAuthnError, WebAuthnUnknownError, } from './webauthn.errors';\nexport { WebAuthnError, isWebAuthnError, identifyRegistrationError, identifyAuthenticationError };\n/**\n * WebAuthn abort service to manage ceremony cancellation.\n * Ensures only one WebAuthn ceremony is active at a time to prevent \"operation already in progress\" errors.\n *\n * @experimental This class is experimental and may change in future releases\n * @see {@link https://w3c.github.io/webauthn/#sctn-automation-webdriver-capability W3C WebAuthn Spec - Aborting Ceremonies}\n */\nexport class WebAuthnAbortService {\n    /**\n     * Create an abort signal for a new WebAuthn operation.\n     * Automatically cancels any existing operation.\n     *\n     * @returns {AbortSignal} Signal to pass to navigator.credentials.create() or .get()\n     * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/AbortSignal MDN - AbortSignal}\n     */\n    createNewAbortSignal() {\n        // Abort any existing calls to navigator.credentials.create() or navigator.credentials.get()\n        if (this.controller) {\n            const abortError = new Error('Cancelling existing WebAuthn API call for new one');\n            abortError.name = 'AbortError';\n            this.controller.abort(abortError);\n        }\n        const newController = new AbortController();\n        this.controller = newController;\n        return newController.signal;\n    }\n    /**\n     * Manually cancel the current WebAuthn operation.\n     * Useful for cleaning up when user cancels or navigates away.\n     *\n     * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/AbortController/abort MDN - AbortController.abort}\n     */\n    cancelCeremony() {\n        if (this.controller) {\n            const abortError = new Error('Manually cancelling existing WebAuthn API call');\n            abortError.name = 'AbortError';\n            this.controller.abort(abortError);\n            this.controller = undefined;\n        }\n    }\n}\n/**\n * Singleton instance to ensure only one WebAuthn ceremony is active at a time.\n * This prevents \"operation already in progress\" errors when retrying WebAuthn operations.\n *\n * @experimental This instance is experimental and may change in future releases\n */\nexport const webAuthnAbortService = new WebAuthnAbortService();\n/**\n * Convert base64url encoded strings in WebAuthn credential creation options to ArrayBuffers\n * as required by the WebAuthn browser API.\n * Supports both native WebAuthn Level 3 parseCreationOptionsFromJSON and manual fallback.\n *\n * @param {ServerCredentialCreationOptions} options - JSON options from server with base64url encoded fields\n * @returns {PublicKeyCredentialCreationOptionsFuture} Options ready for navigator.credentials.create()\n * @see {@link https://w3c.github.io/webauthn/#sctn-parseCreationOptionsFromJSON W3C WebAuthn Spec - parseCreationOptionsFromJSON}\n */\nexport function deserializeCredentialCreationOptions(options) {\n    if (!options) {\n        throw new Error('Credential creation options are required');\n    }\n    // Check if the native parseCreationOptionsFromJSON method is available\n    if (typeof PublicKeyCredential !== 'undefined' &&\n        'parseCreationOptionsFromJSON' in PublicKeyCredential &&\n        typeof PublicKeyCredential\n            .parseCreationOptionsFromJSON === 'function') {\n        // Use the native WebAuthn Level 3 method\n        return PublicKeyCredential.parseCreationOptionsFromJSON(\n        /** we assert the options here as typescript still doesn't know about future webauthn types */\n        options);\n    }\n    // Fallback to manual parsing for browsers that don't support the native method\n    // Destructure to separate fields that need transformation\n    const { challenge: challengeStr, user: userOpts, excludeCredentials } = options, restOptions = __rest(options\n    // Convert challenge from base64url to ArrayBuffer\n    , [\"challenge\", \"user\", \"excludeCredentials\"]);\n    // Convert challenge from base64url to ArrayBuffer\n    const challenge = base64UrlToUint8Array(challengeStr).buffer;\n    // Convert user.id from base64url to ArrayBuffer\n    const user = Object.assign(Object.assign({}, userOpts), { id: base64UrlToUint8Array(userOpts.id).buffer });\n    // Build the result object\n    const result = Object.assign(Object.assign({}, restOptions), { challenge,\n        user });\n    // Only add excludeCredentials if it exists\n    if (excludeCredentials && excludeCredentials.length > 0) {\n        result.excludeCredentials = new Array(excludeCredentials.length);\n        for (let i = 0; i < excludeCredentials.length; i++) {\n            const cred = excludeCredentials[i];\n            result.excludeCredentials[i] = Object.assign(Object.assign({}, cred), { id: base64UrlToUint8Array(cred.id).buffer, type: cred.type || 'public-key', \n                // Cast transports to handle future transport types like \"cable\"\n                transports: cred.transports });\n        }\n    }\n    return result;\n}\n/**\n * Convert base64url encoded strings in WebAuthn credential request options to ArrayBuffers\n * as required by the WebAuthn browser API.\n * Supports both native WebAuthn Level 3 parseRequestOptionsFromJSON and manual fallback.\n *\n * @param {ServerCredentialRequestOptions} options - JSON options from server with base64url encoded fields\n * @returns {PublicKeyCredentialRequestOptionsFuture} Options ready for navigator.credentials.get()\n * @see {@link https://w3c.github.io/webauthn/#sctn-parseRequestOptionsFromJSON W3C WebAuthn Spec - parseRequestOptionsFromJSON}\n */\nexport function deserializeCredentialRequestOptions(options) {\n    if (!options) {\n        throw new Error('Credential request options are required');\n    }\n    // Check if the native parseRequestOptionsFromJSON method is available\n    if (typeof PublicKeyCredential !== 'undefined' &&\n        'parseRequestOptionsFromJSON' in PublicKeyCredential &&\n        typeof PublicKeyCredential\n            .parseRequestOptionsFromJSON === 'function') {\n        // Use the native WebAuthn Level 3 method\n        return PublicKeyCredential.parseRequestOptionsFromJSON(options);\n    }\n    // Fallback to manual parsing for browsers that don't support the native method\n    // Destructure to separate fields that need transformation\n    const { challenge: challengeStr, allowCredentials } = options, restOptions = __rest(options\n    // Convert challenge from base64url to ArrayBuffer\n    , [\"challenge\", \"allowCredentials\"]);\n    // Convert challenge from base64url to ArrayBuffer\n    const challenge = base64UrlToUint8Array(challengeStr).buffer;\n    // Build the result object\n    const result = Object.assign(Object.assign({}, restOptions), { challenge });\n    // Only add allowCredentials if it exists\n    if (allowCredentials && allowCredentials.length > 0) {\n        result.allowCredentials = new Array(allowCredentials.length);\n        for (let i = 0; i < allowCredentials.length; i++) {\n            const cred = allowCredentials[i];\n            result.allowCredentials[i] = Object.assign(Object.assign({}, cred), { id: base64UrlToUint8Array(cred.id).buffer, type: cred.type || 'public-key', \n                // Cast transports to handle future transport types like \"cable\"\n                transports: cred.transports });\n        }\n    }\n    return result;\n}\n/**\n * Convert a registration/enrollment credential response to server format.\n * Serializes binary fields to base64url for JSON transmission.\n * Supports both native WebAuthn Level 3 toJSON and manual fallback.\n *\n * @param {RegistrationCredential} credential - Credential from navigator.credentials.create()\n * @returns {RegistrationResponseJSON} JSON-serializable credential for server\n * @see {@link https://w3c.github.io/webauthn/#dom-publickeycredential-tojson W3C WebAuthn Spec - toJSON}\n */\nexport function serializeCredentialCreationResponse(credential) {\n    var _a;\n    // Check if the credential instance has the toJSON method\n    if ('toJSON' in credential && typeof credential.toJSON === 'function') {\n        // Use the native WebAuthn Level 3 method\n        return credential.toJSON();\n    }\n    const credentialWithAttachment = credential;\n    return {\n        id: credential.id,\n        rawId: credential.id,\n        response: {\n            attestationObject: bytesToBase64URL(new Uint8Array(credential.response.attestationObject)),\n            clientDataJSON: bytesToBase64URL(new Uint8Array(credential.response.clientDataJSON)),\n        },\n        type: 'public-key',\n        clientExtensionResults: credential.getClientExtensionResults(),\n        // Convert null to undefined and cast to AuthenticatorAttachment type\n        authenticatorAttachment: ((_a = credentialWithAttachment.authenticatorAttachment) !== null && _a !== void 0 ? _a : undefined),\n    };\n}\n/**\n * Convert an authentication/verification credential response to server format.\n * Serializes binary fields to base64url for JSON transmission.\n * Supports both native WebAuthn Level 3 toJSON and manual fallback.\n *\n * @param {AuthenticationCredential} credential - Credential from navigator.credentials.get()\n * @returns {AuthenticationResponseJSON} JSON-serializable credential for server\n * @see {@link https://w3c.github.io/webauthn/#dom-publickeycredential-tojson W3C WebAuthn Spec - toJSON}\n */\nexport function serializeCredentialRequestResponse(credential) {\n    var _a;\n    // Check if the credential instance has the toJSON method\n    if ('toJSON' in credential && typeof credential.toJSON === 'function') {\n        // Use the native WebAuthn Level 3 method\n        return credential.toJSON();\n    }\n    // Fallback to manual conversion for browsers that don't support toJSON\n    // Access authenticatorAttachment via type assertion to handle TypeScript version differences\n    // @simplewebauthn/types includes this property but base TypeScript 4.7.4 doesn't\n    const credentialWithAttachment = credential;\n    const clientExtensionResults = credential.getClientExtensionResults();\n    const assertionResponse = credential.response;\n    return {\n        id: credential.id,\n        rawId: credential.id, // W3C spec expects rawId to match id for JSON format\n        response: {\n            authenticatorData: bytesToBase64URL(new Uint8Array(assertionResponse.authenticatorData)),\n            clientDataJSON: bytesToBase64URL(new Uint8Array(assertionResponse.clientDataJSON)),\n            signature: bytesToBase64URL(new Uint8Array(assertionResponse.signature)),\n            userHandle: assertionResponse.userHandle\n                ? bytesToBase64URL(new Uint8Array(assertionResponse.userHandle))\n                : undefined,\n        },\n        type: 'public-key',\n        clientExtensionResults,\n        // Convert null to undefined and cast to AuthenticatorAttachment type\n        authenticatorAttachment: ((_a = credentialWithAttachment.authenticatorAttachment) !== null && _a !== void 0 ? _a : undefined),\n    };\n}\n/**\n * A simple test to determine if a hostname is a properly-formatted domain name.\n * Considers localhost valid for development environments.\n *\n * A \"valid domain\" is defined here: https://url.spec.whatwg.org/#valid-domain\n *\n * Regex sourced from here:\n * https://www.oreilly.com/library/view/regular-expressions-cookbook/9781449327453/ch08s15.html\n *\n * @param {string} hostname - The hostname to validate\n * @returns {boolean} True if valid domain or localhost\n * @see {@link https://url.spec.whatwg.org/#valid-domain WHATWG URL Spec - Valid Domain}\n */\nexport function isValidDomain(hostname) {\n    return (\n    // Consider localhost valid as well since it's okay wrt Secure Contexts\n    hostname === 'localhost' || /^([a-z0-9]+(-[a-z0-9]+)*\\.)+[a-z]{2,}$/i.test(hostname));\n}\n/**\n * Determine if the browser is capable of WebAuthn.\n * Checks for necessary Web APIs: PublicKeyCredential and Credential Management.\n *\n * @returns {boolean} True if browser supports WebAuthn\n * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/PublicKeyCredential#browser_compatibility MDN - PublicKeyCredential Browser Compatibility}\n */\nfunction browserSupportsWebAuthn() {\n    var _a, _b;\n    return !!(isBrowser() &&\n        'PublicKeyCredential' in window &&\n        window.PublicKeyCredential &&\n        'credentials' in navigator &&\n        typeof ((_a = navigator === null || navigator === void 0 ? void 0 : navigator.credentials) === null || _a === void 0 ? void 0 : _a.create) === 'function' &&\n        typeof ((_b = navigator === null || navigator === void 0 ? void 0 : navigator.credentials) === null || _b === void 0 ? void 0 : _b.get) === 'function');\n}\n/**\n * Create a WebAuthn credential using the browser's credentials API.\n * Wraps navigator.credentials.create() with error handling.\n *\n * @param {CredentialCreationOptions} options - Options including publicKey parameters\n * @returns {Promise<RequestResult<RegistrationCredential, WebAuthnError>>} Created credential or error\n * @see {@link https://w3c.github.io/webauthn/#sctn-createCredential W3C WebAuthn Spec - Create Credential}\n * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/CredentialsContainer/create MDN - credentials.create}\n */\nexport async function createCredential(options) {\n    try {\n        const response = await navigator.credentials.create(\n        /** we assert the type here until typescript types are updated */\n        options);\n        if (!response) {\n            return {\n                data: null,\n                error: new WebAuthnUnknownError('Empty credential response', response),\n            };\n        }\n        if (!(response instanceof PublicKeyCredential)) {\n            return {\n                data: null,\n                error: new WebAuthnUnknownError('Browser returned unexpected credential type', response),\n            };\n        }\n        return { data: response, error: null };\n    }\n    catch (err) {\n        return {\n            data: null,\n            error: identifyRegistrationError({\n                error: err,\n                options,\n            }),\n        };\n    }\n}\n/**\n * Get a WebAuthn credential using the browser's credentials API.\n * Wraps navigator.credentials.get() with error handling.\n *\n * @param {CredentialRequestOptions} options - Options including publicKey parameters\n * @returns {Promise<RequestResult<AuthenticationCredential, WebAuthnError>>} Retrieved credential or error\n * @see {@link https://w3c.github.io/webauthn/#sctn-getAssertion W3C WebAuthn Spec - Get Assertion}\n * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/CredentialsContainer/get MDN - credentials.get}\n */\nexport async function getCredential(options) {\n    try {\n        const response = await navigator.credentials.get(\n        /** we assert the type here until typescript types are updated */\n        options);\n        if (!response) {\n            return {\n                data: null,\n                error: new WebAuthnUnknownError('Empty credential response', response),\n            };\n        }\n        if (!(response instanceof PublicKeyCredential)) {\n            return {\n                data: null,\n                error: new WebAuthnUnknownError('Browser returned unexpected credential type', response),\n            };\n        }\n        return { data: response, error: null };\n    }\n    catch (err) {\n        return {\n            data: null,\n            error: identifyAuthenticationError({\n                error: err,\n                options,\n            }),\n        };\n    }\n}\nexport const DEFAULT_CREATION_OPTIONS = {\n    hints: ['security-key'],\n    authenticatorSelection: {\n        authenticatorAttachment: 'cross-platform',\n        requireResidentKey: false,\n        /** set to preferred because older yubikeys don't have PIN/Biometric */\n        userVerification: 'preferred',\n        residentKey: 'discouraged',\n    },\n    attestation: 'none',\n};\nexport const DEFAULT_REQUEST_OPTIONS = {\n    /** set to preferred because older yubikeys don't have PIN/Biometric */\n    userVerification: 'preferred',\n    hints: ['security-key'],\n};\nfunction deepMerge(...sources) {\n    const isObject = (val) => val !== null && typeof val === 'object' && !Array.isArray(val);\n    const isArrayBufferLike = (val) => val instanceof ArrayBuffer || ArrayBuffer.isView(val);\n    const result = {};\n    for (const source of sources) {\n        if (!source)\n            continue;\n        for (const key in source) {\n            const value = source[key];\n            if (value === undefined)\n                continue;\n            if (Array.isArray(value)) {\n                // preserve array reference, including unions like AuthenticatorTransport[]\n                result[key] = value;\n            }\n            else if (isArrayBufferLike(value)) {\n                result[key] = value;\n            }\n            else if (isObject(value)) {\n                const existing = result[key];\n                if (isObject(existing)) {\n                    result[key] = deepMerge(existing, value);\n                }\n                else {\n                    result[key] = deepMerge(value);\n                }\n            }\n            else {\n                result[key] = value;\n            }\n        }\n    }\n    return result;\n}\n/**\n * Merges WebAuthn credential creation options with overrides.\n * Sets sensible defaults for authenticator selection and extensions.\n *\n * @param {PublicKeyCredentialCreationOptionsFuture} baseOptions - The base options from the server\n * @param {PublicKeyCredentialCreationOptionsFuture} overrides - Optional overrides to apply\n * @param {string} friendlyName - Optional friendly name for the credential\n * @returns {PublicKeyCredentialCreationOptionsFuture} Merged credential creation options\n * @see {@link https://w3c.github.io/webauthn/#dictdef-authenticatorselectioncriteria W3C WebAuthn Spec - AuthenticatorSelectionCriteria}\n */\nexport function mergeCredentialCreationOptions(baseOptions, overrides) {\n    return deepMerge(DEFAULT_CREATION_OPTIONS, baseOptions, overrides || {});\n}\n/**\n * Merges WebAuthn credential request options with overrides.\n * Sets sensible defaults for user verification and hints.\n *\n * @param {PublicKeyCredentialRequestOptionsFuture} baseOptions - The base options from the server\n * @param {PublicKeyCredentialRequestOptionsFuture} overrides - Optional overrides to apply\n * @returns {PublicKeyCredentialRequestOptionsFuture} Merged credential request options\n * @see {@link https://w3c.github.io/webauthn/#dictdef-publickeycredentialrequestoptions W3C WebAuthn Spec - PublicKeyCredentialRequestOptions}\n */\nexport function mergeCredentialRequestOptions(baseOptions, overrides) {\n    return deepMerge(DEFAULT_REQUEST_OPTIONS, baseOptions, overrides || {});\n}\n/**\n * WebAuthn API wrapper for Supabase Auth.\n * Provides methods for enrolling, challenging, verifying, authenticating, and registering WebAuthn credentials.\n *\n * @experimental This API is experimental and may change in future releases\n * @see {@link https://w3c.github.io/webauthn/ W3C WebAuthn Specification}\n * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/Web_Authentication_API MDN - Web Authentication API}\n */\nexport class WebAuthnApi {\n    constructor(client) {\n        this.client = client;\n        // Bind all methods so they can be destructured\n        this.enroll = this._enroll.bind(this);\n        this.challenge = this._challenge.bind(this);\n        this.verify = this._verify.bind(this);\n        this.authenticate = this._authenticate.bind(this);\n        this.register = this._register.bind(this);\n    }\n    /**\n     * Enroll a new WebAuthn factor.\n     * Creates an unverified WebAuthn factor that must be verified with a credential.\n     *\n     * @experimental This method is experimental and may change in future releases\n     * @param {Omit<MFAEnrollWebauthnParams, 'factorType'>} params - Enrollment parameters (friendlyName required)\n     * @returns {Promise<AuthMFAEnrollWebauthnResponse>} Enrolled factor details or error\n     * @see {@link https://w3c.github.io/webauthn/#sctn-registering-a-new-credential W3C WebAuthn Spec - Registering a New Credential}\n     */\n    async _enroll(params) {\n        return this.client.mfa.enroll(Object.assign(Object.assign({}, params), { factorType: 'webauthn' }));\n    }\n    /**\n     * Challenge for WebAuthn credential creation or authentication.\n     * Combines server challenge with browser credential operations.\n     * Handles both registration (create) and authentication (request) flows.\n     *\n     * @experimental This method is experimental and may change in future releases\n     * @param {MFAChallengeWebauthnParams & { friendlyName?: string; signal?: AbortSignal }} params - Challenge parameters including factorId\n     * @param {Object} overrides - Allows you to override the parameters passed to navigator.credentials\n     * @param {PublicKeyCredentialCreationOptionsFuture} overrides.create - Override options for credential creation\n     * @param {PublicKeyCredentialRequestOptionsFuture} overrides.request - Override options for credential request\n     * @returns {Promise<RequestResult>} Challenge response with credential or error\n     * @see {@link https://w3c.github.io/webauthn/#sctn-credential-creation W3C WebAuthn Spec - Credential Creation}\n     * @see {@link https://w3c.github.io/webauthn/#sctn-verifying-assertion W3C WebAuthn Spec - Verifying Assertion}\n     */\n    async _challenge({ factorId, webauthn, friendlyName, signal, }, overrides) {\n        try {\n            // Get challenge from server using the client's MFA methods\n            const { data: challengeResponse, error: challengeError } = await this.client.mfa.challenge({\n                factorId,\n                webauthn,\n            });\n            if (!challengeResponse) {\n                return { data: null, error: challengeError };\n            }\n            const abortSignal = signal !== null && signal !== void 0 ? signal : webAuthnAbortService.createNewAbortSignal();\n            /** webauthn will fail if either of the name/displayname are blank */\n            if (challengeResponse.webauthn.type === 'create') {\n                const { user } = challengeResponse.webauthn.credential_options.publicKey;\n                if (!user.name) {\n                    user.name = `${user.id}:${friendlyName}`;\n                }\n                if (!user.displayName) {\n                    user.displayName = user.name;\n                }\n            }\n            switch (challengeResponse.webauthn.type) {\n                case 'create': {\n                    const options = mergeCredentialCreationOptions(challengeResponse.webauthn.credential_options.publicKey, overrides === null || overrides === void 0 ? void 0 : overrides.create);\n                    const { data, error } = await createCredential({\n                        publicKey: options,\n                        signal: abortSignal,\n                    });\n                    if (data) {\n                        return {\n                            data: {\n                                factorId,\n                                challengeId: challengeResponse.id,\n                                webauthn: {\n                                    type: challengeResponse.webauthn.type,\n                                    credential_response: data,\n                                },\n                            },\n                            error: null,\n                        };\n                    }\n                    return { data: null, error };\n                }\n                case 'request': {\n                    const options = mergeCredentialRequestOptions(challengeResponse.webauthn.credential_options.publicKey, overrides === null || overrides === void 0 ? void 0 : overrides.request);\n                    const { data, error } = await getCredential(Object.assign(Object.assign({}, challengeResponse.webauthn.credential_options), { publicKey: options, signal: abortSignal }));\n                    if (data) {\n                        return {\n                            data: {\n                                factorId,\n                                challengeId: challengeResponse.id,\n                                webauthn: {\n                                    type: challengeResponse.webauthn.type,\n                                    credential_response: data,\n                                },\n                            },\n                            error: null,\n                        };\n                    }\n                    return { data: null, error };\n                }\n            }\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: null, error };\n            }\n            return {\n                data: null,\n                error: new AuthUnknownError('Unexpected error in challenge', error),\n            };\n        }\n    }\n    /**\n     * Verify a WebAuthn credential with the server.\n     * Completes the WebAuthn ceremony by sending the credential to the server for verification.\n     *\n     * @experimental This method is experimental and may change in future releases\n     * @param {Object} params - Verification parameters\n     * @param {string} params.challengeId - ID of the challenge being verified\n     * @param {string} params.factorId - ID of the WebAuthn factor\n     * @param {MFAVerifyWebauthnParams<T>['webauthn']} params.webauthn - WebAuthn credential response\n     * @returns {Promise<AuthMFAVerifyResponse>} Verification result with session or error\n     * @see {@link https://w3c.github.io/webauthn/#sctn-verifying-assertion W3C WebAuthn Spec - Verifying an Authentication Assertion}\n     * */\n    async _verify({ challengeId, factorId, webauthn, }) {\n        return this.client.mfa.verify({\n            factorId,\n            challengeId,\n            webauthn: webauthn,\n        });\n    }\n    /**\n     * Complete WebAuthn authentication flow.\n     * Performs challenge and verification in a single operation for existing credentials.\n     *\n     * @experimental This method is experimental and may change in future releases\n     * @param {Object} params - Authentication parameters\n     * @param {string} params.factorId - ID of the WebAuthn factor to authenticate with\n     * @param {Object} params.webauthn - WebAuthn configuration\n     * @param {string} params.webauthn.rpId - Relying Party ID (defaults to current hostname)\n     * @param {string[]} params.webauthn.rpOrigins - Allowed origins (defaults to current origin)\n     * @param {AbortSignal} params.webauthn.signal - Optional abort signal\n     * @param {PublicKeyCredentialRequestOptionsFuture} overrides - Override options for navigator.credentials.get\n     * @returns {Promise<RequestResult<AuthMFAVerifyResponseData, WebAuthnError | AuthError>>} Authentication result\n     * @see {@link https://w3c.github.io/webauthn/#sctn-authentication W3C WebAuthn Spec - Authentication Ceremony}\n     * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/PublicKeyCredentialRequestOptions MDN - PublicKeyCredentialRequestOptions}\n     */\n    async _authenticate({ factorId, webauthn: { rpId = typeof window !== 'undefined' ? window.location.hostname : undefined, rpOrigins = typeof window !== 'undefined' ? [window.location.origin] : undefined, signal, }, }, overrides) {\n        if (!rpId) {\n            return {\n                data: null,\n                error: new AuthError('rpId is required for WebAuthn authentication'),\n            };\n        }\n        try {\n            if (!browserSupportsWebAuthn()) {\n                return {\n                    data: null,\n                    error: new AuthUnknownError('Browser does not support WebAuthn', null),\n                };\n            }\n            // Get challenge and credential\n            const { data: challengeResponse, error: challengeError } = await this.challenge({\n                factorId,\n                webauthn: { rpId, rpOrigins },\n                signal,\n            }, { request: overrides });\n            if (!challengeResponse) {\n                return { data: null, error: challengeError };\n            }\n            const { webauthn } = challengeResponse;\n            // Verify credential\n            return this._verify({\n                factorId,\n                challengeId: challengeResponse.challengeId,\n                webauthn: {\n                    type: webauthn.type,\n                    rpId,\n                    rpOrigins,\n                    credential_response: webauthn.credential_response,\n                },\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: null, error };\n            }\n            return {\n                data: null,\n                error: new AuthUnknownError('Unexpected error in authenticate', error),\n            };\n        }\n    }\n    /**\n     * Complete WebAuthn registration flow.\n     * Performs enrollment, challenge, and verification in a single operation for new credentials.\n     *\n     * @experimental This method is experimental and may change in future releases\n     * @param {Object} params - Registration parameters\n     * @param {string} params.friendlyName - User-friendly name for the credential\n     * @param {string} params.rpId - Relying Party ID (defaults to current hostname)\n     * @param {string[]} params.rpOrigins - Allowed origins (defaults to current origin)\n     * @param {AbortSignal} params.signal - Optional abort signal\n     * @param {PublicKeyCredentialCreationOptionsFuture} overrides - Override options for navigator.credentials.create\n     * @returns {Promise<RequestResult<AuthMFAVerifyResponseData, WebAuthnError | AuthError>>} Registration result\n     * @see {@link https://w3c.github.io/webauthn/#sctn-registering-a-new-credential W3C WebAuthn Spec - Registration Ceremony}\n     * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/PublicKeyCredentialCreationOptions MDN - PublicKeyCredentialCreationOptions}\n     */\n    async _register({ friendlyName, rpId = typeof window !== 'undefined' ? window.location.hostname : undefined, rpOrigins = typeof window !== 'undefined' ? [window.location.origin] : undefined, signal, }, overrides) {\n        if (!rpId) {\n            return {\n                data: null,\n                error: new AuthError('rpId is required for WebAuthn registration'),\n            };\n        }\n        try {\n            if (!browserSupportsWebAuthn()) {\n                return {\n                    data: null,\n                    error: new AuthUnknownError('Browser does not support WebAuthn', null),\n                };\n            }\n            // Enroll factor\n            const { data: factor, error: enrollError } = await this._enroll({\n                friendlyName,\n            });\n            if (!factor) {\n                await this.client.mfa\n                    .listFactors()\n                    .then((factors) => {\n                    var _a;\n                    return (_a = factors.data) === null || _a === void 0 ? void 0 : _a.all.find((v) => v.factor_type === 'webauthn' &&\n                        v.friendly_name === friendlyName &&\n                        v.status !== 'unverified');\n                })\n                    .then((factor) => (factor ? this.client.mfa.unenroll({ factorId: factor === null || factor === void 0 ? void 0 : factor.id }) : void 0));\n                return { data: null, error: enrollError };\n            }\n            // Get challenge and create credential\n            const { data: challengeResponse, error: challengeError } = await this._challenge({\n                factorId: factor.id,\n                friendlyName: factor.friendly_name,\n                webauthn: { rpId, rpOrigins },\n                signal,\n            }, {\n                create: overrides,\n            });\n            if (!challengeResponse) {\n                return { data: null, error: challengeError };\n            }\n            return this._verify({\n                factorId: factor.id,\n                challengeId: challengeResponse.challengeId,\n                webauthn: {\n                    rpId,\n                    rpOrigins,\n                    type: challengeResponse.webauthn.type,\n                    credential_response: challengeResponse.webauthn.credential_response,\n                },\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: null, error };\n            }\n            return {\n                data: null,\n                error: new AuthUnknownError('Unexpected error in register', error),\n            };\n        }\n    }\n}\n//# sourceMappingURL=webauthn.js.map","import GoTrueAdminApi from './GoTrueAdminApi';\nimport { AUTO_REFRESH_TICK_DURATION_MS, AUTO_REFRESH_TICK_THRESHOLD, DEFAULT_HEADERS, EXPIRY_MARGIN_MS, GOTRUE_URL, JWKS_TTL, STORAGE_KEY, } from './lib/constants';\nimport { AuthImplicitGrantRedirectError, AuthInvalidCredentialsError, AuthInvalidJwtError, AuthInvalidTokenResponseError, AuthPKCEGrantCodeExchangeError, AuthSessionMissingError, AuthUnknownError, isAuthApiError, isAuthError, isAuthImplicitGrantRedirectError, isAuthRetryableFetchError, isAuthSessionMissingError, } from './lib/errors';\nimport { _request, _sessionResponse, _sessionResponsePassword, _ssoResponse, _userResponse, } from './lib/fetch';\nimport { decodeJWT, deepClone, Deferred, getAlgorithm, getCodeChallengeAndMethod, getItemAsync, insecureUserWarningProxy, isBrowser, parseParametersFromURL, removeItemAsync, resolveFetch, retryable, setItemAsync, sleep, supportsLocalStorage, userNotAvailableProxy, uuid, validateExp, } from './lib/helpers';\nimport { memoryLocalStorageAdapter } from './lib/local-storage';\nimport { LockAcquireTimeoutError, navigatorLock } from './lib/locks';\nimport { polyfillGlobalThis } from './lib/polyfills';\nimport { version } from './lib/version';\nimport { bytesToBase64URL, stringToUint8Array } from './lib/base64url';\nimport { createSiweMessage, fromHex, getAddress, toHex, } from './lib/web3/ethereum';\nimport { deserializeCredentialCreationOptions, deserializeCredentialRequestOptions, serializeCredentialCreationResponse, serializeCredentialRequestResponse, WebAuthnApi, } from './lib/webauthn';\npolyfillGlobalThis(); // Make \"globalThis\" available\nconst DEFAULT_OPTIONS = {\n    url: GOTRUE_URL,\n    storageKey: STORAGE_KEY,\n    autoRefreshToken: true,\n    persistSession: true,\n    detectSessionInUrl: true,\n    headers: DEFAULT_HEADERS,\n    flowType: 'implicit',\n    debug: false,\n    hasCustomAuthorizationHeader: false,\n    throwOnError: false,\n};\nasync function lockNoOp(name, acquireTimeout, fn) {\n    return await fn();\n}\n/**\n * Caches JWKS values for all clients created in the same environment. This is\n * especially useful for shared-memory execution environments such as Vercel's\n * Fluid Compute, AWS Lambda or Supabase's Edge Functions. Regardless of how\n * many clients are created, if they share the same storage key they will use\n * the same JWKS cache, significantly speeding up getClaims() with asymmetric\n * JWTs.\n */\nconst GLOBAL_JWKS = {};\nclass GoTrueClient {\n    /**\n     * The JWKS used for verifying asymmetric JWTs\n     */\n    get jwks() {\n        var _a, _b;\n        return (_b = (_a = GLOBAL_JWKS[this.storageKey]) === null || _a === void 0 ? void 0 : _a.jwks) !== null && _b !== void 0 ? _b : { keys: [] };\n    }\n    set jwks(value) {\n        GLOBAL_JWKS[this.storageKey] = Object.assign(Object.assign({}, GLOBAL_JWKS[this.storageKey]), { jwks: value });\n    }\n    get jwks_cached_at() {\n        var _a, _b;\n        return (_b = (_a = GLOBAL_JWKS[this.storageKey]) === null || _a === void 0 ? void 0 : _a.cachedAt) !== null && _b !== void 0 ? _b : Number.MIN_SAFE_INTEGER;\n    }\n    set jwks_cached_at(value) {\n        GLOBAL_JWKS[this.storageKey] = Object.assign(Object.assign({}, GLOBAL_JWKS[this.storageKey]), { cachedAt: value });\n    }\n    /**\n     * Create a new client for use in the browser.\n     */\n    constructor(options) {\n        var _a, _b, _c;\n        /**\n         * @experimental\n         */\n        this.userStorage = null;\n        this.memoryStorage = null;\n        this.stateChangeEmitters = new Map();\n        this.autoRefreshTicker = null;\n        this.visibilityChangedCallback = null;\n        this.refreshingDeferred = null;\n        /**\n         * Keeps track of the async client initialization.\n         * When null or not yet resolved the auth state is `unknown`\n         * Once resolved the auth state is known and it's safe to call any further client methods.\n         * Keep extra care to never reject or throw uncaught errors\n         */\n        this.initializePromise = null;\n        this.detectSessionInUrl = true;\n        this.hasCustomAuthorizationHeader = false;\n        this.suppressGetSessionWarning = false;\n        this.lockAcquired = false;\n        this.pendingInLock = [];\n        /**\n         * Used to broadcast state change events to other tabs listening.\n         */\n        this.broadcastChannel = null;\n        this.logger = console.log;\n        const settings = Object.assign(Object.assign({}, DEFAULT_OPTIONS), options);\n        this.storageKey = settings.storageKey;\n        this.instanceID = (_a = GoTrueClient.nextInstanceID[this.storageKey]) !== null && _a !== void 0 ? _a : 0;\n        GoTrueClient.nextInstanceID[this.storageKey] = this.instanceID + 1;\n        this.logDebugMessages = !!settings.debug;\n        if (typeof settings.debug === 'function') {\n            this.logger = settings.debug;\n        }\n        if (this.instanceID > 0 && isBrowser()) {\n            const message = `${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;\n            console.warn(message);\n            if (this.logDebugMessages) {\n                console.trace(message);\n            }\n        }\n        this.persistSession = settings.persistSession;\n        this.autoRefreshToken = settings.autoRefreshToken;\n        this.admin = new GoTrueAdminApi({\n            url: settings.url,\n            headers: settings.headers,\n            fetch: settings.fetch,\n        });\n        this.url = settings.url;\n        this.headers = settings.headers;\n        this.fetch = resolveFetch(settings.fetch);\n        this.lock = settings.lock || lockNoOp;\n        this.detectSessionInUrl = settings.detectSessionInUrl;\n        this.flowType = settings.flowType;\n        this.hasCustomAuthorizationHeader = settings.hasCustomAuthorizationHeader;\n        this.throwOnError = settings.throwOnError;\n        if (settings.lock) {\n            this.lock = settings.lock;\n        }\n        else if (isBrowser() && ((_b = globalThis === null || globalThis === void 0 ? void 0 : globalThis.navigator) === null || _b === void 0 ? void 0 : _b.locks)) {\n            this.lock = navigatorLock;\n        }\n        else {\n            this.lock = lockNoOp;\n        }\n        if (!this.jwks) {\n            this.jwks = { keys: [] };\n            this.jwks_cached_at = Number.MIN_SAFE_INTEGER;\n        }\n        this.mfa = {\n            verify: this._verify.bind(this),\n            enroll: this._enroll.bind(this),\n            unenroll: this._unenroll.bind(this),\n            challenge: this._challenge.bind(this),\n            listFactors: this._listFactors.bind(this),\n            challengeAndVerify: this._challengeAndVerify.bind(this),\n            getAuthenticatorAssuranceLevel: this._getAuthenticatorAssuranceLevel.bind(this),\n            webauthn: new WebAuthnApi(this),\n        };\n        this.oauth = {\n            getAuthorizationDetails: this._getAuthorizationDetails.bind(this),\n            approveAuthorization: this._approveAuthorization.bind(this),\n            denyAuthorization: this._denyAuthorization.bind(this),\n        };\n        if (this.persistSession) {\n            if (settings.storage) {\n                this.storage = settings.storage;\n            }\n            else {\n                if (supportsLocalStorage()) {\n                    this.storage = globalThis.localStorage;\n                }\n                else {\n                    this.memoryStorage = {};\n                    this.storage = memoryLocalStorageAdapter(this.memoryStorage);\n                }\n            }\n            if (settings.userStorage) {\n                this.userStorage = settings.userStorage;\n            }\n        }\n        else {\n            this.memoryStorage = {};\n            this.storage = memoryLocalStorageAdapter(this.memoryStorage);\n        }\n        if (isBrowser() && globalThis.BroadcastChannel && this.persistSession && this.storageKey) {\n            try {\n                this.broadcastChannel = new globalThis.BroadcastChannel(this.storageKey);\n            }\n            catch (e) {\n                console.error('Failed to create a new BroadcastChannel, multi-tab state changes will not be available', e);\n            }\n            (_c = this.broadcastChannel) === null || _c === void 0 ? void 0 : _c.addEventListener('message', async (event) => {\n                this._debug('received broadcast notification from other tab or client', event);\n                await this._notifyAllSubscribers(event.data.event, event.data.session, false); // broadcast = false so we don't get an endless loop of messages\n            });\n        }\n        this.initialize();\n    }\n    /**\n     * Returns whether error throwing mode is enabled for this client.\n     */\n    isThrowOnErrorEnabled() {\n        return this.throwOnError;\n    }\n    /**\n     * Centralizes return handling with optional error throwing. When `throwOnError` is enabled\n     * and the provided result contains a non-nullish error, the error is thrown instead of\n     * being returned. This ensures consistent behavior across all public API methods.\n     */\n    _returnResult(result) {\n        if (this.throwOnError && result && result.error) {\n            throw result.error;\n        }\n        return result;\n    }\n    _logPrefix() {\n        return ('GoTrueClient@' +\n            `${this.storageKey}:${this.instanceID} (${version}) ${new Date().toISOString()}`);\n    }\n    _debug(...args) {\n        if (this.logDebugMessages) {\n            this.logger(this._logPrefix(), ...args);\n        }\n        return this;\n    }\n    /**\n     * Initializes the client session either from the url or from storage.\n     * This method is automatically called when instantiating the client, but should also be called\n     * manually when checking for an error from an auth redirect (oauth, magiclink, password recovery, etc).\n     */\n    async initialize() {\n        if (this.initializePromise) {\n            return await this.initializePromise;\n        }\n        this.initializePromise = (async () => {\n            return await this._acquireLock(-1, async () => {\n                return await this._initialize();\n            });\n        })();\n        return await this.initializePromise;\n    }\n    /**\n     * IMPORTANT:\n     * 1. Never throw in this method, as it is called from the constructor\n     * 2. Never return a session from this method as it would be cached over\n     *    the whole lifetime of the client\n     */\n    async _initialize() {\n        var _a;\n        try {\n            let params = {};\n            let callbackUrlType = 'none';\n            if (isBrowser()) {\n                params = parseParametersFromURL(window.location.href);\n                if (this._isImplicitGrantCallback(params)) {\n                    callbackUrlType = 'implicit';\n                }\n                else if (await this._isPKCECallback(params)) {\n                    callbackUrlType = 'pkce';\n                }\n            }\n            /**\n             * Attempt to get the session from the URL only if these conditions are fulfilled\n             *\n             * Note: If the URL isn't one of the callback url types (implicit or pkce),\n             * then there could be an existing session so we don't want to prematurely remove it\n             */\n            if (isBrowser() && this.detectSessionInUrl && callbackUrlType !== 'none') {\n                const { data, error } = await this._getSessionFromURL(params, callbackUrlType);\n                if (error) {\n                    this._debug('#_initialize()', 'error detecting session from URL', error);\n                    if (isAuthImplicitGrantRedirectError(error)) {\n                        const errorCode = (_a = error.details) === null || _a === void 0 ? void 0 : _a.code;\n                        if (errorCode === 'identity_already_exists' ||\n                            errorCode === 'identity_not_found' ||\n                            errorCode === 'single_identity_not_deletable') {\n                            return { error };\n                        }\n                    }\n                    // failed login attempt via url,\n                    // remove old session as in verifyOtp, signUp and signInWith*\n                    await this._removeSession();\n                    return { error };\n                }\n                const { session, redirectType } = data;\n                this._debug('#_initialize()', 'detected session in URL', session, 'redirect type', redirectType);\n                await this._saveSession(session);\n                setTimeout(async () => {\n                    if (redirectType === 'recovery') {\n                        await this._notifyAllSubscribers('PASSWORD_RECOVERY', session);\n                    }\n                    else {\n                        await this._notifyAllSubscribers('SIGNED_IN', session);\n                    }\n                }, 0);\n                return { error: null };\n            }\n            // no login attempt via callback url try to recover session from storage\n            await this._recoverAndRefresh();\n            return { error: null };\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ error });\n            }\n            return this._returnResult({\n                error: new AuthUnknownError('Unexpected error during initialization', error),\n            });\n        }\n        finally {\n            await this._handleVisibilityChange();\n            this._debug('#_initialize()', 'end');\n        }\n    }\n    /**\n     * Creates a new anonymous user.\n     *\n     * @returns A session where the is_anonymous claim in the access token JWT set to true\n     */\n    async signInAnonymously(credentials) {\n        var _a, _b, _c;\n        try {\n            const res = await _request(this.fetch, 'POST', `${this.url}/signup`, {\n                headers: this.headers,\n                body: {\n                    data: (_b = (_a = credentials === null || credentials === void 0 ? void 0 : credentials.options) === null || _a === void 0 ? void 0 : _a.data) !== null && _b !== void 0 ? _b : {},\n                    gotrue_meta_security: { captcha_token: (_c = credentials === null || credentials === void 0 ? void 0 : credentials.options) === null || _c === void 0 ? void 0 : _c.captchaToken },\n                },\n                xform: _sessionResponse,\n            });\n            const { data, error } = res;\n            if (error || !data) {\n                return this._returnResult({ data: { user: null, session: null }, error: error });\n            }\n            const session = data.session;\n            const user = data.user;\n            if (data.session) {\n                await this._saveSession(data.session);\n                await this._notifyAllSubscribers('SIGNED_IN', session);\n            }\n            return this._returnResult({ data: { user, session }, error: null });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: { user: null, session: null }, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Creates a new user.\n     *\n     * Be aware that if a user account exists in the system you may get back an\n     * error message that attempts to hide this information from the user.\n     * This method has support for PKCE via email signups. The PKCE flow cannot be used when autoconfirm is enabled.\n     *\n     * @returns A logged-in session if the server has \"autoconfirm\" ON\n     * @returns A user if the server has \"autoconfirm\" OFF\n     */\n    async signUp(credentials) {\n        var _a, _b, _c;\n        try {\n            let res;\n            if ('email' in credentials) {\n                const { email, password, options } = credentials;\n                let codeChallenge = null;\n                let codeChallengeMethod = null;\n                if (this.flowType === 'pkce') {\n                    ;\n                    [codeChallenge, codeChallengeMethod] = await getCodeChallengeAndMethod(this.storage, this.storageKey);\n                }\n                res = await _request(this.fetch, 'POST', `${this.url}/signup`, {\n                    headers: this.headers,\n                    redirectTo: options === null || options === void 0 ? void 0 : options.emailRedirectTo,\n                    body: {\n                        email,\n                        password,\n                        data: (_a = options === null || options === void 0 ? void 0 : options.data) !== null && _a !== void 0 ? _a : {},\n                        gotrue_meta_security: { captcha_token: options === null || options === void 0 ? void 0 : options.captchaToken },\n                        code_challenge: codeChallenge,\n                        code_challenge_method: codeChallengeMethod,\n                    },\n                    xform: _sessionResponse,\n                });\n            }\n            else if ('phone' in credentials) {\n                const { phone, password, options } = credentials;\n                res = await _request(this.fetch, 'POST', `${this.url}/signup`, {\n                    headers: this.headers,\n                    body: {\n                        phone,\n                        password,\n                        data: (_b = options === null || options === void 0 ? void 0 : options.data) !== null && _b !== void 0 ? _b : {},\n                        channel: (_c = options === null || options === void 0 ? void 0 : options.channel) !== null && _c !== void 0 ? _c : 'sms',\n                        gotrue_meta_security: { captcha_token: options === null || options === void 0 ? void 0 : options.captchaToken },\n                    },\n                    xform: _sessionResponse,\n                });\n            }\n            else {\n                throw new AuthInvalidCredentialsError('You must provide either an email or phone number and a password');\n            }\n            const { data, error } = res;\n            if (error || !data) {\n                return this._returnResult({ data: { user: null, session: null }, error: error });\n            }\n            const session = data.session;\n            const user = data.user;\n            if (data.session) {\n                await this._saveSession(data.session);\n                await this._notifyAllSubscribers('SIGNED_IN', session);\n            }\n            return this._returnResult({ data: { user, session }, error: null });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: { user: null, session: null }, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Log in an existing user with an email and password or phone and password.\n     *\n     * Be aware that you may get back an error message that will not distinguish\n     * between the cases where the account does not exist or that the\n     * email/phone and password combination is wrong or that the account can only\n     * be accessed via social login.\n     */\n    async signInWithPassword(credentials) {\n        try {\n            let res;\n            if ('email' in credentials) {\n                const { email, password, options } = credentials;\n                res = await _request(this.fetch, 'POST', `${this.url}/token?grant_type=password`, {\n                    headers: this.headers,\n                    body: {\n                        email,\n                        password,\n                        gotrue_meta_security: { captcha_token: options === null || options === void 0 ? void 0 : options.captchaToken },\n                    },\n                    xform: _sessionResponsePassword,\n                });\n            }\n            else if ('phone' in credentials) {\n                const { phone, password, options } = credentials;\n                res = await _request(this.fetch, 'POST', `${this.url}/token?grant_type=password`, {\n                    headers: this.headers,\n                    body: {\n                        phone,\n                        password,\n                        gotrue_meta_security: { captcha_token: options === null || options === void 0 ? void 0 : options.captchaToken },\n                    },\n                    xform: _sessionResponsePassword,\n                });\n            }\n            else {\n                throw new AuthInvalidCredentialsError('You must provide either an email or phone number and a password');\n            }\n            const { data, error } = res;\n            if (error) {\n                return this._returnResult({ data: { user: null, session: null }, error });\n            }\n            else if (!data || !data.session || !data.user) {\n                const invalidTokenError = new AuthInvalidTokenResponseError();\n                return this._returnResult({ data: { user: null, session: null }, error: invalidTokenError });\n            }\n            if (data.session) {\n                await this._saveSession(data.session);\n                await this._notifyAllSubscribers('SIGNED_IN', data.session);\n            }\n            return this._returnResult({\n                data: Object.assign({ user: data.user, session: data.session }, (data.weak_password ? { weakPassword: data.weak_password } : null)),\n                error,\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: { user: null, session: null }, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Log in an existing user via a third-party provider.\n     * This method supports the PKCE flow.\n     */\n    async signInWithOAuth(credentials) {\n        var _a, _b, _c, _d;\n        return await this._handleProviderSignIn(credentials.provider, {\n            redirectTo: (_a = credentials.options) === null || _a === void 0 ? void 0 : _a.redirectTo,\n            scopes: (_b = credentials.options) === null || _b === void 0 ? void 0 : _b.scopes,\n            queryParams: (_c = credentials.options) === null || _c === void 0 ? void 0 : _c.queryParams,\n            skipBrowserRedirect: (_d = credentials.options) === null || _d === void 0 ? void 0 : _d.skipBrowserRedirect,\n        });\n    }\n    /**\n     * Log in an existing user by exchanging an Auth Code issued during the PKCE flow.\n     */\n    async exchangeCodeForSession(authCode) {\n        await this.initializePromise;\n        return this._acquireLock(-1, async () => {\n            return this._exchangeCodeForSession(authCode);\n        });\n    }\n    /**\n     * Signs in a user by verifying a message signed by the user's private key.\n     * Supports Ethereum (via Sign-In-With-Ethereum) & Solana (Sign-In-With-Solana) standards,\n     * both of which derive from the EIP-4361 standard\n     * With slight variation on Solana's side.\n     * @reference https://eips.ethereum.org/EIPS/eip-4361\n     */\n    async signInWithWeb3(credentials) {\n        const { chain } = credentials;\n        switch (chain) {\n            case 'ethereum':\n                return await this.signInWithEthereum(credentials);\n            case 'solana':\n                return await this.signInWithSolana(credentials);\n            default:\n                throw new Error(`@supabase/auth-js: Unsupported chain \"${chain}\"`);\n        }\n    }\n    async signInWithEthereum(credentials) {\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l;\n        // TODO: flatten type\n        let message;\n        let signature;\n        if ('message' in credentials) {\n            message = credentials.message;\n            signature = credentials.signature;\n        }\n        else {\n            const { chain, wallet, statement, options } = credentials;\n            let resolvedWallet;\n            if (!isBrowser()) {\n                if (typeof wallet !== 'object' || !(options === null || options === void 0 ? void 0 : options.url)) {\n                    throw new Error('@supabase/auth-js: Both wallet and url must be specified in non-browser environments.');\n                }\n                resolvedWallet = wallet;\n            }\n            else if (typeof wallet === 'object') {\n                resolvedWallet = wallet;\n            }\n            else {\n                const windowAny = window;\n                if ('ethereum' in windowAny &&\n                    typeof windowAny.ethereum === 'object' &&\n                    'request' in windowAny.ethereum &&\n                    typeof windowAny.ethereum.request === 'function') {\n                    resolvedWallet = windowAny.ethereum;\n                }\n                else {\n                    throw new Error(`@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.`);\n                }\n            }\n            const url = new URL((_a = options === null || options === void 0 ? void 0 : options.url) !== null && _a !== void 0 ? _a : window.location.href);\n            const accounts = await resolvedWallet\n                .request({\n                method: 'eth_requestAccounts',\n            })\n                .then((accs) => accs)\n                .catch(() => {\n                throw new Error(`@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid`);\n            });\n            if (!accounts || accounts.length === 0) {\n                throw new Error(`@supabase/auth-js: No accounts available. Please ensure the wallet is connected.`);\n            }\n            const address = getAddress(accounts[0]);\n            let chainId = (_b = options === null || options === void 0 ? void 0 : options.signInWithEthereum) === null || _b === void 0 ? void 0 : _b.chainId;\n            if (!chainId) {\n                const chainIdHex = await resolvedWallet.request({\n                    method: 'eth_chainId',\n                });\n                chainId = fromHex(chainIdHex);\n            }\n            const siweMessage = {\n                domain: url.host,\n                address: address,\n                statement: statement,\n                uri: url.href,\n                version: '1',\n                chainId: chainId,\n                nonce: (_c = options === null || options === void 0 ? void 0 : options.signInWithEthereum) === null || _c === void 0 ? void 0 : _c.nonce,\n                issuedAt: (_e = (_d = options === null || options === void 0 ? void 0 : options.signInWithEthereum) === null || _d === void 0 ? void 0 : _d.issuedAt) !== null && _e !== void 0 ? _e : new Date(),\n                expirationTime: (_f = options === null || options === void 0 ? void 0 : options.signInWithEthereum) === null || _f === void 0 ? void 0 : _f.expirationTime,\n                notBefore: (_g = options === null || options === void 0 ? void 0 : options.signInWithEthereum) === null || _g === void 0 ? void 0 : _g.notBefore,\n                requestId: (_h = options === null || options === void 0 ? void 0 : options.signInWithEthereum) === null || _h === void 0 ? void 0 : _h.requestId,\n                resources: (_j = options === null || options === void 0 ? void 0 : options.signInWithEthereum) === null || _j === void 0 ? void 0 : _j.resources,\n            };\n            message = createSiweMessage(siweMessage);\n            // Sign message\n            signature = (await resolvedWallet.request({\n                method: 'personal_sign',\n                params: [toHex(message), address],\n            }));\n        }\n        try {\n            const { data, error } = await _request(this.fetch, 'POST', `${this.url}/token?grant_type=web3`, {\n                headers: this.headers,\n                body: Object.assign({ chain: 'ethereum', message,\n                    signature }, (((_k = credentials.options) === null || _k === void 0 ? void 0 : _k.captchaToken)\n                    ? { gotrue_meta_security: { captcha_token: (_l = credentials.options) === null || _l === void 0 ? void 0 : _l.captchaToken } }\n                    : null)),\n                xform: _sessionResponse,\n            });\n            if (error) {\n                throw error;\n            }\n            if (!data || !data.session || !data.user) {\n                const invalidTokenError = new AuthInvalidTokenResponseError();\n                return this._returnResult({ data: { user: null, session: null }, error: invalidTokenError });\n            }\n            if (data.session) {\n                await this._saveSession(data.session);\n                await this._notifyAllSubscribers('SIGNED_IN', data.session);\n            }\n            return this._returnResult({ data: Object.assign({}, data), error });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: { user: null, session: null }, error });\n            }\n            throw error;\n        }\n    }\n    async signInWithSolana(credentials) {\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m;\n        let message;\n        let signature;\n        if ('message' in credentials) {\n            message = credentials.message;\n            signature = credentials.signature;\n        }\n        else {\n            const { chain, wallet, statement, options } = credentials;\n            let resolvedWallet;\n            if (!isBrowser()) {\n                if (typeof wallet !== 'object' || !(options === null || options === void 0 ? void 0 : options.url)) {\n                    throw new Error('@supabase/auth-js: Both wallet and url must be specified in non-browser environments.');\n                }\n                resolvedWallet = wallet;\n            }\n            else if (typeof wallet === 'object') {\n                resolvedWallet = wallet;\n            }\n            else {\n                const windowAny = window;\n                if ('solana' in windowAny &&\n                    typeof windowAny.solana === 'object' &&\n                    (('signIn' in windowAny.solana && typeof windowAny.solana.signIn === 'function') ||\n                        ('signMessage' in windowAny.solana &&\n                            typeof windowAny.solana.signMessage === 'function'))) {\n                    resolvedWallet = windowAny.solana;\n                }\n                else {\n                    throw new Error(`@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.`);\n                }\n            }\n            const url = new URL((_a = options === null || options === void 0 ? void 0 : options.url) !== null && _a !== void 0 ? _a : window.location.href);\n            if ('signIn' in resolvedWallet && resolvedWallet.signIn) {\n                const output = await resolvedWallet.signIn(Object.assign(Object.assign(Object.assign({ issuedAt: new Date().toISOString() }, options === null || options === void 0 ? void 0 : options.signInWithSolana), { \n                    // non-overridable properties\n                    version: '1', domain: url.host, uri: url.href }), (statement ? { statement } : null)));\n                let outputToProcess;\n                if (Array.isArray(output) && output[0] && typeof output[0] === 'object') {\n                    outputToProcess = output[0];\n                }\n                else if (output &&\n                    typeof output === 'object' &&\n                    'signedMessage' in output &&\n                    'signature' in output) {\n                    outputToProcess = output;\n                }\n                else {\n                    throw new Error('@supabase/auth-js: Wallet method signIn() returned unrecognized value');\n                }\n                if ('signedMessage' in outputToProcess &&\n                    'signature' in outputToProcess &&\n                    (typeof outputToProcess.signedMessage === 'string' ||\n                        outputToProcess.signedMessage instanceof Uint8Array) &&\n                    outputToProcess.signature instanceof Uint8Array) {\n                    message =\n                        typeof outputToProcess.signedMessage === 'string'\n                            ? outputToProcess.signedMessage\n                            : new TextDecoder().decode(outputToProcess.signedMessage);\n                    signature = outputToProcess.signature;\n                }\n                else {\n                    throw new Error('@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields');\n                }\n            }\n            else {\n                if (!('signMessage' in resolvedWallet) ||\n                    typeof resolvedWallet.signMessage !== 'function' ||\n                    !('publicKey' in resolvedWallet) ||\n                    typeof resolvedWallet !== 'object' ||\n                    !resolvedWallet.publicKey ||\n                    !('toBase58' in resolvedWallet.publicKey) ||\n                    typeof resolvedWallet.publicKey.toBase58 !== 'function') {\n                    throw new Error('@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API');\n                }\n                message = [\n                    `${url.host} wants you to sign in with your Solana account:`,\n                    resolvedWallet.publicKey.toBase58(),\n                    ...(statement ? ['', statement, ''] : ['']),\n                    'Version: 1',\n                    `URI: ${url.href}`,\n                    `Issued At: ${(_c = (_b = options === null || options === void 0 ? void 0 : options.signInWithSolana) === null || _b === void 0 ? void 0 : _b.issuedAt) !== null && _c !== void 0 ? _c : new Date().toISOString()}`,\n                    ...(((_d = options === null || options === void 0 ? void 0 : options.signInWithSolana) === null || _d === void 0 ? void 0 : _d.notBefore)\n                        ? [`Not Before: ${options.signInWithSolana.notBefore}`]\n                        : []),\n                    ...(((_e = options === null || options === void 0 ? void 0 : options.signInWithSolana) === null || _e === void 0 ? void 0 : _e.expirationTime)\n                        ? [`Expiration Time: ${options.signInWithSolana.expirationTime}`]\n                        : []),\n                    ...(((_f = options === null || options === void 0 ? void 0 : options.signInWithSolana) === null || _f === void 0 ? void 0 : _f.chainId)\n                        ? [`Chain ID: ${options.signInWithSolana.chainId}`]\n                        : []),\n                    ...(((_g = options === null || options === void 0 ? void 0 : options.signInWithSolana) === null || _g === void 0 ? void 0 : _g.nonce) ? [`Nonce: ${options.signInWithSolana.nonce}`] : []),\n                    ...(((_h = options === null || options === void 0 ? void 0 : options.signInWithSolana) === null || _h === void 0 ? void 0 : _h.requestId)\n                        ? [`Request ID: ${options.signInWithSolana.requestId}`]\n                        : []),\n                    ...(((_k = (_j = options === null || options === void 0 ? void 0 : options.signInWithSolana) === null || _j === void 0 ? void 0 : _j.resources) === null || _k === void 0 ? void 0 : _k.length)\n                        ? [\n                            'Resources',\n                            ...options.signInWithSolana.resources.map((resource) => `- ${resource}`),\n                        ]\n                        : []),\n                ].join('\\n');\n                const maybeSignature = await resolvedWallet.signMessage(new TextEncoder().encode(message), 'utf8');\n                if (!maybeSignature || !(maybeSignature instanceof Uint8Array)) {\n                    throw new Error('@supabase/auth-js: Wallet signMessage() API returned an recognized value');\n                }\n                signature = maybeSignature;\n            }\n        }\n        try {\n            const { data, error } = await _request(this.fetch, 'POST', `${this.url}/token?grant_type=web3`, {\n                headers: this.headers,\n                body: Object.assign({ chain: 'solana', message, signature: bytesToBase64URL(signature) }, (((_l = credentials.options) === null || _l === void 0 ? void 0 : _l.captchaToken)\n                    ? { gotrue_meta_security: { captcha_token: (_m = credentials.options) === null || _m === void 0 ? void 0 : _m.captchaToken } }\n                    : null)),\n                xform: _sessionResponse,\n            });\n            if (error) {\n                throw error;\n            }\n            if (!data || !data.session || !data.user) {\n                const invalidTokenError = new AuthInvalidTokenResponseError();\n                return this._returnResult({ data: { user: null, session: null }, error: invalidTokenError });\n            }\n            if (data.session) {\n                await this._saveSession(data.session);\n                await this._notifyAllSubscribers('SIGNED_IN', data.session);\n            }\n            return this._returnResult({ data: Object.assign({}, data), error });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: { user: null, session: null }, error });\n            }\n            throw error;\n        }\n    }\n    async _exchangeCodeForSession(authCode) {\n        const storageItem = await getItemAsync(this.storage, `${this.storageKey}-code-verifier`);\n        const [codeVerifier, redirectType] = (storageItem !== null && storageItem !== void 0 ? storageItem : '').split('/');\n        try {\n            const { data, error } = await _request(this.fetch, 'POST', `${this.url}/token?grant_type=pkce`, {\n                headers: this.headers,\n                body: {\n                    auth_code: authCode,\n                    code_verifier: codeVerifier,\n                },\n                xform: _sessionResponse,\n            });\n            await removeItemAsync(this.storage, `${this.storageKey}-code-verifier`);\n            if (error) {\n                throw error;\n            }\n            if (!data || !data.session || !data.user) {\n                const invalidTokenError = new AuthInvalidTokenResponseError();\n                return this._returnResult({\n                    data: { user: null, session: null, redirectType: null },\n                    error: invalidTokenError,\n                });\n            }\n            if (data.session) {\n                await this._saveSession(data.session);\n                await this._notifyAllSubscribers('SIGNED_IN', data.session);\n            }\n            return this._returnResult({ data: Object.assign(Object.assign({}, data), { redirectType: redirectType !== null && redirectType !== void 0 ? redirectType : null }), error });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({\n                    data: { user: null, session: null, redirectType: null },\n                    error,\n                });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Allows signing in with an OIDC ID token. The authentication provider used\n     * should be enabled and configured.\n     */\n    async signInWithIdToken(credentials) {\n        try {\n            const { options, provider, token, access_token, nonce } = credentials;\n            const res = await _request(this.fetch, 'POST', `${this.url}/token?grant_type=id_token`, {\n                headers: this.headers,\n                body: {\n                    provider,\n                    id_token: token,\n                    access_token,\n                    nonce,\n                    gotrue_meta_security: { captcha_token: options === null || options === void 0 ? void 0 : options.captchaToken },\n                },\n                xform: _sessionResponse,\n            });\n            const { data, error } = res;\n            if (error) {\n                return this._returnResult({ data: { user: null, session: null }, error });\n            }\n            else if (!data || !data.session || !data.user) {\n                const invalidTokenError = new AuthInvalidTokenResponseError();\n                return this._returnResult({ data: { user: null, session: null }, error: invalidTokenError });\n            }\n            if (data.session) {\n                await this._saveSession(data.session);\n                await this._notifyAllSubscribers('SIGNED_IN', data.session);\n            }\n            return this._returnResult({ data, error });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: { user: null, session: null }, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Log in a user using magiclink or a one-time password (OTP).\n     *\n     * If the `{{ .ConfirmationURL }}` variable is specified in the email template, a magiclink will be sent.\n     * If the `{{ .Token }}` variable is specified in the email template, an OTP will be sent.\n     * If you're using phone sign-ins, only an OTP will be sent. You won't be able to send a magiclink for phone sign-ins.\n     *\n     * Be aware that you may get back an error message that will not distinguish\n     * between the cases where the account does not exist or, that the account\n     * can only be accessed via social login.\n     *\n     * Do note that you will need to configure a Whatsapp sender on Twilio\n     * if you are using phone sign in with the 'whatsapp' channel. The whatsapp\n     * channel is not supported on other providers\n     * at this time.\n     * This method supports PKCE when an email is passed.\n     */\n    async signInWithOtp(credentials) {\n        var _a, _b, _c, _d, _e;\n        try {\n            if ('email' in credentials) {\n                const { email, options } = credentials;\n                let codeChallenge = null;\n                let codeChallengeMethod = null;\n                if (this.flowType === 'pkce') {\n                    ;\n                    [codeChallenge, codeChallengeMethod] = await getCodeChallengeAndMethod(this.storage, this.storageKey);\n                }\n                const { error } = await _request(this.fetch, 'POST', `${this.url}/otp`, {\n                    headers: this.headers,\n                    body: {\n                        email,\n                        data: (_a = options === null || options === void 0 ? void 0 : options.data) !== null && _a !== void 0 ? _a : {},\n                        create_user: (_b = options === null || options === void 0 ? void 0 : options.shouldCreateUser) !== null && _b !== void 0 ? _b : true,\n                        gotrue_meta_security: { captcha_token: options === null || options === void 0 ? void 0 : options.captchaToken },\n                        code_challenge: codeChallenge,\n                        code_challenge_method: codeChallengeMethod,\n                    },\n                    redirectTo: options === null || options === void 0 ? void 0 : options.emailRedirectTo,\n                });\n                return this._returnResult({ data: { user: null, session: null }, error });\n            }\n            if ('phone' in credentials) {\n                const { phone, options } = credentials;\n                const { data, error } = await _request(this.fetch, 'POST', `${this.url}/otp`, {\n                    headers: this.headers,\n                    body: {\n                        phone,\n                        data: (_c = options === null || options === void 0 ? void 0 : options.data) !== null && _c !== void 0 ? _c : {},\n                        create_user: (_d = options === null || options === void 0 ? void 0 : options.shouldCreateUser) !== null && _d !== void 0 ? _d : true,\n                        gotrue_meta_security: { captcha_token: options === null || options === void 0 ? void 0 : options.captchaToken },\n                        channel: (_e = options === null || options === void 0 ? void 0 : options.channel) !== null && _e !== void 0 ? _e : 'sms',\n                    },\n                });\n                return this._returnResult({\n                    data: { user: null, session: null, messageId: data === null || data === void 0 ? void 0 : data.message_id },\n                    error,\n                });\n            }\n            throw new AuthInvalidCredentialsError('You must provide either an email or phone number.');\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: { user: null, session: null }, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Log in a user given a User supplied OTP or TokenHash received through mobile or email.\n     */\n    async verifyOtp(params) {\n        var _a, _b;\n        try {\n            let redirectTo = undefined;\n            let captchaToken = undefined;\n            if ('options' in params) {\n                redirectTo = (_a = params.options) === null || _a === void 0 ? void 0 : _a.redirectTo;\n                captchaToken = (_b = params.options) === null || _b === void 0 ? void 0 : _b.captchaToken;\n            }\n            const { data, error } = await _request(this.fetch, 'POST', `${this.url}/verify`, {\n                headers: this.headers,\n                body: Object.assign(Object.assign({}, params), { gotrue_meta_security: { captcha_token: captchaToken } }),\n                redirectTo,\n                xform: _sessionResponse,\n            });\n            if (error) {\n                throw error;\n            }\n            if (!data) {\n                const tokenVerificationError = new Error('An error occurred on token verification.');\n                throw tokenVerificationError;\n            }\n            const session = data.session;\n            const user = data.user;\n            if (session === null || session === void 0 ? void 0 : session.access_token) {\n                await this._saveSession(session);\n                await this._notifyAllSubscribers(params.type == 'recovery' ? 'PASSWORD_RECOVERY' : 'SIGNED_IN', session);\n            }\n            return this._returnResult({ data: { user, session }, error: null });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: { user: null, session: null }, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Attempts a single-sign on using an enterprise Identity Provider. A\n     * successful SSO attempt will redirect the current page to the identity\n     * provider authorization page. The redirect URL is implementation and SSO\n     * protocol specific.\n     *\n     * You can use it by providing a SSO domain. Typically you can extract this\n     * domain by asking users for their email address. If this domain is\n     * registered on the Auth instance the redirect will use that organization's\n     * currently active SSO Identity Provider for the login.\n     *\n     * If you have built an organization-specific login page, you can use the\n     * organization's SSO Identity Provider UUID directly instead.\n     */\n    async signInWithSSO(params) {\n        var _a, _b, _c;\n        try {\n            let codeChallenge = null;\n            let codeChallengeMethod = null;\n            if (this.flowType === 'pkce') {\n                ;\n                [codeChallenge, codeChallengeMethod] = await getCodeChallengeAndMethod(this.storage, this.storageKey);\n            }\n            const result = await _request(this.fetch, 'POST', `${this.url}/sso`, {\n                body: Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({}, ('providerId' in params ? { provider_id: params.providerId } : null)), ('domain' in params ? { domain: params.domain } : null)), { redirect_to: (_b = (_a = params.options) === null || _a === void 0 ? void 0 : _a.redirectTo) !== null && _b !== void 0 ? _b : undefined }), (((_c = params === null || params === void 0 ? void 0 : params.options) === null || _c === void 0 ? void 0 : _c.captchaToken)\n                    ? { gotrue_meta_security: { captcha_token: params.options.captchaToken } }\n                    : null)), { skip_http_redirect: true, code_challenge: codeChallenge, code_challenge_method: codeChallengeMethod }),\n                headers: this.headers,\n                xform: _ssoResponse,\n            });\n            return this._returnResult(result);\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: null, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Sends a reauthentication OTP to the user's email or phone number.\n     * Requires the user to be signed-in.\n     */\n    async reauthenticate() {\n        await this.initializePromise;\n        return await this._acquireLock(-1, async () => {\n            return await this._reauthenticate();\n        });\n    }\n    async _reauthenticate() {\n        try {\n            return await this._useSession(async (result) => {\n                const { data: { session }, error: sessionError, } = result;\n                if (sessionError)\n                    throw sessionError;\n                if (!session)\n                    throw new AuthSessionMissingError();\n                const { error } = await _request(this.fetch, 'GET', `${this.url}/reauthenticate`, {\n                    headers: this.headers,\n                    jwt: session.access_token,\n                });\n                return this._returnResult({ data: { user: null, session: null }, error });\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: { user: null, session: null }, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Resends an existing signup confirmation email, email change email, SMS OTP or phone change OTP.\n     */\n    async resend(credentials) {\n        try {\n            const endpoint = `${this.url}/resend`;\n            if ('email' in credentials) {\n                const { email, type, options } = credentials;\n                const { error } = await _request(this.fetch, 'POST', endpoint, {\n                    headers: this.headers,\n                    body: {\n                        email,\n                        type,\n                        gotrue_meta_security: { captcha_token: options === null || options === void 0 ? void 0 : options.captchaToken },\n                    },\n                    redirectTo: options === null || options === void 0 ? void 0 : options.emailRedirectTo,\n                });\n                return this._returnResult({ data: { user: null, session: null }, error });\n            }\n            else if ('phone' in credentials) {\n                const { phone, type, options } = credentials;\n                const { data, error } = await _request(this.fetch, 'POST', endpoint, {\n                    headers: this.headers,\n                    body: {\n                        phone,\n                        type,\n                        gotrue_meta_security: { captcha_token: options === null || options === void 0 ? void 0 : options.captchaToken },\n                    },\n                });\n                return this._returnResult({\n                    data: { user: null, session: null, messageId: data === null || data === void 0 ? void 0 : data.message_id },\n                    error,\n                });\n            }\n            throw new AuthInvalidCredentialsError('You must provide either an email or phone number and a type');\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: { user: null, session: null }, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Returns the session, refreshing it if necessary.\n     *\n     * The session returned can be null if the session is not detected which can happen in the event a user is not signed-in or has logged out.\n     *\n     * **IMPORTANT:** This method loads values directly from the storage attached\n     * to the client. If that storage is based on request cookies for example,\n     * the values in it may not be authentic and therefore it's strongly advised\n     * against using this method and its results in such circumstances. A warning\n     * will be emitted if this is detected. Use {@link #getUser()} instead.\n     */\n    async getSession() {\n        await this.initializePromise;\n        const result = await this._acquireLock(-1, async () => {\n            return this._useSession(async (result) => {\n                return result;\n            });\n        });\n        return result;\n    }\n    /**\n     * Acquires a global lock based on the storage key.\n     */\n    async _acquireLock(acquireTimeout, fn) {\n        this._debug('#_acquireLock', 'begin', acquireTimeout);\n        try {\n            if (this.lockAcquired) {\n                const last = this.pendingInLock.length\n                    ? this.pendingInLock[this.pendingInLock.length - 1]\n                    : Promise.resolve();\n                const result = (async () => {\n                    await last;\n                    return await fn();\n                })();\n                this.pendingInLock.push((async () => {\n                    try {\n                        await result;\n                    }\n                    catch (e) {\n                        // we just care if it finished\n                    }\n                })());\n                return result;\n            }\n            return await this.lock(`lock:${this.storageKey}`, acquireTimeout, async () => {\n                this._debug('#_acquireLock', 'lock acquired for storage key', this.storageKey);\n                try {\n                    this.lockAcquired = true;\n                    const result = fn();\n                    this.pendingInLock.push((async () => {\n                        try {\n                            await result;\n                        }\n                        catch (e) {\n                            // we just care if it finished\n                        }\n                    })());\n                    await result;\n                    // keep draining the queue until there's nothing to wait on\n                    while (this.pendingInLock.length) {\n                        const waitOn = [...this.pendingInLock];\n                        await Promise.all(waitOn);\n                        this.pendingInLock.splice(0, waitOn.length);\n                    }\n                    return await result;\n                }\n                finally {\n                    this._debug('#_acquireLock', 'lock released for storage key', this.storageKey);\n                    this.lockAcquired = false;\n                }\n            });\n        }\n        finally {\n            this._debug('#_acquireLock', 'end');\n        }\n    }\n    /**\n     * Use instead of {@link #getSession} inside the library. It is\n     * semantically usually what you want, as getting a session involves some\n     * processing afterwards that requires only one client operating on the\n     * session at once across multiple tabs or processes.\n     */\n    async _useSession(fn) {\n        this._debug('#_useSession', 'begin');\n        try {\n            // the use of __loadSession here is the only correct use of the function!\n            const result = await this.__loadSession();\n            return await fn(result);\n        }\n        finally {\n            this._debug('#_useSession', 'end');\n        }\n    }\n    /**\n     * NEVER USE DIRECTLY!\n     *\n     * Always use {@link #_useSession}.\n     */\n    async __loadSession() {\n        this._debug('#__loadSession()', 'begin');\n        if (!this.lockAcquired) {\n            this._debug('#__loadSession()', 'used outside of an acquired lock!', new Error().stack);\n        }\n        try {\n            let currentSession = null;\n            const maybeSession = await getItemAsync(this.storage, this.storageKey);\n            this._debug('#getSession()', 'session from storage', maybeSession);\n            if (maybeSession !== null) {\n                if (this._isValidSession(maybeSession)) {\n                    currentSession = maybeSession;\n                }\n                else {\n                    this._debug('#getSession()', 'session from storage is not valid');\n                    await this._removeSession();\n                }\n            }\n            if (!currentSession) {\n                return { data: { session: null }, error: null };\n            }\n            // A session is considered expired before the access token _actually_\n            // expires. When the autoRefreshToken option is off (or when the tab is\n            // in the background), very eager users of getSession() -- like\n            // realtime-js -- might send a valid JWT which will expire by the time it\n            // reaches the server.\n            const hasExpired = currentSession.expires_at\n                ? currentSession.expires_at * 1000 - Date.now() < EXPIRY_MARGIN_MS\n                : false;\n            this._debug('#__loadSession()', `session has${hasExpired ? '' : ' not'} expired`, 'expires_at', currentSession.expires_at);\n            if (!hasExpired) {\n                if (this.userStorage) {\n                    const maybeUser = (await getItemAsync(this.userStorage, this.storageKey + '-user'));\n                    if (maybeUser === null || maybeUser === void 0 ? void 0 : maybeUser.user) {\n                        currentSession.user = maybeUser.user;\n                    }\n                    else {\n                        currentSession.user = userNotAvailableProxy();\n                    }\n                }\n                // Wrap the user object with a warning proxy on the server\n                // This warns when properties of the user are accessed, not when session.user itself is accessed\n                if (this.storage.isServer &&\n                    currentSession.user &&\n                    !currentSession.user.__isUserNotAvailableProxy) {\n                    const suppressWarningRef = { value: this.suppressGetSessionWarning };\n                    currentSession.user = insecureUserWarningProxy(currentSession.user, suppressWarningRef);\n                    // Update the client-level suppression flag when the proxy suppresses the warning\n                    if (suppressWarningRef.value) {\n                        this.suppressGetSessionWarning = true;\n                    }\n                }\n                return { data: { session: currentSession }, error: null };\n            }\n            const { data: session, error } = await this._callRefreshToken(currentSession.refresh_token);\n            if (error) {\n                return this._returnResult({ data: { session: null }, error });\n            }\n            return this._returnResult({ data: { session }, error: null });\n        }\n        finally {\n            this._debug('#__loadSession()', 'end');\n        }\n    }\n    /**\n     * Gets the current user details if there is an existing session. This method\n     * performs a network request to the Supabase Auth server, so the returned\n     * value is authentic and can be used to base authorization rules on.\n     *\n     * @param jwt Takes in an optional access token JWT. If no JWT is provided, the JWT from the current session is used.\n     */\n    async getUser(jwt) {\n        if (jwt) {\n            return await this._getUser(jwt);\n        }\n        await this.initializePromise;\n        const result = await this._acquireLock(-1, async () => {\n            return await this._getUser();\n        });\n        return result;\n    }\n    async _getUser(jwt) {\n        try {\n            if (jwt) {\n                return await _request(this.fetch, 'GET', `${this.url}/user`, {\n                    headers: this.headers,\n                    jwt: jwt,\n                    xform: _userResponse,\n                });\n            }\n            return await this._useSession(async (result) => {\n                var _a, _b, _c;\n                const { data, error } = result;\n                if (error) {\n                    throw error;\n                }\n                // returns an error if there is no access_token or custom authorization header\n                if (!((_a = data.session) === null || _a === void 0 ? void 0 : _a.access_token) && !this.hasCustomAuthorizationHeader) {\n                    return { data: { user: null }, error: new AuthSessionMissingError() };\n                }\n                return await _request(this.fetch, 'GET', `${this.url}/user`, {\n                    headers: this.headers,\n                    jwt: (_c = (_b = data.session) === null || _b === void 0 ? void 0 : _b.access_token) !== null && _c !== void 0 ? _c : undefined,\n                    xform: _userResponse,\n                });\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                if (isAuthSessionMissingError(error)) {\n                    // JWT contains a `session_id` which does not correspond to an active\n                    // session in the database, indicating the user is signed out.\n                    await this._removeSession();\n                    await removeItemAsync(this.storage, `${this.storageKey}-code-verifier`);\n                }\n                return this._returnResult({ data: { user: null }, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Updates user data for a logged in user.\n     */\n    async updateUser(attributes, options = {}) {\n        await this.initializePromise;\n        return await this._acquireLock(-1, async () => {\n            return await this._updateUser(attributes, options);\n        });\n    }\n    async _updateUser(attributes, options = {}) {\n        try {\n            return await this._useSession(async (result) => {\n                const { data: sessionData, error: sessionError } = result;\n                if (sessionError) {\n                    throw sessionError;\n                }\n                if (!sessionData.session) {\n                    throw new AuthSessionMissingError();\n                }\n                const session = sessionData.session;\n                let codeChallenge = null;\n                let codeChallengeMethod = null;\n                if (this.flowType === 'pkce' && attributes.email != null) {\n                    ;\n                    [codeChallenge, codeChallengeMethod] = await getCodeChallengeAndMethod(this.storage, this.storageKey);\n                }\n                const { data, error: userError } = await _request(this.fetch, 'PUT', `${this.url}/user`, {\n                    headers: this.headers,\n                    redirectTo: options === null || options === void 0 ? void 0 : options.emailRedirectTo,\n                    body: Object.assign(Object.assign({}, attributes), { code_challenge: codeChallenge, code_challenge_method: codeChallengeMethod }),\n                    jwt: session.access_token,\n                    xform: _userResponse,\n                });\n                if (userError) {\n                    throw userError;\n                }\n                session.user = data.user;\n                await this._saveSession(session);\n                await this._notifyAllSubscribers('USER_UPDATED', session);\n                return this._returnResult({ data: { user: session.user }, error: null });\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: { user: null }, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Sets the session data from the current session. If the current session is expired, setSession will take care of refreshing it to obtain a new session.\n     * If the refresh token or access token in the current session is invalid, an error will be thrown.\n     * @param currentSession The current session that minimally contains an access token and refresh token.\n     */\n    async setSession(currentSession) {\n        await this.initializePromise;\n        return await this._acquireLock(-1, async () => {\n            return await this._setSession(currentSession);\n        });\n    }\n    async _setSession(currentSession) {\n        try {\n            if (!currentSession.access_token || !currentSession.refresh_token) {\n                throw new AuthSessionMissingError();\n            }\n            const timeNow = Date.now() / 1000;\n            let expiresAt = timeNow;\n            let hasExpired = true;\n            let session = null;\n            const { payload } = decodeJWT(currentSession.access_token);\n            if (payload.exp) {\n                expiresAt = payload.exp;\n                hasExpired = expiresAt <= timeNow;\n            }\n            if (hasExpired) {\n                const { data: refreshedSession, error } = await this._callRefreshToken(currentSession.refresh_token);\n                if (error) {\n                    return this._returnResult({ data: { user: null, session: null }, error: error });\n                }\n                if (!refreshedSession) {\n                    return { data: { user: null, session: null }, error: null };\n                }\n                session = refreshedSession;\n            }\n            else {\n                const { data, error } = await this._getUser(currentSession.access_token);\n                if (error) {\n                    throw error;\n                }\n                session = {\n                    access_token: currentSession.access_token,\n                    refresh_token: currentSession.refresh_token,\n                    user: data.user,\n                    token_type: 'bearer',\n                    expires_in: expiresAt - timeNow,\n                    expires_at: expiresAt,\n                };\n                await this._saveSession(session);\n                await this._notifyAllSubscribers('SIGNED_IN', session);\n            }\n            return this._returnResult({ data: { user: session.user, session }, error: null });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: { session: null, user: null }, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Returns a new session, regardless of expiry status.\n     * Takes in an optional current session. If not passed in, then refreshSession() will attempt to retrieve it from getSession().\n     * If the current session's refresh token is invalid, an error will be thrown.\n     * @param currentSession The current session. If passed in, it must contain a refresh token.\n     */\n    async refreshSession(currentSession) {\n        await this.initializePromise;\n        return await this._acquireLock(-1, async () => {\n            return await this._refreshSession(currentSession);\n        });\n    }\n    async _refreshSession(currentSession) {\n        try {\n            return await this._useSession(async (result) => {\n                var _a;\n                if (!currentSession) {\n                    const { data, error } = result;\n                    if (error) {\n                        throw error;\n                    }\n                    currentSession = (_a = data.session) !== null && _a !== void 0 ? _a : undefined;\n                }\n                if (!(currentSession === null || currentSession === void 0 ? void 0 : currentSession.refresh_token)) {\n                    throw new AuthSessionMissingError();\n                }\n                const { data: session, error } = await this._callRefreshToken(currentSession.refresh_token);\n                if (error) {\n                    return this._returnResult({ data: { user: null, session: null }, error: error });\n                }\n                if (!session) {\n                    return this._returnResult({ data: { user: null, session: null }, error: null });\n                }\n                return this._returnResult({ data: { user: session.user, session }, error: null });\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: { user: null, session: null }, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Gets the session data from a URL string\n     */\n    async _getSessionFromURL(params, callbackUrlType) {\n        try {\n            if (!isBrowser())\n                throw new AuthImplicitGrantRedirectError('No browser detected.');\n            // If there's an error in the URL, it doesn't matter what flow it is, we just return the error.\n            if (params.error || params.error_description || params.error_code) {\n                // The error class returned implies that the redirect is from an implicit grant flow\n                // but it could also be from a redirect error from a PKCE flow.\n                throw new AuthImplicitGrantRedirectError(params.error_description || 'Error in URL with unspecified error_description', {\n                    error: params.error || 'unspecified_error',\n                    code: params.error_code || 'unspecified_code',\n                });\n            }\n            // Checks for mismatches between the flowType initialised in the client and the URL parameters\n            switch (callbackUrlType) {\n                case 'implicit':\n                    if (this.flowType === 'pkce') {\n                        throw new AuthPKCEGrantCodeExchangeError('Not a valid PKCE flow url.');\n                    }\n                    break;\n                case 'pkce':\n                    if (this.flowType === 'implicit') {\n                        throw new AuthImplicitGrantRedirectError('Not a valid implicit grant flow url.');\n                    }\n                    break;\n                default:\n                // there's no mismatch so we continue\n            }\n            // Since this is a redirect for PKCE, we attempt to retrieve the code from the URL for the code exchange\n            if (callbackUrlType === 'pkce') {\n                this._debug('#_initialize()', 'begin', 'is PKCE flow', true);\n                if (!params.code)\n                    throw new AuthPKCEGrantCodeExchangeError('No code detected.');\n                const { data, error } = await this._exchangeCodeForSession(params.code);\n                if (error)\n                    throw error;\n                const url = new URL(window.location.href);\n                url.searchParams.delete('code');\n                window.history.replaceState(window.history.state, '', url.toString());\n                return { data: { session: data.session, redirectType: null }, error: null };\n            }\n            const { provider_token, provider_refresh_token, access_token, refresh_token, expires_in, expires_at, token_type, } = params;\n            if (!access_token || !expires_in || !refresh_token || !token_type) {\n                throw new AuthImplicitGrantRedirectError('No session defined in URL');\n            }\n            const timeNow = Math.round(Date.now() / 1000);\n            const expiresIn = parseInt(expires_in);\n            let expiresAt = timeNow + expiresIn;\n            if (expires_at) {\n                expiresAt = parseInt(expires_at);\n            }\n            const actuallyExpiresIn = expiresAt - timeNow;\n            if (actuallyExpiresIn * 1000 <= AUTO_REFRESH_TICK_DURATION_MS) {\n                console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${actuallyExpiresIn}s, should have been closer to ${expiresIn}s`);\n            }\n            const issuedAt = expiresAt - expiresIn;\n            if (timeNow - issuedAt >= 120) {\n                console.warn('@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale', issuedAt, expiresAt, timeNow);\n            }\n            else if (timeNow - issuedAt < 0) {\n                console.warn('@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew', issuedAt, expiresAt, timeNow);\n            }\n            const { data, error } = await this._getUser(access_token);\n            if (error)\n                throw error;\n            const session = {\n                provider_token,\n                provider_refresh_token,\n                access_token,\n                expires_in: expiresIn,\n                expires_at: expiresAt,\n                refresh_token,\n                token_type: token_type,\n                user: data.user,\n            };\n            // Remove tokens from URL\n            window.location.hash = '';\n            this._debug('#_getSessionFromURL()', 'clearing window.location.hash');\n            return this._returnResult({ data: { session, redirectType: params.type }, error: null });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: { session: null, redirectType: null }, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Checks if the current URL contains parameters given by an implicit oauth grant flow (https://www.rfc-editor.org/rfc/rfc6749.html#section-4.2)\n     */\n    _isImplicitGrantCallback(params) {\n        return Boolean(params.access_token || params.error_description);\n    }\n    /**\n     * Checks if the current URL and backing storage contain parameters given by a PKCE flow\n     */\n    async _isPKCECallback(params) {\n        const currentStorageContent = await getItemAsync(this.storage, `${this.storageKey}-code-verifier`);\n        return !!(params.code && currentStorageContent);\n    }\n    /**\n     * Inside a browser context, `signOut()` will remove the logged in user from the browser session and log them out - removing all items from localstorage and then trigger a `\"SIGNED_OUT\"` event.\n     *\n     * For server-side management, you can revoke all refresh tokens for a user by passing a user's JWT through to `auth.api.signOut(JWT: string)`.\n     * There is no way to revoke a user's access token jwt until it expires. It is recommended to set a shorter expiry on the jwt for this reason.\n     *\n     * If using `others` scope, no `SIGNED_OUT` event is fired!\n     */\n    async signOut(options = { scope: 'global' }) {\n        await this.initializePromise;\n        return await this._acquireLock(-1, async () => {\n            return await this._signOut(options);\n        });\n    }\n    async _signOut({ scope } = { scope: 'global' }) {\n        return await this._useSession(async (result) => {\n            var _a;\n            const { data, error: sessionError } = result;\n            if (sessionError) {\n                return this._returnResult({ error: sessionError });\n            }\n            const accessToken = (_a = data.session) === null || _a === void 0 ? void 0 : _a.access_token;\n            if (accessToken) {\n                const { error } = await this.admin.signOut(accessToken, scope);\n                if (error) {\n                    // ignore 404s since user might not exist anymore\n                    // ignore 401s since an invalid or expired JWT should sign out the current session\n                    if (!(isAuthApiError(error) &&\n                        (error.status === 404 || error.status === 401 || error.status === 403))) {\n                        return this._returnResult({ error });\n                    }\n                }\n            }\n            if (scope !== 'others') {\n                await this._removeSession();\n                await removeItemAsync(this.storage, `${this.storageKey}-code-verifier`);\n            }\n            return this._returnResult({ error: null });\n        });\n    }\n    onAuthStateChange(callback) {\n        const id = uuid();\n        const subscription = {\n            id,\n            callback,\n            unsubscribe: () => {\n                this._debug('#unsubscribe()', 'state change callback with id removed', id);\n                this.stateChangeEmitters.delete(id);\n            },\n        };\n        this._debug('#onAuthStateChange()', 'registered callback with id', id);\n        this.stateChangeEmitters.set(id, subscription);\n        (async () => {\n            await this.initializePromise;\n            await this._acquireLock(-1, async () => {\n                this._emitInitialSession(id);\n            });\n        })();\n        return { data: { subscription } };\n    }\n    async _emitInitialSession(id) {\n        return await this._useSession(async (result) => {\n            var _a, _b;\n            try {\n                const { data: { session }, error, } = result;\n                if (error)\n                    throw error;\n                await ((_a = this.stateChangeEmitters.get(id)) === null || _a === void 0 ? void 0 : _a.callback('INITIAL_SESSION', session));\n                this._debug('INITIAL_SESSION', 'callback id', id, 'session', session);\n            }\n            catch (err) {\n                await ((_b = this.stateChangeEmitters.get(id)) === null || _b === void 0 ? void 0 : _b.callback('INITIAL_SESSION', null));\n                this._debug('INITIAL_SESSION', 'callback id', id, 'error', err);\n                console.error(err);\n            }\n        });\n    }\n    /**\n     * Sends a password reset request to an email address. This method supports the PKCE flow.\n     *\n     * @param email The email address of the user.\n     * @param options.redirectTo The URL to send the user to after they click the password reset link.\n     * @param options.captchaToken Verification token received when the user completes the captcha on the site.\n     */\n    async resetPasswordForEmail(email, options = {}) {\n        let codeChallenge = null;\n        let codeChallengeMethod = null;\n        if (this.flowType === 'pkce') {\n            ;\n            [codeChallenge, codeChallengeMethod] = await getCodeChallengeAndMethod(this.storage, this.storageKey, true // isPasswordRecovery\n            );\n        }\n        try {\n            return await _request(this.fetch, 'POST', `${this.url}/recover`, {\n                body: {\n                    email,\n                    code_challenge: codeChallenge,\n                    code_challenge_method: codeChallengeMethod,\n                    gotrue_meta_security: { captcha_token: options.captchaToken },\n                },\n                headers: this.headers,\n                redirectTo: options.redirectTo,\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: null, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Gets all the identities linked to a user.\n     */\n    async getUserIdentities() {\n        var _a;\n        try {\n            const { data, error } = await this.getUser();\n            if (error)\n                throw error;\n            return this._returnResult({ data: { identities: (_a = data.user.identities) !== null && _a !== void 0 ? _a : [] }, error: null });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: null, error });\n            }\n            throw error;\n        }\n    }\n    async linkIdentity(credentials) {\n        if ('token' in credentials) {\n            return this.linkIdentityIdToken(credentials);\n        }\n        return this.linkIdentityOAuth(credentials);\n    }\n    async linkIdentityOAuth(credentials) {\n        var _a;\n        try {\n            const { data, error } = await this._useSession(async (result) => {\n                var _a, _b, _c, _d, _e;\n                const { data, error } = result;\n                if (error)\n                    throw error;\n                const url = await this._getUrlForProvider(`${this.url}/user/identities/authorize`, credentials.provider, {\n                    redirectTo: (_a = credentials.options) === null || _a === void 0 ? void 0 : _a.redirectTo,\n                    scopes: (_b = credentials.options) === null || _b === void 0 ? void 0 : _b.scopes,\n                    queryParams: (_c = credentials.options) === null || _c === void 0 ? void 0 : _c.queryParams,\n                    skipBrowserRedirect: true,\n                });\n                return await _request(this.fetch, 'GET', url, {\n                    headers: this.headers,\n                    jwt: (_e = (_d = data.session) === null || _d === void 0 ? void 0 : _d.access_token) !== null && _e !== void 0 ? _e : undefined,\n                });\n            });\n            if (error)\n                throw error;\n            if (isBrowser() && !((_a = credentials.options) === null || _a === void 0 ? void 0 : _a.skipBrowserRedirect)) {\n                window.location.assign(data === null || data === void 0 ? void 0 : data.url);\n            }\n            return this._returnResult({\n                data: { provider: credentials.provider, url: data === null || data === void 0 ? void 0 : data.url },\n                error: null,\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: { provider: credentials.provider, url: null }, error });\n            }\n            throw error;\n        }\n    }\n    async linkIdentityIdToken(credentials) {\n        return await this._useSession(async (result) => {\n            var _a;\n            try {\n                const { error: sessionError, data: { session }, } = result;\n                if (sessionError)\n                    throw sessionError;\n                const { options, provider, token, access_token, nonce } = credentials;\n                const res = await _request(this.fetch, 'POST', `${this.url}/token?grant_type=id_token`, {\n                    headers: this.headers,\n                    jwt: (_a = session === null || session === void 0 ? void 0 : session.access_token) !== null && _a !== void 0 ? _a : undefined,\n                    body: {\n                        provider,\n                        id_token: token,\n                        access_token,\n                        nonce,\n                        link_identity: true,\n                        gotrue_meta_security: { captcha_token: options === null || options === void 0 ? void 0 : options.captchaToken },\n                    },\n                    xform: _sessionResponse,\n                });\n                const { data, error } = res;\n                if (error) {\n                    return this._returnResult({ data: { user: null, session: null }, error });\n                }\n                else if (!data || !data.session || !data.user) {\n                    return this._returnResult({\n                        data: { user: null, session: null },\n                        error: new AuthInvalidTokenResponseError(),\n                    });\n                }\n                if (data.session) {\n                    await this._saveSession(data.session);\n                    await this._notifyAllSubscribers('USER_UPDATED', data.session);\n                }\n                return this._returnResult({ data, error });\n            }\n            catch (error) {\n                if (isAuthError(error)) {\n                    return this._returnResult({ data: { user: null, session: null }, error });\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Unlinks an identity from a user by deleting it. The user will no longer be able to sign in with that identity once it's unlinked.\n     */\n    async unlinkIdentity(identity) {\n        try {\n            return await this._useSession(async (result) => {\n                var _a, _b;\n                const { data, error } = result;\n                if (error) {\n                    throw error;\n                }\n                return await _request(this.fetch, 'DELETE', `${this.url}/user/identities/${identity.identity_id}`, {\n                    headers: this.headers,\n                    jwt: (_b = (_a = data.session) === null || _a === void 0 ? void 0 : _a.access_token) !== null && _b !== void 0 ? _b : undefined,\n                });\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: null, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Generates a new JWT.\n     * @param refreshToken A valid refresh token that was returned on login.\n     */\n    async _refreshAccessToken(refreshToken) {\n        const debugName = `#_refreshAccessToken(${refreshToken.substring(0, 5)}...)`;\n        this._debug(debugName, 'begin');\n        try {\n            const startedAt = Date.now();\n            // will attempt to refresh the token with exponential backoff\n            return await retryable(async (attempt) => {\n                if (attempt > 0) {\n                    await sleep(200 * Math.pow(2, attempt - 1)); // 200, 400, 800, ...\n                }\n                this._debug(debugName, 'refreshing attempt', attempt);\n                return await _request(this.fetch, 'POST', `${this.url}/token?grant_type=refresh_token`, {\n                    body: { refresh_token: refreshToken },\n                    headers: this.headers,\n                    xform: _sessionResponse,\n                });\n            }, (attempt, error) => {\n                const nextBackOffInterval = 200 * Math.pow(2, attempt);\n                return (error &&\n                    isAuthRetryableFetchError(error) &&\n                    // retryable only if the request can be sent before the backoff overflows the tick duration\n                    Date.now() + nextBackOffInterval - startedAt < AUTO_REFRESH_TICK_DURATION_MS);\n            });\n        }\n        catch (error) {\n            this._debug(debugName, 'error', error);\n            if (isAuthError(error)) {\n                return this._returnResult({ data: { session: null, user: null }, error });\n            }\n            throw error;\n        }\n        finally {\n            this._debug(debugName, 'end');\n        }\n    }\n    _isValidSession(maybeSession) {\n        const isValidSession = typeof maybeSession === 'object' &&\n            maybeSession !== null &&\n            'access_token' in maybeSession &&\n            'refresh_token' in maybeSession &&\n            'expires_at' in maybeSession;\n        return isValidSession;\n    }\n    async _handleProviderSignIn(provider, options) {\n        const url = await this._getUrlForProvider(`${this.url}/authorize`, provider, {\n            redirectTo: options.redirectTo,\n            scopes: options.scopes,\n            queryParams: options.queryParams,\n        });\n        this._debug('#_handleProviderSignIn()', 'provider', provider, 'options', options, 'url', url);\n        // try to open on the browser\n        if (isBrowser() && !options.skipBrowserRedirect) {\n            window.location.assign(url);\n        }\n        return { data: { provider, url }, error: null };\n    }\n    /**\n     * Recovers the session from LocalStorage and refreshes the token\n     * Note: this method is async to accommodate for AsyncStorage e.g. in React native.\n     */\n    async _recoverAndRefresh() {\n        var _a, _b;\n        const debugName = '#_recoverAndRefresh()';\n        this._debug(debugName, 'begin');\n        try {\n            const currentSession = (await getItemAsync(this.storage, this.storageKey));\n            if (currentSession && this.userStorage) {\n                let maybeUser = (await getItemAsync(this.userStorage, this.storageKey + '-user'));\n                if (!this.storage.isServer && Object.is(this.storage, this.userStorage) && !maybeUser) {\n                    // storage and userStorage are the same storage medium, for example\n                    // window.localStorage if userStorage does not have the user from\n                    // storage stored, store it first thereby migrating the user object\n                    // from storage -> userStorage\n                    maybeUser = { user: currentSession.user };\n                    await setItemAsync(this.userStorage, this.storageKey + '-user', maybeUser);\n                }\n                currentSession.user = (_a = maybeUser === null || maybeUser === void 0 ? void 0 : maybeUser.user) !== null && _a !== void 0 ? _a : userNotAvailableProxy();\n            }\n            else if (currentSession && !currentSession.user) {\n                // user storage is not set, let's check if it was previously enabled so\n                // we bring back the storage as it should be\n                if (!currentSession.user) {\n                    // test if userStorage was previously enabled and the storage medium was the same, to move the user back under the same key\n                    const separateUser = (await getItemAsync(this.storage, this.storageKey + '-user'));\n                    if (separateUser && (separateUser === null || separateUser === void 0 ? void 0 : separateUser.user)) {\n                        currentSession.user = separateUser.user;\n                        await removeItemAsync(this.storage, this.storageKey + '-user');\n                        await setItemAsync(this.storage, this.storageKey, currentSession);\n                    }\n                    else {\n                        currentSession.user = userNotAvailableProxy();\n                    }\n                }\n            }\n            this._debug(debugName, 'session from storage', currentSession);\n            if (!this._isValidSession(currentSession)) {\n                this._debug(debugName, 'session is not valid');\n                if (currentSession !== null) {\n                    await this._removeSession();\n                }\n                return;\n            }\n            const expiresWithMargin = ((_b = currentSession.expires_at) !== null && _b !== void 0 ? _b : Infinity) * 1000 - Date.now() < EXPIRY_MARGIN_MS;\n            this._debug(debugName, `session has${expiresWithMargin ? '' : ' not'} expired with margin of ${EXPIRY_MARGIN_MS}s`);\n            if (expiresWithMargin) {\n                if (this.autoRefreshToken && currentSession.refresh_token) {\n                    const { error } = await this._callRefreshToken(currentSession.refresh_token);\n                    if (error) {\n                        console.error(error);\n                        if (!isAuthRetryableFetchError(error)) {\n                            this._debug(debugName, 'refresh failed with a non-retryable error, removing the session', error);\n                            await this._removeSession();\n                        }\n                    }\n                }\n            }\n            else if (currentSession.user &&\n                currentSession.user.__isUserNotAvailableProxy === true) {\n                // If we have a proxy user, try to get the real user data\n                try {\n                    const { data, error: userError } = await this._getUser(currentSession.access_token);\n                    if (!userError && (data === null || data === void 0 ? void 0 : data.user)) {\n                        currentSession.user = data.user;\n                        await this._saveSession(currentSession);\n                        await this._notifyAllSubscribers('SIGNED_IN', currentSession);\n                    }\n                    else {\n                        this._debug(debugName, 'could not get user data, skipping SIGNED_IN notification');\n                    }\n                }\n                catch (getUserError) {\n                    console.error('Error getting user data:', getUserError);\n                    this._debug(debugName, 'error getting user data, skipping SIGNED_IN notification', getUserError);\n                }\n            }\n            else {\n                // no need to persist currentSession again, as we just loaded it from\n                // local storage; persisting it again may overwrite a value saved by\n                // another client with access to the same local storage\n                await this._notifyAllSubscribers('SIGNED_IN', currentSession);\n            }\n        }\n        catch (err) {\n            this._debug(debugName, 'error', err);\n            console.error(err);\n            return;\n        }\n        finally {\n            this._debug(debugName, 'end');\n        }\n    }\n    async _callRefreshToken(refreshToken) {\n        var _a, _b;\n        if (!refreshToken) {\n            throw new AuthSessionMissingError();\n        }\n        // refreshing is already in progress\n        if (this.refreshingDeferred) {\n            return this.refreshingDeferred.promise;\n        }\n        const debugName = `#_callRefreshToken(${refreshToken.substring(0, 5)}...)`;\n        this._debug(debugName, 'begin');\n        try {\n            this.refreshingDeferred = new Deferred();\n            const { data, error } = await this._refreshAccessToken(refreshToken);\n            if (error)\n                throw error;\n            if (!data.session)\n                throw new AuthSessionMissingError();\n            await this._saveSession(data.session);\n            await this._notifyAllSubscribers('TOKEN_REFRESHED', data.session);\n            const result = { data: data.session, error: null };\n            this.refreshingDeferred.resolve(result);\n            return result;\n        }\n        catch (error) {\n            this._debug(debugName, 'error', error);\n            if (isAuthError(error)) {\n                const result = { data: null, error };\n                if (!isAuthRetryableFetchError(error)) {\n                    await this._removeSession();\n                }\n                (_a = this.refreshingDeferred) === null || _a === void 0 ? void 0 : _a.resolve(result);\n                return result;\n            }\n            (_b = this.refreshingDeferred) === null || _b === void 0 ? void 0 : _b.reject(error);\n            throw error;\n        }\n        finally {\n            this.refreshingDeferred = null;\n            this._debug(debugName, 'end');\n        }\n    }\n    async _notifyAllSubscribers(event, session, broadcast = true) {\n        const debugName = `#_notifyAllSubscribers(${event})`;\n        this._debug(debugName, 'begin', session, `broadcast = ${broadcast}`);\n        try {\n            if (this.broadcastChannel && broadcast) {\n                this.broadcastChannel.postMessage({ event, session });\n            }\n            const errors = [];\n            const promises = Array.from(this.stateChangeEmitters.values()).map(async (x) => {\n                try {\n                    await x.callback(event, session);\n                }\n                catch (e) {\n                    errors.push(e);\n                }\n            });\n            await Promise.all(promises);\n            if (errors.length > 0) {\n                for (let i = 0; i < errors.length; i += 1) {\n                    console.error(errors[i]);\n                }\n                throw errors[0];\n            }\n        }\n        finally {\n            this._debug(debugName, 'end');\n        }\n    }\n    /**\n     * set currentSession and currentUser\n     * process to _startAutoRefreshToken if possible\n     */\n    async _saveSession(session) {\n        this._debug('#_saveSession()', session);\n        // _saveSession is always called whenever a new session has been acquired\n        // so we can safely suppress the warning returned by future getSession calls\n        this.suppressGetSessionWarning = true;\n        // Create a shallow copy to work with, to avoid mutating the original session object if it's used elsewhere\n        const sessionToProcess = Object.assign({}, session);\n        const userIsProxy = sessionToProcess.user && sessionToProcess.user.__isUserNotAvailableProxy === true;\n        if (this.userStorage) {\n            if (!userIsProxy && sessionToProcess.user) {\n                // If it's a real user object, save it to userStorage.\n                await setItemAsync(this.userStorage, this.storageKey + '-user', {\n                    user: sessionToProcess.user,\n                });\n            }\n            else if (userIsProxy) {\n                // If it's the proxy, it means user was not found in userStorage.\n                // We should ensure no stale user data for this key exists in userStorage if we were to save null,\n                // or simply not save the proxy. For now, we don't save the proxy here.\n                // If there's a need to clear userStorage if user becomes proxy, that logic would go here.\n            }\n            // Prepare the main session data for primary storage: remove the user property before cloning\n            // This is important because the original session.user might be the proxy\n            const mainSessionData = Object.assign({}, sessionToProcess);\n            delete mainSessionData.user; // Remove user (real or proxy) before cloning for main storage\n            const clonedMainSessionData = deepClone(mainSessionData);\n            await setItemAsync(this.storage, this.storageKey, clonedMainSessionData);\n        }\n        else {\n            // No userStorage is configured.\n            // In this case, session.user should ideally not be a proxy.\n            // If it were, structuredClone would fail. This implies an issue elsewhere if user is a proxy here\n            const clonedSession = deepClone(sessionToProcess); // sessionToProcess still has its original user property\n            await setItemAsync(this.storage, this.storageKey, clonedSession);\n        }\n    }\n    async _removeSession() {\n        this._debug('#_removeSession()');\n        await removeItemAsync(this.storage, this.storageKey);\n        await removeItemAsync(this.storage, this.storageKey + '-code-verifier');\n        await removeItemAsync(this.storage, this.storageKey + '-user');\n        if (this.userStorage) {\n            await removeItemAsync(this.userStorage, this.storageKey + '-user');\n        }\n        await this._notifyAllSubscribers('SIGNED_OUT', null);\n    }\n    /**\n     * Removes any registered visibilitychange callback.\n     *\n     * {@see #startAutoRefresh}\n     * {@see #stopAutoRefresh}\n     */\n    _removeVisibilityChangedCallback() {\n        this._debug('#_removeVisibilityChangedCallback()');\n        const callback = this.visibilityChangedCallback;\n        this.visibilityChangedCallback = null;\n        try {\n            if (callback && isBrowser() && (window === null || window === void 0 ? void 0 : window.removeEventListener)) {\n                window.removeEventListener('visibilitychange', callback);\n            }\n        }\n        catch (e) {\n            console.error('removing visibilitychange callback failed', e);\n        }\n    }\n    /**\n     * This is the private implementation of {@link #startAutoRefresh}. Use this\n     * within the library.\n     */\n    async _startAutoRefresh() {\n        await this._stopAutoRefresh();\n        this._debug('#_startAutoRefresh()');\n        const ticker = setInterval(() => this._autoRefreshTokenTick(), AUTO_REFRESH_TICK_DURATION_MS);\n        this.autoRefreshTicker = ticker;\n        if (ticker && typeof ticker === 'object' && typeof ticker.unref === 'function') {\n            // ticker is a NodeJS Timeout object that has an `unref` method\n            // https://nodejs.org/api/timers.html#timeoutunref\n            // When auto refresh is used in NodeJS (like for testing) the\n            // `setInterval` is preventing the process from being marked as\n            // finished and tests run endlessly. This can be prevented by calling\n            // `unref()` on the returned object.\n            ticker.unref();\n            // @ts-expect-error TS has no context of Deno\n        }\n        else if (typeof Deno !== 'undefined' && typeof Deno.unrefTimer === 'function') {\n            // similar like for NodeJS, but with the Deno API\n            // https://deno.land/api@latest?unstable&s=Deno.unrefTimer\n            // @ts-expect-error TS has no context of Deno\n            Deno.unrefTimer(ticker);\n        }\n        // run the tick immediately, but in the next pass of the event loop so that\n        // #_initialize can be allowed to complete without recursively waiting on\n        // itself\n        setTimeout(async () => {\n            await this.initializePromise;\n            await this._autoRefreshTokenTick();\n        }, 0);\n    }\n    /**\n     * This is the private implementation of {@link #stopAutoRefresh}. Use this\n     * within the library.\n     */\n    async _stopAutoRefresh() {\n        this._debug('#_stopAutoRefresh()');\n        const ticker = this.autoRefreshTicker;\n        this.autoRefreshTicker = null;\n        if (ticker) {\n            clearInterval(ticker);\n        }\n    }\n    /**\n     * Starts an auto-refresh process in the background. The session is checked\n     * every few seconds. Close to the time of expiration a process is started to\n     * refresh the session. If refreshing fails it will be retried for as long as\n     * necessary.\n     *\n     * If you set the {@link GoTrueClientOptions#autoRefreshToken} you don't need\n     * to call this function, it will be called for you.\n     *\n     * On browsers the refresh process works only when the tab/window is in the\n     * foreground to conserve resources as well as prevent race conditions and\n     * flooding auth with requests. If you call this method any managed\n     * visibility change callback will be removed and you must manage visibility\n     * changes on your own.\n     *\n     * On non-browser platforms the refresh process works *continuously* in the\n     * background, which may not be desirable. You should hook into your\n     * platform's foreground indication mechanism and call these methods\n     * appropriately to conserve resources.\n     *\n     * {@see #stopAutoRefresh}\n     */\n    async startAutoRefresh() {\n        this._removeVisibilityChangedCallback();\n        await this._startAutoRefresh();\n    }\n    /**\n     * Stops an active auto refresh process running in the background (if any).\n     *\n     * If you call this method any managed visibility change callback will be\n     * removed and you must manage visibility changes on your own.\n     *\n     * See {@link #startAutoRefresh} for more details.\n     */\n    async stopAutoRefresh() {\n        this._removeVisibilityChangedCallback();\n        await this._stopAutoRefresh();\n    }\n    /**\n     * Runs the auto refresh token tick.\n     */\n    async _autoRefreshTokenTick() {\n        this._debug('#_autoRefreshTokenTick()', 'begin');\n        try {\n            await this._acquireLock(0, async () => {\n                try {\n                    const now = Date.now();\n                    try {\n                        return await this._useSession(async (result) => {\n                            const { data: { session }, } = result;\n                            if (!session || !session.refresh_token || !session.expires_at) {\n                                this._debug('#_autoRefreshTokenTick()', 'no session');\n                                return;\n                            }\n                            // session will expire in this many ticks (or has already expired if <= 0)\n                            const expiresInTicks = Math.floor((session.expires_at * 1000 - now) / AUTO_REFRESH_TICK_DURATION_MS);\n                            this._debug('#_autoRefreshTokenTick()', `access token expires in ${expiresInTicks} ticks, a tick lasts ${AUTO_REFRESH_TICK_DURATION_MS}ms, refresh threshold is ${AUTO_REFRESH_TICK_THRESHOLD} ticks`);\n                            if (expiresInTicks <= AUTO_REFRESH_TICK_THRESHOLD) {\n                                await this._callRefreshToken(session.refresh_token);\n                            }\n                        });\n                    }\n                    catch (e) {\n                        console.error('Auto refresh tick failed with error. This is likely a transient error.', e);\n                    }\n                }\n                finally {\n                    this._debug('#_autoRefreshTokenTick()', 'end');\n                }\n            });\n        }\n        catch (e) {\n            if (e.isAcquireTimeout || e instanceof LockAcquireTimeoutError) {\n                this._debug('auto refresh token tick lock not available');\n            }\n            else {\n                throw e;\n            }\n        }\n    }\n    /**\n     * Registers callbacks on the browser / platform, which in-turn run\n     * algorithms when the browser window/tab are in foreground. On non-browser\n     * platforms it assumes always foreground.\n     */\n    async _handleVisibilityChange() {\n        this._debug('#_handleVisibilityChange()');\n        if (!isBrowser() || !(window === null || window === void 0 ? void 0 : window.addEventListener)) {\n            if (this.autoRefreshToken) {\n                // in non-browser environments the refresh token ticker runs always\n                this.startAutoRefresh();\n            }\n            return false;\n        }\n        try {\n            this.visibilityChangedCallback = async () => await this._onVisibilityChanged(false);\n            window === null || window === void 0 ? void 0 : window.addEventListener('visibilitychange', this.visibilityChangedCallback);\n            // now immediately call the visbility changed callback to setup with the\n            // current visbility state\n            await this._onVisibilityChanged(true); // initial call\n        }\n        catch (error) {\n            console.error('_handleVisibilityChange', error);\n        }\n    }\n    /**\n     * Callback registered with `window.addEventListener('visibilitychange')`.\n     */\n    async _onVisibilityChanged(calledFromInitialize) {\n        const methodName = `#_onVisibilityChanged(${calledFromInitialize})`;\n        this._debug(methodName, 'visibilityState', document.visibilityState);\n        if (document.visibilityState === 'visible') {\n            if (this.autoRefreshToken) {\n                // in browser environments the refresh token ticker runs only on focused tabs\n                // which prevents race conditions\n                this._startAutoRefresh();\n            }\n            if (!calledFromInitialize) {\n                // called when the visibility has changed, i.e. the browser\n                // transitioned from hidden -> visible so we need to see if the session\n                // should be recovered immediately... but to do that we need to acquire\n                // the lock first asynchronously\n                await this.initializePromise;\n                await this._acquireLock(-1, async () => {\n                    if (document.visibilityState !== 'visible') {\n                        this._debug(methodName, 'acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting');\n                        // visibility has changed while waiting for the lock, abort\n                        return;\n                    }\n                    // recover the session\n                    await this._recoverAndRefresh();\n                });\n            }\n        }\n        else if (document.visibilityState === 'hidden') {\n            if (this.autoRefreshToken) {\n                this._stopAutoRefresh();\n            }\n        }\n    }\n    /**\n     * Generates the relevant login URL for a third-party provider.\n     * @param options.redirectTo A URL or mobile address to send the user to after they are confirmed.\n     * @param options.scopes A space-separated list of scopes granted to the OAuth application.\n     * @param options.queryParams An object of key-value pairs containing query parameters granted to the OAuth application.\n     */\n    async _getUrlForProvider(url, provider, options) {\n        const urlParams = [`provider=${encodeURIComponent(provider)}`];\n        if (options === null || options === void 0 ? void 0 : options.redirectTo) {\n            urlParams.push(`redirect_to=${encodeURIComponent(options.redirectTo)}`);\n        }\n        if (options === null || options === void 0 ? void 0 : options.scopes) {\n            urlParams.push(`scopes=${encodeURIComponent(options.scopes)}`);\n        }\n        if (this.flowType === 'pkce') {\n            const [codeChallenge, codeChallengeMethod] = await getCodeChallengeAndMethod(this.storage, this.storageKey);\n            const flowParams = new URLSearchParams({\n                code_challenge: `${encodeURIComponent(codeChallenge)}`,\n                code_challenge_method: `${encodeURIComponent(codeChallengeMethod)}`,\n            });\n            urlParams.push(flowParams.toString());\n        }\n        if (options === null || options === void 0 ? void 0 : options.queryParams) {\n            const query = new URLSearchParams(options.queryParams);\n            urlParams.push(query.toString());\n        }\n        if (options === null || options === void 0 ? void 0 : options.skipBrowserRedirect) {\n            urlParams.push(`skip_http_redirect=${options.skipBrowserRedirect}`);\n        }\n        return `${url}?${urlParams.join('&')}`;\n    }\n    async _unenroll(params) {\n        try {\n            return await this._useSession(async (result) => {\n                var _a;\n                const { data: sessionData, error: sessionError } = result;\n                if (sessionError) {\n                    return this._returnResult({ data: null, error: sessionError });\n                }\n                return await _request(this.fetch, 'DELETE', `${this.url}/factors/${params.factorId}`, {\n                    headers: this.headers,\n                    jwt: (_a = sessionData === null || sessionData === void 0 ? void 0 : sessionData.session) === null || _a === void 0 ? void 0 : _a.access_token,\n                });\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: null, error });\n            }\n            throw error;\n        }\n    }\n    async _enroll(params) {\n        try {\n            return await this._useSession(async (result) => {\n                var _a, _b;\n                const { data: sessionData, error: sessionError } = result;\n                if (sessionError) {\n                    return this._returnResult({ data: null, error: sessionError });\n                }\n                const body = Object.assign({ friendly_name: params.friendlyName, factor_type: params.factorType }, (params.factorType === 'phone'\n                    ? { phone: params.phone }\n                    : params.factorType === 'totp'\n                        ? { issuer: params.issuer }\n                        : {}));\n                const { data, error } = (await _request(this.fetch, 'POST', `${this.url}/factors`, {\n                    body,\n                    headers: this.headers,\n                    jwt: (_a = sessionData === null || sessionData === void 0 ? void 0 : sessionData.session) === null || _a === void 0 ? void 0 : _a.access_token,\n                }));\n                if (error) {\n                    return this._returnResult({ data: null, error });\n                }\n                if (params.factorType === 'totp' && data.type === 'totp' && ((_b = data === null || data === void 0 ? void 0 : data.totp) === null || _b === void 0 ? void 0 : _b.qr_code)) {\n                    data.totp.qr_code = `data:image/svg+xml;utf-8,${data.totp.qr_code}`;\n                }\n                return this._returnResult({ data, error: null });\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: null, error });\n            }\n            throw error;\n        }\n    }\n    async _verify(params) {\n        return this._acquireLock(-1, async () => {\n            try {\n                return await this._useSession(async (result) => {\n                    var _a;\n                    const { data: sessionData, error: sessionError } = result;\n                    if (sessionError) {\n                        return this._returnResult({ data: null, error: sessionError });\n                    }\n                    const body = Object.assign({ challenge_id: params.challengeId }, ('webauthn' in params\n                        ? {\n                            webauthn: Object.assign(Object.assign({}, params.webauthn), { credential_response: params.webauthn.type === 'create'\n                                    ? serializeCredentialCreationResponse(params.webauthn.credential_response)\n                                    : serializeCredentialRequestResponse(params.webauthn.credential_response) }),\n                        }\n                        : { code: params.code }));\n                    const { data, error } = await _request(this.fetch, 'POST', `${this.url}/factors/${params.factorId}/verify`, {\n                        body,\n                        headers: this.headers,\n                        jwt: (_a = sessionData === null || sessionData === void 0 ? void 0 : sessionData.session) === null || _a === void 0 ? void 0 : _a.access_token,\n                    });\n                    if (error) {\n                        return this._returnResult({ data: null, error });\n                    }\n                    await this._saveSession(Object.assign({ expires_at: Math.round(Date.now() / 1000) + data.expires_in }, data));\n                    await this._notifyAllSubscribers('MFA_CHALLENGE_VERIFIED', data);\n                    return this._returnResult({ data, error });\n                });\n            }\n            catch (error) {\n                if (isAuthError(error)) {\n                    return this._returnResult({ data: null, error });\n                }\n                throw error;\n            }\n        });\n    }\n    async _challenge(params) {\n        return this._acquireLock(-1, async () => {\n            try {\n                return await this._useSession(async (result) => {\n                    var _a;\n                    const { data: sessionData, error: sessionError } = result;\n                    if (sessionError) {\n                        return this._returnResult({ data: null, error: sessionError });\n                    }\n                    const response = (await _request(this.fetch, 'POST', `${this.url}/factors/${params.factorId}/challenge`, {\n                        body: params,\n                        headers: this.headers,\n                        jwt: (_a = sessionData === null || sessionData === void 0 ? void 0 : sessionData.session) === null || _a === void 0 ? void 0 : _a.access_token,\n                    }));\n                    if (response.error) {\n                        return response;\n                    }\n                    const { data } = response;\n                    if (data.type !== 'webauthn') {\n                        return { data, error: null };\n                    }\n                    switch (data.webauthn.type) {\n                        case 'create':\n                            return {\n                                data: Object.assign(Object.assign({}, data), { webauthn: Object.assign(Object.assign({}, data.webauthn), { credential_options: Object.assign(Object.assign({}, data.webauthn.credential_options), { publicKey: deserializeCredentialCreationOptions(data.webauthn.credential_options.publicKey) }) }) }),\n                                error: null,\n                            };\n                        case 'request':\n                            return {\n                                data: Object.assign(Object.assign({}, data), { webauthn: Object.assign(Object.assign({}, data.webauthn), { credential_options: Object.assign(Object.assign({}, data.webauthn.credential_options), { publicKey: deserializeCredentialRequestOptions(data.webauthn.credential_options.publicKey) }) }) }),\n                                error: null,\n                            };\n                    }\n                });\n            }\n            catch (error) {\n                if (isAuthError(error)) {\n                    return this._returnResult({ data: null, error });\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * {@see GoTrueMFAApi#challengeAndVerify}\n     */\n    async _challengeAndVerify(params) {\n        // both _challenge and _verify independently acquire the lock, so no need\n        // to acquire it here\n        const { data: challengeData, error: challengeError } = await this._challenge({\n            factorId: params.factorId,\n        });\n        if (challengeError) {\n            return this._returnResult({ data: null, error: challengeError });\n        }\n        return await this._verify({\n            factorId: params.factorId,\n            challengeId: challengeData.id,\n            code: params.code,\n        });\n    }\n    /**\n     * {@see GoTrueMFAApi#listFactors}\n     */\n    async _listFactors() {\n        var _a;\n        // use #getUser instead of #_getUser as the former acquires a lock\n        const { data: { user }, error: userError, } = await this.getUser();\n        if (userError) {\n            return { data: null, error: userError };\n        }\n        const data = {\n            all: [],\n            phone: [],\n            totp: [],\n            webauthn: [],\n        };\n        // loop over the factors ONCE\n        for (const factor of (_a = user === null || user === void 0 ? void 0 : user.factors) !== null && _a !== void 0 ? _a : []) {\n            data.all.push(factor);\n            if (factor.status === 'verified') {\n                ;\n                data[factor.factor_type].push(factor);\n            }\n        }\n        return {\n            data,\n            error: null,\n        };\n    }\n    /**\n     * {@see GoTrueMFAApi#getAuthenticatorAssuranceLevel}\n     */\n    async _getAuthenticatorAssuranceLevel() {\n        var _a, _b;\n        const { data: { session }, error: sessionError, } = await this.getSession();\n        if (sessionError) {\n            return this._returnResult({ data: null, error: sessionError });\n        }\n        if (!session) {\n            return {\n                data: { currentLevel: null, nextLevel: null, currentAuthenticationMethods: [] },\n                error: null,\n            };\n        }\n        const { payload } = decodeJWT(session.access_token);\n        let currentLevel = null;\n        if (payload.aal) {\n            currentLevel = payload.aal;\n        }\n        let nextLevel = currentLevel;\n        const verifiedFactors = (_b = (_a = session.user.factors) === null || _a === void 0 ? void 0 : _a.filter((factor) => factor.status === 'verified')) !== null && _b !== void 0 ? _b : [];\n        if (verifiedFactors.length > 0) {\n            nextLevel = 'aal2';\n        }\n        const currentAuthenticationMethods = payload.amr || [];\n        return { data: { currentLevel, nextLevel, currentAuthenticationMethods }, error: null };\n    }\n    /**\n     * Retrieves details about an OAuth authorization request.\n     * Only relevant when the OAuth 2.1 server is enabled in Supabase Auth.\n     *\n     * Returns authorization details including client info, scopes, and user information.\n     * If the API returns a redirect_uri, it means consent was already given - the caller\n     * should handle the redirect manually if needed.\n     */\n    async _getAuthorizationDetails(authorizationId) {\n        try {\n            return await this._useSession(async (result) => {\n                const { data: { session }, error: sessionError, } = result;\n                if (sessionError) {\n                    return this._returnResult({ data: null, error: sessionError });\n                }\n                if (!session) {\n                    return this._returnResult({ data: null, error: new AuthSessionMissingError() });\n                }\n                return await _request(this.fetch, 'GET', `${this.url}/oauth/authorizations/${authorizationId}`, {\n                    headers: this.headers,\n                    jwt: session.access_token,\n                    xform: (data) => ({ data, error: null }),\n                });\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: null, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Approves an OAuth authorization request.\n     * Only relevant when the OAuth 2.1 server is enabled in Supabase Auth.\n     */\n    async _approveAuthorization(authorizationId, options) {\n        try {\n            return await this._useSession(async (result) => {\n                const { data: { session }, error: sessionError, } = result;\n                if (sessionError) {\n                    return this._returnResult({ data: null, error: sessionError });\n                }\n                if (!session) {\n                    return this._returnResult({ data: null, error: new AuthSessionMissingError() });\n                }\n                const response = await _request(this.fetch, 'POST', `${this.url}/oauth/authorizations/${authorizationId}/consent`, {\n                    headers: this.headers,\n                    jwt: session.access_token,\n                    body: { action: 'approve' },\n                    xform: (data) => ({ data, error: null }),\n                });\n                if (response.data && response.data.redirect_url) {\n                    // Automatically redirect in browser unless skipBrowserRedirect is true\n                    if (isBrowser() && !(options === null || options === void 0 ? void 0 : options.skipBrowserRedirect)) {\n                        window.location.assign(response.data.redirect_url);\n                    }\n                }\n                return response;\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: null, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Denies an OAuth authorization request.\n     * Only relevant when the OAuth 2.1 server is enabled in Supabase Auth.\n     */\n    async _denyAuthorization(authorizationId, options) {\n        try {\n            return await this._useSession(async (result) => {\n                const { data: { session }, error: sessionError, } = result;\n                if (sessionError) {\n                    return this._returnResult({ data: null, error: sessionError });\n                }\n                if (!session) {\n                    return this._returnResult({ data: null, error: new AuthSessionMissingError() });\n                }\n                const response = await _request(this.fetch, 'POST', `${this.url}/oauth/authorizations/${authorizationId}/consent`, {\n                    headers: this.headers,\n                    jwt: session.access_token,\n                    body: { action: 'deny' },\n                    xform: (data) => ({ data, error: null }),\n                });\n                if (response.data && response.data.redirect_url) {\n                    // Automatically redirect in browser unless skipBrowserRedirect is true\n                    if (isBrowser() && !(options === null || options === void 0 ? void 0 : options.skipBrowserRedirect)) {\n                        window.location.assign(response.data.redirect_url);\n                    }\n                }\n                return response;\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: null, error });\n            }\n            throw error;\n        }\n    }\n    async fetchJwk(kid, jwks = { keys: [] }) {\n        // try fetching from the supplied jwks\n        let jwk = jwks.keys.find((key) => key.kid === kid);\n        if (jwk) {\n            return jwk;\n        }\n        const now = Date.now();\n        // try fetching from cache\n        jwk = this.jwks.keys.find((key) => key.kid === kid);\n        // jwk exists and jwks isn't stale\n        if (jwk && this.jwks_cached_at + JWKS_TTL > now) {\n            return jwk;\n        }\n        // jwk isn't cached in memory so we need to fetch it from the well-known endpoint\n        const { data, error } = await _request(this.fetch, 'GET', `${this.url}/.well-known/jwks.json`, {\n            headers: this.headers,\n        });\n        if (error) {\n            throw error;\n        }\n        if (!data.keys || data.keys.length === 0) {\n            return null;\n        }\n        this.jwks = data;\n        this.jwks_cached_at = now;\n        // Find the signing key\n        jwk = data.keys.find((key) => key.kid === kid);\n        if (!jwk) {\n            return null;\n        }\n        return jwk;\n    }\n    /**\n     * Extracts the JWT claims present in the access token by first verifying the\n     * JWT against the server's JSON Web Key Set endpoint\n     * `/.well-known/jwks.json` which is often cached, resulting in significantly\n     * faster responses. Prefer this method over {@link #getUser} which always\n     * sends a request to the Auth server for each JWT.\n     *\n     * If the project is not using an asymmetric JWT signing key (like ECC or\n     * RSA) it always sends a request to the Auth server (similar to {@link\n     * #getUser}) to verify the JWT.\n     *\n     * @param jwt An optional specific JWT you wish to verify, not the one you\n     *            can obtain from {@link #getSession}.\n     * @param options Various additional options that allow you to customize the\n     *                behavior of this method.\n     */\n    async getClaims(jwt, options = {}) {\n        try {\n            let token = jwt;\n            if (!token) {\n                const { data, error } = await this.getSession();\n                if (error || !data.session) {\n                    return this._returnResult({ data: null, error });\n                }\n                token = data.session.access_token;\n            }\n            const { header, payload, signature, raw: { header: rawHeader, payload: rawPayload }, } = decodeJWT(token);\n            if (!(options === null || options === void 0 ? void 0 : options.allowExpired)) {\n                // Reject expired JWTs should only happen if jwt argument was passed\n                validateExp(payload.exp);\n            }\n            const signingKey = !header.alg ||\n                header.alg.startsWith('HS') ||\n                !header.kid ||\n                !('crypto' in globalThis && 'subtle' in globalThis.crypto)\n                ? null\n                : await this.fetchJwk(header.kid, (options === null || options === void 0 ? void 0 : options.keys) ? { keys: options.keys } : options === null || options === void 0 ? void 0 : options.jwks);\n            // If symmetric algorithm or WebCrypto API is unavailable, fallback to getUser()\n            if (!signingKey) {\n                const { error } = await this.getUser(token);\n                if (error) {\n                    throw error;\n                }\n                // getUser succeeds so the claims in the JWT can be trusted\n                return {\n                    data: {\n                        claims: payload,\n                        header,\n                        signature,\n                    },\n                    error: null,\n                };\n            }\n            const algorithm = getAlgorithm(header.alg);\n            // Convert JWK to CryptoKey\n            const publicKey = await crypto.subtle.importKey('jwk', signingKey, algorithm, true, [\n                'verify',\n            ]);\n            // Verify the signature\n            const isValid = await crypto.subtle.verify(algorithm, publicKey, signature, stringToUint8Array(`${rawHeader}.${rawPayload}`));\n            if (!isValid) {\n                throw new AuthInvalidJwtError('Invalid JWT signature');\n            }\n            // If verification succeeds, decode and return claims\n            return {\n                data: {\n                    claims: payload,\n                    header,\n                    signature,\n                },\n                error: null,\n            };\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: null, error });\n            }\n            throw error;\n        }\n    }\n}\nGoTrueClient.nextInstanceID = {};\nexport default GoTrueClient;\n//# sourceMappingURL=GoTrueClient.js.map","import GoTrueClient from './GoTrueClient';\nconst AuthClient = GoTrueClient;\nexport default AuthClient;\n//# sourceMappingURL=AuthClient.js.map","import { AuthClient } from '@supabase/auth-js';\nexport class SupabaseAuthClient extends AuthClient {\n    constructor(options) {\n        super(options);\n    }\n}\n//# sourceMappingURL=SupabaseAuthClient.js.map","import { FunctionsClient } from '@supabase/functions-js';\nimport { PostgrestClient, } from '@supabase/postgrest-js';\nimport { RealtimeClient, } from '@supabase/realtime-js';\nimport { StorageClient as SupabaseStorageClient } from '@supabase/storage-js';\nimport { DEFAULT_AUTH_OPTIONS, DEFAULT_DB_OPTIONS, DEFAULT_GLOBAL_OPTIONS, DEFAULT_REALTIME_OPTIONS, } from './lib/constants';\nimport { fetchWithAuth } from './lib/fetch';\nimport { applySettingDefaults, validateSupabaseUrl } from './lib/helpers';\nimport { SupabaseAuthClient } from './lib/SupabaseAuthClient';\n/**\n * Supabase Client.\n *\n * An isomorphic Javascript client for interacting with Postgres.\n */\nexport default class SupabaseClient {\n    /**\n     * Create a new client for use in the browser.\n     * @param supabaseUrl The unique Supabase URL which is supplied when you create a new project in your project dashboard.\n     * @param supabaseKey The unique Supabase Key which is supplied when you create a new project in your project dashboard.\n     * @param options.db.schema You can switch in between schemas. The schema needs to be on the list of exposed schemas inside Supabase.\n     * @param options.auth.autoRefreshToken Set to \"true\" if you want to automatically refresh the token before expiring.\n     * @param options.auth.persistSession Set to \"true\" if you want to automatically save the user session into local storage.\n     * @param options.auth.detectSessionInUrl Set to \"true\" if you want to automatically detects OAuth grants in the URL and signs in the user.\n     * @param options.realtime Options passed along to realtime-js constructor.\n     * @param options.storage Options passed along to the storage-js constructor.\n     * @param options.global.fetch A custom fetch implementation.\n     * @param options.global.headers Any additional headers to send with each network request.\n     */\n    constructor(supabaseUrl, supabaseKey, options) {\n        var _a, _b, _c;\n        this.supabaseUrl = supabaseUrl;\n        this.supabaseKey = supabaseKey;\n        const baseUrl = validateSupabaseUrl(supabaseUrl);\n        if (!supabaseKey)\n            throw new Error('supabaseKey is required.');\n        this.realtimeUrl = new URL('realtime/v1', baseUrl);\n        this.realtimeUrl.protocol = this.realtimeUrl.protocol.replace('http', 'ws');\n        this.authUrl = new URL('auth/v1', baseUrl);\n        this.storageUrl = new URL('storage/v1', baseUrl);\n        this.functionsUrl = new URL('functions/v1', baseUrl);\n        // default storage key uses the supabase project ref as a namespace\n        const defaultStorageKey = `sb-${baseUrl.hostname.split('.')[0]}-auth-token`;\n        const DEFAULTS = {\n            db: DEFAULT_DB_OPTIONS,\n            realtime: DEFAULT_REALTIME_OPTIONS,\n            auth: Object.assign(Object.assign({}, DEFAULT_AUTH_OPTIONS), { storageKey: defaultStorageKey }),\n            global: DEFAULT_GLOBAL_OPTIONS,\n        };\n        const settings = applySettingDefaults(options !== null && options !== void 0 ? options : {}, DEFAULTS);\n        this.storageKey = (_a = settings.auth.storageKey) !== null && _a !== void 0 ? _a : '';\n        this.headers = (_b = settings.global.headers) !== null && _b !== void 0 ? _b : {};\n        if (!settings.accessToken) {\n            this.auth = this._initSupabaseAuthClient((_c = settings.auth) !== null && _c !== void 0 ? _c : {}, this.headers, settings.global.fetch);\n        }\n        else {\n            this.accessToken = settings.accessToken;\n            this.auth = new Proxy({}, {\n                get: (_, prop) => {\n                    throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(prop)} is not possible`);\n                },\n            });\n        }\n        this.fetch = fetchWithAuth(supabaseKey, this._getAccessToken.bind(this), settings.global.fetch);\n        this.realtime = this._initRealtimeClient(Object.assign({ headers: this.headers, accessToken: this._getAccessToken.bind(this) }, settings.realtime));\n        this.rest = new PostgrestClient(new URL('rest/v1', baseUrl).href, {\n            headers: this.headers,\n            schema: settings.db.schema,\n            fetch: this.fetch,\n        });\n        this.storage = new SupabaseStorageClient(this.storageUrl.href, this.headers, this.fetch, options === null || options === void 0 ? void 0 : options.storage);\n        if (!settings.accessToken) {\n            this._listenForAuthEvents();\n        }\n    }\n    /**\n     * Supabase Functions allows you to deploy and invoke edge functions.\n     */\n    get functions() {\n        return new FunctionsClient(this.functionsUrl.href, {\n            headers: this.headers,\n            customFetch: this.fetch,\n        });\n    }\n    /**\n     * Perform a query on a table or a view.\n     *\n     * @param relation - The table or view name to query\n     */\n    from(relation) {\n        return this.rest.from(relation);\n    }\n    // NOTE: signatures must be kept in sync with PostgrestClient.schema\n    /**\n     * Select a schema to query or perform an function (rpc) call.\n     *\n     * The schema needs to be on the list of exposed schemas inside Supabase.\n     *\n     * @param schema - The schema to query\n     */\n    schema(schema) {\n        return this.rest.schema(schema);\n    }\n    // NOTE: signatures must be kept in sync with PostgrestClient.rpc\n    /**\n     * Perform a function call.\n     *\n     * @param fn - The function name to call\n     * @param args - The arguments to pass to the function call\n     * @param options - Named parameters\n     * @param options.head - When set to `true`, `data` will not be returned.\n     * Useful if you only need the count.\n     * @param options.get - When set to `true`, the function will be called with\n     * read-only access mode.\n     * @param options.count - Count algorithm to use to count rows returned by the\n     * function. Only applicable for [set-returning\n     * functions](https://www.postgresql.org/docs/current/functions-srf.html).\n     *\n     * `\"exact\"`: Exact but slow count algorithm. Performs a `COUNT(*)` under the\n     * hood.\n     *\n     * `\"planned\"`: Approximated but fast count algorithm. Uses the Postgres\n     * statistics under the hood.\n     *\n     * `\"estimated\"`: Uses exact count for low numbers and planned count for high\n     * numbers.\n     */\n    rpc(fn, args = {}, options = {\n        head: false,\n        get: false,\n        count: undefined,\n    }) {\n        return this.rest.rpc(fn, args, options);\n    }\n    /**\n     * Creates a Realtime channel with Broadcast, Presence, and Postgres Changes.\n     *\n     * @param {string} name - The name of the Realtime channel.\n     * @param {Object} opts - The options to pass to the Realtime channel.\n     *\n     */\n    channel(name, opts = { config: {} }) {\n        return this.realtime.channel(name, opts);\n    }\n    /**\n     * Returns all Realtime channels.\n     */\n    getChannels() {\n        return this.realtime.getChannels();\n    }\n    /**\n     * Unsubscribes and removes Realtime channel from Realtime client.\n     *\n     * @param {RealtimeChannel} channel - The name of the Realtime channel.\n     *\n     */\n    removeChannel(channel) {\n        return this.realtime.removeChannel(channel);\n    }\n    /**\n     * Unsubscribes and removes all Realtime channels from Realtime client.\n     */\n    removeAllChannels() {\n        return this.realtime.removeAllChannels();\n    }\n    async _getAccessToken() {\n        var _a, _b;\n        if (this.accessToken) {\n            return await this.accessToken();\n        }\n        const { data } = await this.auth.getSession();\n        return (_b = (_a = data.session) === null || _a === void 0 ? void 0 : _a.access_token) !== null && _b !== void 0 ? _b : this.supabaseKey;\n    }\n    _initSupabaseAuthClient({ autoRefreshToken, persistSession, detectSessionInUrl, storage, userStorage, storageKey, flowType, lock, debug, throwOnError, }, headers, fetch) {\n        const authHeaders = {\n            Authorization: `Bearer ${this.supabaseKey}`,\n            apikey: `${this.supabaseKey}`,\n        };\n        return new SupabaseAuthClient({\n            url: this.authUrl.href,\n            headers: Object.assign(Object.assign({}, authHeaders), headers),\n            storageKey: storageKey,\n            autoRefreshToken,\n            persistSession,\n            detectSessionInUrl,\n            storage,\n            userStorage,\n            flowType,\n            lock,\n            debug,\n            throwOnError,\n            fetch,\n            // auth checks if there is a custom authorizaiton header using this flag\n            // so it knows whether to return an error when getUser is called with no session\n            hasCustomAuthorizationHeader: Object.keys(this.headers).some((key) => key.toLowerCase() === 'authorization'),\n        });\n    }\n    _initRealtimeClient(options) {\n        return new RealtimeClient(this.realtimeUrl.href, Object.assign(Object.assign({}, options), { params: Object.assign({ apikey: this.supabaseKey }, options === null || options === void 0 ? void 0 : options.params) }));\n    }\n    _listenForAuthEvents() {\n        const data = this.auth.onAuthStateChange((event, session) => {\n            this._handleTokenChanged(event, 'CLIENT', session === null || session === void 0 ? void 0 : session.access_token);\n        });\n        return data;\n    }\n    _handleTokenChanged(event, source, token) {\n        if ((event === 'TOKEN_REFRESHED' || event === 'SIGNED_IN') &&\n            this.changedAccessToken !== token) {\n            this.changedAccessToken = token;\n            this.realtime.setAuth(token);\n        }\n        else if (event === 'SIGNED_OUT') {\n            this.realtime.setAuth();\n            if (source == 'STORAGE')\n                this.auth.signOut();\n            this.changedAccessToken = undefined;\n        }\n    }\n}\n//# sourceMappingURL=SupabaseClient.js.map","import SupabaseClient from './SupabaseClient';\nexport * from '@supabase/auth-js';\nexport { PostgrestError, } from '@supabase/postgrest-js';\nexport { FunctionsHttpError, FunctionsFetchError, FunctionsRelayError, FunctionsError, FunctionRegion, } from '@supabase/functions-js';\nexport * from '@supabase/realtime-js';\nexport { default as SupabaseClient } from './SupabaseClient';\n/**\n * Creates a new Supabase Client.\n */\nexport const createClient = (supabaseUrl, supabaseKey, options) => {\n    return new SupabaseClient(supabaseUrl, supabaseKey, options);\n};\n// Check for Node.js <= 18 deprecation\nfunction shouldShowDeprecationWarning() {\n    // Skip in browser environments\n    if (typeof window !== 'undefined') {\n        return false;\n    }\n    // Skip if process is not available (e.g., Edge Runtime)\n    if (typeof process === 'undefined') {\n        return false;\n    }\n    // Use dynamic property access to avoid Next.js Edge Runtime static analysis warnings\n    const processVersion = process['version'];\n    if (processVersion === undefined || processVersion === null) {\n        return false;\n    }\n    const versionMatch = processVersion.match(/^v(\\d+)\\./);\n    if (!versionMatch) {\n        return false;\n    }\n    const majorVersion = parseInt(versionMatch[1], 10);\n    return majorVersion <= 18;\n}\nif (shouldShowDeprecationWarning()) {\n    console.warn(`  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. ` +\n        `Please upgrade to Node.js 20 or later. ` +\n        `For more information, visit: https://github.com/orgs/supabase/discussions/37217`);\n}\n//# sourceMappingURL=index.js.map","import { createClient } from '@supabase/supabase-js';\nconst supabaseUrl = import.meta.env.VITE_SUPABASE_URL;\nconst supabaseAnonKey = import.meta.env.VITE_SUPABASE_ANON_KEY;\nif (!supabaseUrl || !supabaseAnonKey) {\n    console.warn('[Supabase]    . .env.local  .');\n}\nexport const SUPABASE_URL = supabaseUrl ?? '';\nexport const SUPABASE_ANON_KEY = supabaseAnonKey ?? '';\nconst SUPABASE_CLIENT_KEY = '__gals_supabase_client__';\nconst globalScope = globalThis;\nif (!globalScope[SUPABASE_CLIENT_KEY]) {\n    globalScope[SUPABASE_CLIENT_KEY] = createClient(SUPABASE_URL, SUPABASE_ANON_KEY, {\n        auth: {\n            storageKey: 'supabase.auth.gals',\n            persistSession: true,\n            autoRefreshToken: true,\n            detectSessionInUrl: true\n        }\n    });\n}\nexport const supabase = globalScope[SUPABASE_CLIENT_KEY];\n","export const campaignStageData = [\n    {\n        id: 1, name: '', theme: 'Neutral', recommendedPower: 100,\n        firstReward: { gold: 200, shards: 2 }, repeatReward: { gold: 100, shards: 1 }, cleared: false,\n        story: {\n            description: '        .  Lucian    .',\n            backgroundImage: 'backgrounds/stage_01_training_1.png'\n        },\n        characterImage: 'characters/seraphina_belmont.png', //  \n        enemyImage: 'characters/lucian_rosegarden.png', //  \n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Lucian',\n                    text: ' ,       .',\n                    emotion: 'normal',\n                    characterImage: 'characters/lucian_rosegarden'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '        .',\n                    emotion: 'normal',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Lucian',\n                    text: '      .   ,        .',\n                    emotion: 'normal',\n                    characterImage: 'characters/lucian_rosegarden'\n                },\n                {\n                    speaker: 'Lucian',\n                    text: ', ,    .       .',\n                    emotion: 'normal',\n                    characterImage: 'characters/lucian_rosegarden'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '  .          .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Lucian',\n                    text: '     .       .',\n                    emotion: 'happy',\n                    characterImage: 'characters/lucian_rosegarden'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '        .   .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Lucian',\n                    text: '.      .     .',\n                    emotion: 'normal',\n                    characterImage: 'characters/lucian_rosegarden'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '.    ,       .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Lucian',\n                    text: '  .  ?',\n                    emotion: 'happy',\n                    characterImage: 'characters/lucian_rosegarden'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Lucian',\n                    text: ' .     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/lucian_rosegarden'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '  ,      .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Lucian',\n                    text: '     .     .',\n                    emotion: 'normal',\n                    characterImage: 'characters/lucian_rosegarden'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '     .      .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Lucian',\n                    text: '.      .',\n                    emotion: 'happy',\n                    characterImage: 'characters/lucian_rosegarden'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Lucian',\n                    text: '    .       .',\n                    emotion: 'normal',\n                    characterImage: 'characters/lucian_rosegarden'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '     .     .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Lucian',\n                    text: '    .        .',\n                    emotion: 'normal',\n                    characterImage: 'characters/lucian_rosegarden'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '.          .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Lucian',\n                    text: '    .     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/lucian_rosegarden'\n                }\n            ]\n        }\n    },\n    {\n        id: 2, name: ' ', theme: 'Fire', recommendedPower: 120,\n        firstReward: { gold: 0, shards: 2 }, repeatReward: { gold: 0, shards: 2 }, cleared: false,\n        story: {\n            description: '  . \"     ...     !\"     .',\n            backgroundImage: 'backgrounds/stage_02_fire_1.png'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/ariana_drake.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Ariana',\n                    text: ' ?            .',\n                    emotion: 'angry',\n                    characterImage: 'characters/ariana_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '.     .  ?',\n                    emotion: 'normal',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Ariana',\n                    text: '.        ?    .',\n                    emotion: 'angry',\n                    characterImage: 'characters/ariana_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '      .       .',\n                    emotion: 'angry',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Ariana',\n                    text: '.     .       !',\n                    emotion: 'angry',\n                    characterImage: 'characters/ariana_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '          .      .',\n                    emotion: 'normal',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Ariana',\n                    text: ' .        !',\n                    emotion: 'angry',\n                    characterImage: 'characters/ariana_drake'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Ariana',\n                    text: ' ...   .',\n                    emotion: 'sad',\n                    characterImage: 'characters/ariana_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '   .     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Ariana',\n                    text: '...      .     .',\n                    emotion: 'angry',\n                    characterImage: 'characters/ariana_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: ' .          .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Ariana',\n                    text: ' ,  .           .',\n                    emotion: 'angry',\n                    characterImage: 'characters/ariana_drake'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Ariana',\n                    text: ',      .        .',\n                    emotion: 'happy',\n                    characterImage: 'characters/ariana_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '   ...   .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Ariana',\n                    text: '     .     .',\n                    emotion: 'angry',\n                    characterImage: 'characters/ariana_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: ' .      .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ]\n        }\n    },\n    {\n        id: 3, name: ' ', theme: 'Ice', recommendedPower: 140,\n        firstReward: { gold: 250, shards: 3 }, repeatReward: { gold: 120, shards: 2 }, cleared: false,\n        story: {\n            description: '   Seraphine Winters .      .   .',\n            backgroundImage: 'backgrounds/stage_03_ice_1.png'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/seraphine_winters.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Seraphine Winters',\n                    text: '    .  Seraphine Winters,   .',\n                    emotion: 'normal',\n                    characterImage: 'characters/elena_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: ' Seraphine ,    .',\n                    emotion: 'surprised',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Seraphine Winters',\n                    text: '    .      .',\n                    emotion: 'normal',\n                    characterImage: 'characters/elena_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '    .    .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Seraphine Winters',\n                    text: '.        .   .',\n                    emotion: 'normal',\n                    characterImage: 'characters/elena_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '    .      .',\n                    emotion: 'normal',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Seraphine Winters',\n                    text: '  .      .  .',\n                    emotion: 'happy',\n                    characterImage: 'characters/elena_drake'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Seraphine Winters',\n                    text: '.      .',\n                    emotion: 'happy',\n                    characterImage: 'characters/elena_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '.         .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Seraphine Winters',\n                    text: '    ,    .    .',\n                    emotion: 'normal',\n                    characterImage: 'characters/elena_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '.     .    .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Seraphine Winters',\n                    text: '  .      .',\n                    emotion: 'normal',\n                    characterImage: 'characters/elena_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '     .   .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Seraphine Winters',\n                    text: '      .     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/elena_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: ' .       .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ]\n        }\n    },\n    {\n        id: 4, name: ' ', theme: 'Lightning', recommendedPower: 160,\n        firstReward: { gold: 0, shards: 2 }, repeatReward: { gold: 0, shards: 2 }, cleared: false,\n        story: {\n            description: '    Leon Ardenia. \"   ? .    .\"       .',\n            backgroundImage: 'backgrounds/stage_04_lightning_1.png'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/leon_ardenia.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Leon Ardenia',\n                    text: '   ...    .',\n                    emotion: 'normal',\n                    characterImage: 'characters/leon_ardenia'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '  Leon Ardenia ,   .      .',\n                    emotion: 'normal',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Leon Ardenia',\n                    text: '       .      .',\n                    emotion: 'normal',\n                    characterImage: 'characters/leon_ardenia'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '   ,    .   .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Leon Ardenia',\n                    text: '.    .         .',\n                    emotion: 'normal',\n                    characterImage: 'characters/leon_ardenia'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: ' ,  ...   .',\n                    emotion: 'normal',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Leon Ardenia',\n                    text: '    .     .',\n                    emotion: 'angry',\n                    characterImage: 'characters/leon_ardenia'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Leon Ardenia',\n                    text: '....       .',\n                    emotion: 'surprised',\n                    characterImage: 'characters/leon_ardenia'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '  ,     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Leon Ardenia',\n                    text: '    .         .',\n                    emotion: 'happy',\n                    characterImage: 'characters/leon_ardenia'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: ' .     .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Leon Ardenia',\n                    text: '.       .',\n                    emotion: 'normal',\n                    characterImage: 'characters/leon_ardenia'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '      ...  .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Leon Ardenia',\n                    text: '    . \", , .\"     .',\n                    emotion: 'normal',\n                    characterImage: 'characters/leon_ardenia'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '   .      .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ]\n        }\n    },\n    {\n        id: 5, name: ' ', theme: 'Wind', recommendedPower: 180,\n        firstReward: { gold: 300, shards: 3 }, repeatReward: { gold: 150, shards: 2 }, cleared: false,\n        story: {\n            description: '     .    Iris   .       .',\n            backgroundImage: 'backgrounds/stage_05_wind_1.png'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/iris_belmont.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Iris Belmont',\n                    text: '!    ?     !',\n                    emotion: 'happy',\n                    characterImage: 'characters/iris_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: 'Iris,  .       .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Iris Belmont',\n                    text: '      .       !',\n                    emotion: 'normal',\n                    characterImage: 'characters/iris_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '.  ,    .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Iris Belmont',\n                    text: '     .       !',\n                    emotion: 'happy',\n                    characterImage: 'characters/iris_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '      ? .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Iris Belmont',\n                    text: '!   !     !',\n                    emotion: 'angry',\n                    characterImage: 'characters/iris_belmont'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Iris Belmont',\n                    text: '...  !     !',\n                    emotion: 'happy',\n                    characterImage: 'characters/iris_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '    .       .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Iris Belmont',\n                    text: '    !     !',\n                    emotion: 'happy',\n                    characterImage: 'characters/iris_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '.           .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Iris Belmont',\n                    text: '?    ?   .',\n                    emotion: 'surprised',\n                    characterImage: 'characters/iris_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '     .   .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Iris Belmont',\n                    text: '    !     !',\n                    emotion: 'happy',\n                    characterImage: 'characters/iris_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: ', Iris.        .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ]\n        }\n    },\n    {\n        id: 6, name: ' ', theme: 'FireIce', recommendedPower: 210,\n        firstReward: { gold: 320, shards: 3 }, repeatReward: { gold: 160, shards: 2 }, cleared: false,\n        story: {\n            description: '  Ariana   Seraphine     .  ,         .',\n            backgroundImage: 'backgrounds/stage_06_fire_ice_1.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/ariana_drake.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Ariana',\n                    text: '     .   ,  Seraphine .',\n                    emotion: 'happy',\n                    characterImage: 'characters/ariana_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '  ,   ...      .',\n                    emotion: 'surprised',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Seraphine Winters',\n                    text: '   .           .',\n                    emotion: 'normal',\n                    characterImage: 'characters/seraphine_winters'\n                },\n                {\n                    speaker: 'Ariana',\n                    text: '   .    .      .',\n                    emotion: 'angry',\n                    characterImage: 'characters/ariana_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '    .        .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Seraphine Winters',\n                    text: '   .  ,         .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphine_winters'\n                },\n                {\n                    speaker: 'Ariana',\n                    text: ',    ?     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/ariana_drake'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Ariana',\n                    text: '   .        .',\n                    emotion: 'happy',\n                    characterImage: 'characters/ariana_drake'\n                },\n                {\n                    speaker: 'Seraphine Winters',\n                    text: '      .      .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphine_winters'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '      .    .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Ariana',\n                    text: '        .     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/ariana_drake'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Ariana',\n                    text: '    .    .',\n                    emotion: 'angry',\n                    characterImage: 'characters/ariana_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '    .       .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Seraphine Winters',\n                    text: '      .     .',\n                    emotion: 'normal',\n                    characterImage: 'characters/seraphine_winters'\n                },\n                {\n                    speaker: 'Ariana',\n                    text: ' .     .     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/ariana_drake'\n                }\n            ]\n        }\n    },\n    {\n        id: 7, name: ' ', theme: 'Storm', recommendedPower: 240,\n        firstReward: { gold: 330, shards: 3 }, repeatReward: { gold: 170, shards: 2 }, cleared: false,\n        story: {\n            description: '    .         .',\n            backgroundImage: 'backgrounds/stage_07_storm_1.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/garen_stone.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Garen Stone',\n                    text: ' .     ?',\n                    emotion: 'normal',\n                    characterImage: 'characters/garen_stone'\n                },\n                {\n                    speaker: 'Iris Belmont',\n                    text: ',     !   !',\n                    emotion: 'happy',\n                    characterImage: 'characters/iris_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '  .        ?',\n                    emotion: 'surprised',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Garen Stone',\n                    text: '  .   ,      .',\n                    emotion: 'angry',\n                    characterImage: 'characters/garen_stone'\n                },\n                {\n                    speaker: 'Iris Belmont',\n                    text: '    .         !',\n                    emotion: 'happy',\n                    characterImage: 'characters/iris_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '   .    .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Garen Stone',\n                    text: '    .     .',\n                    emotion: 'surprised',\n                    characterImage: 'characters/garen_stone'\n                },\n                {\n                    speaker: 'Iris Belmont',\n                    text: ',  !      !',\n                    emotion: 'happy',\n                    characterImage: 'characters/iris_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '     .      .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Garen Stone',\n                    text: '.       .',\n                    emotion: 'normal',\n                    characterImage: 'characters/garen_stone'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Garen Stone',\n                    text: '     .     .',\n                    emotion: 'angry',\n                    characterImage: 'characters/garen_stone'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: ' .     .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Iris Belmont',\n                    text: ' !      !',\n                    emotion: 'happy',\n                    characterImage: 'characters/iris_belmont'\n                },\n                {\n                    speaker: 'Garen Stone',\n                    text: ' ,   .    .',\n                    emotion: 'normal',\n                    characterImage: 'characters/garen_stone'\n                }\n            ]\n        }\n    },\n    {\n        id: 8, name: ' ', theme: 'Elite', recommendedPower: 280,\n        firstReward: { gold: 340, shards: 3 }, repeatReward: { gold: 170, shards: 2 }, cleared: false,\n        story: {\n            description: '      . , ,     .',\n            backgroundImage: 'backgrounds/stage_08_elite_1.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/marcus_belmont.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Marcus Belmont',\n                    text: '      .     .',\n                    emotion: 'angry',\n                    characterImage: 'characters/marcus_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: 'Marcus ,         .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Lucian',\n                    text: '    ,     .    .',\n                    emotion: 'normal',\n                    characterImage: 'characters/lucian_rosegarden'\n                },\n                {\n                    speaker: 'Marcus Belmont',\n                    text: '   ,     .        .',\n                    emotion: 'normal',\n                    characterImage: 'characters/marcus_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '    .    .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Marcus Belmont',\n                    text: '.     .',\n                    emotion: 'normal',\n                    characterImage: 'characters/marcus_belmont'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Marcus Belmont',\n                    text: '  .      .',\n                    emotion: 'surprised',\n                    characterImage: 'characters/marcus_belmont'\n                },\n                {\n                    speaker: 'Lucian',\n                    text: '  \"       \" .',\n                    emotion: 'happy',\n                    characterImage: 'characters/lucian_rosegarden'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '     .    .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Marcus Belmont',\n                    text: '   .   .',\n                    emotion: 'normal',\n                    characterImage: 'characters/marcus_belmont'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Marcus Belmont',\n                    text: ' .     .',\n                    emotion: 'angry',\n                    characterImage: 'characters/marcus_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '      ...  .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Lucian',\n                    text: '    .    .',\n                    emotion: 'normal',\n                    characterImage: 'characters/lucian_rosegarden'\n                },\n                {\n                    speaker: 'Marcus Belmont',\n                    text: '  .       .',\n                    emotion: 'normal',\n                    characterImage: 'characters/marcus_belmont'\n                }\n            ]\n        }\n    },\n    {\n        id: 9, name: ' ', theme: 'Shadow Corridor', recommendedPower: 320,\n        firstReward: { gold: 360, shards: 4 }, repeatReward: { gold: 180, shards: 2 }, cleared: false,\n        story: {\n            description: '     .         .',\n            backgroundImage: 'backgrounds/stage_09_corridor_1.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/darius_blackwood.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Darius Blackwood',\n                    text: '       .    ?',\n                    emotion: 'normal',\n                    characterImage: 'characters/darius_blackwood'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '  ...    .   .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Darius Blackwood',\n                    text: '   .       .',\n                    emotion: 'normal',\n                    characterImage: 'characters/darius_blackwood'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '  \"\" .        .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Darius Blackwood',\n                    text: '.     ,   .',\n                    emotion: 'angry',\n                    characterImage: 'characters/darius_blackwood'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Darius Blackwood',\n                    text: '   .    .',\n                    emotion: 'surprised',\n                    characterImage: 'characters/darius_blackwood'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '   .      .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Darius Blackwood',\n                    text: ',   .       .',\n                    emotion: 'normal',\n                    characterImage: 'characters/darius_blackwood'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Darius Blackwood',\n                    text: '  .    .',\n                    emotion: 'normal',\n                    characterImage: 'characters/darius_blackwood'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '...   .      .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Darius Blackwood',\n                    text: ' ,   \"\" .    .',\n                    emotion: 'normal',\n                    characterImage: 'characters/darius_blackwood'\n                },\n                {\n                    speaker: 'Darius Blackwood',\n                    text: ' .     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/darius_blackwood'\n                }\n            ]\n        }\n    },\n    {\n        id: 10, name: ' ', theme: 'Estate', recommendedPower: 200,\n        firstReward: { gold: 380, shards: 4 }, repeatReward: { gold: 190, shards: 2 }, cleared: false,\n        story: {\n            description: '     .        .',\n            backgroundImage: 'backgrounds/stage_10_final_boss_1.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/elena_drake.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Elena Drake',\n                    text: ',     .     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/elena_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: ' ,    .         .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Kai Drake',\n                    text: '    .    .',\n                    emotion: 'happy',\n                    characterImage: 'characters/kai_drake'\n                },\n                {\n                    speaker: 'Elena Drake',\n                    text: '   ,     .     .',\n                    emotion: 'angry',\n                    characterImage: 'characters/elena_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '.       .       .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Kai Drake',\n                    text: '    .   .',\n                    emotion: 'happy',\n                    characterImage: 'characters/kai_drake'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Elena Drake',\n                    text: '  .     .',\n                    emotion: 'surprised',\n                    characterImage: 'characters/elena_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '     .   \" \" .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Kai Drake',\n                    text: '    .      .',\n                    emotion: 'happy',\n                    characterImage: 'characters/kai_drake'\n                },\n                {\n                    speaker: 'Elena Drake',\n                    text: '     .        .',\n                    emotion: 'happy',\n                    characterImage: 'characters/elena_drake'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Elena Drake',\n                    text: '  .     .',\n                    emotion: 'normal',\n                    characterImage: 'characters/elena_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '    .      .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Kai Drake',\n                    text: ' .         .',\n                    emotion: 'happy',\n                    characterImage: 'characters/kai_drake'\n                },\n                {\n                    speaker: 'Elena Drake',\n                    text: '      .    .',\n                    emotion: 'happy',\n                    characterImage: 'characters/elena_drake'\n                }\n            ]\n        }\n    },\n    {\n        id: 11, name: ' ', theme: 'Lucian2', recommendedPower: 220,\n        firstReward: { gold: 400, shards: 4 }, repeatReward: { gold: 200, shards: 2 }, cleared: false,\n        story: {\n            description: '     .     Lucian     .',\n            backgroundImage: 'backgrounds/stage_11_training_advanced.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/lucian_rosegarden.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Lucian',\n                    text: ',       .      .',\n                    emotion: 'normal',\n                    characterImage: 'characters/lucian_rosegarden'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '    .    .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Lucian',\n                    text: '    ,      .   .',\n                    emotion: 'normal',\n                    characterImage: 'characters/lucian_rosegarden'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '.      .    .',\n                    emotion: 'normal',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Lucian',\n                    text: '.          .  .',\n                    emotion: 'angry',\n                    characterImage: 'characters/lucian_rosegarden'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: ' .          .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Lucian',\n                    text: '!     ...      .',\n                    emotion: 'happy',\n                    characterImage: 'characters/lucian_rosegarden'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '     .    .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Lucian',\n                    text: '      .     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/lucian_rosegarden'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '    .    .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Lucian',\n                    text: '   .      .',\n                    emotion: 'normal',\n                    characterImage: 'characters/lucian_rosegarden'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '...     .  .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Lucian',\n                    text: '   .         .',\n                    emotion: 'happy',\n                    characterImage: 'characters/lucian_rosegarden'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: ' .     .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ]\n        }\n    },\n    {\n        id: 12, name: ' ', theme: 'Fire2', recommendedPower: 240,\n        firstReward: { gold: 450, shards: 4 }, repeatReward: { gold: 220, shards: 2 }, cleared: false,\n        story: {\n            description: '      .     .',\n            backgroundImage: 'backgrounds/stage_12_fire_master.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/ariana_drake.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Ariana',\n                    text: 'Stage 11  ,  .       .',\n                    emotion: 'happy',\n                    characterImage: 'characters/ariana_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: 'Lucian      .   .',\n                    emotion: 'normal',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Ariana',\n                    text: '   .    .    .',\n                    emotion: 'normal',\n                    characterImage: 'characters/ariana_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: ' .      .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Ariana',\n                    text: '.       .      .',\n                    emotion: 'normal',\n                    characterImage: 'characters/ariana_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '.     .',\n                    emotion: 'angry',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Ariana',\n                    text: '.  ,      .',\n                    emotion: 'happy',\n                    characterImage: 'characters/ariana_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '     .      .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Ariana',\n                    text: '     .    .',\n                    emotion: 'normal',\n                    characterImage: 'characters/ariana_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '.     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Ariana',\n                    text: '  .    ?',\n                    emotion: 'normal',\n                    characterImage: 'characters/ariana_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '...    .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Ariana',\n                    text: '.         .',\n                    emotion: 'happy',\n                    characterImage: 'characters/ariana_drake'\n                }\n            ]\n        }\n    },\n    {\n        id: 13, name: ' ', theme: 'Ice2', recommendedPower: 260,\n        firstReward: { gold: 500, shards: 5 }, repeatReward: { gold: 250, shards: 3 }, cleared: false,\n        story: {\n            description: '    .     .',\n            backgroundImage: 'backgrounds/stage_13_ice_master.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/seraphine_winters.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Seraphine Winters',\n                    text: '       .   .',\n                    emotion: 'normal',\n                    characterImage: 'characters/seraphine_winters'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: 'Ariana   .    .',\n                    emotion: 'normal',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Seraphine Winters',\n                    text: ' .   ,   .   .',\n                    emotion: 'normal',\n                    characterImage: 'characters/seraphine_winters'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: 'Lucian   .      .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Seraphine Winters',\n                    text: '.           .',\n                    emotion: 'normal',\n                    characterImage: 'characters/seraphine_winters'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '    .',\n                    emotion: 'angry',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Seraphine Winters',\n                    text: '.     .',\n                    emotion: 'surprised',\n                    characterImage: 'characters/seraphine_winters'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '     .       .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Seraphine Winters',\n                    text: '   .       .',\n                    emotion: 'normal',\n                    characterImage: 'characters/seraphine_winters'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '   .',\n                    emotion: 'normal',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Seraphine Winters',\n                    text: '.     .',\n                    emotion: 'normal',\n                    characterImage: 'characters/seraphine_winters'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '   ...   .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Seraphine Winters',\n                    text: ' ,   .   .',\n                    emotion: 'normal',\n                    characterImage: 'characters/seraphine_winters'\n                }\n            ]\n        }\n    },\n    {\n        id: 14, name: ' ', theme: 'Lightning2', recommendedPower: 280,\n        firstReward: { gold: 550, shards: 5 }, repeatReward: { gold: 280, shards: 3 }, cleared: false,\n        story: {\n            description: '    .      .',\n            backgroundImage: 'backgrounds/stage_14_lightning_master.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/leon_ardenia.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Leon Ardenia',\n                    text: '  .    .   .',\n                    emotion: 'normal',\n                    characterImage: 'characters/leon_ardenia'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: 'Leon ,     .',\n                    emotion: 'normal',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Leon Ardenia',\n                    text: '      .    .',\n                    emotion: 'normal',\n                    characterImage: 'characters/leon_ardenia'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '      .  .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Leon Ardenia',\n                    text: '  .   .',\n                    emotion: 'angry',\n                    characterImage: 'characters/leon_ardenia'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Leon Ardenia',\n                    text: '   .    .',\n                    emotion: 'surprised',\n                    characterImage: 'characters/leon_ardenia'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Leon Ardenia',\n                    text: ' .       .',\n                    emotion: 'normal',\n                    characterImage: 'characters/leon_ardenia'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Leon Ardenia',\n                    text: '.   .',\n                    emotion: 'normal',\n                    characterImage: 'characters/leon_ardenia'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: ' ...   .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Leon Ardenia',\n                    text: ' ,    .       .',\n                    emotion: 'normal',\n                    characterImage: 'characters/leon_ardenia'\n                }\n            ]\n        }\n    },\n    {\n        id: 15, name: ' ', theme: 'Wind2', recommendedPower: 300,\n        firstReward: { gold: 600, shards: 5 }, repeatReward: { gold: 300, shards: 3 }, cleared: false,\n        story: {\n            description: '     .       .',\n            backgroundImage: 'backgrounds/stage_15_wind_master.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/iris_belmont.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Iris Belmont',\n                    text: '!   .       !',\n                    emotion: 'happy',\n                    characterImage: 'characters/iris_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '     .       .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Leon Ardenia',\n                    text: '      .      .',\n                    emotion: 'normal',\n                    characterImage: 'characters/leon_ardenia'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '        .     .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Iris Belmont',\n                    text: ' !       !',\n                    emotion: 'happy',\n                    characterImage: 'characters/iris_belmont'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Iris Belmont',\n                    text: ',     !    !',\n                    emotion: 'happy',\n                    characterImage: 'characters/iris_belmont'\n                },\n                {\n                    speaker: 'Leon Ardenia',\n                    text: '     .     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/leon_ardenia'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '    .   \" \" .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Iris Belmont',\n                    text: ' !      !',\n                    emotion: 'happy',\n                    characterImage: 'characters/iris_belmont'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Iris Belmont',\n                    text: '   ?     ,     .',\n                    emotion: 'normal',\n                    characterImage: 'characters/iris_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '...   .   .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Leon Ardenia',\n                    text: '    .       .',\n                    emotion: 'normal',\n                    characterImage: 'characters/leon_ardenia'\n                },\n                {\n                    speaker: 'Iris Belmont',\n                    text: ' !     !',\n                    emotion: 'happy',\n                    characterImage: 'characters/iris_belmont'\n                }\n            ]\n        }\n    },\n    {\n        id: 16, name: ' ', theme: 'Storm2', recommendedPower: 320,\n        firstReward: { gold: 650, shards: 6 }, repeatReward: { gold: 325, shards: 3 }, cleared: false,\n        story: {\n            description: '      .   .',\n            backgroundImage: 'backgrounds/stage_16_earth_master.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/garen_stone.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Garen Stone',\n                    text: '    .        .',\n                    emotion: 'normal',\n                    characterImage: 'characters/garen_stone'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: 'Garen ,      .',\n                    emotion: 'normal',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Garen Stone',\n                    text: '   .    .      .',\n                    emotion: 'angry',\n                    characterImage: 'characters/garen_stone'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: 'Marcus     .     .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Garen Stone',\n                    text: '     .  .',\n                    emotion: 'surprised',\n                    characterImage: 'characters/garen_stone'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '     .    .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Garen Stone',\n                    text: '       ?',\n                    emotion: 'normal',\n                    characterImage: 'characters/garen_stone'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Garen Stone',\n                    text: ' .  .',\n                    emotion: 'normal',\n                    characterImage: 'characters/garen_stone'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '  ...  .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Garen Stone',\n                    text: '   .    .',\n                    emotion: 'normal',\n                    characterImage: 'characters/garen_stone'\n                }\n            ]\n        }\n    },\n    {\n        id: 17, name: ' ', theme: 'Fire3', recommendedPower: 340,\n        firstReward: { gold: 700, shards: 6 }, repeatReward: { gold: 350, shards: 3 }, cleared: false,\n        story: {\n            description: '     . Ariana      .',\n            backgroundImage: 'backgrounds/stage_17_fire_challenge.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/ariana_drake.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Ariana',\n                    text: '  .     . ?',\n                    emotion: 'normal',\n                    characterImage: 'characters/ariana_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '      .      .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Ariana',\n                    text: '   .  .     .',\n                    emotion: 'angry',\n                    characterImage: 'characters/ariana_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '  .     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Ariana',\n                    text: '.    .      .',\n                    emotion: 'happy',\n                    characterImage: 'characters/ariana_drake'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Ariana',\n                    text: '  .    .',\n                    emotion: 'surprised',\n                    characterImage: 'characters/ariana_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '      .    .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Ariana',\n                    text: ' Mira   .      .',\n                    emotion: 'happy',\n                    characterImage: 'characters/ariana_drake'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Ariana',\n                    text: ' ?     .',\n                    emotion: 'angry',\n                    characterImage: 'characters/ariana_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '...  .    .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Ariana',\n                    text: ' .     .',\n                    emotion: 'normal',\n                    characterImage: 'characters/ariana_drake'\n                }\n            ]\n        }\n    },\n    {\n        id: 18, name: ' ', theme: 'Friendship', recommendedPower: 360,\n        firstReward: { gold: 720, shards: 7 }, repeatReward: { gold: 360, shards: 4 }, cleared: false,\n        story: {\n            description: '  Mira    .    .',\n            backgroundImage: 'backgrounds/stage_18_friendship.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/mira.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Mira',\n                    text: ',    .   .',\n                    emotion: 'happy',\n                    characterImage: 'characters/mira'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: 'Mira,      .      .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Mira',\n                    text: '     .       .',\n                    emotion: 'determined',\n                    characterImage: 'characters/mira'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '   .        .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Mira',\n                    text: ' !    ,  !',\n                    emotion: 'happy',\n                    characterImage: 'characters/mira'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Mira',\n                    text: '  !      ?',\n                    emotion: 'happy',\n                    characterImage: 'characters/mira'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '.    .     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Mira',\n                    text: '   !  !',\n                    emotion: 'happy',\n                    characterImage: 'characters/mira'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Mira',\n                    text: '...    .',\n                    emotion: 'sad',\n                    characterImage: 'characters/mira'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '.      .     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Mira',\n                    text: '!    .    !',\n                    emotion: 'determined',\n                    characterImage: 'characters/mira'\n                }\n            ]\n        }\n    },\n    {\n        id: 19, name: ' ', theme: 'Shadow2', recommendedPower: 380,\n        firstReward: { gold: 800, shards: 8 }, repeatReward: { gold: 400, shards: 4 }, cleared: false,\n        story: {\n            description: '    .    .',\n            backgroundImage: 'backgrounds/stage_19_shadow.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/darius_blackwood.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Darius Blackwood',\n                    text: '  .       ?',\n                    emotion: 'normal',\n                    characterImage: 'characters/darius_blackwood'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '  .   .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Darius Blackwood',\n                    text: '  .     .',\n                    emotion: 'angry',\n                    characterImage: 'characters/darius_blackwood'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '      .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Darius Blackwood',\n                    text: '   .   .',\n                    emotion: 'surprised',\n                    characterImage: 'characters/darius_blackwood'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '  ...    .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Darius Blackwood',\n                    text: '   .  2   .',\n                    emotion: 'normal',\n                    characterImage: 'characters/darius_blackwood'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Darius Blackwood',\n                    text: ' .    .',\n                    emotion: 'normal',\n                    characterImage: 'characters/darius_blackwood'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '...   .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Darius Blackwood',\n                    text: ' ,      .  .',\n                    emotion: 'normal',\n                    characterImage: 'characters/darius_blackwood'\n                }\n            ]\n        }\n    },\n    {\n        id: 20, name: ' 2', theme: 'Elite2', recommendedPower: 400,\n        firstReward: { gold: 900, shards: 9 }, repeatReward: { gold: 450, shards: 5 }, cleared: false,\n        story: {\n            description: '    .     .',\n            backgroundImage: 'backgrounds/stage_20_elite_advanced.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/marcus_belmont.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Marcus Belmont',\n                    text: '    .      .',\n                    emotion: 'angry',\n                    characterImage: 'characters/marcus_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: 'Marcus     .     .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Marcus Belmont',\n                    text: ' ,  .  .     .',\n                    emotion: 'normal',\n                    characterImage: 'characters/marcus_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '     .      .',\n                    emotion: 'normal',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Marcus Belmont',\n                    text: '....       .',\n                    emotion: 'happy',\n                    characterImage: 'characters/marcus_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '.    .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Marcus Belmont',\n                    text: '    .  .',\n                    emotion: 'normal',\n                    characterImage: 'characters/marcus_belmont'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Marcus Belmont',\n                    text: ' .      .',\n                    emotion: 'normal',\n                    characterImage: 'characters/marcus_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '...   .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Marcus Belmont',\n                    text: '   ,    .',\n                    emotion: 'normal',\n                    characterImage: 'characters/marcus_belmont'\n                }\n            ]\n        }\n    },\n    // Chapter 3:   (Stage 21-29) - TODO: Stage 30  \n    {\n        id: 21, name: ' ', theme: 'Fusion', recommendedPower: 420,\n        firstReward: { gold: 950, shards: 9 }, repeatReward: { gold: 475, shards: 5 }, cleared: false,\n        story: {\n            description: '    .      .',\n            backgroundImage: 'backgrounds/stage_21_fusion.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Lucian',\n                    text: ',        .',\n                    emotion: 'normal',\n                    characterImage: 'characters/lucian_rosegarden'\n                },\n                {\n                    speaker: 'Ariana',\n                    text: '     ,     .  .',\n                    emotion: 'normal',\n                    characterImage: 'characters/ariana_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '      .    .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Leon Ardenia',\n                    text: ' .    .',\n                    emotion: 'normal',\n                    characterImage: 'characters/leon_ardenia'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '.        .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Lucian',\n                    text: '!        .',\n                    emotion: 'happy',\n                    characterImage: 'characters/lucian_rosegarden'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '      .     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Ariana',\n                    text: '    .     .',\n                    emotion: 'normal',\n                    characterImage: 'characters/ariana_drake'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Lucian',\n                    text: '   .    .',\n                    emotion: 'normal',\n                    characterImage: 'characters/lucian_rosegarden'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '   ...    ?',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Leon Ardenia',\n                    text: ' . , , ...     .',\n                    emotion: 'normal',\n                    characterImage: 'characters/leon_ardenia'\n                }\n            ]\n        }\n    },\n    {\n        id: 22, name: ' ', theme: 'Kai1', recommendedPower: 450,\n        firstReward: { gold: 1000, shards: 10 }, repeatReward: { gold: 500, shards: 6 }, cleared: false,\n        story: {\n            description: '    Kai    .    .',\n            backgroundImage: 'backgrounds/stage_22_kai.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/kai_drake.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Kai Drake',\n                    text: ',       . ?',\n                    emotion: 'happy',\n                    characterImage: 'characters/kai_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: 'Kai  ?      .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Kai Drake',\n                    text: '         .    .',\n                    emotion: 'normal',\n                    characterImage: 'characters/kai_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '     .       .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Kai Drake',\n                    text: '.    .       .',\n                    emotion: 'happy',\n                    characterImage: 'characters/kai_drake'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Kai Drake',\n                    text: '....     .',\n                    emotion: 'surprised',\n                    characterImage: 'characters/kai_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: 'Kai   .      .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Kai Drake',\n                    text: '      .     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/kai_drake'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Kai Drake',\n                    text: '.       .',\n                    emotion: 'normal',\n                    characterImage: 'characters/kai_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '    .   .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Kai Drake',\n                    text: '   .    .',\n                    emotion: 'happy',\n                    characterImage: 'characters/kai_drake'\n                }\n            ]\n        }\n    },\n    {\n        id: 23, name: ' ', theme: 'Lightning3', recommendedPower: 470,\n        firstReward: { gold: 1050, shards: 10 }, repeatReward: { gold: 525, shards: 6 }, cleared: false,\n        story: {\n            description: '   .     .',\n            backgroundImage: 'backgrounds/stage_23_knights.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/leon_ardenia.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Leon Ardenia',\n                    text: '  .      ?',\n                    emotion: 'angry',\n                    characterImage: 'characters/leon_ardenia'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: ',     .   .',\n                    emotion: 'normal',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Leon Ardenia',\n                    text: ' ,      .   .',\n                    emotion: 'normal',\n                    characterImage: 'characters/leon_ardenia'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '      .  .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Leon Ardenia',\n                    text: '.     .   .',\n                    emotion: 'happy',\n                    characterImage: 'characters/leon_ardenia'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '   .     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Leon Ardenia',\n                    text: '     .     .',\n                    emotion: 'normal',\n                    characterImage: 'characters/leon_ardenia'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Leon Ardenia',\n                    text: ' .    .',\n                    emotion: 'normal',\n                    characterImage: 'characters/leon_ardenia'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '...   .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Leon Ardenia',\n                    text: '   ,    .',\n                    emotion: 'normal',\n                    characterImage: 'characters/leon_ardenia'\n                }\n            ]\n        }\n    },\n    {\n        id: 24, name: ' ', theme: 'Storm3', recommendedPower: 490,\n        firstReward: { gold: 1100, shards: 11 }, repeatReward: { gold: 550, shards: 6 }, cleared: false,\n        story: {\n            description: '      .     .',\n            backgroundImage: 'backgrounds/stage_24_petrification.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/garen_stone.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Garen Stone',\n                    text: '     .    ?',\n                    emotion: 'angry',\n                    characterImage: 'characters/garen_stone'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '  ...       .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Garen Stone',\n                    text: '    .       .',\n                    emotion: 'normal',\n                    characterImage: 'characters/garen_stone'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '   .   .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Garen Stone',\n                    text: '  .     .',\n                    emotion: 'surprised',\n                    characterImage: 'characters/garen_stone'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '  .      .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Garen Stone',\n                    text: '       .   .',\n                    emotion: 'normal',\n                    characterImage: 'characters/garen_stone'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Garen Stone',\n                    text: '.  .',\n                    emotion: 'normal',\n                    characterImage: 'characters/garen_stone'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '   ...   .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Garen Stone',\n                    text: '    .   .',\n                    emotion: 'normal',\n                    characterImage: 'characters/garen_stone'\n                }\n            ]\n        }\n    },\n    {\n        id: 25, name: ' ', theme: 'ShadowMaster', recommendedPower: 510,\n        firstReward: { gold: 1150, shards: 11 }, repeatReward: { gold: 575, shards: 6 }, cleared: false,\n        story: {\n            description: '    . Darius     .',\n            backgroundImage: 'backgrounds/stage_25_shadow_master.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/darius_blackwood.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Darius Blackwood',\n                    text: '  ?       .',\n                    emotion: 'normal',\n                    characterImage: 'characters/darius_blackwood'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: ',   .   .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Darius Blackwood',\n                    text: '.     .    .',\n                    emotion: 'normal',\n                    characterImage: 'characters/darius_blackwood'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '        .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Darius Blackwood',\n                    text: '  .    .',\n                    emotion: 'happy',\n                    characterImage: 'characters/darius_blackwood'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '   .      .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Darius Blackwood',\n                    text: '   .     .',\n                    emotion: 'normal',\n                    characterImage: 'characters/darius_blackwood'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Darius Blackwood',\n                    text: '  .   .',\n                    emotion: 'angry',\n                    characterImage: 'characters/darius_blackwood'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: ' ...    .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ]\n        }\n    },\n    {\n        id: 26, name: ' ', theme: 'Elite3', recommendedPower: 530,\n        firstReward: { gold: 1200, shards: 12 }, repeatReward: { gold: 600, shards: 7 }, cleared: false,\n        story: {\n            description: '     .     .',\n            backgroundImage: 'backgrounds/stage_26_elite_final.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/marcus_belmont.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Marcus Belmont',\n                    text: '    .     ?',\n                    emotion: 'normal',\n                    characterImage: 'characters/marcus_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '     .',\n                    emotion: 'normal',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Marcus Belmont',\n                    text: '.        .',\n                    emotion: 'normal',\n                    characterImage: 'characters/marcus_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '    .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Marcus Belmont',\n                    text: '   .   .',\n                    emotion: 'happy',\n                    characterImage: 'characters/marcus_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '     .   .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Marcus Belmont',\n                    text: '    .     .',\n                    emotion: 'normal',\n                    characterImage: 'characters/marcus_belmont'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Marcus Belmont',\n                    text: '    .     .',\n                    emotion: 'normal',\n                    characterImage: 'characters/marcus_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '   .    .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Marcus Belmont',\n                    text: ' .     .',\n                    emotion: 'normal',\n                    characterImage: 'characters/marcus_belmont'\n                }\n            ]\n        }\n    },\n    {\n        id: 27, name: ' ', theme: 'Sisters', recommendedPower: 550,\n        firstReward: { gold: 1250, shards: 12 }, repeatReward: { gold: 625, shards: 7 }, cleared: false,\n        story: {\n            description: '  Elena Ariana    .   .',\n            backgroundImage: 'backgrounds/stage_27_sisters.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/elena_drake.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Elena Drake',\n                    text: '!    .   ?',\n                    emotion: 'happy',\n                    characterImage: 'characters/elena_drake'\n                },\n                {\n                    speaker: 'Ariana',\n                    text: 'Elena      .       .',\n                    emotion: 'normal',\n                    characterImage: 'characters/ariana_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '      .    .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Elena Drake',\n                    text: '     !       !',\n                    emotion: 'happy',\n                    characterImage: 'characters/elena_drake'\n                },\n                {\n                    speaker: 'Ariana',\n                    text: 'Elena,  .        .',\n                    emotion: 'angry',\n                    characterImage: 'characters/ariana_drake'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Elena Drake',\n                    text: '! ,  !    !',\n                    emotion: 'happy',\n                    characterImage: 'characters/elena_drake'\n                },\n                {\n                    speaker: 'Ariana',\n                    text: '      .     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/ariana_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '.    .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Elena Drake',\n                    text: '?     ?',\n                    emotion: 'surprised',\n                    characterImage: 'characters/elena_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '   ...   .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Ariana',\n                    text: '   .     .',\n                    emotion: 'normal',\n                    characterImage: 'characters/ariana_drake'\n                }\n            ]\n        }\n    },\n    {\n        id: 28, name: ' ', theme: 'Multi', recommendedPower: 570,\n        firstReward: { gold: 1300, shards: 13 }, repeatReward: { gold: 650, shards: 7 }, cleared: false,\n        story: {\n            description: '    .     .',\n            backgroundImage: 'backgrounds/stage_28_multi_tactics.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Lucian',\n                    text: '       .     .',\n                    emotion: 'normal',\n                    characterImage: 'characters/lucian_rosegarden'\n                },\n                {\n                    speaker: 'Marcus Belmont',\n                    text: ' , ,       .  .',\n                    emotion: 'normal',\n                    characterImage: 'characters/marcus_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '    .     .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Kai Drake',\n                    text: '  .      .',\n                    emotion: 'normal',\n                    characterImage: 'characters/kai_drake'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Lucian',\n                    text: '    .  !',\n                    emotion: 'happy',\n                    characterImage: 'characters/lucian_rosegarden'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '      .     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Kai Drake',\n                    text: '   .  .',\n                    emotion: 'normal',\n                    characterImage: 'characters/kai_drake'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Marcus Belmont',\n                    text: ' .      .',\n                    emotion: 'normal',\n                    characterImage: 'characters/marcus_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '...   .   .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Lucian',\n                    text: '  ,     .',\n                    emotion: 'normal',\n                    characterImage: 'characters/lucian_rosegarden'\n                }\n            ]\n        }\n    },\n    {\n        id: 29, name: ' ', theme: 'IrisFinal', recommendedPower: 590,\n        firstReward: { gold: 1400, shards: 14 }, repeatReward: { gold: 700, shards: 8 }, cleared: false,\n        story: {\n            description: '    Iris   .    .',\n            backgroundImage: 'backgrounds/stage_29_wind_final.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/iris_belmont.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Iris Belmont',\n                    text: '!   .    !',\n                    emotion: 'happy',\n                    characterImage: 'characters/iris_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: 'Iris,    .     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Iris Belmont',\n                    text: '    .     ?',\n                    emotion: 'determined',\n                    characterImage: 'characters/iris_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '   .       .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Iris Belmont',\n                    text: ' !          .',\n                    emotion: 'happy',\n                    characterImage: 'characters/iris_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '    .    .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Iris Belmont',\n                    text: '   .   !',\n                    emotion: 'happy',\n                    characterImage: 'characters/iris_belmont'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Iris Belmont',\n                    text: ' !   .   !',\n                    emotion: 'happy',\n                    characterImage: 'characters/iris_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: ', Iris.     .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ]\n        }\n    },\n    {\n        id: 30, name: ' ', theme: 'ElderFinal', recommendedPower: 650,\n        firstReward: { gold: 1500, shards: 15 }, repeatReward: { gold: 750, shards: 9 }, cleared: false,\n        story: {\n            description: '  .  Elder Belmont   .   .',\n            backgroundImage: 'backgrounds/stage_30_final_boss.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/elder_belmont.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Elder Belmont',\n                    text: ',    .    .',\n                    emotion: 'normal',\n                    characterImage: 'characters/elder_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: ',       .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Elder Belmont',\n                    text: '    ,      .    .',\n                    emotion: 'angry',\n                    characterImage: 'characters/elder_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '     .    .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Elder Belmont',\n                    text: '.        .',\n                    emotion: 'happy',\n                    characterImage: 'characters/elder_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '.      .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Elder Belmont',\n                    text: '   .      .',\n                    emotion: 'normal',\n                    characterImage: 'characters/elder_belmont'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Elder Belmont',\n                    text: '   .   .',\n                    emotion: 'normal',\n                    characterImage: 'characters/elder_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: ' .     .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ]\n        }\n    },\n    {\n        id: 31, name: '', theme: 'Wedding', recommendedPower: 680,\n        firstReward: { gold: 1500, shards: 15 }, repeatReward: { gold: 750, shards: 9 }, cleared: false,\n        story: {\n            description: '     .    .',\n            backgroundImage: 'backgrounds/stage_31_wedding.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/ariana_drake.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Ariana',\n                    text: ' !      .      ?',\n                    emotion: 'normal',\n                    characterImage: 'characters/ariana_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '    .   ,     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Ariana',\n                    text: '        . ,     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/ariana_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '    .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Ariana',\n                    text: '!      .   .',\n                    emotion: 'happy',\n                    characterImage: 'characters/ariana_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '.        .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Ariana',\n                    text: '   .      .',\n                    emotion: 'normal',\n                    characterImage: 'characters/ariana_drake'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Ariana',\n                    text: '?  .     .',\n                    emotion: 'surprised',\n                    characterImage: 'characters/ariana_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '     ...  .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Ariana',\n                    text: ' .    .',\n                    emotion: 'happy',\n                    characterImage: 'characters/ariana_drake'\n                }\n            ]\n        }\n    },\n    {\n        id: 32, name: ' ', theme: 'Aldric', recommendedPower: 700,\n        firstReward: { gold: 1600, shards: 16 }, repeatReward: { gold: 800, shards: 9 }, cleared: false,\n        story: {\n            description: '    .    .',\n            backgroundImage: 'backgrounds/stage_32_politics.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Advisor Aldric',\n                    text: ',      .    .',\n                    emotion: 'normal'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '      .   .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Advisor Aldric',\n                    text: '  ,  ,   .      .',\n                    emotion: 'normal'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '   .    .',\n                    emotion: 'normal',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Advisor Aldric',\n                    text: '.      .',\n                    emotion: 'normal'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '      .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Advisor Aldric',\n                    text: '   .   .',\n                    emotion: 'normal'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Advisor Aldric',\n                    text: '   .    .',\n                    emotion: 'normal'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: ' ...    .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Advisor Aldric',\n                    text: '     .   .',\n                    emotion: 'normal'\n                }\n            ]\n        }\n    },\n    {\n        id: 33, name: ' ', theme: 'MiraFinal', recommendedPower: 720,\n        firstReward: { gold: 1700, shards: 17 }, repeatReward: { gold: 850, shards: 9 }, cleared: false,\n        story: {\n            description: '   Mira  .      .',\n            backgroundImage: 'backgrounds/stage_33_mira_final.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/mira.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Mira',\n                    text: ',           .',\n                    emotion: 'happy',\n                    characterImage: 'characters/mira'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '    ...      .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Mira',\n                    text: '    ,      .',\n                    emotion: 'determined',\n                    characterImage: 'characters/mira'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '     .       .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Mira',\n                    text: ',       !',\n                    emotion: 'happy',\n                    characterImage: 'characters/mira'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Mira',\n                    text: ' !        !',\n                    emotion: 'happy',\n                    characterImage: 'characters/mira'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '       .         .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Mira',\n                    text: '   .      !',\n                    emotion: 'happy',\n                    characterImage: 'characters/mira'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Mira',\n                    text: '?        ...',\n                    emotion: 'sad',\n                    characterImage: 'characters/mira'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '.      .     .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Mira',\n                    text: '      .     !',\n                    emotion: 'happy',\n                    characterImage: 'characters/mira'\n                }\n            ]\n        }\n    },\n    {\n        id: 34, name: '', theme: 'Marcus2', recommendedPower: 740,\n        firstReward: { gold: 1800, shards: 18 }, repeatReward: { gold: 900, shards: 10 }, cleared: false,\n        story: {\n            description: '     .    .',\n            backgroundImage: 'backgrounds/stage_34_conflict.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/marcus_belmont.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Marcus Belmont',\n                    text: '       .    .',\n                    emotion: 'normal',\n                    characterImage: 'characters/marcus_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '    .    .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Marcus Belmont',\n                    text: '     .  .',\n                    emotion: 'angry',\n                    characterImage: 'characters/marcus_belmont'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Marcus Belmont',\n                    text: '.    .   .',\n                    emotion: 'happy',\n                    characterImage: 'characters/marcus_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '     .        .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Marcus Belmont',\n                    text: '  .    .',\n                    emotion: 'normal',\n                    characterImage: 'characters/marcus_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '...   .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Marcus Belmont',\n                    text: '  ,    .',\n                    emotion: 'normal',\n                    characterImage: 'characters/marcus_belmont'\n                }\n            ]\n        }\n    },\n    {\n        id: 35, name: ' ', theme: 'Conspiracy', recommendedPower: 760,\n        firstReward: { gold: 1900, shards: 19 }, repeatReward: { gold: 950, shards: 11 }, cleared: false,\n        story: {\n            description: '    .    .',\n            backgroundImage: 'backgrounds/stage_35_conspiracy.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Leon Ardenia',\n                    text: '    .       .',\n                    emotion: 'angry',\n                    characterImage: 'characters/leon_ardenia'\n                },\n                {\n                    speaker: 'Advisor Aldric',\n                    text: '         . ?',\n                    emotion: 'normal'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '  .     .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Leon Ardenia',\n                    text: '.    .',\n                    emotion: 'happy',\n                    characterImage: 'characters/leon_ardenia'\n                },\n                {\n                    speaker: 'Advisor Aldric',\n                    text: '     .     .',\n                    emotion: 'normal'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Leon Ardenia',\n                    text: ' .    .',\n                    emotion: 'normal',\n                    characterImage: 'characters/leon_ardenia'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '    .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Advisor Aldric',\n                    text: '     .  .',\n                    emotion: 'normal'\n                }\n            ]\n        }\n    },\n    {\n        id: 36, name: ' ', theme: 'Thorne', recommendedPower: 780,\n        firstReward: { gold: 2000, shards: 20 }, repeatReward: { gold: 1000, shards: 12 }, cleared: false,\n        story: {\n            description: '      .     .',\n            backgroundImage: 'backgrounds/stage_36_magic_lab.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Archmage Thorne',\n                    text: '       .  .',\n                    emotion: 'normal'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '   .     .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Archmage Thorne',\n                    text: '     .     .',\n                    emotion: 'normal'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Archmage Thorne',\n                    text: '.    .',\n                    emotion: 'normal'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '    .    .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Archmage Thorne',\n                    text: '   .  .',\n                    emotion: 'normal'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: ' .   .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ]\n        }\n    },\n    {\n        id: 37, name: ' ', theme: 'AncientMagic', recommendedPower: 800,\n        firstReward: { gold: 2100, shards: 21 }, repeatReward: { gold: 1050, shards: 12 }, cleared: false,\n        story: {\n            description: '       .      .',\n            backgroundImage: 'backgrounds/stage_37_ancient.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Archmage Thorne',\n                    text: '  .        .',\n                    emotion: 'normal'\n                },\n                {\n                    speaker: 'Seraphine Winters',\n                    text: '      .     .',\n                    emotion: 'normal',\n                    characterImage: 'characters/seraphine_winters'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '      .     .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Archmage Thorne',\n                    text: '    .   .',\n                    emotion: 'normal'\n                },\n                {\n                    speaker: 'Seraphine Winters',\n                    text: '    . , , ...  !',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphine_winters'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Archmage Thorne',\n                    text: '.          .',\n                    emotion: 'happy'\n                },\n                {\n                    speaker: 'Seraphine Winters',\n                    text: '       .     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphine_winters'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '    .         .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Archmage Thorne',\n                    text: ' .   .',\n                    emotion: 'normal'\n                },\n                {\n                    speaker: 'Seraphine',\n                    text: '  ...   .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Seraphine Winters',\n                    text: ',   ?  .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphine_winters'\n                }\n            ]\n        }\n    },\n    {\n        id: 38, name: ' ', theme: 'Ariana4', recommendedPower: 820,\n        firstReward: { gold: 2200, shards: 22 }, repeatReward: { gold: 1100, shards: 13 }, cleared: false,\n        story: {\n            description: ' Ariana    .  .',\n            backgroundImage: 'backgrounds/stage_38_reconciliation.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/ariana_drake.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Ariana',\n                    text: '  .         .',\n                    emotion: 'happy',\n                    characterImage: 'characters/ariana_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '     .    .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Ariana',\n                    text: '!    .',\n                    emotion: 'angry',\n                    characterImage: 'characters/ariana_drake'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Ariana',\n                    text: '.  ,   .',\n                    emotion: 'happy',\n                    characterImage: 'characters/ariana_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '.    .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Ariana',\n                    text: '.     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/ariana_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '  .    .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ]\n        }\n    },\n    {\n        id: 39, name: ' ', theme: 'Kai2', recommendedPower: 840,\n        firstReward: { gold: 2300, shards: 23 }, repeatReward: { gold: 1150, shards: 13 }, cleared: false,\n        story: {\n            description: '    .     .',\n            backgroundImage: 'backgrounds/stage_39_cooperation.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/kai_drake.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Kai Drake',\n                    text: '  ,    .    .',\n                    emotion: 'happy',\n                    characterImage: 'characters/kai_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '    .     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Kai Drake',\n                    text: '        .    .',\n                    emotion: 'normal',\n                    characterImage: 'characters/kai_drake'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Kai Drake',\n                    text: '.      .',\n                    emotion: 'happy',\n                    characterImage: 'characters/kai_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '   .   .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Kai Drake',\n                    text: '.     .',\n                    emotion: 'normal',\n                    characterImage: 'characters/kai_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: ' .     .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ]\n        }\n    },\n    {\n        id: 40, name: ' ', theme: 'Cult', recommendedPower: 860,\n        firstReward: { gold: 2500, shards: 25 }, repeatReward: { gold: 1250, shards: 15 }, cleared: false,\n        story: {\n            description: '    .    .',\n            backgroundImage: 'backgrounds/stage_40_cult.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Dark Cult Leader',\n                    text: '  ,      ...  ?',\n                    emotion: 'normal'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '     .',\n                    emotion: 'angry',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Dark Cult Leader',\n                    text: '    .    ,   .',\n                    emotion: 'angry'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Dark Cult Leader',\n                    text: '...    ...      ...',\n                    emotion: 'sad'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '   .   .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Dark Cult Leader',\n                    text: '    .    ...',\n                    emotion: 'happy'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '  .      .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ]\n        }\n    },\n    // Chapter 5:   (Stage 41-50)\n    {\n        id: 41, name: ' ', theme: 'Invasion', recommendedPower: 880,\n        firstReward: { gold: 2600, shards: 26 }, repeatReward: { gold: 1300, shards: 15 }, cleared: false,\n        story: {\n            description: '   .     .',\n            backgroundImage: 'backgrounds/stage_41_invasion.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Leon Ardenia',\n                    text: '    .    .',\n                    emotion: 'angry',\n                    characterImage: 'characters/leon_ardenia'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '  .    .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Darius Blackwood',\n                    text: '    .    .',\n                    emotion: 'normal',\n                    characterImage: 'characters/darius_blackwood'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Leon Ardenia',\n                    text: ' .    .',\n                    emotion: 'happy',\n                    characterImage: 'characters/leon_ardenia'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '   .     .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Leon Ardenia',\n                    text: ' !  !',\n                    emotion: 'angry',\n                    characterImage: 'characters/leon_ardenia'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '...   .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ]\n        }\n    },\n    {\n        id: 42, name: ' ', theme: 'Garen4', recommendedPower: 920,\n        firstReward: { gold: 2800, shards: 28 }, repeatReward: { gold: 1400, shards: 17 }, cleared: false,\n        story: {\n            description: ' Garen      .     .',\n            backgroundImage: 'backgrounds/stage_42_corrupted_stone.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/garen_stone.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Garen Stone',\n                    text: '......  ... ...',\n                    emotion: 'sad',\n                    characterImage: 'characters/garen_stone'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: 'Garen !  .  !',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Garen Stone',\n                    text: '      ...    ...',\n                    emotion: 'angry',\n                    characterImage: 'characters/garen_stone'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Garen Stone',\n                    text: '......  ...',\n                    emotion: 'happy',\n                    characterImage: 'characters/garen_stone'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '  .     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Garen Stone',\n                    text: '...   ...',\n                    emotion: 'angry',\n                    characterImage: 'characters/garen_stone'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '...    .  !',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ]\n        }\n    },\n    {\n        id: 43, name: ' ', theme: 'Darius3', recommendedPower: 960,\n        firstReward: { gold: 3000, shards: 30 }, repeatReward: { gold: 1500, shards: 18 }, cleared: false,\n        story: {\n            description: '      .      .',\n            backgroundImage: 'backgrounds/stage_43_absolute_darkness.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/darius_blackwood.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Darius Blackwood',\n                    text: '    .        .',\n                    emotion: 'normal',\n                    characterImage: 'characters/darius_blackwood'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '       .   .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Darius Blackwood',\n                    text: '       .     .',\n                    emotion: 'normal',\n                    characterImage: 'characters/darius_blackwood'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '   .       .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Darius Blackwood',\n                    text: '.        .     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/darius_blackwood'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '  ,    .        .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Darius Blackwood',\n                    text: '    .    .',\n                    emotion: 'normal',\n                    characterImage: 'characters/darius_blackwood'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: ' ...       .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ]\n        }\n    },\n    {\n        id: 44, name: 'Elena ', theme: 'Elena2', recommendedPower: 1000,\n        firstReward: { gold: 3200, shards: 32 }, repeatReward: { gold: 1600, shards: 20 }, cleared: false,\n        story: {\n            description: ' Elena   .     .',\n            backgroundImage: 'backgrounds/stage_44_corruption_prison.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/elena_drake.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Elena Drake',\n                    text: '... ... ...   ...',\n                    emotion: 'sad',\n                    characterImage: 'characters/elena_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: 'Elena!   .   .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Elena Drake',\n                    text: '... .      .',\n                    emotion: 'happy',\n                    characterImage: 'characters/elena_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '.    .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Elena Drake',\n                    text: '... ... ...',\n                    emotion: 'angry',\n                    characterImage: 'characters/elena_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '  !  !',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ]\n        }\n    },\n    {\n        id: 45, name: ' ', theme: 'CultFinal', recommendedPower: 1050,\n        firstReward: { gold: 3600, shards: 36 }, repeatReward: { gold: 1800, shards: 22 }, cleared: false,\n        story: {\n            description: '   .        .',\n            backgroundImage: 'backgrounds/stage_45_cult_final.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Dark Cult Leader',\n                    text: '    .      .',\n                    emotion: 'angry'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '   .     .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Dark Cult Leader',\n                    text: '      .    .',\n                    emotion: 'angry'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '  ,       .    .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Dark Cult Leader',\n                    text: ' ... ...  ...!',\n                    emotion: 'sad'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: ' .       .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Dark Cult Leader',\n                    text: ' ...     .',\n                    emotion: 'happy'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '   .     .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ]\n        }\n    },\n    {\n        id: 46, name: '', theme: 'Mastermind', recommendedPower: 1100,\n        firstReward: { gold: 3900, shards: 39 }, repeatReward: { gold: 1950, shards: 24 }, cleared: false,\n        story: {\n            description: '      Xander .      .',\n            backgroundImage: 'backgrounds/stage_46_mastermind.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Mastermind Xander',\n                    text: ' , .         .',\n                    emotion: 'normal'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '     ,     .',\n                    emotion: 'angry',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Mastermind Xander',\n                    text: '   ,   .     .',\n                    emotion: 'angry'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '       .    .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Mastermind Xander',\n                    text: '...   ...      ...',\n                    emotion: 'sad'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '         .      .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Mastermind Xander',\n                    text: '.     .  , .',\n                    emotion: 'happy'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '    .    .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ]\n        }\n    },\n    {\n        id: 47, name: '', theme: 'Corrupted', recommendedPower: 1150,\n        firstReward: { gold: 4200, shards: 42 }, repeatReward: { gold: 2100, shards: 28 }, cleared: false,\n        story: {\n            description: '    . Garen, Darius, Elena    .',\n            backgroundImage: 'backgrounds/stage_47_corrupted_gathering.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Garen Stone',\n                    text: '...    .    .',\n                    emotion: 'normal',\n                    characterImage: 'characters/garen_stone'\n                },\n                {\n                    speaker: 'Darius Blackwood',\n                    text: '       .',\n                    emotion: 'normal',\n                    characterImage: 'characters/darius_blackwood'\n                },\n                {\n                    speaker: 'Elena Drake',\n                    text: '...     .',\n                    emotion: 'sad',\n                    characterImage: 'characters/elena_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: ' .    .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Garen Stone',\n                    text: '   .    .',\n                    emotion: 'happy',\n                    characterImage: 'characters/garen_stone'\n                },\n                {\n                    speaker: 'Darius Blackwood',\n                    text: '     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/darius_blackwood'\n                },\n                {\n                    speaker: 'Elena Drake',\n                    text: '!    !',\n                    emotion: 'happy',\n                    characterImage: 'characters/elena_drake'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Garen Stone',\n                    text: '   ...  .',\n                    emotion: 'normal',\n                    characterImage: 'characters/garen_stone'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '  .   .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ]\n        }\n    },\n    {\n        id: 48, name: ' ', theme: 'Elder2', recommendedPower: 1200,\n        firstReward: { gold: 4600, shards: 46 }, repeatReward: { gold: 2300, shards: 30 }, cleared: false,\n        story: {\n            description: '     .     .',\n            backgroundImage: 'backgrounds/stage_48_elder_cooperation.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        enemyImage: 'characters/elder_belmont.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Elder Belmont',\n                    text: ',     .   .',\n                    emotion: 'normal',\n                    characterImage: 'characters/elder_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                },\n                {\n                    speaker: 'Elder Belmont',\n                    text: '   .      .',\n                    emotion: 'happy',\n                    characterImage: 'characters/elder_belmont'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Elder Belmont',\n                    text: '.       .',\n                    emotion: 'happy',\n                    characterImage: 'characters/elder_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '   .',\n                    emotion: 'determined',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Elder Belmont',\n                    text: '.     .',\n                    emotion: 'normal',\n                    characterImage: 'characters/elder_belmont'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '   .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ]\n        }\n    },\n    {\n        id: 49, name: ' ', theme: 'Family', recommendedPower: 1250,\n        firstReward: { gold: 5000, shards: 50 }, repeatReward: { gold: 2500, shards: 33 }, cleared: false,\n        story: {\n            description: ' Ariana     .    .',\n            backgroundImage: 'backgrounds/stage_49_family.webp'\n        },\n        characterImage: 'characters/seraphina_belmont.png',\n        cutscene: {\n            preBattle: [\n                {\n                    speaker: 'Kai Drake',\n                    text: '   .     .',\n                    emotion: 'happy',\n                    characterImage: 'characters/kai_drake'\n                },\n                {\n                    speaker: 'Ariana',\n                    text: '   ,    .',\n                    emotion: 'happy',\n                    characterImage: 'characters/ariana_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '  .    .',\n                    emotion: 'happy',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ],\n            postVictory: [\n                {\n                    speaker: 'Kai Drake',\n                    text: '   .  .',\n                    emotion: 'happy',\n                    characterImage: 'characters/kai_drake'\n                },\n                {\n                    speaker: 'Ariana',\n                    text: '  , Seraphina.',\n                    emotion: 'happy',\n                    characterImage: 'characters/ariana_drake'\n                }\n            ],\n            postDefeat: [\n                {\n                    speaker: 'Kai Drake',\n                    text: '.     .',\n                    emotion: 'normal',\n                    characterImage: 'characters/kai_drake'\n                },\n                {\n                    speaker: 'Seraphina',\n                    text: '.      .',\n                    emotion: 'sad',\n                    characterImage: 'characters/seraphina_belmont'\n                }\n            ]\n        }\n    },\n    {\n        id: 50, name: ' ', theme: 'Void', recommendedPower: 1500,\n        firstReward: { gold: 6000, shards: 60 }, repeatReward: { gold: 3000, shards: 40 }, cleared: false,\n        story: {\n            description: '    .      .',\n            backgroundImage: 'backgrounds/stage_50_void_emperor.webp'\n        }\n    },\n];\nexport function createInitialCampaignStages() {\n    return campaignStageData.map(stage => ({\n        ...stage,\n        firstReward: {\n            ...stage.firstReward,\n            cards: 'cards' in stage.firstReward && Array.isArray(stage.firstReward.cards)\n                ? [...stage.firstReward.cards]\n                : undefined,\n        },\n        repeatReward: {\n            ...stage.repeatReward,\n            cards: 'cards' in stage.repeatReward && Array.isArray(stage.repeatReward.cards)\n                ? [...stage.repeatReward.cards]\n                : undefined,\n        },\n        story: stage.story ? { ...stage.story } : undefined,\n        cutscene: stage.cutscene\n            ? {\n                preBattle: stage.cutscene.preBattle?.map(mapDialogueLine),\n                postVictory: stage.cutscene.postVictory?.map(mapDialogueLine),\n                postDefeat: stage.cutscene.postDefeat?.map(mapDialogueLine),\n            }\n            : undefined,\n    }));\n}\nfunction mapDialogueLine(line) {\n    return { ...line };\n}\n","let pendingDeckSave = false;\nfunction scheduleDeckSave() {\n    if (pendingDeckSave)\n        return;\n    pendingDeckSave = true;\n    setTimeout(() => {\n        pendingDeckSave = false;\n        triggerCloudSave();\n    }, 250);\n}\nimport { create } from 'zustand';\nimport { supabase, SUPABASE_URL, SUPABASE_ANON_KEY } from './supabaseClient';\nimport { createInitialCampaignStages } from './data/campaignStages';\nfunction generateUuid() {\n    if (typeof crypto !== 'undefined' && typeof crypto.randomUUID === 'function') {\n        return crypto.randomUUID();\n    }\n    const bytes = new Uint8Array(16);\n    if (typeof crypto !== 'undefined' && typeof crypto.getRandomValues === 'function') {\n        crypto.getRandomValues(bytes);\n    }\n    else {\n        for (let i = 0; i < bytes.length; i += 1) {\n            bytes[i] = Math.floor(Math.random() * 256);\n        }\n    }\n    bytes[6] = (bytes[6] & 0x0f) | 0x40;\n    bytes[8] = (bytes[8] & 0x3f) | 0x80;\n    const hex = Array.from(bytes, b => b.toString(16).padStart(2, '0')).join('');\n    return `${hex.slice(0, 8)}-${hex.slice(8, 12)}-${hex.slice(12, 16)}-${hex.slice(16, 20)}-${hex.slice(20)}`;\n}\nlet vfxCallback = null;\nlet positionCallback = null;\nlet cardUseAnimationCallback = null;\nlet handTrackingResetCallback = null;\nlet enemyHandUpdateCallback = null;\n// setTimeout  \nlet enemyTurnTimer1 = null;\nlet enemyTurnTimer2 = null;\nlet enemyTurnTimer3 = null;\nlet endTurnTimer = null;\nlet pvpPollTimer = null;\nlet pvpUnloadCleanup = null;\nlet pvpTurnTimerInterval = null;\nconst DEFAULT_PVP_TURN_DURATION = 15;\nconst CLOUD_SAVE_EVENT = 'cloud-save-force';\nfunction triggerCloudSave() {\n    if (typeof window !== 'undefined') {\n        window.dispatchEvent(new Event(CLOUD_SAVE_EVENT));\n    }\n}\nconst clampDeckSnapshot = (cards) => cards.slice(0, 20);\nfunction normalizeCardId(cardId) {\n    const withoutSnapshot = cardId.split('__snap__')[0] ?? cardId;\n    const parts = withoutSnapshot.split('_');\n    if (parts.length <= 6) {\n        return withoutSnapshot;\n    }\n    return parts.slice(0, 6).join('_');\n}\nfunction rehydrateCardFromPool(card, pool) {\n    if (!card)\n        return card;\n    if (!Array.isArray(pool) || pool.length === 0)\n        return card;\n    const baseId = normalizeCardId(card.id);\n    const canonical = pool.find(candidate => normalizeCardId(candidate.id) === baseId);\n    if (!canonical) {\n        return card;\n    }\n    return {\n        ...canonical,\n        id: card.id,\n    };\n}\nfunction rehydrateCardsFromPool(cards, pool) {\n    if (!Array.isArray(cards) || cards.length === 0)\n        return cards;\n    if (!Array.isArray(pool) || pool.length === 0)\n        return cards;\n    return cards.map(card => rehydrateCardFromPool(card, pool));\n}\nfunction getDeckSnapshot(cards) {\n    return clampDeckSnapshot(cards).map(card => {\n        const baseId = normalizeCardId(card.id);\n        return {\n            baseId,\n            rarity: card.rarity,\n        };\n    });\n}\nfunction buildDeckFromSnapshot(snapshot, pool) {\n    if (!Array.isArray(snapshot) || snapshot.length === 0 || pool.length === 0) {\n        return [];\n    }\n    const baseMap = new Map(pool.map(card => [normalizeCardId(card.id), card]));\n    const generated = [];\n    snapshot.forEach((entry, index) => {\n        const base = baseMap.get(entry.baseId);\n        if (base) {\n            generated.push({\n                ...base,\n                id: `${normalizeCardId(base.id)}__snap__${index}`,\n            });\n        }\n    });\n    return clampDeckSnapshot(generated);\n}\nconst LCG_A = 1664525;\nconst LCG_C = 1013904223;\nconst LCG_M = 0x100000000;\nfunction mixSeeds(base, salt) {\n    let seed = (base ^ (salt + 0x9e3779b9)) >>> 0;\n    seed = (seed * 0x85ebca6b) >>> 0;\n    seed = (seed ^ (seed >>> 13)) >>> 0;\n    return seed >>> 0;\n}\nfunction nextSeed(seed) {\n    return (LCG_A * seed + LCG_C) >>> 0;\n}\nfunction generateRoundSeed(baseSeed, round, phase = 0) {\n    const mixed = mixSeeds(baseSeed, round + phase * 9973);\n    return nextSeed(mixed);\n}\nfunction getSeededRandom(baseSeed, counter, salt = 0) {\n    let seed = mixSeeds(baseSeed, counter + salt * 2654435761);\n    seed = nextSeed(seed);\n    return seed / LCG_M;\n}\nfunction serializeCard(card) {\n    const { id, name, type, rarity, cost, effects, tags, keywords, effectText, levelCurve, vfxKey, sfxKey, version } = card;\n    return {\n        id,\n        name,\n        type,\n        rarity,\n        cost,\n        effects,\n        tags,\n        keywords,\n        effectText,\n        levelCurve,\n        vfxKey,\n        sfxKey,\n        version,\n    };\n}\nfunction deserializeCard(serialized) {\n    return {\n        ...serialized,\n        tags: serialized.tags ?? [],\n        keywords: serialized.keywords ?? [],\n        effects: serialized.effects ?? [],\n    };\n}\nfunction clearPvpPolling() {\n    if (pvpPollTimer !== null) {\n        window.clearInterval(pvpPollTimer);\n        pvpPollTimer = null;\n    }\n}\nfunction detachPvpUnloadCleanup() {\n    if (typeof window === 'undefined' || !pvpUnloadCleanup) {\n        pvpUnloadCleanup = null;\n        return;\n    }\n    window.removeEventListener('beforeunload', pvpUnloadCleanup);\n    window.removeEventListener('pagehide', pvpUnloadCleanup);\n    pvpUnloadCleanup = null;\n}\nfunction registerPvpUnloadCleanup(userId) {\n    if (typeof window === 'undefined' || !SUPABASE_URL || !SUPABASE_ANON_KEY) {\n        return;\n    }\n    detachPvpUnloadCleanup();\n    const restEndpoint = `${SUPABASE_URL}/rest/v1/pvp_queue?user_id=eq.${userId}`;\n    const handler = () => {\n        detachPvpUnloadCleanup();\n        fetch(restEndpoint, {\n            method: 'DELETE',\n            headers: {\n                apikey: SUPABASE_ANON_KEY,\n                Authorization: `Bearer ${SUPABASE_ANON_KEY}`,\n                'Content-Type': 'application/json',\n                Prefer: 'return=minimal',\n            },\n            keepalive: true,\n        }).catch(() => {\n            //        \n        });\n    };\n    window.addEventListener('beforeunload', handler);\n    window.addEventListener('pagehide', handler);\n    pvpUnloadCleanup = handler;\n}\nexport function setVFXCallback(callback) {\n    vfxCallback = callback;\n}\nexport function setPositionCallback(callback) {\n    positionCallback = callback;\n}\nexport function setCardUseAnimationCallback(callback) {\n    cardUseAnimationCallback = callback;\n}\nexport function setHandTrackingResetCallback(callback) {\n    handTrackingResetCallback = callback;\n}\nexport function setEnemyHandUpdateCallback(callback) {\n    enemyHandUpdateCallback = callback;\n}\nfunction notifyEnemyHandUpdate() {\n    if (enemyHandUpdateCallback) {\n        enemyHandUpdateCallback();\n    }\n}\nfunction triggerVFX(type, target, value) {\n    if (vfxCallback) {\n        vfxCallback(type, target, value);\n    }\n}\nconst STATUS_VFX_MAP = {\n    Burn: 'burn',\n    Freeze: 'freeze',\n    Shock: 'shock',\n    Vulnerable: 'vulnerable',\n    Poison: 'vulnerable',\n    Regen: 'heal',\n    Mark: 'buff',\n    Root: 'freeze',\n};\nfunction triggerStatusVFX(key, target) {\n    const mapped = STATUS_VFX_MAP[key];\n    if (mapped) {\n        triggerVFX(mapped, target);\n    }\n}\nasync function triggerCardUseAnimation(card, isPlayerCard, handIndex) {\n    if (cardUseAnimationCallback) {\n        await cardUseAnimationCallback(card, isPlayerCard, handIndex);\n    }\n}\nconst STAGE_REWARD_SETTINGS = {\n    first: {\n        goldMultiplier: 3.5,\n        goldMinimum: 450,\n        shardMultiplier: 2.5,\n        shardMinimum: 6\n    },\n    repeat: {\n        goldMultiplier: 2,\n        goldMinimum: 220,\n        shardMultiplier: 1.5,\n        shardMinimum: 3\n    },\n    stageGoldBonus: 40,\n    stageShardBonus: 1\n};\nexport function getBoostedStageReward(reward, stageId, isRepeat) {\n    const config = isRepeat ? STAGE_REWARD_SETTINGS.repeat : STAGE_REWARD_SETTINGS.first;\n    const goldBase = reward.gold * config.goldMultiplier + stageId * STAGE_REWARD_SETTINGS.stageGoldBonus;\n    const shardsBase = reward.shards * config.shardMultiplier + stageId * STAGE_REWARD_SETTINGS.stageShardBonus;\n    return {\n        gold: Math.max(config.goldMinimum, goldBase),\n        shards: Math.max(config.shardMinimum, shardsBase)\n    };\n}\n// Daily dungeon helpers\nfunction getTodayKey() {\n    try {\n        const formatter = new Intl.DateTimeFormat('ko-KR', { timeZone: 'Asia/Seoul' });\n        const formatted = formatter.format(new Date()).replace(/\\./g, '-').replace(/\\s/g, '').replace(/-$/, '');\n        if (formatted) {\n            return formatted;\n        }\n    }\n    catch (error) {\n        // Intl   \n    }\n    return new Date().toISOString().slice(0, 10);\n}\nfunction createSeededRandom(seed) {\n    let value = seed >>> 0;\n    return () => {\n        value = (value * 1664525 + 1013904223) >>> 0;\n        return value / 0x100000000;\n    };\n}\nfunction generateDailyDungeonFloors(dateKey, stages) {\n    if (stages.length === 0) {\n        return [];\n    }\n    const seed = parseInt(dateKey.replace(/-/g, ''), 10) || Date.now();\n    const rand = createSeededRandom(seed);\n    const pickStage = (pool) => {\n        if (pool.length === 0) {\n            return stages[Math.floor(rand() * stages.length)] ?? stages[0];\n        }\n        return pool[Math.floor(rand() * pool.length)] ?? pool[0];\n    };\n    const early = stages.filter(s => s.id <= 15);\n    const mid = stages.filter(s => s.id > 15 && s.id <= 30);\n    const late = stages.filter(s => s.id > 30);\n    const floor1Stage = pickStage(early);\n    const floor2Stage = pickStage(mid);\n    const floor3Stage = pickStage(late);\n    return [\n        {\n            id: 1,\n            name: '  ',\n            stageId: floor1Stage.id,\n            recommendedPower: floor1Stage.recommendedPower,\n            description: `${floor1Stage.name}    .    .`,\n            modifiers: [\n                { type: 'playerEnergy', value: 1, label: '   +1', description: '       1 .' },\n                { type: 'playerShield', value: 10, label: '   10', description: '    10    .' }\n            ],\n            reward: { gold: 1600, shards: 6 },\n            cleared: false\n        },\n        {\n            id: 2,\n            name: '  ',\n            stageId: floor2Stage.id,\n            recommendedPower: floor2Stage.recommendedPower,\n            description: `${floor2Stage.name}      .    .`,\n            modifiers: [\n                { type: 'enemyEnergy', value: 1, label: '   +1', description: '     1 .' },\n                { type: 'enemyShield', value: 15, label: '    15', description: '     15 .' }\n            ],\n            reward: { gold: 2000, shards: 8 },\n            cleared: false\n        },\n        {\n            id: 3,\n            name: '  ',\n            stageId: floor3Stage.id,\n            recommendedPower: floor3Stage.recommendedPower,\n            description: `${floor3Stage.name}    .      .`,\n            modifiers: [\n                { type: 'playerShield', value: 15, label: '   15', description: '     15   .' },\n                { type: 'enemyEnergy', value: 1, label: '   +1', description: '     1 .' },\n                { type: 'enemyShield', value: 20, label: '    20', description: '     20 .' }\n            ],\n            reward: { gold: 2600, shards: 12 },\n            cleared: false\n        }\n    ];\n}\nconst initialEntityStatus = {\n    statuses: [],\n    shield: 0,\n    shieldDuration: 0,\n    guard: 0,\n    guardDuration: 0,\n    vulnerable: 0,\n    attackBuff: 0,\n    regen: 0,\n    regenDuration: 0,\n    priorityBoost: 0,\n    priorityBoostDuration: 0,\n    shockStacks: 0,\n    evasionCharges: 0,\n    evasionDuration: 0,\n    nullifyCharges: 0,\n    counterValue: 0,\n    counterDuration: 0,\n    immuneKeywords: [],\n    immuneDuration: 0,\n    nextCardDuplicate: undefined,\n    bleedStacks: 0,\n    bleedDuration: 0,\n    bleedDamagePerStack: 0,\n    reactiveArmorCharges: 0,\n    reactiveArmorReflectRatio: 0,\n    reactiveArmorShieldRatio: 0,\n    reactiveArmorDuration: 0,\n    energyBoostPending: 0,\n    energyBoostDuration: 0,\n    rootDuration: 0,\n    markStacks: 0,\n    markDuration: 0,\n    markDamageAmp: 0,\n    onHitStatuses: [],\n    nullifyTriggerEffects: [],\n    summons: [],\n};\n/**\n *     \n * -      \n * - 1-5:  Normal  ( )\n * - 6-10: Normal +   Rare  \n * - 11-20:   + Epic  \n * - 21+:   + Legendary  \n */\nfunction getEnemyDeckForStage(stageId, allCards, campaignStages) {\n    const stage = campaignStages.find(s => s.id === stageId);\n    if (!stage) {\n        //     \n        return getBasicEnemyDeck(allCards);\n    }\n    //     (enemyImage)\n    const enemyImage = stage.enemyImage || '';\n    const characterName = extractCharacterNameFromImage(enemyImage);\n    //      \n    let availableCards = [];\n    if (stageId <= 5) {\n        // 1-5 :  Normal  ( )\n        //   Normal  ,  1-2 \n        availableCards = allCards.filter(c => {\n            const cardChar = extractCharacterFromCardId(c.id);\n            return cardChar === characterName &&\n                c.rarity === 'Normal' &&\n                c.cost <= 2;\n        });\n        //      Normal  \n        if (availableCards.length < 10) {\n            const fallbackCards = allCards.filter(c => c.rarity === 'Normal' && c.cost <= 1);\n            availableCards = [...availableCards, ...fallbackCards];\n        }\n    }\n    else if (stageId <= 10) {\n        // 6-10 : Normal +   Rare  \n        const normalCards = allCards.filter(c => {\n            const cardChar = extractCharacterFromCardId(c.id);\n            return cardChar === characterName &&\n                c.rarity === 'Normal' &&\n                c.cost <= 2;\n        });\n        const rareCards = allCards.filter(c => {\n            const cardChar = extractCharacterFromCardId(c.id);\n            return cardChar === characterName &&\n                c.rarity === 'Rare' &&\n                c.cost <= 2;\n        });\n        // Normal 70%, Rare 30%\n        availableCards = [\n            ...normalCards,\n            ...rareCards.slice(0, Math.ceil(rareCards.length * 0.3))\n        ];\n    }\n    else if (stageId <= 20) {\n        // 11-20 :   + Epic  \n        const normalCards = allCards.filter(c => {\n            const cardChar = extractCharacterFromCardId(c.id);\n            return cardChar === characterName &&\n                c.rarity === 'Normal' &&\n                c.cost <= 3;\n        });\n        const rareCards = allCards.filter(c => {\n            const cardChar = extractCharacterFromCardId(c.id);\n            return cardChar === characterName &&\n                c.rarity === 'Rare' &&\n                c.cost <= 3;\n        });\n        const epicCards = allCards.filter(c => {\n            const cardChar = extractCharacterFromCardId(c.id);\n            return cardChar === characterName &&\n                c.rarity === 'Epic' &&\n                c.cost <= 3;\n        });\n        // Normal 50%, Rare 30%, Epic 20%\n        availableCards = [\n            ...normalCards,\n            ...rareCards,\n            ...epicCards.slice(0, Math.ceil(epicCards.length * 0.2))\n        ];\n    }\n    else {\n        // 21+ :   + Legendary  \n        const normalCards = allCards.filter(c => {\n            const cardChar = extractCharacterFromCardId(c.id);\n            return cardChar === characterName &&\n                c.rarity === 'Normal';\n        });\n        const rareCards = allCards.filter(c => {\n            const cardChar = extractCharacterFromCardId(c.id);\n            return cardChar === characterName &&\n                c.rarity === 'Rare';\n        });\n        const epicCards = allCards.filter(c => {\n            const cardChar = extractCharacterFromCardId(c.id);\n            return cardChar === characterName &&\n                c.rarity === 'Epic';\n        });\n        const legendaryCards = allCards.filter(c => {\n            const cardChar = extractCharacterFromCardId(c.id);\n            return cardChar === characterName &&\n                c.rarity === 'Legendary';\n        });\n        // Normal 40%, Rare 30%, Epic 20%, Legendary 10%\n        availableCards = [\n            ...normalCards,\n            ...rareCards,\n            ...epicCards,\n            ...legendaryCards.slice(0, Math.ceil(legendaryCards.length * 0.1))\n        ];\n    }\n    //  :  40% (8),  30% (6),  20% (4),  10% (2)\n    const attackCards = availableCards.filter(c => c.type === 'Attack');\n    const defenseCards = availableCards.filter(c => c.type === 'Defense');\n    const healCards = availableCards.filter(c => c.type === 'Heal');\n    const specialCards = availableCards.filter(c => c.type === 'Special');\n    const deck = [];\n    const timestamp = Date.now();\n    let cardIndex = 0;\n    //  8 (40%)\n    const attackCount = Math.min(8, attackCards.length);\n    const shuffledAttack = [...attackCards].sort(() => Math.random() - 0.5);\n    for (let i = 0; i < attackCount; i++) {\n        const card = shuffledAttack[i % shuffledAttack.length];\n        deck.push({ ...card, id: `${card.id}_enemy_${timestamp}_${cardIndex++}` });\n    }\n    //  6 (30%)\n    const defenseCount = Math.min(6, defenseCards.length);\n    const shuffledDefense = [...defenseCards].sort(() => Math.random() - 0.5);\n    for (let i = 0; i < defenseCount; i++) {\n        const card = shuffledDefense[i % shuffledDefense.length];\n        deck.push({ ...card, id: `${card.id}_enemy_${timestamp}_${cardIndex++}` });\n    }\n    //  4 (20%)\n    const healCount = Math.min(4, healCards.length);\n    const shuffledHeal = [...healCards].sort(() => Math.random() - 0.5);\n    for (let i = 0; i < healCount; i++) {\n        const card = shuffledHeal[i % shuffledHeal.length];\n        deck.push({ ...card, id: `${card.id}_enemy_${timestamp}_${cardIndex++}` });\n    }\n    //  2 (10%)\n    const specialCount = Math.min(2, specialCards.length);\n    const shuffledSpecial = [...specialCards].sort(() => Math.random() - 0.5);\n    for (let i = 0; i < specialCount; i++) {\n        const card = shuffledSpecial[i % shuffledSpecial.length];\n        deck.push({ ...card, id: `${card.id}_enemy_${timestamp}_${cardIndex++}` });\n    }\n    //   \n    if (deck.length < 20) {\n        const remaining = availableCards.filter(c => !deck.some(d => {\n            const deckBaseId = d.id.split('_enemy_')[0];\n            const cardBaseId = c.id;\n            return deckBaseId === cardBaseId;\n        }));\n        const needed = 20 - deck.length;\n        const shuffled = [...remaining].sort(() => Math.random() - 0.5);\n        for (let i = 0; i < needed && i < shuffled.length; i++) {\n            const card = shuffled[i];\n            deck.push({ ...card, id: `${card.id}_enemy_${timestamp}_${cardIndex++}` });\n        }\n    }\n    return deck.slice(0, 20).sort(() => Math.random() - 0.5);\n}\n/**\n *    (   )\n */\nfunction getBasicEnemyDeck(allCards) {\n    const basicCards = allCards.filter(c => c.rarity === 'Normal' && c.cost <= 1);\n    const shuffled = [...basicCards].sort(() => Math.random() - 0.5);\n    return shuffled.slice(0, 20).map((card, i) => ({\n        ...card,\n        id: `${card.id}_enemy_basic_${Date.now()}_${i}`\n    }));\n}\n/**\n *     \n * : 'characters/lucian_rosegarden.png' -> 'LUCIAN'\n */\nfunction extractCharacterNameFromImage(imagePath) {\n    const match = imagePath.match(/\\/([^\\/]+)\\.png$/);\n    if (!match)\n        return '';\n    const filename = match[1];\n    // lucian_rosegarden -> LUCIAN\n    const parts = filename.split('_');\n    return parts[0].toUpperCase();\n}\n/**\n *  ID   \n * : 'ATT_ARIANA_NO_001' -> 'ARIANA'\n */\nfunction extractCharacterFromCardId(cardId) {\n    const parts = cardId.split('_');\n    if (parts.length >= 2) {\n        return parts[1]; // ARIANA, LUCIAN \n    }\n    return '';\n}\nexport const STARTER_DECK_CARD_IDS = [\n    'ATT_ARIANA_NO_001',\n    'ATT_ARIANA_NO_001',\n    'ATT_DARIUS_NO_017',\n    'ATT_KAI_NO_097',\n    'ATT_LUCIAN_NO_129',\n    'ATT_MARCUS_NO_145',\n    'DEF_ARIANA_NO_013',\n    'DEF_DARIUS_NO_025',\n    'DEF_GAREN_NO_077',\n    'DEF_LEON_NO_121',\n    'DEF_LUCIAN_NO_137',\n    'HEA_ARIANA_NO_005',\n    'HEA_IRIS_NO_085',\n    'HEA_DARIUS_NO_021',\n    'HEA_LUCIAN_NO_133',\n    'SPE_ARIANA_NO_009',\n    'SPE_DARIUS_NO_029',\n    'SPE_KAI_NO_105',\n    'SPE_LEON_NO_125',\n    'SPE_MARCUS_NO_153',\n];\nexport const STARTER_COLLECTION_CARD_IDS = [\n    ...STARTER_DECK_CARD_IDS,\n    'ATT_ELDER_NO_033',\n    'DEF_KAI_NO_109',\n    'DEF_MARCUS_NO_157',\n    'HEA_KAI_NO_101',\n    'HEA_MARCUS_NO_149',\n    'SPE_ELDER_NO_041',\n    'SPE_LUCIAN_NO_213',\n];\nconst RANK_TIERS = [\n    { label: '', color: '#b87333' },\n    { label: '', color: '#c0d4ff' },\n    { label: '', color: '#fbc02d' },\n    { label: '', color: '#5ce1e6' },\n    { label: '', color: '#82b1ff' },\n    { label: '', color: '#f48fb1' },\n];\nconst RANK_LEVELS = ['V', 'IV', 'III', 'II', 'I'];\nconst WINS_PER_RANK = 5;\nexport const PVP_RANKS = (() => {\n    const ranks = [];\n    let winThreshold = 0;\n    RANK_TIERS.forEach((tier) => {\n        RANK_LEVELS.forEach((level) => {\n            ranks.push({\n                name: `${tier.label} ${level}`,\n                minWins: winThreshold,\n                color: tier.color,\n            });\n            winThreshold += WINS_PER_RANK;\n        });\n    });\n    return ranks;\n})();\nexport function getPvpRankInfo(wins) {\n    const cappedWins = Math.max(0, Math.floor(wins));\n    let rank = PVP_RANKS[0];\n    for (const candidate of PVP_RANKS) {\n        if (cappedWins >= candidate.minWins) {\n            rank = candidate;\n        }\n        else {\n            break;\n        }\n    }\n    const index = PVP_RANKS.findIndex(r => r === rank);\n    const nextRank = PVP_RANKS[index + 1] ?? null;\n    return {\n        name: rank.name,\n        color: rank.color,\n        minWins: rank.minWins,\n        index,\n        nextRankName: nextRank?.name ?? null,\n        nextMinWins: nextRank?.minWins ?? null,\n    };\n}\n/**\n *   20  \n * -  6,  5,  4,  5\n * -  Normal ,    \n */\nfunction getInitialDeck(allCards) {\n    const initialCardIds = STARTER_DECK_CARD_IDS;\n    //  ID  \n    const cardMap = new Map(allCards.map(card => [card.id, card]));\n    const initialDeck = [];\n    for (const cardId of initialCardIds) {\n        const card = cardMap.get(cardId);\n        if (card) {\n            //    ID  (  )\n            initialDeck.push({ ...card, id: `${card.id}_${Date.now()}_${Math.random()}` });\n        }\n        else {\n            console.warn(`[InitialDeck] Card not found: ${cardId}`);\n        }\n    }\n    //   Normal   \n    if (initialDeck.length < 20) {\n        const normalCards = allCards.filter(c => c.rarity === 'Normal' && c.cost <= 2);\n        const needed = 20 - initialDeck.length;\n        const shuffled = [...normalCards].sort(() => Math.random() - 0.5);\n        for (let i = 0; i < needed && i < shuffled.length; i++) {\n            const card = shuffled[i];\n            initialDeck.push({ ...card, id: `${card.id}_${Date.now()}_${Math.random()}` });\n        }\n    }\n    return initialDeck.slice(0, 20);\n}\nexport const useBattleStore = create((set, get) => ({\n    //  \n    gameScreen: 'intro',\n    setGameScreen: (screen) => {\n        const currentState = get();\n        // console.log(`[GameScreen]  CHANGING: ${currentState.gameScreen}  ${screen}`);\n        // console.log(`[GameScreen]   Before - hand: ${currentState.hand.length}, enemyHand: ${currentState.enemyHand.length}`);\n        set({ gameScreen: screen });\n        const newState = get();\n        // console.log(`[GameScreen]   After - hand: ${newState.hand.length}, enemyHand: ${newState.enemyHand.length}`);\n        // console.log(`[GameScreen]  Changed to: ${screen}`);\n    },\n    //  \n    replayHistory: [],\n    recordReplayAction: (action) => {\n        const history = [...get().replayHistory, action];\n        set({ replayHistory: history });\n        // console.log(`[Replay] Recorded round ${action.round}, seed: ${action.seed}`);\n    },\n    exportReplay: () => {\n        const state = get();\n        const replay = {\n            timestamp: new Date().toISOString(),\n            stage: state.currentStage,\n            initialSeed: state.replayHistory[0]?.seed || state.roundSeed,\n            actions: state.replayHistory,\n            result: state.gameOver,\n        };\n        const json = JSON.stringify(replay, null, 2);\n        // console.log('[Replay] Exported:', json);\n        return json;\n    },\n    //  \n    gold: 1200, //   (   )\n    shards: 80, //  \n    pvpWins: 0,\n    addGold: (amount) => {\n        const current = get().gold;\n        set({ gold: current + amount });\n        triggerCloudSave();\n        // console.log(`[Currency] Gold: ${current} -> ${current + amount} (+${amount})`);\n    },\n    addShards: (amount) => {\n        const current = get().shards;\n        set({ shards: current + amount });\n        triggerCloudSave();\n        // console.log(`[Currency] Shards: ${current} -> ${current + amount} (+${amount})`);\n    },\n    //  \n    getCardPacks: () => {\n        return [\n            {\n                id: 'pack_normal',\n                name: ' ',\n                type: 'normal',\n                price: 100,\n                priceType: 'gold',\n                description: ' ',\n                rates: { Normal: 70, Rare: 25, Epic: 4, Legendary: 1 }\n            },\n            {\n                id: 'pack_rare',\n                name: ' ',\n                type: 'rare',\n                price: 250,\n                priceType: 'gold',\n                description: '   ',\n                rates: { Normal: 50, Rare: 40, Epic: 8, Legendary: 2 }\n            },\n            {\n                id: 'pack_epic',\n                name: ' ',\n                type: 'epic',\n                price: 500,\n                priceType: 'gold',\n                description: '   ',\n                rates: { Normal: 30, Rare: 40, Epic: 25, Legendary: 5 }\n            },\n            {\n                id: 'pack_legendary',\n                name: ' ',\n                type: 'legendary',\n                price: 1000,\n                priceType: 'gold',\n                description: '   ',\n                rates: { Normal: 0, Rare: 20, Epic: 50, Legendary: 30 }\n            },\n            {\n                id: 'pack_premium',\n                name: ' ',\n                type: 'epic',\n                price: 50,\n                priceType: 'shards',\n                description: '   ',\n                rates: { Normal: 20, Rare: 30, Epic: 40, Legendary: 10 }\n            }\n        ];\n    },\n    buyCardPack: (packType) => {\n        const state = get();\n        const packs = get().getCardPacks();\n        const pack = packs.find(p => p.type === packType);\n        if (!pack) {\n            console.error(`[Shop] Pack type not found: ${packType}`);\n            return null;\n        }\n        //  \n        if (pack.priceType === 'gold') {\n            if (state.gold < pack.price) {\n                console.warn(`[Shop] Not enough gold: ${state.gold} < ${pack.price}`);\n                return null;\n            }\n            get().addGold(-pack.price);\n        }\n        else if (pack.priceType === 'shards') {\n            if (state.shards < pack.price) {\n                console.warn(`[Shop] Not enough shards: ${state.shards} < ${pack.price}`);\n                return null;\n            }\n            get().addShards(-pack.price);\n        }\n        //   \n        const roll = Math.random() * 100;\n        let selectedRarity = 'Normal';\n        let cumulative = 0;\n        for (const [rarity, rate] of Object.entries(pack.rates)) {\n            cumulative += rate;\n            if (roll < cumulative) {\n                selectedRarity = rarity;\n                break;\n            }\n        }\n        //       (  )\n        const cardPool = state.allCardsPool.length > 0 ? state.allCardsPool : state.collection;\n        const availableCards = cardPool.filter(c => c.rarity === selectedRarity);\n        if (availableCards.length === 0) {\n            console.warn(`[Shop] No cards available for rarity: ${selectedRarity}`);\n            //   Normal \n            const fallbackCards = cardPool.filter(c => c.rarity === 'Normal');\n            if (fallbackCards.length === 0) {\n                return null;\n            }\n            const randomIndex = Math.floor(Math.random() * fallbackCards.length);\n            const selectedCard = fallbackCards[randomIndex];\n            //   ( )\n            const newCollection = [...state.collection, { ...selectedCard, id: `${selectedCard.id}_${Date.now()}` }];\n            set({ collection: newCollection });\n            triggerCloudSave();\n            return selectedCard;\n        }\n        const randomIndex = Math.floor(Math.random() * availableCards.length);\n        const selectedCard = availableCards[randomIndex];\n        //   (  -       )\n        const newCollection = [...state.collection, { ...selectedCard, id: `${selectedCard.id}_${Date.now()}` }];\n        set({ collection: newCollection });\n        triggerCloudSave();\n        console.log(`[Shop] Pack opened: ${pack.name}, Got: ${selectedCard.name} (${selectedRarity})`);\n        return selectedCard;\n    },\n    // PvP \n    pvpQueueStatus: 'idle',\n    pvpStatusMessage: '',\n    pvpError: null,\n    pvpMatch: null,\n    pvpChannel: null,\n    pvpRealtimeConnected: false,\n    pvpLocalSubmissionRound: null,\n    pvpRemoteSubmission: null,\n    pvpLastResolvedRound: 0,\n    pvpRandomCounter: 0,\n    pvpLocalReady: false,\n    pvpOpponentReady: false,\n    pvpTurnDuration: DEFAULT_PVP_TURN_DURATION,\n    pvpTurnTimeLeft: null,\n    pvpTurnTimerActive: false,\n    startPvpTurnTimer: (forceRestart = false) => {\n        const state = get();\n        if (state.battleContext.type !== 'pvp' || state.gameOver !== 'none') {\n            return;\n        }\n        if (!forceRestart && state.pvpTurnTimerActive) {\n            return;\n        }\n        if (!forceRestart && state.pvpLocalReady) {\n            return;\n        }\n        if (pvpTurnTimerInterval !== null && typeof window !== 'undefined') {\n            window.clearInterval(pvpTurnTimerInterval);\n            pvpTurnTimerInterval = null;\n        }\n        const duration = state.pvpTurnDuration || DEFAULT_PVP_TURN_DURATION;\n        set({\n            pvpTurnDuration: duration,\n            pvpTurnTimeLeft: duration,\n            pvpTurnTimerActive: true,\n        });\n        if (typeof window === 'undefined') {\n            return;\n        }\n        pvpTurnTimerInterval = window.setInterval(() => {\n            const current = get();\n            if (current.battleContext.type !== 'pvp' || current.gameOver !== 'none') {\n                current.stopPvpTurnTimer(true);\n                return;\n            }\n            if (current.pvpLocalReady) {\n                current.stopPvpTurnTimer();\n                return;\n            }\n            const remaining = (current.pvpTurnTimeLeft ?? current.pvpTurnDuration ?? DEFAULT_PVP_TURN_DURATION) - 1;\n            if (remaining <= 0) {\n                set({ pvpTurnTimeLeft: 0 });\n                current.stopPvpTurnTimer();\n                current.handlePvpTurnTimeout();\n            }\n            else {\n                set({ pvpTurnTimeLeft: remaining });\n            }\n        }, 1000);\n    },\n    stopPvpTurnTimer: (resetState = false) => {\n        if (pvpTurnTimerInterval !== null && typeof window !== 'undefined') {\n            window.clearInterval(pvpTurnTimerInterval);\n            pvpTurnTimerInterval = null;\n        }\n        set(state => ({\n            pvpTurnTimerActive: false,\n            pvpTurnTimeLeft: resetState ? null : state.pvpTurnTimeLeft,\n        }));\n    },\n    handlePvpTurnTimeout: () => {\n        const state = get();\n        if (state.battleContext.type !== 'pvp' || state.gameOver !== 'none' || state.pvpLocalReady) {\n            return;\n        }\n        get().addLog('      .', 'system');\n        void get().endPlayerTurn();\n    },\n    startPvpMatchmaking: async () => {\n        const { data: sessionData } = await supabase.auth.getSession();\n        const session = sessionData.session;\n        if (!session) {\n            set({ pvpQueueStatus: 'error', pvpError: '   .' });\n            return;\n        }\n        const userId = session.user.id;\n        clearPvpPolling();\n        get().stopPvpTurnTimer(true);\n        set(state => {\n            const isPvp = state.battleContext.type === 'pvp';\n            return {\n                pvpQueueStatus: 'searching',\n                pvpStatusMessage: '  ...',\n                pvpError: null,\n                pvpMatch: null,\n                pvpLocalSubmissionRound: isPvp ? state.pvpLocalSubmissionRound : null,\n                pvpRemoteSubmission: isPvp ? state.pvpRemoteSubmission : null,\n                pvpLastResolvedRound: 0,\n                pvpLocalReady: false,\n                pvpOpponentReady: false,\n                pvpTurnTimeLeft: null,\n                pvpTurnTimerActive: false,\n            };\n        });\n        try {\n            await supabase.rpc('pvp_cleanup_stale');\n        }\n        catch (error) {\n            console.warn('[PvP] cleanup rpc failed (non-blocking)', error);\n        }\n        const deckSnapshot = getDeckSnapshot(get().playerDeck);\n        const queuePayload = {\n            user_id: userId,\n            status: 'waiting',\n            opponent_id: null,\n            match_id: null,\n            deck_snapshot: deckSnapshot,\n            updated_at: new Date().toISOString(),\n        };\n        const upsertResult = await supabase.from('pvp_queue').upsert(queuePayload);\n        if (upsertResult.error) {\n            set({ pvpQueueStatus: 'error', pvpError: upsertResult.error.message });\n            console.error('[PvP] Failed to join queue', upsertResult.error, queuePayload);\n            return;\n        }\n        console.log('[PvP] Joined queue', { userId, deckSnapshotSize: deckSnapshot.length });\n        registerPvpUnloadCleanup(userId);\n        const opponentRes = await supabase\n            .from('pvp_queue')\n            .select('user_id, deck_snapshot, updated_at')\n            .eq('status', 'waiting')\n            .neq('user_id', userId)\n            .order('updated_at', { ascending: true })\n            .limit(1);\n        if (opponentRes.error) {\n            set({ pvpQueueStatus: 'error', pvpError: opponentRes.error.message });\n            console.error('[PvP] Failed to search opponent', opponentRes.error);\n            return;\n        }\n        console.log('[PvP] Opponent search result', opponentRes.data?.length ?? 0);\n        if (opponentRes.data && opponentRes.data.length > 0) {\n            const opponent = opponentRes.data[0];\n            const matchId = generateUuid();\n            const seed = Math.floor(Math.random() * 1000000);\n            const insertedMatch = await supabase.from('pvp_matches').insert({\n                id: matchId,\n                player1_id: opponent.user_id,\n                player2_id: userId,\n                seed,\n                status: 'pending',\n                created_at: new Date().toISOString(),\n                player1_deck: opponent.deck_snapshot ?? [],\n                player2_deck: deckSnapshot,\n            });\n            if (insertedMatch.error) {\n                set({ pvpQueueStatus: 'error', pvpError: insertedMatch.error.message });\n                console.error('[PvP] Failed to create match row', insertedMatch.error);\n                return;\n            }\n            await Promise.all([\n                supabase.from('pvp_queue').update({ status: 'matched', match_id: matchId, opponent_id: opponent.user_id }).eq('user_id', userId),\n                supabase.from('pvp_queue').update({ status: 'matched', match_id: matchId, opponent_id: userId }).eq('user_id', opponent.user_id),\n            ]);\n            const opponentProfile = await supabase\n                .from('profiles')\n                .select('display_name')\n                .eq('user_id', opponent.user_id)\n                .maybeSingle();\n            const opponentDeckSnapshot = opponent.deck_snapshot ?? [];\n            const opponentDeckCards = buildDeckFromSnapshot(opponentDeckSnapshot, get().allCardsPool);\n            set({\n                pvpQueueStatus: 'matched',\n                pvpStatusMessage: ' .',\n                pvpMatch: {\n                    matchId,\n                    seed,\n                    opponentId: opponent.user_id,\n                    opponentName: opponentProfile.data?.display_name ?? null,\n                    opponentDeckSnapshot,\n                    opponentDeckCards,\n                    playerDeckSnapshot: deckSnapshot,\n                    playerRole: 'player2',\n                    status: 'pending',\n                },\n            });\n            void Promise.resolve().then(() => get().acceptPvpMatch());\n            return;\n        }\n        clearPvpPolling();\n        pvpPollTimer = window.setInterval(async () => {\n            const queueRes = await supabase\n                .from('pvp_queue')\n                .select('status, match_id, opponent_id')\n                .eq('user_id', userId)\n                .maybeSingle();\n            if (queueRes.error) {\n                set({ pvpQueueStatus: 'error', pvpError: queueRes.error.message });\n                clearPvpPolling();\n                return;\n            }\n            const queueRow = queueRes.data;\n            if (!queueRow || queueRow.status !== 'matched' || !queueRow.match_id) {\n                return;\n            }\n            clearPvpPolling();\n            const matchRes = await supabase\n                .from('pvp_matches')\n                .select('id, player1_id, player2_id, seed, player1_deck, player2_deck')\n                .eq('id', queueRow.match_id)\n                .maybeSingle();\n            if (matchRes.error || !matchRes.data) {\n                set({ pvpQueueStatus: 'error', pvpError: matchRes.error?.message ?? '   .' });\n                return;\n            }\n            const match = matchRes.data;\n            const playerRole = match.player1_id === userId ? 'player1' : 'player2';\n            const opponentId = playerRole === 'player1' ? match.player2_id : match.player1_id;\n            const opponentSnapshot = (playerRole === 'player1' ? match.player2_deck : match.player1_deck);\n            const ownSnapshot = (playerRole === 'player1' ? match.player1_deck : match.player2_deck);\n            const opponentDeckCards = buildDeckFromSnapshot(opponentSnapshot ?? [], get().allCardsPool);\n            const opponentProfile = await supabase\n                .from('profiles')\n                .select('display_name')\n                .eq('user_id', opponentId)\n                .maybeSingle();\n            set({\n                pvpQueueStatus: 'matched',\n                pvpStatusMessage: ' .',\n                pvpMatch: {\n                    matchId: match.id,\n                    seed: match.seed ?? 0,\n                    opponentId,\n                    opponentName: opponentProfile.data?.display_name ?? null,\n                    opponentDeckSnapshot: opponentSnapshot ?? [],\n                    opponentDeckCards,\n                    playerDeckSnapshot: ownSnapshot ?? deckSnapshot,\n                    playerRole,\n                    status: 'pending',\n                },\n            });\n            void Promise.resolve().then(() => get().acceptPvpMatch());\n        }, 2000);\n    },\n    cancelPvpMatchmaking: async () => {\n        const { data: sessionData } = await supabase.auth.getSession();\n        const session = sessionData.session;\n        clearPvpPolling();\n        detachPvpUnloadCleanup();\n        if (session) {\n            await supabase.from('pvp_queue').delete().eq('user_id', session.user.id);\n        }\n        set({ pvpQueueStatus: 'idle', pvpStatusMessage: '', pvpError: null, pvpMatch: null });\n        await get().disconnectPvpChannel();\n    },\n    acceptPvpMatch: async () => {\n        const match = get().pvpMatch;\n        if (!match || match.status === 'ready')\n            return;\n        const { data: sessionData } = await supabase.auth.getSession();\n        const session = sessionData.session;\n        if (!session) {\n            set({ pvpError: '  .', pvpQueueStatus: 'error' });\n            return;\n        }\n        await supabase.from('pvp_queue').delete().eq('user_id', session.user.id);\n        detachPvpUnloadCleanup();\n        set(state => ({\n            battleContext: { type: 'pvp', pvpMatchId: match.matchId, pvpSeed: match.seed },\n            pvpMatch: match ? { ...match, status: 'ready' } : null,\n        }));\n        set({ pvpQueueStatus: 'idle', pvpStatusMessage: '' });\n        const cardsPool = get().allCardsPool;\n        const deck = match.playerRole === 'player1'\n            ? buildDeckFromSnapshot(match.playerDeckSnapshot, cardsPool)\n            : get().playerDeck;\n        if (match.playerRole === 'player1') {\n            set({ playerDeck: deck });\n        }\n        await get().connectPvpChannel(match);\n        get().initGame(cardsPool);\n        get().setGameScreen('battle');\n    },\n    reportPvpResult: async (result) => {\n        const match = get().pvpMatch;\n        if (!match)\n            return;\n        const { data: sessionData } = await supabase.auth.getSession();\n        const session = sessionData.session;\n        if (!session)\n            return;\n        const outcome = await supabase.from('pvp_matches').update({\n            status: 'completed',\n            result,\n            completed_at: new Date().toISOString(),\n            winner_id: result === 'victory' ? session.user.id : result === 'defeat' ? match.opponentId : null,\n        }).eq('id', match.matchId);\n        if (outcome.error) {\n            console.error('[PvP] Failed to report match result', outcome.error);\n        }\n        await supabase.from('pvp_queue').delete().eq('user_id', session.user.id);\n        detachPvpUnloadCleanup();\n        if (result === 'victory') {\n            set(state => ({ pvpWins: (state.pvpWins ?? 0) + 1 }));\n        }\n        triggerCloudSave();\n        set({ pvpMatch: { ...match, status: 'completed' }, pvpQueueStatus: 'idle', pvpStatusMessage: '' });\n        await get().disconnectPvpChannel();\n    },\n    connectPvpChannel: async (match) => {\n        const existing = get().pvpChannel;\n        if (existing) {\n            try {\n                await existing.unsubscribe();\n            }\n            catch (error) {\n                console.warn('[PvP] Failed to unsubscribe existing channel', error);\n            }\n        }\n        const channel = supabase.channel(`pvp:${match.matchId}`, {\n            config: {\n                broadcast: { ack: true },\n            },\n        });\n        channel.on('broadcast', { event: 'turn:submit' }, ({ payload }) => {\n            const data = payload;\n            if (!data || data.matchId !== match.matchId) {\n                return;\n            }\n            const state = get();\n            if (state.battleContext.type !== 'pvp')\n                return;\n            if (data.round < state.round) {\n                return;\n            }\n            const cards = data.cards.map(deserializeCard);\n            set(current => {\n                if (current.battleContext.type !== 'pvp') {\n                    return {};\n                }\n                if (data.round < current.round) {\n                    return {};\n                }\n                return {\n                    enemyQueue: cards.map(card => ({ card })),\n                    pvpRemoteSubmission: { round: data.round, cards, energySnapshot: data.energy },\n                    enemyEnergy: data.energy,\n                    pvpOpponentReady: true,\n                };\n            });\n            get().addLog(`  . ( ${data.round})`, 'system');\n            void get().tryResolvePvpRound(data.round);\n        });\n        let subscribeError = null;\n        await new Promise((resolve, reject) => {\n            channel.subscribe(status => {\n                if (status === 'SUBSCRIBED') {\n                    set({ pvpRealtimeConnected: true });\n                    resolve();\n                }\n                else if (status === 'CHANNEL_ERROR') {\n                    reject(new Error('PVP   '));\n                }\n            });\n            // subscribe returns immediately; resolution handled in callback\n        }).catch(error => {\n            subscribeError = error instanceof Error ? error : new Error(String(error));\n            console.error('[PvP] Channel subscribe error', subscribeError);\n            set({ pvpError: subscribeError.message });\n        });\n        if (subscribeError) {\n            try {\n                await channel.unsubscribe();\n            }\n            catch {\n                // ignore\n            }\n            return;\n        }\n        set({\n            pvpChannel: channel,\n            pvpRealtimeConnected: true,\n            pvpOpponentReady: false,\n        });\n    },\n    disconnectPvpChannel: async () => {\n        const existing = get().pvpChannel;\n        if (existing) {\n            try {\n                await existing.unsubscribe();\n            }\n            catch (error) {\n                console.warn('[PvP] Failed to unsubscribe channel', error);\n            }\n        }\n        get().stopPvpTurnTimer(true);\n        set({\n            pvpChannel: null,\n            pvpRealtimeConnected: false,\n            pvpLocalSubmissionRound: null,\n            pvpRemoteSubmission: null,\n            pvpLocalReady: false,\n            pvpOpponentReady: false,\n            pvpTurnTimeLeft: null,\n            pvpTurnTimerActive: false,\n        });\n    },\n    submitPvpTurn: async () => {\n        const state = get();\n        if (state.battleContext.type !== 'pvp') {\n            return;\n        }\n        if (!state.pvpChannel || !state.pvpMatch) {\n            set({ pvpError: 'PVP   .' });\n            return;\n        }\n        const currentRound = state.round;\n        if (state.pvpLocalSubmissionRound === currentRound || state.pvpLocalReady) {\n            return;\n        }\n        if (!state.declarationLocked) {\n            set({ declarationLocked: true });\n        }\n        set({ isTurnProcessing: true, pvpError: null });\n        get().addLog('  ', 'system');\n        const payload = {\n            matchId: state.pvpMatch.matchId,\n            round: currentRound,\n            cards: state.playerQueue.map(entry => serializeCard(entry.card)),\n            energy: state.energy,\n        };\n        const sendStatus = await state.pvpChannel.send({\n            type: 'broadcast',\n            event: 'turn:submit',\n            payload,\n        });\n        if (sendStatus !== 'ok') {\n            console.error('[PvP] Failed to send turn payload', sendStatus);\n            set({\n                pvpError: sendStatus === 'timed out'\n                    ? '     .'\n                    : '   .',\n                isTurnProcessing: false,\n            });\n            return;\n        }\n        get().stopPvpTurnTimer();\n        set({\n            pvpLocalSubmissionRound: currentRound,\n            pvpLocalReady: true,\n        });\n        await get().tryResolvePvpRound(currentRound);\n    },\n    tryResolvePvpRound: async (round) => {\n        const state = get();\n        if (state.battleContext.type !== 'pvp')\n            return;\n        if (state.round !== round)\n            return;\n        if (state.pvpLocalSubmissionRound !== round)\n            return;\n        const remote = state.pvpRemoteSubmission;\n        if (!remote || remote.round !== round)\n            return;\n        if (state.pvpLastResolvedRound >= round)\n            return;\n        if (state.isTurnProcessing && state.gameOver !== 'none') {\n            return;\n        }\n        try {\n            set(current => ({\n                enemyQueue: remote.cards.map(card => ({ card })),\n                enemyEnergy: remote.energySnapshot,\n                declarationLocked: true,\n                isTurnProcessing: true,\n            }));\n            await get().revealAndResolve();\n            if (get().gameOver !== 'none') {\n                set({\n                    pvpRandomCounter: 0,\n                    pvpLastResolvedRound: round,\n                    pvpLocalSubmissionRound: null,\n                    pvpRemoteSubmission: null,\n                    pvpLocalReady: false,\n                    pvpOpponentReady: false,\n                    isTurnProcessing: false,\n                });\n                return;\n            }\n            get().processStatusEffects();\n            const after = get();\n            const matchSeed = after.pvpMatch?.seed ?? after.roundSeed;\n            const nextRound = round + 1;\n            const nextSeed = generateRoundSeed(matchSeed, nextRound);\n            const nextPlayerEnergy = Math.min(after.energy + 3, 10);\n            const nextEnemyEnergy = Math.min(after.enemyEnergy + 3, 10);\n            const turnDuration = after.pvpTurnDuration || DEFAULT_PVP_TURN_DURATION;\n            set({\n                round: nextRound,\n                roundSeed: nextSeed,\n                energy: nextPlayerEnergy,\n                enemyEnergy: nextEnemyEnergy,\n                pvpRandomCounter: 0,\n                pvpLastResolvedRound: round,\n                pvpLocalSubmissionRound: null,\n                pvpRemoteSubmission: null,\n                pvpLocalReady: false,\n                pvpOpponentReady: false,\n                pvpTurnTimeLeft: turnDuration,\n                pvpTurnTimerActive: false,\n                isTurnProcessing: false,\n            });\n            get().addLog(`  ${nextRound}  `, 'system');\n            get().addLog(` : ${nextPlayerEnergy}`, 'system');\n            get().addLog(` : ${nextEnemyEnergy}`, 'system');\n            get().draw(1);\n            if (after.battleContext.type === 'pvp') {\n                get().enemyDraw(1);\n            }\n            get().startPvpTurnTimer(true);\n        }\n        catch (error) {\n            console.error('[PvP] Failed to resolve round', error);\n            set({\n                pvpError: error instanceof Error ? error.message : String(error),\n                isTurnProcessing: false,\n            });\n        }\n    },\n    //  \n    campaignStages: createInitialCampaignStages(),\n    completedStageIds: [],\n    dailyDungeon: {\n        dateKey: '',\n        floors: [],\n        currentFloorId: null,\n        completed: false,\n    },\n    currentDailyFloorId: null,\n    currentStage: null,\n    battleContext: { type: null, campaignStageId: null, dailyFloorId: null, pvpMatchId: null, pvpSeed: null },\n    postBattleScreen: null,\n    selectStage: (stageId) => {\n        set({\n            currentStage: stageId,\n            currentDailyFloorId: null,\n            battleContext: { type: 'campaign', campaignStageId: stageId, dailyFloorId: null, pvpMatchId: null, pvpSeed: null },\n            postBattleScreen: 'campaign',\n        });\n        // console.log(`[Campaign] Selected stage: ${stageId}`);\n    },\n    clearStage: (stageId) => {\n        const stages = get().campaignStages;\n        const updatedStages = stages.map(s => s.id === stageId ? { ...s, cleared: true } : s);\n        const stage = stages.find(s => s.id === stageId);\n        if (stage) {\n            set(state => {\n                const alreadyCleared = state.completedStageIds.includes(stageId);\n                return alreadyCleared\n                    ? {}\n                    : { completedStageIds: [...state.completedStageIds, stageId].sort((a, b) => a - b) };\n            });\n            //   (  )\n            const isRepeatClear = stage.cleared;\n            const baseReward = isRepeatClear ? stage.repeatReward : stage.firstReward;\n            const boostedReward = getBoostedStageReward(baseReward, stageId, isRepeatClear);\n            set({\n                campaignStages: updatedStages,\n                pendingReward: { gold: boostedReward.gold, shards: boostedReward.shards, cards: [] }\n            });\n            if (typeof window !== 'undefined') {\n                window.dispatchEvent(new Event('cloud-save-force'));\n            }\n            // console.log(`[Campaign] Stage ${stageId} cleared! Reward: ${reward.gold} gold, ${reward.shards} shards`);\n        }\n    },\n    ensureDailyDungeon: () => {\n        const state = get();\n        const today = getTodayKey();\n        if (state.dailyDungeon.dateKey === today && state.dailyDungeon.floors.length > 0) {\n            return;\n        }\n        const floors = generateDailyDungeonFloors(today, state.campaignStages);\n        set({\n            dailyDungeon: {\n                dateKey: today,\n                floors,\n                currentFloorId: null,\n                completed: floors.every(f => f.cleared),\n            },\n            currentDailyFloorId: null,\n        });\n    },\n    resetDailyDungeon: () => {\n        const today = getTodayKey();\n        const floors = generateDailyDungeonFloors(today, get().campaignStages);\n        set({\n            dailyDungeon: {\n                dateKey: today,\n                floors,\n                currentFloorId: null,\n                completed: false,\n            },\n            currentDailyFloorId: null,\n        });\n    },\n    enterDailyDungeonFloor: (floorId) => {\n        get().ensureDailyDungeon();\n        const state = get();\n        const daily = state.dailyDungeon;\n        const floorIndex = daily.floors.findIndex(f => f.id === floorId);\n        if (floorIndex === -1) {\n            console.warn(`[DailyDungeon] Floor not found: ${floorId}`);\n            return;\n        }\n        if (floorIndex > 0 && !daily.floors[floorIndex - 1].cleared) {\n            console.warn(`[DailyDungeon] Floor ${floorId} is locked. Previous floor not cleared.`);\n            return;\n        }\n        const floor = daily.floors[floorIndex];\n        set({\n            currentDailyFloorId: floorId,\n            currentStage: floor.stageId,\n            battleContext: { type: 'daily', campaignStageId: floor.stageId, dailyFloorId: floorId, pvpMatchId: null, pvpSeed: null },\n            postBattleScreen: 'daily',\n            dailyDungeon: { ...daily, currentFloorId: floorId },\n        });\n        get().setGameScreen('battle');\n    },\n    completeDailyFloor: (floorId) => {\n        const state = get();\n        const daily = state.dailyDungeon;\n        const floors = daily.floors.map(f => f.id === floorId ? { ...f, cleared: true } : f);\n        const floor = floors.find(f => f.id === floorId);\n        if (!floor)\n            return;\n        const completed = floors.every(f => f.cleared);\n        set({\n            dailyDungeon: {\n                dateKey: daily.dateKey,\n                floors,\n                currentFloorId: null,\n                completed,\n            },\n            currentDailyFloorId: null,\n            currentStage: null,\n            battleContext: { type: null, campaignStageId: null, dailyFloorId: null, pvpMatchId: null, pvpSeed: null },\n            pendingReward: { gold: floor.reward.gold, shards: floor.reward.shards, cards: [] },\n        });\n    },\n    handleBattleDefeatNavigation: () => {\n        const target = get().postBattleScreen;\n        if (target === 'daily') {\n            set(state => ({\n                currentStage: null,\n                currentDailyFloorId: null,\n                dailyDungeon: { ...state.dailyDungeon, currentFloorId: null },\n                battleContext: { type: null, campaignStageId: null, dailyFloorId: null, pvpMatchId: null, pvpSeed: null },\n                postBattleScreen: null,\n            }));\n            get().setGameScreen('daily');\n        }\n        else {\n            set({ battleContext: { type: null, campaignStageId: null, dailyFloorId: null, pvpMatchId: null, pvpSeed: null }, postBattleScreen: null });\n            get().setGameScreen(target ?? 'campaign');\n        }\n    },\n    navigateAfterReward: () => {\n        const target = get().postBattleScreen;\n        set({ postBattleScreen: null });\n        if (target === 'daily') {\n            get().setGameScreen('daily');\n        }\n        else {\n            set({ battleContext: { type: null, campaignStageId: null, dailyFloorId: null, pvpMatchId: null, pvpSeed: null } });\n            get().setGameScreen('campaign');\n        }\n    },\n    //  \n    pendingReward: null,\n    claimReward: () => {\n        const reward = get().pendingReward;\n        if (!reward)\n            return;\n        get().addGold(reward.gold);\n        get().addShards(reward.shards);\n        //     (TODO:  )\n        set({ pendingReward: null });\n        if (typeof window !== 'undefined') {\n            window.dispatchEvent(new Event('cloud-save-force'));\n        }\n        console.log('[Reward] Claimed!');\n    },\n    //  \n    playerDeck: [],\n    collection: [],\n    allCardsPool: [],\n    setCollection: (cards) => {\n        const pool = get().allCardsPool;\n        const hydrated = rehydrateCardsFromPool(cards, pool);\n        set({ collection: hydrated });\n        //     20  ( )\n        const currentDeck = get().playerDeck;\n        if (currentDeck.length === 0) {\n            // allCardsPool    (   )\n            const allCardsPool = get().allCardsPool;\n            if (allCardsPool.length > 0) {\n                const initialDeck = getInitialDeck(allCardsPool);\n                set({ playerDeck: initialDeck });\n                console.log('[Deck] Auto-generated initial deck (20 cards)');\n            }\n            else if (cards.length >= 20) {\n                // allCardsPool  collection  ()\n                const initialDeck = getInitialDeck(cards);\n                set({ playerDeck: initialDeck });\n                console.log('[Deck] Auto-generated initial deck from collection (20 cards)');\n            }\n        }\n        triggerCloudSave();\n    },\n    setAllCardsPool: (cards) => {\n        const state = get();\n        const rehydratedCollection = rehydrateCardsFromPool(state.collection, cards);\n        const rehydratedDeck = rehydrateCardsFromPool(state.playerDeck, cards);\n        set({\n            allCardsPool: cards,\n            collection: rehydratedCollection,\n            playerDeck: rehydratedDeck,\n        });\n        console.log(`[Shop] All cards pool set: ${cards.length} cards`);\n    },\n    addCardToDeck: (card) => {\n        const state = get();\n        const currentDeck = state.playerDeck;\n        //   20  \n        if (currentDeck.length >= 20) {\n            console.warn('[Deck] Cannot add card: deck is full (20/20)');\n            return false;\n        }\n        //     ( 3)\n        const newCardKey = normalizeCardId(card.id);\n        const sameCardCount = currentDeck.filter(c => normalizeCardId(c.id) === newCardKey).length;\n        if (sameCardCount >= 3) {\n            console.warn(`[Deck] Cannot add card: ${card.name} already has 3 copies`);\n            return false;\n        }\n        const ownedCount = state.collection.filter(c => normalizeCardId(c.id) === newCardKey).length;\n        if (sameCardCount >= ownedCount) {\n            console.warn(`[Deck] Cannot add card: ${card.name} owned ${ownedCount}, already in deck ${sameCardCount}`);\n            return false;\n        }\n        // Legendary 1 \n        if (card.rarity === 'Legendary') {\n            const legendaryCount = currentDeck.filter(c => c.rarity === 'Legendary').length;\n            if (legendaryCount >= 3) {\n                console.warn('[Deck] Cannot add card: Legendary limit (3) reached');\n                return false;\n            }\n        }\n        set({ playerDeck: [...currentDeck, card] });\n        scheduleDeckSave();\n        // console.log(`[Deck] Added: ${card.name} (${currentDeck.length + 1}/20)`);\n        return true;\n    },\n    removeCardFromDeck: (cardId) => {\n        const state = get();\n        const currentDeck = state.playerDeck;\n        //     \n        const index = currentDeck.findIndex(c => c.id === cardId);\n        if (index === -1) {\n            console.warn('[Deck] Cannot remove card: not found in deck');\n            return;\n        }\n        const newDeck = [...currentDeck];\n        newDeck.splice(index, 1);\n        set({ playerDeck: newDeck });\n        scheduleDeckSave();\n        // console.log(`[Deck] Removed card (${newDeck.length}/20)`);\n    },\n    autoBuildDeck: () => {\n        const state = get();\n        const { collection } = state;\n        if (!collection || collection.length === 0) {\n            console.warn('[Deck] Cannot auto-build: collection is empty');\n            return { success: false, deckSize: state.playerDeck.length, missing: Math.max(0, 20 - state.playerDeck.length), reason: 'empty-collection' };\n        }\n        const canonicalMap = new Map();\n        collection.forEach(card => {\n            const key = normalizeCardId(card.id);\n            if (!canonicalMap.has(key)) {\n                canonicalMap.set(key, []);\n            }\n            canonicalMap.get(key).push(card);\n        });\n        const rarityScore = {\n            Legendary: 500,\n            Epic: 360,\n            Rare: 250,\n            Normal: 150,\n        };\n        const typeScore = {\n            Attack: 80,\n            Defense: 70,\n            Heal: 65,\n            Special: 60,\n        };\n        const entries = Array.from(canonicalMap.entries()).map(([key, cards]) => {\n            const sortedCards = cards.slice().sort((a, b) => (b.version ?? 0) - (a.version ?? 0));\n            const primary = sortedCards[0];\n            const baseCost = primary.cost ?? 0;\n            const costScore = Math.max(40, 90 - Math.abs(baseCost - 2.5) * 18);\n            const tagScore = (primary.tags?.includes('Tempo') ? 14 : 0) +\n                (primary.tags?.includes('Shield') ? 8 : 0) +\n                (primary.tags?.includes('Heal') ? 8 : 0);\n            const score = (rarityScore[primary.rarity] ?? 120) +\n                (typeScore[primary.type] ?? 50) +\n                costScore +\n                tagScore +\n                (primary.version ?? 0);\n            return {\n                key,\n                cards: sortedCards,\n                prototype: primary,\n                remaining: Math.min(sortedCards.length, 3),\n                score,\n            };\n        }).filter(entry => entry.remaining > 0);\n        if (entries.length === 0) {\n            console.warn('[Deck] Cannot auto-build: no usable cards');\n            return { success: false, deckSize: state.playerDeck.length, missing: Math.max(0, 20 - state.playerDeck.length), reason: 'no-available-cards' };\n        }\n        const typeTargets = {\n            Attack: 10,\n            Defense: 6,\n            Heal: 2,\n            Special: 2,\n        };\n        const deck = [];\n        const duplicateCounts = new Map();\n        const typeCounts = new Map();\n        const legendaryCap = 1;\n        let legendaryCount = 0;\n        const performAdd = (entry) => {\n            if (entry.remaining <= 0)\n                return false;\n            const canonicalId = entry.key;\n            const currentCount = duplicateCounts.get(canonicalId) ?? 0;\n            if (currentCount >= 3) {\n                entry.remaining = 0;\n                return false;\n            }\n            const cardIndex = entry.cards.length - entry.remaining;\n            const card = entry.cards[cardIndex];\n            if (!card) {\n                entry.remaining = 0;\n                return false;\n            }\n            if (card.rarity === 'Legendary' && legendaryCount >= legendaryCap) {\n                entry.remaining = 0;\n                return false;\n            }\n            deck.push(card);\n            duplicateCounts.set(canonicalId, currentCount + 1);\n            entry.remaining -= 1;\n            typeCounts.set(card.type, (typeCounts.get(card.type) ?? 0) + 1);\n            if (card.rarity === 'Legendary') {\n                legendaryCount += 1;\n            }\n            return true;\n        };\n        const typeOrder = ['Attack', 'Defense', 'Heal', 'Special'];\n        typeOrder.forEach(type => {\n            const target = typeTargets[type] ?? 0;\n            let current = typeCounts.get(type) ?? 0;\n            if (target <= current)\n                return;\n            const candidates = entries\n                .filter(entry => entry.prototype.type === type && entry.remaining > 0)\n                .sort((a, b) => b.score - a.score);\n            for (const entry of candidates) {\n                while (deck.length < 20 && entry.remaining > 0 && current < target) {\n                    if (!performAdd(entry))\n                        break;\n                    current = typeCounts.get(type) ?? 0;\n                }\n                if (deck.length >= 20 || current >= target)\n                    break;\n            }\n        });\n        const sortedEntries = entries.sort((a, b) => b.score - a.score);\n        for (const entry of sortedEntries) {\n            while (deck.length < 20 && entry.remaining > 0) {\n                if (!performAdd(entry))\n                    break;\n            }\n            if (deck.length >= 20)\n                break;\n        }\n        if (deck.length === 0) {\n            console.warn('[Deck] Auto-build produced an empty deck');\n            return { success: false, deckSize: state.playerDeck.length, missing: Math.max(0, 20 - state.playerDeck.length), reason: 'selection-failed' };\n        }\n        const rarityOrder = {\n            Legendary: 3,\n            Epic: 2,\n            Rare: 1,\n            Normal: 0,\n        };\n        deck.sort((a, b) => {\n            const costDiff = (a.cost ?? 0) - (b.cost ?? 0);\n            if (costDiff !== 0)\n                return costDiff;\n            const rarityDiff = (rarityOrder[b.rarity] ?? 0) - (rarityOrder[a.rarity] ?? 0);\n            if (rarityDiff !== 0)\n                return rarityDiff;\n            return a.name.localeCompare(b.name);\n        });\n        set({ playerDeck: deck.slice(0, 20) });\n        scheduleDeckSave();\n        const missing = Math.max(0, 20 - deck.length);\n        return {\n            success: true,\n            deckSize: deck.length,\n            missing,\n            reason: missing > 0 ? 'insufficient-cards' : undefined,\n        };\n    },\n    getDeckValidity: () => {\n        const state = get();\n        const deck = state.playerDeck;\n        const errors = [];\n        //    ( 20)\n        if (deck.length < 20) {\n            errors.push(` ${20 - deck.length}  (${deck.length}/20)`);\n        }\n        else if (deck.length > 20) {\n            errors.push(` ${deck.length - 20}  (${deck.length}/20)`);\n        }\n        //   3  \n        const cardCounts = new Map();\n        deck.forEach(card => {\n            const canonicalId = normalizeCardId(card.id);\n            const count = cardCounts.get(canonicalId) || 0;\n            cardCounts.set(canonicalId, count + 1);\n        });\n        cardCounts.forEach((count, cardId) => {\n            if (count > 3) {\n                const card = deck.find(c => normalizeCardId(c.id) === cardId);\n                errors.push(`${card?.name || cardId}:    3 ( ${count})`);\n            }\n        });\n        // Legendary 1  \n        const legendaryCards = deck.filter(c => c.rarity === 'Legendary');\n        if (legendaryCards.length > 1) {\n            errors.push(`Legendary  1  ( ${legendaryCards.length})`);\n        }\n        return {\n            valid: errors.length === 0,\n            errors\n        };\n    },\n    //  \n    energy: 3,\n    enemyEnergy: 3,\n    round: 1,\n    roundSeed: Math.floor(Math.random() * 1000000),\n    playerDamageTakenThisTurn: 0,\n    playerDamageTakenLastTurn: 0,\n    enemyDamageTakenThisTurn: 0,\n    enemyDamageTakenLastTurn: 0,\n    skipEnemyTurnOnce: false,\n    skipPlayerTurnOnce: false,\n    playerHp: 100,\n    playerMaxHp: 100,\n    enemyHp: 100,\n    enemyMaxHp: 100,\n    playerStatus: { ...initialEntityStatus },\n    enemyStatus: { ...initialEntityStatus },\n    gameOver: 'none',\n    deck: [],\n    hand: [],\n    discard: [],\n    enemyDeck: [],\n    enemyHand: [],\n    enemyDiscard: [],\n    logs: [],\n    logIdCounter: 0,\n    declarationLocked: false,\n    isTurnProcessing: false,\n    playerQueue: [],\n    enemyQueue: [],\n    queuedHandIndices: [],\n    getPendingCost: () => get().playerQueue.reduce((sum, q) => sum + (q.card?.cost ?? 0), 0),\n    getRemainingEnergy: () => {\n        const s = get();\n        return Math.max(0, s.energy - s.playerQueue.reduce((sum, q) => sum + (q.card?.cost ?? 0), 0));\n    },\n    addLog: (message, type = 'system') => {\n        const state = get();\n        const entry = {\n            id: state.logIdCounter++,\n            message,\n            type,\n            timestamp: Date.now()\n        };\n        const newLogs = [...state.logs, entry].slice(-100); // Keep last 100 entries (20  100)\n        set({ logs: newLogs });\n    },\n    applyStatus: (target, key, stacks = 1, duration = 1, chance = 100, value = 0) => {\n        const state = get();\n        if (state.gameOver !== 'none')\n            return 0;\n        const status = target === 'player' ? state.playerStatus : state.enemyStatus;\n        //  :     \n        if (status.immuneKeywords.includes(key)) {\n            get().addLog(` ${target === 'player' ? '' : ''} : ${key}  `, 'effect');\n            return 0;\n        }\n        const isPvp = state.battleContext.type === 'pvp';\n        if (chance < 100) {\n            if (isPvp) {\n                const counter = state.pvpRandomCounter;\n                const roll = getSeededRandom(state.roundSeed, counter) * 100;\n                set({ pvpRandomCounter: counter + 1 });\n                if (roll >= chance) {\n                    get().addLog(`${target === 'player' ? '' : ''}   : ${key} (${chance}%)`, 'effect');\n                    return;\n                }\n            }\n            else if (Math.random() * 100 >= chance) {\n                get().addLog(`${target === 'player' ? '' : ''}   : ${key} (${chance}%)`, 'effect');\n                return;\n            }\n        }\n        const existingIndex = status.statuses.findIndex(s => s.key === key);\n        let newStatuses = [...status.statuses];\n        if (existingIndex >= 0) {\n            //       \n            const existing = { ...newStatuses[existingIndex] };\n            if (key === 'Burn') {\n                // Burn  ( 3)\n                existing.stacks = Math.min(3, (existing.stacks || 1) + (stacks || 1));\n                existing.duration = Math.max(existing.duration, duration);\n            }\n            else if (key === 'Bleed') {\n                const stackValue = Math.max(1, stacks || 1);\n                existing.stacks = Math.min(5, (existing.stacks || 0) + stackValue);\n                existing.duration = Math.max(existing.duration, duration);\n                existing.value = value || existing.value || 5;\n            }\n            else {\n                //    \n                existing.duration = Math.max(existing.duration, duration);\n                if (stacks)\n                    existing.stacks = stacks;\n                if (value)\n                    existing.value = value;\n            }\n            newStatuses[existingIndex] = existing;\n        }\n        else {\n            //   \n            const baseStacks = key === 'Bleed' ? Math.max(1, stacks || 1) : stacks;\n            const baseValue = key === 'Bleed' ? value || 5 : value;\n            newStatuses.push({ key, stacks: baseStacks, duration, chance, value: baseValue });\n        }\n        const newStatus = { ...status, statuses: newStatuses };\n        const regenEffect = newStatuses.find(s => s.key === 'Regen');\n        if (regenEffect) {\n            const regenValue = regenEffect.value ?? newStatus.regen ?? value ?? 0;\n            newStatus.regen = regenValue;\n            newStatus.regenDuration = regenEffect.duration ?? duration ?? newStatus.regenDuration;\n        }\n        else {\n            newStatus.regen = 0;\n            newStatus.regenDuration = 0;\n        }\n        // Vulnerable  \n        if (key === 'Vulnerable' && value > 0) {\n            newStatus.vulnerable = Math.max(newStatus.vulnerable, duration);\n        }\n        if (target === 'player') {\n            set({ playerStatus: newStatus });\n        }\n        else {\n            set({ enemyStatus: newStatus });\n        }\n        if (key === 'Root') {\n            newStatus.rootDuration = Math.max(newStatus.rootDuration, duration);\n            newStatus.evasionCharges = 0;\n            newStatus.evasionDuration = 0;\n        }\n        if (key === 'Mark') {\n            newStatus.markStacks = Math.max(1, stacks || 1);\n            newStatus.markDuration = Math.max(newStatus.markDuration, duration);\n            newStatus.markDamageAmp = value || newStatus.markDamageAmp || 20;\n        }\n        const statusName = {\n            Burn: '',\n            Bleed: '',\n            Freeze: '',\n            Shock: '',\n            Vulnerable: '',\n            Root: '',\n            Mark: '',\n            Regen: ' ',\n        };\n        get().addLog(`${target === 'player' ? '' : ''} : ${statusName[key] || key}${stacks && stacks > 1 ? ` (${stacks})` : ''} (${duration})`, 'effect');\n        triggerStatusVFX(key, target);\n    },\n    //  :      ()\n    _tickEntityStatus: (target, status) => {\n        const prefix = target === 'player' ? '' : ' ';\n        const newStatus = { ...status };\n        const newStatuses = [];\n        // 1) DoT/HoT    \n        for (const eff of status.statuses) {\n            if (eff.key === 'Burn' && eff.stacks) {\n                const damage = 10 * eff.stacks;\n                get().dealDamage(target, damage, false, true);\n                get().addLog(` ${prefix} : ${damage} (${eff.stacks}, ${eff.duration} )`, 'effect');\n                // VFX \n                triggerVFX('burn', target);\n            }\n            else if (eff.key === 'Bleed' && eff.stacks) {\n                const damagePerStack = (eff.value ?? status.bleedDamagePerStack) ?? 5;\n                const damage = Math.max(0, Math.floor(damagePerStack * eff.stacks));\n                if (damage > 0) {\n                    get().dealDamage(target, damage, false, true);\n                    get().addLog(` ${prefix} : ${damage} (${eff.stacks}, ${eff.duration} )`, 'effect');\n                    triggerVFX('damage', target);\n                }\n            }\n            else if (eff.key === 'Poison' && eff.value) {\n                const damage = eff.value;\n                get().dealDamage(target, damage, false, true);\n                get().addLog(` ${prefix} : ${damage} (${eff.duration} )`, 'effect');\n                // VFX \n                triggerVFX('vulnerable', target);\n            }\n            else if (eff.key === 'Regen') {\n                const healAmount = status.regen || eff.value || 0;\n                if (healAmount > 0) {\n                    get().heal(target, healAmount);\n                    get().addLog(` ${prefix} : +${healAmount}`, 'effect');\n                }\n            }\n            const newDuration = eff.duration - 1;\n            if (newDuration > 0) {\n                newStatuses.push({ ...eff, duration: newDuration });\n            }\n            else {\n                //   \n                get().addLog(`${prefix}${eff.key}  `, 'effect');\n            }\n        }\n        newStatus.statuses = newStatuses;\n        const regenStatus = newStatuses.find(s => s.key === 'Regen');\n        if (regenStatus) {\n            newStatus.regen = regenStatus.value ?? status.regen ?? 0;\n            newStatus.regenDuration = regenStatus.duration ?? status.regenDuration ?? 0;\n        }\n        else {\n            newStatus.regen = 0;\n            newStatus.regenDuration = 0;\n        }\n        // 2) Vulnerable \n        const vulnerableStatus = newStatuses.find(s => s.key === 'Vulnerable');\n        newStatus.vulnerable = vulnerableStatus ? vulnerableStatus.duration : 0;\n        const bleedStatus = newStatuses.find(s => s.key === 'Bleed');\n        if (bleedStatus) {\n            newStatus.bleedStacks = bleedStatus.stacks ?? 0;\n            newStatus.bleedDuration = bleedStatus.duration ?? 0;\n            const baseDamage = bleedStatus.value ?? newStatus.bleedDamagePerStack;\n            newStatus.bleedDamagePerStack = baseDamage && baseDamage > 0 ? baseDamage : 5;\n        }\n        else {\n            newStatus.bleedStacks = 0;\n            newStatus.bleedDuration = 0;\n            newStatus.bleedDamagePerStack = 0;\n        }\n        // 3) Guard duration \n        if (newStatus.guardDuration > 0) {\n            newStatus.guardDuration -= 1;\n            if (newStatus.guardDuration === 0 && newStatus.guard > 0) {\n                newStatus.guard = 0;\n                get().addLog(`${prefix}  `, 'effect');\n            }\n        }\n        // 4) Shield duration \n        if (newStatus.shieldDuration > 0) {\n            newStatus.shieldDuration -= 1;\n            if (newStatus.shieldDuration === 0 && newStatus.shield > 0) {\n                newStatus.shield = 0;\n                get().addLog(`${prefix}  `, 'effect');\n            }\n        }\n        // 5) Evasion duration \n        if (newStatus.evasionDuration > 0) {\n            newStatus.evasionDuration -= 1;\n            if (newStatus.evasionDuration === 0 && newStatus.evasionCharges > 0) {\n                newStatus.evasionCharges = 0;\n                get().addLog(`${prefix}  `, 'effect');\n            }\n        }\n        // 6) Counter duration \n        if (newStatus.counterDuration > 0) {\n            newStatus.counterDuration -= 1;\n            if (newStatus.counterDuration === 0) {\n                newStatus.counterValue = 0;\n                get().addLog(`${prefix}  `, 'effect');\n            }\n        }\n        // 7) Immune duration \n        if (newStatus.immuneDuration > 0) {\n            newStatus.immuneDuration -= 1;\n            if (newStatus.immuneDuration === 0) {\n                newStatus.immuneKeywords = [];\n                get().addLog(`${prefix}  `, 'effect');\n            }\n        }\n        if (newStatus.priorityBoostDuration > 0) {\n            newStatus.priorityBoostDuration -= 1;\n            if (newStatus.priorityBoostDuration === 0 && newStatus.priorityBoost !== 0) {\n                newStatus.priorityBoost = 0;\n                get().addLog(`${prefix}  `, 'effect');\n            }\n        }\n        if (newStatus.rootDuration > 0) {\n            newStatus.rootDuration -= 1;\n            if (newStatus.rootDuration === 0) {\n                get().addLog(`${prefix}  `, 'effect');\n            }\n        }\n        if (newStatus.markDuration > 0) {\n            newStatus.markDuration -= 1;\n            if (newStatus.markDuration === 0) {\n                newStatus.markStacks = 0;\n                newStatus.markDamageAmp = 0;\n                get().addLog(`${prefix}  `, 'effect');\n            }\n        }\n        if (newStatus.onHitStatuses.length > 0) {\n            const remaining = [];\n            newStatus.onHitStatuses.forEach(entry => {\n                const next = entry.turnsLeft - 1;\n                if (next > 0) {\n                    remaining.push({ ...entry, turnsLeft: next });\n                }\n                else {\n                    get().addLog(`${prefix}   `, 'effect');\n                }\n            });\n            newStatus.onHitStatuses = remaining;\n        }\n        // 8) Reactive Armor duration \n        if (newStatus.reactiveArmorDuration > 0) {\n            newStatus.reactiveArmorDuration -= 1;\n            if (newStatus.reactiveArmorDuration === 0 || newStatus.reactiveArmorCharges <= 0) {\n                if (newStatus.reactiveArmorCharges > 0) {\n                    newStatus.reactiveArmorCharges = 0;\n                }\n                newStatus.reactiveArmorReflectRatio = 0;\n                newStatus.reactiveArmorShieldRatio = 0;\n                get().addLog(`${prefix}   `, 'effect');\n            }\n        }\n        return newStatus;\n    },\n    processStatusEffects: (phase = 'both') => {\n        const state = get();\n        if (state.gameOver !== 'none')\n            return 0;\n        const tickPlayer = phase === 'both' || phase === 'enemyEnd';\n        const tickEnemy = phase === 'both' || phase === 'playerEnd';\n        const headerLabel = phase === 'playerEnd'\n            ? '   ( )'\n            : phase === 'enemyEnd'\n                ? '   ( )'\n                : '  ';\n        get().addLog(` ${headerLabel} `, 'system');\n        if (tickPlayer) {\n            const playerBurns = state.playerStatus.statuses.filter(s => s.key === 'Burn');\n            if (playerBurns.length > 0) {\n                get().addLog(`    Burn: ${playerBurns.map(b => `${b.stacks} ${b.duration}`).join(', ')}`, 'system');\n            }\n        }\n        if (tickEnemy) {\n            const enemyBurns = state.enemyStatus.statuses.filter(s => s.key === 'Burn');\n            if (enemyBurns.length > 0) {\n                get().addLog(`    Burn: ${enemyBurns.map(b => `${b.stacks} ${b.duration}`).join(', ')}`, 'system');\n            }\n        }\n        const updates = {};\n        if (tickPlayer) {\n            updates.playerStatus = get()._tickEntityStatus('player', state.playerStatus);\n        }\n        if (tickEnemy) {\n            updates.enemyStatus = get()._tickEntityStatus('enemy', state.enemyStatus);\n        }\n        if (Object.keys(updates).length > 0) {\n            set(updates);\n        }\n        const footerLabel = phase === 'playerEnd'\n            ? '   ( )'\n            : phase === 'enemyEnd'\n                ? '   ( )'\n                : '  ';\n        get().addLog(` ${footerLabel} `, 'system');\n    },\n    checkGameOver: () => {\n        const state = get();\n        console.log(`[CheckGameOver]  Called - playerHp: ${state.playerHp}, enemyHp: ${state.enemyHp}, gameOver: ${state.gameOver}, hand: ${state.hand.length}, enemyHand: ${state.enemyHand.length}`);\n        if (state.gameOver !== 'none') {\n            console.log(`[CheckGameOver]  Already over, skipping`);\n            return 0;\n        }\n        if (state.playerHp <= 0) {\n            console.log(`[CheckGameOver]  DEFEAT - playerHp: ${state.playerHp}, hand: ${state.hand.length}, enemyHand: ${state.enemyHand.length}`);\n            set({ gameOver: 'defeat' });\n            get().addLog('!  HP 0 .', 'system');\n            //  \n            const replay = get().exportReplay();\n            // console.log('=== GAME REPLAY (DEFEAT) ===');\n            // console.log(replay);\n            // VFX:  \n            triggerVFX('defeat', 'center');\n            if (state.battleContext.type === 'pvp') {\n                get().stopPvpTurnTimer(true);\n                void get().reportPvpResult('defeat');\n            }\n            if (state.battleContext.type === 'daily') {\n                set(current => ({\n                    dailyDungeon: { ...current.dailyDungeon, currentFloorId: null },\n                    currentDailyFloorId: null,\n                }));\n            }\n        }\n        else if (state.enemyHp <= 0) {\n            console.log(`[CheckGameOver]  VICTORY - enemyHp: ${state.enemyHp}`);\n            set({ gameOver: 'victory' });\n            get().addLog('!  HP 0 .', 'system');\n            //  \n            const replay = get().exportReplay();\n            // console.log('=== GAME REPLAY (VICTORY) ===');\n            // console.log(replay);\n            // VFX:  \n            triggerVFX('victory', 'center');\n            if (state.battleContext.type === 'pvp') {\n                get().stopPvpTurnTimer(true);\n                void get().reportPvpResult('victory');\n            }\n            // /   \n            //    main.ts showVictoryScreen \n            const context = state.battleContext;\n            if (context.type === 'campaign' && state.currentStage !== null) {\n                get().clearStage(state.currentStage);\n            }\n            else if (context.type === 'daily' && state.currentDailyFloorId !== null) {\n                get().completeDailyFloor(state.currentDailyFloorId);\n            }\n        }\n    },\n    dealDamage: (target, amount, skipGameOverCheck = false, disableReactive = false) => {\n        const state = get();\n        if (state.gameOver !== 'none')\n            return 0;\n        const opponent = target === 'player' ? 'enemy' : 'player';\n        const targetLabel = target === 'player' ? '' : '';\n        const opponentLabel = opponent === 'player' ? '' : '';\n        const getStatus = () => (target === 'player' ? get().playerStatus : get().enemyStatus);\n        const setStatus = (next) => {\n            if (target === 'player') {\n                set({ playerStatus: next });\n            }\n            else {\n                set({ enemyStatus: next });\n            }\n        };\n        let status = getStatus();\n        // Evasion () \n        if (status.evasionCharges > 0) {\n            const chargesLeft = status.evasionCharges - 1;\n            const newStatus = { ...status, evasionCharges: Math.max(0, chargesLeft) };\n            if (newStatus.evasionCharges === 0) {\n                newStatus.evasionDuration = 0;\n            }\n            setStatus(newStatus);\n            get().addLog(`${targetLabel} !   ( : ${Math.max(0, chargesLeft)})`, 'effect');\n            if (chargesLeft <= 0) {\n                get().addLog(`${targetLabel}  `, 'effect');\n            }\n            return 0;\n        }\n        let finalAmount = amount;\n        const hasVulnerable = status.vulnerable > 0 || status.statuses.some(s => s.key === 'Vulnerable' && s.duration > 0);\n        if (hasVulnerable) {\n            finalAmount = Math.floor(amount * 1.2);\n        }\n        const markActive = status.markDuration > 0 && status.markStacks > 0 && status.markDamageAmp > 0;\n        if (markActive) {\n            finalAmount = Math.floor(finalAmount * (1 + status.markDamageAmp / 100));\n        }\n        // Guard :  \n        if (status.guard > 0) {\n            finalAmount = Math.max(0, finalAmount - status.guard);\n        }\n        // Shield :     \n        const prevShield = status.shield;\n        let remainingShield = prevShield;\n        let hpDamage = finalAmount;\n        if (remainingShield > 0) {\n            if (finalAmount <= remainingShield) {\n                remainingShield -= finalAmount;\n                hpDamage = 0;\n            }\n            else {\n                hpDamage = finalAmount - remainingShield;\n                remainingShield = 0;\n            }\n            const newStatus = { ...status, shield: remainingShield };\n            setStatus(newStatus);\n            status = newStatus;\n            if (finalAmount > 0) {\n                get().addLog(`${targetLabel} : ${prevShield}  ${remainingShield}`, 'effect');\n            }\n        }\n        if (target === 'player') {\n            const newHp = Math.max(0, state.playerHp - hpDamage);\n            set({ playerHp: newHp });\n            const vulnerableText = hasVulnerable ? `  ${finalAmount} ( +20%)` : '';\n            const guardText = status.guard > 0 ? `  ${finalAmount} ( -${status.guard})` : '';\n            const shieldText = prevShield > 0 ? `  ${hpDamage} ( ${prevShield}${remainingShield})` : '';\n            get().addLog(` : ${hpDamage} (: ${amount}${vulnerableText}${guardText}${shieldText}) (HP: ${newHp}/${state.playerMaxHp})`, 'effect');\n            if (hpDamage > 0) {\n                triggerVFX('damage', 'player', hpDamage);\n            }\n            if (hpDamage > 0 && state.playerStatus.counterValue > 0) {\n                const counterDamage = state.playerStatus.counterValue;\n                get().addLog(`  !  ${counterDamage} `, 'effect');\n                get().dealDamage('enemy', counterDamage, true);\n            }\n        }\n        else {\n            const newHp = Math.max(0, state.enemyHp - hpDamage);\n            set({ enemyHp: newHp });\n            const vulnerableText = hasVulnerable ? `  ${finalAmount} ( +20%)` : '';\n            const guardText = status.guard > 0 ? `  ${finalAmount} ( -${status.guard})` : '';\n            const shieldText = prevShield > 0 ? `  ${hpDamage} ( ${prevShield}${remainingShield})` : '';\n            get().addLog(` : ${hpDamage} (: ${amount}${vulnerableText}${guardText}${shieldText}) (HP: ${newHp}/${state.enemyMaxHp})`, 'effect');\n            if (hpDamage > 0) {\n                triggerVFX('damage', 'enemy', hpDamage);\n            }\n            if (hpDamage > 0 && state.enemyStatus.counterValue > 0) {\n                const counterDamage = state.enemyStatus.counterValue;\n                get().addLog(`   !  ${counterDamage} `, 'effect');\n                get().dealDamage('player', counterDamage, true);\n            }\n        }\n        // Reactive Armor  (   )\n        if (!disableReactive && hpDamage > 0) {\n            status = getStatus();\n            if (status.reactiveArmorCharges > 0 && (status.reactiveArmorReflectRatio > 0 || status.reactiveArmorShieldRatio > 0)) {\n                const reflectRatio = Math.min(1, Math.max(0, status.reactiveArmorReflectRatio || 0));\n                const shieldRatio = Math.min(1, Math.max(0, status.reactiveArmorShieldRatio || 0));\n                const reflectDamage = Math.floor(hpDamage * reflectRatio);\n                const shieldGain = Math.floor(hpDamage * shieldRatio);\n                const chargesLeft = Math.max(0, status.reactiveArmorCharges - 1);\n                const updatedStatus = {\n                    ...status,\n                    reactiveArmorCharges: chargesLeft,\n                };\n                if (chargesLeft === 0 && updatedStatus.reactiveArmorDuration === 0) {\n                    updatedStatus.reactiveArmorReflectRatio = 0;\n                    updatedStatus.reactiveArmorShieldRatio = 0;\n                }\n                if (shieldGain > 0) {\n                    updatedStatus.shield = (updatedStatus.shield || 0) + shieldGain;\n                    updatedStatus.shieldDuration = Math.max(updatedStatus.shieldDuration, 1);\n                    get().addLog(`${targetLabel}  :  ${hpDamage}   +${shieldGain}`, 'effect');\n                }\n                setStatus(updatedStatus);\n                if (reflectDamage > 0) {\n                    get().addLog(`   ! ${opponentLabel} ${reflectDamage} `, 'effect');\n                    get().dealDamage(opponent, reflectDamage, true, true);\n                }\n            }\n        }\n        if (hpDamage > 0 && markActive) {\n            const updatedStatus = { ...getStatus() };\n            updatedStatus.markStacks = Math.max(0, updatedStatus.markStacks - 1);\n            if (updatedStatus.markStacks === 0) {\n                updatedStatus.markDuration = 0;\n                updatedStatus.markDamageAmp = 0;\n            }\n            setStatus(updatedStatus);\n            status = updatedStatus;\n        }\n        if (hpDamage > 0) {\n            const postStatus = getStatus();\n            if (postStatus.onHitStatuses.length > 0) {\n                const remaining = [];\n                postStatus.onHitStatuses.forEach(entry => {\n                    get().applyStatus(opponent, entry.status.key, entry.status.stacks ?? 1, entry.status.duration ?? 1, entry.status.chance ?? 100, entry.status.value ?? 0);\n                    const next = entry.turnsLeft - 1;\n                    if (next > 0) {\n                        remaining.push({ ...entry, turnsLeft: next });\n                    }\n                });\n                setStatus({ ...postStatus, onHitStatuses: remaining });\n            }\n        }\n        if (hpDamage > 0) {\n            if (target === 'player') {\n                const currentDamage = get().playerDamageTakenThisTurn;\n                set({ playerDamageTakenThisTurn: currentDamage + hpDamage });\n            }\n            else {\n                const currentDamage = get().enemyDamageTakenThisTurn;\n                set({ enemyDamageTakenThisTurn: currentDamage + hpDamage });\n            }\n        }\n        if (!skipGameOverCheck) {\n            get().checkGameOver();\n        }\n        return hpDamage;\n    },\n    heal: (target, amount) => {\n        const state = get();\n        if (target === 'player') {\n            const newHp = Math.min(state.playerMaxHp, state.playerHp + amount);\n            set({ playerHp: newHp });\n            get().addLog(` : ${amount} (HP: ${newHp}/${state.playerMaxHp})`, 'effect');\n            // VFX:  \n            triggerVFX('heal', 'player', amount);\n        }\n        else {\n            const newHp = Math.min(state.enemyMaxHp, state.enemyHp + amount);\n            set({ enemyHp: newHp });\n            get().addLog(` : ${amount} (HP: ${newHp}/${state.enemyMaxHp})`, 'effect');\n            triggerVFX('heal', 'enemy', amount);\n        }\n    },\n    initGame: (cards) => {\n        //  : playerDeck  (   )\n        const state = get();\n        console.log(`[InitGame]  Starting - BEFORE: playerHp: ${state.playerHp}, enemyHp: ${state.enemyHp}, gameOver: ${state.gameOver}, hand: ${state.hand.length}, enemyHand: ${state.enemyHand.length}`);\n        let deck = [...state.playerDeck];\n        // playerDeck  20   \n        if (deck.length !== 20) {\n            console.warn('[Battle] playerDeck is invalid, generating random deck');\n            deck = [...cards].sort(() => Math.random() - 0.5).slice(0, 20);\n        }\n        //  \n        deck = deck.sort(() => Math.random() - 0.5);\n        //  :  \n        const currentStage = state.currentStage;\n        let enemyDeck;\n        const isPvp = state.battleContext.type === 'pvp' && !!state.pvpMatch;\n        if (isPvp) {\n            enemyDeck = state.pvpMatch?.opponentDeckCards?.length ? [...state.pvpMatch.opponentDeckCards] : [];\n        }\n        else if (currentStage) {\n            enemyDeck = getEnemyDeckForStage(currentStage, cards, state.campaignStages);\n        }\n        else {\n            enemyDeck = getBasicEnemyDeck(cards);\n        }\n        const baseSeed = isPvp ? state.pvpMatch.seed : Math.floor(Math.random() * 1000000);\n        const initialSeed = isPvp ? generateRoundSeed(baseSeed, 1) : baseSeed;\n        //  setTimeout    (       )\n        if (enemyTurnTimer1 !== null) {\n            clearTimeout(enemyTurnTimer1);\n            enemyTurnTimer1 = null;\n            console.log('[Battle] Cleared enemyTurnTimer1');\n        }\n        if (enemyTurnTimer2 !== null) {\n            clearTimeout(enemyTurnTimer2);\n            enemyTurnTimer2 = null;\n            console.log('[Battle] Cleared enemyTurnTimer2');\n        }\n        if (enemyTurnTimer3 !== null) {\n            clearTimeout(enemyTurnTimer3);\n            enemyTurnTimer3 = null;\n            console.log('[Battle] Cleared enemyTurnTimer3');\n        }\n        if (endTurnTimer !== null) {\n            clearTimeout(endTurnTimer);\n            endTurnTimer = null;\n            console.log('[Battle] Cleared endTurnTimer');\n        }\n        //      ( )\n        if (handTrackingResetCallback) {\n            console.log('[Battle] Resetting hand tracking');\n            handTrackingResetCallback();\n        }\n        //      \n        set({\n            deck, discard: [],\n            enemyDeck, enemyDiscard: [],\n            hand: [], //    \n            enemyHand: [], //     \n            energy: 3, enemyEnergy: 3, round: 1,\n            roundSeed: initialSeed,\n            playerHp: 100, playerMaxHp: 100,\n            enemyHp: 100, enemyMaxHp: 100,\n            playerStatus: { ...initialEntityStatus },\n            enemyStatus: { ...initialEntityStatus },\n            gameOver: 'none',\n            logs: [], //    \n            logIdCounter: 0, //   ID   \n            declarationLocked: false,\n            isTurnProcessing: false,\n            playerQueue: [],\n            enemyQueue: [],\n            queuedHandIndices: [], //      \n            replayHistory: [], //   \n            pvpRandomCounter: 0,\n            pvpLastResolvedRound: 0,\n            pvpLocalSubmissionRound: null,\n            pvpRemoteSubmission: null,\n            pvpLocalReady: false,\n            pvpOpponentReady: false,\n            pvpTurnTimeLeft: isPvp ? (get().pvpTurnDuration || DEFAULT_PVP_TURN_DURATION) : null,\n            pvpTurnTimerActive: false,\n        });\n        const context = get().battleContext;\n        if (context.type === 'daily' && context.dailyFloorId !== null) {\n            const dailyState = get().dailyDungeon;\n            const floor = dailyState.floors.find(f => f.id === context.dailyFloorId);\n            if (floor) {\n                let playerEnergyBonus = 0;\n                let enemyEnergyBonus = 0;\n                let playerShieldBonus = 0;\n                let enemyShieldBonus = 0;\n                const ruleMessages = [];\n                floor.modifiers.forEach(mod => {\n                    switch (mod.type) {\n                        case 'playerEnergy':\n                            playerEnergyBonus += Number(mod.value) || 0;\n                            break;\n                        case 'enemyEnergy':\n                            enemyEnergyBonus += Number(mod.value) || 0;\n                            break;\n                        case 'playerShield':\n                            playerShieldBonus += Number(mod.value) || 0;\n                            break;\n                        case 'enemyShield':\n                            enemyShieldBonus += Number(mod.value) || 0;\n                            break;\n                        case 'rule':\n                            ruleMessages.push(String(mod.description));\n                            break;\n                    }\n                });\n                if (playerEnergyBonus !== 0) {\n                    set(state => ({ energy: Math.max(0, state.energy + playerEnergyBonus) }));\n                    get().addLog(`   :   +${playerEnergyBonus}`, 'system');\n                }\n                if (enemyEnergyBonus !== 0) {\n                    set(state => ({ enemyEnergy: Math.max(0, state.enemyEnergy + enemyEnergyBonus) }));\n                    get().addLog(`   :   +${enemyEnergyBonus}`, 'system');\n                }\n                if (playerShieldBonus > 0) {\n                    const status = get().playerStatus;\n                    set({ playerStatus: { ...status, shield: status.shield + playerShieldBonus } });\n                    get().addLog(`   :   +${playerShieldBonus}`, 'system');\n                }\n                if (enemyShieldBonus > 0) {\n                    const status = get().enemyStatus;\n                    set({ enemyStatus: { ...status, shield: status.shield + enemyShieldBonus } });\n                    get().addLog(`   :   +${enemyShieldBonus}`, 'system');\n                }\n                ruleMessages.forEach(message => {\n                    get().addLog(`  : ${message}`, 'system');\n                });\n            }\n        }\n        //   \n        const afterState = get();\n        console.log(`[InitGame]  After init - playerHp: ${afterState.playerHp}, enemyHp: ${afterState.enemyHp}, gameOver: ${afterState.gameOver}, hand: ${afterState.hand.length}, enemyHand: ${afterState.enemyHand.length}`);\n        get().addLog(`  -  : ${initialSeed}`, 'system');\n        //   : draw() hand []   5 \n        // console.log('[Battle] Starting initial draw(5)');\n        get().drawInitial(5);\n        get().enemyDrawInitial(5);\n        if (isPvp) {\n            get().addLog(` 5 .`, 'system');\n            get().startPvpTurnTimer(true);\n        }\n        else {\n            get().addLog(`   5 `, 'system');\n        }\n    },\n    declareCard: (handIndex) => {\n        const state = get();\n        if (state.gameOver !== 'none' || state.declarationLocked || state.isTurnProcessing)\n            return false;\n        if (state.battleContext.type === 'pvp' && state.pvpLocalSubmissionRound === state.round) {\n            return false;\n        }\n        const card = state.hand[handIndex];\n        if (!card)\n            return false;\n        //     handIndex \n        if (state.playerQueue.some(q => q.handIndex === handIndex)) {\n            return false;\n        }\n        //       \n        const remaining = get().getRemainingEnergy();\n        if (card.cost > remaining) {\n            get().addLog(` : ${card.name}   (: ${card.cost}, : ${remaining})`, 'system');\n            return false;\n        }\n        const queue = [...state.playerQueue, { handIndex, card }];\n        const queued = [...state.queuedHandIndices, handIndex];\n        set({ playerQueue: queue, queuedHandIndices: queued });\n        get().addLog(`: ${card.name} ( ${card.cost})`, 'system');\n        return true;\n    },\n    unDeclareCard: (handIndex) => {\n        const state = get();\n        const target = state.playerQueue.find(q => q.handIndex === handIndex);\n        if (!target)\n            return;\n        const nextQueue = state.playerQueue.filter(q => q.handIndex !== handIndex);\n        const nextQueued = state.queuedHandIndices.filter(i => i !== handIndex);\n        set({ playerQueue: nextQueue, queuedHandIndices: nextQueued });\n        get().addLog(` : ${target.card.name}`, 'system');\n    },\n    lockIn: () => {\n        const state = get();\n        if (state.gameOver !== 'none')\n            return;\n        set({ declarationLocked: true });\n        get().addLog(' ', 'system');\n    },\n    revealAndResolve: async () => {\n        const state = get();\n        if (state.gameOver !== 'none')\n            return;\n        if (!state.declarationLocked) {\n            get().addLog('  ', 'system');\n            return;\n        }\n        //   \n        const delay = (ms) => new Promise(resolve => window.setTimeout(resolve, ms));\n        //   \n        get().addLog(`  ${state.round} : ${state.roundSeed}`, 'system');\n        // : Special > Attack > Defense > Heal,   \n        const priorityMap = { Special: 3, Attack: 2, Defense: 1, Heal: 0 };\n        const priority = (t) => priorityMap[t] ?? 0;\n        const current = get();\n        //    hand  (handIndex   )\n        const pq = current.playerQueue.map(q => {\n            const handIdx = current.hand.findIndex(c => c.id === q.card.id);\n            return { who: 'player', card: q.card, handIndex: handIdx };\n        }).filter(q => q.handIndex >= 0); // hand   \n        const eq = current.enemyQueue.map(q => ({ who: 'enemy', card: q.card }));\n        //       \n        const playerPriorityBonus = Math.max(0, current.playerStatus.priorityBoost || 0);\n        const enemyPriorityBonus = Math.max(0, current.enemyStatus.priorityBoost || 0);\n        const combined = [...pq, ...eq].map((entry, idx) => ({\n            ...entry,\n            priority: priority(entry.card.type) +\n                (entry.who === 'player' ? playerPriorityBonus : enemyPriorityBonus),\n            originalIndex: idx\n        })).sort((a, b) => {\n            // 1:  \n            if (a.priority !== b.priority)\n                return b.priority - a.priority;\n            // 2:   \n            if (a.card.cost !== b.card.cost)\n                return b.card.cost - a.card.cost;\n            // 3:     ()\n            const seedA = (current.roundSeed + a.originalIndex) % 1000;\n            const seedB = (current.roundSeed + b.originalIndex) % 1000;\n            return seedB - seedA;\n        });\n        get().addLog(`: ${combined.length}   ( )`, 'system');\n        await delay(500); //    \n        //   \n        combined.forEach((entry, idx) => {\n            const typeLabel = { Special: '', Attack: '', Defense: '', Heal: '' }[entry.card.type] || entry.card.type;\n            const who = entry.who === 'player' ? '' : '';\n            get().addLog(`  ${idx + 1}: ${who} [${typeLabel}/${entry.card.cost}] ${entry.card.name}`, 'system');\n        });\n        await delay(300); //    \n        //    (forEach  for loop)\n        for (let idx = 0; idx < combined.length; idx++) {\n            const entry = combined[idx];\n            if (entry.who === 'player') {\n                //    hand  handIndex  (      )\n                const s = get();\n                const actualHandIndex = s.hand.findIndex(c => c.id === entry.card.id);\n                // playCard      \n                if (s.energy >= entry.card.cost && actualHandIndex >= 0) {\n                    get().addLog(`  : ${entry.card.name} ( ${entry.card.cost})`, 'card-play');\n                    //      (  )\n                    await triggerCardUseAnimation(entry.card, true, actualHandIndex);\n                    const success = get().playCard(actualHandIndex);\n                    if (!success) {\n                        get().addLog(`: ${entry.card.name}  `, 'system');\n                    }\n                    await delay(600); //     \n                }\n                else if (actualHandIndex < 0) {\n                    get().addLog(`: ${entry.card.name}()  `, 'system');\n                }\n                else {\n                    get().addLog(` : ${entry.card.name}   (: ${entry.card.cost}, : ${s.energy})`, 'system');\n                }\n            }\n            else {\n                const s = get();\n                if (s.enemyEnergy >= entry.card.cost) {\n                    get().addLog(`  : ${entry.card.name} ( ${entry.card.cost})`, 'card-play');\n                    //      ( handIndex -1)\n                    await triggerCardUseAnimation(entry.card, false, -1);\n                    get().playEnemyCard(entry.card);\n                    await delay(600); //     \n                }\n            }\n        }\n        // \n        await delay(300); //    \n        set({ declarationLocked: false, playerQueue: [], enemyQueue: [], queuedHandIndices: [] });\n        get().addLog(' / ', 'system');\n        //   \n        const finalState = get();\n        get().recordReplayAction({\n            round: finalState.round,\n            seed: finalState.roundSeed,\n            player: pq.map(p => ({ cardId: p.card.id, cardName: p.card.name })),\n            enemy: eq.map(e => ({ cardId: e.card.id, cardName: e.card.name })),\n            resultHp: { player: finalState.playerHp, enemy: finalState.enemyHp }\n        });\n    },\n    //    (hand []  )\n    drawInitial: (count) => {\n        console.log(`[DrawInitial]  drawInitial() called with count: ${count}, current hand: ${get().hand.length}`);\n        let { deck, discard } = get();\n        const hand = []; //   \n        const drawn = [];\n        let newDeck = [...deck];\n        let newDiscard = [...discard];\n        const maxHandSize = 10;\n        for (let i = 0; i < count && hand.length + drawn.length < maxHandSize; i++) {\n            if (newDeck.length === 0 && newDiscard.length > 0) {\n                newDeck = [...newDiscard].sort(() => Math.random() - 0.5);\n                newDiscard = [];\n                get().addLog(` : ${newDeck.length}`, 'system');\n            }\n            if (newDeck.length > 0) {\n                drawn.push(newDeck.shift());\n            }\n            else {\n                break;\n            }\n        }\n        const beforeHand = hand.length;\n        console.log(`[DrawInitial]  set() BEFORE - hand: ${beforeHand}, drawn: ${drawn.length}, newHand will be: ${beforeHand + drawn.length}`);\n        set({ deck: newDeck, hand: [...hand, ...drawn], discard: newDiscard });\n        const afterHand = get().hand.length;\n        console.log(`[DrawInitial]  set() AFTER - hand: ${afterHand}`);\n        if (drawn.length > 0) {\n            get().addLog(`: ${drawn.length}`, 'system');\n        }\n    },\n    draw: (count) => {\n        console.log(`[Draw]  draw() called with count: ${count}, current hand: ${get().hand.length}`);\n        let { deck, hand, discard } = get();\n        const drawn = [];\n        let newDeck = [...deck];\n        let newDiscard = [...discard];\n        const maxHandSize = 10;\n        for (let i = 0; i < count && hand.length + drawn.length < maxHandSize; i++) {\n            //   discard pile  \n            if (newDeck.length === 0 && newDiscard.length > 0) {\n                newDeck = [...newDiscard].sort(() => Math.random() - 0.5);\n                newDiscard = [];\n                get().addLog(` : ${newDeck.length}`, 'system');\n            }\n            if (newDeck.length > 0) {\n                drawn.push(newDeck.shift());\n            }\n            else {\n                //  discard   \n                break;\n            }\n        }\n        //     \n        const overflow = count - drawn.length;\n        if (overflow > 0 && newDeck.length > 0) {\n            const discarded = [];\n            for (let i = 0; i < overflow && newDeck.length > 0; i++) {\n                discarded.push(newDeck.shift());\n            }\n            newDiscard = [...newDiscard, ...discarded];\n            if (discarded.length > 0) {\n                get().addLog(`  : ${discarded.length} `, 'system');\n            }\n        }\n        //    set() \n        const beforeHand = hand.length;\n        console.log(`[Draw]  set() BEFORE - hand: ${beforeHand}, drawn: ${drawn.length}, newHand will be: ${beforeHand + drawn.length}`);\n        set({ deck: newDeck, hand: [...hand, ...drawn], discard: newDiscard });\n        const afterHand = get().hand.length;\n        console.log(`[Draw]  set() AFTER - hand: ${afterHand}`);\n        if (drawn.length > 0) {\n            get().addLog(`: ${drawn.length}`, 'system');\n            triggerVFX('draw', 'player', drawn.length);\n        }\n    },\n    //     (enemyHand []  )\n    enemyDrawInitial: (count) => {\n        let { enemyDeck, enemyDiscard } = get();\n        const enemyHand = []; //   \n        const drawn = [];\n        let newDeck = [...enemyDeck];\n        let newDiscard = [...enemyDiscard];\n        const maxHandSize = 10;\n        for (let i = 0; i < count && enemyHand.length + drawn.length < maxHandSize; i++) {\n            if (newDeck.length === 0 && newDiscard.length > 0) {\n                newDeck = [...newDiscard].sort(() => Math.random() - 0.5);\n                newDiscard = [];\n                get().addLog(`  : ${newDeck.length}`, 'system');\n            }\n            if (newDeck.length > 0) {\n                drawn.push(newDeck.shift());\n            }\n            else {\n                break;\n            }\n        }\n        const beforeEnemyHand = enemyHand.length;\n        console.log(`[EnemyDrawInitial]  set() BEFORE - enemyHand: ${beforeEnemyHand}, drawn: ${drawn.length}, newEnemyHand will be: ${beforeEnemyHand + drawn.length}`);\n        set({ enemyDeck: newDeck, enemyHand: [...enemyHand, ...drawn], enemyDiscard: newDiscard });\n        notifyEnemyHandUpdate();\n        notifyEnemyHandUpdate();\n        const afterEnemyHand = get().enemyHand.length;\n        console.log(`[EnemyDrawInitial]  set() AFTER - enemyHand: ${afterEnemyHand}`);\n        if (drawn.length > 0) {\n            get().addLog(` : ${drawn.length}`, 'system');\n            triggerVFX('draw', 'enemy', drawn.length);\n        }\n    },\n    enemyDraw: (count) => {\n        let { enemyDeck, enemyHand, enemyDiscard } = get();\n        const drawn = [];\n        let newDeck = [...enemyDeck];\n        let newDiscard = [...enemyDiscard];\n        const maxHandSize = 10;\n        for (let i = 0; i < count && enemyHand.length + drawn.length < maxHandSize; i++) {\n            //   discard pile  \n            if (newDeck.length === 0 && newDiscard.length > 0) {\n                newDeck = [...newDiscard].sort(() => Math.random() - 0.5);\n                newDiscard = [];\n                get().addLog(`  : ${newDeck.length}`, 'system');\n            }\n            if (newDeck.length > 0) {\n                drawn.push(newDeck.shift());\n            }\n            else {\n                //  discard   \n                break;\n            }\n        }\n        //     \n        const overflow = count - drawn.length;\n        if (overflow > 0 && newDeck.length > 0) {\n            const discarded = [];\n            for (let i = 0; i < overflow && newDeck.length > 0; i++) {\n                discarded.push(newDeck.shift());\n            }\n            newDiscard = [...newDiscard, ...discarded];\n            if (discarded.length > 0) {\n                get().addLog(`   : ${discarded.length} `, 'system');\n            }\n        }\n        //    set() \n        const beforeEnemyHand = enemyHand.length;\n        console.log(`[EnemyDraw]  set() BEFORE - enemyHand: ${beforeEnemyHand}, drawn: ${drawn.length}, newEnemyHand will be: ${beforeEnemyHand + drawn.length}`);\n        set({ enemyDeck: newDeck, enemyHand: [...enemyHand, ...drawn], enemyDiscard: newDiscard });\n        const afterEnemyHand = get().enemyHand.length;\n        console.log(`[EnemyDraw]  set() AFTER - enemyHand: ${afterEnemyHand}`);\n        if (drawn.length > 0) {\n            get().addLog(` : ${drawn.length}`, 'system');\n            triggerVFX('draw', 'enemy', drawn.length);\n        }\n    },\n    playCard: (handIndex) => {\n        const state = get();\n        if (state.gameOver !== 'none')\n            return false;\n        const card = state.hand[handIndex];\n        if (!card)\n            return false;\n        if (state.energy < card.cost)\n            return false;\n        // Nullify :     \n        if (state.enemyStatus.nullifyCharges > 0) {\n            const newEnergy = state.energy - card.cost;\n            const newHand = state.hand.filter((_, i) => i !== handIndex);\n            const newDiscard = [...state.discard, card];\n            const newEnemyStatus = { ...state.enemyStatus };\n            newEnemyStatus.nullifyCharges -= 1;\n            set({ energy: newEnergy, hand: newHand, discard: newDiscard, enemyStatus: newEnemyStatus });\n            get().addLog(` : ${card.name} ( ${card.cost})`, 'card-play');\n            get().addLog(` !     ( : ${newEnemyStatus.nullifyCharges})`, 'effect');\n            return true;\n        }\n        const newEnergy = state.energy - card.cost;\n        const newHand = state.hand.filter((_, i) => i !== handIndex);\n        const newDiscard = [...state.discard, card];\n        set({ energy: newEnergy, hand: newHand, discard: newDiscard });\n        get().addLog(` : ${card.name} ( ${card.cost})`, 'card-play');\n        // process effects\n        card.effects.forEach((eff, idx) => {\n            if (!eff)\n                return;\n            if (eff.type === 'Draw') {\n                const value = Number(eff.value ?? 0);\n                if (value > 0) {\n                    get().draw(value);\n                    get().addLog(`:  ${value}`, 'effect');\n                }\n            }\n            else if (eff.type === 'GainAction') {\n                const value = Number(eff.value ?? 0);\n                if (value > 0) {\n                    if (eff.delayed) {\n                        const turns = Math.max(1, Number(eff.delayTurns ?? 1));\n                        const playerStatus = { ...get().playerStatus };\n                        playerStatus.energyBoostPending = (playerStatus.energyBoostPending || 0) + value;\n                        playerStatus.energyBoostDuration = Math.max(playerStatus.energyBoostDuration, turns);\n                        set({ playerStatus });\n                        get().addLog(`   : ${turns}  +${value}`, 'effect');\n                        triggerVFX('buff', 'player', value);\n                    }\n                    else {\n                        set({ energy: get().energy + value });\n                        get().addLog(`:  +${value}`, 'effect');\n                        triggerVFX('energy', 'player', value);\n                    }\n                }\n            }\n            else if (eff.type === 'Damage') {\n                const value = Number(eff.value ?? 0);\n                const hits = Math.max(1, Number(eff.hits ?? 1));\n                const lifestealRatio = Math.min(1, Math.max(0, Number(eff.lifestealRatio ?? 0)));\n                if (value > 0) {\n                    //   \n                    let finalValue = value;\n                    if (card.type === 'Attack') {\n                        const attackBuff = state.playerStatus.attackBuff || 0;\n                        if (attackBuff > 0) {\n                            finalValue = Math.floor(value * (1 + attackBuff / 100));\n                        }\n                        //  (Shock) :     ()\n                        const currentState = get();\n                        const shockStacks = currentState.enemyStatus.shockStacks || 0;\n                        if (shockStacks > 0) {\n                            //   \n                            let procChance = 0;\n                            let damageRatio = 0;\n                            if (shockStacks >= 3) {\n                                procChance = 0.9; // 90%\n                                damageRatio = 0.5; // 50%  \n                            }\n                            else if (shockStacks === 2) {\n                                procChance = 0.6; // 60%\n                                damageRatio = 0.4; // 40%  \n                            }\n                            else {\n                                procChance = 0.3; // 30%\n                                damageRatio = 0.3; // 30%  \n                            }\n                            //     (roundSeed )\n                            const roll = ((currentState.roundSeed + finalValue + shockStacks) % 100) / 100;\n                            if (roll < procChance) {\n                                const chainDamage = Math.floor(finalValue * damageRatio);\n                                get().addLog(`  ! (${shockStacks}, ${Math.floor(procChance * 100)}% )  : ${chainDamage}`, 'effect');\n                                get().dealDamage('enemy', chainDamage, false);\n                                //   1 \n                                const updatedState = get();\n                                const newEnemyStatus = { ...updatedState.enemyStatus };\n                                newEnemyStatus.shockStacks = Math.max(0, shockStacks - 1);\n                                set({ enemyStatus: newEnemyStatus });\n                            }\n                            else {\n                                get().addLog(`   (${shockStacks}, ${Math.floor(procChance * 100)}% )`, 'effect');\n                            }\n                        }\n                    }\n                    // Attack cards damage enemy, others might vary\n                    //          Damage\n                    const remainingDamages = card.effects.slice(idx + 1).filter(e => e.type === 'Damage').length;\n                    const aoe = eff.aoe === true;\n                    if (hits > 1) {\n                        get().addLog(` : ${hits}`, 'effect');\n                    }\n                    const targetOverride = eff.target;\n                    for (let hitIndex = 0; hitIndex < hits; hitIndex++) {\n                        const totalRemaining = remainingDamages + (hits - hitIndex - 1);\n                        const skipGameOver = totalRemaining > 0;\n                        let dealt = 0;\n                        if (aoe) {\n                            dealt = get().dealDamage('enemy', finalValue, skipGameOver);\n                            get().addLog(` :  ${finalValue}`, 'effect');\n                        }\n                        else {\n                            let targetSide = card.type === 'Attack' ? 'enemy' : 'player';\n                            if (targetOverride === 'player' || targetOverride === 'enemy') {\n                                targetSide = targetOverride;\n                            }\n                            dealt = get().dealDamage(targetSide, finalValue, skipGameOver);\n                        }\n                        if (lifestealRatio > 0 && card.type === 'Attack' && dealt > 0) {\n                            const healAmount = Math.floor(dealt * lifestealRatio);\n                            if (healAmount > 0) {\n                                get().heal('player', healAmount);\n                                get().addLog(` : +${healAmount}`, 'effect');\n                            }\n                        }\n                    }\n                }\n            }\n            else if (eff.type === 'Heal') {\n                const value = Number(eff.value ?? 0);\n                const aoe = eff.aoe === true;\n                const overflowToShield = eff.overflowToShield === true;\n                if (value > 0) {\n                    if (aoe) {\n                        //  :    (  )\n                        get().heal('player', value);\n                        get().heal('enemy', value);\n                        get().addLog(` :   ${value}`, 'effect');\n                    }\n                    else if (overflowToShield) {\n                        const currentState = get();\n                        const currentHp = currentState.playerHp;\n                        const maxHp = currentState.playerMaxHp;\n                        const missing = Math.max(0, maxHp - currentHp);\n                        const healAmount = Math.min(value, missing);\n                        const overflow = Math.max(0, value - healAmount);\n                        if (healAmount > 0) {\n                            get().heal('player', healAmount);\n                        }\n                        if (overflow > 0) {\n                            const playerStatus = { ...currentState.playerStatus };\n                            playerStatus.shield = (playerStatus.shield || 0) + overflow;\n                            playerStatus.shieldDuration = Math.max(playerStatus.shieldDuration, 2);\n                            set({ playerStatus });\n                            get().addLog(`  : +${overflow} ( ${playerStatus.shield})`, 'effect');\n                        }\n                        if (healAmount === 0 && overflow === 0) {\n                            get().addLog(`   HP     `, 'effect');\n                        }\n                    }\n                    else {\n                        get().heal('player', value);\n                    }\n                }\n            }\n            else if (eff.type === 'ApplyBleed') {\n                const stacks = Math.max(1, Number(eff.stacks ?? 1));\n                const duration = Math.max(1, Number(eff.duration ?? 2));\n                const damagePerStack = Math.max(1, Number(eff.damagePerStack ?? 5));\n                get().applyStatus('enemy', 'Bleed', stacks, duration, 100, damagePerStack);\n                get().addLog(` : ${stacks} / ${duration} ( ${damagePerStack})`, 'effect');\n                triggerVFX('damage', 'enemy', stacks);\n            }\n            else if (eff.type === 'ReactiveArmor') {\n                const charges = Math.max(1, Number(eff.charges ?? 1));\n                const reflectRatio = Math.min(1, Math.max(0, Number(eff.reflectRatio ?? 0.3)));\n                const shieldRatio = Math.min(1, Math.max(0, Number(eff.shieldRatio ?? 0)));\n                const duration = Math.max(0, Number(eff.duration ?? charges));\n                const playerStatus = { ...get().playerStatus };\n                playerStatus.reactiveArmorCharges = charges;\n                playerStatus.reactiveArmorReflectRatio = reflectRatio;\n                playerStatus.reactiveArmorShieldRatio = shieldRatio;\n                playerStatus.reactiveArmorDuration = duration;\n                set({ playerStatus });\n                const reflectPct = Math.round(reflectRatio * 100);\n                const shieldPct = Math.round(shieldRatio * 100);\n                get().addLog(`  : ${charges} ( ${reflectPct}%,   ${shieldPct}%)`, 'effect');\n                triggerVFX('shield', 'player', charges);\n            }\n            else if (eff.type === 'TempoBoost') {\n                const amount = Number(eff.amount ?? 0);\n                const turns = Math.max(1, Number(eff.turns ?? 1));\n                if (amount > 0) {\n                    const playerStatus = { ...get().playerStatus };\n                    playerStatus.energyBoostPending = (playerStatus.energyBoostPending || 0) + amount;\n                    playerStatus.energyBoostDuration = Math.max(playerStatus.energyBoostDuration, turns);\n                    set({ playerStatus });\n                    get().addLog(` :  ${turns}   +${amount}`, 'effect');\n                    triggerVFX('energy', 'player', amount);\n                }\n            }\n            else if (eff.type === 'ArmorBreak') {\n                const guardBreak = Math.max(0, Number(eff.guard ?? 0));\n                const shieldBreak = Math.max(0, Number(eff.shield ?? 0));\n                const enemyStatus = { ...get().enemyStatus };\n                if (guardBreak > 0 && enemyStatus.guard > 0) {\n                    const prevGuard = enemyStatus.guard;\n                    enemyStatus.guard = Math.max(0, enemyStatus.guard - guardBreak);\n                    if (enemyStatus.guard === 0) {\n                        enemyStatus.guardDuration = 0;\n                    }\n                    get().addLog(`  : ${prevGuard}  ${enemyStatus.guard}`, 'effect');\n                }\n                if (shieldBreak > 0 && enemyStatus.shield > 0) {\n                    const prevShield = enemyStatus.shield;\n                    enemyStatus.shield = Math.max(0, enemyStatus.shield - shieldBreak);\n                    if (enemyStatus.shield === 0) {\n                        enemyStatus.shieldDuration = 0;\n                    }\n                    get().addLog(`  : ${prevShield}  ${enemyStatus.shield}`, 'effect');\n                }\n                set({ enemyStatus });\n                if (guardBreak > 0 || shieldBreak > 0) {\n                    triggerVFX('vulnerable', 'enemy', guardBreak + shieldBreak);\n                }\n            }\n            else if (eff.type === 'UndoDamage') {\n                const percent = Math.max(0, Math.min(100, Number(eff.percent ?? 0)));\n                if (percent > 0) {\n                    const target = eff.target ?? 'player';\n                    const lastDamage = target === 'player' ? get().playerDamageTakenLastTurn : get().enemyDamageTakenLastTurn;\n                    const maxRecover = eff.max ? Math.max(0, Number(eff.max)) : undefined;\n                    if (lastDamage > 0) {\n                        const rawAmount = Math.floor((lastDamage * percent) / 100);\n                        const amount = maxRecover !== undefined ? Math.min(rawAmount, maxRecover) : rawAmount;\n                        if (amount > 0) {\n                            get().heal(target, amount);\n                            get().addLog(`    : ${target === 'player' ? '' : ''} +${amount}`, 'effect');\n                        }\n                    }\n                    else {\n                        get().addLog(`      `, 'effect');\n                    }\n                }\n            }\n            else if (eff.type === 'OnHitStatus') {\n                const playerStatus = { ...get().playerStatus };\n                const entry = {\n                    status: {\n                        key: eff.status.key,\n                        stacks: eff.status.stacks,\n                        duration: eff.status.duration ?? 1,\n                        chance: eff.status.chance,\n                    },\n                    turnsLeft: Math.max(1, eff.duration),\n                };\n                if (typeof eff.status.value === 'number') {\n                    entry.status.value = eff.status.value;\n                }\n                playerStatus.onHitStatuses = [...(playerStatus.onHitStatuses || []), entry];\n                set({ playerStatus });\n                get().addLog(`   :  ${eff.status.key}  (${eff.duration})`, 'effect');\n                triggerVFX('buff', 'player', entry.status.stacks ?? 1);\n            }\n            else if (eff.type === 'StealCard') {\n                const count = Math.max(1, Number(eff.count ?? 1));\n                const fromHand = eff.from === 'opponentHand';\n                const enemyHand = [...get().enemyHand];\n                const enemyDeck = [...get().enemyDeck];\n                const acquired = [];\n                const source = fromHand ? enemyHand : enemyDeck;\n                if (source.length === 0) {\n                    get().addLog(`  `, 'effect');\n                }\n                else {\n                    const resolvedFilter = eff.filter ?? 'random';\n                    const pickCard = () => {\n                        if (resolvedFilter === 'lowestCost') {\n                            return source.reduce((acc, curr) => (curr.cost < acc.cost ? curr : acc), source[0]);\n                        }\n                        if (resolvedFilter === 'highestCost') {\n                            return source.reduce((acc, curr) => (curr.cost > acc.cost ? curr : acc), source[0]);\n                        }\n                        return source[Math.floor(Math.random() * source.length)];\n                    };\n                    for (let i = 0; i < count && source.length > 0; i++) {\n                        const picked = pickCard();\n                        const index = source.findIndex(c => c === picked);\n                        if (index >= 0) {\n                            source.splice(index, 1);\n                            acquired.push({ ...picked });\n                        }\n                    }\n                    if (fromHand) {\n                        set({ enemyHand: source });\n                    }\n                    else {\n                        set({ enemyDeck: source });\n                    }\n                    if (acquired.length > 0) {\n                        const currentHand = get().hand;\n                        const newHand = [...currentHand, ...acquired.map(card => ({ ...card }))].slice(0, 10);\n                        set({ hand: newHand });\n                        get().addLog(`  : ${acquired.map(c => c.name).join(', ')}`, 'effect');\n                        triggerVFX('draw', 'player', acquired.length);\n                    }\n                }\n            }\n            else if (eff.type === 'TurnSkip') {\n                const chance = Math.max(0, Math.min(100, Number(eff.chance ?? 0)));\n                const roll = Math.random() * 100;\n                if (roll < chance) {\n                    set({ skipEnemyTurnOnce: true });\n                    get().addLog(`    ! ( ${chance}% )`, 'effect');\n                    triggerVFX('freeze', 'enemy', chance);\n                }\n                else {\n                    get().addLog(`   ( ${chance}%)`, 'effect');\n                }\n            }\n            else if (eff.type === 'Summon') {\n                get().addLog(`     . (  )`, 'effect');\n            }\n            else if (eff.type === 'ApplyStatus') {\n                const key = eff.key;\n                const stacks = Number(eff.stacks ?? 1);\n                const duration = Number(eff.duration ?? 2);\n                const chance = Number(eff.chance ?? 100);\n                const target = eff.target ??\n                    (card.type === 'Attack' ? 'enemy' : 'player');\n                get().applyStatus(target, key, stacks, duration, chance);\n                // Shock  shockStacks \n                if (key === 'Shock' && target === 'enemy') {\n                    const currentState = get();\n                    const enemyStatus = { ...currentState.enemyStatus };\n                    enemyStatus.shockStacks = (enemyStatus.shockStacks || 0) + stacks;\n                    set({ enemyStatus });\n                }\n            }\n            else if (eff.type === 'Shield') {\n                const value = Number(eff.value ?? 0);\n                const duration = Number(eff.duration ?? 1);\n                if (value > 0) {\n                    const playerStatus = { ...state.playerStatus };\n                    playerStatus.shield = (playerStatus.shield || 0) + value;\n                    playerStatus.shieldDuration = Math.max(playerStatus.shieldDuration, duration);\n                    set({ playerStatus });\n                    get().addLog(`: +${value} (: ${playerStatus.shield}, ${playerStatus.shieldDuration})`, 'effect');\n                    triggerVFX('shield', 'player', value);\n                }\n            }\n            else if (eff.type === 'Guard') {\n                const value = Number(eff.value ?? 0);\n                const duration = Number(eff.duration ?? 1);\n                if (value > 0) {\n                    const playerStatus = { ...state.playerStatus };\n                    playerStatus.guard = value;\n                    playerStatus.guardDuration = duration;\n                    set({ playerStatus });\n                    get().addLog(`: ${value} ( , ${duration})`, 'effect');\n                    triggerVFX('shield', 'player', value);\n                }\n            }\n            else if (eff.type === 'Vulnerable') {\n                const value = Number(eff.value ?? 0);\n                const duration = Number(eff.duration ?? 1);\n                if (value > 0) {\n                    // Attack    \n                    get().applyStatus('enemy', 'Vulnerable', 1, duration, 100, value);\n                }\n            }\n            else if (eff.type === 'Buff') {\n                const stat = eff.stat;\n                const value = Number(eff.value ?? 0);\n                const duration = Number(eff.duration ?? 1);\n                if (value > 0 && stat === 'attack') {\n                    const playerStatus = { ...state.playerStatus };\n                    playerStatus.attackBuff = value;\n                    set({ playerStatus });\n                    get().addLog(` : +${value}% (${duration})`, 'effect');\n                    // duration      \n                    triggerVFX('buff', 'player', value);\n                }\n            }\n            else if (eff.type === 'Regen') {\n                const value = Number(eff.value ?? 0);\n                const duration = Number(eff.duration ?? 3);\n                if (value > 0) {\n                    const playerStatus = { ...state.playerStatus };\n                    playerStatus.regen = value;\n                    playerStatus.regenDuration = duration;\n                    set({ playerStatus });\n                    get().applyStatus('player', 'Regen', 1, duration, 100, value);\n                    get().addLog(` :    ${value}  (${duration})`, 'effect');\n                }\n            }\n            else if (eff.type === 'Cleanse') {\n                const maxStacks = Number(eff.maxStacks ?? 2);\n                const playerStatus = { ...state.playerStatus };\n                const removed = playerStatus.statuses.filter(s => s.key === 'Burn' && (s.stacks || 0) <= maxStacks);\n                playerStatus.statuses = playerStatus.statuses.filter(s => !(s.key === 'Burn' && (s.stacks || 0) <= maxStacks));\n                set({ playerStatus });\n                if (removed.length > 0) {\n                    get().addLog(`:  ${removed.reduce((sum, s) => sum + (s.stacks || 0), 0)} `, 'effect');\n                    triggerVFX('buff', 'player', removed.length);\n                }\n            }\n            else if (eff.type === 'PriorityBoost') {\n                const value = Number(eff.value ?? 0);\n                const duration = Number(eff.duration ?? 1);\n                if (value > 0) {\n                    const playerStatus = { ...state.playerStatus };\n                    playerStatus.priorityBoost = (playerStatus.priorityBoost || 0) + value;\n                    playerStatus.priorityBoostDuration = Math.max(playerStatus.priorityBoostDuration || 0, duration);\n                    set({ playerStatus });\n                    get().addLog(` : +${value} (${duration})`, 'effect');\n                    triggerVFX('buff', 'player', value);\n                }\n            }\n            else if (eff.type === 'Silence') {\n                const duration = Number(eff.duration ?? 1);\n                // :      ( ,  )\n                get().addLog(`:   ${duration}   `, 'effect');\n                triggerVFX('shock', 'enemy', duration);\n            }\n            else if (eff.type === 'Nullify') {\n                const times = Number(eff.times ?? 1);\n                if (times > 0) {\n                    const playerStatus = { ...state.playerStatus };\n                    playerStatus.nullifyCharges = (playerStatus.nullifyCharges || 0) + times;\n                    set({ playerStatus });\n                    get().addLog(`:   ${times}   `, 'effect');\n                    triggerVFX('shield', 'player', times);\n                }\n            }\n            else if (eff.type === 'Counter') {\n                const value = Number(eff.value ?? 0);\n                const duration = Number(eff.duration ?? 1);\n                if (value > 0) {\n                    const playerStatus = { ...state.playerStatus };\n                    playerStatus.counterValue = value;\n                    playerStatus.counterDuration = duration;\n                    set({ playerStatus });\n                    get().addLog(`:   ${value}   (${duration})`, 'effect');\n                    triggerVFX('buff', 'player', value);\n                }\n            }\n            else if (eff.type === 'Evasion') {\n                const value = Number(eff.value ?? 100); //   (%)\n                const charges = Number(eff.charges ?? 1);\n                const duration = Number(eff.duration ?? 1);\n                if (charges > 0) {\n                    const playerStatus = { ...state.playerStatus };\n                    playerStatus.evasionCharges = (playerStatus.evasionCharges || 0) + charges;\n                    playerStatus.evasionDuration = Math.max(playerStatus.evasionDuration, duration);\n                    set({ playerStatus });\n                    get().addLog(`: ${charges}    (${playerStatus.evasionDuration})`, 'effect');\n                    triggerVFX('buff', 'player', charges);\n                }\n            }\n            else if (eff.type === 'Immune') {\n                const keywords = eff.keywords || [];\n                const duration = Number(eff.duration ?? 1);\n                if (keywords.length > 0) {\n                    const playerStatus = { ...state.playerStatus };\n                    playerStatus.immuneKeywords = [...new Set([...playerStatus.immuneKeywords, ...keywords])];\n                    playerStatus.immuneDuration = Math.max(playerStatus.immuneDuration, duration);\n                    set({ playerStatus });\n                    get().addLog(` : ${keywords.join(', ')}   (${duration})`, 'effect');\n                    triggerVFX('shield', 'player', keywords.length);\n                }\n            }\n            else if (eff.type === 'Chain') {\n                // Chain :  Damage   ratio   \n                const targets = Number(eff.targets ?? 2);\n                const ratio = Number(eff.ratio ?? 0.5);\n                //    Damage  \n                let chainDamage = 0;\n                for (let i = idx - 1; i >= 0; i--) {\n                    const prevEff = card.effects[i];\n                    if (prevEff.type === 'Damage') {\n                        const prevDamage = Number(prevEff.value ?? 0);\n                        if (prevDamage > 0) {\n                            //    ()\n                            let prevFinalValue = prevDamage;\n                            if (card.type === 'Attack') {\n                                const currentState = get();\n                                const attackBuff = currentState.playerStatus.attackBuff || 0;\n                                if (attackBuff > 0) {\n                                    prevFinalValue = Math.floor(prevDamage * (1 + attackBuff / 100));\n                                }\n                            }\n                            chainDamage = Math.floor(prevFinalValue * ratio);\n                            break;\n                        }\n                    }\n                }\n                if (chainDamage > 0) {\n                    // Chain   (    ,   )\n                    for (let t = 0; t < targets; t++) {\n                        get().dealDamage('enemy', chainDamage, t < targets - 1);\n                    }\n                    get().addLog(` :   ${chainDamage}  ${targets}`, 'effect');\n                }\n                else {\n                    get().addLog(` :   `, 'effect');\n                }\n            }\n            else if (eff.type === 'Conditional') {\n                //   \n                const condition = eff.if;\n                let conditionMet = false;\n                if (condition.includes('targetHp<=')) {\n                    // HP   (: \"targetHp<=30%\")\n                    const match = condition.match(/targetHp<=(\\d+)%/);\n                    if (match) {\n                        const threshold = Number(match[1]);\n                        const currentState = get();\n                        const targetHp = card.type === 'Attack' ? currentState.enemyHp : currentState.playerHp;\n                        const targetMaxHp = card.type === 'Attack' ? currentState.enemyMaxHp : currentState.playerMaxHp;\n                        const hpPercent = (targetHp / targetMaxHp) * 100;\n                        conditionMet = hpPercent <= threshold;\n                    }\n                }\n                if (conditionMet) {\n                    get().addLog(` !   `, 'effect');\n                    // then   \n                    eff.then.forEach((thenEff) => {\n                        //     card.effects \n                        const originalEffects = card.effects;\n                        card.effects = [thenEff];\n                        //     \n                        if (thenEff.type === 'Damage') {\n                            const value = Number(thenEff.value ?? 0);\n                            if (value > 0) {\n                                let finalValue = value;\n                                if (card.type === 'Attack') {\n                                    const currentState = get();\n                                    const attackBuff = currentState.playerStatus.attackBuff || 0;\n                                    if (attackBuff > 0) {\n                                        finalValue = Math.floor(value * (1 + attackBuff / 100));\n                                    }\n                                }\n                                get().dealDamage(card.type === 'Attack' ? 'enemy' : 'player', finalValue, false);\n                                get().addLog(` : ${finalValue}`, 'effect');\n                            }\n                        }\n                        else if (thenEff.type === 'Heal') {\n                            const value = Number(thenEff.value ?? 0);\n                            if (value > 0) {\n                                get().heal('player', value);\n                                get().addLog(` : ${value}`, 'effect');\n                            }\n                        }\n                        card.effects = originalEffects;\n                    });\n                }\n                else {\n                    get().addLog(` : ${condition}`, 'effect');\n                }\n            }\n            else if (eff.type === 'DuplicateNext') {\n                //    \n                const typeFilter = eff.typeFilter;\n                const times = Number(eff.times ?? 1);\n                const playerStatus = { ...state.playerStatus };\n                playerStatus.nextCardDuplicate = { typeFilter, times };\n                set({ playerStatus });\n                get().addLog(` ${typeFilter || ''} ${times + 1}  `, 'effect');\n            }\n            else if (eff.type === 'CopyCard') {\n                //   \n                const from = eff.from; // \"deck\"\n                const filter = eff.filter; // \"type:Attack\"\n                const to = eff.to; // \"hand\"\n                if (from === 'deck' && to === 'hand') {\n                    const currentState = get();\n                    let sourceDeck = currentState.deck;\n                    //  \n                    if (filter && filter.includes('type:')) {\n                        const cardType = filter.split(':')[1];\n                        sourceDeck = sourceDeck.filter(c => c.type === cardType);\n                    }\n                    if (sourceDeck.length > 0) {\n                        //   \n                        const randomIndex = Math.floor((currentState.roundSeed + idx) % sourceDeck.length);\n                        const copiedCard = sourceDeck[randomIndex];\n                        //    \n                        const newDeck = currentState.deck.filter(c => c.id !== copiedCard.id);\n                        const newHand = [...currentState.hand, copiedCard];\n                        set({ deck: newDeck, hand: newHand });\n                        get().addLog(` \"${copiedCard.name}\"   `, 'effect');\n                    }\n                    else {\n                        get().addLog(` :     `, 'effect');\n                    }\n                }\n            }\n            else if (eff.type === 'TransferHp') {\n                // HP \n                const value = Number(eff.value ?? 0);\n                const from = eff.from;\n                const to = eff.to;\n                if (value > 0) {\n                    const currentState = get();\n                    let fromHp = from === 'player' ? currentState.playerHp : currentState.enemyHp;\n                    let toHp = to === 'player' ? currentState.playerHp : currentState.enemyHp;\n                    let toMaxHp = to === 'player' ? currentState.playerMaxHp : currentState.enemyMaxHp;\n                    //  HP  (    HP)\n                    const transferAmount = Math.min(value, fromHp);\n                    if (transferAmount > 0) {\n                        // from HP \n                        if (from === 'player') {\n                            set({ playerHp: Math.max(0, currentState.playerHp - transferAmount) });\n                        }\n                        else {\n                            set({ enemyHp: Math.max(0, currentState.enemyHp - transferAmount) });\n                        }\n                        // to HP \n                        if (to === 'player') {\n                            set({ playerHp: Math.min(currentState.playerMaxHp, currentState.playerHp + transferAmount) });\n                        }\n                        else {\n                            set({ enemyHp: Math.min(currentState.enemyMaxHp, currentState.enemyHp + transferAmount) });\n                        }\n                        get().addLog(`HP : ${from} ${to} ${transferAmount} `, 'effect');\n                    }\n                }\n            }\n            else if (eff.type === 'Revive') {\n                //  \n                const value = Number(eff.value ?? 0);\n                const chance = Number(eff.chance ?? 30);\n                const currentState = get();\n                if (currentState.playerHp <= 0) {\n                    //  \n                    const roll = ((currentState.roundSeed + idx) % 100);\n                    if (roll < chance) {\n                        set({ playerHp: value });\n                        get().addLog(` ! HP ${value} `, 'effect');\n                    }\n                    else {\n                        get().addLog(`  (${chance}% )`, 'effect');\n                    }\n                }\n                else {\n                    get().addLog(` :  `, 'effect');\n                }\n            }\n            else if (eff.type === 'ElementShift') {\n                //   ( ,     )\n                const from = eff.from;\n                const to = eff.to;\n                const duration = Number(eff.duration ?? 1);\n                get().addLog(` : ${from}  ${to} (${duration})`, 'effect');\n            }\n        });\n        // DuplicateNext  :     \n        if (state.playerStatus.nextCardDuplicate) {\n            const duplicate = state.playerStatus.nextCardDuplicate;\n            const shouldDuplicate = !duplicate.typeFilter || card.type === duplicate.typeFilter;\n            if (shouldDuplicate) {\n                //   \n                for (let i = 0; i < duplicate.times; i++) {\n                    get().addLog(` : \"${card.name}\"   (${i + 1}/${duplicate.times})`, 'effect');\n                    //   \n                    card.effects.forEach((dupEff) => {\n                        if (dupEff.type === 'Damage') {\n                            const value = Number(dupEff.value ?? 0);\n                            if (value > 0) {\n                                let finalValue = value;\n                                const currentState = get();\n                                if (card.type === 'Attack') {\n                                    const attackBuff = currentState.playerStatus.attackBuff || 0;\n                                    if (attackBuff > 0) {\n                                        finalValue = Math.floor(value * (1 + attackBuff / 100));\n                                    }\n                                }\n                                get().dealDamage(card.type === 'Attack' ? 'enemy' : 'player', finalValue, false);\n                            }\n                        }\n                        else if (dupEff.type === 'Heal') {\n                            const value = Number(dupEff.value ?? 0);\n                            if (value > 0) {\n                                get().heal('player', value);\n                            }\n                        }\n                        else if (dupEff.type === 'ApplyStatus') {\n                            const key = dupEff.key;\n                            const stacks = Number(dupEff.stacks ?? 1);\n                            const duration = Number(dupEff.duration ?? 2);\n                            const chance = Number(dupEff.chance ?? 100);\n                            const target = card.type === 'Attack' ? 'enemy' : 'player';\n                            get().applyStatus(target, key, stacks, duration, chance);\n                        }\n                    });\n                }\n                //   \n                const updatedState = get();\n                const newPlayerStatus = { ...updatedState.playerStatus };\n                newPlayerStatus.nextCardDuplicate = undefined;\n                set({ playerStatus: newPlayerStatus });\n            }\n        }\n        return true;\n    },\n    playEnemyCard: (card) => {\n        const state = get();\n        if (state.gameOver !== 'none')\n            return false;\n        if (state.enemyEnergy < card.cost)\n            return false;\n        const isPvp = state.battleContext.type === 'pvp';\n        const handIndex = state.enemyHand.findIndex(c => c.id === card.id);\n        const hasHandCard = handIndex !== -1;\n        if (!isPvp && !hasHandCard)\n            return false;\n        const deckCopy = [...state.enemyDeck];\n        const deckIndex = deckCopy.findIndex(c => c.id === card.id);\n        if (deckIndex !== -1) {\n            deckCopy.splice(deckIndex, 1);\n        }\n        const newHand = hasHandCard ? state.enemyHand.filter((_, i) => i !== handIndex) : [...state.enemyHand];\n        // Nullify :     \n        if (state.playerStatus.nullifyCharges > 0) {\n            const newEnergy = state.enemyEnergy - card.cost;\n            const newPlayerStatus = { ...state.playerStatus, nullifyCharges: state.playerStatus.nullifyCharges - 1 };\n            const newDiscard = [...state.enemyDiscard, card];\n            set({\n                enemyEnergy: newEnergy,\n                enemyHand: newHand,\n                enemyDeck: deckIndex !== -1 ? deckCopy : state.enemyDeck,\n                enemyDiscard: newDiscard,\n                playerStatus: newPlayerStatus\n            });\n            notifyEnemyHandUpdate();\n            get().addLog(` ${card.name}  ( ${card.cost})`, 'card-play');\n            get().addLog(` !     ( : ${newPlayerStatus.nullifyCharges})`, 'effect');\n            return true;\n        }\n        const newEnergy = state.enemyEnergy - card.cost;\n        const newDiscard = [...state.enemyDiscard, card];\n        set({\n            enemyEnergy: newEnergy,\n            enemyHand: newHand,\n            enemyDeck: deckIndex !== -1 ? deckCopy : state.enemyDeck,\n            enemyDiscard: newDiscard\n        });\n        notifyEnemyHandUpdate();\n        get().addLog(` ${card.name}  ( ${card.cost})`, 'card-play');\n        // process effects (   )\n        card.effects.forEach((eff, idx) => {\n            if (eff && typeof eff === 'object') {\n                const type = eff.type;\n                if (type === 'Draw') {\n                    const value = Number(eff.value ?? 0);\n                    if (value > 0) {\n                        get().enemyDraw(value);\n                        get().addLog(` :  ${value}`, 'effect');\n                        triggerVFX('draw', 'enemy', value);\n                    }\n                }\n                else if (type === 'GainAction') {\n                    const value = Number(eff.value ?? 0);\n                    if (value > 0) {\n                        if (eff.delayed) {\n                            const turns = Math.max(1, Number(eff.delayTurns ?? 1));\n                            const enemyStatus = { ...get().enemyStatus };\n                            enemyStatus.energyBoostPending = (enemyStatus.energyBoostPending || 0) + value;\n                            enemyStatus.energyBoostDuration = Math.max(enemyStatus.energyBoostDuration, turns);\n                            set({ enemyStatus });\n                            get().addLog(`    : ${turns}  +${value}`, 'effect');\n                            triggerVFX('buff', 'enemy', value);\n                        }\n                        else {\n                            set({ enemyEnergy: get().enemyEnergy + value });\n                            get().addLog(` :  +${value}`, 'effect');\n                            triggerVFX('energy', 'enemy', value);\n                        }\n                    }\n                }\n                else if (type === 'Damage') {\n                    const value = Number(eff.value ?? 0);\n                    const hits = Math.max(1, Number(eff.hits ?? 1));\n                    const lifestealRatio = Math.min(1, Math.max(0, Number(eff.lifestealRatio ?? 0)));\n                    const aoe = eff.aoe === true;\n                    if (value > 0) {\n                        let finalValue = value;\n                        //    \n                        const state = get();\n                        const attackBuff = state.enemyStatus.attackBuff || 0;\n                        if (attackBuff > 0) {\n                            finalValue = Math.floor(value * (1 + attackBuff / 100));\n                        }\n                        //  (Shock) :     ()\n                        const currentState = get();\n                        const shockStacks = currentState.playerStatus.shockStacks || 0;\n                        if (shockStacks > 0) {\n                            let procChance = 0;\n                            let damageRatio = 0;\n                            if (shockStacks >= 3) {\n                                procChance = 0.9;\n                                damageRatio = 0.5;\n                            }\n                            else if (shockStacks === 2) {\n                                procChance = 0.6;\n                                damageRatio = 0.4;\n                            }\n                            else {\n                                procChance = 0.3;\n                                damageRatio = 0.3;\n                            }\n                            const roll = ((currentState.roundSeed + finalValue + shockStacks + 100) % 100) / 100;\n                            if (roll < procChance) {\n                                const chainDamage = Math.floor(finalValue * damageRatio);\n                                get().addLog(`  ! (${shockStacks}, ${Math.floor(procChance * 100)}% )  : ${chainDamage}`, 'effect');\n                                get().dealDamage('player', chainDamage, false);\n                                const updatedState = get();\n                                const newPlayerStatus = { ...updatedState.playerStatus };\n                                newPlayerStatus.shockStacks = Math.max(0, shockStacks - 1);\n                                set({ playerStatus: newPlayerStatus });\n                            }\n                            else {\n                                get().addLog(`   (${shockStacks}, ${Math.floor(procChance * 100)}% )`, 'effect');\n                            }\n                        }\n                        const remainingDamages = card.effects.slice(idx + 1).filter((e) => e.type === 'Damage').length;\n                        if (hits > 1) {\n                            get().addLog(`  : ${hits}`, 'effect');\n                        }\n                        const targetOverride = eff.target;\n                        for (let hitIndex = 0; hitIndex < hits; hitIndex++) {\n                            const totalRemaining = remainingDamages + (hits - hitIndex - 1);\n                            const skipCheck = totalRemaining > 0;\n                            let dealt = 0;\n                            if (aoe) {\n                                dealt = get().dealDamage('player', finalValue, skipCheck);\n                                get().addLog(`  : ${finalValue}`, 'effect');\n                            }\n                            else {\n                                let targetSide = 'player';\n                                if (targetOverride === 'player' || targetOverride === 'enemy') {\n                                    targetSide = targetOverride;\n                                }\n                                dealt = get().dealDamage(targetSide, finalValue, skipCheck);\n                            }\n                            if (lifestealRatio > 0 && dealt > 0) {\n                                const healAmount = Math.floor(dealt * lifestealRatio);\n                                if (healAmount > 0) {\n                                    get().heal('enemy', healAmount);\n                                    get().addLog(` : +${healAmount}`, 'effect');\n                                }\n                            }\n                        }\n                    }\n                }\n                else if (type === 'Heal') {\n                    const value = Number(eff.value ?? 0);\n                    const aoe = eff.aoe === true;\n                    const overflowToShield = eff.overflowToShield === true;\n                    if (value > 0) {\n                        if (aoe) {\n                            get().heal('enemy', value);\n                            get().heal('player', value);\n                            get().addLog(`  : ${value}`, 'effect');\n                        }\n                        else if (overflowToShield) {\n                            const currentState = get();\n                            const currentHp = currentState.enemyHp;\n                            const maxHp = currentState.enemyMaxHp;\n                            const missing = Math.max(0, maxHp - currentHp);\n                            const healAmount = Math.min(value, missing);\n                            const overflow = Math.max(0, value - healAmount);\n                            if (healAmount > 0) {\n                                get().heal('enemy', healAmount);\n                            }\n                            if (overflow > 0) {\n                                const enemyStatus = { ...currentState.enemyStatus };\n                                enemyStatus.shield = (enemyStatus.shield || 0) + overflow;\n                                enemyStatus.shieldDuration = Math.max(enemyStatus.shieldDuration, 2);\n                                set({ enemyStatus });\n                                get().addLog(`   : +${overflow} ( ${enemyStatus.shield})`, 'effect');\n                            }\n                        }\n                        else {\n                            get().heal('enemy', value);\n                        }\n                    }\n                }\n                else if (type === 'ApplyBleed') {\n                    const stacks = Math.max(1, Number(eff.stacks ?? 1));\n                    const duration = Math.max(1, Number(eff.duration ?? 2));\n                    const damagePerStack = Math.max(1, Number(eff.damagePerStack ?? 5));\n                    get().applyStatus('player', 'Bleed', stacks, duration, 100, damagePerStack);\n                    get().addLog(`  : ${stacks} / ${duration} ( ${damagePerStack})`, 'effect');\n                    triggerVFX('damage', 'player', stacks);\n                }\n                else if (type === 'ReactiveArmor') {\n                    const charges = Math.max(1, Number(eff.charges ?? 1));\n                    const reflectRatio = Math.min(1, Math.max(0, Number(eff.reflectRatio ?? 0.3)));\n                    const shieldRatio = Math.min(1, Math.max(0, Number(eff.shieldRatio ?? 0)));\n                    const duration = Math.max(0, Number(eff.duration ?? charges));\n                    const enemyStatus = { ...get().enemyStatus };\n                    enemyStatus.reactiveArmorCharges = charges;\n                    enemyStatus.reactiveArmorReflectRatio = reflectRatio;\n                    enemyStatus.reactiveArmorShieldRatio = shieldRatio;\n                    enemyStatus.reactiveArmorDuration = duration;\n                    set({ enemyStatus });\n                    const reflectPct = Math.round(reflectRatio * 100);\n                    const shieldPct = Math.round(shieldRatio * 100);\n                    get().addLog(`  : ${charges} ( ${reflectPct}%,   ${shieldPct}%)`, 'effect');\n                    triggerVFX('shield', 'enemy', charges);\n                }\n                else if (type === 'TempoBoost') {\n                    const amount = Number(eff.amount ?? 0);\n                    const turns = Math.max(1, Number(eff.turns ?? 1));\n                    if (amount > 0) {\n                        const enemyStatus = { ...get().enemyStatus };\n                        enemyStatus.energyBoostPending = (enemyStatus.energyBoostPending || 0) + amount;\n                        enemyStatus.energyBoostDuration = Math.max(enemyStatus.energyBoostDuration, turns);\n                        set({ enemyStatus });\n                        get().addLog(`  :  ${turns}   +${amount}`, 'effect');\n                        triggerVFX('energy', 'enemy', amount);\n                    }\n                }\n                else if (type === 'ArmorBreak') {\n                    const guardBreak = Math.max(0, Number(eff.guard ?? 0));\n                    const shieldBreak = Math.max(0, Number(eff.shield ?? 0));\n                    const playerStatus = { ...get().playerStatus };\n                    if (guardBreak > 0 && playerStatus.guard > 0) {\n                        const prevGuard = playerStatus.guard;\n                        playerStatus.guard = Math.max(0, playerStatus.guard - guardBreak);\n                        if (playerStatus.guard === 0) {\n                            playerStatus.guardDuration = 0;\n                        }\n                        get().addLog(` :    ${prevGuard}  ${playerStatus.guard}`, 'effect');\n                    }\n                    if (shieldBreak > 0 && playerStatus.shield > 0) {\n                        const prevShield = playerStatus.shield;\n                        playerStatus.shield = Math.max(0, playerStatus.shield - shieldBreak);\n                        if (playerStatus.shield === 0) {\n                            playerStatus.shieldDuration = 0;\n                        }\n                        get().addLog(` :    ${prevShield}  ${playerStatus.shield}`, 'effect');\n                    }\n                    set({ playerStatus });\n                    if (guardBreak > 0 || shieldBreak > 0) {\n                        triggerVFX('vulnerable', 'player', guardBreak + shieldBreak);\n                    }\n                }\n                else if (type === 'UndoDamage') {\n                    const percent = Math.max(0, Math.min(100, Number(eff.percent ?? 0)));\n                    if (percent > 0) {\n                        const target = eff.target ?? 'enemy';\n                        const lastDamage = target === 'enemy' ? get().enemyDamageTakenLastTurn : get().playerDamageTakenLastTurn;\n                        const maxRecover = eff.max !== undefined ? Math.max(0, Number(eff.max)) : undefined;\n                        if (lastDamage > 0) {\n                            const rawAmount = Math.floor((lastDamage * percent) / 100);\n                            const amount = maxRecover !== undefined ? Math.min(rawAmount, maxRecover) : rawAmount;\n                            if (amount > 0) {\n                                get().heal(target, amount);\n                                get().addLog(` :     (${target === 'enemy' ? '' : ''}) +${amount}`, 'effect');\n                            }\n                        }\n                    }\n                }\n                else if (type === 'OnHitStatus') {\n                    const enemyStatus = { ...get().enemyStatus };\n                    const entry = {\n                        status: {\n                            key: eff.status.key,\n                            stacks: eff.status.stacks,\n                            duration: eff.status.duration ?? 1,\n                            chance: eff.status.chance,\n                            value: eff.status.value,\n                        },\n                        turnsLeft: Math.max(1, Number(eff.duration ?? 1)),\n                    };\n                    enemyStatus.onHitStatuses = [...(enemyStatus.onHitStatuses || []), entry];\n                    set({ enemyStatus });\n                    get().addLog(` :   (${entry.status.key})`, 'effect');\n                    triggerVFX('buff', 'enemy', entry.status.stacks ?? 1);\n                }\n                else if (type === 'StealCard') {\n                    const count = Math.max(1, Number(eff.count ?? 1));\n                    const fromHand = eff.from === 'opponentHand';\n                    const playerHand = [...get().hand];\n                    const playerDeck = [...get().deck];\n                    const source = fromHand ? playerHand : playerDeck;\n                    const acquired = [];\n                    if (source.length === 0) {\n                        get().addLog(` :    `, 'effect');\n                    }\n                    else {\n                        const resolvedFilter = eff.filter ?? 'random';\n                        const pickCard = () => {\n                            if (resolvedFilter === 'lowestCost') {\n                                return source.reduce((acc, curr) => (curr.cost < acc.cost ? curr : acc), source[0]);\n                            }\n                            if (resolvedFilter === 'highestCost') {\n                                return source.reduce((acc, curr) => (curr.cost > acc.cost ? curr : acc), source[0]);\n                            }\n                            return source[Math.floor(Math.random() * source.length)];\n                        };\n                        for (let i = 0; i < count && source.length > 0; i++) {\n                            const picked = pickCard();\n                            const index = source.findIndex(c => c === picked);\n                            if (index >= 0) {\n                                source.splice(index, 1);\n                                acquired.push({ ...picked });\n                            }\n                        }\n                        if (fromHand) {\n                            set({ hand: source });\n                        }\n                        else {\n                            set({ deck: source });\n                        }\n                        if (acquired.length > 0) {\n                            const enemyHand = get().enemyHand;\n                            const newEnemyHand = [...enemyHand, ...acquired.map(c => ({ ...c }))].slice(0, 10);\n                            set({ enemyHand: newEnemyHand });\n                            notifyEnemyHandUpdate();\n                            get().addLog(`   : ${acquired.map(c => c.name).join(', ')}`, 'effect');\n                            triggerVFX('draw', 'enemy', acquired.length);\n                        }\n                    }\n                }\n                else if (type === 'TurnSkip') {\n                    const chance = Math.max(0, Math.min(100, Number(eff.chance ?? 0)));\n                    const roll = Math.random() * 100;\n                    if (roll < chance) {\n                        set({ skipPlayerTurnOnce: true });\n                        get().addLog(`   !`, 'effect');\n                        triggerVFX('freeze', 'player', chance);\n                    }\n                    else {\n                        get().addLog(`   ( ${chance}%)`, 'effect');\n                    }\n                }\n                else if (type === 'Summon') {\n                    get().addLog(`     . (  )`, 'effect');\n                }\n                else if (type === 'ApplyStatus') {\n                    const key = eff.key;\n                    const stacks = Number(eff.stacks ?? 1);\n                    const duration = Number(eff.duration ?? 2);\n                    const chance = Number(eff.chance ?? 100);\n                    const targetOverride = eff.target;\n                    let target = 'player';\n                    if (targetOverride === 'player' || targetOverride === 'enemy') {\n                        target = targetOverride;\n                    }\n                    get().applyStatus(target, key, stacks, duration, chance);\n                    if (key === 'Shock') {\n                        const currentState = get();\n                        if (target === 'player') {\n                            const playerStatus = { ...currentState.playerStatus };\n                            playerStatus.shockStacks = (playerStatus.shockStacks || 0) + stacks;\n                            set({ playerStatus });\n                        }\n                        else {\n                            const enemyStatus = { ...currentState.enemyStatus };\n                            enemyStatus.shockStacks = (enemyStatus.shockStacks || 0) + stacks;\n                            set({ enemyStatus });\n                        }\n                    }\n                }\n                else if (type === 'Shield') {\n                    const value = Number(eff.value ?? 0);\n                    const duration = Number(eff.duration ?? 1);\n                    if (value > 0) {\n                        const enemyStatus = { ...state.enemyStatus };\n                        enemyStatus.shield = (enemyStatus.shield || 0) + value;\n                        enemyStatus.shieldDuration = Math.max(enemyStatus.shieldDuration, duration);\n                        set({ enemyStatus });\n                        get().addLog(` : +${value} (: ${enemyStatus.shield}, ${enemyStatus.shieldDuration})`, 'effect');\n                        triggerVFX('shield', 'enemy', value);\n                    }\n                }\n                else if (type === 'Guard') {\n                    const value = Number(eff.value ?? 0);\n                    const duration = Number(eff.duration ?? 1);\n                    if (value > 0) {\n                        const enemyStatus = { ...state.enemyStatus };\n                        enemyStatus.guard = value;\n                        enemyStatus.guardDuration = duration;\n                        set({ enemyStatus });\n                        get().addLog(` : ${value} (${duration})`, 'effect');\n                        triggerVFX('shield', 'enemy', value);\n                    }\n                }\n                else if (type === 'Vulnerable') {\n                    const value = Number(eff.value ?? 0);\n                    const duration = Number(eff.duration ?? 1);\n                    if (value > 0) {\n                        get().applyStatus('player', 'Vulnerable', 1, duration, 100, value);\n                    }\n                }\n                else if (type === 'Nullify') {\n                    const times = Number(eff.times ?? 1);\n                    if (times > 0) {\n                        const enemyStatus = { ...state.enemyStatus };\n                        enemyStatus.nullifyCharges = (enemyStatus.nullifyCharges || 0) + times;\n                        set({ enemyStatus });\n                        get().addLog(` :   ${times}   `, 'effect');\n                        triggerVFX('shield', 'enemy', times);\n                    }\n                }\n                else if (type === 'Counter') {\n                    const value = Number(eff.value ?? 0);\n                    const duration = Number(eff.duration ?? 1);\n                    if (value > 0) {\n                        const enemyStatus = { ...state.enemyStatus };\n                        enemyStatus.counterValue = value;\n                        enemyStatus.counterDuration = duration;\n                        set({ enemyStatus });\n                        get().addLog(` :    ${value}   (${duration})`, 'effect');\n                        triggerVFX('buff', 'enemy', value);\n                    }\n                }\n                else if (type === 'Immune') {\n                    const keywords = eff.keywords || [];\n                    const duration = Number(eff.duration ?? 1);\n                    if (keywords.length > 0) {\n                        const enemyStatus = { ...state.enemyStatus };\n                        enemyStatus.immuneKeywords = [...new Set([...enemyStatus.immuneKeywords, ...keywords])];\n                        enemyStatus.immuneDuration = Math.max(enemyStatus.immuneDuration, duration);\n                        set({ enemyStatus });\n                        get().addLog(` : ${keywords.join(', ')}   (${duration})`, 'effect');\n                        triggerVFX('shield', 'enemy', keywords.length);\n                    }\n                }\n                else if (type === 'PriorityBoost') {\n                    const value = Number(eff.value ?? 0);\n                    const duration = Number(eff.duration ?? 1);\n                    if (value > 0) {\n                        const enemyStatus = { ...state.enemyStatus };\n                        enemyStatus.priorityBoost = (enemyStatus.priorityBoost || 0) + value;\n                        enemyStatus.priorityBoostDuration = Math.max(enemyStatus.priorityBoostDuration || 0, duration);\n                        set({ enemyStatus });\n                        get().addLog(`  : +${value} (${duration})`, 'effect');\n                        triggerVFX('buff', 'enemy', value);\n                    }\n                }\n                else if (type === 'Conditional') {\n                    //    ( )\n                    const condition = eff.if;\n                    let conditionMet = false;\n                    if (condition.includes('targetHp<=')) {\n                        const match = condition.match(/targetHp<=(\\d+)%/);\n                        if (match) {\n                            const threshold = Number(match[1]);\n                            const currentState = get();\n                            const targetHp = card.type === 'Attack' ? currentState.playerHp : currentState.enemyHp;\n                            const targetMaxHp = card.type === 'Attack' ? currentState.playerMaxHp : currentState.enemyMaxHp;\n                            const hpPercent = (targetHp / targetMaxHp) * 100;\n                            conditionMet = hpPercent <= threshold;\n                        }\n                    }\n                    if (conditionMet) {\n                        get().addLog(`  !   `, 'effect');\n                        const thenEffects = eff.then || [];\n                        thenEffects.forEach((thenEff) => {\n                            if (thenEff.type === 'Damage') {\n                                const value = Number(thenEff.value ?? 0);\n                                if (value > 0) {\n                                    get().dealDamage('player', value, false);\n                                    get().addLog(`  : ${value}`, 'effect');\n                                }\n                            }\n                            else if (thenEff.type === 'Heal') {\n                                const value = Number(thenEff.value ?? 0);\n                                if (value > 0) {\n                                    get().heal('enemy', value);\n                                    get().addLog(`  : ${value}`, 'effect');\n                                }\n                            }\n                        });\n                    }\n                }\n                else if (type === 'Chain') {\n                    // Chain  ( )\n                    const targets = Number(eff.targets ?? 2);\n                    const ratio = Number(eff.ratio ?? 0.5);\n                    let chainDamage = 0;\n                    for (let i = idx - 1; i >= 0; i--) {\n                        const prevEff = card.effects[i];\n                        if (prevEff && prevEff.type === 'Damage') {\n                            const prevDamage = Number(prevEff.value ?? 0);\n                            if (prevDamage > 0) {\n                                chainDamage = Math.floor(prevDamage * ratio);\n                                break;\n                            }\n                        }\n                    }\n                    if (chainDamage > 0) {\n                        for (let t = 0; t < targets; t++) {\n                            get().dealDamage('player', chainDamage, t < targets - 1);\n                        }\n                        get().addLog(`  :   ${chainDamage}  ${targets}`, 'effect');\n                    }\n                }\n            }\n        });\n        return true;\n    },\n    spendEnergy: () => {\n        const { energy } = get();\n        if (energy > 0)\n            set({ energy: energy - 1 });\n    },\n    resetEnergyAndNextRound: () => {\n        const stateBefore = get();\n        const { round } = stateBefore;\n        const skipPlayerTurn = stateBefore.skipPlayerTurnOnce;\n        set({\n            playerDamageTakenLastTurn: stateBefore.playerDamageTakenThisTurn,\n            enemyDamageTakenLastTurn: stateBefore.enemyDamageTakenThisTurn,\n            playerDamageTakenThisTurn: 0,\n            enemyDamageTakenThisTurn: 0,\n            skipPlayerTurnOnce: false,\n        });\n        //  \n        get().processStatusEffects();\n        const currentState = get();\n        const playerStatus = { ...currentState.playerStatus };\n        let bonusEnergy = 0;\n        if (playerStatus.energyBoostDuration > 0) {\n            bonusEnergy = Math.max(0, playerStatus.energyBoostPending);\n            playerStatus.energyBoostDuration = Math.max(0, playerStatus.energyBoostDuration - 1);\n            if (playerStatus.energyBoostDuration === 0) {\n                playerStatus.energyBoostPending = 0;\n                get().addLog(`   `, 'effect');\n            }\n        }\n        const newEnergy = Math.min(10, 3 + bonusEnergy);\n        const updates = {\n            energy: newEnergy,\n            round: round + 1,\n            playerStatus,\n        };\n        set(updates);\n        if (bonusEnergy > 0) {\n            get().addLog(` :  3 +  ${bonusEnergy} = ${newEnergy}`, 'system');\n        }\n        else {\n            get().addLog(` : 3`, 'system');\n        }\n        get().addLog(`    ${round + 1}`, 'system');\n        if (skipPlayerTurn) {\n            get().addLog(`      .`, 'system');\n            const triggerEnemy = () => {\n                if (get().gameOver === 'none') {\n                    void get().enemyTurn();\n                }\n            };\n            if (typeof window !== 'undefined') {\n                window.setTimeout(triggerEnemy, 400);\n            }\n            else {\n                triggerEnemy();\n            }\n        }\n    },\n    endPlayerTurn: async () => {\n        const state = get();\n        if (state.gameOver !== 'none' || state.isTurnProcessing)\n            return;\n        if (state.battleContext.type === 'pvp') {\n            await get().submitPvpTurn();\n            return;\n        }\n        //     ( )\n        set({ isTurnProcessing: true });\n        //    /  \n        if (state.playerQueue.length > 0) {\n            set({ declarationLocked: true });\n            await get().revealAndResolve(); //   \n        }\n        get().addLog(`  `, 'system');\n        //  \n        get().processStatusEffects('playerEnd');\n        //   \n        endTurnTimer = window.setTimeout(async () => {\n            await get().enemyTurn();\n            //     ( ) -     \n        }, 500);\n    },\n    // AI   \n    evaluateCard: (card, context) => {\n        let score = 0;\n        const { enemyHp, enemyMaxHp, playerHp, playerMaxHp, enemyStatus, playerStatus } = context;\n        const enemyHpRatio = enemyHp / enemyMaxHp;\n        const playerHpRatio = playerHp / playerMaxHp;\n        //    \n        if (card.type === 'Attack') {\n            score += 50;\n            //   :  HP    \n            if (playerHpRatio < 0.3) {\n                score += 40; //  \n            }\n            else if (playerHpRatio < 0.5) {\n                score += 20;\n            }\n            //       \n            if (playerStatus.vulnerable > 0) {\n                score += 25;\n            }\n            //  /    \n            if (playerStatus.guard > 0) {\n                score -= 15;\n            }\n            if (playerStatus.shield > 0) {\n                score -= 10;\n            }\n            //       \n            if (playerStatus.evasionCharges > 0) {\n                score -= 30;\n            }\n        }\n        else if (card.type === 'Heal') {\n            score += 30;\n            //  : HP    \n            if (enemyHpRatio < 0.3) {\n                score += 50; //  \n            }\n            else if (enemyHpRatio < 0.5) {\n                score += 30;\n            }\n            else if (enemyHpRatio > 0.8) {\n                score -= 20; // HP   \n            }\n        }\n        else if (card.type === 'Defense') {\n            score += 35;\n            //  : HP     \n            if (enemyHpRatio < 0.5) {\n                score += 25;\n            }\n            //  /     \n            if (enemyStatus.guard > 0 || enemyStatus.shield > 0) {\n                score -= 20;\n            }\n        }\n        else if (card.type === 'Special') {\n            score += 40;\n            // Special    \n            if (card.keywords.includes('Nullify') && playerStatus.nullifyCharges === 0) {\n                score += 20; //   \n            }\n        }\n        //  :    (  )\n        score -= card.cost * 3;\n        //  \n        card.keywords.forEach(keyword => {\n            if (keyword === 'Burn') {\n                //      \n                if (!playerStatus.immuneKeywords.includes('Burn')) {\n                    score += 15;\n                }\n                else {\n                    score -= 30; //  \n                }\n            }\n            else if (keyword === 'Shock') {\n                if (!playerStatus.immuneKeywords.includes('Shock')) {\n                    score += 12;\n                }\n                else {\n                    score -= 30;\n                }\n            }\n            else if (keyword === 'Vulnerable') {\n                //    \n                score += 10;\n            }\n            else if (keyword === 'Shield' || keyword === 'Guard') {\n                //      \n                if (enemyHpRatio < 0.6) {\n                    score += 15;\n                }\n            }\n        });\n        return Math.max(0, score);\n    },\n    enemyTurn: async () => {\n        const state = get();\n        console.log(`[EnemyTurn]  enemyTurn() called, gameOver: ${state.gameOver}`);\n        if (state.battleContext.type === 'pvp')\n            return;\n        if (state.gameOver !== 'none')\n            return;\n        get().addLog(`  `, 'system');\n        if (state.skipEnemyTurnOnce) {\n            set({ skipEnemyTurnOnce: false });\n            get().addLog(`  !   .`, 'system');\n            get().processStatusEffects('enemyEnd');\n            const midState = get();\n            const newRound = midState.round + 1;\n            const newSeed = Math.floor(Math.random() * 1000000);\n            const remainingEnergy = midState.energy;\n            const newEnergy = Math.min(remainingEnergy + 3, 10);\n            set({ round: newRound, roundSeed: newSeed, energy: newEnergy });\n            get().addLog(`  ${newRound}  `, 'system');\n            get().addLog(`  `, 'system');\n            if (remainingEnergy > 0) {\n                get().addLog(`: ${remainingEnergy}() + 3 = ${newEnergy}`, 'system');\n            }\n            else {\n                get().addLog(`: ${newEnergy}`, 'system');\n            }\n            get().draw(1);\n            set({ isTurnProcessing: false });\n            return;\n        }\n        //      ( :   + 3 (+),  10)\n        const remainingEnemyEnergy = state.enemyEnergy;\n        const enemyStatus = { ...state.enemyStatus };\n        let enemyBonusEnergy = 0;\n        if (enemyStatus.energyBoostDuration > 0) {\n            enemyBonusEnergy = Math.max(0, enemyStatus.energyBoostPending);\n            enemyStatus.energyBoostDuration = Math.max(0, enemyStatus.energyBoostDuration - 1);\n            if (enemyStatus.energyBoostDuration === 0) {\n                enemyStatus.energyBoostPending = 0;\n                get().addLog(`    `, 'effect');\n            }\n        }\n        const newEnemyEnergy = Math.min(remainingEnemyEnergy + 3 + enemyBonusEnergy, 10);\n        set({ enemyEnergy: newEnemyEnergy, enemyStatus });\n        if (enemyBonusEnergy > 0 || remainingEnemyEnergy > 0) {\n            get().addLog(` : ${remainingEnemyEnergy}() + 3${enemyBonusEnergy > 0 ? ` +  ${enemyBonusEnergy}` : ''} = ${newEnemyEnergy}`, 'system');\n        }\n        else {\n            get().addLog(` : ${newEnemyEnergy}`, 'system');\n        }\n        get().enemyDraw(1);\n        //     (500ms)\n        enemyTurnTimer1 = window.setTimeout(async () => {\n            console.log(`[EnemyTurn]  setTimeout callback 1 triggered, gameOver: ${get().gameOver}, round: ${get().round}`);\n            const currentState = get();\n            //     (initGame     )\n            if (currentState.gameOver !== 'none') {\n                console.log(`[EnemyTurn]  Aborted due to gameOver: ${currentState.gameOver}`);\n                return;\n            }\n            // AI :    \n            const playableCards = currentState.enemyHand.filter(c => c.cost <= currentState.enemyEnergy);\n            if (playableCards.length === 0) {\n                get().addLog(`   `, 'system');\n            }\n            else {\n                //  \n                const context = {\n                    enemyHp: currentState.enemyHp,\n                    enemyMaxHp: currentState.enemyMaxHp,\n                    playerHp: currentState.playerHp,\n                    playerMaxHp: currentState.playerMaxHp,\n                    enemyStatus: currentState.enemyStatus,\n                    playerStatus: currentState.playerStatus,\n                };\n                //   \n                const cardScores = playableCards.map(card => ({\n                    card,\n                    score: get().evaluateCard(card, context)\n                }));\n                //  \n                cardScores.sort((a, b) => b.score - a.score);\n                //  30%     (  )\n                const topCandidates = cardScores.slice(0, Math.max(1, Math.ceil(cardScores.length * 0.3)));\n                const chosenCard = topCandidates[Math.floor(Math.random() * topCandidates.length)].card;\n                if (chosenCard) {\n                    get().addLog(`[AI] : ${chosenCard.name} (: ${cardScores.find(cs => cs.card.id === chosenCard.id)?.score})`, 'system');\n                    //     \n                    await triggerCardUseAnimation(chosenCard, false, -1);\n                    get().playEnemyCard(chosenCard);\n                    //    \n                    const nextState = get();\n                    //    \n                    if (nextState.gameOver !== 'none')\n                        return;\n                    const nextPlayable = nextState.enemyHand.filter(c => c.cost <= nextState.enemyEnergy);\n                    if (nextPlayable.length > 0) {\n                        const nextScores = nextPlayable.map(card => ({\n                            card,\n                            score: get().evaluateCard(card, {\n                                enemyHp: nextState.enemyHp,\n                                enemyMaxHp: nextState.enemyMaxHp,\n                                playerHp: nextState.playerHp,\n                                playerMaxHp: nextState.playerMaxHp,\n                                enemyStatus: nextState.enemyStatus,\n                                playerStatus: nextState.playerStatus,\n                            })\n                        }));\n                        nextScores.sort((a, b) => b.score - a.score);\n                        //      (50 )\n                        if (nextScores[0].score >= 50) {\n                            //     \n                            await triggerCardUseAnimation(nextScores[0].card, false, -1);\n                            get().playEnemyCard(nextScores[0].card);\n                        }\n                    }\n                }\n            }\n            //     (initGame     )\n            const checkState = get();\n            console.log(`[EnemyTurn]  Before addLog, gameOver: ${checkState.gameOver}, round: ${checkState.round}`);\n            if (checkState.gameOver !== 'none') {\n                console.log(`[EnemyTurn]  Aborted before addLog due to gameOver: ${checkState.gameOver}`);\n                return;\n            }\n            //      \n            get().addLog(`  `, 'system');\n            get().processStatusEffects('enemyEnd');\n            enemyTurnTimer2 = window.setTimeout(() => {\n                console.log(`[EnemyTurn]  setTimeout callback 2 triggered, gameOver: ${get().gameOver}, round: ${get().round}`);\n                const finalState = get();\n                if (finalState.gameOver === 'none') {\n                    //      \n                    const newRound = finalState.round + 1;\n                    const newSeed = Math.floor(Math.random() * 1000000);\n                    //   :   + 3,  10\n                    const remainingEnergy = finalState.energy;\n                    const newEnergy = Math.min(remainingEnergy + 3, 10);\n                    set({ round: newRound, roundSeed: newSeed, energy: newEnergy });\n                    get().addLog(`  ${newRound}  `, 'system');\n                    get().addLog(`  `, 'system');\n                    if (remainingEnergy > 0) {\n                        get().addLog(`: ${remainingEnergy}() + 3 = ${newEnergy}`, 'system');\n                    }\n                    else {\n                        get().addLog(`: ${newEnergy}`, 'system');\n                    }\n                    //   1\n                    get().draw(1);\n                    //     ( ) -    \n                    enemyTurnTimer3 = window.setTimeout(() => {\n                        set({ isTurnProcessing: false });\n                    }, 500); //    \n                }\n            }, 500);\n        }, 500); //    \n    },\n}));\n","import { supabase } from './supabaseClient';\nimport { useBattleStore } from './store';\nconst SAVE_VERSION = 1;\nconst SAVE_TABLE = 'saves';\nlet currentUserId = null;\nlet unsubscribeSync = null;\nlet saveTimer = null;\nlet lastSavedJson = '';\nlet pendingSaveJson = '';\nlet unloadHandlerRegistered = false;\nlet unloadHandler = null;\nlet currentSyncStatus = 'idle';\nlet lastSaveTriggers = null;\nlet pendingSavedCollection = null;\nlet pendingSavedDeck = null;\nfunction setCloudSyncStatus(status) {\n    if (currentSyncStatus === status) {\n        return;\n    }\n    currentSyncStatus = status;\n    window.dispatchEvent(new CustomEvent('cloud-sync-status', { detail: status }));\n}\nif (typeof window !== 'undefined') {\n    let debugInitialized = false;\n    window.addEventListener('cloud-save-force', () => flushSaveImmediately());\n    if (!debugInitialized) {\n        debugInitialized = true;\n        let lastGold = useBattleStore.getState().gold;\n        let lastShards = useBattleStore.getState().shards;\n        let lastCollection = useBattleStore.getState().collection.length;\n        let lastDeck = useBattleStore.getState().playerDeck.length;\n        let lastStage = useBattleStore.getState().currentStage;\n        useBattleStore.subscribe((state) => {\n            if (state.gold !== lastGold) {\n                console.log('[CloudSave][Debug] Gold changed', { prev: lastGold, next: state.gold });\n                lastGold = state.gold;\n            }\n            if (state.shards !== lastShards) {\n                console.log('[CloudSave][Debug] Shards changed', { prev: lastShards, next: state.shards });\n                lastShards = state.shards;\n            }\n            if (state.collection.length !== lastCollection) {\n                console.log('[CloudSave][Debug] Collection length changed', { prev: lastCollection, next: state.collection.length });\n                lastCollection = state.collection.length;\n            }\n            if (state.playerDeck.length !== lastDeck) {\n                console.log('[CloudSave][Debug] Player deck length changed', { prev: lastDeck, next: state.playerDeck.length });\n                lastDeck = state.playerDeck.length;\n            }\n            if (state.currentStage !== lastStage) {\n                console.log('[CloudSave][Debug] Current stage changed', { prev: lastStage, next: state.currentStage });\n                lastStage = state.currentStage;\n            }\n        });\n    }\n}\nfunction selectPersistentState(state) {\n    const campaignClears = state.completedStageIds.length > 0\n        ? state.completedStageIds\n        : state.campaignStages.filter(stage => stage.cleared).map(stage => stage.id);\n    const clearedFloorIds = state.dailyDungeon.floors.filter(floor => floor.cleared).map(floor => floor.id);\n    const collectionEntries = aggregateCollection(state.collection);\n    const deckEntries = aggregateDeck(state.playerDeck);\n    const snapshot = {\n        version: SAVE_VERSION,\n        gold: state.gold,\n        shards: state.shards,\n        pvpWins: state.pvpWins ?? 0,\n        collection: collectionEntries,\n        playerDeck: deckEntries,\n        campaignClears,\n        daily: {\n            dateKey: state.dailyDungeon.dateKey,\n            clearedFloorIds,\n            currentFloorId: state.currentDailyFloorId,\n            completed: state.dailyDungeon.completed,\n        },\n        currentStage: state.currentStage,\n        timestamp: new Date().toISOString(),\n    };\n    console.log('[CloudSave] selectPersistentState snapshot', {\n        gold: snapshot.gold,\n        shards: snapshot.shards,\n        pvpWins: snapshot.pvpWins,\n        collectionEntries: snapshot.collection.length,\n        deckEntries: snapshot.playerDeck.length,\n        campaignClears: snapshot.campaignClears,\n        currentStage: snapshot.currentStage,\n    });\n    return snapshot;\n}\nfunction getCanonicalCardId(cardId) {\n    if (!cardId || typeof cardId !== 'string') {\n        return '';\n    }\n    const parts = cardId.split('_');\n    if (parts.length <= 6) {\n        return cardId;\n    }\n    return parts.slice(0, 6).join('_');\n}\nfunction aggregateCollection(cards) {\n    const counts = new Map();\n    cards.forEach(card => {\n        const key = getCanonicalCardId(card.id);\n        if (!key)\n            return;\n        counts.set(key, (counts.get(key) ?? 0) + 1);\n    });\n    return Array.from(counts.entries()).map(([cardId, count]) => ({ cardId, count }));\n}\nfunction aggregateDeck(cards) {\n    const limited = cards.slice(0, 20);\n    const counts = new Map();\n    limited.forEach(card => {\n        const key = getCanonicalCardId(card.id);\n        if (!key)\n            return;\n        counts.set(key, (counts.get(key) ?? 0) + 1);\n    });\n    return Array.from(counts.entries()).map(([cardId, count]) => ({ cardId, count }));\n}\nfunction normalizeSavedCollection(data) {\n    if (!Array.isArray(data)) {\n        return [];\n    }\n    if (data.length === 0) {\n        return [];\n    }\n    const first = data[0];\n    if (first && typeof first === 'object' && 'cardId' in first && 'count' in first) {\n        return data.map(entry => ({\n            cardId: getCanonicalCardId(entry.cardId),\n            count: Math.max(0, Math.floor(entry.count ?? 0)),\n        })).filter(entry => entry.cardId && entry.count > 0);\n    }\n    // Legacy format: array of Card objects\n    const counts = new Map();\n    data.forEach(card => {\n        if (!card || typeof card !== 'object')\n            return;\n        const key = getCanonicalCardId(card.id);\n        if (!key)\n            return;\n        counts.set(key, (counts.get(key) ?? 0) + 1);\n    });\n    return Array.from(counts.entries()).map(([cardId, count]) => ({ cardId, count }));\n}\nfunction normalizeSavedDeck(data) {\n    if (!Array.isArray(data)) {\n        return [];\n    }\n    if (data.length === 0) {\n        return [];\n    }\n    const first = data[0];\n    if (first && typeof first === 'object' && 'cardId' in first && 'count' in first) {\n        return data.map(entry => ({\n            cardId: getCanonicalCardId(entry.cardId),\n            count: Math.max(0, Math.floor(entry.count ?? 0)),\n        })).filter(entry => entry.cardId && entry.count > 0);\n    }\n    // Legacy format: array of Card objects\n    const limited = data.slice(0, 20);\n    const counts = new Map();\n    limited.forEach(card => {\n        if (!card || typeof card !== 'object')\n            return;\n        const key = getCanonicalCardId(card.id);\n        if (!key)\n            return;\n        counts.set(key, (counts.get(key) ?? 0) + 1);\n    });\n    return Array.from(counts.entries()).map(([cardId, count]) => ({ cardId, count }));\n}\nfunction instantiateSavedEntries(entries, pool, limit = null) {\n    if (!Array.isArray(entries) || entries.length === 0) {\n        return [];\n    }\n    if (!Array.isArray(pool) || pool.length === 0) {\n        return [];\n    }\n    const poolMap = new Map();\n    pool.forEach(card => {\n        const key = getCanonicalCardId(card.id);\n        if (!key)\n            return;\n        poolMap.set(key, card);\n    });\n    const result = [];\n    const now = Date.now();\n    for (const entry of entries) {\n        const canonicalId = getCanonicalCardId(entry.cardId);\n        const base = poolMap.get(canonicalId);\n        if (!base) {\n            console.warn('[CloudSave] Base card not found for saved entry', canonicalId);\n            continue;\n        }\n        const copies = Math.max(0, Math.floor(entry.count ?? 0));\n        for (let i = 0; i < copies; i++) {\n            if (limit !== null && result.length >= limit) {\n                return result;\n            }\n            const uniqueId = `${base.id}_${now}_${result.length}_${Math.random().toString(36).slice(2, 8)}`;\n            result.push({ ...base, id: uniqueId });\n        }\n    }\n    return result;\n}\nfunction applySavedCardData(collectionEntries, deckEntries) {\n    const pool = useBattleStore.getState().allCardsPool;\n    if (!Array.isArray(pool) || pool.length === 0) {\n        pendingSavedCollection = collectionEntries;\n        pendingSavedDeck = deckEntries;\n        return;\n    }\n    const hydratedCollection = instantiateSavedEntries(collectionEntries, pool);\n    const hydratedDeck = instantiateSavedEntries(deckEntries, pool, 20);\n    useBattleStore.setState(() => {\n        const patch = {};\n        if (hydratedCollection.length > 0) {\n            patch.collection = hydratedCollection;\n        }\n        if (hydratedDeck.length > 0) {\n            patch.playerDeck = hydratedDeck;\n        }\n        return Object.keys(patch).length > 0 ? patch : {};\n    });\n    pendingSavedCollection = null;\n    pendingSavedDeck = null;\n}\nuseBattleStore.subscribe((state) => {\n    if (Array.isArray(state.allCardsPool) &&\n        state.allCardsPool.length > 0 &&\n        (pendingSavedCollection?.length ?? 0) > 0) {\n        const collectionEntries = pendingSavedCollection ?? [];\n        const deckEntries = pendingSavedDeck ?? [];\n        applySavedCardData(collectionEntries, deckEntries);\n    }\n});\nfunction makeDeckSignature(deck) {\n    return deck\n        .map(card => getCanonicalCardId(card.id))\n        .filter(Boolean)\n        .join('|');\n}\nfunction makeCollectionSignature(collection) {\n    const counts = new Map();\n    collection.forEach(card => {\n        const key = getCanonicalCardId(card.id);\n        if (!key)\n            return;\n        counts.set(key, (counts.get(key) ?? 0) + 1);\n    });\n    return Array.from(counts.entries())\n        .sort(([aId], [bId]) => (aId < bId ? -1 : aId > bId ? 1 : 0))\n        .map(([id, count]) => `${id}:${count}`)\n        .join('|');\n}\nfunction makeCampaignClearsSignature(state) {\n    const ids = state.completedStageIds.length > 0\n        ? state.completedStageIds\n        : state.campaignStages\n            .filter(stage => stage.cleared)\n            .map(stage => stage.id);\n    return ids.slice().sort((a, b) => a - b).join(',');\n}\nfunction makeDailySignature(state) {\n    const clearedFloors = state.dailyDungeon.floors\n        .filter(floor => floor.cleared)\n        .map(floor => floor.id)\n        .sort((a, b) => a - b)\n        .join(',');\n    return `${state.dailyDungeon.completed ? '1' : '0'}|${state.dailyDungeon.dateKey}|${clearedFloors}|${state.currentDailyFloorId ?? 'null'}`;\n}\nfunction extractSaveTriggers(state) {\n    return {\n        gold: state.gold,\n        shards: state.shards,\n        pvpWins: state.pvpWins,\n        deckSignature: makeDeckSignature(state.playerDeck),\n        collectionSignature: makeCollectionSignature(state.collection),\n        campaignClearsSignature: makeCampaignClearsSignature(state),\n        currentStage: state.currentStage ?? null,\n        dailySignature: makeDailySignature(state),\n    };\n}\nfunction triggersChanged(a, b) {\n    if (!a) {\n        return true;\n    }\n    return (a.gold !== b.gold ||\n        a.shards !== b.shards ||\n        a.pvpWins !== b.pvpWins ||\n        a.deckSignature !== b.deckSignature ||\n        a.collectionSignature !== b.collectionSignature ||\n        a.campaignClearsSignature !== b.campaignClearsSignature ||\n        a.currentStage !== b.currentStage ||\n        a.dailySignature !== b.dailySignature);\n}\nasync function loadCloudSave(userId) {\n    const { data, error } = await supabase\n        .from(SAVE_TABLE)\n        .select('save_blob')\n        .eq('user_id', userId)\n        .maybeSingle();\n    if (error) {\n        console.error('[CloudSave] Failed to load save:', error);\n        return null;\n    }\n    if (!data || !data.save_blob) {\n        console.log('[CloudSave] No existing save for user', userId);\n        return null;\n    }\n    try {\n        const rawBlob = data.save_blob;\n        console.log('[CloudSave] Raw save_blob fetched', {\n            type: typeof rawBlob,\n            hasContent: !!rawBlob,\n        });\n        const parsed = typeof rawBlob === 'string'\n            ? JSON.parse(rawBlob)\n            : rawBlob;\n        if (!parsed || typeof parsed !== 'object') {\n            console.warn('[CloudSave] Save blob is not an object, ignoring load');\n            return null;\n        }\n        console.log('[CloudSave] Parsed save summary', {\n            gold: parsed.gold,\n            shards: parsed.shards,\n            collection: Array.isArray(parsed.collection) ? parsed.collection.length : null,\n            deck: Array.isArray(parsed.playerDeck) ? parsed.playerDeck.length : null,\n            currentStage: parsed.currentStage,\n            campaignClears: parsed.campaignClears,\n        });\n        return parsed;\n    }\n    catch (parseError) {\n        console.error('[CloudSave] Failed to parse save blob:', parseError);\n        return null;\n    }\n}\nasync function persistCloudSave(userId, save) {\n    const payload = {\n        user_id: userId,\n        save_blob: save,\n        updated_at: new Date().toISOString()\n    };\n    const { error } = await supabase\n        .from(SAVE_TABLE)\n        .upsert(payload, { onConflict: 'user_id' });\n    if (error) {\n        console.error('[CloudSave] Failed to persist save:', error);\n    }\n    else {\n        console.log('[CloudSave] Save persisted');\n    }\n}\nfunction applyCampaignClears(state, clears) {\n    const clearedSet = new Set(clears);\n    return state.campaignStages.map(stage => (clearedSet.has(stage.id) ? { ...stage, cleared: true } : stage));\n}\nfunction applyCloudSave(save) {\n    useBattleStore.setState((state) => {\n        const updatedStages = applyCampaignClears(state, save.campaignClears ?? []);\n        return {\n            gold: save.gold ?? state.gold,\n            shards: save.shards ?? state.shards,\n            pvpWins: typeof save.pvpWins === 'number' ? save.pvpWins : state.pvpWins,\n            campaignStages: updatedStages,\n            completedStageIds: Array.isArray(save.campaignClears) ? [...save.campaignClears].sort((a, b) => a - b) : state.completedStageIds,\n            currentDailyFloorId: save.daily?.currentFloorId ?? state.currentDailyFloorId,\n            currentStage: save.currentStage ?? null,\n        };\n    });\n    const legacyCollectionFormat = Array.isArray(save.collection) &&\n        save.collection.length > 0 &&\n        !save.collection[0]?.cardId;\n    const legacyDeckFormat = Array.isArray(save.playerDeck) &&\n        save.playerDeck.length > 0 &&\n        !save.playerDeck[0]?.cardId;\n    const collectionEntries = normalizeSavedCollection(save.collection);\n    const deckEntries = normalizeSavedDeck(save.playerDeck);\n    if (collectionEntries.length > 0 || deckEntries.length > 0) {\n        applySavedCardData(collectionEntries, deckEntries);\n    }\n    console.log('[CloudSave] Applied save to store', {\n        gold: save.gold,\n        shards: save.shards,\n        collectionEntries: collectionEntries.length,\n        deckEntries: deckEntries.length,\n        currentStage: save.currentStage,\n        clears: save.campaignClears,\n        pendingForRehydrate: {\n            collection: pendingSavedCollection?.length ?? 0,\n            deck: pendingSavedDeck?.length ?? 0,\n        },\n    });\n    if ((legacyCollectionFormat || legacyDeckFormat) && typeof window !== 'undefined') {\n        //  (   )  (cardId+count)    \n        if (currentUserId) {\n            const convertedSave = {\n                ...save,\n                collection: collectionEntries,\n                playerDeck: deckEntries,\n            };\n            persistCloudSave(currentUserId, convertedSave).then(() => {\n                lastSavedJson = JSON.stringify(convertedSave);\n                pendingSaveJson = '';\n                lastSaveTriggers = extractSaveTriggers(useBattleStore.getState());\n                setCloudSyncStatus('idle');\n            }).catch((error) => {\n                console.error('[CloudSave] Failed to persist converted save:', error);\n            });\n        }\n        window.setTimeout(() => {\n            flushSaveImmediately();\n        }, 0);\n    }\n}\nfunction applyDailyProgressFromSave(save) {\n    if (!save) {\n        return;\n    }\n    const state = useBattleStore.getState();\n    if (!state.dailyDungeon.dateKey || state.dailyDungeon.dateKey !== save.dateKey) {\n        return;\n    }\n    const clearedSet = new Set(save.clearedFloorIds);\n    useBattleStore.setState({\n        dailyDungeon: {\n            ...state.dailyDungeon,\n            floors: state.dailyDungeon.floors.map(floor => ({ ...floor, cleared: clearedSet.has(floor.id) })),\n            completed: save.completed,\n        },\n        currentDailyFloorId: save.currentFloorId ?? null,\n    });\n}\nfunction flushSaveImmediately() {\n    if (!currentUserId) {\n        return;\n    }\n    setCloudSyncStatus('saving');\n    const snapshot = selectPersistentState(useBattleStore.getState());\n    lastSaveTriggers = extractSaveTriggers(useBattleStore.getState());\n    pendingSaveJson = JSON.stringify(snapshot);\n    persistCloudSave(currentUserId, snapshot).then(() => {\n        lastSavedJson = JSON.stringify(snapshot);\n        pendingSaveJson = '';\n        setCloudSyncStatus('idle');\n    }).catch((error) => {\n        console.error('[CloudSave] Immediate flush failed', error);\n        setCloudSyncStatus('idle');\n    });\n}\nfunction scheduleSave(userId, data) {\n    const json = JSON.stringify(data);\n    if (json === lastSavedJson || json === pendingSaveJson) {\n        return;\n    }\n    pendingSaveJson = json;\n    if (saveTimer) {\n        clearTimeout(saveTimer);\n    }\n    saveTimer = window.setTimeout(async () => {\n        saveTimer = null;\n        try {\n            setCloudSyncStatus('saving');\n            const snapshot = pendingSaveJson || json;\n            const payload = JSON.parse(snapshot);\n            await persistCloudSave(userId, payload);\n            lastSavedJson = snapshot;\n        }\n        catch (error) {\n            console.error('[CloudSave] Failed to serialize save payload:', error);\n        }\n        finally {\n            pendingSaveJson = '';\n            setCloudSyncStatus('idle');\n        }\n    }, 1000);\n}\nasync function startSync(userId) {\n    setCloudSyncStatus('loading');\n    try {\n        const existing = await loadCloudSave(userId);\n        if (existing) {\n            console.log('[CloudSave] Existing save found, applying');\n            applyCloudSave(existing);\n            useBattleStore.getState().ensureDailyDungeon();\n            applyDailyProgressFromSave(existing.daily);\n            const currentState = useBattleStore.getState();\n            lastSavedJson = JSON.stringify(selectPersistentState(currentState));\n            lastSaveTriggers = extractSaveTriggers(currentState);\n        }\n        else {\n            console.log('[CloudSave] No save found, creating default snapshot');\n            useBattleStore.getState().ensureDailyDungeon();\n            const defaultSave = selectPersistentState(useBattleStore.getState());\n            await persistCloudSave(userId, defaultSave);\n            lastSavedJson = JSON.stringify(defaultSave);\n            lastSaveTriggers = extractSaveTriggers(useBattleStore.getState());\n        }\n        unsubscribeSync = useBattleStore.subscribe((state) => {\n            const triggers = extractSaveTriggers(state);\n            if (!triggersChanged(lastSaveTriggers, triggers)) {\n                return;\n            }\n            lastSaveTriggers = triggers;\n            const newState = selectPersistentState(state);\n            scheduleSave(userId, newState);\n        });\n        if (!unloadHandlerRegistered) {\n            unloadHandler = () => flushSaveImmediately();\n            window.addEventListener('beforeunload', unloadHandler);\n            window.addEventListener('pagehide', unloadHandler);\n            unloadHandlerRegistered = true;\n        }\n    }\n    finally {\n        setCloudSyncStatus('idle');\n    }\n}\nfunction stopSync() {\n    if (unsubscribeSync) {\n        unsubscribeSync();\n        unsubscribeSync = null;\n    }\n    if (saveTimer) {\n        clearTimeout(saveTimer);\n        saveTimer = null;\n    }\n    lastSavedJson = '';\n    pendingSaveJson = '';\n    lastSaveTriggers = null;\n    if (unloadHandlerRegistered && unloadHandler) {\n        window.removeEventListener('beforeunload', unloadHandler);\n        window.removeEventListener('pagehide', unloadHandler);\n        unloadHandlerRegistered = false;\n        unloadHandler = null;\n    }\n    setCloudSyncStatus('idle');\n}\nexport async function handleAuthSessionChange(userId) {\n    if (userId === currentUserId) {\n        return;\n    }\n    stopSync();\n    currentUserId = userId;\n    if (!userId) {\n        return;\n    }\n    await startSync(userId);\n}\n","import { create } from 'zustand';\nimport { supabase } from './supabaseClient';\nimport { useBattleStore } from './store';\nconst defaultNickname = '';\nfunction normalizeNickname(value) {\n    if (!value || typeof value !== 'string') {\n        return null;\n    }\n    const trimmed = value.trim();\n    return trimmed.length > 0 ? trimmed : null;\n}\nfunction resolveSessionNickname(session) {\n    if (!session) {\n        return null;\n    }\n    const meta = session.user?.user_metadata ?? {};\n    if (typeof meta !== 'object' || meta === null) {\n        return null;\n    }\n    const metaRecord = meta;\n    return (normalizeNickname(metaRecord.display_name) ??\n        normalizeNickname(metaRecord.nickname) ??\n        null);\n}\nexport const useAuthStore = create((set, get) => ({\n    session: null,\n    initializing: true,\n    loading: false,\n    error: null,\n    message: null,\n    authView: 'sign-in',\n    profileNickname: defaultNickname,\n    async initialize() {\n        set({ initializing: true });\n        const { data, error } = await supabase.auth.getSession();\n        if (error) {\n            console.error('[Auth]   ', error);\n            set({ error: '   .', initializing: false });\n        }\n        else {\n            const session = data.session ?? null;\n            const metaNickname = resolveSessionNickname(session);\n            set({\n                session,\n                initializing: false,\n                error: null,\n                message: null,\n                profileNickname: metaNickname ?? defaultNickname,\n            });\n            if (session?.user?.id) {\n                await get().refreshProfileNickname();\n            }\n        }\n        supabase.auth.onAuthStateChange((event, session) => {\n            if (event === 'SIGNED_IN') {\n                const metaNickname = resolveSessionNickname(session);\n                set({\n                    session,\n                    loading: false,\n                    error: null,\n                    message: null,\n                    profileNickname: metaNickname ?? defaultNickname,\n                });\n                void get().refreshProfileNickname();\n            }\n            else if (event === 'SIGNED_OUT') {\n                set({ session: null, loading: false, message: null, profileNickname: defaultNickname });\n            }\n            else if (event === 'TOKEN_REFRESHED') {\n                set({ session, loading: false });\n            }\n        });\n    },\n    setAuthView(view) {\n        set({ authView: view, error: null, message: null });\n    },\n    setProfileNickname(nickname) {\n        set({ profileNickname: normalizeNickname(nickname) ?? defaultNickname });\n    },\n    async refreshProfileNickname() {\n        const { data: sessionData } = await supabase.auth.getSession();\n        const session = sessionData.session;\n        if (!session) {\n            set({ profileNickname: defaultNickname });\n            return;\n        }\n        const sessionNickname = resolveSessionNickname(session);\n        const { data, error } = await supabase\n            .from('profiles')\n            .select('display_name, nickname')\n            .eq('user_id', session.user.id)\n            .maybeSingle();\n        if (error) {\n            console.warn('[Auth]    ', error);\n            set({ profileNickname: sessionNickname ?? defaultNickname });\n            return;\n        }\n        const profileNickname = normalizeNickname(data?.display_name) ??\n            normalizeNickname(data?.nickname) ??\n            sessionNickname ??\n            defaultNickname;\n        set({ profileNickname });\n    },\n    async signIn(email, password) {\n        set({ loading: true, error: null });\n        const { error } = await supabase.auth.signInWithPassword({ email, password });\n        if (error) {\n            console.error('[Auth]  ', error);\n            set({ error: error.message, loading: false });\n            return;\n        }\n        const { data } = await supabase.auth.getSession();\n        const session = data.session ?? null;\n        const metaNickname = resolveSessionNickname(session);\n        set({ loading: false, message: '!', profileNickname: metaNickname ?? defaultNickname });\n        void get().refreshProfileNickname();\n    },\n    async signUp(email, password, nickname) {\n        set({ loading: true, error: null });\n        const normalizedNickname = normalizeNickname(nickname) ?? defaultNickname;\n        const { data, error } = await supabase.auth.signUp({\n            email,\n            password,\n            options: {\n                data: {\n                    display_name: normalizedNickname\n                }\n            }\n        });\n        if (error) {\n            console.error('[Auth]  ', error);\n            set({ error: error.message, loading: false });\n            return;\n        }\n        const session = data.session ?? null;\n        if (session) {\n            await supabase.from('profiles').upsert({\n                user_id: session.user.id,\n                display_name: normalizedNickname,\n                nickname: normalizedNickname,\n                locale: 'ko',\n                created_at: new Date().toISOString(),\n                updated_at: new Date().toISOString()\n            });\n        }\n        set({ loading: false, message: ' .  .' });\n        set({ profileNickname: normalizedNickname });\n    },\n    async signOut() {\n        set({ loading: true, error: null });\n        try {\n            const { data: sessionData } = await supabase.auth.getSession();\n            if (!sessionData.session) {\n                set({ session: null, loading: false, message: '  .' });\n                return;\n            }\n            const { error } = await supabase.auth.signOut({ scope: 'local' });\n            if (error && !/auth session missing/i.test(error.message)) {\n                throw error;\n            }\n            set({ session: null, loading: false, message: ' .', profileNickname: defaultNickname });\n            useBattleStore.getState().setGameScreen('intro');\n            if (typeof window !== 'undefined') {\n                window.dispatchEvent(new CustomEvent('auth-force-overlay'));\n            }\n        }\n        catch (error) {\n            console.error('[Auth]  ', error);\n            set({ error: error instanceof Error ? error.message : String(error), loading: false });\n        }\n    }\n}));\nexport function requireSession() {\n    const state = useAuthStore.getState();\n    return state.session;\n}\n","export async function loadSampleCards() {\n    // Cache-buster to ensure latest pruned list is fetched during dev\n    const url = `/data/cards.json?v=${Date.now()}`;\n    const res = await fetch(url);\n    if (!res.ok) {\n        throw new Error(`Failed to load cards.json: ${res.status} ${res.statusText}`);\n    }\n    const data = await res.json();\n    if (!Array.isArray(data)) {\n        throw new Error('cards.json is not an array');\n    }\n    const cards = data.map(enrichCard);\n    return cards;\n}\nfunction enrichCard(card) {\n    const enriched = { ...card };\n    // effectText  ( )\n    if (!enriched.effectText) {\n        enriched.effectText = summarizeEffects(enriched.effects);\n    }\n    // levelCurve  ( )\n    if (!enriched.levelCurve) {\n        const base = {};\n        // Damage/Heal  \n        const dmg = firstEffectValue(enriched.effects, 'Damage');\n        const heal = firstEffectValue(enriched.effects, 'Heal');\n        if (typeof dmg === 'number')\n            base['damage'] = dmg;\n        if (typeof heal === 'number')\n            base['heal'] = heal;\n        enriched.levelCurve = { base, perLevel: {} };\n    }\n    return enriched;\n}\nfunction firstEffectValue(effects, kind) {\n    for (const e of effects) {\n        if (e.type === kind && 'value' in e) {\n            const v = Number(e.value ?? NaN);\n            if (!Number.isNaN(v))\n                return v;\n        }\n    }\n    return undefined;\n}\nfunction summarizeEffects(effects) {\n    const parts = [];\n    for (const e of effects) {\n        if (!e)\n            continue;\n        if (e.type === 'Damage') {\n            const v = e.value ?? 0;\n            const aoe = e.aoe ? ' ()' : '';\n            parts.push(` ${v}${aoe}`);\n        }\n        else if (e.type === 'Heal') {\n            const v = e.value ?? 0;\n            const aoe = e.aoe ? ' ()' : '';\n            parts.push(` ${v}${aoe}`);\n        }\n        else if (e.type === 'ApplyStatus') {\n            const key = e.key ?? 'Status';\n            const stacks = e.stacks ?? 1;\n            parts.push(`${key} ${stacks}`);\n        }\n        else if (e.type === 'Shield') {\n            const v = e.value ?? 0;\n            parts.push(` ${v}`);\n        }\n        else if (e.type === 'Guard') {\n            const v = e.value ?? 0;\n            parts.push(` ${v}`);\n        }\n        else if (e.type === 'Draw') {\n            const v = e.value ?? 1;\n            parts.push(` ${v}`);\n        }\n        else if (e.type === 'GainAction') {\n            const v = e.value ?? 1;\n            parts.push(` +${v}`);\n        }\n        else if (e.type === 'Vulnerable') {\n            const v = e.value ?? 20;\n            parts.push(` +${v}%`);\n        }\n        else if (e.type === 'Regen') {\n            const v = e.value ?? 0;\n            parts.push(`  ${v}/`);\n        }\n        else if (e.type === 'Cleanse') {\n            const maxStacks = e.maxStacks ?? 2;\n            parts.push(`( ${maxStacks})`);\n        }\n    }\n    return parts.join(', ');\n}\n","import { Assets } from 'pixi.js';\nconst manifest = {\n    webp: [],\n    png: [],\n    loaded: new Set(),\n    failed: new Set(),\n};\n/**\n *  ID   .\n * ID : {TYPE}_{CHARACTER}_{RARITY}_{NUMBER}\n * : ATT_ARIANA_NO_001 -> Ariana\n */\nfunction extractCharacterFromId(cardId) {\n    const parts = cardId.split('_');\n    if (parts.length >= 2) {\n        const charName = parts[1];\n        // ARIANA -> Ariana (  )\n        return charName.charAt(0) + charName.slice(1).toLowerCase();\n    }\n    return 'Ariana'; // \n}\n/**\n *    \n */\nfunction getCardImagePaths(card) {\n    const character = extractCharacterFromId(card.id);\n    const baseName = `${character}_${card.type}_${card.rarity}`;\n    return {\n        webp: `cards/${baseName}.webp`,\n        png: `cards/${baseName}.png`,\n    };\n}\n/**\n *    (WebP , PNG )\n */\nasync function loadSingleImage(webpPath, pngPath) {\n    //   \n    if (manifest.loaded.has(webpPath))\n        return webpPath;\n    if (manifest.loaded.has(pngPath))\n        return pngPath;\n    // WebP \n    try {\n        await Assets.load(webpPath);\n        manifest.loaded.add(webpPath);\n        return webpPath;\n    }\n    catch {\n        // PNG \n        try {\n            await Assets.load(pngPath);\n            manifest.loaded.add(pngPath);\n            return pngPath;\n        }\n        catch {\n            manifest.failed.add(webpPath);\n            manifest.failed.add(pngPath);\n            throw new Error(`Failed to load: ${webpPath} or ${pngPath}`);\n        }\n    }\n}\n/**\n *    \n */\nexport async function preloadCardImages(cards) {\n    console.log(`[AssetLoader] Preloading ${cards.length} card images...`);\n    const startTime = performance.now();\n    //   ( +type+rarity )\n    const uniqueCards = new Map();\n    cards.forEach(card => {\n        const character = extractCharacterFromId(card.id);\n        const key = `${character}_${card.type}_${card.rarity}`;\n        if (!uniqueCards.has(key)) {\n            uniqueCards.set(key, card);\n        }\n    });\n    const loadPromises = [];\n    for (const card of uniqueCards.values()) {\n        const { webp, png } = getCardImagePaths(card);\n        loadPromises.push(loadSingleImage(webp, png)\n            .then(() => {\n            // Success - silent\n        })\n            .catch((err) => {\n            console.warn(`[AssetLoader] Failed to load card image for ${card.type}/${card.rarity}:`, err);\n        }));\n    }\n    //   \n    loadPromises.push(loadSingleImage('cards/card_back.webp', 'cards/card_back.png')\n        .then(() => {\n        console.log('[AssetLoader] Card back loaded');\n    })\n        .catch((err) => {\n        console.warn('[AssetLoader] Failed to load card back:', err);\n    }));\n    //   \n    const typeIcons = [\n        'cardIcons/Type/type_attack.png',\n        'cardIcons/Type/type_defense.png',\n        'cardIcons/Type/type_heal.png',\n        'cardIcons/Type/type_special.png',\n    ];\n    typeIcons.forEach(iconPath => {\n        loadPromises.push(Assets.load(iconPath)\n            .then(() => {\n            manifest.loaded.add(iconPath);\n            console.log(`[AssetLoader] Type icon loaded: ${iconPath}`);\n        })\n            .catch((err) => {\n            manifest.failed.add(iconPath);\n            console.warn(`[AssetLoader] Failed to load type icon: ${iconPath}`, err);\n        }));\n    });\n    //     \n    await Promise.all(loadPromises);\n    const elapsed = performance.now() - startTime;\n    console.log(`[AssetLoader] Preloaded ${manifest.loaded.size} images in ${elapsed.toFixed(0)}ms`);\n    console.log(`[AssetLoader] Failed: ${manifest.failed.size} images`);\n}\n/**\n *    \n */\nexport function isCardImageLoaded(card) {\n    const { webp, png } = getCardImagePaths(card);\n    return manifest.loaded.has(webp) || manifest.loaded.has(png);\n}\n/**\n *      \n */\nexport function getLoadedCardImage(card) {\n    const { webp, png } = getCardImagePaths(card);\n    if (manifest.loaded.has(webp))\n        return webp;\n    if (manifest.loaded.has(png))\n        return png;\n    return null;\n}\n/**\n *     \n */\nexport function getCardBackImage() {\n    if (manifest.loaded.has('cards/card_back.webp'))\n        return 'cards/card_back.webp';\n    if (manifest.loaded.has('cards/card_back.png'))\n        return 'cards/card_back.png';\n    return null;\n}\n/**\n *  \n */\nexport function getAssetStats() {\n    return {\n        loaded: manifest.loaded.size,\n        failed: manifest.failed.size,\n        totalWebP: manifest.webp.length,\n        totalPNG: manifest.png.length,\n    };\n}\n/**\n *   ( )\n */\nexport function clearAssetCache() {\n    manifest.loaded.clear();\n    manifest.failed.clear();\n    console.log('[AssetLoader] Cache cleared');\n}\n","import { Container, Sprite, Text, Graphics } from 'pixi.js';\nclass CardPool {\n    constructor() {\n        this.pool = [];\n        this.poolSize = 0;\n    }\n    /**\n     *    (   )\n     */\n    acquire(cardWidth, cardHeight) {\n        //    \n        let pooledCard = this.pool.find(c => !c.inUse);\n        if (!pooledCard) {\n            //  \n            const container = new Container();\n            const sprite = new Graphics(); // Placeholder (sprite )\n            const costText = new Container(); //  (  + )\n            const typeIcon = new Container(); //   (  + )\n            const nameText = new Text({\n                text: '',\n                style: {\n                    fontSize: 11,\n                    fill: 0xFFFFFF,\n                    wordWrap: true,\n                    wordWrapWidth: cardWidth - 10,\n                    align: 'center'\n                }\n            });\n            nameText.anchor.set(0.5, 0);\n            typeIcon.x = 15;\n            typeIcon.y = 15;\n            container.addChild(sprite);\n            container.addChild(typeIcon);\n            container.addChild(costText);\n            container.addChild(nameText);\n            pooledCard = { container, sprite, costText, typeIcon, nameText, inUse: false };\n            this.pool.push(pooledCard);\n            this.poolSize++;\n        }\n        pooledCard.inUse = true;\n        return pooledCard;\n    }\n    /**\n     *   ( )\n     */\n    release(pooledCard) {\n        pooledCard.inUse = false;\n        pooledCard.container.visible = false;\n        //   \n        pooledCard.container.removeAllListeners();\n    }\n    /**\n     *     \n     */\n    releaseAll() {\n        this.pool.forEach(card => {\n            if (card.inUse) {\n                this.release(card);\n            }\n        });\n    }\n    /**\n     *  \n     */\n    getStats() {\n        return {\n            total: this.poolSize,\n            inUse: this.pool.filter(c => c.inUse).length,\n            available: this.pool.filter(c => !c.inUse).length,\n        };\n    }\n    /**\n     *   (Graphics  Sprite or vice versa)\n     */\n    replaceSprite(pooledCard, newSprite) {\n        const container = pooledCard.container;\n        const oldSprite = pooledCard.sprite;\n        //    ( )\n        if (oldSprite && oldSprite.parent) {\n            container.removeChild(oldSprite);\n        }\n        //      ( )\n        newSprite.x = 0;\n        newSprite.y = 0;\n        newSprite.alpha = 1.0;\n        newSprite.tint = 0xFFFFFF;\n        newSprite.rotation = 0;\n        //  scale   - width/height    \n        //    (  )\n        container.addChildAt(newSprite, 0);\n        pooledCard.sprite = newSprite;\n    }\n    /**\n     *    (  + )\n     */\n    setupTypeIcon(pooledCard, backgroundColor, iconPath) {\n        const container = pooledCard.container;\n        const oldIcon = pooledCard.typeIcon;\n        //    ( )\n        if (oldIcon && oldIcon.parent) {\n            container.removeChild(oldIcon);\n        }\n        //  Container \n        const typeIcon = new Container();\n        typeIcon.x = 15;\n        typeIcon.y = 15;\n        //   \n        const circle = new Graphics();\n        circle.circle(0, 0, 14);\n        circle.fill({ color: backgroundColor, alpha: 1.0 });\n        typeIcon.addChild(circle);\n        //   \n        const iconSprite = Sprite.from(iconPath);\n        iconSprite.width = 18;\n        iconSprite.height = 18;\n        iconSprite.anchor.set(0.5);\n        iconSprite.x = 0;\n        iconSprite.y = 0;\n        iconSprite.tint = 0xFFFFFF; //  \n        typeIcon.addChild(iconSprite);\n        //    (position 2 = typeIcon )\n        container.addChildAt(typeIcon, 2);\n        pooledCard.typeIcon = typeIcon;\n    }\n    /**\n     *    (  + )\n     */\n    setupCostText(pooledCard, cost, cardWidth, isAffordable) {\n        const container = pooledCard.container;\n        const oldCostText = pooledCard.costText;\n        //    \n        if (oldCostText && oldCostText.parent) {\n            container.removeChild(oldCostText);\n        }\n        //  Container \n        const costText = new Container();\n        costText.x = cardWidth - 15;\n        costText.y = 15;\n        //    ()\n        const circle = new Graphics();\n        circle.circle(0, 0, 12);\n        circle.fill({ color: 0x000000, alpha: 0.8 });\n        costText.addChild(circle);\n        //  \n        const text = new Text({\n            text: `${cost}`,\n            style: {\n                fontSize: 20,\n                fontWeight: 'bold',\n                fill: isAffordable ? 0xFFFFFF : 0xFF0000,\n            }\n        });\n        text.anchor.set(0.5);\n        text.x = 0;\n        text.y = 0;\n        costText.addChild(text);\n        //     (position 3 = costText )\n        container.addChildAt(costText, 3);\n        pooledCard.costText = costText;\n    }\n}\n//   \nexport const playerHandPool = new CardPool();\n//   \nexport const enemyHandPool = new CardPool();\n","import { Graphics } from 'pixi.js';\nclass ParticleEmitter {\n    constructor(container) {\n        this.particles = [];\n        this.container = container;\n    }\n    /**\n     *  \n     */\n    createParticle(x, y, vx, vy, color, size, life, fadeOut = true) {\n        const sprite = new Graphics();\n        sprite.circle(0, 0, size);\n        sprite.fill({ color, alpha: 1 });\n        sprite.x = x;\n        sprite.y = y;\n        this.container.addChild(sprite);\n        return {\n            sprite,\n            vx,\n            vy,\n            life,\n            maxLife: life,\n            scale: 1,\n            fadeOut,\n        };\n    }\n    /**\n     *  \n     */\n    burst(x, y, count, color, options) {\n        const speed = options?.speed ?? 2;\n        const size = options?.size ?? 3;\n        const life = options?.life ?? 30;\n        for (let i = 0; i < count; i++) {\n            const angle = (Math.PI * 2 * i) / count;\n            const vx = Math.cos(angle) * speed;\n            const vy = Math.sin(angle) * speed;\n            this.particles.push(this.createParticle(x, y, vx, vy, color, size, life));\n        }\n    }\n    /**\n     *  \n     */\n    spray(x, y, count, angle, spread, color, options) {\n        const speed = options?.speed ?? 3;\n        const size = options?.size ?? 3;\n        const life = options?.life ?? 30;\n        for (let i = 0; i < count; i++) {\n            const randomAngle = angle + (Math.random() - 0.5) * spread;\n            const randomSpeed = speed * (0.5 + Math.random() * 0.5);\n            const vx = Math.cos(randomAngle) * randomSpeed;\n            const vy = Math.sin(randomAngle) * randomSpeed;\n            this.particles.push(this.createParticle(x, y, vx, vy, color, size, life));\n        }\n    }\n    /**\n     *  \n     */\n    rain(x, y, count, color, options) {\n        const width = options?.width ?? 100;\n        const speed = options?.speed ?? 1;\n        const size = options?.size ?? 2;\n        const life = options?.life ?? 60;\n        for (let i = 0; i < count; i++) {\n            const offsetX = (Math.random() - 0.5) * width;\n            const vx = (Math.random() - 0.5) * 0.5;\n            const vy = speed + Math.random() * speed;\n            this.particles.push(this.createParticle(x + offsetX, y, vx, vy, color, size, life));\n        }\n    }\n    /**\n     *  \n     */\n    flash(x, y, color, size = 50) {\n        const sprite = new Graphics();\n        sprite.circle(0, 0, size);\n        sprite.fill({ color, alpha: 0.8 });\n        sprite.x = x;\n        sprite.y = y;\n        this.container.addChild(sprite);\n        this.particles.push({\n            sprite,\n            vx: 0,\n            vy: 0,\n            life: 15,\n            maxLife: 15,\n            scale: 2,\n            fadeOut: true,\n        });\n    }\n    /**\n     *   (,  )\n     */\n    rise(x, y, count, color, options) {\n        const speed = options?.speed ?? 1.5;\n        const size = options?.size ?? 4;\n        const life = options?.life ?? 40;\n        for (let i = 0; i < count; i++) {\n            const offsetX = (Math.random() - 0.5) * 30;\n            const vx = (Math.random() - 0.5) * 0.3;\n            const vy = -speed - Math.random() * 0.5;\n            this.particles.push(this.createParticle(x + offsetX, y, vx, vy, color, size, life));\n        }\n    }\n    /**\n     *   \n     */\n    update() {\n        for (let i = this.particles.length - 1; i >= 0; i--) {\n            const p = this.particles[i];\n            //  \n            p.sprite.x += p.vx;\n            p.sprite.y += p.vy;\n            //   ( )\n            p.vy += 0.1;\n            //  \n            p.life--;\n            //  \n            if (p.fadeOut) {\n                const alpha = p.life / p.maxLife;\n                p.sprite.alpha = alpha;\n            }\n            //   ()\n            if (p.scale !== 1) {\n                const scale = 1 + (p.scale - 1) * (p.life / p.maxLife);\n                p.sprite.scale.set(scale);\n            }\n            //   \n            if (p.life <= 0) {\n                this.container.removeChild(p.sprite);\n                p.sprite.destroy();\n                this.particles.splice(i, 1);\n            }\n        }\n    }\n    /**\n     *   \n     */\n    clear() {\n        this.particles.forEach(p => {\n            this.container.removeChild(p.sprite);\n            p.sprite.destroy();\n        });\n        this.particles = [];\n    }\n}\n/**\n * VFX  ()\n */\nclass VFXManager {\n    constructor() {\n        this.emitter = null;\n        this.container = null;\n    }\n    init(container) {\n        this.container = container;\n        this.emitter = new ParticleEmitter(container);\n    }\n    update() {\n        this.emitter?.update();\n    }\n    // ===    ===\n    /**\n     *   (  + )  !\n     */\n    playDamageEffect(x, y, value) {\n        if (!this.emitter)\n            return;\n        //   \n        this.emitter.flash(x, y, 0xff0000, 80);\n        //   \n        this.emitter.flash(x, y, 0xff6600, 50);\n        //    (3 )\n        const count = Math.min(60, 30 + Math.floor(value / 5));\n        this.emitter.burst(x, y, count, 0xff4444, { speed: 5, size: 6, life: 35 });\n        //   \n        this.emitter.burst(x, y, 15, 0x882222, { speed: 2, size: 8, life: 40 });\n        //   ()\n        setTimeout(() => {\n            this.emitter?.burst(x, y, 20, 0xff8888, { speed: 6, size: 4, life: 25 });\n        }, 50);\n    }\n    /**\n     *   (  + )  !\n     */\n    playHealEffect(x, y, value) {\n        if (!this.emitter)\n            return;\n        //   \n        this.emitter.flash(x, y, 0xffff00, 70);\n        //   \n        this.emitter.flash(x, y, 0x00ff00, 90);\n        //    ()\n        const count = Math.min(40, 20 + Math.floor(value / 5));\n        this.emitter.rise(x, y, count, 0xffff44, { speed: 2, size: 7, life: 50 });\n        //   \n        this.emitter.rise(x, y, count, 0x44ff44, { speed: 1.8, size: 6, life: 45 });\n        //    ()\n        setTimeout(() => {\n            this.emitter?.rise(x, y, 15, 0x00ffaa, { speed: 2.5, size: 5, life: 40 });\n        }, 100);\n    }\n    /**\n     *   ( )  !\n     */\n    playShieldEffect(x, y) {\n        if (!this.emitter)\n            return;\n        //   \n        this.emitter.flash(x, y, 0x00ffff, 100);\n        //   \n        this.emitter.flash(x, y, 0x4444ff, 80);\n        //   \n        this.emitter.burst(x, y, 40, 0x66bbff, { speed: 4, size: 7, life: 40 });\n        //   \n        this.emitter.burst(x, y, 25, 0xaaeeff, { speed: 3, size: 5, life: 35 });\n        //    (3)\n        for (let i = 0; i < 3; i++) {\n            setTimeout(() => {\n                this.emitter?.burst(x, y, 20, 0x88ddff, { speed: 2 + i, size: 4, life: 30 });\n            }, i * 100);\n        }\n    }\n    /**\n     *    ( )  !\n     */\n    playEnergyEffect(x, y) {\n        if (!this.emitter)\n            return;\n        //   \n        this.emitter.flash(x, y, 0xffff00, 80);\n        //   \n        this.emitter.rise(x, y, 30, 0xffdd44, { speed: 2.5, size: 7, life: 50 });\n        //   \n        this.emitter.rise(x, y, 20, 0xffaa00, { speed: 2, size: 6, life: 45 });\n        //   \n        this.emitter.burst(x, y, 15, 0xffffaa, { speed: 3, size: 5, life: 35 });\n    }\n    /**\n     *   ( )  !\n     */\n    playDrawEffect(x, y) {\n        if (!this.emitter)\n            return;\n        //   \n        this.emitter.flash(x, y, 0x00ffff, 70);\n        //   ()\n        this.emitter.spray(x, y, 35, -Math.PI / 2, Math.PI / 3, 0x44dddd, { speed: 4, size: 6, life: 40 });\n        //  \n        this.emitter.spray(x, y, 25, -Math.PI / 2, Math.PI / 3, 0x88eeff, { speed: 3.5, size: 5, life: 35 });\n        //  \n        this.emitter.burst(x, y, 15, 0xaaffff, { speed: 2, size: 4, life: 30 });\n    }\n    // ===   ===\n    /**\n     *   ()  !\n     */\n    playBurnEffect(x, y) {\n        if (!this.emitter)\n            return;\n        //  \n        this.emitter.flash(x, y, 0xff6600, 60);\n        //    \n        this.emitter.rise(x, y, 25, 0xff3300, { speed: 2.5, size: 8, life: 45 });\n        //   \n        this.emitter.rise(x, y, 20, 0xff6600, { speed: 2, size: 7, life: 40 });\n        //    ( )\n        this.emitter.rise(x, y, 15, 0xffaa00, { speed: 1.8, size: 6, life: 35 });\n        //   \n        setTimeout(() => {\n            this.emitter?.rise(x, y, 10, 0x442222, { speed: 1.2, size: 10, life: 50 });\n        }, 100);\n    }\n    /**\n     *   ( )  !\n     */\n    playFreezeEffect(x, y) {\n        if (!this.emitter)\n            return;\n        //   \n        this.emitter.flash(x, y, 0xffffff, 70);\n        //   \n        this.emitter.flash(x, y, 0xaaeeff, 90);\n        //   \n        this.emitter.burst(x, y, 35, 0x88ddff, { speed: 4, size: 6, life: 50 });\n        //   \n        this.emitter.burst(x, y, 30, 0xccffff, { speed: 3, size: 5, life: 45 });\n        //   \n        this.emitter.burst(x, y, 20, 0x4488ff, { speed: 2, size: 7, life: 40 });\n        //  \n        setTimeout(() => {\n            this.emitter?.rain(x, y, 15, 0xeeffff, { width: 80, speed: 1.5, size: 4, life: 55 });\n        }, 100);\n    }\n    /**\n     *   ()  !\n     */\n    playShockEffect(x, y) {\n        if (!this.emitter)\n            return;\n        //   \n        this.emitter.flash(x, y, 0xffffff, 90);\n        //   \n        this.emitter.flash(x, y, 0xffff00, 70);\n        //    ( )\n        this.emitter.burst(x, y, 50, 0xffff44, { speed: 8, size: 4, life: 20 });\n        //   \n        this.emitter.burst(x, y, 30, 0x88ffff, { speed: 6, size: 3, life: 18 });\n        //   ()\n        setTimeout(() => {\n            this.emitter?.burst(x, y, 20, 0xaa88ff, { speed: 7, size: 3, life: 15 });\n        }, 50);\n        //   \n        setTimeout(() => {\n            this.emitter?.flash(x, y, 0xffff44, 50);\n            this.emitter?.burst(x, y, 15, 0xffffaa, { speed: 5, size: 2, life: 12 });\n        }, 120);\n    }\n    /**\n     *   ( )  !\n     */\n    playVulnerableEffect(x, y) {\n        if (!this.emitter)\n            return;\n        //   \n        this.emitter.flash(x, y, 0x8800aa, 80);\n        //   \n        this.emitter.flash(x, y, 0xaa44aa, 60);\n        //    \n        this.emitter.burst(x, y, 30, 0xdd66dd, { speed: 3, size: 7, life: 45 });\n        //   \n        this.emitter.burst(x, y, 20, 0xff88ff, { speed: 2, size: 6, life: 40 });\n        //   \n        setTimeout(() => {\n            this.emitter?.rise(x, y, 15, 0x662288, { speed: 1.5, size: 8, life: 50 });\n        }, 100);\n    }\n    /**\n     *   ( )  !\n     */\n    playBuffEffect(x, y) {\n        if (!this.emitter)\n            return;\n        //   \n        this.emitter.flash(x, y, 0xffffff, 90);\n        //  \n        this.emitter.flash(x, y, 0xffd700, 70);\n        //   \n        this.emitter.rise(x, y, 40, 0xffee44, { speed: 2.5, size: 8, life: 50 });\n        //  \n        this.emitter.rise(x, y, 30, 0xffaa00, { speed: 2, size: 7, life: 45 });\n        //   \n        this.emitter.burst(x, y, 20, 0xffffaa, { speed: 3, size: 6, life: 40 });\n    }\n    // ===    ===\n    /**\n     *   ( )  !\n     */\n    playVictoryEffect(x, y) {\n        if (!this.emitter)\n            return;\n        //   \n        this.emitter.flash(x, y, 0xffffff, 120);\n        this.emitter.flash(x, y, 0xffd700, 100);\n        this.emitter.burst(x, y, 60, 0xffd700, { speed: 6, size: 10, life: 60 });\n        // 2: / \n        setTimeout(() => {\n            this.emitter?.flash(x, y - 50, 0xff6600, 80);\n            this.emitter?.burst(x, y - 50, 40, 0xff6600, { speed: 5, size: 8, life: 50 });\n            this.emitter?.burst(x + 50, y, 30, 0xff4444, { speed: 4, size: 7, life: 45 });\n        }, 200);\n        // 3: / \n        setTimeout(() => {\n            this.emitter?.flash(x, y + 50, 0x44ff44, 80);\n            this.emitter?.burst(x, y + 50, 40, 0x44ff44, { speed: 5, size: 8, life: 50 });\n            this.emitter?.burst(x - 50, y, 30, 0x4444ff, { speed: 4, size: 7, life: 45 });\n        }, 400);\n        // 4:   \n        setTimeout(() => {\n            this.emitter?.burst(x, y, 50, 0xffffff, { speed: 7, size: 6, life: 55 });\n        }, 600);\n    }\n    /**\n     *   ( )  !\n     */\n    playDefeatEffect(x, y) {\n        if (!this.emitter)\n            return;\n        //  \n        this.emitter.flash(x, y, 0x000000, 100);\n        this.emitter.flash(x, y, 0x444444, 80);\n        //   \n        this.emitter.rain(x, y, 50, 0x666666, { width: 200, speed: 2, size: 6, life: 80 });\n        //   \n        this.emitter.rise(x, y, 30, 0x333333, { speed: 1, size: 10, life: 70 });\n        //   \n        this.emitter.burst(x, y, 25, 0x222222, { speed: 3, size: 8, life: 60 });\n    }\n    /**\n     *    ()  !\n     */\n    playCardTrailEffect(x, y, color) {\n        if (!this.emitter)\n            return;\n        //  \n        this.emitter.flash(x, y, color, 60);\n        //   \n        this.emitter.spray(x, y, 25, Math.PI / 2, Math.PI / 2, color, { speed: 3, size: 6, life: 35 });\n        //   \n        const brightColor = color | 0x888888; // \n        this.emitter.spray(x, y, 15, Math.PI / 2, Math.PI / 3, brightColor, { speed: 2.5, size: 5, life: 30 });\n        //  \n        this.emitter.burst(x, y, 10, 0xffffff, { speed: 2, size: 4, life: 25 });\n    }\n    clear() {\n        this.emitter?.clear();\n    }\n}\n//  \nexport const vfxManager = new VFXManager();\n","/**\n *    \n * requestAnimationFrame \n */\n// Easing \nexport const Easing = {\n    linear: (t) => t,\n    easeInQuad: (t) => t * t,\n    easeOutQuad: (t) => t * (2 - t),\n    easeInOutQuad: (t) => (t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t),\n    easeInCubic: (t) => t * t * t,\n    easeOutCubic: (t) => (--t) * t * t + 1,\n    easeInOutCubic: (t) => (t < 0.5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1),\n    easeInQuart: (t) => t * t * t * t,\n    easeOutQuart: (t) => 1 - (--t) * t * t * t,\n    easeInOutQuart: (t) => (t < 0.5 ? 8 * t * t * t * t : 1 - 8 * (--t) * t * t * t),\n    easeInElastic: (t) => {\n        if (t === 0 || t === 1)\n            return t;\n        return -Math.pow(2, 10 * (t - 1)) * Math.sin((t - 1.1) * 5 * Math.PI);\n    },\n    easeOutElastic: (t) => {\n        if (t === 0 || t === 1)\n            return t;\n        return Math.pow(2, -10 * t) * Math.sin((t - 0.1) * 5 * Math.PI) + 1;\n    },\n    easeOutBounce: (t) => {\n        const n1 = 7.5625;\n        const d1 = 2.75;\n        if (t < 1 / d1) {\n            return n1 * t * t;\n        }\n        else if (t < 2 / d1) {\n            return n1 * (t -= 1.5 / d1) * t + 0.75;\n        }\n        else if (t < 2.5 / d1) {\n            return n1 * (t -= 2.25 / d1) * t + 0.9375;\n        }\n        else {\n            return n1 * (t -= 2.625 / d1) * t + 0.984375;\n        }\n    },\n};\nclass Tween {\n    constructor(options) {\n        this.startTime = null;\n        this.rafId = null;\n        this.running = false;\n        this.options = {\n            from: options.from,\n            to: options.to,\n            duration: options.duration,\n            easing: options.easing || Easing.easeOutQuad,\n            onUpdate: options.onUpdate || (() => { }),\n            onComplete: options.onComplete || (() => { }),\n        };\n    }\n    start() {\n        if (this.running)\n            return this;\n        this.running = true;\n        this.startTime = null;\n        const animate = (timestamp) => {\n            if (!this.running)\n                return;\n            if (!this.startTime) {\n                this.startTime = timestamp;\n            }\n            const elapsed = timestamp - this.startTime;\n            const progress = Math.min(elapsed / this.options.duration, 1);\n            const easedProgress = this.options.easing(progress);\n            const currentValue = this.options.from + (this.options.to - this.options.from) * easedProgress;\n            this.options.onUpdate(currentValue);\n            if (progress < 1) {\n                this.rafId = requestAnimationFrame(animate);\n            }\n            else {\n                this.running = false;\n                this.options.onComplete();\n            }\n        };\n        this.rafId = requestAnimationFrame(animate);\n        return this;\n    }\n    stop() {\n        if (this.rafId !== null) {\n            cancelAnimationFrame(this.rafId);\n            this.rafId = null;\n        }\n        this.running = false;\n        return this;\n    }\n    isRunning() {\n        return this.running;\n    }\n}\n/**\n *   (  )\n */\nclass TweenManager {\n    constructor() {\n        this.tweens = new Set();\n    }\n    create(options) {\n        const tween = new Tween(options);\n        this.tweens.add(tween);\n        //    \n        const originalOnComplete = options.onComplete;\n        tween['options'].onComplete = () => {\n            if (originalOnComplete)\n                originalOnComplete();\n            this.tweens.delete(tween);\n        };\n        return tween;\n    }\n    stopAll() {\n        this.tweens.forEach(tween => tween.stop());\n        this.tweens.clear();\n    }\n    getActiveTweensCount() {\n        return this.tweens.size;\n    }\n}\n//  \nexport const tweenManager = new TweenManager();\n/**\n *  :   \n */\nexport function tweenNumber(from, to, duration, onUpdate, options) {\n    return tweenManager.create({\n        from,\n        to,\n        duration,\n        easing: options?.easing,\n        onUpdate,\n        onComplete: options?.onComplete,\n    }).start();\n}\n/**\n *  :   \n */\nexport function tweenDelay(duration, onComplete) {\n    return tweenManager.create({\n        from: 0,\n        to: 1,\n        duration,\n        onUpdate: () => { },\n        onComplete,\n    }).start();\n}\n/**\n *  :  \n */\nexport function tweenSequence(tweens) {\n    if (tweens.length === 0)\n        return;\n    const runNext = (index) => {\n        if (index >= tweens.length)\n            return;\n        const tween = tweens[index]();\n        const originalOnComplete = tween['options'].onComplete;\n        tween['options'].onComplete = () => {\n            if (originalOnComplete)\n                originalOnComplete();\n            runNext(index + 1);\n        };\n    };\n    runNext(0);\n}\n/**\n *  :  \n */\nexport function tweenParallel(tweens, onAllComplete) {\n    if (tweens.length === 0) {\n        if (onAllComplete)\n            onAllComplete();\n        return;\n    }\n    let completedCount = 0;\n    tweens.forEach(createTween => {\n        const tween = createTween();\n        const originalOnComplete = tween['options'].onComplete;\n        tween['options'].onComplete = () => {\n            if (originalOnComplete)\n                originalOnComplete();\n            completedCount++;\n            if (completedCount === tweens.length && onAllComplete) {\n                onAllComplete();\n            }\n        };\n    });\n}\n","/**\n *   \n * Web Audio API \n */\nclass AudioManager {\n    constructor() {\n        this.tracks = new Map();\n        this.settings = {\n            masterVolume: 0.7,\n            bgmVolume: 0.5,\n            sfxVolume: 0.8,\n            muted: false,\n        };\n        this.currentBGM = null;\n        // localStorage  \n        this.loadSettings();\n    }\n    /**\n     *    ()\n     */\n    register(name, path, type = 'sfx') {\n        if (this.tracks.has(name)) {\n            console.warn(`[Audio] Sound \"${name}\" is already registered.`);\n            return;\n        }\n        const audio = new Audio();\n        audio.preload = 'auto';\n        const track = {\n            name,\n            type,\n            audio: null,\n            loaded: false,\n            isPlaying: false,\n        };\n        audio.addEventListener('canplaythrough', () => {\n            track.loaded = true;\n            console.log(`[Audio] Loaded: ${name}`);\n        });\n        audio.addEventListener('error', (e) => {\n            console.warn(`[Audio] Failed to load: ${name}`, e);\n            track.audio = null;\n        });\n        audio.src = path;\n        track.audio = audio;\n        // BGM  \n        if (type === 'bgm') {\n            audio.loop = true;\n        }\n        this.tracks.set(name, track);\n    }\n    /**\n     *   ()\n     */\n    playSFX(name, volume) {\n        if (this.settings.muted)\n            return;\n        const track = this.tracks.get(name);\n        if (!track || !track.audio || !track.loaded) {\n            console.warn(`[Audio] SFX not found or not loaded: ${name}`);\n            return;\n        }\n        //   (  )\n        const clone = track.audio.cloneNode();\n        const effectiveVolume = (volume ?? 1.0) *\n            this.settings.sfxVolume *\n            this.settings.masterVolume;\n        clone.volume = Math.max(0, Math.min(1, effectiveVolume));\n        clone.play().catch(err => {\n            console.warn(`[Audio] Failed to play SFX: ${name}`, err);\n        });\n    }\n    /**\n     *  \n     */\n    playBGM(name, fadeIn = true) {\n        if (this.currentBGM === name)\n            return;\n        //  BGM \n        if (this.currentBGM) {\n            this.stopBGM(true);\n        }\n        if (this.settings.muted) {\n            this.currentBGM = name;\n            return;\n        }\n        const track = this.tracks.get(name);\n        if (!track || !track.audio || !track.loaded) {\n            console.warn(`[Audio] BGM not found or not loaded: ${name}`);\n            return;\n        }\n        const audio = track.audio;\n        const targetVolume = this.settings.bgmVolume * this.settings.masterVolume;\n        if (fadeIn) {\n            audio.volume = 0;\n            audio.play().catch(err => {\n                console.warn(`[Audio] Failed to play BGM: ${name}`, err);\n            });\n            //   (2)\n            let currentVol = 0;\n            const fadeInterval = setInterval(() => {\n                currentVol += 0.02;\n                if (currentVol >= targetVolume) {\n                    audio.volume = targetVolume;\n                    clearInterval(fadeInterval);\n                }\n                else {\n                    audio.volume = currentVol;\n                }\n            }, 40); // 2000ms / 50 steps = 40ms\n        }\n        else {\n            audio.volume = targetVolume;\n            audio.play().catch(err => {\n                console.warn(`[Audio] Failed to play BGM: ${name}`, err);\n            });\n        }\n        track.isPlaying = true;\n        this.currentBGM = name;\n    }\n    /**\n     *  \n     */\n    stopBGM(fadeOut = true) {\n        if (!this.currentBGM)\n            return;\n        const track = this.tracks.get(this.currentBGM);\n        if (!track || !track.audio)\n            return;\n        const audio = track.audio;\n        if (fadeOut) {\n            //   (1)\n            const fadeInterval = setInterval(() => {\n                if (audio.volume > 0.02) {\n                    audio.volume -= 0.02;\n                }\n                else {\n                    audio.pause();\n                    audio.currentTime = 0;\n                    clearInterval(fadeInterval);\n                }\n            }, 20); // 1000ms / 50 steps = 20ms\n        }\n        else {\n            audio.pause();\n            audio.currentTime = 0;\n        }\n        track.isPlaying = false;\n        this.currentBGM = null;\n    }\n    /**\n     *  /\n     */\n    pauseBGM() {\n        if (!this.currentBGM)\n            return;\n        const track = this.tracks.get(this.currentBGM);\n        if (track?.audio) {\n            track.audio.pause();\n            track.isPlaying = false;\n        }\n    }\n    resumeBGM() {\n        if (!this.currentBGM)\n            return;\n        const track = this.tracks.get(this.currentBGM);\n        if (track?.audio && !this.settings.muted) {\n            track.audio.play();\n            track.isPlaying = true;\n        }\n    }\n    /**\n     *  \n     */\n    setMasterVolume(volume) {\n        this.settings.masterVolume = Math.max(0, Math.min(1, volume));\n        this.updateBGMVolume();\n        this.saveSettings();\n    }\n    setBGMVolume(volume) {\n        this.settings.bgmVolume = Math.max(0, Math.min(1, volume));\n        this.updateBGMVolume();\n        this.saveSettings();\n    }\n    setSFXVolume(volume) {\n        this.settings.sfxVolume = Math.max(0, Math.min(1, volume));\n        this.saveSettings();\n    }\n    updateBGMVolume() {\n        if (!this.currentBGM)\n            return;\n        const track = this.tracks.get(this.currentBGM);\n        if (track?.audio) {\n            track.audio.volume = this.settings.bgmVolume * this.settings.masterVolume;\n        }\n    }\n    /**\n     *  \n     */\n    setMuted(muted) {\n        this.settings.muted = muted;\n        if (muted) {\n            this.pauseBGM();\n        }\n        else {\n            this.resumeBGM();\n        }\n        this.saveSettings();\n    }\n    toggleMute() {\n        this.setMuted(!this.settings.muted);\n        return this.settings.muted;\n    }\n    /**\n     *  \n     */\n    getSettings() {\n        return { ...this.settings };\n    }\n    /**\n     *   (localStorage)\n     */\n    saveSettings() {\n        localStorage.setItem('gals_audio_settings', JSON.stringify(this.settings));\n    }\n    /**\n     *   (localStorage)\n     */\n    loadSettings() {\n        const saved = localStorage.getItem('gals_audio_settings');\n        if (saved) {\n            try {\n                const parsed = JSON.parse(saved);\n                this.settings = {\n                    masterVolume: parsed.masterVolume ?? 0.7,\n                    bgmVolume: parsed.bgmVolume ?? 0.5,\n                    sfxVolume: parsed.sfxVolume ?? 0.8,\n                    muted: parsed.muted ?? false,\n                };\n                console.log('[Audio] Settings loaded:', this.settings);\n            }\n            catch (e) {\n                console.warn('[Audio] Failed to load settings:', e);\n            }\n        }\n    }\n    /**\n     *   \n     */\n    stopAll() {\n        this.stopBGM(false);\n        this.tracks.forEach(track => {\n            if (track.audio) {\n                track.audio.pause();\n                track.audio.currentTime = 0;\n                track.isPlaying = false;\n            }\n        });\n    }\n    /**\n     *  \n     */\n    getDebugInfo() {\n        const loaded = Array.from(this.tracks.values()).filter(t => t.loaded).length;\n        const total = this.tracks.size;\n        return `Audio: ${loaded}/${total} loaded, BGM: ${this.currentBGM || 'none'}, Muted: ${this.settings.muted}`;\n    }\n}\n//  \nexport const audioManager = new AudioManager();\n/**\n *    \n */\nexport const SoundPaths = {\n    // SFX - \n    cardPlay: 'sounds/sfx/card_play.mp3',\n    cardDraw: 'sounds/sfx/card_draw.mp3',\n    cardShuffle: 'sounds/sfx/card_shuffle.mp3',\n    // SFX - \n    damage: 'sounds/sfx/damage.mp3',\n    heal: 'sounds/sfx/heal.mp3',\n    shield: 'sounds/sfx/shield.mp3',\n    critical: 'sounds/sfx/critical.mp3',\n    // SFX - \n    burn: 'sounds/sfx/burn.mp3',\n    freeze: 'sounds/sfx/freeze.mp3',\n    shock: 'sounds/sfx/shock.mp3',\n    // SFX - UI\n    buttonClick: 'sounds/sfx/button_click.mp3',\n    buttonHover: 'sounds/sfx/button_hover.mp3',\n    menuOpen: 'sounds/sfx/menu_open.mp3',\n    turnEnd: 'sounds/sfx/turn_end.mp3',\n    // SFX -  \n    victory: 'sounds/sfx/victory.mp3',\n    defeat: 'sounds/sfx/defeat.mp3',\n    levelUp: 'sounds/sfx/level_up.mp3',\n    // BGM\n    bgmMenu: 'sounds/bgm/menu.mp3',\n    bgmBattle: 'sounds/bgm/battle.mp3',\n    bgmShop: 'sounds/bgm/shop.mp3',\n    bgmVictory: 'sounds/bgm/victory_jingle.mp3',\n};\n/**\n *    ()\n */\nexport function initAudio() {\n    console.log('[Audio] Initializing audio system...');\n    // SFX \n    audioManager.register('card_play', SoundPaths.cardPlay, 'sfx');\n    audioManager.register('card_draw', SoundPaths.cardDraw, 'sfx');\n    audioManager.register('card_shuffle', SoundPaths.cardShuffle, 'sfx');\n    audioManager.register('damage', SoundPaths.damage, 'sfx');\n    audioManager.register('heal', SoundPaths.heal, 'sfx');\n    audioManager.register('shield', SoundPaths.shield, 'sfx');\n    audioManager.register('critical', SoundPaths.critical, 'sfx');\n    audioManager.register('burn', SoundPaths.burn, 'sfx');\n    audioManager.register('freeze', SoundPaths.freeze, 'sfx');\n    audioManager.register('shock', SoundPaths.shock, 'sfx');\n    audioManager.register('button_click', SoundPaths.buttonClick, 'sfx');\n    audioManager.register('button_hover', SoundPaths.buttonHover, 'sfx');\n    audioManager.register('menu_open', SoundPaths.menuOpen, 'sfx');\n    audioManager.register('turn_end', SoundPaths.turnEnd, 'sfx');\n    audioManager.register('victory', SoundPaths.victory, 'sfx');\n    audioManager.register('defeat', SoundPaths.defeat, 'sfx');\n    audioManager.register('level_up', SoundPaths.levelUp, 'sfx');\n    // BGM \n    audioManager.register('bgm_menu', SoundPaths.bgmMenu, 'bgm');\n    audioManager.register('bgm_battle', SoundPaths.bgmBattle, 'bgm');\n    audioManager.register('bgm_shop', SoundPaths.bgmShop, 'bgm');\n    audioManager.register('bgm_victory', SoundPaths.bgmVictory, 'bgm');\n    console.log('[Audio] Audio system initialized');\n    console.log(audioManager.getDebugInfo());\n}\n","/**\n *   \n */\nclass ToastManager {\n    constructor() {\n        this.container = null;\n        this.toastId = 0;\n    }\n    init() {\n        this.container = document.getElementById('toast-container');\n    }\n    show(message, options = {}) {\n        if (!this.container)\n            return;\n        const { type = 'info', duration = 3000, title = this.getDefaultTitle(type) } = options;\n        const toastId = ++this.toastId;\n        const toast = document.createElement('div');\n        toast.className = `toast ${type}`;\n        toast.setAttribute('data-toast-id', String(toastId));\n        const icon = this.getIcon(type);\n        toast.innerHTML = `\r\n      <div class=\"toast-header\">\r\n        <span class=\"toast-icon\">${icon}</span>\r\n        <span>${title}</span>\r\n        <button class=\"toast-close\" aria-label=\"Close\"></button>\r\n      </div>\r\n      <div class=\"toast-message\">${message}</div>\r\n    `;\n        const closeBtn = toast.querySelector('.toast-close');\n        closeBtn.onclick = () => this.close(toastId);\n        this.container.appendChild(toast);\n        //  \n        if (duration > 0) {\n            setTimeout(() => this.close(toastId), duration);\n        }\n        return toastId;\n    }\n    close(toastId) {\n        if (!this.container)\n            return;\n        const toast = this.container.querySelector(`[data-toast-id=\"${toastId}\"]`);\n        if (toast) {\n            toast.classList.add('fadeOut');\n            setTimeout(() => {\n                toast.remove();\n            }, 300);\n        }\n    }\n    getDefaultTitle(type) {\n        switch (type) {\n            case 'success': return ' ';\n            case 'error': return ' ';\n            case 'warning': return ' ';\n            case 'info': return ' ';\n        }\n    }\n    getIcon(type) {\n        switch (type) {\n            case 'success': return '';\n            case 'error': return '';\n            case 'warning': return '';\n            case 'info': return '';\n        }\n    }\n    success(message, duration) {\n        return this.show(message, { type: 'success', duration });\n    }\n    error(message, duration) {\n        return this.show(message, { type: 'error', duration });\n    }\n    warning(message, duration) {\n        return this.show(message, { type: 'warning', duration });\n    }\n    info(message, duration) {\n        return this.show(message, { type: 'info', duration });\n    }\n}\n//  \nexport const toastManager = new ToastManager();\n/**\n *   \n */\nclass LoadingManager {\n    constructor() {\n        this.loadingScreen = null;\n        this.loadingText = null;\n        this.loadingProgress = null;\n    }\n    init() {\n        this.loadingScreen = document.getElementById('loading-screen');\n        this.loadingText = this.loadingScreen?.querySelector('.loading-text') || null;\n        this.loadingProgress = document.getElementById('loading-progress');\n    }\n    show(text = 'Loading...') {\n        if (!this.loadingScreen)\n            return;\n        this.loadingScreen.classList.remove('hidden');\n        if (this.loadingText) {\n            this.loadingText.textContent = text;\n        }\n    }\n    hide() {\n        if (!this.loadingScreen)\n            return;\n        this.loadingScreen.classList.add('hidden');\n    }\n    setProgress(percent, text) {\n        if (this.loadingProgress) {\n            this.loadingProgress.textContent = `${Math.round(percent)}%`;\n        }\n        if (text && this.loadingText) {\n            this.loadingText.textContent = text;\n        }\n    }\n}\n//  \nexport const loadingManager = new LoadingManager();\n","/**\n *   Variation  \n *\n * Variation :\n * 1. :    \n * 2. :    \n * 3. :   \n * 4. :  //  \n */\n/**\n *  ID      \n * @param stageId  ID (1-50)\n * @param context Variation  \n * @returns   \n */\nexport function getBackgroundVariation(stageId, context = { type: 'random' }) {\n    const stageNames = {\n        // Chapter 1\n        1: 'training',\n        2: 'fire',\n        3: 'ice',\n        4: 'lightning',\n        5: 'wind',\n        6: 'fire_ice',\n        7: 'storm',\n        8: 'elite',\n        9: 'corridor',\n        10: 'drake_estate', // Elena Drake\n        // Chapter 2\n        11: 'training_evening',\n        12: 'fire_master',\n        13: 'ice_master',\n        14: 'lightning_master',\n        15: 'wind_master',\n        16: 'earth_master',\n        17: 'fire_ice_clash',\n        18: 'garden',\n        19: 'shadow_trial',\n        20: 'elite_training',\n        // Chapter 3\n        21: 'fusion_lab',\n        22: 'drake_ballroom',\n        23: 'royal_arena',\n        24: 'stone_battlefield',\n        25: 'void_abyss',\n        26: 'belmont_hq',\n        27: 'drake_arena',\n        28: 'tactics_arena',\n        29: 'wind_temple',\n        30: 'throne_room', // Elder Belmont\n        // Chapter 4\n        31: 'wedding_ceremony',\n        32: 'royal_palace',\n        33: 'belmont_mansion',\n        34: 'council_room',\n        35: 'secret_meeting',\n        36: 'magic_lab',\n        37: 'ancient_ruin',\n        38: 'drake_estate',\n        39: 'newlywed_retreat',\n        40: 'dark_forest',\n        // Chapter 5\n        41: 'cursed_land',\n        42: 'barren_wasteland',\n        43: 'dark_kingdom',\n        44: 'dark_fortress',\n        45: 'cult_headquarters',\n        46: 'secret_chamber',\n        47: 'chaos_battlefield',\n        48: 'belmont_arena',\n        49: 'drake_final_stand',\n        50: 'void_dimension',\n    };\n    const stageName = stageNames[stageId];\n    if (!stageName) {\n        console.warn(`[Background] Invalid stage ID: ${stageId}, using fallback`);\n        return 'backgrounds/fallback_1.png';\n    }\n    let variationNumber = 1;\n    switch (context.type) {\n        case 'random':\n            // : 1-3  \n            variationNumber = Math.floor(Math.random() * 3) + 1;\n            break;\n        case 'sequential':\n            // :    \n            variationNumber = (context.playCount % 3) + 1;\n            break;\n        case 'difficulty':\n            // : Normal(1), Hard(2), Extreme(3)\n            variationNumber =\n                context.level === 'normal' ? 1 :\n                    context.level === 'hard' ? 2 : 3;\n            break;\n        case 'scene':\n            // : Pre(1), Battle(2), Post(3)\n            variationNumber =\n                context.phase === 'pre' ? 1 :\n                    context.phase === 'battle' ? 2 : 3;\n            break;\n    }\n    const path = `backgrounds/stage_${String(stageId).padStart(2, '0')}_${stageName}_${variationNumber}.png`;\n    console.log(`[Background] Stage ${stageId} (${stageName})  Variation ${variationNumber} (${context.type})`);\n    return path;\n}\n/**\n *      (Victory, Defeat, Fallback)\n * @param type  \n * @param variationNumber Variation  (1-3)\n * @returns   \n */\nexport function getSpecialBackground(type, variationNumber = 1) {\n    const clampedVariation = Math.max(1, Math.min(3, variationNumber));\n    return `backgrounds/${type}_${clampedVariation}.png`;\n}\n","import { Application, Assets, Sprite, Container, Text, Graphics } from 'pixi.js';\nimport type { Card } from './types';\nimport { getCardImagePath, getCardImagePathFallback } from './cardImage';\nimport { t, setLocale, getCurrentLocale } from './i18n';\nimport {\n  useBattleStore,\n  setVFXCallback,\n  setPositionCallback,\n  setCardUseAnimationCallback,\n  setHandTrackingResetCallback,\n  setEnemyHandUpdateCallback,\n  getBoostedStageReward,\n  getPvpRankInfo,\n} from './store';\nimport { handleAuthSessionChange } from './cloudSave';\nimport { useAuthStore } from './authStore';\nimport { loadSampleCards } from './data';\nimport { preloadCardImages, getLoadedCardImage, isCardImageLoaded, getCardBackImage } from './assetLoader';\nimport { playerHandPool, enemyHandPool } from './cardPool';\nimport { vfxManager } from './vfx';\nimport { tweenNumber, Easing } from './tweens';\nimport { audioManager, initAudio } from './audio';\nimport { toastManager, loadingManager } from './toast';\nimport { getSpecialBackground } from './utils/backgroundVariation';\n\nconst STARTER_COLLECTION_CARD_IDS_SAFE: readonly string[] = [\n  'ATT_ARIANA_NO_001',\n  'ATT_ARIANA_NO_001',\n  'ATT_DARIUS_NO_017',\n  'ATT_KAI_NO_097',\n  'ATT_LUCIAN_NO_129',\n  'ATT_MARCUS_NO_145',\n  'DEF_ARIANA_NO_013',\n  'DEF_DARIUS_NO_025',\n  'DEF_GAREN_NO_077',\n  'DEF_LEON_NO_121',\n  'DEF_LUCIAN_NO_137',\n  'HEA_ARIANA_NO_005',\n  'HEA_IRIS_NO_085',\n  'HEA_DARIUS_NO_021',\n  'HEA_LUCIAN_NO_133',\n  'SPE_ARIANA_NO_009',\n  'SPE_DARIUS_NO_029',\n  'SPE_KAI_NO_105',\n  'SPE_LEON_NO_125',\n  'SPE_MARCUS_NO_153',\n  'ATT_ELDER_NO_033',\n  'DEF_KAI_NO_109',\n  'DEF_MARCUS_NO_157',\n  'HEA_KAI_NO_101',\n  'HEA_MARCUS_NO_149',\n  'SPE_ELDER_NO_041',\n  'SPE_LUCIAN_NO_213',\n];\n\nconst app = new Application();\nconst root = document.getElementById('app')!;\nroot.replaceChildren();\n\nlet updateBattleLayoutRef: (() => void) | null = null;\nlet layoutBattleBgRef: (() => void) | null = null;\nlet handContainerRef: Container | null = null;\nlet appReady = false;\nlet lastViewportWidth = 0;\nlet lastViewportHeight = 0;\nlet layoutRefreshTimer: number | null = null;\n\nfunction getViewportSize() {\n  const vv = window.visualViewport;\n  if (vv) {\n    return {\n      width: Math.max(1, Math.round(vv.width)),\n      height: Math.max(1, Math.round(vv.height)),\n    };\n  }\n  return {\n    width: Math.max(1, Math.round(window.innerWidth)),\n    height: Math.max(1, Math.round(window.innerHeight)),\n  };\n}\n\nfunction scheduleLayoutRefresh() {\n  layoutRefreshTimer && window.clearTimeout(layoutRefreshTimer);\n  applyViewportSize();\n  layoutRefreshTimer = window.setTimeout(() => {\n    applyViewportSize();\n    layoutRefreshTimer = null;\n  }, 260);\n}\n\nfunction applyViewportSize() {\n  if (!appReady) return;\n  const { width, height } = getViewportSize();\n  if (width === lastViewportWidth && height === lastViewportHeight) {\n    return;\n  }\n  lastViewportWidth = width;\n  lastViewportHeight = height;\n  app.renderer.resize(width, height);\n  layoutBattleBgRef?.();\n  updateBattleLayoutRef?.();\n  requestAnimationFrame(() => {\n    layoutBattleBgRef?.();\n    updateBattleLayoutRef?.();\n  });\n}\n\nfunction updateViewportFlags() {\n  const { width, height } = getViewportSize();\n  const isLandscape = width > height;\n  const isCompactHeight = height <= 580;\n  const shouldApplyCompact = isLandscape && isCompactHeight && width <= 1280;\n  document.body.classList.toggle('mobile-landscape', shouldApplyCompact);\n  scheduleLayoutRefresh();\n}\n\nupdateViewportFlags();\nwindow.addEventListener('resize', updateViewportFlags);\nwindow.addEventListener('orientationchange', updateViewportFlags);\nif (window.visualViewport) {\n  window.visualViewport.addEventListener('resize', updateViewportFlags);\n}\n\nconst { setAuthOverlayEnabled, requestAuthWithCallback } = setupAuthUI();\n\nwindow.addEventListener('auth-force-overlay', () => {\n  setAuthOverlayEnabled(true);\n});\n\n// Menu setup\nconst introRoot = document.getElementById('intro')!;\nconst menuRoot = document.getElementById('menu')!;\nconst menuUserInfoRoot = document.getElementById('menu-user-info') as HTMLElement | null;\nconst menuUserNicknameEl = document.getElementById('menu-user-nickname') as HTMLElement | null;\nconst menuUserStageEl = document.getElementById('menu-user-stage') as HTMLElement | null;\nconst menuUserRankEl = document.getElementById('menu-user-rank') as HTMLElement | null;\nconst menuButtons = menuRoot.querySelectorAll<HTMLButtonElement>('.menu-btn');\nconst deckEditorRoot = document.getElementById('deck-editor')!;\nconst cardGalleryRoot = document.getElementById('card-gallery')!;\nconst MOBILE_DECK_EDITOR_PAGES = ['collection', 'deck', 'stats'] as const;\ntype MobileDeckEditorPage = typeof MOBILE_DECK_EDITOR_PAGES[number];\nlet currentMobileDeckEditorPage: MobileDeckEditorPage = 'collection';\nconst campaignRoot = document.getElementById('campaign')!;\nconst dailyRoot = document.getElementById('daily')!;\nconst rewardRoot = document.getElementById('reward')!;\nconst shopRoot = document.getElementById('shop')!;\nconst pvpRoot = document.getElementById('pvp')!;\nconst tutorialOverlay = document.getElementById('tutorial-overlay')!;\nconst victoryScreen = document.getElementById('victory-screen')!;\nconst defeatScreen = document.getElementById('defeat-screen')!;\nconst cloudSyncOverlay = document.getElementById('cloud-sync-overlay');\nconst cloudSyncText = document.getElementById('cloud-sync-text');\nlet cloudSyncHideTimer: number | null = null;\n\nconst pvpStatusText = document.getElementById('pvp-status-text')!;\nconst pvpOpponentInfo = document.getElementById('pvp-opponent-info')!;\nconst pvpOpponentName = document.getElementById('pvp-opponent-name')!;\nconst pvpErrorText = document.getElementById('pvp-error')!;\nconst pvpStatusIndicator = document.getElementById('pvp-status-indicator') as HTMLElement | null;\nconst pvpSearchBtn = document.getElementById('pvp-search-btn') as HTMLButtonElement;\nconst pvpCancelBtn = document.getElementById('pvp-cancel-btn') as HTMLButtonElement;\nconst pvpBackBtn = document.getElementById('pvp-back-btn') as HTMLButtonElement | null;\n\npvpCancelBtn.disabled = true;\npvpOpponentInfo.classList.add('hidden');\npvpErrorText.classList.remove('visible');\npvpErrorText.textContent = '';\n\nconst announcementModal = document.getElementById('announcement-modal') as HTMLElement | null;\nconst announcementCloseButtons = Array.from(document.querySelectorAll<HTMLButtonElement>('[data-announcement-close]'));\n\nlet announcementHasBeenShown = false;\nlet announcementDismissedPermanently = false;\nlet announcementRemindQueued = false;\n\nfunction openAnnouncementModal() {\n  if (!announcementModal || announcementDismissedPermanently) return;\n  if (announcementModal.classList.contains('active')) return;\n  announcementModal.classList.add('active');\n  document.body.classList.add('modal-open');\n  announcementHasBeenShown = true;\n  announcementRemindQueued = false;\n}\n\nfunction closeAnnouncementModal(reason: 'confirm' | 'close' | 'remind' = 'close') {\n  if (!announcementModal) return;\n  if (!announcementModal.classList.contains('active')) return;\n  announcementModal.classList.remove('active');\n  document.body.classList.remove('modal-open');\n\n  if (reason === 'remind') {\n    announcementHasBeenShown = false;\n    announcementRemindQueued = true;\n  } else {\n    announcementDismissedPermanently = true;\n  }\n}\n\nif (announcementModal) {\n  announcementModal.addEventListener('click', event => {\n    if (event.target === announcementModal) {\n      closeAnnouncementModal('close');\n    }\n  });\n}\n\nannouncementCloseButtons.forEach(button => {\n  button.addEventListener('click', () => {\n    if (button.id === 'announcement-remind-later') {\n      closeAnnouncementModal('remind');\n    } else if (button.id === 'announcement-confirm') {\n      closeAnnouncementModal('confirm');\n    } else {\n      closeAnnouncementModal('close');\n    }\n  });\n});\n\nconst HERO_PORTRAIT_MAP: Record<string, string> = {\n  ARIANA: 'characters/ariana_drake.png',\n  DARIUS: 'characters/darius_blackwood.png',\n  ELDER: 'characters/elder_belmont.png',\n  ELENA: 'characters/elena_drake.png',\n  GAREN: 'characters/garen_stone.png',\n  IRIS: 'characters/iris_belmont.png',\n  KAI: 'characters/kai_drake.png',\n  LEON: 'characters/leon_ardenia.png',\n  LUCIAN: 'characters/lucian_rosegarden.png',\n  MARCUS: 'characters/marcus_belmont.png',\n  MIRA: 'characters/mira.png',\n  SERAPHINA: 'characters/seraphina_belmont.png',\n  SERAPHINE: 'characters/seraphine_winters.png',\n};\n\nconst DEFAULT_PLAYER_PORTRAIT = 'characters/seraphina_belmont.png';\nconst DEFAULT_ENEMY_PORTRAIT = 'characters/ariana_drake.png';\nconst PVP_DEFAULT_BACKGROUND = 'backgrounds/fallback_1.webp';\nconst STORY_TOTAL_STAGE_TARGET = 50;\n\nconst PVP_STATUS_LABELS: Record<string, string> = {\n  idle: ' ',\n  searching: ' ',\n  matched: ' ',\n  error: ''\n};\n\nconst PVP_STATUS_CLASSES = ['status-idle', 'status-searching', 'status-matched', 'status-error'] as const;\n\nfunction resolveDeckPortrait(deck: Card[], fallback: string): string {\n  if (!Array.isArray(deck) || deck.length === 0) {\n    return fallback;\n  }\n  const counts: Record<string, number> = {};\n  deck.forEach(card => {\n    if (!card || !card.id) return;\n    const baseId = card.id.split('__snap__')[0] ?? card.id;\n    const segments = baseId.split('_');\n    if (segments.length < 2) return;\n    const heroKey = segments[1]?.toUpperCase();\n    if (!heroKey || !HERO_PORTRAIT_MAP[heroKey]) return;\n    counts[heroKey] = (counts[heroKey] ?? 0) + 1;\n  });\n  const entries = Object.entries(counts);\n  if (entries.length === 0) {\n    return fallback;\n  }\n  entries.sort((a, b) => b[1] - a[1]);\n  const [topHero] = entries[0];\n  return HERO_PORTRAIT_MAP[topHero] ?? fallback;\n}\n\nfunction showCloudSync(status: 'loading' | 'saving') {\n  if (!cloudSyncOverlay || !cloudSyncText) return;\n  if (cloudSyncHideTimer !== null) {\n    clearTimeout(cloudSyncHideTimer);\n    cloudSyncHideTimer = null;\n  }\n  cloudSyncOverlay.classList.add('active');\n  cloudSyncText.textContent = status === 'loading' ? '  ...' : '  ...';\n}\n\nfunction hideCloudSync(withDelay: boolean = true) {\n  if (!cloudSyncOverlay) return;\n  if (cloudSyncHideTimer !== null) {\n    clearTimeout(cloudSyncHideTimer);\n    cloudSyncHideTimer = null;\n  }\n  const performHide = () => cloudSyncOverlay.classList.remove('active');\n  if (withDelay) {\n    cloudSyncHideTimer = window.setTimeout(() => {\n      performHide();\n      cloudSyncHideTimer = null;\n    }, 200);\n  } else {\n    performHide();\n  }\n}\n\nconst CHARACTER_NAME_MAP: Record<string, string> = {\n  'characters/seraphina_belmont.png': '',\n  'characters/ariana_drake.png': '',\n  'characters/darius_blackwood.png': '',\n  'characters/elder_belmont.png': ' ',\n  'characters/elena_drake.png': '',\n  'characters/garen_stone.png': '',\n  'characters/iris_belmont.png': '',\n  'characters/kai_drake.png': '',\n  'characters/leon_ardenia.png': '',\n  'characters/lucian_rosegarden.png': '',\n  'characters/marcus_belmont.png': '',\n  'characters/mira.png': '',\n  'characters/seraphine_winters.png': '',\n};\n\nconst GENERIC_VICTORY_LINES = [\n  '    .',\n  '  .    .',\n  '  .   .',\n  '.         .',\n];\n\nconst GENERIC_DEFEAT_TAUNTS = [\n  '      .',\n  ' .    .',\n  '  ,  .',\n  ' .    .',\n];\n\nconst STAGE_VICTORY_LINES: Record<number, string[]> = {\n  1: ['  .    ?', '     .'],\n  2: ['  .     .', ' ,   .'],\n  3: ['   ,   .', '      .'],\n};\n\nconst STAGE_DEFEAT_TAUNTS: Record<number, string[]> = {\n  1: ['  .    .', '      .'],\n  2: ['   .     .', '    ,    ?'],\n  3: ['     .   .', '   .    .'],\n};\n\nfunction escapeHtml(text: string): string {\n  return text\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#39;');\n}\n\nfunction pickRandom<T>(items: T[], fallback: T): T {\n  if (!items || items.length === 0) return fallback;\n  const index = Math.floor(Math.random() * items.length);\n  return items[index] ?? fallback;\n}\n\nfunction getDisplayNameFromPortrait(portrait: string | null | undefined, fallback: string): string {\n  if (!portrait) return fallback;\n  return CHARACTER_NAME_MAP[portrait] ?? fallback;\n}\n\ntype OutcomeDialogue = {\n  portrait: string;\n  speaker: string;\n  message: string;\n  subtitle: string;\n  accent: string;\n};\n\nlet cardPreview!: HTMLElement;\nlet closeCardPreview!: () => void;\nlet tooltipRoot!: HTMLElement;\nlet hideTooltip!: () => void;\n\nif (cloudSyncOverlay && cloudSyncText) {\n  window.addEventListener('cloud-sync-status', (event) => {\n    const status = (event as CustomEvent<'loading' | 'saving' | 'idle'>).detail;\n    if (status === 'idle') {\n      hideCloudSync(true);\n    } else {\n      showCloudSync(status);\n    }\n  });\n}\n\nuseBattleStore.subscribe((state) => {\n  const status = state.pvpQueueStatus ?? 'idle';\n  const message = state.pvpStatusMessage;\n  const error = state.pvpError;\n  const match = state.pvpMatch;\n  const isBattleScreen = state.gameScreen === 'battle';\n\n  console.log('[PvP] State updated:', {\n    status,\n    message,\n    error,\n    matchId: match?.matchId,\n    matchStatus: match?.status,\n  });\n\n  const statusLabel = PVP_STATUS_LABELS[status] ?? PVP_STATUS_LABELS.idle;\n  if (pvpStatusIndicator) {\n    pvpStatusIndicator.classList.remove(...PVP_STATUS_CLASSES);\n    pvpStatusIndicator.classList.add(`status-${status}`);\n    pvpStatusIndicator.textContent = statusLabel;\n  }\n\n  const defaultMessage =\n    status === 'idle'\n      ? '   .'\n      : status === 'searching'\n        ? '        ...'\n        : status === 'matched'\n          ? ' .   ...'\n          : '   ...';\n\n  pvpStatusText.textContent = message || defaultMessage;\n\n  if (error) {\n    pvpErrorText.textContent = error;\n    pvpErrorText.classList.add('visible');\n  } else {\n    pvpErrorText.textContent = '';\n    pvpErrorText.classList.remove('visible');\n  }\n\n  if (match) {\n    pvpOpponentInfo.classList.remove('hidden');\n    pvpOpponentName.textContent = match.opponentName ?? ' ';\n  } else {\n    pvpOpponentInfo.classList.add('hidden');\n    pvpOpponentName.textContent = '-';\n  }\n\n  if (!isBattleScreen) {\n    if (cardPreview.classList.contains('active')) {\n      closeCardPreview();\n    }\n    if (tooltipRoot.style.display !== 'none') {\n      hideTooltip();\n    }\n  }\n\n  switch (status) {\n    case 'idle':\n      pvpSearchBtn.disabled = false;\n      pvpCancelBtn.disabled = true;\n      break;\n    case 'searching':\n      pvpSearchBtn.disabled = true;\n      pvpCancelBtn.disabled = false;\n      break;\n    case 'matched':\n      pvpSearchBtn.disabled = true;\n      pvpCancelBtn.disabled = false;\n      break;\n    case 'error':\n      pvpSearchBtn.disabled = false;\n      pvpCancelBtn.disabled = true;\n      break;\n  }\n});\n\nfunction setupAuthUI(): {\n  setAuthOverlayEnabled: (enabled: boolean) => void;\n  requestAuthWithCallback: (onAuthenticated: () => void) => void;\n} {\n  const noopAuthUI = {\n    setAuthOverlayEnabled: (_enabled: boolean) => {},\n    requestAuthWithCallback: (onAuthenticated: () => void) => {\n      if (typeof onAuthenticated === 'function') {\n        onAuthenticated();\n      }\n    }\n  } as const;\n\n  const authScreen = document.getElementById('auth-screen');\n  const authTitle = document.getElementById('auth-title');\n  const authError = document.getElementById('auth-error');\n  const authMessage = document.getElementById('auth-message');\n  const signInForm = document.getElementById('auth-sign-in') as HTMLFormElement | null;\n  const signUpForm = document.getElementById('auth-sign-up') as HTMLFormElement | null;\n  const logoutButton = document.getElementById('auth-sign-out') as HTMLButtonElement | null;\n\n  if (!authScreen || !authTitle || !authError || !authMessage || !signInForm || !signUpForm) {\n    console.warn('[Auth] UI    .');\n    return noopAuthUI;\n  }\n\n  const signInEmail = signInForm.querySelector<HTMLInputElement>('input[name=\"email\"]');\n  const signInPassword = signInForm.querySelector<HTMLInputElement>('input[name=\"password\"]');\n  const signInSubmit = signInForm.querySelector<HTMLButtonElement>('button[type=\"submit\"]');\n  const signUpEmail = signUpForm.querySelector<HTMLInputElement>('input[name=\"email\"]');\n  const signUpPassword = signUpForm.querySelector<HTMLInputElement>('input[name=\"password\"]');\n  const signUpNickname = signUpForm.querySelector<HTMLInputElement>('input[name=\"nickname\"]');\n  const signUpSubmit = signUpForm.querySelector<HTMLButtonElement>('button[type=\"submit\"]');\n\n  if (!signInEmail || !signInPassword || !signInSubmit || !signUpEmail || !signUpPassword || !signUpNickname || !signUpSubmit) {\n    console.warn('[Auth]     .');\n    return noopAuthUI;\n  }\n\n  const toggleButtons = Array.from(document.querySelectorAll<HTMLButtonElement>('[data-auth-view]'));\n  const switchBlocks = Array.from(document.querySelectorAll<HTMLElement>('[data-auth-visible]'));\n  let authOverlayEnabled = false;\n  let pendingAuthCallback: (() => void) | null = null;\n\n  toggleButtons.forEach((btn) => {\n    btn.addEventListener('click', (event) => {\n      event.preventDefault();\n      const view = btn.getAttribute('data-auth-view');\n      if (view === 'sign-in' || view === 'sign-up') {\n        useAuthStore.getState().setAuthView(view);\n        if (view === 'sign-in') {\n          signInEmail.focus();\n        } else {\n          signUpEmail.focus();\n        }\n      }\n    });\n  });\n\n  signUpNickname.addEventListener('input', (event) => {\n    const value = (event.target as HTMLInputElement).value;\n    useAuthStore.getState().setProfileNickname(value);\n  });\n\n  signInForm.addEventListener('submit', async (event) => {\n    event.preventDefault();\n    const email = signInEmail.value.trim();\n    const password = signInPassword.value;\n    if (!email || !password) {\n      useAuthStore.setState({ error: '  .' });\n      return;\n    }\n    await useAuthStore.getState().signIn(email, password);\n  });\n\n  signUpForm.addEventListener('submit', async (event) => {\n    event.preventDefault();\n    const email = signUpEmail.value.trim();\n    const password = signUpPassword.value;\n    const nickname = signUpNickname.value.trim();\n    if (!email || !password) {\n      useAuthStore.setState({ error: '  .' });\n      return;\n    }\n    await useAuthStore.getState().signUp(email, password, nickname);\n    const state = useAuthStore.getState();\n    if (!state.error) {\n      const successMessage = state.message;\n      useAuthStore.setState({ authView: 'sign-in', error: null, message: successMessage });\n      signInEmail.focus();\n    }\n  });\n\n  if (logoutButton) {\n    logoutButton.addEventListener('click', async () => {\n      await useAuthStore.getState().signOut();\n    });\n  }\n\n  const inputs: HTMLInputElement[] = [\n    signInEmail,\n    signInPassword,\n    signUpEmail,\n    signUpPassword,\n    signUpNickname\n  ];\n\n  const updateAuthUIState = () => {\n    const state = useAuthStore.getState();\n    const isAuthed = !!state.session;\n    const shouldShowOverlay = authOverlayEnabled && (!isAuthed || state.initializing);\n    const showForms = shouldShowOverlay && !state.initializing;\n\n    if (authOverlayEnabled) {\n      authScreen.classList.toggle('auth-hidden', !shouldShowOverlay);\n      document.body.classList.toggle('auth-locked', shouldShowOverlay);\n    } else {\n      authScreen.classList.add('auth-hidden');\n      document.body.classList.remove('auth-locked');\n    }\n\n    if (logoutButton) {\n      const shouldShowLogout = authOverlayEnabled && isAuthed;\n      logoutButton.classList.toggle('auth-hidden', !shouldShowLogout);\n      logoutButton.disabled = state.loading;\n    }\n\n    if (state.initializing && authOverlayEnabled) {\n      authTitle.textContent = '  ...';\n    } else {\n      authTitle.textContent = state.authView === 'sign-in' ? ' ' : '';\n    }\n\n    signInForm.classList.toggle('auth-hidden', state.authView !== 'sign-in' || !showForms);\n    signUpForm.classList.toggle('auth-hidden', state.authView !== 'sign-up' || !showForms);\n\n    switchBlocks.forEach((block) => {\n      const visibleFor = block.getAttribute('data-auth-visible');\n      block.classList.toggle('auth-hidden', visibleFor !== state.authView || !authOverlayEnabled);\n    });\n\n    if (state.error && authOverlayEnabled) {\n      authError.textContent = state.error;\n      authError.classList.remove('auth-hidden');\n    } else {\n      authError.textContent = '';\n      authError.classList.add('auth-hidden');\n    }\n\n    if (authOverlayEnabled && (state.message || state.initializing)) {\n      authMessage.textContent = state.message || '  ...';\n      authMessage.classList.remove('auth-hidden');\n    } else {\n      authMessage.textContent = '';\n      authMessage.classList.add('auth-hidden');\n    }\n\n    const disabled = state.loading || state.initializing;\n    inputs.forEach((input) => {\n      input.disabled = disabled && authOverlayEnabled;\n    });\n    signInSubmit.disabled = disabled;\n    signUpSubmit.disabled = disabled;\n    toggleButtons.forEach((btn) => {\n      btn.disabled = disabled;\n    });\n  };\n\n  const setAuthOverlayEnabled = (enabled: boolean) => {\n    authOverlayEnabled = enabled;\n    updateAuthUIState();\n  };\n\n  const requestAuthWithCallback = (onAuthenticated: () => void) => {\n    const state = useAuthStore.getState();\n    if (state.session) {\n      onAuthenticated();\n      return;\n    }\n    pendingAuthCallback = onAuthenticated;\n    setAuthOverlayEnabled(true);\n  };\n\n  updateAuthUIState();\n  let lastSessionUserId: string | null = null;\n\n  useAuthStore.subscribe((state) => {\n    updateAuthUIState();\n\n    const currentUserId = state.session?.user.id ?? null;\n    if (currentUserId !== lastSessionUserId) {\n      lastSessionUserId = currentUserId;\n      handleAuthSessionChange(currentUserId).catch((error) => {\n        console.error('[CloudSave] Failed to handle session change', error);\n      });\n    }\n\n    if (pendingAuthCallback && state.session) {\n      const callback = pendingAuthCallback;\n      pendingAuthCallback = null;\n      setAuthOverlayEnabled(false);\n      callback();\n    } else if (!state.session && pendingAuthCallback) {\n      //       \n      pendingAuthCallback = null;\n      setAuthOverlayEnabled(true);\n    }\n  });\n\n  useAuthStore\n    .getState()\n    .initialize()\n    .catch((error) => {\n      console.error('[Auth]  ', error);\n    });\n  return { setAuthOverlayEnabled, requestAuthWithCallback };\n}\n\nmenuButtons.forEach(btn => {\n  btn.addEventListener('click', () => {\n    const mode = btn.dataset.mode as 'campaign' | 'daily' | 'draft' | 'pvp' | 'deck' | 'shop';\n    if (!mode || btn.disabled) return;\n    \n    const store = useBattleStore.getState();\n    \n    //  \n    if (mode === 'campaign') {\n      //    \n      store.setGameScreen('campaign');\n    } else if (mode === 'daily') {\n      store.ensureDailyDungeon();\n      store.setGameScreen('daily');\n    } else if (mode === 'deck') {\n      store.setGameScreen('deck-editor');\n    } else if (mode === 'shop') {\n      store.setGameScreen('shop');\n    } else if (mode === 'pvp') {\n      store.setGameScreen('pvp');\n    }\n  });\n});\n\npvpSearchBtn.addEventListener('click', async () => {\n  pvpSearchBtn.disabled = true;\n  try {\n    await useBattleStore.getState().startPvpMatchmaking();\n  } catch (error) {\n    console.error('[PvP] Failed to start matchmaking', error);\n    pvpSearchBtn.disabled = false;\n  }\n});\n\npvpCancelBtn.addEventListener('click', async () => {\n  pvpCancelBtn.disabled = true;\n  try {\n    await useBattleStore.getState().cancelPvpMatchmaking();\n  } catch (error) {\n    console.error('[PvP] Failed to cancel matchmaking', error);\n  } finally {\n    pvpSearchBtn.disabled = false;\n  }\n});\n\npvpBackBtn?.addEventListener('click', async () => {\n  if (pvpBackBtn.disabled) return;\n  pvpBackBtn.disabled = true;\n  try {\n    const store = useBattleStore.getState();\n    const status = store.pvpQueueStatus;\n    if (status === 'searching' || status === 'matched') {\n      try {\n        await store.cancelPvpMatchmaking();\n      } catch (error) {\n        console.error('[PvP] Failed to cancel matchmaking on back', error);\n      }\n    }\n    store.setGameScreen('menu');\n  } finally {\n    pvpBackBtn.disabled = false;\n  }\n});\n\n//  :     \nconst isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\nconst isLowEnd = isMobile || window.innerWidth < 768;\nconst performanceResolution = isLowEnd ? 1 : Math.min(2, window.devicePixelRatio || 1);\n\nconsole.log(`[Performance] Mobile: ${isMobile}, LowEnd: ${isLowEnd}, Resolution: ${performanceResolution}`);\n\napp.init({\n  background: '#0F1A2C',\n  resizeTo: window,\n  // performance tuning -   \n  resolution: performanceResolution,\n  antialias: false,\n  powerPreference: isLowEnd ? 'low-power' : 'high-performance',\n  autoDensity: true\n}).then(async () => {\n  appReady = true;\n  scheduleLayoutRefresh();\n  root.appendChild(app.canvas);\n  \n  // UI  \n  toastManager.init();\n  loadingManager.init();\n  \n  //   \n  loadingManager.show('  ...');\n  \n  //   \n  initAudio();\n\n  // HUD & Controls & Hand & Log & Tooltip & Card Preview\n  const hud = document.getElementById('hud')!;\n  const controls = document.getElementById('controls')!;\n  const handRoot = document.getElementById('hand')!;\n  const logRoot = document.getElementById('log')!;\n  const logToggle = document.getElementById('log-toggle')!;\n  tooltipRoot = document.getElementById('tooltip')!;\n  cardPreview = document.getElementById('card-preview')!;\n  const cardPreviewImage = document.getElementById('card-preview-image') as HTMLImageElement;\n  const cardPreviewName = document.getElementById('card-preview-name')!;\n  const cardPreviewCost = document.getElementById('card-preview-cost')!;\n  const cardPreviewEffects = document.getElementById('card-preview-effects')!;\n  const cardPreviewKeywords = document.getElementById('card-preview-keywords')!;\n  const cardPreviewClose = document.getElementById('card-preview-close')!;\n  \n  //  &  \n  const optionsToggle = document.getElementById('options-toggle')!;\n  const optionsPanel = document.getElementById('options-panel')!;\n  const optionsClose = document.getElementById('options-close')!;\n  const optionsLanguage = document.getElementById('options-language') as HTMLButtonElement;\n  const optionsLogout = document.getElementById('options-logout') as HTMLButtonElement;\n  const volumeMaster = document.getElementById('volume-master') as HTMLInputElement;\n  const volumeBGM = document.getElementById('volume-bgm') as HTMLInputElement;\n  const volumeSFX = document.getElementById('volume-sfx') as HTMLInputElement;\n  const volumeMasterVal = document.getElementById('volume-master-val')!;\n  const volumeBGMVal = document.getElementById('volume-bgm-val')!;\n  const volumeSFXVal = document.getElementById('volume-sfx-val')!;\n  const muteBtn = document.getElementById('mute-btn')!;\n  const store = useBattleStore.getState();\n\n  // =============================\n  // Battle background (dimmed stage image behind blue BG)\n  // =============================\n  const battleBgContainer = new Container();\n  const battleBgSprite = new Sprite();\n  const battleBgOverlay = new Graphics();\n  battleBgContainer.addChild(battleBgSprite);\n  battleBgContainer.addChild(battleBgOverlay);\n  battleBgContainer.visible = false;\n  // Add as the bottom-most layer\n  app.stage.addChildAt(battleBgContainer, 0);\n\n  let currentBgPath: string | null = null;\nlet currentPlayerPortrait: string | null = null;\nlet currentEnemyPortrait: string | null = null;\n\n  function layoutBattleBg() {\n    if (!battleBgContainer.visible || !battleBgSprite.texture) return;\n    const tex = battleBgSprite.texture;\n    const { width: w, height: h } = getViewportSize();\n    const scale = Math.max(w / tex.width, h / tex.height);\n    battleBgSprite.scale.set(scale);\n    battleBgSprite.position.set((w - tex.width * scale) / 2, (h - tex.height * scale) / 2);\n\n    // Dark overlay\n    battleBgOverlay.clear();\n    battleBgOverlay.rect(0, 0, w, h);\n    battleBgOverlay.fill({ color: 0x000000, alpha: 0.55 });\n  }\n  layoutBattleBgRef = layoutBattleBg;\n\n  async function updateBattleBackground() {\n    const s = useBattleStore.getState();\n    if (s.gameScreen !== 'battle') {\n      battleBgContainer.visible = false;\n      currentBgPath = null;\n      return;\n    }\n    const isPvpBattle = s.battleContext.type === 'pvp';\n    let bgPath: string | null = null;\n    if (isPvpBattle) {\n      bgPath = PVP_DEFAULT_BACKGROUND;\n    } else if (s.currentStage) {\n      const stage = s.campaignStages.find(cs => cs.id === s.currentStage);\n      bgPath = stage?.story?.backgroundImage || null;\n    }\n\n    if (!bgPath) {\n      battleBgContainer.visible = false;\n      currentBgPath = null;\n      return;\n    }\n\n    if (currentBgPath !== bgPath) {\n      try {\n        await Assets.load(bgPath);\n        battleBgSprite.texture = Assets.get(bgPath);\n        currentBgPath = bgPath;\n      } catch (e) {\n        console.warn('[BattleBG] Failed to load background:', bgPath, e);\n        battleBgContainer.visible = false;\n        currentBgPath = null;\n        return;\n      }\n    }\n    battleBgContainer.visible = true;\n    layoutBattleBg();\n  }\n\n  // Re-layout on resize\n  window.addEventListener('resize', () => layoutBattleBg());\n  \n  //    ()\n  logToggle.addEventListener('click', () => {\n    logRoot.classList.toggle('mobile-visible');\n    logToggle.textContent = logRoot.classList.contains('mobile-visible') ? '' : '';\n  });\n  //       ()\n  if (isMobile || window.innerWidth <= 768) {\n    document.addEventListener('click', (e) => {\n      const target = e.target as HTMLElement;\n      if (logRoot.classList.contains('mobile-visible') && \n          !logRoot.contains(target) && \n          !logToggle.contains(target)) {\n        logRoot.classList.remove('mobile-visible');\n        logToggle.textContent = '';\n      }\n    });\n  }\n  \n  //    \n  closeCardPreview = function closeCardPreview() {\n    cardPreview.classList.remove('active');\n  };\n  cardPreviewClose.addEventListener('click', closeCardPreview);\n  cardPreview.addEventListener('click', (e) => {\n    if (e.target === cardPreview) {\n      closeCardPreview();\n    }\n  });\n  \n  //   \n  const audioSettings = audioManager.getSettings();\n  volumeMaster.value = String(Math.round(audioSettings.masterVolume * 100));\n  volumeBGM.value = String(Math.round(audioSettings.bgmVolume * 100));\n  volumeSFX.value = String(Math.round(audioSettings.sfxVolume * 100));\n  volumeMasterVal.textContent = volumeMaster.value;\n  volumeBGMVal.textContent = volumeBGM.value;\n  volumeSFXVal.textContent = volumeSFX.value;\n  if (audioSettings.muted) {\n    muteBtn.classList.add('muted');\n    muteBtn.textContent = '  ';\n  }\n\n  //   \n  function closeOptionsPanel() {\n    optionsPanel.classList.remove('active');\n  }\n\n  optionsToggle.addEventListener('click', () => {\n    const nextState = !optionsPanel.classList.contains('active');\n    optionsPanel.classList.toggle('active', nextState);\n    audioManager.playSFX('button_click', 0.5);\n  });\n\n  optionsClose.addEventListener('click', () => {\n    closeOptionsPanel();\n    audioManager.playSFX('button_click', 0.5);\n  });\n\n  //   \n  function updateLanguageButton() {\n    const currentLang = getCurrentLocale();\n    optionsLanguage.textContent = currentLang === 'ko' ? ' : ' : ' Language: English';\n  }\n\n  optionsLanguage.addEventListener('click', () => {\n    audioManager.playSFX('button_click', 0.5);\n    const newLocale = getCurrentLocale() === 'ko' ? 'en' : 'ko';\n    setLocale(newLocale);\n    updateLanguageButton();\n  });\n  updateLanguageButton();\n\n  optionsLogout.addEventListener('click', async () => {\n    audioManager.playSFX('button_click', 0.5);\n    const { session, signOut } = useAuthStore.getState();\n    if (!session) {\n      toastManager.info('  .', 1800);\n      closeOptionsPanel();\n      return;\n    }\n\n    await signOut();\n    const { error } = useAuthStore.getState();\n    if (error) {\n      toastManager.error(' .', 2200);\n    } else {\n      toastManager.success('.', 1800);\n    }\n    closeOptionsPanel();\n  });\n  \n  //  \n  volumeMaster.addEventListener('input', () => {\n    const value = parseInt(volumeMaster.value);\n    volumeMasterVal.textContent = String(value);\n    audioManager.setMasterVolume(value / 100);\n  });\n  \n  volumeBGM.addEventListener('input', () => {\n    const value = parseInt(volumeBGM.value);\n    volumeBGMVal.textContent = String(value);\n    audioManager.setBGMVolume(value / 100);\n  });\n  \n  volumeSFX.addEventListener('input', () => {\n    const value = parseInt(volumeSFX.value);\n    volumeSFXVal.textContent = String(value);\n    audioManager.setSFXVolume(value / 100);\n  });\n  \n  //  \n  muteBtn.addEventListener('click', () => {\n    const isMuted = audioManager.toggleMute();\n    if (isMuted) {\n      muteBtn.classList.add('muted');\n      muteBtn.textContent = '  ';\n    } else {\n      muteBtn.classList.remove('muted');\n      muteBtn.textContent = ' ';\n    }\n    audioManager.playSFX('button_click', 0.5);\n  });\n  \n  //   \n  function showCardPreview(card: typeof store.hand[0]) {\n    const imagePath = getLoadedCardImage(card);\n    if (imagePath) {\n      // PixiJS Assets   URL \n      const texture = Assets.get(imagePath);\n      if (texture && texture.source) {\n        cardPreviewImage.src = texture.source.resource?.src || imagePath;\n      } else {\n        cardPreviewImage.src = imagePath;\n      }\n    } else {\n      // Fallback placeholder\n      cardPreviewImage.src = 'data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"280\" height=\"420\"><rect width=\"280\" height=\"420\" fill=\"%23556677\"/><text x=\"50%\" y=\"50%\" text-anchor=\"middle\" fill=\"white\" font-size=\"20\">No Image</text></svg>';\n    }\n    \n    cardPreviewName.textContent = card.name;\n    cardPreviewCost.textContent = ` : ${card.cost}`;\n    \n    // Effects :      \n    if (card.effectText && card.effectText.trim().length > 0) {\n      cardPreviewEffects.innerHTML = card.effectText\n        .split(/\\r?\\n/)\n        .map(line => line.trim())\n        .filter(line => line.length > 0)\n        .map(line => `<span>${line}</span>`)\n        .join('<br>');\n    } else {\n      const effectsText = card.effects.map(eff => {\n        if (!eff) return '';\n        if (eff.type === 'Damage') return `  ${eff.value}${eff.aoe ? ' ()' : ''}`;\n        if (eff.type === 'Heal') return `  ${eff.value}${eff.aoe ? ' ()' : ''}`;\n        if (eff.type === 'Shield') return `  ${eff.value}`;\n        if (eff.type === 'Guard') return `  ${eff.value}`;\n        if (eff.type === 'Draw') return `  ${eff.value}`;\n        if (eff.type === 'GainAction') return `  +${eff.value}`;\n        if (eff.type === 'ApplyStatus') {\n          const key = eff.key ?? '';\n          const stacks = eff.stacks ?? 1;\n          return ` ${key} ${stacks}`;\n        }\n        return '';\n      }).filter(Boolean).join(' | ');\n      cardPreviewEffects.textContent = effectsText || ' ';\n    }\n    \n    // Keywords \n    cardPreviewKeywords.innerHTML = '';\n    card.keywords.forEach(kw => {\n      const badge = document.createElement('span');\n      badge.className = `status-badge status-${kw.toLowerCase()}`;\n      badge.textContent = kw;\n      cardPreviewKeywords.appendChild(badge);\n    });\n    \n    cardPreview.classList.add('active');\n  }\n  \n  // Keyword descriptions for tooltips\n  const keywordDescriptions: Record<string, string> = {\n    'Burn': ':     10  .',\n    'Freeze': ':        .',\n    'Shock': ':          . (1: 30%, 2: 60%, 3+: 90%)',\n    'Vulnerable': ':   20% .',\n    'Regen': ':    HP .',\n    'Shield': ':   .',\n    'Guard': ':    .',\n    'Nullify': ':    .',\n    'Counter': ':      .',\n    'Immune': ':    .',\n    'Evasion': ':     .',\n    'Haste': ':   .',\n    'Draw': ':   .',\n    'Priority': ':   .',\n    'Duplicate': ':      .',\n    'Silence': ':      .',\n    'Cleanse': ':  .',\n    'Thorns': ':     .',\n  };\n  \n  // Tooltip helper functions\n  function showTooltip(card: typeof store.hand[0], x: number, y: number) {\n    const keywordTexts = card.keywords.map(kw => {\n      const desc = keywordDescriptions[kw];\n      return desc ? `<strong>${kw}</strong>: ${desc}` : kw;\n    }).join('<br>');\n    \n    const effectText = card.effectText || '  .';\n    const cardTypeKey = `card.type.${card.type}`;\n    const translatedType = t(cardTypeKey);\n    \n    tooltipRoot.innerHTML = `\n      <div class=\"tooltip-header\">${card.name}</div>\n      <div>\n        <span class=\"tooltip-cost\"> ${card.cost}</span>\n        <span class=\"tooltip-type\">${translatedType}</span>\n      </div>\n      <div class=\"tooltip-effect\">${effectText}</div>\n      ${card.keywords.length > 0 ? `<div class=\"tooltip-keywords\">${keywordTexts}</div>` : ''}\n    `;\n    \n    //   (   )\n    tooltipRoot.style.display = 'block';\n    tooltipRoot.style.left = `${Math.min(x + 15, window.innerWidth - tooltipRoot.offsetWidth - 10)}px`;\n    tooltipRoot.style.top = `${Math.min(y + 15, window.innerHeight - tooltipRoot.offsetHeight - 10)}px`;\n  }\n  \n  hideTooltip = function hideTooltip() {\n    tooltipRoot.style.display = 'none';\n  };\n  let energy = store.energy;\n  let round = store.round;\n  let roundSeed = store.roundSeed;\n  let playerHp = store.playerHp;\n  let playerMaxHp = store.playerMaxHp;\n  let enemyHp = store.enemyHp;\n  let enemyMaxHp = store.enemyMaxHp;\n  let gameOver = store.gameOver;\n  let playerStatus = store.playerStatus;\n  let enemyStatus = store.enemyStatus;\n  \n  //     ( )\n  let displayEnergy = store.energy;\n  let displayPlayerHp = store.playerHp;\n  let displayEnemyHp = store.enemyHp;\n  \n  function formatStatus(status: typeof playerStatus): string {\n    const badges: string[] = [];\n    \n    //   ()\n    if (status.shield > 0) badges.push(`<span class=\"status-badge status-defense\"> ${status.shield}<sub>${status.shieldDuration}T</sub></span>`);\n    if (status.guard > 0) badges.push(`<span class=\"status-badge status-defense\">  ${status.guard}<sub>${status.guardDuration}T</sub></span>`);\n    if (status.evasionCharges > 0) badges.push(`<span class=\"status-badge status-defense\"> ${status.evasionCharges}<sub>${status.evasionDuration}T</sub></span>`);\n    if (status.nullifyCharges > 0) badges.push(`<span class=\"status-badge status-defense\"> ${status.nullifyCharges}</span>`);\n    if (status.counterValue > 0) badges.push(`<span class=\"status-badge status-buff\">  ${status.counterValue}<sub>${status.counterDuration}T</sub></span>`);\n    if (status.immuneKeywords.length > 0) badges.push(`<span class=\"status-badge status-defense\"> ${status.immuneKeywords.join(',')}<sub>${status.immuneDuration}T</sub></span>`);\n    \n    //   ()\n    if (status.attackBuff > 0) badges.push(`<span class=\"status-badge status-buff\"> +${status.attackBuff}%</span>`);\n    if (status.regen > 0) badges.push(`<span class=\"status-badge status-buff\"> +${status.regen}/T</span>`);\n    \n    //   ()\n    if (status.vulnerable > 0) badges.push(`<span class=\"status-badge status-debuff\"> <sub>${status.vulnerable}T</sub></span>`);\n    if (status.shockStacks > 0) badges.push(`<span class=\"status-badge status-debuff\"> ${status.shockStacks}</span>`);\n    \n    // \n    status.statuses.forEach(s => {\n      const statusConfig: Record<string, { icon: string; type: 'buff' | 'debuff' }> = {\n        'Burn': { icon: '', type: 'debuff' },\n        'Freeze': { icon: '', type: 'debuff' },\n        'Shock': { icon: '', type: 'debuff' },\n        'Vulnerable': { icon: '', type: 'debuff' },\n        'Regen': { icon: '', type: 'buff' },\n      };\n      const config = statusConfig[s.key] || { icon: '', type: 'debuff' };\n      const stacksText = s.stacks && s.stacks > 1 ? ` ${s.stacks}` : '';\n      badges.push(`<span class=\"status-badge status-${config.type}\">${config.icon}${stacksText}<sub>${s.duration}T</sub></span>`);\n    });\n    \n    return badges.length > 0 ? badges.join(' ') : `<span style=\"color: #777;\">${t('status.none')}</span>`;\n  }\n  \n  function renderHUD() {\n    let gameOverText = '';\n    if (gameOver === 'victory') {\n      gameOverText = `<div style=\"color: #4CAF50; font-weight: bold; font-size: 1.2em;\">${t('battle.victory')}</div>`;\n    } else if (gameOver === 'defeat') {\n      gameOverText = `<div style=\"color: #f44336; font-weight: bold; font-size: 1.2em;\">${t('battle.defeat')}</div>`;\n    }\n    //     \n    const displayPlayerHpInt = Math.round(displayPlayerHp);\n    const displayEnemyHpInt = Math.round(displayEnemyHp);\n    \n    hud.innerHTML = `\n      ${gameOverText}\n      <div>${t('battle.round')}: ${round}</div>\n      <div style=\"font-size: 10px; color: #777;\">${t('battle.seed')}: ${roundSeed}</div>\n      <div style=\"margin-top: 8px; padding: 6px; background: rgba(0,0,0,0.3); border-radius: 4px;\">\n        <div style=\"font-weight: bold;\">${t('battle.player')}</div>\n        <div>${t('battle.hp')}: <span style=\"font-weight: bold; color: ${displayPlayerHpInt < playerHp * 0.3 ? '#f44336' : '#4CAF50'}\">${displayPlayerHpInt}</span>/${playerMaxHp}</div>\n        <div style=\"font-size: 11px; color: #aaa; margin-top: 4px;\">${formatStatus(playerStatus)}</div>\n      </div>\n      <div style=\"margin-top: 8px; padding: 6px; background: rgba(139,0,0,0.3); border-radius: 4px;\">\n        <div style=\"font-weight: bold;\">${t('battle.enemy')}</div>\n        <div>${t('battle.hp')}: <span style=\"font-weight: bold; color: ${displayEnemyHpInt < enemyHp * 0.3 ? '#f44336' : '#ff9800'}\">${displayEnemyHpInt}</span>/${enemyMaxHp}</div>\n        <div style=\"font-size: 11px; color: #aaa; margin-top: 4px;\">${formatStatus(enemyStatus)}</div>\n      </div>\n    `;\n  }\n  renderHUD();\n\n  // Controls\n  function renderControls() {\n    controls.innerHTML = '';\n    const state = useBattleStore.getState();\n    const isMobileView = window.innerWidth <= 768;\n    const isSmallMobile = window.innerWidth <= 480;\n    const deckColumnMinWidth = isSmallMobile ? 80 : (isMobileView ? 100 : 110);\n    const collectionMinWidth = isSmallMobile ? 120 : (isMobileView ? 140 : 160);\n    const collectionGap = isSmallMobile ? 10 : (isMobileView ? 14 : 18);\n    const deckGap = isSmallMobile ? 6 : 8;\n    \n    //    ( )\n    const btnMenu = document.createElement('button');\n    btnMenu.textContent = '  ';\n    btnMenu.style.cssText = 'background: #2a3f5f; color: #fff; border: 1px solid #3a4f75; padding: 4px 8px; border-radius: 6px; cursor: pointer; font-size: 11px; margin-bottom: 8px;';\n    btnMenu.onclick = () => {\n      audioManager.playSFX('button_click', 0.6);\n      useBattleStore.getState().setGameScreen('menu');\n    };\n    controls.append(btnMenu);\n\n    if (state.battleContext.type === 'pvp') {\n      const pvpBox = document.createElement('div');\n      pvpBox.style.cssText = 'padding: 10px; background: linear-gradient(135deg, rgba(33,47,79,0.9), rgba(19,29,51,0.95)); border: 1px solid rgba(102,187,255,0.35); border-radius: 8px; margin-bottom: 10px; color: #e3f2fd; box-shadow: 0 0 8px rgba(33,150,243,0.2);';\n\n      const statusRow = document.createElement('div');\n      statusRow.style.cssText = 'display: flex; justify-content: space-between; font-size: 12px; font-weight: 600;';\n      const localStatusColor = state.pvpLocalReady ? '#66bb6a' : '#ffeb3b';\n      const opponentStatusColor = state.pvpOpponentReady ? '#66bb6a' : '#ff8a65';\n      statusRow.innerHTML = `\n        <span style=\"color:${localStatusColor}\">${state.pvpLocalReady ? '   ' : '    '}</span>\n        <span style=\"color:${opponentStatusColor}\">${state.pvpOpponentReady ? '   ' : '   '}</span>\n      `;\n      pvpBox.appendChild(statusRow);\n\n      const duration = state.pvpTurnDuration || 15;\n      const rawRemaining = state.pvpTurnTimeLeft ?? duration;\n      const remaining = Math.max(0, Math.min(duration, Math.round(rawRemaining)));\n      const countdownActive = state.pvpTurnTimerActive && !state.pvpLocalReady;\n      const progressPercent = countdownActive ? (remaining / duration) * 100 : state.pvpLocalReady ? 100 : (state.pvpOpponentReady ? 0 : 100);\n      const clampedPercent = Math.max(0, Math.min(100, progressPercent));\n      const timeColor = remaining <= 5 && countdownActive ? '#ff5252' : '#4caf50';\n\n      const timerHeader = document.createElement('div');\n      timerHeader.style.cssText = 'display:flex; justify-content:space-between; align-items:center; margin-top:6px; font-size:12px;';\n      timerHeader.innerHTML = `\n        <span> </span>\n        <span style=\"font-weight:700; color:${timeColor};\">${remaining.toString().padStart(2, '0')}s</span>\n      `;\n      pvpBox.appendChild(timerHeader);\n\n      const progressOuter = document.createElement('div');\n      progressOuter.style.cssText = 'width:100%; height:8px; border-radius:999px; background:rgba(255,255,255,0.18); overflow:hidden; margin-top:4px;';\n      const progressInner = document.createElement('div');\n      const barColor = countdownActive\n        ? (remaining <= 5 ? 'linear-gradient(90deg, #ff6f61, #ff1744)' : 'linear-gradient(90deg, #4caf50, #2196f3)')\n        : (state.pvpLocalReady ? 'linear-gradient(90deg, #66bb6a, #43a047)' : 'linear-gradient(90deg, #29b6f6, #0288d1)');\n      progressInner.style.cssText = `width:${clampedPercent.toFixed(0)}%; height:100%; transition:width 0.2s ease; background:${barColor};`;\n      progressOuter.appendChild(progressInner);\n      pvpBox.appendChild(progressOuter);\n\n      const infoText = document.createElement('div');\n      infoText.style.cssText = 'margin-top:4px; font-size:10px; color:#b3e5fc;';\n      if (state.pvpLocalReady && !state.pvpOpponentReady) {\n        infoText.textContent = '   ';\n      } else if (!state.pvpLocalReady && !countdownActive) {\n        infoText.textContent = '   .';\n      } else {\n        infoText.textContent = '    .';\n      }\n      pvpBox.appendChild(infoText);\n\n      controls.appendChild(pvpBox);\n    }\n    \n    //   \n    const declareInfo = document.createElement('div');\n    declareInfo.style.cssText = 'padding: 6px 10px; background: rgba(0,0,0,0.5); border-radius: 6px; margin-bottom: 8px; color: #fff; font-size: 12px; border: 1px solid #3a4f75;';\n    const queuedCount = state.queuedHandIndices.length;\n    const reserved = state.getPendingCost();\n    if (queuedCount > 0) {\n      declareInfo.innerHTML = `\n        <div style=\"color: #4a9eff; font-weight: bold;\"> ${t('battle.declared')}: ${queuedCount}</div>\n        <div style=\"font-size: 10px; color: #aaa;\">${t('battle.reservedEnergy')}: ${reserved}</div>\n      `;\n      declareInfo.style.borderColor = '#4a9eff';\n      declareInfo.style.animation = 'pulse 2s ease-in-out infinite';\n    } else {\n      declareInfo.innerHTML = `<div style=\"color: #777;\">${t('battle.noCards')}</div>`;\n    }\n    controls.appendChild(declareInfo);\n    \n    //   \n    const btnEnd = document.createElement('button');\n    btnEnd.textContent = queuedCount > 0 ? `${t('battle.endTurn')} (${queuedCount} )` : t('battle.endTurn');\n    btnEnd.disabled = gameOver !== 'none';\n    btnEnd.style.cssText = queuedCount > 0 \n      ? 'background: linear-gradient(135deg, #4a9eff, #1565C0); color: #fff; border: 2px solid #66BB6A; padding: 8px 14px; border-radius: 6px; cursor: pointer; font-weight: bold; box-shadow: 0 2px 8px rgba(74,158,255,0.5); transition: transform 0.1s;'\n      : 'background: #20304d; color: #fff; border: 1px solid #3a4f75; padding: 6px 10px; border-radius: 6px; cursor: pointer; transition: transform 0.1s;';\n    if (gameOver !== 'none') {\n      btnEnd.style.opacity = '0.5';\n      btnEnd.style.cursor = 'not-allowed';\n    }\n    btnEnd.onclick = () => {\n      const state = useBattleStore.getState();\n      if (gameOver === 'none' && !state.isTurnProcessing) {\n        audioManager.playSFX('turn_end', 0.8);\n        //  \n        btnEnd.style.transform = 'scale(0.95)';\n        setTimeout(() => {\n          btnEnd.style.transform = 'scale(1)';\n          useBattleStore.getState().endPlayerTurn();\n        }, 100);\n      }\n    };\n    controls.append(btnEnd);\n  }\n  renderControls();\n\n  // Log UI with filtering and search\n  let logViewMode: 'all' | 'summary' = 'all';\n  let logFilter: 'all' | 'card-play' | 'effect' | 'system' = 'all';\n  let logSearchText = '';\n  \n  function renderLog() {\n    const state = useBattleStore.getState();\n    logRoot.innerHTML = '';\n    \n    //   \n    const controls = document.createElement('div');\n    controls.style.cssText = 'padding: 4px; background: rgba(0,0,0,0.5); border-bottom: 1px solid #3a4f75; margin-bottom: 4px;';\n    \n    //   \n    const viewToggle = document.createElement('button');\n    viewToggle.textContent = logViewMode === 'all' ? t('log.view.all') : t('log.view.summary');\n    viewToggle.style.cssText = 'padding: 2px 6px; margin-right: 4px; font-size: 10px; background: #2a3f5f; color: #fff; border: 1px solid #3a4f75; border-radius: 3px; cursor: pointer;';\n    viewToggle.onclick = () => {\n      logViewMode = logViewMode === 'all' ? 'summary' : 'all';\n      renderLog();\n    };\n    controls.appendChild(viewToggle);\n    \n    //  \n    const filters: Array<{ label: string; value: typeof logFilter }> = [\n      { label: t('log.filter.all'), value: 'all' },\n      { label: t('log.filter.card'), value: 'card-play' },\n      { label: t('log.filter.effect'), value: 'effect' },\n      { label: t('log.filter.system'), value: 'system' },\n    ];\n    filters.forEach(f => {\n      const btn = document.createElement('button');\n      btn.textContent = f.label;\n      btn.style.cssText = `padding: 2px 6px; margin-right: 2px; font-size: 10px; background: ${logFilter === f.value ? '#4a9eff' : '#2a3f5f'}; color: #fff; border: 1px solid #3a4f75; border-radius: 3px; cursor: pointer;`;\n      btn.onclick = () => {\n        logFilter = f.value;\n        renderLog();\n      };\n      controls.appendChild(btn);\n    });\n    \n    // \n    const searchInput = document.createElement('input');\n    searchInput.type = 'text';\n    searchInput.placeholder = t('log.search');\n    searchInput.value = logSearchText;\n    searchInput.style.cssText = 'width: 80px; padding: 2px 4px; font-size: 10px; background: #1a2f4f; color: #fff; border: 1px solid #3a4f75; border-radius: 3px; margin-left: 4px;';\n    searchInput.oninput = (e) => {\n      logSearchText = (e.target as HTMLInputElement).value.toLowerCase();\n      renderLog();\n    };\n    controls.appendChild(searchInput);\n    \n    logRoot.appendChild(controls);\n    \n    //     \n    const entries = state.logs.filter(entry => {\n      //  \n      if (logFilter !== 'all' && entry.type !== logFilter) return false;\n      //  \n      if (logSearchText && !entry.message.toLowerCase().includes(logSearchText)) return false;\n      return true;\n    });\n    \n    //  :  20\n    const displayEntries = logViewMode === 'summary' ? entries.slice(-20) : entries;\n    \n    displayEntries.forEach((entry) => {\n      const div = document.createElement('div');\n      div.className = `entry ${entry.type}`;\n      div.textContent = entry.message;\n      logRoot.appendChild(div);\n    });\n    \n    if (displayEntries.length === 0 && entries.length > 0) {\n      const noResults = document.createElement('div');\n      noResults.style.cssText = 'padding: 8px; color: #777; text-align: center;';\n      noResults.textContent = t('log.noResults');\n      logRoot.appendChild(noResults);\n    }\n    \n    logRoot.scrollTop = logRoot.scrollHeight;\n  }\n\n  // VFX Layer ()\n  const vfxContainer = new Container();\n  app.stage.addChild(vfxContainer);\n  vfxManager.init(vfxContainer);\n  \n  // VFX  ( )\n  app.ticker.add(() => {\n    vfxManager.update();\n  });\n  \n  // ==================   ( + ) ==================\n  \n  //    \n  function createDeckContainer(isPlayer: boolean) {\n    const container = new Container();\n    \n    //     \n    const isMobile = window.innerWidth <= 768;\n    const isSmallMobile = window.innerWidth <= 480;\n    const bgWidth = isSmallMobile ? 90 : (isMobile ? 105 : 130);\n    const bgHeight = isSmallMobile ? 124 : (isMobile ? 145 : 180);\n    const bgHalfWidth = bgWidth / 2;\n    const bgHalfHeight = bgHeight / 2;\n    \n    // \n    const shadow = new Graphics();\n    shadow.rect(-bgHalfWidth, -bgHalfHeight, bgWidth, bgHeight);\n    shadow.fill({ color: 0x000000, alpha: 0.3 });\n    shadow.x = 6;\n    shadow.y = 6;\n    container.addChild(shadow);\n    \n    //     ( )\n    const characterBackground = new Graphics();\n    characterBackground.rect(-bgHalfWidth, -bgHalfHeight, bgWidth, bgHeight);\n    characterBackground.fill({ color: 0x1a1a2e, alpha: 0.3 }); // alpha 0.8 0.3 \n    container.addChildAt(characterBackground, 0); //   \n    \n    //    (        )\n    const characterSprite = new Sprite();\n    characterSprite.anchor.set(0.5);\n    characterSprite.width = bgWidth;\n    characterSprite.height = bgHeight;\n    characterSprite.alpha = 1.0; //  alpha \n    characterSprite.visible = false; //    \n    //       (initDeckVisuals)\n    \n    //   3\n    const cardBack1 = new Sprite();\n    const cardBack2 = new Sprite();\n    const cardBack3 = new Sprite();\n    \n    //   \n    const countText = new Text({\n      text: ': 0',\n      style: {\n        fontSize: isSmallMobile ? 12 : (isMobile ? 14 : 16),\n        fill: 0xffffff,\n        fontWeight: 'bold',\n        stroke: { color: 0x000000, width: isSmallMobile ? 2 : 3 }\n      }\n    });\n    countText.anchor.set(0.5);\n    countText.y = bgHalfHeight - 10; //    \n    container.addChild(countText);\n    \n    return { container, cardBack1, cardBack2, cardBack3, countText, shadow, characterSprite, characterBackground };\n  }\n  \n  //   (  )\n  const playerDeckData = createDeckContainer(true);\n  const playerDeckContainer = playerDeckData.container;\n  //   resize  \n  \n  //   (  )\n  const enemyDeckData = createDeckContainer(false);\n  const enemyDeckContainer = enemyDeckData.container;\n  //   resize  \n  \n  // VS  ()\n  const vsText = new Text({\n    text: 'VS',\n    style: {\n      fontSize: 48,\n      fill: 0xff0000, // \n      fontWeight: 'bold',\n      stroke: { color: 0x000000, width: 4 }\n    }\n  });\n  vsText.anchor.set(0.5);\n  //   resize  \n  \n  //    \n  app.stage.addChild(playerDeckContainer);\n  app.stage.addChild(enemyDeckContainer);\n  app.stage.addChild(vsText);\n  \n  // VFX Layer   ( /VS  )\n  app.stage.setChildIndex(vfxContainer, app.stage.children.length - 1);\n  \n  //     \n  const initDeckVisuals = async () => {\n    const cardBackPath = getCardBackImage();\n    if (!cardBackPath) {\n      console.warn('[Deck] Card back path not found');\n      return;\n    }\n    \n    try {\n      const texture = await Assets.load(cardBackPath);\n      \n      //     \n      const isMobile = window.innerWidth <= 768;\n      const isSmallMobile = window.innerWidth <= 480;\n      const cardBackWidth = isSmallMobile ? 90 : (isMobile ? 105 : 120);\n      const cardBackHeight = isSmallMobile ? 124 : (isMobile ? 145 : 165);\n      \n      //    \n      [playerDeckData.cardBack1, playerDeckData.cardBack2, playerDeckData.cardBack3].forEach((sprite, i) => {\n        sprite.texture = texture;\n        sprite.width = cardBackWidth;\n        sprite.height = cardBackHeight;\n        sprite.anchor.set(0.5);\n        sprite.x = i * 4 - 4;\n        sprite.y = i * 4 - 4;\n        sprite.alpha = 0.5; //       \n      });\n      playerDeckContainer.addChild(playerDeckData.cardBack3);\n      playerDeckContainer.addChild(playerDeckData.cardBack2);\n      playerDeckContainer.addChild(playerDeckData.cardBack1);\n      //     \n      playerDeckContainer.addChild(playerDeckData.characterSprite);\n      // countText    (  )\n      playerDeckContainer.setChildIndex(playerDeckData.countText, playerDeckContainer.children.length - 1);\n      \n      //    \n      [enemyDeckData.cardBack1, enemyDeckData.cardBack2, enemyDeckData.cardBack3].forEach((sprite, i) => {\n        sprite.texture = texture;\n        sprite.width = cardBackWidth;\n        sprite.height = cardBackHeight;\n        sprite.anchor.set(0.5);\n        sprite.x = i * 4 - 4;\n        sprite.y = i * 4 - 4;\n        sprite.alpha = 0.5; //       \n      });\n      enemyDeckContainer.addChild(enemyDeckData.cardBack3);\n      enemyDeckContainer.addChild(enemyDeckData.cardBack2);\n      enemyDeckContainer.addChild(enemyDeckData.cardBack1);\n      //     \n      enemyDeckContainer.addChild(enemyDeckData.characterSprite);\n      // countText    (  )\n      enemyDeckContainer.setChildIndex(enemyDeckData.countText, enemyDeckContainer.children.length - 1);\n      \n      console.log('[Deck] Player & Enemy deck loaded successfully');\n    } catch (err) {\n      console.warn('[Deck] Failed to load card back:', err);\n    }\n  };\n  //    \n  function updateDeckVisuals() {\n    const state = useBattleStore.getState();\n    \n    //  \n    const playerDeckSize = state.deck.length;\n    playerDeckData.countText.text = `\\n: ${playerDeckSize}`;\n    playerDeckContainer.alpha = playerDeckSize > 0 ? 1.0 : 0.3;\n    playerDeckContainer.visible = state.gameScreen === 'battle';\n    \n    //  \n    const enemyDeckSize = state.enemyDeck.length;\n    enemyDeckData.countText.text = `\\n: ${enemyDeckSize}`;\n    enemyDeckContainer.alpha = enemyDeckSize > 0 ? 1.0 : 0.3;\n    enemyDeckContainer.visible = state.gameScreen === 'battle';\n    \n    // VS \n    vsText.visible = state.gameScreen === 'battle';\n    \n    //    \n    if (state.gameScreen === 'battle') {\n      if (state.currentStage) {\n        const stage = state.campaignStages.find(s => s.id === state.currentStage);\n        if (stage) {\n          if (stage.characterImage) {\n            console.log('[Deck] Loading player character:', stage.characterImage);\n            Assets.load(stage.characterImage).then(texture => {\n              console.log('[Deck] Player character loaded successfully:', stage.characterImage);\n              playerDeckData.characterSprite.texture = texture;\n              const isMobile = window.innerWidth <= 768;\n              const isSmallMobile = window.innerWidth <= 480;\n              playerDeckData.characterSprite.height = isSmallMobile ? 120 : (isMobile ? 140 : 180);\n              playerDeckData.characterSprite.scale.x = playerDeckData.characterSprite.scale.y;\n              if (!playerDeckData.characterSprite.parent) {\n                playerDeckContainer.addChild(playerDeckData.characterSprite);\n                playerDeckContainer.setChildIndex(playerDeckData.countText, playerDeckContainer.children.length - 1);\n              }\n              playerDeckData.characterSprite.visible = true;\n              currentPlayerPortrait = stage.characterImage ?? null;\n            }).catch(err => {\n              console.warn('[Deck] Failed to load player character:', stage.characterImage, err);\n              playerDeckData.characterSprite.visible = false;\n              currentPlayerPortrait = null;\n            });\n          } else {\n            playerDeckData.characterSprite.visible = false;\n            currentPlayerPortrait = null;\n          }\n\n          if (stage.enemyImage) {\n            console.log('[Deck] Loading enemy character:', stage.enemyImage);\n            Assets.load(stage.enemyImage).then(texture => {\n              console.log('[Deck] Enemy character loaded successfully:', stage.enemyImage);\n              enemyDeckData.characterSprite.texture = texture;\n              const isMobile = window.innerWidth <= 768;\n              const isSmallMobile = window.innerWidth <= 480;\n              enemyDeckData.characterSprite.height = isSmallMobile ? 120 : (isMobile ? 140 : 180);\n              enemyDeckData.characterSprite.scale.x = enemyDeckData.characterSprite.scale.y;\n              if (!enemyDeckData.characterSprite.parent) {\n                enemyDeckContainer.addChild(enemyDeckData.characterSprite);\n                enemyDeckContainer.setChildIndex(enemyDeckData.countText, enemyDeckContainer.children.length - 1);\n              }\n              enemyDeckData.characterSprite.visible = true;\n              currentEnemyPortrait = stage.enemyImage ?? null;\n            }).catch(err => {\n              console.warn('[Deck] Failed to load enemy character:', stage.enemyImage, err);\n              enemyDeckData.characterSprite.visible = false;\n              currentEnemyPortrait = null;\n            });\n          } else {\n            enemyDeckData.characterSprite.visible = false;\n            currentEnemyPortrait = null;\n          }\n        }\n      } else if (state.battleContext.type === 'pvp') {\n        const playerPortraitPath = resolveDeckPortrait(state.playerDeck, DEFAULT_PLAYER_PORTRAIT);\n        const enemyPortraitPath = resolveDeckPortrait(state.enemyDeck, DEFAULT_ENEMY_PORTRAIT);\n\n        if (playerPortraitPath !== currentPlayerPortrait) {\n          Assets.load(playerPortraitPath).then(texture => {\n            playerDeckData.characterSprite.texture = texture;\n            const isMobile = window.innerWidth <= 768;\n            const isSmallMobile = window.innerWidth <= 480;\n            playerDeckData.characterSprite.height = isSmallMobile ? 120 : (isMobile ? 140 : 180);\n            playerDeckData.characterSprite.scale.x = playerDeckData.characterSprite.scale.y;\n            if (!playerDeckData.characterSprite.parent) {\n              playerDeckContainer.addChild(playerDeckData.characterSprite);\n              playerDeckContainer.setChildIndex(playerDeckData.countText, playerDeckContainer.children.length - 1);\n            }\n            playerDeckData.characterSprite.visible = true;\n            currentPlayerPortrait = playerPortraitPath;\n          }).catch(err => {\n            console.warn('[Deck] Failed to load PvP player portrait:', playerPortraitPath, err);\n            playerDeckData.characterSprite.visible = false;\n            currentPlayerPortrait = null;\n          });\n        } else if (playerDeckData.characterSprite.texture) {\n          playerDeckData.characterSprite.visible = true;\n        }\n\n        if (enemyPortraitPath !== currentEnemyPortrait) {\n          Assets.load(enemyPortraitPath).then(texture => {\n            enemyDeckData.characterSprite.texture = texture;\n            const isMobile = window.innerWidth <= 768;\n            const isSmallMobile = window.innerWidth <= 480;\n            enemyDeckData.characterSprite.height = isSmallMobile ? 120 : (isMobile ? 140 : 180);\n            enemyDeckData.characterSprite.scale.x = enemyDeckData.characterSprite.scale.y;\n            if (!enemyDeckData.characterSprite.parent) {\n              enemyDeckContainer.addChild(enemyDeckData.characterSprite);\n              enemyDeckContainer.setChildIndex(enemyDeckData.countText, enemyDeckContainer.children.length - 1);\n            }\n            enemyDeckData.characterSprite.visible = true;\n            currentEnemyPortrait = enemyPortraitPath;\n          }).catch(err => {\n            console.warn('[Deck] Failed to load PvP enemy portrait:', enemyPortraitPath, err);\n            enemyDeckData.characterSprite.visible = false;\n            currentEnemyPortrait = null;\n          });\n        } else if (enemyDeckData.characterSprite.texture) {\n          enemyDeckData.characterSprite.visible = true;\n        }\n      } else {\n        playerDeckData.characterSprite.visible = false;\n        enemyDeckData.characterSprite.visible = false;\n        currentPlayerPortrait = null;\n        currentEnemyPortrait = null;\n      }\n    } else {\n      playerDeckData.characterSprite.visible = false;\n      enemyDeckData.characterSprite.visible = false;\n      currentPlayerPortrait = null;\n      currentEnemyPortrait = null;\n    }\n  }\n  \n  // \n  initDeckVisuals().then(() => {\n    console.log('[Deck] Initialization complete');\n  });\n  updateDeckVisuals();\n  \n  //      (   )\n  function flashCharacterSprite(sprite: Sprite, effectType: string = 'damage') {\n    if (!sprite.visible || !sprite.texture) return;\n    \n    //   \n    const effectColors: Record<string, number> = {\n      damage: 0xFF6666,    //  ()\n      heal: 0x66FF66,      //  ()\n      shield: 0x6666FF,    //  ()\n      energy: 0xFFFF66,    //  ()\n      burn: 0xFF6600,      //  ()\n      freeze: 0x66FFFF,    //  ()\n      shock: 0xFFEE66,     //   ()\n      vulnerable: 0xFF66FF, //  ()\n      buff: 0xFFD700,      //  ()\n      draw: 0xFFFFFF,      //  ()\n      'card-trail': 0x4A9EFF, //  ( )\n    };\n    \n    const flashColor = effectColors[effectType] || 0xFFFFFF;\n    sprite.tint = flashColor;\n    \n    // 0.15     ( )\n    setTimeout(() => {\n      sprite.tint = 0xFFFFFF;\n    }, 150);\n  }\n  \n  //   \n  function getPosition(target: 'player' | 'enemy' | 'center'): { x: number; y: number } {\n    const centerX = app.renderer.width / 2;\n    const centerY = app.renderer.height / 2;\n    \n    switch (target) {\n      case 'player':\n        //   \n        return { \n          x: playerDeckContainer.x, \n          y: playerDeckContainer.y \n        };\n      case 'enemy':\n        //   \n        return { \n          x: enemyDeckContainer.x, \n          y: enemyDeckContainer.y \n        };\n      case 'center':\n        //  \n        return { \n          x: centerX, \n          y: centerY \n        };\n      default:\n        return { x: centerX, y: centerY };\n    }\n  }\n  \n  //     \n  setCardUseAnimationCallback(async (card, isPlayerCard, handIndex) => {\n    await showCardUseAnimation(card, isPlayerCard, handIndex);\n  });\n  \n  // VFX   (store VFX )\n  setVFXCallback((type, target, value) => {\n    const pos = getPosition(target);\n    \n    switch (type) {\n      case 'damage':\n        vfxManager.playDamageEffect(pos.x, pos.y, value || 0);\n        audioManager.playSFX('damage', 0.8);\n        if (target === 'player') {\n          flashCharacterSprite(playerDeckData.characterSprite, 'damage');\n        } else if (target === 'enemy') {\n          flashCharacterSprite(enemyDeckData.characterSprite, 'damage');\n        }\n        break;\n      case 'heal':\n        vfxManager.playHealEffect(pos.x, pos.y, value || 0);\n        audioManager.playSFX('heal', 0.7);\n        if (target === 'player') {\n          flashCharacterSprite(playerDeckData.characterSprite, 'heal');\n        } else if (target === 'enemy') {\n          flashCharacterSprite(enemyDeckData.characterSprite, 'heal');\n        }\n        break;\n      case 'shield':\n        vfxManager.playShieldEffect(pos.x, pos.y);\n        audioManager.playSFX('shield', 0.6);\n        if (target === 'player') {\n          flashCharacterSprite(playerDeckData.characterSprite, 'shield');\n        } else if (target === 'enemy') {\n          flashCharacterSprite(enemyDeckData.characterSprite, 'shield');\n        }\n        break;\n      case 'energy':\n        vfxManager.playEnergyEffect(pos.x, pos.y);\n        if (target === 'player') {\n          flashCharacterSprite(playerDeckData.characterSprite, 'energy');\n        } else if (target === 'enemy') {\n          flashCharacterSprite(enemyDeckData.characterSprite, 'energy');\n        }\n        break;\n      case 'draw':\n        vfxManager.playDrawEffect(pos.x, pos.y);\n        audioManager.playSFX('card_draw', 0.5);\n        if (target === 'player') {\n          flashCharacterSprite(playerDeckData.characterSprite, 'draw');\n        } else if (target === 'enemy') {\n          flashCharacterSprite(enemyDeckData.characterSprite, 'draw');\n        }\n        break;\n      case 'burn':\n        vfxManager.playBurnEffect(pos.x, pos.y);\n        audioManager.playSFX('burn', 0.6);\n        if (target === 'player') {\n          flashCharacterSprite(playerDeckData.characterSprite, 'burn');\n        } else if (target === 'enemy') {\n          flashCharacterSprite(enemyDeckData.characterSprite, 'burn');\n        }\n        break;\n      case 'freeze':\n        vfxManager.playFreezeEffect(pos.x, pos.y);\n        audioManager.playSFX('freeze', 0.6);\n        if (target === 'player') {\n          flashCharacterSprite(playerDeckData.characterSprite, 'freeze');\n        } else if (target === 'enemy') {\n          flashCharacterSprite(enemyDeckData.characterSprite, 'freeze');\n        }\n        break;\n      case 'shock':\n        vfxManager.playShockEffect(pos.x, pos.y);\n        audioManager.playSFX('shock', 0.7);\n        if (target === 'player') {\n          flashCharacterSprite(playerDeckData.characterSprite, 'shock');\n        } else if (target === 'enemy') {\n          flashCharacterSprite(enemyDeckData.characterSprite, 'shock');\n        }\n        break;\n      case 'vulnerable':\n        vfxManager.playVulnerableEffect(pos.x, pos.y);\n        if (target === 'player') {\n          flashCharacterSprite(playerDeckData.characterSprite, 'vulnerable');\n        } else if (target === 'enemy') {\n          flashCharacterSprite(enemyDeckData.characterSprite, 'vulnerable');\n        }\n        break;\n      case 'buff':\n        vfxManager.playBuffEffect(pos.x, pos.y);\n        if (target === 'player') {\n          flashCharacterSprite(playerDeckData.characterSprite, 'buff');\n        } else if (target === 'enemy') {\n          flashCharacterSprite(enemyDeckData.characterSprite, 'buff');\n        }\n        break;\n      case 'victory':\n        vfxManager.playVictoryEffect(pos.x, pos.y);\n        audioManager.playSFX('victory', 1.0);\n        break;\n      case 'defeat':\n        vfxManager.playDefeatEffect(pos.x, pos.y);\n        audioManager.playSFX('defeat', 1.0);\n        break;\n      case 'card-trail':\n        vfxManager.playCardTrailEffect(pos.x, pos.y, value || 0x4a9eff);\n        audioManager.playSFX('card_play', 0.5);\n        break;\n      default:\n        console.warn(`[VFX] Unknown effect type: ${type}`);\n    }\n  });\n\n  // Enemy Hand UI (Pixi Container)\n  const enemyHandContainer = new Container();\n  enemyHandContainer.y = 50;\n  app.stage.addChild(enemyHandContainer);\n  \n  // HP   \n  const playerHPBar = new Container();\n  const enemyHPBar = new Container();\n  \n  // HP   \n  function createHPBar(container: Container, maxWidth: number, isPlayer: boolean) {\n    container.removeChildren();\n    \n    //  ( )\n    const bgBar = new Graphics();\n    bgBar.rect(0, 0, maxWidth, 20);\n    bgBar.fill({ color: 0x333333 });\n    container.addChild(bgBar);\n    \n    // HP  ( )\n    const hpBar = new Graphics();\n    hpBar.rect(0, 0, maxWidth, 20);\n    hpBar.fill({ color: 0x4CAF50 });\n    container.addChild(hpBar);\n    \n    // \n    const border = new Graphics();\n    border.rect(0, 0, maxWidth, 20);\n    border.stroke({ color: 0x000000, width: 2 });\n    container.addChild(border);\n    \n    // HP \n    const hpText = new Text({\n      text: '100/100',\n      style: {\n        fontSize: 14,\n        fill: 0xffffff,\n        fontWeight: 'bold',\n        stroke: { color: 0x000000, width: 3 }\n      }\n    });\n    hpText.anchor.set(0.5);\n    hpText.x = maxWidth / 2;\n    hpText.y = 10;\n    container.addChild(hpText);\n    \n    //  \n    const nameText = new Text({\n      text: isPlayer ? 'PLAYER' : 'ENEMY',\n      style: {\n        fontSize: 12,\n        fill: isPlayer ? 0x4a9eff : 0xff4444,\n        fontWeight: 'bold'\n      }\n    });\n    nameText.x = 0;\n    nameText.y = -18;\n    container.addChild(nameText);\n    \n    return { hpBar, hpText, bgBar };\n  }\n  \n  // HP   (  -        )\n  let playerHPBarWidth = 200;\n  let enemyHPBarWidth = 200;\n  let playerHPComponents = createHPBar(playerHPBar, playerHPBarWidth, true);\n  let enemyHPComponents = createHPBar(enemyHPBar, enemyHPBarWidth, false);\n  \n  // HP    updateBattleLayout \n  \n  app.stage.addChild(playerHPBar);\n  app.stage.addChild(enemyHPBar);\n  \n  //    \n  function createEnergyBar(container: Container, maxWidth: number, isPlayer: boolean) {\n    container.removeChildren();\n    \n    //   -     \n    const isMobile = window.innerWidth <= 768;\n    const isSmallMobile = window.innerWidth <= 480;\n    const barHeight = isSmallMobile ? 12 : 16;\n    const fontSize = isSmallMobile ? 9 : (isMobile ? 10 : 12);\n    \n    //  ( )\n    const bgBar = new Graphics();\n    bgBar.rect(0, 0, maxWidth, barHeight);\n    bgBar.fill({ color: 0x333333 });\n    container.addChild(bgBar);\n    \n    //   ()\n    const energyBar = new Graphics();\n    energyBar.rect(0, 0, maxWidth, barHeight);\n    energyBar.fill({ color: 0xffeb3b }); // \n    container.addChild(energyBar);\n    \n    // \n    const border = new Graphics();\n    border.rect(0, 0, maxWidth, barHeight);\n    border.stroke({ color: 0x000000, width: 2 });\n    container.addChild(border);\n    \n    //  \n    const energyText = new Text({\n      text: '10/10',\n      style: {\n        fontSize: fontSize,\n        fill: 0x000000,\n        fontWeight: 'bold'\n      }\n    });\n    energyText.anchor.set(0.5);\n    energyText.x = maxWidth / 2;\n    energyText.y = barHeight / 2;\n    container.addChild(energyText);\n    \n    return { energyBar, energyText, bgBar };\n  }\n  \n  //    \n  const playerEnergyBar = new Container();\n  const enemyEnergyBar = new Container();\n  let playerEnergyComponents = createEnergyBar(playerEnergyBar, 200, true);\n  let enemyEnergyComponents = createEnergyBar(enemyEnergyBar, 200, false);\n  \n  app.stage.addChild(playerEnergyBar);\n  app.stage.addChild(enemyEnergyBar);\n  \n  // ================== / UI (HP  ) ==================\n  \n  const playerStatusContainer = new Container();\n  playerStatusContainer.x = playerHPBar.x;\n  playerStatusContainer.y = playerHPBar.y + 30; // HP \n  app.stage.addChild(playerStatusContainer);\n  \n  const enemyStatusContainer = new Container();\n  enemyStatusContainer.x = enemyHPBar.x;\n  enemyStatusContainer.y = enemyHPBar.y + 30; // HP \n  app.stage.addChild(enemyStatusContainer);\n  \n  //    \n  function createStatusIcon(emoji: string, value: number, duration: number, color: number): Container {\n    const container = new Container();\n    \n    // \n    const bg = new Graphics();\n    bg.rect(0, 0, 50, 24);\n    bg.fill({ color: color, alpha: 0.8 });\n    bg.stroke({ color: 0x000000, width: 1 });\n    container.addChild(bg);\n    \n    //  + \n    const text = new Text({\n      text: `${emoji} ${value}`,\n      style: {\n        fontSize: 14,\n        fill: 0xffffff,\n        fontWeight: 'bold'\n      }\n    });\n    text.x = 4;\n    text.y = 4;\n    container.addChild(text);\n    \n    //   ()\n    if (duration > 0) {\n      const durationText = new Text({\n        text: `${duration}T`,\n        style: {\n          fontSize: 10,\n          fill: 0xcccccc\n        }\n      });\n      durationText.x = 38;\n      durationText.y = 2;\n      container.addChild(durationText);\n    }\n    \n    return container;\n  }\n  \n  //  UI  \n  function updateStatusUI() {\n    const state = useBattleStore.getState();\n    \n    //  / \n    const statusIconMap: Record<string, { emoji: string; color: number }> = {\n      'Burn': { emoji: '', color: 0xf44336 },\n      'Freeze': { emoji: '', color: 0x03a9f4 },\n      'Shock': { emoji: '', color: 0xffeb3b },\n      'Vulnerable': { emoji: '', color: 0xe91e63 },\n      'Weak': { emoji: '', color: 0x795548 },\n      'Poison': { emoji: '', color: 0x4caf50 },\n      'Silence': { emoji: '', color: 0x607d8b },\n      'Strength': { emoji: '', color: 0xff9800 },\n      'Vigor': { emoji: '', color: 0xffc107 },\n      'Focus': { emoji: '', color: 0x9c27b0 },\n    };\n    \n    //   \n    playerStatusContainer.removeChildren();\n    let playerX = 0;\n    \n    //   -  \n    if (state.playerStatus.shield > 0) {\n      const icon = createStatusIcon('', state.playerStatus.shield, state.playerStatus.shieldDuration, 0x4a9eff);\n      icon.x = playerX;\n      playerStatusContainer.addChild(icon);\n      playerX += 54;\n    }\n    if (state.playerStatus.guard > 0) {\n      const icon = createStatusIcon('', state.playerStatus.guard, state.playerStatus.guardDuration, 0x2196f3);\n      icon.x = playerX;\n      playerStatusContainer.addChild(icon);\n      playerX += 54;\n    }\n    \n    //   -  \n    if (state.playerStatus.attackBuff > 0) {\n      const icon = createStatusIcon('', state.playerStatus.attackBuff, 0, 0xff9800);\n      icon.x = playerX;\n      playerStatusContainer.addChild(icon);\n      playerX += 54;\n    }\n    if (state.playerStatus.regen > 0) {\n      const icon = createStatusIcon('', state.playerStatus.regen, 0, 0x4caf50);\n      icon.x = playerX;\n      playerStatusContainer.addChild(icon);\n      playerX += 54;\n    }\n    if (state.playerStatus.shockStacks > 0) {\n      const icon = createStatusIcon('', state.playerStatus.shockStacks, 0, 0xffeb3b);\n      icon.x = playerX;\n      playerStatusContainer.addChild(icon);\n      playerX += 54;\n    }\n    if (state.playerStatus.evasionCharges > 0) {\n      const icon = createStatusIcon('', state.playerStatus.evasionCharges, state.playerStatus.evasionDuration, 0x9c27b0);\n      icon.x = playerX;\n      playerStatusContainer.addChild(icon);\n      playerX += 54;\n    }\n    if (state.playerStatus.nullifyCharges > 0) {\n      const icon = createStatusIcon('', state.playerStatus.nullifyCharges, 0, 0xff9800);\n      icon.x = playerX;\n      playerStatusContainer.addChild(icon);\n      playerX += 54;\n    }\n    if (state.playerStatus.counterValue > 0) {\n      const icon = createStatusIcon('', state.playerStatus.counterValue, state.playerStatus.counterDuration, 0xe91e63);\n      icon.x = playerX;\n      playerStatusContainer.addChild(icon);\n      playerX += 54;\n    }\n    \n    // statuses  -   \n    state.playerStatus.statuses.forEach((status) => {\n      const iconData = statusIconMap[status.key];\n      if (iconData) {\n        const icon = createStatusIcon(iconData.emoji, status.stacks || 1, status.duration, iconData.color);\n        icon.x = playerX;\n        playerStatusContainer.addChild(icon);\n        playerX += 54;\n      }\n    });\n    \n    //   \n    enemyStatusContainer.removeChildren();\n    let enemyX = 0;\n    \n    //   -  \n    if (state.enemyStatus.shield > 0) {\n      const icon = createStatusIcon('', state.enemyStatus.shield, state.enemyStatus.shieldDuration, 0x4a9eff);\n      icon.x = enemyX;\n      enemyStatusContainer.addChild(icon);\n      enemyX += 54;\n    }\n    if (state.enemyStatus.guard > 0) {\n      const icon = createStatusIcon('', state.enemyStatus.guard, state.enemyStatus.guardDuration, 0x2196f3);\n      icon.x = enemyX;\n      enemyStatusContainer.addChild(icon);\n      enemyX += 54;\n    }\n    \n    //   -  \n    if (state.enemyStatus.attackBuff > 0) {\n      const icon = createStatusIcon('', state.enemyStatus.attackBuff, 0, 0xff9800);\n      icon.x = enemyX;\n      enemyStatusContainer.addChild(icon);\n      enemyX += 54;\n    }\n    if (state.enemyStatus.regen > 0) {\n      const icon = createStatusIcon('', state.enemyStatus.regen, 0, 0x4caf50);\n      icon.x = enemyX;\n      enemyStatusContainer.addChild(icon);\n      enemyX += 54;\n    }\n    if (state.enemyStatus.shockStacks > 0) {\n      const icon = createStatusIcon('', state.enemyStatus.shockStacks, 0, 0xffeb3b);\n      icon.x = enemyX;\n      enemyStatusContainer.addChild(icon);\n      enemyX += 54;\n    }\n    if (state.enemyStatus.evasionCharges > 0) {\n      const icon = createStatusIcon('', state.enemyStatus.evasionCharges, state.enemyStatus.evasionDuration, 0x9c27b0);\n      icon.x = enemyX;\n      enemyStatusContainer.addChild(icon);\n      enemyX += 54;\n    }\n    if (state.enemyStatus.nullifyCharges > 0) {\n      const icon = createStatusIcon('', state.enemyStatus.nullifyCharges, 0, 0xff9800);\n      icon.x = enemyX;\n      enemyStatusContainer.addChild(icon);\n      enemyX += 54;\n    }\n    if (state.enemyStatus.counterValue > 0) {\n      const icon = createStatusIcon('', state.enemyStatus.counterValue, state.enemyStatus.counterDuration, 0xe91e63);\n      icon.x = enemyX;\n      enemyStatusContainer.addChild(icon);\n      enemyX += 54;\n    }\n    \n    // statuses  -   \n    state.enemyStatus.statuses.forEach((status) => {\n      const iconData = statusIconMap[status.key];\n      if (iconData) {\n        const icon = createStatusIcon(iconData.emoji, status.stacks || 1, status.duration, iconData.color);\n        icon.x = enemyX;\n        enemyStatusContainer.addChild(icon);\n        enemyX += 54;\n      }\n    });\n    \n    //   \n    playerStatusContainer.visible = state.gameScreen === 'battle';\n    enemyStatusContainer.visible = state.gameScreen === 'battle';\n  }\n  \n  //  HP  \n  const initialState = useBattleStore.getState();\n  updateHPBar(playerHPBar, playerHPComponents, initialState.playerHp, initialState.playerMaxHp, playerHPBarWidth, initialState.playerHp, false);\n  updateHPBar(enemyHPBar, enemyHPComponents, initialState.enemyHp, initialState.enemyMaxHp, enemyHPBarWidth, initialState.enemyHp, false);\n  \n  //    \n  updateEnergyBar(playerEnergyBar, playerEnergyComponents, initialState.energy, 10, playerHPBarWidth);\n  updateEnergyBar(enemyEnergyBar, enemyEnergyComponents, initialState.enemyEnergy, 10, enemyHPBarWidth);\n  \n  //   UI\n  updateStatusUI();\n  \n  //       (  )\n  const updateBattleLayout = () => {\n    const { width: viewportWidth, height: viewportHeight } = getViewportSize();\n    const isLandscapeCompact = document.body.classList.contains('mobile-landscape');\n    const isMobile = viewportWidth <= 768 || viewportHeight <= 620 || isLandscapeCompact;\n    const isSmallMobile = viewportWidth <= 480 || viewportHeight <= 380;\n    \n    // HP     \n    const newPlayerHPBarWidth = isSmallMobile ? 120 : (isLandscapeCompact ? 140 : (isMobile ? 150 : 200));\n    const newEnemyHPBarWidth = isSmallMobile ? 120 : (isLandscapeCompact ? 140 : (isMobile ? 150 : 200));\n    \n    if (playerHPBarWidth !== newPlayerHPBarWidth) {\n      playerHPBarWidth = newPlayerHPBarWidth;\n      const state = useBattleStore.getState();\n      playerHPComponents = createHPBar(playerHPBar, playerHPBarWidth, true);\n      updateHPBar(playerHPBar, playerHPComponents, state.playerHp, state.playerMaxHp, playerHPBarWidth, state.playerHp, false);\n      //     \n      playerEnergyComponents = createEnergyBar(playerEnergyBar, playerHPBarWidth, true);\n      updateEnergyBar(playerEnergyBar, playerEnergyComponents, state.energy, 10, playerHPBarWidth);\n    }\n    \n    if (enemyHPBarWidth !== newEnemyHPBarWidth) {\n      enemyHPBarWidth = newEnemyHPBarWidth;\n      const state = useBattleStore.getState();\n      enemyHPComponents = createHPBar(enemyHPBar, enemyHPBarWidth, false);\n      updateHPBar(enemyHPBar, enemyHPComponents, state.enemyHp, state.enemyMaxHp, enemyHPBarWidth, state.enemyHp, false);\n      //     \n      enemyEnergyComponents = createEnergyBar(enemyEnergyBar, enemyHPBarWidth, false);\n      updateEnergyBar(enemyEnergyBar, enemyEnergyComponents, state.enemyEnergy, 10, enemyHPBarWidth);\n    }\n    \n    //     \n    const bgWidth = isSmallMobile ? 90 : (isLandscapeCompact ? 100 : (isMobile ? 105 : 130));\n    const bgHeight = isSmallMobile ? 124 : (isLandscapeCompact ? 135 : (isMobile ? 145 : 180));\n    const bgHalfWidth = bgWidth / 2;\n    const bgHalfHeight = bgHeight / 2;\n    \n    //    \n    playerDeckData.shadow.clear();\n    playerDeckData.shadow.rect(-bgHalfWidth, -bgHalfHeight, bgWidth, bgHeight);\n    playerDeckData.shadow.fill({ color: 0x000000, alpha: 0.3 });\n    \n    playerDeckData.characterBackground.clear();\n    playerDeckData.characterBackground.rect(-bgHalfWidth, -bgHalfHeight, bgWidth, bgHeight);\n    playerDeckData.characterBackground.fill({ color: 0x1a1a2e, alpha: 0.3 });\n    \n    //    \n    enemyDeckData.shadow.clear();\n    enemyDeckData.shadow.rect(-bgHalfWidth, -bgHalfHeight, bgWidth, bgHeight);\n    enemyDeckData.shadow.fill({ color: 0x000000, alpha: 0.3 });\n    \n    enemyDeckData.characterBackground.clear();\n    enemyDeckData.characterBackground.rect(-bgHalfWidth, -bgHalfHeight, bgWidth, bgHeight);\n    enemyDeckData.characterBackground.fill({ color: 0x1a1a2e, alpha: 0.3 });\n    \n    //      \n    const deckOffsetX = isSmallMobile ? 100 : (isLandscapeCompact ? 140 : (isMobile ? 150 : 200));\n    const deckOffsetY = isSmallMobile ? -30 : (isLandscapeCompact ? -24 : (isMobile ? -40 : -60));\n    const hpOffsetX = isSmallMobile ? -45 : (isLandscapeCompact ? -55 : (isMobile ? -50 : -100));\n    const hpOffsetY = isSmallMobile ? 46 : (isLandscapeCompact ? 48 : (isMobile ? 60 : 60));\n    \n    playerHPBar.x = app.renderer.width / 2 - deckOffsetX + hpOffsetX;\n    playerHPBar.y = app.renderer.height / 2 + hpOffsetY;\n    \n    enemyHPBar.x = app.renderer.width / 2 + deckOffsetX + hpOffsetX;\n    enemyHPBar.y = app.renderer.height / 2 + hpOffsetY;\n    \n    //     (HP  )\n    const energyBarOffset = isSmallMobile ? 20 : (isLandscapeCompact ? 18 : 25); //   \n    playerEnergyBar.x = playerHPBar.x;\n    playerEnergyBar.y = playerHPBar.y + energyBarOffset;\n    \n    enemyEnergyBar.x = enemyHPBar.x;\n    enemyEnergyBar.y = enemyHPBar.y + energyBarOffset;\n    \n    //   \n    playerDeckContainer.x = app.renderer.width / 2 - deckOffsetX;\n    playerDeckContainer.y = app.renderer.height / 2 + deckOffsetY;\n    \n    enemyDeckContainer.x = app.renderer.width / 2 + deckOffsetX;\n    enemyDeckContainer.y = app.renderer.height / 2 + deckOffsetY;\n    \n    // VS   \n    vsText.x = app.renderer.width / 2;\n    vsText.y = app.renderer.height / 2 + deckOffsetY;\n    \n    // VS   \n    if (isSmallMobile) {\n      vsText.style.fontSize = 32;\n      vsText.style.stroke = { color: 0x000000, width: 3 };\n    } else if (isLandscapeCompact) {\n      vsText.style.fontSize = 36;\n      vsText.style.stroke = { color: 0x000000, width: 3 };\n    } else if (isMobile) {\n      vsText.style.fontSize = 40;\n      vsText.style.stroke = { color: 0x000000, width: 3 };\n    } else {\n      vsText.style.fontSize = 48;\n      vsText.style.stroke = { color: 0x000000, width: 4 };\n    }\n    \n    // /    (  )\n    const statusContainerOffset = isSmallMobile ? 20 : (isLandscapeCompact ? 18 : 25); //   \n    playerStatusContainer.x = playerHPBar.x;\n    playerStatusContainer.y = playerEnergyBar.y + statusContainerOffset;\n    \n    enemyStatusContainer.x = enemyHPBar.x;\n    enemyStatusContainer.y = enemyEnergyBar.y + statusContainerOffset;\n\n    if (handContainerRef) {\n      const baseHandOffset = isSmallMobile ? 140 : (isLandscapeCompact ? 130 : (isMobile ? 170 : 220));\n      handContainerRef.y = app.renderer.height - baseHandOffset;\n    }\n  };\n  updateBattleLayoutRef = updateBattleLayout;\n  updateViewportFlags();\n  //   \n  updateBattleLayout();\n  scheduleLayoutRefresh();\n  //    HP     \n  window.addEventListener('resize', updateBattleLayout);\n  // HP     ( )\n  let prevPlayerHPForFlash = initialState.playerHp;\n  let prevEnemyHPForFlash = initialState.enemyHp;\n  // HP    \n  function flashHPBar(container: Container, hpChange: number) {\n    // HP : , HP : \n    const flashColor = hpChange < 0 ? 0xff0000 : 0x00ff00;\n    \n    //  Graphics  (bgBar)\n    const bgBar = container.getChildAt(0) as Graphics;\n    if (!bgBar) return;\n    \n    //   (0.3)\n    let flashAlpha = 0.6;\n    const fadeOutDuration = 300; // 0.3\n    const startTime = Date.now();\n    \n    const animate = () => {\n      const elapsed = Date.now() - startTime;\n      const progress = Math.min(elapsed / fadeOutDuration, 1.0);\n      \n      flashAlpha = 0.6 * (1 - progress);\n      \n      //   \n      if (progress < 1.0) {\n        // bgBar    \n        if (container.children.length > 4) { //    \n          container.removeChildAt(4);\n        }\n        \n        const flashOverlay = new Graphics();\n        flashOverlay.rect(0, 0, playerHPBarWidth, 20);\n        flashOverlay.fill({ color: flashColor, alpha: flashAlpha });\n        container.addChildAt(flashOverlay, 4); //   \n        \n        requestAnimationFrame(animate);\n      } else {\n        //     \n        if (container.children.length > 4) {\n          container.removeChildAt(4);\n        }\n      }\n    };\n    \n    animate();\n  }\n  \n  // HP   \n  function updateHPBar(\n    container: Container,\n    components: { hpBar: Graphics; hpText: Text; bgBar: Graphics },\n    currentHP: number,\n    maxHP: number,\n    maxWidth: number,\n    prevHP: number,\n    animate: boolean = true\n  ) {\n    const ratio = Math.max(0, Math.min(1, currentHP / maxHP));\n    const targetWidth = maxWidth * ratio;\n    \n    //   (    )\n    let color: number;\n    if (ratio > 0.6) {\n      color = 0x4CAF50; // \n    } else if (ratio > 0.3) {\n      color = 0xffeb3b; // \n    } else {\n      color = 0xf44336; // \n    }\n    \n    // HP    \n    components.hpBar.clear();\n    components.hpBar.rect(0, 0, targetWidth, 20);\n    components.hpBar.fill({ color });\n    \n    //  \n    components.hpText.text = `${Math.round(currentHP)}/${maxHP}`;\n    \n    //    (HP  )\n    if (animate && Math.abs(currentHP - prevHP) > 0.1) {\n      const hpChange = currentHP - prevHP;\n      flashHPBar(container, hpChange);\n    }\n  }\n  \n  //    \n  function updateEnergyBar(\n    container: Container,\n    components: { energyBar: Graphics; energyText: Text; bgBar: Graphics },\n    currentEnergy: number,\n    maxEnergy: number,\n    maxWidth: number\n  ) {\n    const ratio = Math.max(0, Math.min(1, currentEnergy / maxEnergy));\n    const targetWidth = maxWidth * ratio;\n    \n    //   -    (createEnergyBar  )\n    const isMobile = window.innerWidth <= 768;\n    const isSmallMobile = window.innerWidth <= 480;\n    const barHeight = isSmallMobile ? 12 : 16;\n    \n    //    \n    components.energyBar.clear();\n    components.energyBar.rect(0, 0, targetWidth, barHeight);\n    components.energyBar.fill({ color: 0xffeb3b }); // \n    \n    //  \n    components.energyText.text = `${Math.round(currentEnergy)}/${maxEnergy}`;\n  }\n  \n  let enemyCardSprites: { sprite: Sprite; container: Container; index: number }[] = [];\n  let isRenderingEnemyHand = false;\n  let pendingEnemyRender = false;\n  \n  function renderEnemyHand() {\n    //      \n    if (isRenderingEnemyHand) {\n      pendingEnemyRender = true;\n      return;\n    }\n    isRenderingEnemyHand = true;\n    \n    try {\n      const state = useBattleStore.getState();\n      \n      // Release all pooled cards (  )\n      enemyHandPool.releaseAll();\n      enemyCardSprites = [];\n      enemyHandContainer.removeChildren();\n      \n      if (!state.enemyHand || state.enemyHand.length === 0) {\n        isRenderingEnemyHand = false;\n        return;\n      }\n      \n      //      \n      const cardsToShow = isDrawingEnemyCards ? Math.min(enemyCardsToRender, state.enemyHand.length) : state.enemyHand.length;\n      \n      //     \n      const isMobileView = window.innerWidth <= 768;\n      const cardWidth = isMobileView ? 90 : 100;\n      const cardHeight = isMobileView ? 135 : 150;\n      const spacing = isMobileView ? 6 : 8;\n      const startX = (app.renderer.width - (cardsToShow * (cardWidth + spacing) - spacing)) * 0.5;\n      \n      for (let idx = 0; idx < cardsToShow; idx++) {\n        const card = state.enemyHand[idx];\n        \n        //    ( or  )\n        const pooledCard = enemyHandPool.acquire(cardWidth, cardHeight);\n        const { container, costText, nameText } = pooledCard;\n        \n        //  :    (    )\n        container.x = startX + idx * (cardWidth + spacing);\n        container.y = 0;\n        container.visible = true;\n        container.scale.set(1.0);\n        container.alpha = 1.0; //  \n        container.tint = 0xFFFFFF; //  \n        \n        //     \n        const cardBackPath = getCardBackImage();\n        \n        if (cardBackPath) {\n          const sprite = Sprite.from(cardBackPath);\n          sprite.width = cardWidth;\n          sprite.height = cardHeight;\n          sprite.tint = 0xFFFFFF; //   \n          enemyHandPool.replaceSprite(pooledCard, sprite);\n        } else {\n          // Fallback: create placeholder if card back not loaded\n          const placeholder = new Graphics();\n          placeholder.rect(0, 0, cardWidth, cardHeight);\n          placeholder.fill({ color: 0x2a1a4a }); //  \n          //  \"?\" \n          const text = new Text({ text: '?', style: { fontSize: 48, fill: 0xffd700 } });\n          text.anchor.set(0.5);\n          text.x = cardWidth / 2;\n          text.y = cardHeight / 2;\n          placeholder.addChild(text);\n          enemyHandPool.replaceSprite(pooledCard, placeholder);\n        }\n        \n        //     ()\n        costText.visible = false;\n        nameText.visible = false;\n        \n        //  \n        container.eventMode = 'static';\n        container.cursor = 'default';\n        \n        container.on('pointerenter', () => {\n          container.scale.set(1.1);\n        });\n        \n        container.on('pointerleave', () => {\n          container.scale.set(1.0);\n        });\n        \n        enemyHandContainer.addChild(container);\n        enemyCardSprites.push({ sprite: pooledCard.sprite as Sprite, container, index: idx });\n      }\n    } finally {\n      isRenderingEnemyHand = false;\n      //       \n      if (pendingEnemyRender) {\n        pendingEnemyRender = false;\n        renderEnemyHand();\n      }\n    }\n  }\n\n  // Hand UI (Pixi Container)\n  const handContainer = new Container();\n  handContainer.y = app.renderer.height - 220;\n  app.stage.addChild(handContainer);\n  handContainerRef = handContainer;\n  \n  //    ()\n  let handScrollData = {\n    isDragging: false,\n    startX: 0,\n    startContainerX: 0,\n    minX: 0,\n    maxX: 0,\n  };\n  \n  //    (  )\n  function updateHandScrollBounds() {\n    const state = useBattleStore.getState();\n    if (!state.hand || state.hand.length === 0) {\n      handScrollData.minX = 0;\n      handScrollData.maxX = 0;\n      return;\n    }\n    \n    const isMobileView = window.innerWidth <= 768;\n    const cardWidth = isMobileView ? 100 : 120;\n    const spacing = isMobileView ? 8 : 10;\n    const totalWidth = state.hand.length * (cardWidth + spacing) - spacing;\n    const screenWidth = app.renderer.width;\n    \n    //     \n    if (totalWidth > screenWidth) {\n      handScrollData.maxX = 0;\n      handScrollData.minX = screenWidth - totalWidth - 50; // 50px \n    } else {\n      //   \n      handScrollData.minX = 0;\n      handScrollData.maxX = 0;\n      handContainer.x = 0;\n    }\n  }\n  \n  // /  \n  handContainer.eventMode = 'static';\n  handContainer.on('pointerdown', (event) => {\n    handScrollData.isDragging = true;\n    handScrollData.startX = event.global.x;\n    handScrollData.startContainerX = handContainer.x;\n  });\n  \n  handContainer.on('pointermove', (event) => {\n    if (!handScrollData.isDragging) return;\n    \n    const dx = event.global.x - handScrollData.startX;\n    let newX = handScrollData.startContainerX + dx;\n    \n    //  \n    newX = Math.max(handScrollData.minX, Math.min(handScrollData.maxX, newX));\n    handContainer.x = newX;\n  });\n  \n  handContainer.on('pointerup', () => {\n    handScrollData.isDragging = false;\n  });\n  \n  handContainer.on('pointerupoutside', () => {\n    handScrollData.isDragging = false;\n  });\n  \n  let cardSprites: { sprite: Sprite; container: Container; index: number }[] = [];\n  let isRenderingHand = false;\n  let pendingRender = false;\n  \n  // ==================     ==================\n  \n  async function showCardUseAnimation(card: Card, isPlayerCard: boolean, handIndex: number): Promise<void> {\n    return new Promise(async (resolve) => {\n      const cardImagePath = getCardImagePath(card);\n      \n      if (!cardImagePath) {\n        console.warn('[CardUse] Card image not found');\n        resolve();\n        return;\n      }\n      \n      try {\n        //   \n        const texture = await Assets.load(cardImagePath);\n        \n        //      (renderHand  )\n        const state = useBattleStore.getState();\n        const isMobileView = window.innerWidth <= 768;\n        const cardWidth = isMobileView ? 100 : 120;\n        const cardHeight = isMobileView ? 150 : 180;\n        const spacing = isMobileView ? 8 : 10;\n        const handCount = isPlayerCard ? state.hand.length : state.enemyHand.length;\n        const startX = (app.renderer.width - (handCount * (cardWidth + spacing) - spacing)) * 0.5;\n        \n        let fromX: number;\n        let fromY: number;\n        \n        if (isPlayerCard && handIndex >= 0) {\n          //  :   \n          fromX = startX + handIndex * (cardWidth + spacing) + cardWidth / 2;\n          fromY = app.renderer.height - cardHeight / 2 - 20;\n        } else {\n          //  :   \n          fromX = app.renderer.width / 2;\n          fromY = cardHeight / 2 + 70;\n        }\n        \n        const toX = app.renderer.width / 2;\n        const toY = app.renderer.height / 2;\n        \n        //    (  )\n        const cardContainer = new Container();\n        cardContainer.x = fromX;\n        cardContainer.y = fromY;\n        app.stage.addChild(cardContainer);\n        \n        //   (  )\n        const cardSprite = new Sprite(texture);\n        cardSprite.anchor.set(0.5);\n        cardSprite.width = cardWidth;\n        cardSprite.height = cardHeight;\n        cardContainer.addChild(cardSprite);\n        \n        //   ( )\n        const overlay = new Graphics();\n        overlay.rect(0, 0, app.renderer.width, app.renderer.height);\n        overlay.fill({ color: 0x000000, alpha: 0 });\n        app.stage.addChildAt(overlay, app.stage.children.indexOf(cardContainer));\n        \n        //  \n        const glow = new Graphics();\n        const glowSize = 210; //   \n        glow.rect(-glowSize/2, -glowSize * 275/200/2, glowSize, glowSize * 275/200);\n        glow.stroke({ color: isPlayerCard ? 0x4a9eff : 0xff4444, width: 4 });\n        glow.alpha = 0;\n        cardContainer.addChild(glow);\n        \n        // Phase 0:    (0.4) \n        const moveDuration = 400;\n        const startTime0 = Date.now();\n        \n        const moveToCenter = () => {\n          const elapsed = Date.now() - startTime0;\n          const progress = Math.min(elapsed / moveDuration, 1.0);\n          const eased = Easing.easeOutCubic(progress);\n          \n          cardContainer.x = fromX + (toX - fromX) * eased;\n          cardContainer.y = fromY + (toY - fromY) * eased;\n          overlay.alpha = eased * 0.3;\n          \n          if (progress < 1.0) {\n            requestAnimationFrame(moveToCenter);\n          } else {\n            // Phase 1:  (0.5)\n            expandCard();\n          }\n        };\n        \n        const expandCard = () => {\n          const expandDuration = 500;\n          const startTime1 = Date.now();\n          const startWidth = cardSprite.width;\n          const startHeight = cardSprite.height;\n          const targetWidth = 200;\n          const targetHeight = 275;\n        \n          const expand = () => {\n            const elapsed = Date.now() - startTime1;\n            const progress = Math.min(elapsed / expandDuration, 1.0);\n            const eased = Easing.easeOutCubic(progress);\n            \n            cardSprite.width = startWidth + (targetWidth - startWidth) * eased;\n            cardSprite.height = startHeight + (targetHeight - startHeight) * eased;\n            overlay.alpha = 0.3 + eased * 0.2; // 0.3  0.5\n            glow.alpha = eased * 0.8;\n            \n            if (progress < 1.0) {\n              requestAnimationFrame(expand);\n            } else {\n              // Phase 2:  (0.4)\n              setTimeout(() => {\n                // Phase 3:  (0.3)\n                const shrinkDuration = 300;\n                const startTime2 = Date.now();\n                \n                const shrink = () => {\n                  const elapsed = Date.now() - startTime2;\n                  const progress = Math.min(elapsed / shrinkDuration, 1.0);\n                  const eased = Easing.easeInCubic(progress);\n                  \n                  cardSprite.width = targetWidth * (1.0 - eased);\n                  cardSprite.height = targetHeight * (1.0 - eased);\n                  cardContainer.alpha = 1.0 - eased;\n                  overlay.alpha = 0.5 - eased * 0.5;\n                  glow.alpha = 0.8 - eased * 0.8;\n                  \n                  if (progress < 1.0) {\n                    requestAnimationFrame(shrink);\n                  } else {\n                    // \n                    app.stage.removeChild(cardContainer);\n                    app.stage.removeChild(overlay);\n                  \n                  //  \n                  const centerX = app.renderer.width / 2;\n                  const centerY = app.renderer.height / 2;\n                  vfxManager.playCardTrailEffect(centerX, centerY, isPlayerCard ? 0x4a9eff : 0xff4444);\n                  \n                  resolve();\n                }\n              };\n              \n              shrink();\n            }, 400);\n          }\n        };\n        \n        expand();\n      };\n        \n        //   (  )\n        moveToCenter();\n        \n      } catch (err) {\n        console.warn('[CardUse] Failed to load card image:', err);\n        resolve();\n      }\n    });\n  }\n  \n  //    \n  async function animateCardDraw(targetPosition: { x: number; y: number }, isPlayerCard: boolean = true): Promise<void> {\n    return new Promise((resolve) => {\n      //       \n      const cardSprite = new Sprite();\n      const cardBackPath = getCardBackImage();\n      \n      if (!cardBackPath) {\n        resolve();\n        return;\n      }\n      \n      Assets.load(cardBackPath).then((texture) => {\n        cardSprite.texture = texture;\n        cardSprite.width = 120;\n        cardSprite.height = 165;\n        cardSprite.anchor.set(0.5);\n        \n        //  :    \n        const deckContainer = isPlayerCard ? playerDeckContainer : enemyDeckContainer;\n        cardSprite.x = deckContainer.x;\n        cardSprite.y = deckContainer.y;\n        cardSprite.rotation = 0;\n        cardSprite.alpha = 1.0;\n        \n        app.stage.addChild(cardSprite);\n        \n        //  \n        const duration = 300; // 0.3\n        const startTime = Date.now();\n        const startX = cardSprite.x;\n        const startY = cardSprite.y;\n        \n        //  \n        const animate = () => {\n          const elapsed = Date.now() - startTime;\n          const progress = Math.min(elapsed / duration, 1.0);\n          const eased = Easing.easeOutQuad(progress);\n          \n          //  \n          cardSprite.x = startX + (targetPosition.x - startX) * eased;\n          cardSprite.y = startY + (targetPosition.y - startY) * eased;\n          \n          //   ( )\n          cardSprite.rotation = Math.PI * 2 * eased;\n          \n          if (progress < 1.0) {\n            requestAnimationFrame(animate);\n          } else {\n            //  \n            app.stage.removeChild(cardSprite);\n            \n            //  \n            vfxManager.playDrawEffect(targetPosition.x, targetPosition.y);\n            \n            // \n            audioManager.playSFX('card_draw', 0.5);\n            \n            resolve();\n          }\n        };\n        \n        animate();\n        \n      }).catch((err) => {\n        console.warn('[DrawAnim] Failed to load card back:', err);\n        resolve();\n      });\n    });\n  }\n  \n  function renderHand() {\n    //      \n    if (isRenderingHand) {\n      pendingRender = true;\n      return;\n    }\n    isRenderingHand = true;\n    \n    try {\n      const state = useBattleStore.getState();\n      \n      // Release all pooled cards (  )\n      playerHandPool.releaseAll();\n      cardSprites = [];\n      handContainer.removeChildren();\n      \n      if (!state.hand || state.hand.length === 0) {\n        return;\n      }\n      \n      //      \n      const cardsToShow = isDrawingCards ? Math.min(cardsToRender, state.hand.length) : state.hand.length;\n      \n      //     \n      const isMobileView = window.innerWidth <= 768;\n      const isSmallMobile = window.innerWidth <= 480;\n      const cardWidth = isSmallMobile ? 75 : (isMobileView ? 90 : 120);\n      const cardHeight = isSmallMobile ? 112 : (isMobileView ? 135 : 180);\n      const spacing = isSmallMobile ? 5 : (isMobileView ? 6 : 10);\n      const startX = (app.renderer.width - (cardsToShow * (cardWidth + spacing) - spacing)) * 0.5;\n      \n      for (let idx = 0; idx < cardsToShow; idx++) {\n      const card = state.hand[idx];\n      \n      //    ( or  )\n      const pooledCard = playerHandPool.acquire(cardWidth, cardHeight);\n      const cardContainer = pooledCard.container;\n      \n      //  :    (    )\n      cardContainer.x = startX + idx * (cardWidth + spacing);\n      cardContainer.y = 0;\n      cardContainer.visible = true;\n      cardContainer.scale.set(1.0);\n      cardContainer.alpha = 1.0; //  \n      cardContainer.tint = 0xFFFFFF; //  \n      \n      //   (   )\n      //  4  : sprite, costText, typeIcon, nameText\n      while (cardContainer.children.length > 4) {\n        cardContainer.removeChildAt(4);\n      }\n      \n      //  \n      const imagePath = getLoadedCardImage(card);\n      \n      if (imagePath) {\n        const sprite = Sprite.from(imagePath);\n        sprite.width = cardWidth;\n        sprite.height = cardHeight;\n        sprite.tint = 0xFFFFFF; //   \n        playerHandPool.replaceSprite(pooledCard, sprite);\n      } else {\n        // Fallback: create placeholder if image not loaded\n        const placeholder = new Graphics();\n        placeholder.rect(0, 0, cardWidth, cardHeight);\n        placeholder.fill({ color: state.energy < card.cost ? 0x444444 : 0x556677 });\n        playerHandPool.replaceSprite(pooledCard, placeholder);\n      }\n      \n      // Cost label  -   /  \n      playerHandPool.setupCostText(pooledCard, card.cost, cardWidth, state.energy >= card.cost);\n      const updatedCost = pooledCard.costText;\n      if (updatedCost instanceof Container) {\n        updatedCost.x = cardWidth - 15;\n        updatedCost.y = 15;\n      }\n      \n      // Type icon  -   \n      //     \n      const typeConfig = {\n        'Attack': { color: 0xFF4444, iconPath: 'cardIcons/Type/type_attack.png' },\n        'Defense': { color: 0x4444FF, iconPath: 'cardIcons/Type/type_defense.png' },\n        'Heal': { color: 0x44FF44, iconPath: 'cardIcons/Type/type_heal.png' },\n        'Special': { color: 0xFF44FF, iconPath: 'cardIcons/Type/type_special.png' },\n      }[card.type] || { color: 0xFFFFFF, iconPath: 'cardIcons/Type/type_attack.png' };\n      \n      playerHandPool.setupTypeIcon(pooledCard, typeConfig.color, typeConfig.iconPath);\n      const updatedIcon = pooledCard.typeIcon;\n      if (updatedIcon instanceof Container) {\n        updatedIcon.x = 15;\n        updatedIcon.y = 15;\n      }\n      \n      // Disabled overlay\n      if (state.energy < card.cost) {\n        const overlay = new Graphics();\n        overlay.rect(0, 0, cardWidth, cardHeight);\n        overlay.fill({ color: 0x000000, alpha: 0.5 });\n        cardContainer.addChild(overlay);\n        cardContainer.alpha = 0.6;\n      }\n      \n      // :   ,     \n      const st = useBattleStore.getState();\n      const isQueued = st.queuedHandIndices.includes(idx);\n      const remaining = st.getRemainingEnergy();\n      const canDeclare = !isQueued && st.gameOver === 'none' && card.cost <= remaining;\n      \n      //    \n      const baseY = cardContainer.y;\n      const queuedY = baseY - 20;\n      const queuedScale = 1.05;\n      \n      if (isQueued) {\n        cardContainer.y = queuedY;\n        cardContainer.scale.set(queuedScale);\n        cardContainer.alpha = 1;\n      } else {\n        cardContainer.alpha = canDeclare ? 1 : 0.5;\n      }\n      \n      // Make interactive with hover effects (  )\n      //      (  )\n      cardContainer.removeAllListeners();\n      \n      cardContainer.eventMode = 'static';\n      cardContainer.cursor = canDeclare || isQueued ? 'pointer' : 'not-allowed';\n      \n      cardContainer.on('pointerenter', (e) => {\n        const current = useBattleStore.getState();\n        const nowQueued = current.queuedHandIndices.includes(idx);\n        if (nowQueued) {\n          //  :   \n          cardContainer.y = queuedY - 10;\n          cardContainer.scale.set(queuedScale * 1.05);\n        } else if (canDeclare) {\n          //   :  hover\n          cardContainer.y = baseY - 15;\n          cardContainer.scale.set(1.1);\n        }\n        //  \n        showTooltip(card, e.globalX, e.globalY);\n      });\n      \n      cardContainer.on('pointerleave', () => {\n        const current = useBattleStore.getState();\n        const nowQueued = current.queuedHandIndices.includes(idx);\n        if (nowQueued) {\n          //   \n          cardContainer.y = queuedY;\n          cardContainer.scale.set(queuedScale);\n        } else {\n          //   \n          cardContainer.y = baseY;\n          cardContainer.scale.set(1.0);\n        }\n        //  \n        hideTooltip();\n      });\n\n      //    \n      let longPressTimer: number | null = null;\n      let pointerDownTime = 0;\n      let pointerDownPos = { x: 0, y: 0 };\n      \n      cardContainer.on('pointerdown', (e) => {\n        const currentState = useBattleStore.getState();\n        if (currentState.gameOver !== 'none') return;\n        \n        pointerDownTime = Date.now();\n        pointerDownPos = { x: e.globalX, y: e.globalY };\n        \n        //    (500ms)\n        longPressTimer = window.setTimeout(() => {\n          // :   \n          hideTooltip();\n          showCardPreview(card);\n          longPressTimer = null;\n        }, 500);\n      });\n      \n      cardContainer.on('pointerup', (e) => {\n        //   \n        if (longPressTimer !== null) {\n          clearTimeout(longPressTimer);\n          longPressTimer = null;\n        }\n        \n        const currentState = useBattleStore.getState();\n        if (currentState.gameOver !== 'none') return;\n        \n        //   +   = \n        const pressDuration = Date.now() - pointerDownTime;\n        const moveDistance = Math.hypot(e.globalX - pointerDownPos.x, e.globalY - pointerDownPos.y);\n        \n        if (pressDuration < 500 && moveDistance < 10) {\n          //  \n          hideTooltip();\n          \n          //       \n          if (useBattleStore.getState().isTurnProcessing) {\n            return;\n          }\n          \n          // :   ,  \n          if (currentState.queuedHandIndices.includes(idx)) {\n            audioManager.playSFX('card_play', 0.4);\n            useBattleStore.getState().unDeclareCard(idx);\n          } else {\n            audioManager.playSFX('card_play', 0.6);\n            useBattleStore.getState().declareCard(idx);\n          }\n        }\n      });\n      \n      cardContainer.on('pointerupoutside', () => {\n        //   \n        if (longPressTimer !== null) {\n          clearTimeout(longPressTimer);\n          longPressTimer = null;\n        }\n      });\n      \n      handContainer.addChild(cardContainer);\n      \n      //         (   hover )\n      //         hover  \n      requestAnimationFrame(() => {\n        //     (    )\n        if (!cardContainer.parent) return;\n        \n        //     ( )\n        const current = useBattleStore.getState();\n        const nowQueued = current.queuedHandIndices.includes(idx);\n        \n        //   ,   hover   \n        //       \n        if (!nowQueued) {\n          cardContainer.y = baseY;\n          cardContainer.scale.set(1.0);\n        }\n      });\n      \n      cardSprites.push({ sprite: pooledCard.sprite as Sprite, container: cardContainer, index: idx });\n      }\n    } finally {\n      isRenderingHand = false;\n      //   \n      updateHandScrollBounds();\n      //       \n      if (pendingRender) {\n        pendingRender = false;\n        renderHand(); //    (await  )\n      }\n    }\n  }\n\n  // Handle window resize\n  window.addEventListener('resize', async () => {\n    if (handContainerRef) {\n      handContainerRef.y = app.renderer.height - 220;\n    }\n    await renderHand();\n  });\n  // Load cards (but don't initialize game yet)\n  let allCards: Card[] = [];\n  let gameInitialized = false;\n  let victoryDefeatTimer: number | null = null;\n  let isInitializingGame = false; //     \n  /**\n   *     (20)\n   *     \n   */\n  function getInitialCollection(allCards: Card[]): Card[] {\n    const initialCardIds = [\n      'ATT_ARIANA_NO_001', 'ATT_ARIANA_NO_001', 'ATT_ARIANA_NO_001',\n      'ATT_DARIUS_NO_017', 'ATT_ELDER_NO_033', 'ATT_ELENA_NO_049',\n      'ATT_GAREN_NO_065', 'ATT_IRIS_NO_081',\n      'DEF_ARIANA_NO_013', 'DEF_ARIANA_NO_013', 'DEF_ARIANA_NO_013',\n      'DEF_ELENA_NO_061', 'DEF_IRIS_NO_093',\n      'HEA_ARIANA_NO_005', 'HEA_ARIANA_NO_005', 'HEA_ARIANA_NO_005',\n      'HEA_DARIUS_NO_021',\n      'SPE_ARIANA_NO_009', 'SPE_ARIANA_NO_009', 'SPE_ELDER_NO_041',\n    ];\n    \n    const cardMap = new Map(allCards.map(card => [card.id, card]));\n    const collection: Card[] = [];\n    \n    for (const cardId of initialCardIds) {\n      const card = cardMap.get(cardId);\n      if (card) {\n        collection.push({ ...card, id: `${card.id}_${Date.now()}_${Math.random()}` });\n      }\n    }\n    \n    return collection;\n  }\n  \n  try {\n    console.log('Loading cards from /data/cards.json...');\n    loadingManager.setProgress(10, '   ...');\n    allCards = await loadSampleCards();\n    console.log(`Loaded ${allCards.length} cards`);\n    // Set collection in store\n    useBattleStore.getState().setAllCardsPool(allCards);\n    \n    //  : 20  (  )\n    const storeState = useBattleStore.getState();\n    const isLoggedIn = useAuthStore.getState().session !== null;\n    if (storeState.collection.length === 0 && !isLoggedIn) {\n      const initialCollection = getInitialCollection(allCards);\n      storeState.setCollection(initialCollection);\n    }\n    \n    // Preload all card images (WebP , PNG )\n    loadingManager.setProgress(30, '   ...');\n    await preloadCardImages(allCards);\n    loadingManager.setProgress(80, ' ...');\n    \n    //      \n    await new Promise(resolve => setTimeout(resolve, 500));\n    loadingManager.setProgress(100, '!');\n    await new Promise(resolve => setTimeout(resolve, 300));\n    loadingManager.hide();\n    \n    toastManager.success(`${allCards.length}   !`, 2000);\n  } catch (e) {\n    console.error('Failed to load sample cards', e);\n    loadingManager.hide();\n    toastManager.error(`  : ${e instanceof Error ? e.message : String(e)}`, 5000);\n    handRoot.innerHTML = `<span style=\"color: #f88;\">  : ${e instanceof Error ? e.message : String(e)}</span>`;\n  }\n  \n  // Deck Editor UI\n  function renderDeckEditor() {\n    //    \n    deckEditorRoot.classList.add('active');\n    cardGalleryRoot.classList.remove('active');\n    \n    const state = useBattleStore.getState();\n    const { playerDeck, collection } = state;\n    console.log('[UI][DeckEditor] Rendering with state', {\n      deckLength: playerDeck.length,\n      collectionLength: collection.length,\n      deckSampleIds: playerDeck.slice(0, 3).map(card => card.id),\n      deckSampleNames: playerDeck.slice(0, 3).map(card => card.name),\n      collectionSampleIds: collection.slice(0, 3).map(card => card.id),\n      collectionSampleNames: collection.slice(0, 3).map(card => card.name),\n    });\n    const validity = state.getDeckValidity();\n    \n    //   \n    const costDistribution = [0, 0, 0, 0, 0, 0]; // 0-5 \n    playerDeck.forEach(card => {\n      const cost = Math.min(5, Math.max(0, card.cost));\n      costDistribution[cost]++;\n    });\n    \n    //     \n    const deckCardCounts = new Map<string, number>();\n    playerDeck.forEach(card => {\n      const count = deckCardCounts.get(card.id) || 0;\n      deckCardCounts.set(card.id, count + 1);\n    });\n\n    const isMobileView = window.innerWidth <= 768;\n    const isSmallMobile = window.innerWidth <= 480;\n    const deckColumnMinWidth = isSmallMobile ? 80 : (isMobileView ? 100 : 110);\n    const collectionMinWidth = isSmallMobile ? 120 : (isMobileView ? 140 : 160);\n    const collectionGap = isSmallMobile ? 10 : (isMobileView ? 14 : 18);\n    const deckGap = isSmallMobile ? 6 : 8;\n\n    const totalCost = playerDeck.reduce((sum, card) => sum + (card?.cost ?? 0), 0);\n    const averageCost = playerDeck.length > 0 ? (totalCost / playerDeck.length).toFixed(1) : '0.0';\n    const legendaryCount = playerDeck.filter(card => card.rarity === 'Legendary').length;\n    const uniqueDeckCards = new Set(playerDeck.map(card => (card.id.split('__snap__')[0] ?? card.id)));\n\n    const deckErrorsMarkup = validity.errors.length > 0\n      ? `\n          <div style=\"background: rgba(244, 67, 54, 0.2); border: 1px solid #f44336; border-radius: 6px; padding: 8px; margin-bottom: 12px; font-size: 12px;\">\n            ${validity.errors.map(err => `<div> ${err}</div>`).join('')}\n          </div>\n        `\n      : '';\n\n    const deckStatusSummaryMarkup = validity.valid\n      ? `\n          <div style=\"background: rgba(102, 187, 106, 0.18); border: 1px solid rgba(102, 187, 106, 0.45); border-radius: 8px; padding: 10px; font-size: 12px; color: #c8e6c9;\">\n               .\n          </div>\n        `\n      : `\n          <div style=\"background: rgba(244, 67, 54, 0.18); border: 1px solid rgba(244, 67, 54, 0.45); border-radius: 8px; padding: 10px; font-size: 12px; color: #ffab91; line-height: 1.5;\">\n            ${validity.errors.map(err => ` ${err}`).join('<br>')}\n          </div>\n        `;\n\n    const costChartMarkup = `\n      <div class=\"cost-chart\">\n        <h4 style=\"margin-top: 0;\"> </h4>\n        ${costDistribution.map((count, cost) => `\n          <div class=\"cost-bar\">\n            <div class=\"label\"> ${cost}</div>\n            <div class=\"bar\">\n              <div class=\"bar-fill\" style=\"width: ${(count / 20) * 100}%\"></div>\n            </div>\n            <div class=\"count\">${count}</div>\n          </div>\n        `).join('')}\n      </div>\n    `;\n\n    const deckSummaryMarkup = `\n      <div style=\"display: flex; flex-direction: column; gap: 8px; margin-bottom: 12px;\">\n        <div style=\"background: rgba(33, 150, 243, 0.18); border: 1px solid rgba(33, 150, 243, 0.45); border-radius: 10px; padding: 10px;\">\n          <div style=\"font-size: 12px; color: #bbdefb;\"> </div>\n          <div style=\"font-size: 18px; font-weight: 700; margin-top: 4px;\">${averageCost}</div>\n        </div>\n        <div style=\"background: rgba(255, 255, 255, 0.08); border: 1px solid rgba(255, 255, 255, 0.18); border-radius: 10px; padding: 10px; display: flex; justify-content: space-between; font-size: 12px;\">\n          <span> </span>\n          <span style=\"font-weight: 700;\">${legendaryCount}</span>\n        </div>\n        <div style=\"background: rgba(255, 255, 255, 0.08); border: 1px solid rgba(255, 255, 255, 0.18); border-radius: 10px; padding: 10px; display: flex; justify-content: space-between; font-size: 12px;\">\n          <span>  </span>\n          <span style=\"font-weight: 700;\">${uniqueDeckCards.size}</span>\n        </div>\n      </div>\n    `;\n\n    const headerHTML = `\n      <div class=\"header\">\n        <div>\n          <h2>  </h2>\n          <div style=\"font-size: 11px; color: #aaa; margin-top: 6px;\">\n             <strong>PC:</strong> Shift+      | <strong>:</strong>   \n          </div>\n          <div style=\"display: flex; gap: 8px; margin-top: 8px;\">\n            <button id=\"deck-menu-btn\" style=\"background: #2a3f5f; color: #fff; border: 1px solid #3a4f75; padding: 4px 12px; border-radius: 6px; cursor: pointer;\">  </button>\n            <button id=\"deck-gallery-btn\" style=\"background: #4a9eff; color: #fff; border: 1px solid #5aaeff; padding: 4px 12px; border-radius: 6px; cursor: pointer;\"> </button>\n            <button id=\"deck-auto-btn\" style=\"background: linear-gradient(90deg, rgba(108,92,231,0.9), rgba(94, 53, 177, 0.95)); color: #fefbff; border: 1px solid rgba(123,97,255,0.65); padding: 4px 12px; border-radius: 6px; cursor: pointer;\">  </button>\n          </div>\n        </div>\n        <div class=\"deck-info\">\n          <div class=\"info-item ${validity.valid ? 'valid' : 'invalid'}\">\n            <strong> :</strong> ${playerDeck.length}/20\n          </div>\n          <div class=\"info-item ${validity.valid ? 'valid' : 'invalid'}\">\n            <strong>:</strong> ${validity.valid ? ' ' : ' '}\n          </div>\n        </div>\n      </div>\n    `;\n\n    let contentHTML = '';\n\n    if (isMobileView) {\n      const pageLabels: Record<MobileDeckEditorPage, string> = {\n        collection: '',\n        deck: ' ',\n        stats: ' ',\n      };\n      if (!MOBILE_DECK_EDITOR_PAGES.includes(currentMobileDeckEditorPage)) {\n        currentMobileDeckEditorPage = 'collection';\n      }\n      const tabButtonsMarkup = MOBILE_DECK_EDITOR_PAGES.map(page => {\n        const isActive = page === currentMobileDeckEditorPage;\n        return `\n          <button\n            type=\"button\"\n            data-deck-tab=\"${page}\"\n            style=\"\n              flex: 1;\n              padding: 10px 12px;\n              border-radius: 999px;\n              border: 1px solid ${isActive ? '#4a9eff' : 'rgba(255,255,255,0.25)'};\n              background: ${isActive ? 'linear-gradient(90deg, rgba(74,158,255,0.9), rgba(33,150,243,0.9))' : 'rgba(255,255,255,0.08)'};\n              color: ${isActive ? '#E3F2FD' : '#cfd8dc'};\n              font-size: 13px;\n              font-weight: 600;\n              transition: all 0.2s ease;\n            \"\n          >\n            ${pageLabels[page]}\n          </button>\n        `;\n      }).join('');\n\n      contentHTML = `\n        <div class=\"mobile-tab-nav\" style=\"display: flex; gap: 10px; margin: 12px 0; padding: 0 2px;\">\n          ${tabButtonsMarkup}\n        </div>\n        <div class=\"mobile-page\" data-page=\"collection\" style=\"${currentMobileDeckEditorPage === 'collection' ? '' : 'display:none;'}\">\n          <h3 style=\"margin: 8px 0;\">  (${collection.length})</h3>\n          <div style=\"font-size: 12px; color: #888; margin-bottom: 8px;\">\n               ,       .\n          </div>\n          <div class=\"card-grid\" id=\"collection-grid\"></div>\n        </div>\n        <div class=\"mobile-page\" data-page=\"deck\" style=\"${currentMobileDeckEditorPage === 'deck' ? '' : 'display:none;'}\">\n          <h3 style=\"margin: 8px 0;\">  (${playerDeck.length}/20)</h3>\n          <div style=\"font-size: 12px; color: #888; margin-bottom: 8px;\">\n                ,       .\n          </div>\n          ${deckErrorsMarkup}\n          <div class=\"deck-card-list\" id=\"deck-list\"></div>\n        </div>\n        <div class=\"mobile-page\" data-page=\"stats\" style=\"${currentMobileDeckEditorPage === 'stats' ? '' : 'display:none;'}\">\n          <h3 style=\"margin: 8px 0;\"> </h3>\n          ${deckStatusSummaryMarkup}\n          ${deckSummaryMarkup}\n          ${costChartMarkup}\n        </div>\n      `;\n    } else {\n      currentMobileDeckEditorPage = 'collection';\n      contentHTML = `\n        <div class=\"content\">\n          <div class=\"collection\">\n            <h3>  (${collection.length})</h3>\n            <div style=\"font-size: 12px; color: #888; margin-bottom: 8px;\">\n              <strong>PC:</strong> :  | Shift+/: <br>\n              <strong>:</strong>  :  |   (0.5): \n            </div>\n            <div class=\"card-grid\" id=\"collection-grid\"></div>\n          </div>\n          <div class=\"current-deck\">\n            <h3>  (${playerDeck.length}/20)</h3>\n            <div style=\"font-size: 12px; color: #888; margin-bottom: 8px;\">\n              <strong>PC:</strong>   X   | Shift+: <br>\n              <strong>:</strong>    X   |  : \n            </div>\n            ${deckErrorsMarkup}\n            <div class=\"deck-card-list\" id=\"deck-list\"></div>\n            ${costChartMarkup}\n          </div>\n        </div>\n      `;\n    }\n\n    deckEditorRoot.innerHTML = `${headerHTML}${contentHTML}`;\n    \n    //     \n    const menuBtn = document.getElementById('deck-menu-btn')!;\n    menuBtn.onclick = () => {\n      useBattleStore.getState().setGameScreen('menu');\n    };\n    \n    //    \n    const galleryBtn = document.getElementById('deck-gallery-btn')!;\n    galleryBtn.onclick = () => {\n      renderCardGallery();\n    };\n    \n    const autoBtn = document.getElementById('deck-auto-btn')!;\n    autoBtn.onclick = () => {\n      if (playerDeck.length > 0 && !window.confirm('   ?\\n   .')) {\n        return;\n      }\n      const result = useBattleStore.getState().autoBuildDeck();\n      if (!result.success) {\n        toastManager.warning('     .', 3000);\n        return;\n      }\n      if (result.missing > 0) {\n        toastManager.warning(`  ! (${result.deckSize}/20) -  ${result.missing} .`, 3500);\n      } else {\n        toastManager.success('  !  .', 2500);\n      }\n      audioManager.playSFX('card_play', 0.6);\n      renderDeckEditor();\n    };\n    \n    if (isMobileView) {\n      const tabButtons = document.querySelectorAll<HTMLButtonElement>('button[data-deck-tab]');\n      tabButtons.forEach(btn => {\n        btn.onclick = () => {\n          const targetPage = btn.dataset.deckTab as MobileDeckEditorPage | undefined;\n          if (targetPage && targetPage !== currentMobileDeckEditorPage) {\n            currentMobileDeckEditorPage = targetPage;\n            renderDeckEditor();\n          }\n        };\n      });\n    }\n    \n    // Render collection cards with images\n    const collectionGrid = document.getElementById('collection-grid')!;\n    const tryAddCardToDeck = (card: Card, currentCount: number) => {\n      if (isMobile && !window.confirm(`'${card.name}'   ?`)) {\n        return;\n      }\n      const success = useBattleStore.getState().addCardToDeck(card);\n      if (!success && currentCount === 0) {\n        toastManager.warning('   Legendary  .', 2500);\n      } else if (!success) {\n        toastManager.warning(`${card.name}()  3.`, 2000);\n      } else {\n        toastManager.success(`${card.name} `, 1500);\n        audioManager.playSFX('card_play', 0.6);\n      }\n    };\n\n    if (isMobileView) {\n      const mobileMinWidth = isSmallMobile ? 130 : 150;\n      collectionGrid.style.cssText = `\n        display: grid;\n        grid-template-columns: repeat(auto-fill, minmax(${mobileMinWidth}px, 1fr));\n        gap: ${collectionGap}px;\n        padding: 8px 4px 12px;\n        max-height: 60vh;\n        overflow-y: auto;\n      `;\n      collectionGrid.style.removeProperty('scrollbar-width');\n      collectionGrid.style.removeProperty('scrollbar-color');\n    } else {\n      collectionGrid.style.cssText = `\n        display: grid;\n        grid-template-columns: repeat(auto-fill, minmax(${collectionMinWidth}px, 1fr));\n        gap: ${collectionGap}px;\n        padding: 8px 12px 16px;\n        max-height: none;\n        overflow-y: auto;\n      `;\n      collectionGrid.style.removeProperty('scrollbar-width');\n      collectionGrid.style.removeProperty('scrollbar-color');\n    }\n\n    collection.forEach(card => {\n      const inDeckCount = deckCardCounts.get(card.id) || 0;\n      const cardDiv = document.createElement('div');\n      cardDiv.className = `deck-editor-card ${inDeckCount >= 3 ? 'maxed' : ''}`;\n      cardDiv.style.cssText = `\n        position: relative;\n        cursor: pointer;\n        transition: transform 0.2s;\n      `;\n      \n      //  \n      const cardImg = document.createElement('img');\n      const imagePath = getCardImagePath(card);\n      cardImg.src = imagePath;\n      cardImg.alt = card.name;\n      cardImg.style.cssText = `\n        width: 100%;\n        ${isMobileView ? 'height: auto;' : 'height: auto;'}\n        border-radius: 8px;\n        box-shadow: 0 4px 8px rgba(0,0,0,0.3);\n        object-fit: cover;\n      `;\n      cardImg.onerror = () => {\n        cardImg.style.display = 'none';\n        cardDiv.innerHTML += `\n          <div style=\"background: linear-gradient(135deg, #2a3f5f, #1a2f4f); border: 2px solid #3a4f75; border-radius: 8px; padding: 10px; height: ${isMobileView ? 150 : 180}px; display: flex; flex-direction: column; justify-content: center; align-items: center;\">\n            <div style=\"font-weight: bold; font-size: 14px; margin-bottom: 4px; text-align: center;\">${card.name}</div>\n            <div style=\"font-size: 11px; color: #aaa; display: flex; gap: 8px;\">\n              <span> ${card.cost}</span>\n              <span>${card.type}</span>\n            </div>\n          </div>\n        `;\n      };\n      \n      //   \n      if (inDeckCount > 0) {\n        const countBadge = document.createElement('div');\n        countBadge.className = 'card-count-badge';\n        countBadge.textContent = `${inDeckCount}`;\n        countBadge.style.cssText = 'position: absolute; top: 8px; right: 8px; background: #4a9eff; color: #fff; width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: bold; box-shadow: 0 2px 6px rgba(0,0,0,0.4);';\n        cardDiv.appendChild(countBadge);\n      }\n      \n      cardDiv.appendChild(cardImg);\n      \n      //  \n      cardDiv.onmouseenter = () => {\n        cardDiv.style.transform = 'translateY(-4px)';\n        cardImg.style.boxShadow = '0 8px 16px rgba(74, 158, 255, 0.4)';\n      };\n      cardDiv.onmouseleave = () => {\n        cardDiv.style.transform = 'translateY(0)';\n        cardImg.style.boxShadow = '0 4px 8px rgba(0,0,0,0.3)';\n      };\n      \n      //   ()\n      let longPressTimer: number | null = null;\n      let touchStartTime = 0;\n      let suppressClickAfterTouch = false;\n      let touchStartX = 0;\n      let touchStartY = 0;\n      let touchMoved = false;\n      \n      cardDiv.ontouchstart = (e) => {\n        if (e.touches && e.touches.length > 0) {\n          touchStartX = e.touches[0].clientX;\n          touchStartY = e.touches[0].clientY;\n        }\n        touchStartTime = Date.now();\n        longPressTimer = window.setTimeout(() => {\n          showCardPreview(card);\n          longPressTimer = null;\n        }, 500);\n        touchMoved = false;\n      };\n      \n      cardDiv.ontouchmove = (e) => {\n        if (touchMoved) {\n          return;\n        }\n        if (e.touches && e.touches.length > 0) {\n          const moveX = e.touches[0].clientX;\n          const moveY = e.touches[0].clientY;\n          const deltaX = Math.abs(moveX - touchStartX);\n          const deltaY = Math.abs(moveY - touchStartY);\n          if (deltaX > 8 || deltaY > 8) {\n            touchMoved = true;\n            if (longPressTimer !== null) {\n              clearTimeout(longPressTimer);\n              longPressTimer = null;\n            }\n          }\n        }\n      };\n\n      cardDiv.ontouchend = (e) => {\n        if (longPressTimer !== null) {\n          clearTimeout(longPressTimer);\n          longPressTimer = null;\n        }\n        if (touchMoved) {\n          touchMoved = false;\n          suppressClickAfterTouch = true;\n          window.setTimeout(() => {\n            suppressClickAfterTouch = false;\n          }, 150);\n          return;\n        }\n        const pressDuration = Date.now() - touchStartTime;\n        if (pressDuration < 500) {\n          tryAddCardToDeck(card, inDeckCount);\n        }\n        suppressClickAfterTouch = true;\n        suppressClickAfterTouch = true;\n        window.setTimeout(() => {\n          suppressClickAfterTouch = false;\n        }, 400);\n      };\n      \n      //      ( )\n      cardDiv.ontouchcancel = () => {\n        if (longPressTimer !== null) {\n          clearTimeout(longPressTimer);\n          longPressTimer = null;\n        }\n        touchMoved = false;\n      };\n      \n      cardDiv.onclick = (e) => {\n        if (isMobile && suppressClickAfterTouch) {\n          return;\n        }\n        // Shift+:   \n        if (e.shiftKey) {\n          e.preventDefault();\n          showCardPreview(card);\n          return;\n        }\n        \n        //  :  \n        tryAddCardToDeck(card, inDeckCount);\n      };\n      \n      // :   \n      cardDiv.oncontextmenu = (e) => {\n        e.preventDefault();\n        showCardPreview(card);\n      };\n      \n      collectionGrid.appendChild(cardDiv);\n    });\n    \n    // Render deck list with card images\n    const deckList = document.getElementById('deck-list')!;\n    if (playerDeck.length === 0) {\n      deckList.innerHTML = '<div style=\"color: #777; text-align: center; padding: 20px;\"> </div>';\n    } else {\n      //   \n      if (isMobileView) {\n        const mobileDeckWidth = isSmallMobile ? 130 : 150;\n        deckList.style.cssText = `\n          display: grid;\n          grid-template-columns: repeat(auto-fill, minmax(${mobileDeckWidth}px, 1fr));\n          gap: ${deckGap}px;\n          margin-top: 16px;\n          max-height: 60vh;\n          overflow-y: auto;\n          padding: 0 4px 12px;\n        `;\n        deckList.style.removeProperty('scrollbar-width');\n        deckList.style.removeProperty('scrollbar-color');\n      } else {\n        deckList.style.cssText = `\n          display: grid;\n          grid-template-columns: repeat(auto-fill, minmax(${deckColumnMinWidth}px, 1fr));\n          gap: ${deckGap}px;\n          margin-top: 16px;\n          max-height: 600px;\n          overflow-y: auto;\n          padding: 0;\n        `;\n        deckList.style.removeProperty('scrollbar-width');\n        deckList.style.removeProperty('scrollbar-color');\n      }\n      \n      playerDeck.forEach((card, index) => {\n        const cardDiv = document.createElement('div');\n        cardDiv.style.cssText = `\n          position: relative;\n          cursor: pointer;\n          transition: transform 0.2s;\n        `;\n        \n        //  \n        const cardImg = document.createElement('img');\n        const imagePath = getCardImagePath(card);\n        cardImg.src = imagePath;\n        cardImg.alt = card.name;\n        cardImg.style.cssText = `\n          width: 100%;\n          ${isMobileView ? 'height: auto;' : 'height: auto;'}\n          border-radius: 6px;\n          box-shadow: 0 2px 6px rgba(0,0,0,0.3);\n          object-fit: cover;\n        `;\n        cardImg.onerror = () => {\n          cardImg.style.display = 'none';\n          cardDiv.innerHTML += `\n            <div style=\"background: rgba(0,0,0,0.3); border: 1px solid #3a4f75; border-radius: 6px; padding: 8px; height: ${isMobileView ? 130 : 140}px; display: flex; flex-direction: column; justify-content: center; align-items: center; font-size: 11px;\">\n              <div style=\"font-weight: bold; margin-bottom: 4px; text-align: center;\">${card.name}</div>\n              <div style=\"color: #aaa;\"> ${card.cost}</div>\n            </div>\n          `;\n        };\n        \n        //   (X )\n        const removeBtn = document.createElement('button');\n        removeBtn.textContent = '';\n        removeBtn.style.cssText = 'position: absolute; top: 4px; right: 4px; background: rgba(244, 67, 54, 0.9); color: #fff; border: none; width: 22px; height: 22px; border-radius: 50%; cursor: pointer; font-size: 12px; font-weight: bold; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 4px rgba(0,0,0,0.3); transition: all 0.2s; opacity: 0;';\n        removeBtn.onclick = (e) => {\n          e.stopPropagation();\n          useBattleStore.getState().removeCardFromDeck(card.id);\n          audioManager.playSFX('card_play', 0.4);\n          toastManager.info(`${card.name} `, 1500);\n        };\n        \n        //     \n        cardDiv.onmouseenter = () => {\n          cardDiv.style.transform = 'translateY(-2px)';\n          cardImg.style.boxShadow = '0 4px 10px rgba(244, 67, 54, 0.4)';\n          removeBtn.style.opacity = '1';\n        };\n        cardDiv.onmouseleave = () => {\n          cardDiv.style.transform = 'translateY(0)';\n          cardImg.style.boxShadow = '0 2px 6px rgba(0,0,0,0.3)';\n          removeBtn.style.opacity = '0';\n        };\n        \n        //   ()\n        let longPressTimer: number | null = null;\n        let touchStartTime = 0;\n        let touchStartX = 0;\n        let touchStartY = 0;\n        let touchMoved = false;\n        \n        cardDiv.ontouchstart = (e) => {\n          touchStartTime = Date.now();\n          if (e.touches && e.touches.length > 0) {\n            touchStartX = e.touches[0].clientX;\n            touchStartY = e.touches[0].clientY;\n          }\n          longPressTimer = window.setTimeout(() => {\n            // :   \n            showCardPreview(card);\n            longPressTimer = null;\n          }, 500);\n          touchMoved = false;\n        };\n        \n        cardDiv.ontouchmove = (e) => {\n          if (touchMoved) return;\n          if (e.touches && e.touches.length > 0) {\n            const moveX = e.touches[0].clientX;\n            const moveY = e.touches[0].clientY;\n            const deltaX = Math.abs(moveX - touchStartX);\n            const deltaY = Math.abs(moveY - touchStartY);\n            if (deltaX > 8 || deltaY > 8) {\n              touchMoved = true;\n              if (longPressTimer !== null) {\n                clearTimeout(longPressTimer);\n                longPressTimer = null;\n              }\n            }\n          }\n        };\n\n        cardDiv.ontouchend = (e) => {\n          if (longPressTimer !== null) {\n            clearTimeout(longPressTimer);\n            longPressTimer = null;\n            \n            //   X   (  )\n            const pressDuration = Date.now() - touchStartTime;\n            if (!touchMoved && pressDuration < 500) {\n              //  : X  \n              if (removeBtn.style.opacity === '1') {\n                removeBtn.style.opacity = '0';\n              } else {\n                removeBtn.style.opacity = '1';\n              }\n            }\n          }\n          touchMoved = false;\n        };\n        \n        //      ( )\n        cardDiv.ontouchcancel = () => {\n          if (longPressTimer !== null) {\n            clearTimeout(longPressTimer);\n            longPressTimer = null;\n          }\n          touchMoved = false;\n        };\n        \n        // Shift+  :   \n        cardDiv.onclick = (e) => {\n          if (e.shiftKey) {\n            e.preventDefault();\n            showCardPreview(card);\n          }\n        };\n        \n        cardDiv.oncontextmenu = (e) => {\n          e.preventDefault();\n          showCardPreview(card);\n        };\n        \n        cardDiv.appendChild(cardImg);\n        cardDiv.appendChild(removeBtn);\n        deckList.appendChild(cardDiv);\n      });\n    }\n  }\n  // Card Gallery UI\n  function renderCardGallery() {\n    const state = useBattleStore.getState();\n    const allCards = state.allCardsPool;\n    \n    //   \n    const cardsByType = {\n      Attack: allCards.filter(c => c.type === 'Attack'),\n      Defense: allCards.filter(c => c.type === 'Defense'),\n      Heal: allCards.filter(c => c.type === 'Heal'),\n      Special: allCards.filter(c => c.type === 'Special')\n    };\n    \n    //  \n    const rarityColors: Record<string, string> = {\n      Normal: '#9e9e9e',\n      Rare: '#2196f3',\n      Epic: '#9c27b0',\n      Legendary: '#ff9800'\n    };\n    \n    cardGalleryRoot.innerHTML = `\n      <div class=\"header\">\n        <div>\n          <h2> </h2>\n          <div style=\"font-size: 11px; color: #aaa; margin-top: 6px;\">\n             <strong>PC:</strong> Shift+      | <strong>:</strong>   \n          </div>\n          <button id=\"gallery-back-btn\" style=\"background: #2a3f5f; color: #fff; border: 1px solid #3a4f75; padding: 4px 12px; border-radius: 6px; cursor: pointer; margin-top: 8px;\">  </button>\n        </div>\n        <div class=\"gallery-info\">\n          <div style=\"font-size: 14px;\">\n            <strong> :</strong> ${allCards.length}\n          </div>\n        </div>\n      </div>\n      <div class=\"content\">\n        ${Object.entries(cardsByType).map(([type, cards]) => `\n          <div style=\"margin-bottom: 40px;\">\n            <h3 style=\"font-size: 20px; margin-bottom: 16px; color: #4a9eff; border-bottom: 2px solid #4a9eff; padding-bottom: 8px;\">\n              ${type === 'Attack' ? ' ' : type === 'Defense' ? ' ' : type === 'Heal' ? ' ' : ' '}  (${cards.length})\n            </h3>\n            <div class=\"card-grid\" id=\"gallery-grid-${type}\"></div>\n          </div>\n        `).join('')}\n      </div>\n    `;\n    \n    //  \n    const backBtn = document.getElementById('gallery-back-btn')!;\n    backBtn.onclick = () => {\n      cardGalleryRoot.classList.remove('active');\n      renderDeckEditor();\n    };\n    \n    //  \n    cardGalleryRoot.classList.add('active');\n    deckEditorRoot.classList.remove('active');\n    \n    //    \n    Object.entries(cardsByType).forEach(([type, cards]) => {\n      const grid = document.getElementById(`gallery-grid-${type}`)!;\n      \n      //    (Normal -> Rare -> Epic -> Legendary)\n      const rarityOrder = { Normal: 0, Rare: 1, Epic: 2, Legendary: 3 };\n      const sortedCards = [...cards].sort((a, b) => {\n        const aOrder = rarityOrder[a.rarity as keyof typeof rarityOrder] ?? 999;\n        const bOrder = rarityOrder[b.rarity as keyof typeof rarityOrder] ?? 999;\n        if (aOrder !== bOrder) return aOrder - bOrder;\n        return a.cost - b.cost;\n      });\n      \n      sortedCards.forEach(card => {\n        const cardDiv = document.createElement('div');\n        cardDiv.className = 'gallery-card';\n        cardDiv.style.cssText = 'position: relative; cursor: pointer; transition: transform 0.2s;';\n        \n        //  \n        const cardImg = document.createElement('img');\n        const imagePath = getCardImagePath(card);\n        cardImg.src = imagePath;\n        cardImg.alt = card.name;\n        cardImg.style.cssText = 'width: 100%; height: auto; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.3);';\n        cardImg.onerror = () => {\n          cardImg.style.display = 'none';\n          cardDiv.innerHTML += `\n            <div style=\"background: linear-gradient(135deg, #2a3f5f, #1a2f4f); border: 2px solid ${rarityColors[card.rarity] || '#3a4f75'}; border-radius: 8px; padding: 12px; height: 180px; display: flex; flex-direction: column; justify-content: center; align-items: center;\">\n              <div style=\"font-weight: bold; font-size: 14px; margin-bottom: 4px; text-align: center; color: ${rarityColors[card.rarity] || '#fff'};\">${card.name}</div>\n              <div style=\"font-size: 11px; color: #aaa; display: flex; gap: 8px;\">\n                <span> ${card.cost}</span>\n                <span>${card.type}</span>\n              </div>\n            </div>\n          `;\n        };\n        \n        //   \n        const rarityBadge = document.createElement('div');\n        rarityBadge.textContent = card.rarity === 'Normal' ? 'N' : card.rarity === 'Rare' ? 'R' : card.rarity === 'Epic' ? 'E' : 'L';\n        rarityBadge.style.cssText = `position: absolute; top: 8px; left: 8px; background: ${rarityColors[card.rarity] || '#9e9e9e'}; color: #fff; width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: bold; box-shadow: 0 2px 6px rgba(0,0,0,0.4);`;\n        cardDiv.appendChild(rarityBadge);\n        \n        cardDiv.appendChild(cardImg);\n        \n        //  \n        cardDiv.onmouseenter = () => {\n          cardDiv.style.transform = 'translateY(-4px)';\n          cardImg.style.boxShadow = '0 8px 16px rgba(74, 158, 255, 0.4)';\n        };\n        cardDiv.onmouseleave = () => {\n          cardDiv.style.transform = 'translateY(0)';\n          cardImg.style.boxShadow = '0 4px 8px rgba(0,0,0,0.3)';\n        };\n        \n        //   ()\n        let longPressTimer: number | null = null;\n        let touchStartTime = 0;\n        \n        cardDiv.ontouchstart = (e) => {\n          touchStartTime = Date.now();\n          longPressTimer = window.setTimeout(() => {\n            showCardPreview(card);\n            longPressTimer = null;\n          }, 500);\n        };\n        \n        cardDiv.ontouchend = (e) => {\n          if (longPressTimer !== null) {\n            clearTimeout(longPressTimer);\n            longPressTimer = null;\n          }\n        };\n        \n        cardDiv.ontouchcancel = () => {\n          if (longPressTimer !== null) {\n            clearTimeout(longPressTimer);\n            longPressTimer = null;\n          }\n        };\n        \n        //  \n        cardDiv.onclick = (e) => {\n          if (e.shiftKey) {\n            e.preventDefault();\n            showCardPreview(card);\n            return;\n          }\n          //      \n          showCardPreview(card);\n        };\n        \n        // :   \n        cardDiv.oncontextmenu = (e) => {\n          e.preventDefault();\n          showCardPreview(card);\n        };\n        \n        grid.appendChild(cardDiv);\n      });\n    });\n  }\n  \n  // Campaign UI\n  function renderDailyDungeon() {\n    const store = useBattleStore.getState();\n    store.ensureDailyDungeon();\n    const { dailyDungeon, gold, shards } = useBattleStore.getState();\n\n    const todayKey = dailyDungeon.dateKey || new Date().toISOString().slice(0, 10);\n    let nextResetDisplay = ' 00:00 (KST)';\n    try {\n      const baseDate = new Date(`${todayKey}T00:00:00`);\n      if (!Number.isNaN(baseDate.getTime())) {\n        const nextReset = new Date(baseDate.getTime() + 24 * 60 * 60 * 1000);\n        const month = String(nextReset.getMonth() + 1).padStart(2, '0');\n        const day = String(nextReset.getDate()).padStart(2, '0');\n        nextResetDisplay = `${nextReset.getFullYear()}.${month}.${day} 00:00 (KST)`;\n      }\n    } catch (error) {\n      // fallback keeps default string\n    }\n\n    const totalFloors = dailyDungeon.floors.length;\n    const clearedFloors = dailyDungeon.floors.filter(f => f.cleared).length;\n    const allCleared = totalFloors > 0 && clearedFloors === totalFloors;\n\n    const floorsMarkup = dailyDungeon.floors.map((floor, index) => {\n      const prevCleared = index === 0 ? true : dailyDungeon.floors[index - 1].cleared;\n      const isLocked = !prevCleared;\n      const statusText = floor.cleared ? '' : (isLocked ? '' : ' ');\n      const buttonLabel = floor.cleared ? '' : (isLocked ? '' : '');\n      const rewardsMarkup = `\n        <div class=\"stage-rewards\">\n          <span> +${floor.reward.gold}</span>\n          <span> +${floor.reward.shards}</span>\n        </div>\n      `;\n      const modifiers = floor.modifiers.map(mod => `\n        <div class=\"modifier-item\">\n          <strong>${mod.label}</strong>\n          <div>${mod.description}</div>\n        </div>\n      `).join('');\n      return `\n        <div class=\"stage-card ${floor.cleared ? 'cleared' : ''} ${isLocked ? 'locked' : ''}\">\n          <div class=\"stage-header\">\n            <div class=\"stage-number\">Floor ${floor.id}</div>\n            <div class=\"badge\">${statusText}</div>\n          </div>\n          <div class=\"stage-name\">${floor.name}</div>\n          <div class=\"stage-description\">${floor.description}</div>\n          <div class=\"stage-power\">  : ${floor.recommendedPower}</div>\n          <div class=\"modifier-list\">${modifiers}</div>\n          ${rewardsMarkup}\n          <div class=\"stage-actions\">\n            <button id=\"daily-play-${floor.id}\" ${floor.cleared || isLocked ? 'disabled' : ''}>${buttonLabel}</button>\n          </div>\n        </div>\n      `;\n    }).join('');\n\n    dailyRoot.innerHTML = `\n      <div class=\"header\">\n        <div>\n          <h2>  </h2>\n          <div class=\"summary\">\n            <span> : ${todayKey}</span>\n            <span> : ${clearedFloors} / ${totalFloors || 0}</span>\n            <span> ${nextResetDisplay}</span>\n            ${allCleared ? '<span>    !</span>' : ''}\n          </div>\n          <div style=\"margin-top: 10px; display: flex; gap: 8px; flex-wrap: wrap;\">\n            <button id=\"daily-menu-btn\" style=\"background: #2a3f5f; color: #fff; border: 1px solid #3a4f75; padding: 6px 14px; border-radius: 8px; cursor: pointer;\">  </button>\n          </div>\n        </div>\n        <div class=\"currency\">\n          <div class=\"currency-item\"> : ${gold}</div>\n          <div class=\"currency-item\"> : ${shards}</div>\n        </div>\n      </div>\n      <section class=\"chapter-section\">\n        <div class=\"chapter-header\">\n          <h3> </h3>\n          <div class=\"chapter-description\">        .</div>\n          <div class=\"chapter-progress\"> ${clearedFloors} / ${totalFloors || 0}</div>\n        </div>\n        <div class=\"stages-grid\">\n          ${floorsMarkup || '<div style=\"color: #ccc; font-size: 14px;\">    ...</div>'}\n        </div>\n      </section>\n    `;\n\n    const menuBtn = document.getElementById('daily-menu-btn');\n    if (menuBtn) {\n      menuBtn.addEventListener('click', () => {\n        useBattleStore.getState().setGameScreen('menu');\n      });\n    }\n\n    dailyDungeon.floors.forEach((floor, index) => {\n      const prevCleared = index === 0 ? true : dailyDungeon.floors[index - 1].cleared;\n      const button = document.getElementById(`daily-play-${floor.id}`) as HTMLButtonElement | null;\n      if (!button) return;\n      if (floor.cleared || !prevCleared) {\n        button.disabled = true;\n        return;\n      }\n      button.onclick = () => {\n        const storeState = useBattleStore.getState();\n        if (storeState.pendingReward) {\n          toastManager.error('  !', 2000);\n          return;\n        }\n        storeState.enterDailyDungeonFloor(floor.id);\n      };\n    });\n  }\n\n  function renderCampaign() {\n    const state = useBattleStore.getState();\n    const { campaignStages, gold, shards } = state;\n    \n    campaignRoot.innerHTML = `\n      <div class=\"header\">\n        <div>\n          <h2> </h2>\n          <button id=\"campaign-menu-btn\" style=\"background: #2a3f5f; color: #fff; border: 1px solid #3a4f75; padding: 4px 12px; border-radius: 6px; cursor: pointer; margin-top: 8px;\">  </button>\n        </div>\n        <div class=\"currency\">\n          <div class=\"currency-item\"> : ${gold}</div>\n          <div class=\"currency-item\"> : ${shards}</div>\n        </div>\n      </div>\n      <div style=\"text-align: center; padding: 12px; background: rgba(103, 126, 234, 0.1); border-radius: 8px; margin: 0 16px 16px 16px; font-size: 13px; color: #aaa;\">\n         <strong>:</strong>   <strong>/</strong>   | <strong>  </strong>   \n      </div>\n      <div id=\"campaign-chapters\"></div>\n    `;\n    \n    //   \n    const menuBtn = document.getElementById('campaign-menu-btn')!;\n    menuBtn.onclick = () => {\n      useBattleStore.getState().setGameScreen('menu');\n    };\n    \n    //   \n    const chaptersRoot = document.getElementById('campaign-chapters')!;\n    const chapterDefinitions = [\n      { id: 1, title: ' Chapter 1:  ', description: '  ,   ', start: 1, end: 10 },\n      { id: 2, title: ' Chapter 2:  ', description: ' ,   ,  ', start: 11, end: 20 },\n      { id: 3, title: ' Chapter 3:  ', description: '  ,    ', start: 21, end: 30 },\n      { id: 4, title: ' Chapter 4:  ', description: ',  ,  ,  ', start: 31, end: 40 },\n      { id: 5, title: ' Chapter 5:  ', description: '  ,  ,  ', start: 41, end: 50 }\n    ];\n    \n    const stageIndexMap = new Map<number, number>();\n    campaignStages.forEach((stage, index) => {\n      stageIndexMap.set(stage.id, index);\n    });\n    \n    chapterDefinitions.forEach(chapter => {\n      const chapterStages = campaignStages.filter(stage => stage.id >= chapter.start && stage.id <= chapter.end);\n      if (chapterStages.length === 0) return;\n      \n      const clearedCount = chapterStages.filter(stage => stage.cleared).length;\n      const chapterSection = document.createElement('section');\n      chapterSection.className = 'chapter-section';\n      chapterSection.innerHTML = `\n        <div class=\"chapter-header\">\n          <h3>${chapter.title}</h3>\n          <div class=\"chapter-description\">${chapter.description}</div>\n          <div class=\"chapter-progress\"> ${clearedCount} / ${chapterStages.length}</div>\n        </div>\n        <div class=\"stages-grid\" id=\"chapter-grid-${chapter.id}\"></div>\n      `;\n      \n      chaptersRoot.appendChild(chapterSection);\n      const stagesGrid = chapterSection.querySelector(`#chapter-grid-${chapter.id}`) as HTMLElement;\n      const sortedStages = [...chapterStages].sort((a, b) => a.id - b.id);\n      \n      sortedStages.forEach(stage => {\n        const stageIndex = stageIndexMap.get(stage.id) ?? 0;\n        const isLocked = stageIndex > 0 && !campaignStages[stageIndex - 1].cleared;\n        const stageCard = document.createElement('div');\n        stageCard.className = `stage-card ${stage.cleared ? 'cleared' : ''} ${isLocked ? 'locked' : ''}`;\n        \n        const baseReward = stage.cleared ? stage.repeatReward : stage.firstReward;\n        const boostedReward = getBoostedStageReward(baseReward, stage.id, stage.cleared);\n        const rewardText: string[] = [];\n        if (boostedReward.gold > 0) rewardText.push(` ${boostedReward.gold}`);\n        if (boostedReward.shards > 0) rewardText.push(` ${boostedReward.shards}`);\n        \n        if (stage.story?.backgroundImage) {\n          stageCard.style.backgroundImage = `url('${stage.story.backgroundImage}')`;\n          stageCard.style.backgroundSize = 'cover';\n          stageCard.style.backgroundPosition = 'center';\n          stageCard.style.position = 'relative';\n        }\n        \n        stageCard.innerHTML = `\n          ${stage.story?.backgroundImage ? '<div style=\"position: absolute; inset: 0; background: rgba(0, 0, 0, 0.6); border-radius: inherit;\"></div>' : ''}\n          <div style=\"position: relative; z-index: 1;\">\n            <div class=\"stage-header\">\n              <div class=\"stage-number\">Stage ${stage.id}</div>\n              <div style=\"display: flex; gap: 8px; align-items: center;\">\n                ${stage.cleared ? '<div style=\"color: #4CAF50; font-size: 20px;\"></div>' : ''}\n                ${isLocked ? '<div style=\"color: #f44336; font-size: 20px;\"></div>' : ''}\n                ${stage.story && !isLocked ? `\n                  <button class=\"story-btn\" data-stage-id=\"${stage.id}\" style=\"\n                    background: rgba(103, 126, 234, 0.8);\n                    color: white;\n                    border: none;\n                    border-radius: 6px;\n                    padding: 4px 8px;\n                    font-size: 16px;\n                    cursor: pointer;\n                    transition: all 0.2s;\n                    display: flex;\n                    align-items: center;\n                    gap: 4px;\n                    box-shadow: 0 2px 4px rgba(0,0,0,0.3);\n                  \" onmouseover=\"this.style.background='rgba(103, 126, 234, 1)'; this.style.transform='scale(1.05)'\" onmouseout=\"this.style.background='rgba(103, 126, 234, 0.8)'; this.style.transform='scale(1)'\">\n                    <span style=\"font-size: 12px;\"></span>\n                  </button>\n                ` : ''}\n              </div>\n            </div>\n            <div class=\"stage-name\">${stage.name}</div>\n            <div class=\"stage-theme\">: ${stage.theme}</div>\n            <div class=\"stage-power\">  : ${stage.recommendedPower}</div>\n            <div class=\"stage-rewards\">: ${rewardText.join(', ')}</div>\n          </div>\n        `;\n        \n        if (!isLocked) {\n          const storyBtn = stageCard.querySelector('.story-btn');\n          if (storyBtn && stage.story) {\n            storyBtn.addEventListener('click', (e) => {\n              e.stopPropagation();\n              showStoryModal(stage);\n            });\n          }\n          \n          stageCard.onclick = (e) => {\n            if ((e.target as HTMLElement).closest('.story-btn')) {\n              return;\n            }\n            \n            if (victoryDefeatTimer !== null) {\n              window.clearTimeout(victoryDefeatTimer);\n              victoryDefeatTimer = null;\n            }\n            \n            useBattleStore.getState().selectStage(stage.id);\n            gameInitialized = false;\n            \n            if (stage.cutscene?.preBattle) {\n              showCutscene(stage.cutscene.preBattle, stage.story?.backgroundImage || '', () => {\n                useBattleStore.getState().setGameScreen('battle');\n              });\n            } else {\n              useBattleStore.getState().setGameScreen('battle');\n            }\n          };\n        }\n        \n        stagesGrid.appendChild(stageCard);\n      });\n    });\n  }\n  \n  //     \n  function showStoryModal(stage: any) {\n    if (!stage.story) return;\n    \n    //   \n    const existingModal = document.getElementById('story-modal');\n    if (existingModal) {\n      existingModal.remove();\n    }\n    \n    const modal = document.createElement('div');\n    modal.id = 'story-modal';\n    modal.style.cssText = `\n      position: fixed;\n      inset: 0;\n      background: rgba(0, 0, 0, 0.85);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      z-index: 10000;\n      padding: 20px;\n      animation: fadeIn 0.3s;\n    `;\n    \n    const modalContent = document.createElement('div');\n    modalContent.style.cssText = `\n      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);\n      border-radius: 12px;\n      max-width: 600px;\n      width: 100%;\n      max-height: 80vh;\n      overflow-y: auto;\n      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);\n      position: relative;\n      animation: slideUp 0.3s;\n    `;\n    \n    //  \n    const backgroundDiv = document.createElement('div');\n    backgroundDiv.style.cssText = `\n      height: 200px;\n      background-image: url('${stage.story.backgroundImage}');\n      background-size: cover;\n      background-position: center;\n      border-radius: 12px 12px 0 0;\n      position: relative;\n    `;\n    \n    //  \n    const overlay = document.createElement('div');\n    overlay.style.cssText = `\n      position: absolute;\n      inset: 0;\n      background: linear-gradient(to bottom, transparent 0%, rgba(26, 26, 46, 0.9) 100%);\n      border-radius: 12px 12px 0 0;\n    `;\n    backgroundDiv.appendChild(overlay);\n    \n    // \n    const textContent = document.createElement('div');\n    textContent.style.cssText = `\n      padding: 24px;\n      color: white;\n    `;\n    textContent.innerHTML = `\n      <div style=\"display: flex; align-items: center; gap: 8px; margin-bottom: 16px;\">\n        <div style=\"font-size: 14px; color: #888;\">Stage ${stage.id}</div>\n        <div style=\"font-size: 24px; font-weight: bold; color: #fff;\">${stage.name}</div>\n      </div>\n      <div style=\"font-size: 14px; color: #aaa; margin-bottom: 8px;\">\n        : ${stage.theme} |   : ${stage.recommendedPower}\n      </div>\n      <div style=\"height: 1px; background: rgba(255,255,255,0.1); margin: 16px 0;\"></div>\n      <div style=\"font-size: 16px; line-height: 1.8; color: #ddd; white-space: pre-wrap;\">\n        ${stage.story.description}\n      </div>\n      <button id=\"story-modal-start\" style=\"\n        width: 100%;\n        padding: 12px;\n        margin-top: 24px;\n        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n        color: white;\n        border: none;\n        border-radius: 8px;\n        font-size: 16px;\n        font-weight: bold;\n        cursor: pointer;\n        transition: transform 0.2s;\n      \">\n         \n      </button>\n      <button id=\"story-modal-close\" style=\"\n        width: 100%;\n        padding: 12px;\n        margin-top: 8px;\n        background: rgba(255,255,255,0.1);\n        color: white;\n        border: none;\n        border-radius: 8px;\n        font-size: 14px;\n        cursor: pointer;\n        transition: background 0.2s;\n      \">\n        \n      </button>\n    `;\n    \n    modalContent.appendChild(backgroundDiv);\n    modalContent.appendChild(textContent);\n    modal.appendChild(modalContent);\n    document.body.appendChild(modal);\n    \n    //  \n    const startBtn = document.getElementById('story-modal-start')!;\n    startBtn.onclick = () => {\n      modal.remove();\n      //   \n      if (victoryDefeatTimer !== null) {\n        window.clearTimeout(victoryDefeatTimer);\n        victoryDefeatTimer = null;\n      }\n      \n      useBattleStore.getState().selectStage(stage.id);\n      gameInitialized = false;\n      \n      //     \n      if (stage.cutscene?.preBattle) {\n        showCutscene(stage.cutscene.preBattle, stage.story?.backgroundImage || '', () => {\n          useBattleStore.getState().setGameScreen('battle');\n        });\n      } else {\n        useBattleStore.getState().setGameScreen('battle');\n      }\n    };\n    \n    const closeBtn = document.getElementById('story-modal-close')!;\n    closeBtn.onclick = () => modal.remove();\n    \n    //   \n    modal.onclick = (e) => {\n      if (e.target === modal) {\n        modal.remove();\n      }\n    };\n    \n    // ESC  \n    const escHandler = (e: KeyboardEvent) => {\n      if (e.key === 'Escape') {\n        modal.remove();\n        document.removeEventListener('keydown', escHandler);\n      }\n    };\n    document.addEventListener('keydown', escHandler);\n  }\n  \n  // Reward UI\n  function renderReward() {\n    const state = useBattleStore.getState();\n    const reward = state.pendingReward;\n    \n    if (!reward) {\n      rewardRoot.classList.remove('active');\n      return;\n    }\n    \n    rewardRoot.classList.add('active');\n  const { stage, subtitle } = resolveStageContext(state);\n  const title = stage ? ` ${stage.id} ` : state.battleContext.type === 'daily' ? '  ' : ' ';\n  const description = stage?.story?.description ?? (state.battleContext.type === 'pvp'\n    ? '    .'\n    : '    .');\n  const itemsHtml = `\n    ${reward.gold > 0 ? `\n      <div class=\"reward-item\">\n        <div class=\"reward-icon gold\"></div>\n        <div class=\"reward-amount\">+${reward.gold}</div>\n        <div class=\"reward-label\"></div>\n      </div>\n    ` : ''}\n    ${reward.shards > 0 ? `\n      <div class=\"reward-item\">\n        <div class=\"reward-icon shard\"></div>\n        <div class=\"reward-amount\">+${reward.shards}</div>\n        <div class=\"reward-label\"> </div>\n      </div>\n    ` : ''}\n  `;\n  const hasItems = reward.gold > 0 || reward.shards > 0;\n  \n    rewardRoot.innerHTML = `\n      <div class=\"reward-background\"></div>\n      <div class=\"reward-panel\">\n        <div class=\"reward-header\">\n          <span class=\"reward-badge\">${escapeHtml(title)}</span>\n          <h2 class=\"reward-title\"> </h2>\n          <p class=\"reward-subtitle\">${escapeHtml(description)}</p>\n        </div>\n        <div class=\"reward-body ${hasItems ? '' : 'reward-body--empty'}\">\n          ${hasItems ? `<div class=\"reward-items\">${itemsHtml}</div>` : `\n            <div class=\"reward-empty\">\n              <div class=\"reward-empty-icon\"></div>\n              <div class=\"reward-empty-text\">  .</div>\n            </div>\n          `}\n        </div>\n        <button id=\"claim-reward-btn\" class=\"reward-btn\"></button>\n      </div>\n    `;\n    \n    //   \n    const claimBtn = document.getElementById('claim-reward-btn')!;\n    claimBtn.onclick = () => {\n      const store = useBattleStore.getState();\n      const target = store.postBattleScreen;\n      store.claimReward();\n\n      if (target === 'campaign') {\n        const currentStageId = store.currentStage;\n        if (currentStageId) {\n          const stage = store.campaignStages.find(s => s.id === currentStageId);\n          if (stage?.cutscene?.postVictory) {\n            showCutscene(stage.cutscene.postVictory, stage.story?.backgroundImage || '', () => {\n              useBattleStore.getState().navigateAfterReward();\n            });\n            return;\n          }\n        }\n      }\n\n      store.navigateAfterReward();\n    };\n  }\n  \n  //  Tutorial UI\n  let currentTutorialStep = 0;\n  let tutorialSteps: {icon: string, title: string, text: string, highlight?: string}[] = [];\n  \n  function showTutorial(steps: typeof tutorialSteps, onComplete: () => void) {\n    currentTutorialStep = 0;\n    tutorialSteps = steps;\n    \n    tutorialOverlay.classList.add('active');\n    renderTutorial();\n    \n    //    \n    (tutorialOverlay as any).onComplete = onComplete;\n  }\n  \n  function renderTutorial() {\n    if (currentTutorialStep >= tutorialSteps.length) {\n      //  \n      tutorialOverlay.classList.remove('active');\n      const onComplete = (tutorialOverlay as any).onComplete;\n      if (onComplete) {\n        onComplete();\n        (tutorialOverlay as any).onComplete = null;\n      }\n      return;\n    }\n    \n    const step = tutorialSteps[currentTutorialStep];\n    const totalSteps = tutorialSteps.length;\n    \n    tutorialOverlay.innerHTML = `\n      <div class=\"tutorial-content\">\n        <div class=\"tutorial-icon\">${step.icon}</div>\n        <div class=\"tutorial-title\">${step.title}</div>\n        <div class=\"tutorial-text\">${step.text}</div>\n        ${step.highlight ? `\n          <div class=\"tutorial-highlight\">${step.highlight}</div>\n        ` : ''}\n        <div class=\"tutorial-buttons\">\n          ${currentTutorialStep < totalSteps - 1 ? `\n            <button class=\"tutorial-btn\" id=\"tutorial-next\"> </button>\n          ` : `\n            <button class=\"tutorial-btn\" id=\"tutorial-complete\"> </button>\n          `}\n          ${currentTutorialStep > 0 ? `\n            <button class=\"tutorial-btn secondary\" id=\"tutorial-skip\"></button>\n          ` : ''}\n        </div>\n      </div>\n    `;\n    \n    //  \n    const nextBtn = document.getElementById('tutorial-next');\n    const completeBtn = document.getElementById('tutorial-complete');\n    const skipBtn = document.getElementById('tutorial-skip');\n    \n    const nextTutorial = () => {\n      currentTutorialStep++;\n      renderTutorial();\n    };\n    \n    const skipTutorial = () => {\n      currentTutorialStep = tutorialSteps.length;\n      renderTutorial();\n    };\n    \n    if (nextBtn) {\n      nextBtn.onclick = nextTutorial;\n    }\n    \n    if (completeBtn) {\n      completeBtn.onclick = skipTutorial;\n    }\n    \n    if (skipBtn) {\n      skipBtn.onclick = skipTutorial;\n    }\n    \n    //  \n    const keyHandler = (e: KeyboardEvent) => {\n      if (e.key === ' ' || e.key === 'Enter') {\n        e.preventDefault();\n        if (currentTutorialStep < totalSteps - 1) {\n          nextTutorial();\n        } else {\n          skipTutorial();\n        }\n      } else if (e.key === 'Escape') {\n        e.preventDefault();\n        skipTutorial();\n      }\n    };\n    \n    document.removeEventListener('keydown', keyHandler);\n    document.addEventListener('keydown', keyHandler);\n  }\n  \n  //  Cutscene UI\n  const cutsceneRoot = document.getElementById('cutscene')!;\n  const screenTransitionOverlay = document.getElementById('screen-transition-overlay')!;\n  let currentDialogueIndex = 0;\n  let currentDialogueLines: any[] = [];\n  let cutsceneCallback: (() => void) | null = null;\n  \n  function showCutscene(dialogues: any[], backgroundImage: string, onComplete: () => void) {\n    currentDialogueIndex = 0;\n    currentDialogueLines = dialogues;\n    cutsceneCallback = onComplete;\n    \n    useBattleStore.getState().setGameScreen('cutscene');\n    renderCutscene(backgroundImage);\n  }\n  function renderCutscene(backgroundImage: string) {\n    if (currentDialogueIndex >= currentDialogueLines.length) {\n      //  \n      cutsceneRoot.classList.remove('active');\n      if (cutsceneCallback) {\n        cutsceneCallback();\n        cutsceneCallback = null;\n      }\n      return;\n    }\n    \n    const dialogue = currentDialogueLines[currentDialogueIndex];\n    const totalLines = currentDialogueLines.length;\n    \n    cutsceneRoot.innerHTML = `\n      <div class=\"cutscene-background\" style=\"background-image: url('${backgroundImage}');\"></div>\n      <div class=\"cutscene-content\">\n        <div class=\"cutscene-top\">\n          ${dialogue.characterImage ? `\n            <img \n              class=\"character-portrait visible ${dialogue.emotion ? `emotion-${dialogue.emotion}` : ''}\" \n              src=\"${dialogue.characterImage}.png\" \n              alt=\"${dialogue.speaker}\"\n            >\n          ` : ''}\n        </div>\n        <div class=\"dialogue-box\">\n          <div class=\"dialogue-speaker\">${dialogue.speaker}</div>\n          <div class=\"dialogue-text\">${dialogue.text}</div>\n          <div class=\"dialogue-controls\">\n            <div class=\"dialogue-progress\">${currentDialogueIndex + 1} / ${totalLines}</div>\n            <div class=\"dialogue-buttons\">\n              ${currentDialogueIndex < totalLines - 1 ? `\n                <button class=\"dialogue-btn\" id=\"dialogue-next\"> </button>\n              ` : `\n                <button class=\"dialogue-btn\" id=\"dialogue-complete\"> </button>\n              `}\n              ${currentDialogueIndex > 0 ? `\n                <button class=\"dialogue-btn secondary\" id=\"dialogue-skip\"></button>\n              ` : ''}\n            </div>\n          </div>\n        </div>\n        <div class=\"skip-hint\">Space  Enter:  | ESC: </div>\n      </div>\n    `;\n    \n    //  \n    const nextBtn = document.getElementById('dialogue-next');\n    const completeBtn = document.getElementById('dialogue-complete');\n    const skipBtn = document.getElementById('dialogue-skip');\n    \n    const nextDialogue = () => {\n      currentDialogueIndex++;\n      renderCutscene(backgroundImage);\n    };\n    \n    const skipCutscene = () => {\n      currentDialogueIndex = currentDialogueLines.length;\n      renderCutscene(backgroundImage);\n    };\n    \n    if (nextBtn) {\n      nextBtn.onclick = nextDialogue;\n    }\n    \n    if (completeBtn) {\n      completeBtn.onclick = skipCutscene;\n    }\n    \n    if (skipBtn) {\n      skipBtn.onclick = skipCutscene;\n    }\n    \n    //  \n    const keyHandler = (e: KeyboardEvent) => {\n      if (e.key === ' ' || e.key === 'Enter') {\n        e.preventDefault();\n        if (currentDialogueIndex < totalLines - 1) {\n          nextDialogue();\n        } else {\n          skipCutscene();\n        }\n      } else if (e.key === 'Escape') {\n        e.preventDefault();\n        skipCutscene();\n      }\n    };\n    \n    document.removeEventListener('keydown', keyHandler);\n    document.addEventListener('keydown', keyHandler);\n  }\n  \n  // Victory/Defeat Screen\n  function resolveStageContext(state: ReturnType<typeof useBattleStore.getState>) {\n    const context = state.battleContext;\n    let stageId: number | null = null;\n    if (context.type === 'campaign') {\n      stageId = context.campaignStageId ?? state.currentStage ?? null;\n    } else if (context.type === 'daily') {\n      stageId = context.campaignStageId ?? state.currentStage ?? null;\n    }\n    const stage = stageId ? state.campaignStages.find(s => s.id === stageId) ?? null : null;\n    let subtitle = ' ';\n    if (stage) {\n      subtitle = ` ${stage.id}. ${stage.name}`;\n    } else if (context.type === 'daily') {\n      subtitle = '  ';\n    } else if (context.type === 'pvp') {\n      subtitle = 'PvP  ';\n    }\n    return { stage, subtitle };\n  }\n\n  function buildVictoryDialogue(state: ReturnType<typeof useBattleStore.getState>): OutcomeDialogue {\n    const { stage, subtitle } = resolveStageContext(state);\n    const authState = useAuthStore.getState();\n    const portrait = stage?.characterImage ?? resolveDeckPortrait(state.playerDeck, DEFAULT_PLAYER_PORTRAIT);\n    const speaker = getDisplayNameFromPortrait(portrait, authState.profileNickname || '');\n    const stageLines = stage ? STAGE_VICTORY_LINES[stage.id] : undefined;\n    let message: string;\n\n    if (stageLines && stageLines.length > 0) {\n      message = pickRandom(stageLines, stageLines[0]);\n    } else if (stage) {\n      message = `${stage.name}     .`;\n    } else {\n      message = pickRandom(GENERIC_VICTORY_LINES, GENERIC_VICTORY_LINES[0]);\n    }\n\n    if (state.battleContext.type === 'pvp') {\n      message = ' .    .';\n    }\n\n    return {\n      portrait,\n      speaker,\n      message,\n      subtitle,\n      accent: '#4caf90',\n    };\n  }\n\n  function buildDefeatDialogue(state: ReturnType<typeof useBattleStore.getState>): OutcomeDialogue {\n    const { stage, subtitle } = resolveStageContext(state);\n    let portrait = stage?.enemyImage ?? resolveDeckPortrait(state.enemyDeck, DEFAULT_ENEMY_PORTRAIT);\n    let speaker = getDisplayNameFromPortrait(portrait, state.pvpMatch?.opponentName || '');\n    const stageLines = stage ? STAGE_DEFEAT_TAUNTS[stage.id] : undefined;\n    let message: string;\n\n    if (stageLines && stageLines.length > 0) {\n      message = pickRandom(stageLines, stageLines[0]);\n    } else if (stage) {\n      message = `${stage.name}   .      .`;\n    } else {\n      message = pickRandom(GENERIC_DEFEAT_TAUNTS, GENERIC_DEFEAT_TAUNTS[0]);\n    }\n\n    if (state.battleContext.type === 'pvp') {\n      const opponent = state.pvpMatch?.opponentName?.trim();\n      portrait = resolveDeckPortrait(state.pvpMatch?.opponentDeckCards ?? [], DEFAULT_ENEMY_PORTRAIT);\n      speaker = opponent && opponent.length > 0 ? opponent : '';\n      message = '   .       .';\n    }\n\n    return {\n      portrait,\n      speaker,\n      message,\n      subtitle,\n      accent: '#f15b5b',\n    };\n  }\n\n  function showVictoryScreen() {\n    const state = useBattleStore.getState();\n    console.log(`[ShowVictoryScreen]  Called - gameOver: ${state.gameOver}, playerHp: ${state.playerHp}, enemyHp: ${state.enemyHp}`);\n    \n    const randomVariation = Math.floor(Math.random() * 3) + 1;\n    const backgroundPath = getSpecialBackground('victory', randomVariation);\n    const hasReward = state.pendingReward !== null;\n    const dialogue = buildVictoryDialogue(state);\n    \n    victoryScreen.innerHTML = `\n      <div class=\"result-background\" style=\"background-image: url('${backgroundPath}');\"></div>\n      <div class=\"result-overlay\">\n        <div class=\"result-card result-card--victory\" style=\"--result-accent: ${dialogue.accent};\">\n          <div class=\"result-portrait\" style=\"background-image: url('${dialogue.portrait}');\"></div>\n          <div class=\"result-content\">\n            <div class=\"result-title\"> !</div>\n            <div class=\"result-subtitle\">${escapeHtml(dialogue.subtitle)}</div>\n            <div class=\"result-speaker\">${escapeHtml(dialogue.speaker)}</div>\n            <div class=\"result-message\">\"${escapeHtml(dialogue.message)}\"</div>\n            <button class=\"result-btn\" id=\"victory-continue-btn\">${hasReward ? ' ' : ' '}</button>\n          </div>\n        </div>\n      </div>\n    `;\n    \n    victoryScreen.classList.add('active');\n    \n    const continueBtn = document.getElementById('victory-continue-btn')!;\n    continueBtn.onclick = () => {\n      victoryScreen.classList.remove('active');\n      if (victoryDefeatTimer !== null) {\n        window.clearTimeout(victoryDefeatTimer);\n        victoryDefeatTimer = null;\n      }\n      if (hasReward) {\n        useBattleStore.getState().setGameScreen('reward');\n      } else {\n        useBattleStore.getState().setGameScreen('menu');\n      }\n    };\n  }\n  \n  function showDefeatScreen() {\n    const state = useBattleStore.getState();\n    console.log(`[ShowDefeatScreen]  Called - gameOver: ${state.gameOver}, playerHp: ${state.playerHp}, enemyHp: ${state.enemyHp}`);\n    \n    const randomVariation = Math.floor(Math.random() * 3) + 1;\n    const backgroundPath = getSpecialBackground('defeat', randomVariation);\n    const dialogue = buildDefeatDialogue(state);\n    \n    defeatScreen.innerHTML = `\n      <div class=\"result-background\" style=\"background-image: url('${backgroundPath}');\"></div>\n      <div class=\"result-overlay\">\n        <div class=\"result-card result-card--defeat\" style=\"--result-accent: ${dialogue.accent};\">\n          <div class=\"result-portrait\" style=\"background-image: url('${dialogue.portrait}');\"></div>\n          <div class=\"result-content\">\n            <div class=\"result-title\"> </div>\n            <div class=\"result-subtitle\">${escapeHtml(dialogue.subtitle)}</div>\n            <div class=\"result-speaker\">${escapeHtml(dialogue.speaker)}</div>\n            <div class=\"result-message\">\"${escapeHtml(dialogue.message)}\"</div>\n            <button class=\"result-btn\" id=\"defeat-retry-btn\"> </button>\n          </div>\n        </div>\n      </div>\n    `;\n    \n    defeatScreen.classList.add('active');\n    \n    const retryBtn = document.getElementById('defeat-retry-btn')!;\n    retryBtn.onclick = () => {\n      defeatScreen.classList.remove('active');\n      if (victoryDefeatTimer !== null) {\n        window.clearTimeout(victoryDefeatTimer);\n        victoryDefeatTimer = null;\n      }\n      gameInitialized = false;\n      useBattleStore.getState().handleBattleDefeatNavigation();\n    };\n  }\n  \n  // Shop UI\n  let gachaResultCard: Card | null = null;\n  let gachaResultModal: HTMLElement | null = null;\n  \n  function renderShop() {\n    const state = useBattleStore.getState();\n    const { gold, shards } = state;\n    console.log('[UI][Shop] Rendering with state', {\n      gold,\n      shards,\n      collection: state.collection.length,\n      deck: state.playerDeck.length,\n    });\n    const cardPacks = state.getCardPacks();\n    const packVisuals: Record<string, { portrait: string; accent: string; border: string; gradient: string }> = {\n      pack_normal: {\n        portrait: 'characters/seraphine_winters.png',\n        accent: 'rgba(148, 163, 184, 0.45)',\n        border: '#9e9e9e',\n        gradient: 'linear-gradient(135deg, rgba(26, 38, 60, 0.92) 0%, rgba(18, 28, 48, 0.96) 100%)'\n      },\n      pack_rare: {\n        portrait: 'characters/elena_drake.png',\n        accent: 'rgba(88, 160, 255, 0.5)',\n        border: '#2196f3',\n        gradient: 'linear-gradient(135deg, rgba(26, 42, 78, 0.92) 0%, rgba(20, 32, 62, 0.96) 100%)'\n      },\n      pack_epic: {\n        portrait: 'characters/lucian_rosegarden.png',\n        accent: 'rgba(180, 120, 255, 0.5)',\n        border: '#9c27b0',\n        gradient: 'linear-gradient(135deg, rgba(32, 26, 68, 0.92) 0%, rgba(24, 20, 54, 0.96) 100%)'\n      },\n      pack_legendary: {\n        portrait: 'characters/seraphina_belmont.png',\n        accent: 'rgba(255, 196, 120, 0.55)',\n        border: '#ff9800',\n        gradient: 'linear-gradient(135deg, rgba(54, 32, 12, 0.9) 0%, rgba(32, 20, 8, 0.94) 100%)'\n      },\n      pack_premium: {\n        portrait: 'characters/ariana_drake.png',\n        accent: 'rgba(255, 140, 200, 0.45)',\n        border: '#f472b6',\n        gradient: 'linear-gradient(135deg, rgba(42, 24, 60, 0.92) 0%, rgba(28, 18, 46, 0.96) 100%)'\n      }\n    };\n    \n    shopRoot.innerHTML = `\n      <div class=\"header\">\n        <div>\n          <h2> </h2>\n          <button id=\"shop-menu-btn\" style=\"background: #2a3f5f; color: #fff; border: 1px solid #3a4f75; padding: 4px 12px; border-radius: 6px; cursor: pointer; margin-top: 8px;\">  </button>\n        </div>\n        <div class=\"currency\">\n          <div class=\"currency-item\"> : ${gold}</div>\n          <div class=\"currency-item\"> : ${shards}</div>\n        </div>\n      </div>\n      <div class=\"shop-packs\" id=\"shop-packs\"></div>\n      <!--    () -->\n      <div id=\"gacha-result-modal\" style=\"display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); z-index: 10000; align-items: center; justify-content: center;\">\n        <div style=\"background: #1a2332; border: 2px solid #4a9eff; border-radius: 12px; padding: 30px; max-width: 400px; text-align: center;\">\n          <h2 style=\"color: #fff; margin-bottom: 20px;\"> !</h2>\n          <div id=\"gacha-result-card\" style=\"margin-bottom: 20px;\"></div>\n          <button id=\"gacha-result-close-old\" style=\"background: #4a9eff; color: #fff; border: none; padding: 10px 30px; border-radius: 6px; cursor: pointer; font-size: 16px;\"></button>\n        </div>\n      </div>\n    `;\n    \n    gachaResultModal = document.getElementById('gacha-result-modal')!;\n    // gacha-animation-container HTML    \n    \n    //   \n    const menuBtn = document.getElementById('shop-menu-btn')!;\n    menuBtn.onclick = () => {\n      useBattleStore.getState().setGameScreen('menu');\n    };\n    \n    //     ( ) -     \n    // closeBtn playGachaAnimation \n    \n    //     ( )\n    const closeBtnOld = document.getElementById('gacha-result-close-old');\n    if (closeBtnOld) {\n      closeBtnOld.onclick = () => {\n        if (gachaResultModal) {\n          gachaResultModal.style.display = 'none';\n        }\n        renderShop();\n      };\n    }\n    \n    //  \n    const packsGrid = document.getElementById('shop-packs')!;\n    cardPacks.forEach(pack => {\n      const packDiv = document.createElement('div');\n      packDiv.className = 'shop-pack';\n      packDiv.dataset.packId = pack.id;\n      packDiv.dataset.packType = pack.type;\n\n      const visuals =\n        packVisuals[pack.id] ??\n        (pack.type === 'legendary'\n          ? packVisuals.pack_legendary\n          : pack.type === 'epic'\n            ? packVisuals.pack_epic\n            : pack.type === 'rare'\n              ? packVisuals.pack_rare\n              : packVisuals.pack_normal);\n\n      packDiv.style.background = visuals.gradient;\n      packDiv.style.borderColor = visuals.border;\n      packDiv.style.setProperty('--pack-portrait', `url('${visuals.portrait}')`);\n      packDiv.style.setProperty('--pack-accent', visuals.accent);\n      \n      const priceIcon = pack.priceType === 'gold' ? '' : '';\n      const currentCurrency = pack.priceType === 'gold' ? gold : shards;\n      const canAfford = currentCurrency >= pack.price;\n\n      const priceClass = ['pack-price'];\n      if (!canAfford) {\n        priceClass.push('disabled');\n      }\n\n      packDiv.innerHTML = `\n        <div class=\"pack-content\">\n          <div class=\"pack-header\">\n            <h3 class=\"pack-name\">${pack.name}</h3>\n            <p class=\"pack-desc\">${pack.description}</p>\n          </div>\n          <div class=\"pack-rates\">\n            <div class=\"pack-rates-title\"> </div>\n            <div class=\"pack-rates-grid\">\n              <span></span><span>${pack.rates.Normal}%</span>\n              <span></span><span>${pack.rates.Rare}%</span>\n              <span></span><span>${pack.rates.Epic}%</span>\n              <span></span><span>${pack.rates.Legendary}%</span>\n            </div>\n          </div>\n          <div class=\"${priceClass.join(' ')}\">${priceIcon} ${pack.price}</div>\n          <button class=\"buy-pack-btn\" data-pack-type=\"${pack.type}\" ${!canAfford ? 'disabled' : ''}>\n             \n          </button>\n        </div>\n      `;\n      \n      const buyBtn = packDiv.querySelector('.buy-pack-btn') as HTMLButtonElement;\n      \n      buyBtn.onclick = async () => {\n        if (!canAfford) {\n          toastManager.error(`${pack.priceType === 'gold' ? '' : ''} !`, 2000);\n          audioManager.playSFX('button_click', 0.3);\n          return;\n        }\n        \n        audioManager.playSFX('button_click', 0.7);\n        const result = state.buyCardPack(pack.type);\n        \n        if (result) {\n          gachaResultCard = result;\n          //   \n          await playGachaAnimation(result);\n          toastManager.success(`${pack.name}() !`, 2000);\n        } else {\n          toastManager.error(' !', 2000);\n        }\n      };\n      \n      packsGrid.appendChild(packDiv);\n    });\n  }\n  \n  async function playGachaAnimation(card: Card) {\n    console.log('[Gacha] Starting animation for card:', card.name);\n    \n    //  \n    const container = document.getElementById('gacha-animation-container');\n    const cardWrapper = document.getElementById('gacha-card-wrapper');\n    const cardBackImg = document.getElementById('gacha-card-back-img') as HTMLImageElement;\n    const cardFrontImg = document.getElementById('gacha-card-front-img') as HTMLImageElement;\n    const resultInfo = document.getElementById('gacha-result-info');\n    const resultName = document.getElementById('gacha-result-name');\n    const resultRarity = document.getElementById('gacha-result-rarity');\n    const closeBtn = document.getElementById('gacha-result-close');\n    \n    if (!container || !cardWrapper || !cardBackImg || !cardFrontImg || !resultInfo || !resultName || !resultRarity || !closeBtn) {\n      console.error('[Gacha] Elements not found!');\n      showGachaResult(card);\n      return;\n    }\n    \n    const rarityColors: Record<string, string> = {\n      Normal: '#9e9e9e',\n      Rare: '#2196f3',\n      Epic: '#9c27b0',\n      Legendary: '#ff9800'\n    };\n    \n    const rarityNames: Record<string, string> = {\n      Normal: '',\n      Rare: '',\n      Epic: '',\n      Legendary: ''\n    };\n    \n    //   \n    container.style.display = 'flex';\n    cardBackImg.style.display = 'block';\n    cardFrontImg.style.display = 'none';\n    resultInfo.style.display = 'none';\n    cardWrapper.style.transform = 'translate(0, 0) rotate(0deg)';\n    cardWrapper.style.transition = 'none';\n    \n    //  \n    const cardBackPath = getCardBackImage();\n    const cardImagePath = getLoadedCardImage(card);\n    \n    // Use relative paths to work under non-root base paths\n    cardBackImg.src = cardBackPath ? cardBackPath : 'cards/card_back.webp';\n    cardFrontImg.src = cardImagePath ? cardImagePath : '';\n    \n    //   \n    await new Promise<void>((resolve) => {\n      let loaded = 0;\n      const check = () => {\n        loaded++;\n        if (loaded >= 2) resolve();\n      };\n      if (cardBackImg.complete) check();\n      else cardBackImg.onload = check;\n      if (cardFrontImg.complete) check();\n      else cardFrontImg.onload = check;\n      setTimeout(() => resolve(), 3000); // \n    });\n    \n    // 1:   \n    await new Promise(resolve => setTimeout(resolve, 300));\n    \n    // 2:  \n    const shakeDuration = 2000;\n    const shakeSteps = 30;\n    for (let i = 0; i < shakeSteps; i++) {\n      const progress = i / shakeSteps;\n      const intensity = progress * progress * 25;\n      const angle = Math.random() * 360;\n      const x = Math.cos(angle * Math.PI / 180) * intensity;\n      const y = Math.sin(angle * Math.PI / 180) * intensity;\n      const rotation = (Math.random() - 0.5) * intensity * 0.6;\n      cardWrapper.style.transform = `translate(${x}px, ${y}px) rotate(${rotation}deg)`;\n      await new Promise(resolve => setTimeout(resolve, shakeDuration / shakeSteps));\n    }\n    \n    //  \n    cardWrapper.style.transition = 'transform 0.3s ease-out';\n    cardWrapper.style.transform = 'translate(0, 0) rotate(0deg)';\n    await new Promise(resolve => setTimeout(resolve, 300));\n    \n    // 3:  \n    cardBackImg.style.display = 'none';\n    cardFrontImg.style.display = 'block';\n    audioManager.playSFX('button_click', 0.8);\n    await new Promise(resolve => setTimeout(resolve, 300));\n    \n    // 4:   \n    resultName.textContent = card.name;\n    resultName.style.color = rarityColors[card.rarity] || '#fff';\n    resultRarity.textContent = rarityNames[card.rarity] || card.rarity;\n    resultRarity.style.color = rarityColors[card.rarity] || '#fff';\n    resultInfo.style.display = 'block';\n    \n    //  \n    if (card.rarity === 'Legendary') {\n      audioManager.playSFX('button_click', 1.0);\n    } else if (card.rarity === 'Epic') {\n      audioManager.playSFX('button_click', 0.9);\n    }\n    \n    //   \n    const handleClose = () => {\n      container.style.display = 'none';\n      setTimeout(() => renderShop(), 100);\n    };\n    \n    closeBtn.onclick = (e) => {\n      e.stopPropagation();\n      handleClose();\n    };\n    \n    container.onclick = (e) => {\n      if (e.target === container) handleClose();\n    };\n    \n    console.log('[Gacha] Animation completed');\n  }\n  \n  function showGachaResult(card: Card) {\n    //    \n    if (!gachaResultModal) return;\n    \n    const rarityColors: Record<string, string> = {\n      Normal: '#9e9e9e',\n      Rare: '#2196f3',\n      Epic: '#9c27b0',\n      Legendary: '#ff9800'\n    };\n    \n    const cardDisplay = document.getElementById('gacha-result-card')!;\n    cardDisplay.innerHTML = `\n      <div style=\"\n        background: linear-gradient(135deg, #1a2332 0%, #2a3f5f 100%);\n        border: 3px solid ${rarityColors[card.rarity] || '#9e9e9e'};\n        border-radius: 12px;\n        padding: 20px;\n        margin: 0 auto;\n        max-width: 300px;\n      \">\n        <div style=\"color: ${rarityColors[card.rarity] || '#9e9e9e'}; font-size: 14px; margin-bottom: 10px; font-weight: bold;\">\n          ${card.rarity}\n        </div>\n        <div style=\"color: #fff; font-size: 24px; font-weight: bold; margin-bottom: 10px;\">\n          ${card.name}\n        </div>\n        <div style=\"color: #aaa; font-size: 14px; margin-bottom: 10px;\">\n          ${card.type}\n        </div>\n        <div style=\"color: #fff; font-size: 12px; line-height: 1.6;\">\n          ${card.effectText || ' '}\n        </div>\n      </div>\n    `;\n    \n    gachaResultModal.style.display = 'flex';\n  }\n  \n  //   \n  type IntroCardPlacement = {\n    asset: string;\n    x: number;\n    y: number;\n    rotation?: number;\n    scale?: number;\n    delay?: number;\n    glow?: 'violet' | 'amber' | 'cyan';\n  };\n\n  type IntroSlide = {\n    text: string;\n    background: string;\n    cards: IntroCardPlacement[];\n  };\n\n  const INTRO_SLIDES: IntroSlide[] = [\n    {\n      text: `   , .<br>      ,        .`,\n      background: 'intro_01.webp',\n      cards: [\n        { asset: 'cards/Seraphina_Attack_Rare.webp', x: 41, y: 47, rotation: -12, scale: 1.05, delay: 60, glow: 'violet' },\n        { asset: 'cards/Seraphina_Special_Epic.webp', x: 57, y: 43, rotation: 6, scale: 1.08, delay: 180, glow: 'amber' },\n        { asset: 'cards/Seraphina_Defense_Rare.webp', x: 50, y: 62, rotation: 2, scale: 0.98, delay: 300, glow: 'cyan' },\n      ],\n    },\n    {\n      text: `...   .<br>   ,   .`,\n      background: 'intro_02.webp',\n      cards: [\n        { asset: 'cards/Marcus_Special_Epic.webp', x: 38, y: 46, rotation: -10, scale: 1.02, delay: 40, glow: 'violet' },\n        { asset: 'cards/Kai_Attack_Epic.webp', x: 54, y: 42, rotation: 8, scale: 1.04, delay: 160, glow: 'cyan' },\n        { asset: 'cards/Leon_Special_Rare.webp', x: 63, y: 58, rotation: 18, scale: 0.96, delay: 260, glow: 'amber' },\n      ],\n    },\n    {\n      text: ` .<br>  ,      .`,\n      background: 'intro_03.webp',\n      cards: [\n        { asset: 'cards/Ariana_Special_Epic.webp', x: 44, y: 44, rotation: -15, scale: 1.05, delay: 60, glow: 'amber' },\n        { asset: 'cards/Iris_Heal_Epic.webp', x: 56, y: 42, rotation: 7, scale: 1.03, delay: 210, glow: 'violet' },\n        { asset: 'cards/Garen_Defense_Rare.webp', x: 52, y: 60, rotation: 4, scale: 0.97, delay: 320, glow: 'cyan' },\n      ],\n    },\n    {\n      text: `   ,<br>      .`,\n      background: 'intro_04.webp',\n      cards: [\n        { asset: 'cards/Lucian_Special_Epic.webp', x: 40, y: 47, rotation: -10, scale: 1.06, delay: 40, glow: 'cyan' },\n        { asset: 'cards/Seraphina_Attack_Rare.webp', x: 58, y: 44, rotation: 9, scale: 1.04, delay: 180, glow: 'violet' },\n        { asset: 'cards/Darius_Attack_Epic.webp', x: 51, y: 61, rotation: 6, scale: 0.98, delay: 280, glow: 'amber' },\n      ],\n    },\n  ];\n\n  const INTRO_TYPE_BY_CODE: Record<string, Card['type']> = {\n    ATT: 'Attack',\n    DEF: 'Defense',\n    HEA: 'Heal',\n    SPE: 'Special',\n  };\n\n  const INTRO_RARITY_BY_CODE: Record<string, Card['rarity']> = {\n    NO: 'Normal',\n    RA: 'Rare',\n    EP: 'Epic',\n    LE: 'Legendary',\n  };\n\n  const INTRO_FINALE_CARD_INTERVAL = 60;\n  const INTRO_FINALE_STACK_BUFFER = 720;\n  const INTRO_FINALE_FLASH_HOLD = 760;\n\n  let introSlidesData: IntroSlide[] = [];\n  let currentIntroPage = 0;\n  let introTimeouts: number[] = [];\n  let introFinalePlaying = false;\n  let introTitleShowing = false;\n\n  function clearIntroTimers() {\n    introTimeouts.forEach((timer) => clearTimeout(timer));\n    introTimeouts = [];\n  }\n\n  function scheduleIntroTimer(callback: () => void, delay: number) {\n    const timer = window.setTimeout(() => {\n      introTimeouts = introTimeouts.filter((t) => t !== timer);\n      callback();\n    }, delay);\n    introTimeouts.push(timer);\n    return timer;\n  }\n\n  function renderIntroCards(slide?: IntroSlide) {\n    const layer = document.getElementById('intro-card-layer');\n    if (!layer || !slide) return;\n    layer.innerHTML = '';\n\n    slide.cards.forEach((card, index) => {\n      const cardEl = document.createElement('div');\n      cardEl.className = 'intro-card';\n      if (card.glow) {\n        cardEl.classList.add(`glow-${card.glow}`);\n      }\n      cardEl.style.left = `${card.x}%`;\n      cardEl.style.top = `${card.y}%`;\n      cardEl.style.backgroundImage = `url('${card.asset}')`;\n      cardEl.style.setProperty('--card-rotation', `${card.rotation ?? 0}deg`);\n      cardEl.style.setProperty('--card-scale', `${card.scale ?? 1}`);\n      const delay = card.delay ?? index * 120;\n      cardEl.style.setProperty('--card-delay', `${delay}ms`);\n      cardEl.style.setProperty('--float-delay', `${(delay / 1000 + 0.4).toFixed(2)}s`);\n      layer.appendChild(cardEl);\n\n      requestAnimationFrame(() => {\n        requestAnimationFrame(() => cardEl.classList.add('show'));\n      });\n    });\n  }\n\n  function resolveCardAssetFromId(cardId: string): string | null {\n    const parts = cardId.split('_');\n    if (parts.length < 3) {\n      return null;\n    }\n    const type = INTRO_TYPE_BY_CODE[parts[0]];\n    const rarity = INTRO_RARITY_BY_CODE[parts[2]];\n    if (!type || !rarity) {\n      return null;\n    }\n    const partial: Partial<Card> = {\n      id: cardId,\n      type,\n      rarity,\n    };\n    return getCardImagePath(partial) || getCardImagePathFallback(partial);\n  }\n\n  function shuffleArray<T>(array: readonly T[]): T[] {\n    const copy = [...array];\n    for (let i = copy.length - 1; i > 0; i--) {\n      const j = Math.floor(Math.random() * (i + 1));\n      [copy[i], copy[j]] = [copy[j], copy[i]];\n    }\n    return copy;\n  }\n\n  function updateMenuUserInfo() {\n    if (!menuUserInfoRoot || !menuUserNicknameEl || !menuUserStageEl || !menuUserRankEl) {\n      return;\n    }\n\n    const authState = useAuthStore.getState();\n    const battleState = useBattleStore.getState();\n\n    const nickname = authState.profileNickname?.trim() ? authState.profileNickname : '';\n    menuUserNicknameEl.textContent = nickname;\n\n    const stageListCount = battleState.campaignStages?.length ?? 0;\n    const totalStages = stageListCount > 0\n      ? Math.max(stageListCount, STORY_TOTAL_STAGE_TARGET)\n      : STORY_TOTAL_STAGE_TARGET;\n    const clearedByFlag = stageListCount > 0\n      ? battleState.campaignStages.filter(stage => stage.cleared).length\n      : 0;\n    const clearedByIds = battleState.completedStageIds?.length ?? 0;\n    const clearedStages = stageListCount > 0 ? Math.max(clearedByFlag, clearedByIds) : clearedByIds;\n\n    if (totalStages > 0) {\n      menuUserStageEl.textContent = `   ${Math.min(clearedStages, totalStages)}/${totalStages} `;\n    } else {\n      menuUserStageEl.textContent = '    ';\n    }\n\n    const wins = battleState.pvpWins ?? 0;\n    const rankInfo = getPvpRankInfo(wins);\n    const remaining =\n      rankInfo.nextMinWins !== null ? Math.max(0, rankInfo.nextMinWins - wins) : null;\n    let rankText = `${rankInfo.name}  ${wins}`;\n    rankText += remaining !== null ? `   ${remaining}` : '   ';\n    menuUserRankEl.textContent = rankText;\n    menuUserRankEl.style.color = rankInfo.color;\n  }\n\n  updateMenuUserInfo();\n  useBattleStore.subscribe(() => {\n    updateMenuUserInfo();\n  });\n  useAuthStore.subscribe(() => {\n    updateMenuUserInfo();\n  });\n\n  function getAssetPathForCard(card: Card): string | null {\n    const primary = getCardImagePath(card);\n    if (primary) {\n      return primary;\n    }\n    const fallback = getCardImagePathFallback(card);\n    return fallback || null;\n  }\nfunction buildFinaleCardAssets(): string[] {\n  if (!allCards || allCards.length === 0) {\n    return STARTER_COLLECTION_CARD_IDS_SAFE\n      .map(resolveCardAssetFromId)\n      .filter((src): src is string => !!src);\n  }\n\n  const rarityBuckets: Record<Card['rarity'], string[]> = {\n    Legendary: [],\n    Epic: [],\n    Rare: [],\n    Normal: [],\n  };\n\n  allCards.forEach(card => {\n    const asset = getAssetPathForCard(card);\n    if (!asset) return;\n    rarityBuckets[card.rarity].push(asset);\n  });\n\n  const selected: string[] = [];\n  const used = new Set<string>();\n\n  const takeFromBucket = (rarity: Card['rarity'], count: number) => {\n    const bucket = rarityBuckets[rarity];\n    if (bucket.length === 0 || count <= 0) return;\n    const shuffled = shuffleArray(bucket);\n    for (let i = 0; i < shuffled.length && selected.length < count; i++) {\n      const asset = shuffled[i];\n      if (used.has(asset)) continue;\n      used.add(asset);\n      selected.push(asset);\n    }\n  };\n\n  takeFromBucket('Legendary', 9);\n  takeFromBucket('Epic', 8);\n  takeFromBucket('Rare', 6);\n  takeFromBucket('Normal', 5);\n\n  const allAssets = shuffleArray([\n    ...rarityBuckets.Legendary,\n    ...rarityBuckets.Epic,\n    ...rarityBuckets.Rare,\n    ...rarityBuckets.Normal,\n  ]);\n\n  let index = 0;\n  while (selected.length < 28 && index < allAssets.length) {\n    const asset = allAssets[index++];\n    if (used.has(asset)) continue;\n    used.add(asset);\n    selected.push(asset);\n  }\n\n  return selected;\n}\n\n  function playIntroFinale() {\n    if (introFinalePlaying) return;\n    introFinalePlaying = true;\n    clearIntroTimers();\n    introRoot.classList.add('finale-mode');\n    introRoot.innerHTML = `\n      <div id=\"intro-finale-layer\"></div>\n      <div id=\"intro-flash\"></div>\n    `;\n\n    const layer = document.getElementById('intro-finale-layer');\n    if (!layer) {\n      showIntroTitle();\n      return;\n    }\n\n    const cardAssets = shuffleArray(buildFinaleCardAssets());\n\n    const totalCards = Math.min(cardAssets.length, 28);\n\n    cardAssets.slice(0, totalCards).forEach((src, index) => {\n      const cardImg = document.createElement('img');\n      cardImg.className = 'intro-stack-card';\n      cardImg.src = src;\n      cardImg.alt = '';\n\n      const rotation = (Math.random() * 44) - 22;\n      const offsetX = (Math.random() * 520) - 260;\n      const offsetY = (Math.random() * 260) - 130;\n      const scale = 0.72 + Math.random() * 0.28;\n      const delay = index * INTRO_FINALE_CARD_INTERVAL;\n\n      cardImg.style.setProperty('--stack-rotation', `${rotation}deg`);\n      cardImg.style.setProperty('--stack-offset-x', `${offsetX}px`);\n      cardImg.style.setProperty('--stack-offset-y', `${offsetY}px`);\n      cardImg.style.setProperty('--stack-scale', `${scale}`);\n      cardImg.style.setProperty('--stack-delay', `${delay}ms`);\n      cardImg.style.setProperty('--stack-z', `${index + 10}`);\n\n      layer.appendChild(cardImg);\n\n      scheduleIntroTimer(() => {\n        cardImg.classList.add('show');\n        audioManager.playSFX('card_play', 0.25);\n      }, delay);\n    });\n\n    const totalDuration = totalCards * INTRO_FINALE_CARD_INTERVAL + INTRO_FINALE_STACK_BUFFER;\n    scheduleIntroTimer(() => {\n      const flash = document.getElementById('intro-flash');\n      audioManager.playSFX('card_play', 0.8);\n      if (flash) {\n        flash.classList.add('active');\n      }\n      scheduleIntroTimer(() => {\n        introRoot.classList.remove('finale-mode');\n        showIntroTitle();\n        scheduleIntroTimer(() => {\n          if (flash) {\n            flash.classList.remove('active');\n          }\n        }, INTRO_FINALE_FLASH_HOLD);\n      }, INTRO_FINALE_FLASH_HOLD);\n    }, totalDuration);\n  }\n\n  function renderIntro() {\n    setAuthOverlayEnabled(false);\n    clearIntroTimers();\n    introSlidesData = INTRO_SLIDES;\n    currentIntroPage = 0;\n    introFinalePlaying = false;\n  introTitleShowing = false;\n    introRoot.classList.remove('title-mode');\n    introRoot.classList.remove('finale-mode');\n    introRoot.classList.add('active');\n    showNextIntroPage();\n    \n    //  \n    introRoot.onclick = () => {\n      if (introTitleShowing) {\n        return;\n      }\n      if (introFinalePlaying) {\n        clearIntroTimers();\n        showIntroTitle();\n        return;\n      }\n      if (currentIntroPage < introSlidesData.length) {\n        showNextIntroPage();\n      } else {\n        playIntroFinale();\n      }\n    };\n  }\n  \n  function showNextIntroPage() {\n    if (introFinalePlaying) {\n      return;\n    }\n    if (currentIntroPage >= introSlidesData.length) {\n      playIntroFinale();\n      return;\n    }\n\n    clearIntroTimers();\n    const pageIndex = currentIntroPage;\n    const slide = introSlidesData[pageIndex];\n    currentIntroPage++;\n    introRoot.classList.remove('title-mode');\n\n    if (!slide) {\n      playIntroFinale();\n      return;\n    }\n\n    //   \n    introRoot.style.backgroundImage = `url('backgrounds/${slide.background}')`;\n    introRoot.style.backgroundSize = 'cover';\n    introRoot.style.backgroundPosition = 'center';\n    introRoot.style.backgroundRepeat = 'no-repeat';\n    \n    //    \n    introRoot.innerHTML = `\n      <div id=\"intro-card-layer\"></div>\n      <div id=\"intro-page\" class=\"active\">\n        <p id=\"intro-text\"></p>\n      </div>\n    `;\n    \n    renderIntroCards(slide);\n    audioManager.playSFX('card_draw', 0.5);\n\n    //    \n    const textElement = document.getElementById('intro-text');\n    if (textElement) {\n      textElement.innerHTML = '';\n    }\n    typeWriterEffect(slide.text, (completeText: string) => {\n      const textElement = document.getElementById('intro-text');\n      if (textElement) {\n        textElement.innerHTML = completeText;\n      }\n      \n      //    \n      scheduleIntroTimer(() => {\n        if (!introFinalePlaying && currentIntroPage <= introSlidesData.length) {\n          showNextIntroPage();\n        }\n      }, 1800); //    1.8 \n    });\n  }\n  \n  function typeWriterEffect(text: string, onComplete: (text: string) => void, speed: number = 30, elementId: string = 'intro-text') {\n    const textElement = document.getElementById(elementId);\n    if (!textElement) return;\n\n    clearIntroTimers();\n    \n    // <br>     \n    const parts: string[] = [];\n    const regex = /(<br>)/g;\n    let lastIndex = 0;\n    let match;\n    \n    while ((match = regex.exec(text)) !== null) {\n      if (match.index > lastIndex) {\n        parts.push(text.substring(lastIndex, match.index));\n      }\n      parts.push(match[0]); // <br> \n      lastIndex = regex.lastIndex;\n    }\n    if (lastIndex < text.length) {\n      parts.push(text.substring(lastIndex));\n    }\n    \n    if (parts.length === 0) {\n      parts.push(text);\n    }\n    \n    //    \n    let partIndex = 0;\n    let charIndex = 0;\n    \n    function typeNext() {\n      if (!textElement) return;\n      \n      if (partIndex >= parts.length) {\n        onComplete(text);\n        return;\n      }\n      \n      const currentPart = parts[partIndex];\n      \n      if (currentPart === '<br>') {\n        textElement.innerHTML = textElement.innerHTML + '<br>';\n        partIndex++;\n        charIndex = 0;\n        scheduleIntroTimer(typeNext, 50); //    \n      } else {\n        if (charIndex < currentPart.length) {\n          textElement.innerHTML = textElement.innerHTML + currentPart[charIndex];\n          charIndex++;\n          scheduleIntroTimer(typeNext, speed); //  \n        } else {\n          partIndex++;\n          charIndex = 0;\n          scheduleIntroTimer(typeNext, 0);\n        }\n      }\n    }\n    \n    typeNext();\n  }\n  \n  function showIntroTitle() {\n    clearIntroTimers();\n    introFinalePlaying = false;\n  introTitleShowing = true;\n  currentIntroPage = introSlidesData.length;\n    introRoot.classList.add('title-mode');\n    introRoot.classList.remove('finale-mode');\n  introRoot.onclick = () => {};\n    const titleText = '  <br>      ';\n    \n    //    \n    introRoot.style.backgroundImage = `url('backgrounds/intro_title.webp')`;\n    introRoot.style.backgroundSize = 'cover';\n    introRoot.style.backgroundPosition = 'center';\n    introRoot.style.backgroundRepeat = 'no-repeat';\n    \n    //    (  ,   )\n    introRoot.innerHTML = `\n      <div id=\"intro-title\">${titleText}</div>\n      <div id=\"intro-click-hint\"> </div>\n    `;\n    \n    //        \n    scheduleIntroTimer(() => {\n    introRoot.onclick = () => {\n      introTitleShowing = false;\n      requestAuthWithCallback(() => {\n        useBattleStore.getState().setGameScreen('menu');\n      });\n    };\n    }, 1000);\n  }\n  \n  //  UI / \n  //    \n  let isInitialLoad = true; //    \n  \n  function transitionToScreen(screen: string, callback: () => void, skipTransition: boolean = false) {\n    //         \n    if (skipTransition || isInitialLoad) {\n      callback();\n      isInitialLoad = false;\n      return;\n    }\n    \n    //   \n    screenTransitionOverlay.classList.add('active');\n    \n    //      \n    setTimeout(() => {\n      callback();\n      \n      //   \n      setTimeout(() => {\n        screenTransitionOverlay.classList.remove('active');\n      }, 50); //       \n    }, 300); //    (CSS transition )\n  }\n\n  function updateScreenVisibility(screen: string) {\n    //   \n    introRoot.classList.remove('active');\n    menuRoot.classList.remove('active');\n  menuUserInfoRoot?.classList.remove('visible');\n    deckEditorRoot.classList.remove('active');\n    campaignRoot.classList.remove('active');\n    dailyRoot.classList.remove('active');\n    shopRoot.classList.remove('active');\n    rewardRoot.classList.remove('active');\n    cutsceneRoot.classList.remove('active');\n    pvpRoot.classList.remove('active');\n    root.style.display = 'none';\n    hud.style.display = 'none';\n    controls.style.display = 'none';\n    logRoot.style.display = 'none';\n    handRoot.style.display = 'none';\n    logToggle.style.display = 'none'; //    \n    closeOptionsPanel();\n    \n    // BGM \n    if (screen === 'menu' || screen === 'deck-editor') {\n      audioManager.playBGM('bgm_menu');\n    } else if (screen === 'battle' || screen === 'campaign' || screen === 'daily' || screen === 'pvp') {\n      audioManager.playBGM('bgm_battle');\n    } else if (screen === 'shop') {\n      audioManager.playBGM('bgm_shop');\n    } else if (screen === 'cutscene') {\n      //    (  BGM )\n    }\n    \n    // UI  \n    if (screen !== 'cutscene' && screen !== 'intro') {\n      audioManager.playSFX('menu_open', 0.4);\n    }\n    \n    //  \n    if (screen === 'intro') {\n      renderIntro();\n      playerHPBar.visible = false;\n      enemyHPBar.visible = false;\n    } else if (screen === 'menu') {\n      menuRoot.classList.add('active');\n      menuUserInfoRoot?.classList.add('visible');\n      updateMenuUserInfo();\n      playerHPBar.visible = false;\n      enemyHPBar.visible = false;\n      gameInitialized = false; //      \n      if (!announcementDismissedPermanently && (!announcementHasBeenShown || announcementRemindQueued)) {\n        window.setTimeout(() => openAnnouncementModal(), 120);\n      }\n    } else if (screen === 'cutscene') {\n      cutsceneRoot.classList.add('active');\n      playerHPBar.visible = false;\n      enemyHPBar.visible = false;\n    } else if (screen === 'battle') {\n      root.style.display = 'block';\n      hud.style.display = 'block';\n      controls.style.display = 'flex';\n      logRoot.style.display = 'block';\n      handRoot.style.display = 'flex';\n      //     \n      if (isMobile || window.innerWidth <= 768) {\n        logToggle.style.display = 'block';\n      }\n      playerHPBar.visible = true;\n      enemyHPBar.visible = true;\n      \n      //   \n      updateDeckVisuals();\n      \n      //      \n      if (!gameInitialized && allCards.length > 0) {\n        //   \n        if (victoryDefeatTimer !== null) {\n        window.clearTimeout(victoryDefeatTimer);\n          victoryDefeatTimer = null;\n        }\n        \n        const store = useBattleStore.getState();\n        gameInitialized = true; //  gameInitialized     \n        store.initGame(allCards);\n        \n        // UI   (   )\n        requestAnimationFrame(() => {\n          renderHUD();\n          renderControls();\n          renderLog();\n          //  /  Zustand   \n          \n          //  1  \n          if (store.currentStage === 1) {\n            setTimeout(() => {\n              showTutorial([\n                {\n                  icon: '',\n                  title: '',\n                  text: ' HP 0  !',\n                },\n                {\n                  icon: '',\n                  title: ' ',\n                  text: '   .',\n                  highlight: '   \"\"'\n                },\n                {\n                  icon: '',\n                  title: ' ',\n                  text: '  \" \"  .',\n                  highlight: '     '\n                },\n                {\n                  icon: '',\n                  title: '',\n                  text: '     .',\n                  highlight: ' >  >  > '\n                },\n                {\n                  icon: '',\n                  title: '',\n                  text: '     !',\n                }\n              ], () => {\n                //      \n              });\n            }, 800);\n          }\n        });\n      }\n    } else if (screen === 'deck-editor') {\n      deckEditorRoot.classList.add('active');\n      playerHPBar.visible = false;\n      enemyHPBar.visible = false;\n      gameInitialized = false; //       \n      renderDeckEditor();\n    } else if (screen === 'campaign') {\n      campaignRoot.classList.add('active');\n      playerHPBar.visible = true;\n      enemyHPBar.visible = true;\n      //   showDefeatScreen/showVictoryScreen \n      renderCampaign();\n    } else if (screen === 'daily') {\n      dailyRoot.classList.add('active');\n      playerHPBar.visible = false;\n      enemyHPBar.visible = false;\n      gameInitialized = false;\n      renderDailyDungeon();\n    } else if (screen === 'shop') {\n      shopRoot.classList.add('active');\n      playerHPBar.visible = false;\n      enemyHPBar.visible = false;\n      gameInitialized = false; //      \n      renderShop();\n    } else if (screen === 'reward') {\n      playerHPBar.visible = false;\n      enemyHPBar.visible = false;\n      gameInitialized = false; //       \n      renderReward();\n    } else if (screen === 'pvp') {\n      pvpRoot.classList.add('active');\n      playerHPBar.visible = false;\n      enemyHPBar.visible = false;\n    }\n  }\n  \n  //    (  )\n  isInitialLoad = true;\n  updateScreenVisibility(useBattleStore.getState().gameScreen);\n  isInitialLoad = false;\n\n  //     (  )\n  let previousScreen = useBattleStore.getState().gameScreen;\n\n  //  : requestAnimationFrame UI  \n  let pendingUIUpdate = false;\n  let screenToRender: string | null = null;\n  \n  function scheduleUIUpdate(screen: string) {\n    screenToRender = screen;\n    if (pendingUIUpdate) return;\n    \n    pendingUIUpdate = true;\n    requestAnimationFrame(() => {\n      pendingUIUpdate = false;\n      if (!screenToRender) return;\n      \n      //  UI \n      if (screenToRender === 'battle') {\n        renderHUD();\n        renderControls();\n        renderLog();\n        renderEnemyHand();\n        renderHand();\n      } else if (screenToRender === 'deck-editor') {\n        renderDeckEditor();\n      } else if (screenToRender === 'campaign') {\n        renderCampaign();\n      } else if (screenToRender === 'daily') {\n        renderDailyDungeon();\n      } else if (screenToRender === 'shop') {\n        renderShop();\n      } else if (screenToRender === 'reward') {\n        renderReward();\n      }\n    });\n  }\n\n  // /   \n  let prevDeckLength = useBattleStore.getState().deck.length;\n  let prevHandLength = useBattleStore.getState().hand.length;\n  let prevEnemyHandLength = useBattleStore.getState().enemyHand.length;\n  \n  //    \n  let isDrawingCards = false;\n  let isDrawingEnemyCards = false;\n  let cardsToRender = 0; //    (  )\n  let enemyCardsToRender = 0;\n  \n  //    \n  let drawAnimationTimers: number[] = [];\n  let enemyDrawAnimationTimers: number[] = [];\n  \n  //       (initGame )\n  setHandTrackingResetCallback(() => {\n    console.log(`[HandTracking]  RESET CALLED`);\n    console.log(`[HandTracking]   Before - prevHand: ${prevHandLength}, prevEnemyHand: ${prevEnemyHandLength}`);\n    \n    //      \n    drawAnimationTimers.forEach(timer => window.clearTimeout(timer));\n    drawAnimationTimers = [];\n    enemyDrawAnimationTimers.forEach(timer => window.clearTimeout(timer));\n    enemyDrawAnimationTimers = [];\n    \n    //   0  (draw()   )\n    prevDeckLength = 0;\n    prevHandLength = 0;\n    prevEnemyHandLength = 0;\n    isDrawingCards = false;\n    isDrawingEnemyCards = false;\n    cardsToRender = 0;\n    enemyCardsToRender = 0;\n    \n    console.log(`[HandTracking]   After - prevHand: ${prevHandLength}, prevEnemyHand: ${prevEnemyHandLength}`);\n  });\n\n  setEnemyHandUpdateCallback(() => {\n    const state = useBattleStore.getState();\n    enemyCardsToRender = state.enemyHand.length;\n    renderEnemyHand();\n  });\n  // Keep local variables in sync with store updates\n  useBattleStore.subscribe((s) => {\n    //      \n    if (s.gameScreen !== previousScreen) {\n      console.log(`[Screen] Transition: ${previousScreen} -> ${s.gameScreen}`);\n      const targetScreen = s.gameScreen;\n      \n      //    \n      transitionToScreen(targetScreen, () => {\n        previousScreen = targetScreen;\n        updateScreenVisibility(targetScreen);\n        // Update battle background on screen change\n        updateBattleBackground();\n      });\n    }\n\n    // Update battle background when stage changes\n    if (s.gameScreen === 'battle') {\n      updateBattleBackground();\n    }\n    \n    //   \n    if (s.deck.length !== prevDeckLength) {\n      updateDeckVisuals();\n      prevDeckLength = s.deck.length;\n    }\n    \n    //      (   -  )\n    if (s.hand.length !== prevHandLength) {\n      console.log(`[Hand]  CHANGE DETECTED - prev: ${prevHandLength}, current: ${s.hand.length}, screen: ${s.gameScreen}, isDrawing: ${isDrawingCards}`);\n    }\n    \n    //    hand 0    (Zustand  subscribe )\n    if (s.hand.length === 0 && prevHandLength > 0 && isDrawingCards) {\n      console.log(`[Hand]  IGNORED: hand reset to 0 during draw animation (Zustand async issue)`);\n      // prevHandLength   \n    } else if (s.hand.length > prevHandLength && s.gameScreen === 'battle' && !isDrawingCards) {\n      const newCards = s.hand.length - prevHandLength;\n      const targetHandSize = s.hand.length; //    :   \n      \n      console.log(`[Draw]  ${newCards} card(s) drawn (${prevHandLength}  ${targetHandSize})`);\n      \n      //    \n      isDrawingCards = true;\n      cardsToRender = prevHandLength; //   \n      renderHand(); //   \n      \n      // prevHandLength   (  )\n      prevHandLength = targetHandSize;\n      console.log(`[Hand]  Updated prevHandLength to ${targetHandSize}`);\n      \n      //    ( )\n      for (let i = 0; i < newCards; i++) {\n        const targetX = app.renderer.width / 2;\n        const targetY = app.renderer.height - 100;\n        \n        const timer = window.setTimeout(async () => {\n          await animateCardDraw({ x: targetX, y: targetY }, true);\n          \n          //     \n          cardsToRender++;\n          renderHand();\n          \n          //    \n          if (cardsToRender >= targetHandSize) {\n            isDrawingCards = false;\n            console.log(`[Hand]  Animation complete`);\n          }\n        }, i * 300); // 0.3 \n        drawAnimationTimers.push(timer);\n      }\n    } else if (s.hand.length !== prevHandLength && !isDrawingCards) {\n      //     (  )\n      console.log(`[Hand]  Change detected (not a draw or screen !== 'battle') - prev: ${prevHandLength}, current: ${s.hand.length}, screen: ${s.gameScreen}`);\n      prevHandLength = s.hand.length;\n    }\n    \n    //      (   -  )\n    if (s.enemyHand.length !== prevEnemyHandLength) {\n      console.log(`[EnemyHand]  CHANGE DETECTED - prev: ${prevEnemyHandLength}, current: ${s.enemyHand.length}, screen: ${s.gameScreen}, isDrawing: ${isDrawingEnemyCards}`);\n    }\n    \n    //    enemyHand 0    (Zustand  subscribe )\n    if (s.enemyHand.length === 0 && prevEnemyHandLength > 0 && isDrawingEnemyCards) {\n      console.log(`[EnemyHand]  IGNORED: enemyHand reset to 0 during draw animation (Zustand async issue)`);\n      // prevEnemyHandLength   \n    } else if (s.enemyHand.length > prevEnemyHandLength && s.gameScreen === 'battle' && !isDrawingEnemyCards) {\n      if (prevEnemyHandLength === 0 && s.battleContext.type === 'pvp' && s.round === 1) {\n        enemyCardsToRender = s.enemyHand.length;\n        renderEnemyHand();\n        prevEnemyHandLength = s.enemyHand.length;\n        isDrawingEnemyCards = false;\n        console.log('[EnemyHand]  Initial PvP hand synced without animation');\n      } else {\n        const newCards = s.enemyHand.length - prevEnemyHandLength;\n        const targetHandSize = s.enemyHand.length; //    :   \n        \n        console.log(`[EnemyDraw]  ${newCards} card(s) drawn (${prevEnemyHandLength}  ${targetHandSize})`);\n        \n        //    \n        isDrawingEnemyCards = true;\n        enemyCardsToRender = prevEnemyHandLength; //   \n        renderEnemyHand(); //   \n        \n        // prevEnemyHandLength   (  )\n        prevEnemyHandLength = targetHandSize;\n        console.log(`[EnemyHand]  Updated prevEnemyHandLength to ${targetHandSize}`);\n        \n        //    ( )\n        for (let i = 0; i < newCards; i++) {\n          const targetX = app.renderer.width / 2;\n          const targetY = 100;\n          \n          const timer = window.setTimeout(async () => {\n            await animateCardDraw({ x: targetX, y: targetY }, false);\n            \n            //     \n            enemyCardsToRender++;\n            renderEnemyHand();\n            \n            //    \n            if (enemyCardsToRender >= targetHandSize) {\n              isDrawingEnemyCards = false;\n              console.log(`[EnemyHand]  Animation complete`);\n            }\n          }, i * 300); // 0.3 \n          enemyDrawAnimationTimers.push(timer);\n        }\n      }\n    } else if (s.enemyHand.length !== prevEnemyHandLength && s.gameScreen === 'battle' && !isDrawingEnemyCards) {\n      //    (  )\n      const newCards = s.enemyHand.length - prevEnemyHandLength;\n      console.log(`[EnemyHand]  UNEXPECTED CHANGE - newCards: ${newCards}, prev: ${prevEnemyHandLength}, current: ${s.enemyHand.length}`);\n      if (newCards < 0) {\n        console.log(`[EnemyHand] ${Math.abs(newCards)} card(s) removed`);\n      }\n      enemyCardsToRender = s.enemyHand.length;\n      renderEnemyHand();\n      prevEnemyHandLength = s.enemyHand.length;\n    } else if (s.enemyHand.length !== prevEnemyHandLength) {\n      console.log(`[EnemyHand]  Change detected but screen !== 'battle' (screen: ${s.gameScreen})`);\n      enemyCardsToRender = s.enemyHand.length;\n      renderEnemyHand();\n      prevEnemyHandLength = s.enemyHand.length;\n    }\n    \n    //    +  \n    \n    //   \n    if (energy !== s.energy) {\n      tweenNumber(displayEnergy, s.energy, 300, (value) => {\n        displayEnergy = value;\n        renderHUD();\n        //    \n        updateEnergyBar(playerEnergyBar, playerEnergyComponents, value, 10, playerHPBarWidth);\n      }, { easing: Easing.easeOutQuad });\n    }\n    energy = s.energy;\n    \n    //   \n    if (s.enemyEnergy !== undefined) {\n      updateEnergyBar(enemyEnergyBar, enemyEnergyComponents, s.enemyEnergy, 10, enemyHPBarWidth);\n    }\n    \n    //  HP  \n    if (playerHp !== s.playerHp) {\n      const prevHP = displayPlayerHp; //   HP \n      tweenNumber(displayPlayerHp, s.playerHp, 400, (value) => {\n        displayPlayerHp = value;\n        renderHUD();\n        // HP   (  )\n        updateHPBar(playerHPBar, playerHPComponents, value, s.playerMaxHp, playerHPBarWidth, prevPlayerHPForFlash, true);\n      }, { easing: Easing.easeOutCubic });\n      prevPlayerHPForFlash = s.playerHp; //  HP \n    }\n    playerHp = s.playerHp;\n    \n    //  HP  \n    if (enemyHp !== s.enemyHp) {\n      const prevHP = displayEnemyHp; //   HP \n      tweenNumber(displayEnemyHp, s.enemyHp, 400, (value) => {\n        displayEnemyHp = value;\n        renderHUD();\n        // HP   (  )\n        updateHPBar(enemyHPBar, enemyHPComponents, value, s.enemyMaxHp, enemyHPBarWidth, prevEnemyHPForFlash, true);\n      }, { easing: Easing.easeOutCubic });\n      prevEnemyHPForFlash = s.enemyHp; //  HP \n    }\n    enemyHp = s.enemyHp;\n    \n    round = s.round;\n    roundSeed = s.roundSeed;\n    playerMaxHp = s.playerMaxHp;\n    enemyMaxHp = s.enemyMaxHp;\n    \n    //     \n    if (gameOver !== s.gameOver) {\n      console.log(`[GameOver] State changed: ${gameOver}  ${s.gameOver}`);\n      //   \n      if (victoryDefeatTimer !== null) {\n        window.clearTimeout(victoryDefeatTimer);\n        victoryDefeatTimer = null;\n        console.log(`[GameOver] Cancelled previous timer`);\n      }\n      \n      if (s.gameOver === 'victory') {\n        console.log(`[GameOver] Setting victory timer`);\n        victoryDefeatTimer = window.setTimeout(() => {\n          const currentState = useBattleStore.getState();\n          if (currentState.gameOver === 'victory') {\n            showVictoryScreen();\n          } else {\n            console.log(`[GameOver] Timer fired but gameOver changed to ${currentState.gameOver}, skipping`);\n          }\n        }, 1000);\n      } else if (s.gameOver === 'defeat') {\n        console.log(`[GameOver] Setting defeat timer`);\n        victoryDefeatTimer = window.setTimeout(() => {\n          const currentState = useBattleStore.getState();\n          if (currentState.gameOver === 'defeat') {\n            showDefeatScreen();\n          } else {\n            console.log(`[GameOver] Timer fired but gameOver changed to ${currentState.gameOver}, skipping`);\n          }\n        }, 1000);\n      } else {\n        //     \n        console.log(`[GameOver] Hiding victory/defeat screens`);\n        victoryScreen.classList.remove('active');\n        defeatScreen.classList.remove('active');\n      }\n    }\n    gameOver = s.gameOver;\n    \n    //     UI \n    if (playerStatus !== s.playerStatus || enemyStatus !== s.enemyStatus) {\n      updateStatusUI();\n    }\n    playerStatus = s.playerStatus;\n    enemyStatus = s.enemyStatus;\n    \n    //  UI  (    - updateScreenVisibility  )\n    if (s.gameScreen === previousScreen) {\n      scheduleUIUpdate(s.gameScreen);\n    }\n  });\n});"],"file":"assets/index-BJnN8Bkh.js"}